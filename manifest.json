{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v7.json", "dbt_version": "1.3.1", "generated_at": "2023-06-05T10:09:08.380875Z", "invocation_id": "be1adf02-c285-4fdb-a2e7-544d855a9340", "env": {}, "project_id": "b924fe89d01aefe5ef73cf52f3b33d29", "user_id": "1eb1dd1f-18d3-41b1-bd42-ecfcd9e1295f", "send_anonymous_usage_stats": true, "adapter_type": "trino"}, "nodes": {"model.dga_data_model.dwh__ccl_pln": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.ccl_pln"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily"], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__ccl_pln"], "unique_id": "model.dga_data_model.dwh__ccl_pln", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      import_date\r\n    , date_eff\r\n    , loai_vay\r\n    , loai_vay_kt\r\n    , chi_nhanh\r\n    , cif\r\n    , br_cif\r\n    , ten_kh\r\n    , loai_hinh_kh\r\n    , class\r\n    , bank_ql\r\n    , du_no_quy_doi\r\n    , gia_tri_tsbd\r\n    , gia_tri_tsbd_khau_tru\r\n    , pln_truoc_cic\r\n    , du_phong_chung\r\n    , du_phong_cu_the\r\n    , pln_sau_cic\r\n    , du_phong_chung_cic\r\n    , du_phong_cu_the_cic\r\n  FROM {{ source('dwh', 'ccl_pln') }}\r\n  {% if is_incremental() %}\r\n  WHERE import_date > (SELECT MAX(import_date) FROM {{ this }})\r\n{% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__ccl_pln.sql", "original_file_path": "models\\base\\dwh__ccl_pln.sql", "name": "dwh__ccl_pln", "alias": "dwh__ccl_pln", "checksum": {"name": "sha256", "checksum": "16328553222f9b3a03e2d3dee17664dd409fab40d20fb7acf0960cb94c20a33f"}, "tags": ["daily"], "refs": [], "sources": [["dwh", "ccl_pln"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__ccl_pln.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily"], "materialized": "incremental"}, "created_at": 1685959752.3061464, "compiled_code": "\nWITH source AS(\n  SELECT\n      import_date\n    , date_eff\n    , loai_vay\n    , loai_vay_kt\n    , chi_nhanh\n    , cif\n    , br_cif\n    , ten_kh\n    , loai_hinh_kh\n    , class\n    , bank_ql\n    , du_no_quy_doi\n    , gia_tri_tsbd\n    , gia_tri_tsbd_khau_tru\n    , pln_truoc_cic\n    , du_phong_chung\n    , du_phong_cu_the\n    , pln_sau_cic\n    , du_phong_chung_cic\n    , du_phong_cu_the_cic\n  FROM oracle_dwh.dwh.ccl_pln\n  \n  WHERE import_date > (SELECT MAX(import_date) FROM \"oracle_dgaworkzone\".base.dwh__ccl_pln)\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__ccl_pln"}, "model.dga_data_model.dwh__demanddeposit_master003": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.ddft_master"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily", "weekly"], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "etl_date", "start_date": "2020000", "stop_date": "2022359", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__demanddeposit_master003"], "unique_id": "model.dga_data_model.dwh__demanddeposit_master003", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"etl_date\",\r\n    start_date = \"2020000\",\r\n    stop_date = \"2022359\")\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      etl_date\r\n    , branch_sk\r\n    , account_no_sk\r\n    , account_type\r\n    , currency\r\n    , product_sk\r\n    , customer_sk\r\n    , status\r\n    , status_since\r\n    , open_date\r\n    , last_active_dt\r\n    , last_contact_dt\r\n    , rate_code\r\n    , rate\r\n    , accr_dr\r\n    , today_accr_dr\r\n    , today_dr_int_liq\r\n    , ytd_dr_int_liq\r\n    , ytd_cr_int_liq\r\n    , od_rate_code\r\n    , od_rate\r\n    , efft_rate\r\n    , acy_blocked_amt\r\n    , lcy_blocked_amt\r\n    , acy_ledger_bal\r\n    , lcy_ledger_bal\r\n    , acy_collected_bal\r\n    , lcy_collected_bal\r\n    , ac_stat_dormant\r\n    , dorm_since\r\n    , gl_code_sk\r\n    , icycle_high_int\r\n    , q1_avg_lbal\r\n    , q2_avg_lbal\r\n    , q3_avg_lbal\r\n    , q4_avg_lbal\r\n    , q1_avg_cbal\r\n    , q2_avg_cbal\r\n    , q3_avg_cbal\r\n    , q4_avg_cbal\r\n    , qtr_agr_days\r\n    , qtr_agr_lbal\r\n    , qtr_agr_cbal\r\n    , mtd_agr_days\r\n    , mtd_agr_bal\r\n    , icycle_agr_days\r\n    , icycle_agr_lbal\r\n    , icycle_agr_cbal\r\n    , icycle_min_bal\r\n    , icycle_max_bal\r\n    , mtd_min_bal\r\n    , mtd_max_bal\r\n    , ac_today_no_dr\r\n    , acy_today_tover_dr\r\n    , lcy_today_tover_dr\r\n    , ac_today_no_cr\r\n    , acy_today_tover_cr\r\n    , lcy_today_tover_cr\r\n    , sc_no_dr\r\n    , sc_tover_dr\r\n    , sc_no_cr\r\n    , sc_tover_cr\r\n    , maker_sk\r\n    , maker_dt_stamp\r\n    , checker_sk\r\n    , number_debit_mtd\r\n    , amount_debit_mtd\r\n    , number_credit_mtd\r\n    , amount_credit_mtd\r\n    , yesterday_balance\r\n    , int_paid_td\r\n    , number_debit_ytd\r\n    , amount_debit_ytd\r\n    , number_credit_ytd\r\n    , amount_credit_ytd\r\n    , book_no\r\n    , last_trn_date\r\n    , aggregate_balance\r\n    , od_accr_int\r\n    , od_exss_int\r\n    , od_accr_int_day\r\n    , od_exss_int_day\r\n  FROM {{ source('dwh', 'ddft_master') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE etl_date > (SELECT MAX(etl_date) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__demanddeposit_master003.sql", "original_file_path": "models\\base\\dwh__demanddeposit_master003.sql", "name": "dwh__demanddeposit_master003", "alias": "dwh__demanddeposit_master003", "checksum": {"name": "sha256", "checksum": "f54a2a8829b7475e7cdad7a49760ad091aa3e3a59d79d84830bc962c7071a9a7"}, "tags": ["daily", "weekly"], "refs": [], "sources": [["dwh", "ddft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__demanddeposit_master003.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily", "weekly"], "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "etl_date", "start_date": "2020000", "stop_date": "2022359"}, "created_at": 1685959752.2951465, "compiled_code": "\nWITH source AS(\n  SELECT\n      etl_date\n    , branch_sk\n    , account_no_sk\n    , account_type\n    , currency\n    , product_sk\n    , customer_sk\n    , status\n    , status_since\n    , open_date\n    , last_active_dt\n    , last_contact_dt\n    , rate_code\n    , rate\n    , accr_dr\n    , today_accr_dr\n    , today_dr_int_liq\n    , ytd_dr_int_liq\n    , ytd_cr_int_liq\n    , od_rate_code\n    , od_rate\n    , efft_rate\n    , acy_blocked_amt\n    , lcy_blocked_amt\n    , acy_ledger_bal\n    , lcy_ledger_bal\n    , acy_collected_bal\n    , lcy_collected_bal\n    , ac_stat_dormant\n    , dorm_since\n    , gl_code_sk\n    , icycle_high_int\n    , q1_avg_lbal\n    , q2_avg_lbal\n    , q3_avg_lbal\n    , q4_avg_lbal\n    , q1_avg_cbal\n    , q2_avg_cbal\n    , q3_avg_cbal\n    , q4_avg_cbal\n    , qtr_agr_days\n    , qtr_agr_lbal\n    , qtr_agr_cbal\n    , mtd_agr_days\n    , mtd_agr_bal\n    , icycle_agr_days\n    , icycle_agr_lbal\n    , icycle_agr_cbal\n    , icycle_min_bal\n    , icycle_max_bal\n    , mtd_min_bal\n    , mtd_max_bal\n    , ac_today_no_dr\n    , acy_today_tover_dr\n    , lcy_today_tover_dr\n    , ac_today_no_cr\n    , acy_today_tover_cr\n    , lcy_today_tover_cr\n    , sc_no_dr\n    , sc_tover_dr\n    , sc_no_cr\n    , sc_tover_cr\n    , maker_sk\n    , maker_dt_stamp\n    , checker_sk\n    , number_debit_mtd\n    , amount_debit_mtd\n    , number_credit_mtd\n    , amount_credit_mtd\n    , yesterday_balance\n    , int_paid_td\n    , number_debit_ytd\n    , amount_debit_ytd\n    , number_credit_ytd\n    , amount_credit_ytd\n    , book_no\n    , last_trn_date\n    , aggregate_balance\n    , od_accr_int\n    , od_exss_int\n    , od_accr_int_day\n    , od_exss_int_day\n  FROM oracle_dwh.dwh.ddft_master\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__demanddeposit_master003"}, "model.dga_data_model.dwh__demanddeposit_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.generate_surrogate_key", "macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.ddft_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily"], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "trn_date", "start_date": "2011206", "stop_date": "2022359", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__demanddeposit_transaction001"], "unique_id": "model.dga_data_model.dwh__demanddeposit_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"trn_date\",\r\n    start_date = \"2011206\",\r\n    stop_date = \"2022359\")\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n    trn_ref_no,\r\n    src_ref_no,\r\n    sub_ref_no,\r\n    affect_code,\r\n    trn_sk,\r\n    trn_time,\r\n    trn_date,\r\n    value_date,\r\n    currency,\r\n    dorc_ind,\r\n    acy_amount,\r\n    exchange_rate,\r\n    lcy_amount,\r\n    product_sk,\r\n    status,\r\n    channel,\r\n    channel_trn,\r\n    ac_branch_sk,\r\n    trn_branch_sk,\r\n    account_no_sk,\r\n    customer_sk,\r\n    gl_code_sk,\r\n    maker_sk,\r\n    checker_sk,\r\n    related_person,\r\n    related_account,\r\n    trf_sys,\r\n    trf_bank_sk,\r\n    remark,\r\n    seq_number,\r\n    posting_order,\r\n    before_balance,\r\n    current_balance,\r\n    user_id,\r\n    eqv_tramt,\r\n    {{ generate_surrogate_key([\r\n        'trn_ref_no'\r\n      ,  'src_ref_no'\r\n      , 'sub_ref_no'\r\n      , 'affect_code'\r\n      , 'trn_sk'\r\n      , 'trn_time'\r\n      , 'trn_date'\r\n      , 'value_date'\r\n      , 'currency'\r\n      , 'dorc_ind'\r\n      , 'acy_amount'\r\n      , 'exchange_rate'\r\n      , 'lcy_amount'\r\n      , 'product_sk'\r\n      , 'status'\r\n      , 'channel'\r\n      , 'channel_trn'\r\n      , 'ac_branch_sk'\r\n      , 'trn_branch_sk'\r\n      , 'account_no_sk'\r\n      , 'customer_sk'\r\n      , 'gl_code_sk'\r\n      , 'maker_sk'\r\n      , 'checker_sk'\r\n      , 'related_person'\r\n      , 'related_account'\r\n      , 'trf_sys'\r\n      , 'trf_bank_sk'\r\n      , 'remark'\r\n      , 'seq_number'\r\n      , 'posting_order'\r\n      , 'before_balance'\r\n      , 'current_balance'\r\n      , 'user_id'\r\n      , 'eqv_tramt'\r\n      ]) }} AS surrogate_key\r\n  FROM {{ source('dwh', 'ddft_transaction') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE trn_date > (SELECT MAX(trn_date) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__demanddeposit_transaction001.sql", "original_file_path": "models\\base\\dwh__demanddeposit_transaction001.sql", "name": "dwh__demanddeposit_transaction001", "alias": "dwh__demanddeposit_transaction001", "checksum": {"name": "sha256", "checksum": "8d8d2e9eaa2594817bd603bba7813f2c39f5fd4838c594b73cabcbd9a68da1b7"}, "tags": ["daily"], "refs": [], "sources": [["dwh", "ddft_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__demanddeposit_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily"], "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "trn_date", "start_date": "2011206", "stop_date": "2022359"}, "created_at": 1685959752.2971466, "compiled_code": "\nWITH source AS (\n  SELECT\n    trn_ref_no,\n    src_ref_no,\n    sub_ref_no,\n    affect_code,\n    trn_sk,\n    trn_time,\n    trn_date,\n    value_date,\n    currency,\n    dorc_ind,\n    acy_amount,\n    exchange_rate,\n    lcy_amount,\n    product_sk,\n    status,\n    channel,\n    channel_trn,\n    ac_branch_sk,\n    trn_branch_sk,\n    account_no_sk,\n    customer_sk,\n    gl_code_sk,\n    maker_sk,\n    checker_sk,\n    related_person,\n    related_account,\n    trf_sys,\n    trf_bank_sk,\n    remark,\n    seq_number,\n    posting_order,\n    before_balance,\n    current_balance,\n    user_id,\n    eqv_tramt,\n    \n    \nlower(to_hex(md5(to_utf8(cast(coalesce(cast(trn_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(src_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sub_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(affect_code as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_time as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_date as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(value_date as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dorc_ind as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(acy_amount as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(exchange_rate as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lcy_amount as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(status as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel_trn as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ac_branch_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_branch_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_no_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(gl_code_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(maker_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(checker_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(related_person as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(related_account as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trf_sys as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trf_bank_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(remark as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(seq_number as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(posting_order as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(before_balance as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_balance as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(user_id as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(eqv_tramt as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) AS surrogate_key\n  FROM oracle_dwh.dwh.ddft_transaction\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__demanddeposit_transaction001"}, "model.dga_data_model.dwh__fixeddeposit_master003": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.fdft_master"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily"], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "etl_date", "start_date": "2020000", "stop_date": "2022359", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__fixeddeposit_master003"], "unique_id": "model.dga_data_model.dwh__fixeddeposit_master003", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"etl_date\",\r\n    start_date = \"2020000\",\r\n    stop_date = \"2022359\")\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n      etl_date\r\n    , branch_sk\r\n    , account_sk\r\n    , currency\r\n    , product_sk\r\n    , customer_sk\r\n    , status\r\n    , status_since\r\n    , open_date\r\n    , term\r\n    , maturity_date\r\n    , last_renew_bal\r\n    , last_renew_date\r\n    , renew_count\r\n    , last_update_dt\r\n    , rate\r\n    , rate_review_dt\r\n    , accr_amount\r\n    , today_accr_dr\r\n    , expected_accr_int\r\n    , last_liq_date\r\n    , next_liq_date\r\n    , withdrawable_int\r\n    , org_discount_amt\r\n    , org_amount\r\n    , acy_blocked_amt\r\n    , acy_ledger_bal\r\n    , lcy_ledger_bal\r\n    , ac_stat_dormant\r\n    , dorm_since\r\n    , acy_aggr_bal\r\n    , aggr_days\r\n    , gl_code_sk\r\n    , maker_sk\r\n    , maker_dt_stamp\r\n    , officer_sk\r\n    , auto_renew\r\n    , renew_bal\r\n    , today_backdate_int\r\n    , mtd_accr_int\r\n    , last_int_amt_paid\r\n    , penanty_amount\r\n    , today_tover_int_dr\r\n    , today_tover_int_cr\r\n    , today_int_drop\r\n    , today_int_paid\r\n    , ctd_int_deposit\r\n    , ctd_int_withdraw\r\n    , ytd_interest_paid\r\n    , ctd_interest_paid\r\n    , highist_interest_earn\r\n    , yesterday_balance\r\n  FROM {{ source('dwh', 'fdft_master') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE etl_date > (SELECT MAX(etl_date) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__fixeddeposit_master003.sql", "original_file_path": "models\\base\\dwh__fixeddeposit_master003.sql", "name": "dwh__fixeddeposit_master003", "alias": "dwh__fixeddeposit_master003", "checksum": {"name": "sha256", "checksum": "7056d714a05e59a048693013223ac3e98a86e100b564b931502893400d7aad36"}, "tags": ["daily"], "refs": [], "sources": [["dwh", "fdft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__fixeddeposit_master003.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily"], "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "etl_date", "start_date": "2020000", "stop_date": "2022359"}, "created_at": 1685959752.2981465, "compiled_code": "\nWITH source AS (\n  SELECT\n      etl_date\n    , branch_sk\n    , account_sk\n    , currency\n    , product_sk\n    , customer_sk\n    , status\n    , status_since\n    , open_date\n    , term\n    , maturity_date\n    , last_renew_bal\n    , last_renew_date\n    , renew_count\n    , last_update_dt\n    , rate\n    , rate_review_dt\n    , accr_amount\n    , today_accr_dr\n    , expected_accr_int\n    , last_liq_date\n    , next_liq_date\n    , withdrawable_int\n    , org_discount_amt\n    , org_amount\n    , acy_blocked_amt\n    , acy_ledger_bal\n    , lcy_ledger_bal\n    , ac_stat_dormant\n    , dorm_since\n    , acy_aggr_bal\n    , aggr_days\n    , gl_code_sk\n    , maker_sk\n    , maker_dt_stamp\n    , officer_sk\n    , auto_renew\n    , renew_bal\n    , today_backdate_int\n    , mtd_accr_int\n    , last_int_amt_paid\n    , penanty_amount\n    , today_tover_int_dr\n    , today_tover_int_cr\n    , today_int_drop\n    , today_int_paid\n    , ctd_int_deposit\n    , ctd_int_withdraw\n    , ytd_interest_paid\n    , ctd_interest_paid\n    , highist_interest_earn\n    , yesterday_balance\n  FROM oracle_dwh.dwh.fdft_master\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__fixeddeposit_master003"}, "model.dga_data_model.dwh__fixeddeposit_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.generate_surrogate_key", "macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.fdft_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily"], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "trn_date", "start_date": "2020000", "stop_date": "2022359", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__fixeddeposit_transaction001"], "unique_id": "model.dga_data_model.dwh__fixeddeposit_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"trn_date\",\r\n    start_date = \"2020000\",\r\n    stop_date = \"2022359\")\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n      trn_ref_no\r\n    , sub_ref_no\r\n    , src_ref_no\r\n    , trn_sk\r\n    , affect_code\r\n    , trn_branch_sk\r\n    , trn_time\r\n    , trn_date\r\n    , value_date\r\n    , dorc_ind\r\n    , acy_amount\r\n    , currency\r\n    , exchange_rate\r\n    , lcy_amount\r\n    , ac_branch_sk\r\n    , account_no_sk\r\n    , gl_code_sk\r\n    , customer_sk\r\n    , product_sk\r\n    , prate\r\n    , rate\r\n    , channel\r\n    , channel_trn_code\r\n    , maker_sk\r\n    , checker_sk\r\n    , seq_number\r\n    , channel_trn\r\n    , remark\r\n    , before_balance\r\n    , current_balance\r\n    , posting_order\r\n    , {{ generate_surrogate_key([\r\n        'trn_ref_no'\r\n      , 'sub_ref_no'\r\n      , 'src_ref_no'\r\n      , 'trn_sk'\r\n      , 'affect_code'\r\n      , 'trn_branch_sk'\r\n      , 'trn_time'\r\n      , 'trn_date'\r\n      , 'value_date'\r\n      , 'dorc_ind'\r\n      , 'acy_amount'\r\n      , 'currency'\r\n      , 'exchange_rate'\r\n      , 'lcy_amount'\r\n      , 'ac_branch_sk'\r\n      , 'account_no_sk'\r\n      , 'gl_code_sk'\r\n      , 'customer_sk'\r\n      , 'product_sk'\r\n      , 'prate'\r\n      , 'rate'\r\n      , 'channel'\r\n      , 'channel_trn_code'\r\n      , 'maker_sk'\r\n      , 'checker_sk'\r\n      , 'seq_number'\r\n      , 'channel_trn'\r\n      , 'remark'\r\n      , 'before_balance'\r\n      , 'current_balance'\r\n      , 'posting_order'\r\n      ]) }} AS surrogate_key\r\n  FROM {{ source('dwh', 'fdft_transaction') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE trn_date > (SELECT MAX(trn_date) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__fixeddeposit_transaction001.sql", "original_file_path": "models\\base\\dwh__fixeddeposit_transaction001.sql", "name": "dwh__fixeddeposit_transaction001", "alias": "dwh__fixeddeposit_transaction001", "checksum": {"name": "sha256", "checksum": "2f44e60be733e37f6aa7050e3f46281ebb5fe2d0c33eb94b630a10951c31f8a7"}, "tags": ["daily"], "refs": [], "sources": [["dwh", "fdft_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__fixeddeposit_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily"], "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "trn_date", "start_date": "2020000", "stop_date": "2022359"}, "created_at": 1685959752.3001466, "compiled_code": "\nWITH source AS (\n  SELECT\n      trn_ref_no\n    , sub_ref_no\n    , src_ref_no\n    , trn_sk\n    , affect_code\n    , trn_branch_sk\n    , trn_time\n    , trn_date\n    , value_date\n    , dorc_ind\n    , acy_amount\n    , currency\n    , exchange_rate\n    , lcy_amount\n    , ac_branch_sk\n    , account_no_sk\n    , gl_code_sk\n    , customer_sk\n    , product_sk\n    , prate\n    , rate\n    , channel\n    , channel_trn_code\n    , maker_sk\n    , checker_sk\n    , seq_number\n    , channel_trn\n    , remark\n    , before_balance\n    , current_balance\n    , posting_order\n    , \n    \nlower(to_hex(md5(to_utf8(cast(coalesce(cast(trn_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sub_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(src_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(affect_code as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_branch_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_time as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_date as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(value_date as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dorc_ind as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(acy_amount as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(exchange_rate as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lcy_amount as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ac_branch_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_no_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(gl_code_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(prate as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(rate as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel_trn_code as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(maker_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(checker_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(seq_number as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel_trn as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(remark as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(before_balance as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_balance as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(posting_order as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) AS surrogate_key\n  FROM oracle_dwh.dwh.fdft_transaction\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__fixeddeposit_transaction001"}, "model.dga_data_model.dwh__glft_his_transaction": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.glft_his_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "trn_date", "start_date": "2022000", "stop_date": "2022208", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__glft_his_transaction"], "unique_id": "model.dga_data_model.dwh__glft_his_transaction", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"trn_date\",\r\n    start_date = \"2022000\",\r\n    stop_date = \"2022208\")\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      posting_order\r\n    , seq_number\r\n    , acc_branch_sk\r\n    , gl_code_sk\r\n    , trn_code\r\n    , dorc\r\n    , affect_code\r\n    , trn_amount\r\n    , trn_date\r\n    , value_date\r\n    , trn_desc\r\n    , backdate\r\n    , trn_source\r\n    , src_branch_sk\r\n    , trn_currency\r\n    , foreign_currency\r\n    , ref_number\r\n    , module\r\n    , gl_interface\r\n    , gl_group\r\n    , convert_currency\r\n    , conversion_rate\r\n    , maker_id\r\n    , channel\r\n    , remark\r\n    , exchange_rate\r\n    , local_equivalent\r\n    , org_amount\r\n    , org_currency\r\n    , ticket\r\n    , checker_id\r\n    , trn_time\r\n    , correction\r\n    , \"key\"\r\n    , src_ref_no\r\n  FROM {{ source('dwh', 'glft_his_transaction') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE trn_date > (SELECT MAX(trn_date) FROM {{ this }})\r\n{% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__glft_his_transaction.sql", "original_file_path": "models\\base\\dwh__glft_his_transaction.sql", "name": "dwh__glft_his_transaction", "alias": "dwh__glft_his_transaction", "checksum": {"name": "sha256", "checksum": "ef8a44673c499fea2f0bb17f449a8855a21f45ffd4d66a7ea55479e2a6151a61"}, "tags": [], "refs": [], "sources": [["dwh", "glft_his_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__glft_his_transaction.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "trn_date", "start_date": "2022000", "stop_date": "2022208"}, "created_at": 1685959750.3617997, "compiled_code": "\nWITH source AS(\n  SELECT\n      posting_order\n    , seq_number\n    , acc_branch_sk\n    , gl_code_sk\n    , trn_code\n    , dorc\n    , affect_code\n    , trn_amount\n    , trn_date\n    , value_date\n    , trn_desc\n    , backdate\n    , trn_source\n    , src_branch_sk\n    , trn_currency\n    , foreign_currency\n    , ref_number\n    , module\n    , gl_interface\n    , gl_group\n    , convert_currency\n    , conversion_rate\n    , maker_id\n    , channel\n    , remark\n    , exchange_rate\n    , local_equivalent\n    , org_amount\n    , org_currency\n    , ticket\n    , checker_id\n    , trn_time\n    , correction\n    , \"key\"\n    , src_ref_no\n  FROM oracle_dwh.dwh.glft_his_transaction\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__glft_his_transaction"}, "model.dga_data_model.dwh__loan_master003": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.lnft_master"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily", "weekly"], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "etl_date", "start_date": "2020000", "stop_date": "2022359", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__loan_master003"], "unique_id": "model.dga_data_model.dwh__loan_master003", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"etl_date\",\r\n    start_date = \"2020000\",\r\n    stop_date = \"2022359\")\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n      etl_date\r\n    , branch_code_sk\r\n    , account_no_sk\r\n    , customer_sk\r\n    , contract_sk\r\n    , aano_sk\r\n    , currency\r\n    , product_sk\r\n    , acy_original_amt\r\n    , lcy_original_amt\r\n    , drawdown_limit\r\n    , released_amt\r\n    , acy_outstanding_bal\r\n    , lcy_outstanding_bal\r\n    , status\r\n    , status_since\r\n    , classified_type\r\n    , overdue_status_sk\r\n    , group_overdue_status_sk\r\n    , final_maturity_dt\r\n    , interest\r\n    , based_rate\r\n    , next_review_dt\r\n    , rate_review_dt\r\n    , prime_review_dt\r\n    , last_pliq_amt\r\n    , last_pliq_dt\r\n    , next_pliq_dt\r\n    , last_iliq_dt\r\n    , next_iliq_dt\r\n    , payment_amt\r\n    , final_payment_amt\r\n    , ltd_int_paid\r\n    , ltd_prn_paid\r\n    , last_accr_amt\r\n    , acy_std_accr_amt\r\n    , lcy_std_accr_amt\r\n    , acy_std_accr_penalty_amt\r\n    , lcy_std_accr_penalty_amt\r\n    , acy_ltd_accr_amt\r\n    , lcy_ltd_accr_amt\r\n    , prin_overdue_days\r\n    , acy_prin_overdue_amt\r\n    , int_overdue_days\r\n    , acy_int_overdue_amt\r\n    , acy_total_overdue_amt\r\n    , lcy_total_overdue_amt\r\n    , acy_late_charge\r\n    , dealer_id\r\n    , purpose_sk\r\n    , industry_sk\r\n    , tenor_code_sk\r\n    , maker_sk\r\n    , maker_dt_stamp\r\n    , checker_sk\r\n    , checker_dt_stamp\r\n    , officer_sk\r\n    , ftp_rate\r\n    , actual_overdue_status_sk\r\n    , bil_prin_amt\r\n    , bil_int_amt\r\n    , bil_lc_amt\r\n    , lcy_prin_overdue_amt\r\n    , lcy_int_overdue_amt\r\n    , lcy_late_charge\r\n    , part_industry_sk\r\n    , year_base\r\n  FROM {{ source('dwh', 'lnft_master') }}\r\n  where __PERIOD_FILTER__\r\n--   {% if is_incremental() %}\r\n--   WHERE etl_date > (SELECT MAX(etl_date) FROM {{ this }})\r\n--   {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__loan_master003.sql", "original_file_path": "models\\base\\dwh__loan_master003.sql", "name": "dwh__loan_master003", "alias": "dwh__loan_master003", "checksum": {"name": "sha256", "checksum": "3ba636794666788053a01e76f359ec28adc7fb3b80a4bd01d75efa5787d1be13"}, "tags": ["daily", "weekly"], "refs": [], "sources": [["dwh", "lnft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__loan_master003.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily", "weekly"], "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "etl_date", "start_date": "2020000", "stop_date": "2022359"}, "created_at": 1685959752.3021467, "compiled_code": "\nWITH source AS (\n  SELECT\n      etl_date\n    , branch_code_sk\n    , account_no_sk\n    , customer_sk\n    , contract_sk\n    , aano_sk\n    , currency\n    , product_sk\n    , acy_original_amt\n    , lcy_original_amt\n    , drawdown_limit\n    , released_amt\n    , acy_outstanding_bal\n    , lcy_outstanding_bal\n    , status\n    , status_since\n    , classified_type\n    , overdue_status_sk\n    , group_overdue_status_sk\n    , final_maturity_dt\n    , interest\n    , based_rate\n    , next_review_dt\n    , rate_review_dt\n    , prime_review_dt\n    , last_pliq_amt\n    , last_pliq_dt\n    , next_pliq_dt\n    , last_iliq_dt\n    , next_iliq_dt\n    , payment_amt\n    , final_payment_amt\n    , ltd_int_paid\n    , ltd_prn_paid\n    , last_accr_amt\n    , acy_std_accr_amt\n    , lcy_std_accr_amt\n    , acy_std_accr_penalty_amt\n    , lcy_std_accr_penalty_amt\n    , acy_ltd_accr_amt\n    , lcy_ltd_accr_amt\n    , prin_overdue_days\n    , acy_prin_overdue_amt\n    , int_overdue_days\n    , acy_int_overdue_amt\n    , acy_total_overdue_amt\n    , lcy_total_overdue_amt\n    , acy_late_charge\n    , dealer_id\n    , purpose_sk\n    , industry_sk\n    , tenor_code_sk\n    , maker_sk\n    , maker_dt_stamp\n    , checker_sk\n    , checker_dt_stamp\n    , officer_sk\n    , ftp_rate\n    , actual_overdue_status_sk\n    , bil_prin_amt\n    , bil_int_amt\n    , bil_lc_amt\n    , lcy_prin_overdue_amt\n    , lcy_int_overdue_amt\n    , lcy_late_charge\n    , part_industry_sk\n    , year_base\n  FROM oracle_dwh.dwh.lnft_master\n  where __PERIOD_FILTER__\n--   \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__loan_master003"}, "model.dga_data_model.dwh__loan_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.generate_surrogate_key", "macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dwh.lnft_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily"], "meta": {}, "materialized": "insert_by_julian_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "period": "day", "timestamp_field": "tran_date", "start_date": "2020000", "stop_date": "2022359", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "dwh__loan_transaction001"], "unique_id": "model.dga_data_model.dwh__loan_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_julian_period\",\r\n    period = \"day\",\r\n    timestamp_field = \"tran_date\",\r\n    start_date = \"2020000\",\r\n    stop_date = \"2022359\")\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n      trn_ref_no\r\n    , src_ref_no\r\n    , tran_sk\r\n    , affect_code\r\n    , trn_branch_sk\r\n    , trn_time\r\n    , tran_date\r\n    , value_date\r\n    , dorc_ind\r\n    , acy_amount\r\n    , currency\r\n    , exchange_rate\r\n    , lcy_amount\r\n    , ac_branch_sk\r\n    , account_no_sk\r\n    , gl_code_sk\r\n    , charge_type\r\n    , product_sk\r\n    , acy_runing_bal\r\n    , lcy_runing_bal\r\n    , acy_oustanding_bal\r\n    , lcy_oustanding_bal\r\n    , old_od_status_sk\r\n    , new_od_status_sk\r\n    , old_ac_status\r\n    , new_ac_status\r\n    , old_interest\r\n    , new_interest\r\n    , channel\r\n    , maker_sk\r\n    , checker_sk\r\n    , description\r\n    , customer_sk\r\n    , seq_number\r\n    , channel_trn\r\n    , remark\r\n    , {{ generate_surrogate_key([   'trn_ref_no'\r\n      , 'src_ref_no'\r\n      , 'tran_sk'\r\n      , 'affect_code'\r\n      , 'trn_branch_sk'\r\n      , 'trn_time'\r\n      , 'tran_date'\r\n      , 'value_date'\r\n      , 'dorc_ind'\r\n      , 'acy_amount'\r\n      , 'currency'\r\n      , 'exchange_rate'\r\n      , 'lcy_amount'\r\n      , 'ac_branch_sk'\r\n      , 'account_no_sk'\r\n      , 'gl_code_sk'\r\n      , 'charge_type'\r\n      , 'product_sk'\r\n      , 'acy_runing_bal'\r\n      , 'lcy_runing_bal'\r\n      , 'acy_oustanding_bal'\r\n      , 'lcy_oustanding_bal'\r\n      , 'old_od_status_sk'\r\n      , 'new_od_status_sk'\r\n      , 'old_ac_status'\r\n      , 'new_ac_status'\r\n      , 'old_interest'\r\n      , 'new_interest'\r\n      , 'channel'\r\n      , 'maker_sk'\r\n      , 'checker_sk'\r\n      , 'description'\r\n      , 'customer_sk'\r\n      , 'seq_number'\r\n      , 'channel_trn'\r\n      , 'remark'\r\n      ]) }} AS surrogate_key\r\n  FROM {{ source('dwh', 'lnft_transaction') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE tran_date > (SELECT MAX(trn_date) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\dwh__loan_transaction001.sql", "original_file_path": "models\\base\\dwh__loan_transaction001.sql", "name": "dwh__loan_transaction001", "alias": "dwh__loan_transaction001", "checksum": {"name": "sha256", "checksum": "6f0b6a4273e79dc94fdb752520eeb13d9243fdbc48bac858c6cfda7abed6609a"}, "tags": ["daily"], "refs": [], "sources": [["dwh", "lnft_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\dwh__loan_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily"], "materialized": "insert_by_julian_period", "period": "day", "timestamp_field": "tran_date", "start_date": "2020000", "stop_date": "2022359"}, "created_at": 1685959752.3031466, "compiled_code": "\nWITH source AS (\n  SELECT\n      trn_ref_no\n    , src_ref_no\n    , tran_sk\n    , affect_code\n    , trn_branch_sk\n    , trn_time\n    , tran_date\n    , value_date\n    , dorc_ind\n    , acy_amount\n    , currency\n    , exchange_rate\n    , lcy_amount\n    , ac_branch_sk\n    , account_no_sk\n    , gl_code_sk\n    , charge_type\n    , product_sk\n    , acy_runing_bal\n    , lcy_runing_bal\n    , acy_oustanding_bal\n    , lcy_oustanding_bal\n    , old_od_status_sk\n    , new_od_status_sk\n    , old_ac_status\n    , new_ac_status\n    , old_interest\n    , new_interest\n    , channel\n    , maker_sk\n    , checker_sk\n    , description\n    , customer_sk\n    , seq_number\n    , channel_trn\n    , remark\n    , \n    \nlower(to_hex(md5(to_utf8(cast(coalesce(cast(trn_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(src_ref_no as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tran_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(affect_code as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_branch_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trn_time as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tran_date as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(value_date as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dorc_ind as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(acy_amount as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(exchange_rate as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lcy_amount as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ac_branch_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_no_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(gl_code_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(charge_type as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(acy_runing_bal as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lcy_runing_bal as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(acy_oustanding_bal as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lcy_oustanding_bal as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(old_od_status_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(new_od_status_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(old_ac_status as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(new_ac_status as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(old_interest as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(new_interest as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(maker_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(checker_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(description as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_sk as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(seq_number as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(channel_trn as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(remark as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) AS surrogate_key\n  FROM oracle_dwh.dwh.lnft_transaction\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.dwh__loan_transaction001"}, "model.dga_data_model.imp__eb_portfolio_mtd": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dga.thuvh3_eb_dm_luyke"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "imp__eb_portfolio_mtd"], "unique_id": "model.dga_data_model.imp__eb_portfolio_mtd", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        yearmonth\r\n        , cif\r\n        , taxcode\r\n        , brn\r\n        , vung\r\n        , snd_rbtc\r\n        , customer_name\r\n        , grade_t\r\n        , segment_level1_t\r\n        , segment_level2_t\r\n        , cap_pd\r\n        , borrowing_t\r\n        , total_credit_line_t\r\n        , industry_code_5\r\n        , name_sector\r\n        , new_approval\r\n        , on_t\r\n        , tf_t\r\n        , os_t\r\n        , da_ky_hdtd\r\n        , segment_cttd\r\n        , cif_update\r\n        , segment_2020\r\n        , segment_core\r\n    FROM {{ source('dga', 'thuvh3_eb_dm_luyke') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\imp__eb_portfolio_mtd.sql", "original_file_path": "models\\base\\imp__eb_portfolio_mtd.sql", "name": "imp__eb_portfolio_mtd", "alias": "imp__eb_portfolio_mtd", "checksum": {"name": "sha256", "checksum": "7fc08bb97cceefe91f8d0e18bff2ad1f508d5ce654caaa269dee395098c68ac0"}, "tags": [], "refs": [], "sources": [["dga", "thuvh3_eb_dm_luyke"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\imp__eb_portfolio_mtd.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "view"}, "created_at": 1685959750.3868012, "compiled_code": "\nWITH source AS (\n    SELECT\n        yearmonth\n        , cif\n        , taxcode\n        , brn\n        , vung\n        , snd_rbtc\n        , customer_name\n        , grade_t\n        , segment_level1_t\n        , segment_level2_t\n        , cap_pd\n        , borrowing_t\n        , total_credit_line_t\n        , industry_code_5\n        , name_sector\n        , new_approval\n        , on_t\n        , tf_t\n        , os_t\n        , da_ky_hdtd\n        , segment_cttd\n        , cif_update\n        , segment_2020\n        , segment_core\n    FROM oracle_dgaworkzone.dga.thuvh3_eb_dm_luyke\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.imp__eb_portfolio_mtd"}, "model.dga_data_model.imp__eb_txn_processed": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dga.anlt4_eb_txn_processed"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "imp__eb_txn_processed"], "unique_id": "model.dga_data_model.imp__eb_txn_processed", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        etl_date\r\n        , dayid\r\n        , customer_number\r\n        , account_no\r\n        , customer_fullname_locale\r\n        , division_lv2\r\n        , tax_code\r\n        , trn_ref_no\r\n        , src_ref_no\r\n        , debit_credit\r\n        , trn_date\r\n        , trn_time\r\n        , seq_number\r\n        , trn_amt\r\n        , channel\r\n        , channel_trn\r\n        , related_person\r\n        , related_account\r\n        , trf_sys\r\n        , remark\r\n        , new_bank\r\n        , company_name\r\n        , tax_code_related_person\r\n        , txn_id\r\n        , number_txn\r\n        , internal_external_final\r\n        , receiver_type\r\n        , user_id\r\n        , before_balance\r\n        , current_balance\r\n        , eqv_tramt\r\n        , acy_amount\r\n        , affect_code\r\n        , currency\r\n        , ac_branch_sk\r\n        , trn_branch_sk\r\n        , gl_code_sk\r\n        , posting_order\r\n        , status\r\n    FROM {{ source('dga', 'anlt4_eb_txn_processed') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\imp__eb_txn_processed.sql", "original_file_path": "models\\base\\imp__eb_txn_processed.sql", "name": "imp__eb_txn_processed", "alias": "imp__eb_txn_processed", "checksum": {"name": "sha256", "checksum": "6f6239b2368f93b077e115a20067c1e6bd3c8b74f29d93acb5504bb262bf7b4f"}, "tags": [], "refs": [], "sources": [["dga", "anlt4_eb_txn_processed"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\imp__eb_txn_processed.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "view"}, "created_at": 1685959750.3897998, "compiled_code": "\nWITH source AS (\n    SELECT\n        etl_date\n        , dayid\n        , customer_number\n        , account_no\n        , customer_fullname_locale\n        , division_lv2\n        , tax_code\n        , trn_ref_no\n        , src_ref_no\n        , debit_credit\n        , trn_date\n        , trn_time\n        , seq_number\n        , trn_amt\n        , channel\n        , channel_trn\n        , related_person\n        , related_account\n        , trf_sys\n        , remark\n        , new_bank\n        , company_name\n        , tax_code_related_person\n        , txn_id\n        , number_txn\n        , internal_external_final\n        , receiver_type\n        , user_id\n        , before_balance\n        , current_balance\n        , eqv_tramt\n        , acy_amount\n        , affect_code\n        , currency\n        , ac_branch_sk\n        , trn_branch_sk\n        , gl_code_sk\n        , posting_order\n        , status\n    FROM oracle_dgaworkzone.dga.anlt4_eb_txn_processed\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.imp__eb_txn_processed"}, "model.dga_data_model.landing__lc_cc_mast": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dga_ingest.lc_cc_mast"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["daily"], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "landing__lc_cc_mast"], "unique_id": "model.dga_data_model.landing__lc_cc_mast", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nSELECT \r\n    brn\r\n  , cifno\r\n  , acno\r\n  , prdcode\r\n  , card_number\r\n  , pstd\r\n  , p_beg\r\n  , p_mov_d\r\n  , p_mov_c\r\n  , p_end\r\n  , i_beg\r\n  , i_mov_d\r\n  , i_mov_c\r\n  , i_end\r\n  , f_beg\r\n  , f_mov_d\r\n  , f_mov_c\r\n  , f_end\r\n  , bucket\r\n  , status\r\n  , ymbucket\r\n  , tmbucket\r\n  , ymbucket_d\r\n  , tmbucket_d\r\n  , ydebtgrp\r\n  , tdebtgrp\r\n  , ydebtgrp_d\r\n  , tdebtgrp_d\r\n  , debtgrpcore\r\n  , matd\r\n  , ccy\r\nFROM\r\n  {{ source('dga_ingest', 'lc_cc_mast') }}\r\n{% if is_incremental() %}\r\n  WHERE pstd > (SELECT MAX(pstd) FROM {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\landing__lc_cc_mast.sql", "original_file_path": "models\\base\\landing__lc_cc_mast.sql", "name": "landing__lc_cc_mast", "alias": "landing__lc_cc_mast", "checksum": {"name": "sha256", "checksum": "43c7e8375d60dbea62208146883adb22b225b9773fa836d27bfbcc92c42649f0"}, "tags": ["daily"], "refs": [], "sources": [["dga_ingest", "lc_cc_mast"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\base.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\landing__lc_cc_mast.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "tags": ["daily"], "materialized": "incremental"}, "created_at": 1685959752.3051467, "compiled_code": "\nSELECT \n    brn\n  , cifno\n  , acno\n  , prdcode\n  , card_number\n  , pstd\n  , p_beg\n  , p_mov_d\n  , p_mov_c\n  , p_end\n  , i_beg\n  , i_mov_d\n  , i_mov_c\n  , i_end\n  , f_beg\n  , f_mov_d\n  , f_mov_c\n  , f_end\n  , bucket\n  , status\n  , ymbucket\n  , tmbucket\n  , ymbucket_d\n  , tmbucket_d\n  , ydebtgrp\n  , tdebtgrp\n  , ydebtgrp_d\n  , tdebtgrp_d\n  , debtgrpcore\n  , matd\n  , ccy\nFROM\n  oracle_ldz.dga_ingest.lc_cc_mast\n\n  WHERE pstd > (SELECT MAX(pstd) FROM \"oracle_dgaworkzone\".base.landing__lc_cc_mast)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.landing__lc_cc_mast"}, "model.dga_data_model.vision__mgt_result_balances": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.vision.mgt_result_balances"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "insert_by_range_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "timestamp_field": "date_creation", "period": "week", "year_column": "year", "start_year": "2020", "source_table": "oracle_vision.vision.mgt_result_balances", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision__mgt_result_balances"], "unique_id": "model.dga_data_model.vision__mgt_result_balances", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_range_period\",\r\n    timestamp_field = \"date_creation\",\r\n    period=\"week\",\r\n    year_column=\"year\",\r\n    start_year=\"2020\",\r\n    source_table=\"oracle_vision.vision.mgt_result_balances\"\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      year\r\n    , sequence_mr\r\n    , data_source_at\r\n    , data_source\r\n    , bal_type_nt\r\n    , bal_type\r\n    , balance_01\r\n    , balance_02\r\n    , balance_03\r\n    , balance_04\r\n    , balance_05\r\n    , balance_06\r\n    , balance_07\r\n    , balance_08\r\n    , balance_09\r\n    , balance_10\r\n    , balance_11\r\n    , balance_12\r\n    , balance_ytd\r\n    , balance_full_year\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n    , rs\r\n  FROM {{ source('vision', 'mgt_result_balances') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM {{ this }})\r\n{% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision__mgt_result_balances.sql", "original_file_path": "models\\base\\vision__mgt_result_balances.sql", "name": "vision__mgt_result_balances", "alias": "vision__mgt_result_balances", "checksum": {"name": "sha256", "checksum": "aab14c5c07189a31a8b32df35bbeb246d8f3ec5b3d4d056a7c57a77b4be174e2"}, "tags": [], "refs": [], "sources": [["vision", "mgt_result_balances"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision__mgt_result_balances.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "insert_by_range_period", "timestamp_field": "date_creation", "period": "week", "year_column": "year", "start_year": "2020", "source_table": "oracle_vision.vision.mgt_result_balances"}, "created_at": 1685959750.4008029, "compiled_code": "\nWITH source AS(\n  SELECT\n      year\n    , sequence_mr\n    , data_source_at\n    , data_source\n    , bal_type_nt\n    , bal_type\n    , balance_01\n    , balance_02\n    , balance_03\n    , balance_04\n    , balance_05\n    , balance_06\n    , balance_07\n    , balance_08\n    , balance_09\n    , balance_10\n    , balance_11\n    , balance_12\n    , balance_ytd\n    , balance_full_year\n    , internal_status\n    , date_last_modified\n    , date_creation\n    , rs\n  FROM oracle_vision.vision.mgt_result_balances\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__mgt_result_balances"}, "model.dga_data_model.vision__mgt_result_headers": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.vision.mgt_result_headers"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "insert_by_range_period", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "timestamp_field": "date_creation", "period": "week", "year_column": "year", "start_year": "2020", "source_table": "oracle_vision.vision.mgt_result_headers", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision__mgt_result_headers"], "unique_id": "model.dga_data_model.vision__mgt_result_headers", "raw_code": "{{\r\n  config(\r\n    materialized = \"insert_by_range_period\",\r\n    timestamp_field = \"date_creation\",\r\n    period=\"week\",\r\n    year_column=\"year\",\r\n    start_year=\"2020\",\r\n    source_table=\"oracle_vision.vision.mgt_result_headers\"\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      \"year\"\r\n    , sequence_mr\r\n    , data_source_at\r\n    , data_source\r\n    , country\r\n    , le_book\r\n    , customer_id\r\n    , customer_id_mgt\r\n    , gl_enrich_id\r\n    , contract_id\r\n    , office_account\r\n    , bs_gl\r\n    , pl_gl\r\n    , vision_ouc\r\n    , customer_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , account_officer\r\n    , cost_center\r\n    , currency\r\n    , mis_currency\r\n    , accrual_status_nt\r\n    , accrual_status\r\n    , credit_line\r\n    , mrl_line\r\n    , product\r\n    , gl_product\r\n    , ouc_product\r\n    , result_source_at\r\n    , result_source\r\n    , original_ouc\r\n    , record_type_nt\r\n    , record_type\r\n    , source_id_nt\r\n    , source_id\r\n    , transaction_code_group\r\n    , transaction_channel_at\r\n    , transaction_channel\r\n    , headcount_type_nt\r\n    , headcount_type\r\n    , mgt_reference\r\n    , job_group_nt\r\n    , job_group\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ source('vision', 'mgt_result_headers') }}\r\n  where __PERIOD_FILTER__\r\n  {% if is_incremental() %}\r\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM {{ this }})\r\n{% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision__mgt_result_headers.sql", "original_file_path": "models\\base\\vision__mgt_result_headers.sql", "name": "vision__mgt_result_headers", "alias": "vision__mgt_result_headers", "checksum": {"name": "sha256", "checksum": "154b98da1f8165c83f0029ac725d859d89d4db2e370b63096191da5cdf484c43"}, "tags": [], "refs": [], "sources": [["vision", "mgt_result_headers"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision__mgt_result_headers.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "insert_by_range_period", "timestamp_field": "date_creation", "period": "week", "year_column": "year", "start_year": "2020", "source_table": "oracle_vision.vision.mgt_result_headers"}, "created_at": 1685959750.4068806, "compiled_code": "\nWITH source AS(\n  SELECT\n      \"year\"\n    , sequence_mr\n    , data_source_at\n    , data_source\n    , country\n    , le_book\n    , customer_id\n    , customer_id_mgt\n    , gl_enrich_id\n    , contract_id\n    , office_account\n    , bs_gl\n    , pl_gl\n    , vision_ouc\n    , customer_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , account_officer\n    , cost_center\n    , currency\n    , mis_currency\n    , accrual_status_nt\n    , accrual_status\n    , credit_line\n    , mrl_line\n    , product\n    , gl_product\n    , ouc_product\n    , result_source_at\n    , result_source\n    , original_ouc\n    , record_type_nt\n    , record_type\n    , source_id_nt\n    , source_id\n    , transaction_code_group\n    , transaction_channel_at\n    , transaction_channel\n    , headcount_type_nt\n    , headcount_type\n    , mgt_reference\n    , job_group_nt\n    , job_group\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.mgt_result_headers\n  where __PERIOD_FILTER__\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__mgt_result_headers"}, "model.dga_data_model.bpm_vhkq__atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__atm"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__atm"], "unique_id": "model.dga_data_model.bpm_vhkq__atm", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__atm') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__atm.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__atm.sql", "name": "bpm_vhkq__atm", "alias": "bpm_vhkq__atm", "checksum": {"name": "sha256", "checksum": "7a2c4978931420d3a759743d75b3bf253266c6f7f088d1c2de62c09fe36f92e5"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__atm"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.3699355, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__atm"}, "model.dga_data_model.bpm_vhkq__atm_category_tray": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__atm_category_tray"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__atm_category_tray"], "unique_id": "model.dga_data_model.bpm_vhkq__atm_category_tray", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__atm_category_tray') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__atm_category_tray.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__atm_category_tray.sql", "name": "bpm_vhkq__atm_category_tray", "alias": "bpm_vhkq__atm_category_tray", "checksum": {"name": "sha256", "checksum": "ac02ae834397f06f575f7305cc8e5c457ff3ceb3c6291acb46f1ddfaa9a6483b"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__atm_category_tray"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__atm_category_tray.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.371979, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm_category_tray\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__atm_category_tray"}, "model.dga_data_model.bpm_vhkq__atm_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__atm_detail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__atm_detail"], "unique_id": "model.dga_data_model.bpm_vhkq__atm_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__atm_detail') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__atm_detail.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__atm_detail.sql", "name": "bpm_vhkq__atm_detail", "alias": "bpm_vhkq__atm_detail", "checksum": {"name": "sha256", "checksum": "45f0efab9a8973ec0eaac0d11d9bdc41778a1b239525ab43993115ee319da1e7"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__atm_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__atm_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.373976, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm_detail\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__atm_detail"}, "model.dga_data_model.bpm_vhkq__attachment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__attachment"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__attachment"], "unique_id": "model.dga_data_model.bpm_vhkq__attachment", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__attachment') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__attachment.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__attachment.sql", "name": "bpm_vhkq__attachment", "alias": "bpm_vhkq__attachment", "checksum": {"name": "sha256", "checksum": "ec872db028100fa6a5df4ff4718d61f766ade0c6741be13e7030526cbb00b7f6"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__attachment"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__attachment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3759758, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__attachment\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__attachment)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__attachment"}, "model.dga_data_model.bpm_vhkq__category": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__category"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__category"], "unique_id": "model.dga_data_model.bpm_vhkq__category", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__category' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n--  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__category.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__category.sql", "name": "bpm_vhkq__category", "alias": "bpm_vhkq__category", "checksum": {"name": "sha256", "checksum": "f6f1bddee4be966bf9199bef105fd2d7ba0d9907e25dbeca54668274d0dab078"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__category"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__category.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3769891, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__category\n)\nSELECT * FROM source\n\n--  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__category)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__category"}, "model.dga_data_model.bpm_vhkq__delivery": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__delivery"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__delivery"], "unique_id": "model.dga_data_model.bpm_vhkq__delivery", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__delivery') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__delivery.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__delivery.sql", "name": "bpm_vhkq__delivery", "alias": "bpm_vhkq__delivery", "checksum": {"name": "sha256", "checksum": "e08b255178bd4772ecbe6f78054b31e9d92610074508acb03aac4177334532f5"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__delivery"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__delivery.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3789823, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__delivery\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__delivery)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__delivery"}, "model.dga_data_model.bpm_vhkq__doc_no": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__doc_no"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__doc_no"], "unique_id": "model.dga_data_model.bpm_vhkq__doc_no", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__doc_no' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n--  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__doc_no.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__doc_no.sql", "name": "bpm_vhkq__doc_no", "alias": "bpm_vhkq__doc_no", "checksum": {"name": "sha256", "checksum": "aea5ea5b08dc7c35017c90fcbdf3757ef99db87d66bea0b2efba35f9880e3dba"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__doc_no"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__doc_no.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.380985, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__doc_no\n)\nSELECT * FROM source\n\n--  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__doc_no)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__doc_no"}, "model.dga_data_model.bpm_vhkq__mail_log": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__mail_log"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__mail_log"], "unique_id": "model.dga_data_model.bpm_vhkq__mail_log", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__mail_log' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n--  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__mail_log.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__mail_log.sql", "name": "bpm_vhkq__mail_log", "alias": "bpm_vhkq__mail_log", "checksum": {"name": "sha256", "checksum": "4a3002cc870ed920dd728a4fffa2735280d6a3320bbf72e6e58961239a3f9f0d"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__mail_log"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__mail_log.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3829086, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__mail_log\n)\nSELECT * FROM source\n\n--  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__mail_log)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__mail_log"}, "model.dga_data_model.bpm_vhkq__position": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__position"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__position"], "unique_id": "model.dga_data_model.bpm_vhkq__position", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__position' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n--  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__position.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__position.sql", "name": "bpm_vhkq__position", "alias": "bpm_vhkq__position", "checksum": {"name": "sha256", "checksum": "673d4158ffbac4dc50e17abcbe1943ec86cf9cb876eb25565d46ef745182b02e"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__position"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__position.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3849065, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__position\n)\nSELECT * FROM source\n\n--  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__position)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__position"}, "model.dga_data_model.bpm_vhkq__process_definition": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__process_definition"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__process_definition"], "unique_id": "model.dga_data_model.bpm_vhkq__process_definition", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__process_definition' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__process_definition.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__process_definition.sql", "name": "bpm_vhkq__process_definition", "alias": "bpm_vhkq__process_definition", "checksum": {"name": "sha256", "checksum": "7da19fae4e92ad5d4867c5b832b7640bcc0664bec7a64f319bb0fc9395b6a864"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__process_definition"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__process_definition.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.386982, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__process_definition\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__process_definition)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__process_definition"}, "model.dga_data_model.bpm_vhkq__process_instance": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__process_instance"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__process_instance"], "unique_id": "model.dga_data_model.bpm_vhkq__process_instance", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__process_instance' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__process_instance.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__process_instance.sql", "name": "bpm_vhkq__process_instance", "alias": "bpm_vhkq__process_instance", "checksum": {"name": "sha256", "checksum": "4bfc2ef5b1b673515c8774fa219159b71c9c3f2eed6262bb4e65d0ad6303b019"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__process_instance"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__process_instance.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.38794, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__process_instance\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__process_instance)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__process_instance"}, "model.dga_data_model.bpm_vhkq__process_instance_his": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__process_instance_his"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__process_instance_his"], "unique_id": "model.dga_data_model.bpm_vhkq__process_instance_his", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__process_instance_his' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__process_instance_his.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__process_instance_his.sql", "name": "bpm_vhkq__process_instance_his", "alias": "bpm_vhkq__process_instance_his", "checksum": {"name": "sha256", "checksum": "a9823332768c39964688f3e09c7630e49c435e210d8e887534060ae45b0f791c"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__process_instance_his"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__process_instance_his.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3899758, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__process_instance_his\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__process_instance_his)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__process_instance_his"}, "model.dga_data_model.bpm_vhkq__request_atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_atm"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_atm"], "unique_id": "model.dga_data_model.bpm_vhkq__request_atm", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_atm' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_atm.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_atm.sql", "name": "bpm_vhkq__request_atm", "alias": "bpm_vhkq__request_atm", "checksum": {"name": "sha256", "checksum": "49082f6a4467a3403eb4a527f6b4fe5e1fe301e2c3bf10f07f18d49fb7b5a73c"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_atm"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.391981, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_atm"}, "model.dga_data_model.bpm_vhkq__request_atm_card_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_atm_card_detail"], "unique_id": "model.dga_data_model.bpm_vhkq__request_atm_card_detail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_atm_card_detail' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_atm_card_detail.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_card_detail.sql", "name": "bpm_vhkq__request_atm_card_detail", "alias": "bpm_vhkq__request_atm_card_detail", "checksum": {"name": "sha256", "checksum": "ead260e87437dfd5226597fbbbc2b975a82b967e64629b9d94ec28c2c9059b83"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_atm_card_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_card_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3939762, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_card_detail\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_card_detail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_card_detail"}, "model.dga_data_model.bpm_vhkq__request_atm_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_atm_detail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_atm_detail"], "unique_id": "model.dga_data_model.bpm_vhkq__request_atm_detail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_atm_detail' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_atm_detail.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_detail.sql", "name": "bpm_vhkq__request_atm_detail", "alias": "bpm_vhkq__request_atm_detail", "checksum": {"name": "sha256", "checksum": "89561cece5048810e15fe84e56e90f31486f9665e8926cbaa415647cf513724c"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_atm_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3959777, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_detail\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_detail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_detail"}, "model.dga_data_model.bpm_vhkq__request_atm_tray_control": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_atm_tray_control"], "unique_id": "model.dga_data_model.bpm_vhkq__request_atm_tray_control", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_atm_tray_control' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_atm_tray_control.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_tray_control.sql", "name": "bpm_vhkq__request_atm_tray_control", "alias": "bpm_vhkq__request_atm_tray_control", "checksum": {"name": "sha256", "checksum": "e6738a9769c642b91f63dc20e6991744eed3b703af041e5195478c1bc706df23"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_atm_tray_control"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_tray_control.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.397977, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_tray_control\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_tray_control)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_tray_control"}, "model.dga_data_model.bpm_vhkq__request_atm_tray_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_atm_tray_detail"], "unique_id": "model.dga_data_model.bpm_vhkq__request_atm_tray_detail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_atm_tray_detail' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_atm_tray_detail.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_tray_detail.sql", "name": "bpm_vhkq__request_atm_tray_detail", "alias": "bpm_vhkq__request_atm_tray_detail", "checksum": {"name": "sha256", "checksum": "6bde1d24d4485ab26dd6f44c0efa8cd5645a3dc9cd9ab00f52e69b22ae56608e"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_atm_tray_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_atm_tray_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.3999166, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_tray_detail\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_tray_detail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_tray_detail"}, "model.dga_data_model.bpm_vhkq__request_branch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_branch"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_branch"], "unique_id": "model.dga_data_model.bpm_vhkq__request_branch", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_branch' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_branch.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_branch.sql", "name": "bpm_vhkq__request_branch", "alias": "bpm_vhkq__request_branch", "checksum": {"name": "sha256", "checksum": "4e80444abc2c5e0eb24ffcda922ce088c98d3ca05a4ecdb60e9e471559f3b579"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_branch"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_branch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4019773, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_branch\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_branch)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_branch"}, "model.dga_data_model.bpm_vhkq__request_branch_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__request_branch_detail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__request_branch_detail"], "unique_id": "model.dga_data_model.bpm_vhkq__request_branch_detail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__request_branch_detail' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__request_branch_detail.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__request_branch_detail.sql", "name": "bpm_vhkq__request_branch_detail", "alias": "bpm_vhkq__request_branch_detail", "checksum": {"name": "sha256", "checksum": "ebcf0f066eff91fbf5dbcdc30a63310aef918195c57b2cda3a7d7f2388fc7879"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__request_branch_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__request_branch_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4039774, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_branch_detail\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__request_branch_detail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__request_branch_detail"}, "model.dga_data_model.bpm_vhkq__skewed_threshold": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__skewed_threshold"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__skewed_threshold"], "unique_id": "model.dga_data_model.bpm_vhkq__skewed_threshold", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__skewed_threshold' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__skewed_threshold.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__skewed_threshold.sql", "name": "bpm_vhkq__skewed_threshold", "alias": "bpm_vhkq__skewed_threshold", "checksum": {"name": "sha256", "checksum": "89bfb0e0fb22c6117c39c8b1c53692e6ca72ba55bda929d123726c81f0491de7"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__skewed_threshold"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__skewed_threshold.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4059763, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__skewed_threshold\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__skewed_threshold)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__skewed_threshold"}, "model.dga_data_model.bpm_vhkq__staff": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__staff"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__staff"], "unique_id": "model.dga_data_model.bpm_vhkq__staff", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select\r\n    id,\r\n    replace(code, '''','') code,\r\n    email,\r\n    id_identity,\r\n    issued_by,\r\n    issued_date,\r\n    trim(name) as name,\r\n    position,\r\n    type,\r\n    warehouse_code,\r\n    username,\r\n    atm_group_position,\r\n    branch_name,\r\n    concurrent_position,\r\n    created_by,\r\n    decision_date,\r\n    decision_number,\r\n    from_date,\r\n    is_belong_branch,\r\n    license_plate_number,\r\n    manage_unit,\r\n    phone_number,\r\n    protection_rating,\r\n    staff_title,\r\n    status,\r\n    warehouse_name,\r\n    created_at,\r\n    updated_at\r\n  FROM {{ ref('stg_bpm_vhkq__staff') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__staff.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__staff.sql", "name": "bpm_vhkq__staff", "alias": "bpm_vhkq__staff", "checksum": {"name": "sha256", "checksum": "36791785dd6f1a94c68d1c9cca4760ba946108de9d00766da29fa7b6c5ebc3b5"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__staff"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__staff.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.406977, "compiled_code": "\nWITH source AS(\n select\n    id,\n    replace(code, '''','') code,\n    email,\n    id_identity,\n    issued_by,\n    issued_date,\n    trim(name) as name,\n    position,\n    type,\n    warehouse_code,\n    username,\n    atm_group_position,\n    branch_name,\n    concurrent_position,\n    created_by,\n    decision_date,\n    decision_number,\n    from_date,\n    is_belong_branch,\n    license_plate_number,\n    manage_unit,\n    phone_number,\n    protection_rating,\n    staff_title,\n    status,\n    warehouse_name,\n    created_at,\n    updated_at\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__staff"}, "model.dga_data_model.bpm_vhkq__staff_assignment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__staff_assignment"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__staff_assignment"], "unique_id": "model.dga_data_model.bpm_vhkq__staff_assignment", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__staff_assignment' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__staff_assignment.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__staff_assignment.sql", "name": "bpm_vhkq__staff_assignment", "alias": "bpm_vhkq__staff_assignment", "checksum": {"name": "sha256", "checksum": "a5ace97bc4da43901eba42f05225ee532b2ad91d7fe3d90051af008ad30905a4"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__staff_assignment"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__staff_assignment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4089777, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_assignment\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__staff_assignment)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__staff_assignment"}, "model.dga_data_model.bpm_vhkq__staff_request_atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__staff_request_atm"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__staff_request_atm"], "unique_id": "model.dga_data_model.bpm_vhkq__staff_request_atm", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__staff_request_atm') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__staff_request_atm.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__staff_request_atm.sql", "name": "bpm_vhkq__staff_request_atm", "alias": "bpm_vhkq__staff_request_atm", "checksum": {"name": "sha256", "checksum": "d68dda6904309ef0a19ecf9ec3e9095a3ebb9b8f83d9edf4776fb3d26c83dff0"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__staff_request_atm"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__staff_request_atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4109814, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_request_atm\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__staff_request_atm)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__staff_request_atm"}, "model.dga_data_model.bpm_vhkq__staff_request_branch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__staff_request_branch"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__staff_request_branch"], "unique_id": "model.dga_data_model.bpm_vhkq__staff_request_branch", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__staff_request_branch') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__staff_request_branch.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__staff_request_branch.sql", "name": "bpm_vhkq__staff_request_branch", "alias": "bpm_vhkq__staff_request_branch", "checksum": {"name": "sha256", "checksum": "d4aef99df505a518cf40f790f1b35101f5c93915094de746163e568602bf72ad"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__staff_request_branch"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__staff_request_branch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4129772, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_request_branch\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__staff_request_branch)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__staff_request_branch"}, "model.dga_data_model.bpm_vhkq__staff_transfer_history": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__staff_transfer_history"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__staff_transfer_history"], "unique_id": "model.dga_data_model.bpm_vhkq__staff_transfer_history", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__staff_transfer_history') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__staff_transfer_history.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__staff_transfer_history.sql", "name": "bpm_vhkq__staff_transfer_history", "alias": "bpm_vhkq__staff_transfer_history", "checksum": {"name": "sha256", "checksum": "4270716aa570cae2a526a1905511cdfa17b5057e4735147fc54f518b31a4825b"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__staff_transfer_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__staff_transfer_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.414986, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_transfer_history\n)\nSELECT * FROM source\n\n  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__staff_transfer_history)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__staff_transfer_history"}, "model.dga_data_model.bpm_vhkq__staff_tsd": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "dbt_scd_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__staff_tsd"], "unique_id": "model.dga_data_model.bpm_vhkq__staff_tsd", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'dbt_scd_id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select\r\n    id,\r\n    replace(code, '''','') code,\r\n    email,\r\n    id_identity,\r\n    issued_by,\r\n    issued_date,\r\n    initcap(lower(trim(name))) as name,\r\n    position,\r\n    type,\r\n    warehouse_code,\r\n    username,\r\n    atm_group_position,\r\n    branch_name,\r\n    concurrent_position,\r\n    created_by,\r\n    decision_date,\r\n    decision_number,\r\n    from_date,\r\n    is_belong_branch,\r\n    license_plate_number,\r\n    manage_unit,\r\n    phone_number,\r\n    protection_rating,\r\n    staff_title,\r\n    status,\r\n    warehouse_name,\r\n    created_at,\r\n    updated_at,\r\n    dbt_scd_id,\r\n    trunc(dbt_valid_from)                                      as  eff_from_date,\r\n    trunc(nvl(dbt_valid_to,TO_DATE(29990101, 'yyyymmdd')))     as  eff_to_date\r\n  FROM {{ ref('stg_bpm_vhkq__staff_tsd') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__staff_tsd.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__staff_tsd.sql", "name": "bpm_vhkq__staff_tsd", "alias": "bpm_vhkq__staff_tsd", "checksum": {"name": "sha256", "checksum": "61664394fecf47028c295ae233aebc5edbf214a13f5601e5984b558408ba51d0"}, "tags": [], "refs": [["stg_bpm_vhkq__staff_tsd"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__staff_tsd.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "materialized": "incremental", "unique_key": "dbt_scd_id", "incremental_strategy": "merge"}, "created_at": 1685959750.5537677, "compiled_code": "\nWITH source AS(\n select\n    id,\n    replace(code, '''','') code,\n    email,\n    id_identity,\n    issued_by,\n    issued_date,\n    initcap(lower(trim(name))) as name,\n    position,\n    type,\n    warehouse_code,\n    username,\n    atm_group_position,\n    branch_name,\n    concurrent_position,\n    created_by,\n    decision_date,\n    decision_number,\n    from_date,\n    is_belong_branch,\n    license_plate_number,\n    manage_unit,\n    phone_number,\n    protection_rating,\n    staff_title,\n    status,\n    warehouse_name,\n    created_at,\n    updated_at,\n    dbt_scd_id,\n    trunc(dbt_valid_from)                                      as  eff_from_date,\n    trunc(nvl(dbt_valid_to,TO_DATE(29990101, 'yyyymmdd')))     as  eff_to_date\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_tsd\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__staff_tsd"}, "model.dga_data_model.bpm_vhkq__template": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__template"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__template"], "unique_id": "model.dga_data_model.bpm_vhkq__template", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__template' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n--  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__template.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__template.sql", "name": "bpm_vhkq__template", "alias": "bpm_vhkq__template", "checksum": {"name": "sha256", "checksum": "8ed22b9f94ce78b0b128b600821d8f46b884df45d7c426726f89c41d24f35b17"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__template"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__template.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4169774, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__template\n)\nSELECT * FROM source\n\n--  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__template)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__template"}, "model.dga_data_model.bpm_vhkq__user_unit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_bpm_vhkq__user_unit"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__user_unit"], "unique_id": "model.dga_data_model.bpm_vhkq__user_unit", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__user_unit' ) }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n--  where updated_at > (select max(updated_at) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__user_unit.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__user_unit.sql", "name": "bpm_vhkq__user_unit", "alias": "bpm_vhkq__user_unit", "checksum": {"name": "sha256", "checksum": "332491857fb9eb71b2cc71330b2edf7d5365b4bc0979f7d9a85dee7356c41afc"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__user_unit"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__user_unit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.4179795, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__user_unit\n)\nSELECT * FROM source\n\n--  where updated_at > (select max(updated_at) from \"oracle_dgaworkzone\".base.bpm_vhkq__user_unit)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__user_unit"}, "model.dga_data_model.bpm_vhkq__volume": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__volume"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "execute_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__volume"], "unique_id": "model.dga_data_model.bpm_vhkq__volume", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__volume') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__volume.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__volume.sql", "name": "bpm_vhkq__volume", "alias": "bpm_vhkq__volume", "checksum": {"name": "sha256", "checksum": "46e770f5c80a8d08e8943523ef88a8e5be3779818daa9855a033aa270854200f"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__volume"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "execute_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__volume.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "execute_date"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.419978, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__volume\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__volume"}, "model.dga_data_model.bpm_vhkq__volume_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__volume_detail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "check_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__volume_detail"], "unique_id": "model.dga_data_model.bpm_vhkq__volume_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__volume_detail' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__volume_detail.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__volume_detail.sql", "name": "bpm_vhkq__volume_detail", "alias": "bpm_vhkq__volume_detail", "checksum": {"name": "sha256", "checksum": "69772bf714dc7dd9726c82c492a6628b405280dcf73dc01ac7117fe1a1c19d5b"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__volume_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "check_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__volume_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "check_date"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.422049, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__volume_detail\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__volume_detail"}, "model.dga_data_model.bpm_vhkq__warehouse": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__warehouse"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__warehouse"], "unique_id": "model.dga_data_model.bpm_vhkq__warehouse", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__warehouse' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__warehouse.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__warehouse.sql", "name": "bpm_vhkq__warehouse", "alias": "bpm_vhkq__warehouse", "checksum": {"name": "sha256", "checksum": "57948bb317cabbb2759fb942839f9098585047e58774db65bf1fae7f90f74c68"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__warehouse"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__warehouse.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.4239771, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__warehouse\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__warehouse"}, "model.dga_data_model.bpm_vhkq__warehouse_organization": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__warehouse_organization"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__warehouse_organization"], "unique_id": "model.dga_data_model.bpm_vhkq__warehouse_organization", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__warehouse_organization' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__warehouse_organization.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__warehouse_organization.sql", "name": "bpm_vhkq__warehouse_organization", "alias": "bpm_vhkq__warehouse_organization", "checksum": {"name": "sha256", "checksum": "a7a430470a201b1af07e4e70241d0ff9c1ddae898606479a93c3c76af4aa9508"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__warehouse_organization"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__warehouse_organization.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.42498, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__warehouse_organization\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__warehouse_organization"}, "model.dga_data_model.bpm_vhkq__warehouse_user": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__warehouse_user"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "bpm_vhkq", "bpm_vhkq__warehouse_user"], "unique_id": "model.dga_data_model.bpm_vhkq__warehouse_user", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select *\r\n  FROM {{ ref('stg_bpm_vhkq__warehouse_user' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\bpm_vhkq\\bpm_vhkq__warehouse_user.sql", "original_file_path": "models\\base\\bpm_vhkq\\bpm_vhkq__warehouse_user.sql", "name": "bpm_vhkq__warehouse_user", "alias": "bpm_vhkq__warehouse_user", "checksum": {"name": "sha256", "checksum": "5bb5f95fc89eeca7336d1a37cb34f221077b7d25961b82fe96e09451c7dc6a3d"}, "tags": ["vhkq_daily"], "refs": [["stg_bpm_vhkq__warehouse_user"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\bpm_vhkq\\base_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\bpm_vhkq\\bpm_vhkq__warehouse_user.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.426979, "compiled_code": "\nWITH source AS(\n select *\n  FROM \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__warehouse_user\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.bpm_vhkq__warehouse_user"}, "model.dga_data_model.landing_hist__ews_rb_cust_info": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ews_bulanding.ews_rb_cust_info @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["ews_rb_monthly"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["cuif001", "etl_date"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "ews_rb", "landing_hist__ews_rb_cust_info"], "unique_id": "model.dga_data_model.landing_hist__ews_rb_cust_info", "raw_code": "{{\r\n  config(\r\n      materialized='incremental',\r\n      unique_key = ['cuif001', 'etl_date']\r\n    )\r\n}}\r\nSELECT\r\n  cuif001\r\n, cuif002\r\n, cuif003\r\n, cuif005\r\n, cuif006\r\n, cuif010\r\n, cuif026\r\n, etl_date_ews\r\n, etl_date\r\nFROM\r\n  {{ source('ews_bulanding', 'ews_rb_cust_info @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\ews_rb\\landing_hist__ews_rb_cust_info.sql", "original_file_path": "models\\base\\ews_rb\\landing_hist__ews_rb_cust_info.sql", "name": "landing_hist__ews_rb_cust_info", "alias": "landing_hist__ews_rb_cust_info", "checksum": {"name": "sha256", "checksum": "3a3a93d03df845ff22a07c1c8102983b4002ebcaffb426463d3b746953ebd344"}, "tags": ["ews_rb_monthly"], "refs": [], "sources": [["ews_bulanding", "ews_rb_cust_info @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\ews_rb\\ews_rb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\landing_hist__ews_rb_cust_info.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "tags": "ews_rb_monthly", "materialized": "incremental", "unique_key": ["cuif001", "etl_date"]}, "created_at": 1685959752.4279778, "compiled_code": "\nSELECT\n  cuif001\n, cuif002\n, cuif003\n, cuif005\n, cuif006\n, cuif010\n, cuif026\n, etl_date_ews\n, etl_date\nFROM\n  oracle_bulanding.df_2.ews_rb_cust_info @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.landing_hist__ews_rb_cust_info"}, "model.dga_data_model.landing_hist__ews_rb_thruput_casa": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["ews_rb_monthly"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["cifno", "etl_date"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "ews_rb", "landing_hist__ews_rb_thruput_casa"], "unique_id": "model.dga_data_model.landing_hist__ews_rb_thruput_casa", "raw_code": "{{\r\n  config(\r\n      materialized='incremental',\r\n      unique_key = ['cifno', 'etl_date']\r\n    )\r\n}}\r\nSELECT\r\n  etl_date_ews\r\n, cifno\r\n, thca001\r\n, thca002\r\n, etl_date\r\n, thca027\r\nFROM\r\n  {{ source('ews_bulanding', 'ews_rb_thruput_casa @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\ews_rb\\landing_hist__ews_rb_thruput_casa.sql", "original_file_path": "models\\base\\ews_rb\\landing_hist__ews_rb_thruput_casa.sql", "name": "landing_hist__ews_rb_thruput_casa", "alias": "landing_hist__ews_rb_thruput_casa", "checksum": {"name": "sha256", "checksum": "b01c275606704ca02fc12f21ebc7a111661021bb9792b626afae86bc8a8a1333"}, "tags": ["ews_rb_monthly"], "refs": [], "sources": [["ews_bulanding", "ews_rb_thruput_casa @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\ews_rb\\ews_rb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\landing_hist__ews_rb_thruput_casa.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "tags": "ews_rb_monthly", "materialized": "incremental", "unique_key": ["cifno", "etl_date"]}, "created_at": 1685959752.4279778, "compiled_code": "\nSELECT\n  etl_date_ews\n, cifno\n, thca001\n, thca002\n, etl_date\n, thca027\nFROM\n  oracle_bulanding.df_2.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_casa"}, "model.dga_data_model.landing_hist__ews_rb_thruput_fd": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["ews_rb_monthly"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["cifno", "etl_date"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "ews_rb", "landing_hist__ews_rb_thruput_fd"], "unique_id": "model.dga_data_model.landing_hist__ews_rb_thruput_fd", "raw_code": "{{\r\n  config(\r\n      materialized='incremental',\r\n      unique_key = ['cifno', 'etl_date']\r\n    )\r\n}}\r\nSELECT\r\n  etl_date_ews\r\n, cifno\r\n, thfd001\r\n, thfd002\r\n, thfd027\r\n, etl_date\r\n, thfd029\r\nFROM\r\n  {{ source('ews_bulanding', 'ews_rb_thruput_fd @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\ews_rb\\landing_hist__ews_rb_thruput_fd.sql", "original_file_path": "models\\base\\ews_rb\\landing_hist__ews_rb_thruput_fd.sql", "name": "landing_hist__ews_rb_thruput_fd", "alias": "landing_hist__ews_rb_thruput_fd", "checksum": {"name": "sha256", "checksum": "ec0bf59874f6b8c82ce4f629a4e5df7ecea2e9710e11f039b13ee781ac575622"}, "tags": ["ews_rb_monthly"], "refs": [], "sources": [["ews_bulanding", "ews_rb_thruput_fd @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\ews_rb\\ews_rb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\landing_hist__ews_rb_thruput_fd.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "tags": "ews_rb_monthly", "materialized": "incremental", "unique_key": ["cifno", "etl_date"]}, "created_at": 1685959752.4279778, "compiled_code": "\nSELECT\n  etl_date_ews\n, cifno\n, thfd001\n, thfd002\n, thfd027\n, etl_date\n, thfd029\nFROM\n  oracle_bulanding.df_2.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_fd"}, "model.dga_data_model.landing_hist__ews_rb_thruput_in": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_in @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["ews_rb_monthly"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["cifno", "etl_date"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "ews_rb", "landing_hist__ews_rb_thruput_in"], "unique_id": "model.dga_data_model.landing_hist__ews_rb_thruput_in", "raw_code": "{{\r\n  config(\r\n      materialized='incremental',\r\n      unique_key = ['cifno', 'etl_date']\r\n    )\r\n}}\r\nSELECT\r\n  etl_date_ews\r\n, cifno\r\n, thin001\r\n, thin025\r\n, thin028\r\n, thin041\r\n, thin065\r\n, thin068\r\n, thin144\r\n, thin253\r\n, thin254\r\n, thin255\r\n, thin265\r\n, thin266\r\n, thin267\r\n, etl_date\r\n, thin111\r\nFROM\r\n  {{ source('ews_bulanding', 'ews_rb_thruput_in @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\ews_rb\\landing_hist__ews_rb_thruput_in.sql", "original_file_path": "models\\base\\ews_rb\\landing_hist__ews_rb_thruput_in.sql", "name": "landing_hist__ews_rb_thruput_in", "alias": "landing_hist__ews_rb_thruput_in", "checksum": {"name": "sha256", "checksum": "262208038f4c8b1430f528d6a5f36233c952b17fa10b37bb88a3a874cbf82338"}, "tags": ["ews_rb_monthly"], "refs": [], "sources": [["ews_bulanding", "ews_rb_thruput_in @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\ews_rb\\ews_rb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\landing_hist__ews_rb_thruput_in.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "tags": "ews_rb_monthly", "materialized": "incremental", "unique_key": ["cifno", "etl_date"]}, "created_at": 1685959752.4289782, "compiled_code": "\nSELECT\n  etl_date_ews\n, cifno\n, thin001\n, thin025\n, thin028\n, thin041\n, thin065\n, thin068\n, thin144\n, thin253\n, thin254\n, thin255\n, thin265\n, thin266\n, thin267\n, etl_date\n, thin111\nFROM\n  oracle_bulanding.df_2.ews_rb_thruput_in @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_in"}, "model.dga_data_model.landing_hist__ews_rb_thruput_out": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_out @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["ews_rb_monthly"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["cifno", "etl_date"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "ews_rb", "landing_hist__ews_rb_thruput_out"], "unique_id": "model.dga_data_model.landing_hist__ews_rb_thruput_out", "raw_code": "{{\r\n  config(\r\n      materialized='incremental',\r\n      unique_key = ['cifno', 'etl_date']\r\n    )\r\n}}\r\nSELECT\r\n  cifno\r\n, etl_date_ews\r\n, thot001\r\n, thot025\r\n, thot041\r\n, thot065\r\n, thot080\r\n, thot144\r\n, thot246\r\n, thot247\r\n, thot248\r\n, thot258\r\n, thot259\r\n, etl_date\r\nFROM\r\n  {{ source('ews_bulanding', 'ews_rb_thruput_out @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\ews_rb\\landing_hist__ews_rb_thruput_out.sql", "original_file_path": "models\\base\\ews_rb\\landing_hist__ews_rb_thruput_out.sql", "name": "landing_hist__ews_rb_thruput_out", "alias": "landing_hist__ews_rb_thruput_out", "checksum": {"name": "sha256", "checksum": "28441057c568773d7d1a4e26e32927d40d1466d26f09f4f20685376e846f082f"}, "tags": ["ews_rb_monthly"], "refs": [], "sources": [["ews_bulanding", "ews_rb_thruput_out @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\ews_rb\\ews_rb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\landing_hist__ews_rb_thruput_out.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "tags": "ews_rb_monthly", "materialized": "incremental", "unique_key": ["cifno", "etl_date"]}, "created_at": 1685959752.4289782, "compiled_code": "\nSELECT\n  cifno\n, etl_date_ews\n, thot001\n, thot025\n, thot041\n, thot065\n, thot080\n, thot144\n, thot246\n, thot247\n, thot248\n, thot258\n, thot259\n, etl_date\nFROM\n  oracle_bulanding.df_2.ews_rb_thruput_out @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_out"}, "model.dga_data_model.los__addoncarddetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__addoncarddetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "addoncarddetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__addoncarddetails"], "unique_id": "model.dga_data_model.los__addoncarddetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'addoncarddetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  addoncarddetailsid\r\n, creditcardproductid\r\n, existingcif\r\n, embossednameaddoncard\r\n, relationship\r\n, cifid\r\n, isdeleted\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\n, customcardholderphone\r\n, customcardtype\r\n, customway4code\r\n, customaddinfo1\r\n, customaddinfo2\r\n, customaddinfo3\r\n, customlimitofcard\r\nFROM {{ ref('stg_los__addoncarddetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__addoncarddetails.sql", "original_file_path": "models\\base\\los\\los__addoncarddetails.sql", "name": "los__addoncarddetails", "alias": "los__addoncarddetails", "checksum": {"name": "sha256", "checksum": "96d7a349042ce2accf7f267d0620b627342bc8f4853e8d2a72780308b36b5594"}, "tags": ["los"], "refs": [["stg_los__addoncarddetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__addoncarddetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "addoncarddetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.4519775, "compiled_code": "\nWITH source AS(\nSELECT  addoncarddetailsid\n, creditcardproductid\n, existingcif\n, embossednameaddoncard\n, relationship\n, cifid\n, isdeleted\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\n, customcardholderphone\n, customcardtype\n, customway4code\n, customaddinfo1\n, customaddinfo2\n, customaddinfo3\n, customlimitofcard\nFROM \"oracle_dgaworkzone\".staging.stg_los__addoncarddetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__addoncarddetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__addoncarddetails"}, "model.dga_data_model.los__address": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.crmuser.address"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__address"], "unique_id": "model.dga_data_model.los__address", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT\r\n  addressid\r\n  ,  bank_id\r\n  ,  lastverifieddate\r\n  ,  addresskey\r\n  ,  seasonal_flag\r\n  ,  subzip\r\n  ,  isaddressverified\r\n  ,  swift_name\r\n  ,  name_alt1\r\n  ,  corp_rep_id\r\n  ,  corp_id\r\n  ,  swift_code\r\n  ,  templateid\r\n  ,  personid\r\n  ,  orgid\r\n  ,  accountid\r\n  ,  contactid\r\n  ,  suspectid\r\n  ,  partnerid\r\n  ,  addresscategory\r\n  ,  address_line1\r\n  ,  address_line2\r\n  ,  address_line3\r\n  ,  city\r\n  ,  state\r\n  ,  zip\r\n  ,  mailstop\r\n  ,  country\r\n  ,  start_date\r\n  ,  end_date\r\n  ,  residentialstatus\r\n  ,  userfield1\r\n  ,  userfield2\r\n  ,  userfield3\r\n  ,  userfield4\r\n  ,  userfield5\r\n  ,  userdatefield1\r\n  ,  userdatefield2\r\n  ,  userfield6\r\n  ,  userfield7\r\n  ,  extensionid\r\n  ,  name\r\n  ,  salutation_code\r\n  ,  address_proof_doc_id\r\n  ,  phoneno1\r\n  ,  phoneno1localcode\r\n  ,  phoneno1citycode\r\n  ,  phoneno1countrycode\r\n  ,  phoneno2\r\n  ,  phoneno2localcode\r\n  ,  phoneno2citycode\r\n  ,  phoneno2countrycode\r\n  ,  workextension\r\n  ,  cellno\r\n  ,  cellnolocalcode\r\n  ,  cellnocitycode\r\n  ,  cellnocountrycode\r\n  ,  faxno\r\n  ,  faxnolocalcode\r\n  ,  faxnocitycode\r\n  ,  faxnocountrycode\r\n  ,  faxno2\r\n  ,  faxnolocalcode2\r\n  ,  faxnocitycode2\r\n  ,  faxnocountrycode2\r\n  ,  email\r\n  ,  pagerno\r\n  ,  pagernolocalcode\r\n  ,  pagernocitycode\r\n  ,  pagernocountrycode\r\n  ,  emailpalm\r\n  ,  url\r\n  ,  house_no\r\n  ,  premise_name\r\n  ,  building_level\r\n  ,  street_no\r\n  ,  street_name\r\n  ,  suburb\r\n  ,  locality_name\r\n  ,  town\r\n  ,  domicile\r\n  ,  telex\r\n  ,  telexlocalcode\r\n  ,  telexcitycode\r\n  ,  telexcountrycode\r\n  ,  mluserfield1\r\n  ,  mluserfield2\r\n  ,  mluserfield3\r\n  ,  mluserfield4\r\n  ,  mluserfield5\r\n  ,  mluserfield6\r\n  ,  mluserfield7\r\n  ,  mluserfield8\r\n  ,  mluserfield9\r\n  ,  mluserfield10\r\n  ,  mluserfield11\r\n  ,  mluserfield12\r\n  ,  mluserfield13\r\n  ,  mluserfield14\r\n  ,  mluserfield15\r\n  ,  mluserfield16\r\n  ,  mluserfield17\r\n  ,  mluserfield18\r\n  ,  mluserfield19\r\n  ,  mluserfield20\r\n  ,  mluserfield21\r\n  ,  mluserfield22\r\n  ,  mluserfield23\r\n  ,  mluserfield24\r\n  ,  mluserfield25\r\n  ,  mluserfield26\r\n  ,  mluserfield27\r\n  ,  mluserfield28\r\n  ,  mluserfield29\r\n  ,  mluserfield30\r\n  ,  city_code\r\n  ,  state_code\r\n  ,  country_code\r\n  ,  core_cust_id\r\n  ,  concurdetect_x\r\n  ,  preferredaddress\r\n  ,  holdmailinitiatedby\r\n  ,  holdmailflag\r\n  ,  businesscenter\r\n  ,  holdmailreason\r\n  ,  preferredformat\r\n  ,  freetextaddress\r\n  ,  freetextlabel\r\n  ,  noncustomerid\r\n  ,  is_address_proof_rcvd\r\n  ,  lastupdate_date\r\n  ,  orgkey\r\n  ,  salutation\r\n  ,  holdmailstartdate\r\n  ,  holdmailenddate\r\n  ,  addressvalidity\r\n  ,  multi_addr_same_day\r\n  ,  core_start_date\r\n  ,  core_end_date\r\n  ,  exp_def_addr_type\r\n  ,  cast(tmdate as timestamp(3)) as tmdate\r\n\r\nFROM {{ source('crmuser', 'address') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__address.sql", "original_file_path": "models\\base\\los\\los__address.sql", "name": "los__address", "alias": "los__address", "checksum": {"name": "sha256", "checksum": "4ccb883e05602498965219093b80620ea684efa8cdeb91c205b1771cd9136a8d"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "address"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__address.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "table"}, "created_at": 1685959750.593162, "compiled_code": "\nWITH source AS(\nSELECT\n  addressid\n  ,  bank_id\n  ,  lastverifieddate\n  ,  addresskey\n  ,  seasonal_flag\n  ,  subzip\n  ,  isaddressverified\n  ,  swift_name\n  ,  name_alt1\n  ,  corp_rep_id\n  ,  corp_id\n  ,  swift_code\n  ,  templateid\n  ,  personid\n  ,  orgid\n  ,  accountid\n  ,  contactid\n  ,  suspectid\n  ,  partnerid\n  ,  addresscategory\n  ,  address_line1\n  ,  address_line2\n  ,  address_line3\n  ,  city\n  ,  state\n  ,  zip\n  ,  mailstop\n  ,  country\n  ,  start_date\n  ,  end_date\n  ,  residentialstatus\n  ,  userfield1\n  ,  userfield2\n  ,  userfield3\n  ,  userfield4\n  ,  userfield5\n  ,  userdatefield1\n  ,  userdatefield2\n  ,  userfield6\n  ,  userfield7\n  ,  extensionid\n  ,  name\n  ,  salutation_code\n  ,  address_proof_doc_id\n  ,  phoneno1\n  ,  phoneno1localcode\n  ,  phoneno1citycode\n  ,  phoneno1countrycode\n  ,  phoneno2\n  ,  phoneno2localcode\n  ,  phoneno2citycode\n  ,  phoneno2countrycode\n  ,  workextension\n  ,  cellno\n  ,  cellnolocalcode\n  ,  cellnocitycode\n  ,  cellnocountrycode\n  ,  faxno\n  ,  faxnolocalcode\n  ,  faxnocitycode\n  ,  faxnocountrycode\n  ,  faxno2\n  ,  faxnolocalcode2\n  ,  faxnocitycode2\n  ,  faxnocountrycode2\n  ,  email\n  ,  pagerno\n  ,  pagernolocalcode\n  ,  pagernocitycode\n  ,  pagernocountrycode\n  ,  emailpalm\n  ,  url\n  ,  house_no\n  ,  premise_name\n  ,  building_level\n  ,  street_no\n  ,  street_name\n  ,  suburb\n  ,  locality_name\n  ,  town\n  ,  domicile\n  ,  telex\n  ,  telexlocalcode\n  ,  telexcitycode\n  ,  telexcountrycode\n  ,  mluserfield1\n  ,  mluserfield2\n  ,  mluserfield3\n  ,  mluserfield4\n  ,  mluserfield5\n  ,  mluserfield6\n  ,  mluserfield7\n  ,  mluserfield8\n  ,  mluserfield9\n  ,  mluserfield10\n  ,  mluserfield11\n  ,  mluserfield12\n  ,  mluserfield13\n  ,  mluserfield14\n  ,  mluserfield15\n  ,  mluserfield16\n  ,  mluserfield17\n  ,  mluserfield18\n  ,  mluserfield19\n  ,  mluserfield20\n  ,  mluserfield21\n  ,  mluserfield22\n  ,  mluserfield23\n  ,  mluserfield24\n  ,  mluserfield25\n  ,  mluserfield26\n  ,  mluserfield27\n  ,  mluserfield28\n  ,  mluserfield29\n  ,  mluserfield30\n  ,  city_code\n  ,  state_code\n  ,  country_code\n  ,  core_cust_id\n  ,  concurdetect_x\n  ,  preferredaddress\n  ,  holdmailinitiatedby\n  ,  holdmailflag\n  ,  businesscenter\n  ,  holdmailreason\n  ,  preferredformat\n  ,  freetextaddress\n  ,  freetextlabel\n  ,  noncustomerid\n  ,  is_address_proof_rcvd\n  ,  lastupdate_date\n  ,  orgkey\n  ,  salutation\n  ,  holdmailstartdate\n  ,  holdmailenddate\n  ,  addressvalidity\n  ,  multi_addr_same_day\n  ,  core_start_date\n  ,  core_end_date\n  ,  exp_def_addr_type\n  ,  cast(tmdate as timestamp(3)) as tmdate\n\nFROM oracle_los.crmuser.address\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__address"}, "model.dga_data_model.los__addressdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.crmuser.addressdetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__addressdetail"], "unique_id": "model.dga_data_model.los__addressdetail", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT\r\n    addressdetailid\r\n  , holdmailreason\r\n  , custsequenceno\r\n  , bccode\r\n  , addressproofrcvdind\r\n  , addressverifiedind\r\n  , holdmailinitiatedby\r\n  , crmaddressid\r\n  , holdmailflag\r\n  , addresslabel\r\n  , moduleid\r\n  , modulename\r\n  , houseno\r\n  , buildinglevel\r\n  , premisename\r\n  , streetno\r\n  , streetname\r\n  , locality\r\n  , suburb\r\n  , town\r\n  , addresstype\r\n  , residencytype\r\n  , addressline1\r\n  , addressline2\r\n  , addressline3\r\n  , city\r\n  , state\r\n  , country\r\n  , postalcode\r\n  , ispresentaddress\r\n  , residingfromdate\r\n  , residingtilldate\r\n  , deletestatus\r\n  , isstructured\r\n  , bank_id\r\n  , bodatecreated\r\n  , bocreatedby\r\n  , bodatemodified\r\n  , bomodifiedby\r\n  , concurdetect_x\r\n  , boaclid\r\n  , securityilhint\r\n  , securityiuhint\r\n  , securityglhint\r\n  , securityguhint\r\n  , holdmailfromdate\r\n  , holdmailtilldate\r\n  , ispreferred\r\n  ,  cast(tmdate as timestamp(3)) as tmdate\r\n\r\nFROM {{ source('crmuser','addressdetail')}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__addressdetail.sql", "original_file_path": "models\\base\\los\\los__addressdetail.sql", "name": "los__addressdetail", "alias": "los__addressdetail", "checksum": {"name": "sha256", "checksum": "ff1e2e207afdbf3777dc10ca8388c1883edaadecaa573086f76b63da76061749"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "addressdetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__addressdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "table"}, "created_at": 1685959750.595167, "compiled_code": "\nWITH source AS(\nSELECT\n    addressdetailid\n  , holdmailreason\n  , custsequenceno\n  , bccode\n  , addressproofrcvdind\n  , addressverifiedind\n  , holdmailinitiatedby\n  , crmaddressid\n  , holdmailflag\n  , addresslabel\n  , moduleid\n  , modulename\n  , houseno\n  , buildinglevel\n  , premisename\n  , streetno\n  , streetname\n  , locality\n  , suburb\n  , town\n  , addresstype\n  , residencytype\n  , addressline1\n  , addressline2\n  , addressline3\n  , city\n  , state\n  , country\n  , postalcode\n  , ispresentaddress\n  , residingfromdate\n  , residingtilldate\n  , deletestatus\n  , isstructured\n  , bank_id\n  , bodatecreated\n  , bocreatedby\n  , bodatemodified\n  , bomodifiedby\n  , concurdetect_x\n  , boaclid\n  , securityilhint\n  , securityiuhint\n  , securityglhint\n  , securityguhint\n  , holdmailfromdate\n  , holdmailtilldate\n  , ispreferred\n  ,  cast(tmdate as timestamp(3)) as tmdate\n\nFROM oracle_los.crmuser.addressdetail\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__addressdetail"}, "model.dga_data_model.los__agents": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__agents"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "personid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__agents"], "unique_id": "model.dga_data_model.los__agents", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'personid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  personid\r\n, channel\r\n, bhid\r\n, enablealert\r\n, home_bank_id\r\n, bcid\r\n, ccid\r\n, tlpassword\r\n, tlavailabilitystatus\r\n, loggedin_bank\r\n, acdpassword\r\n, acdrepid\r\n, location\r\n, agentavailability\r\n, supervisorid\r\n, agenttype\r\n, designation\r\n, defaultemail\r\n, thresincidents\r\n, thresoppor\r\n, sla\r\n, availstring\r\n, referencedate\r\n, wrapuptime\r\n, shiftstarttime\r\n, shiftendtime\r\n, referenceday\r\n, asgenflag\r\n, numofopeninci\r\n, numofopenoppr\r\n, primarybcgid\r\n, defaultchannel\r\n, primarygroupid\r\n, bodatecreated\r\n, numofopencamptgt\r\n, threscamptgt\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n, userfield5\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, primarysegment\r\n, primaryroleid\r\n, thresretentities\r\n, noofopenretentities\r\n, threscorpentities\r\n, noofopencorpentities\r\n, seedavailstring\r\n, dsaname\r\n, tmdate\r\nFROM {{ ref('stg_los__agents') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__agents.sql", "original_file_path": "models\\base\\los\\los__agents.sql", "name": "los__agents", "alias": "los__agents", "checksum": {"name": "sha256", "checksum": "f81d432e9009db0218584915b1d600401f78763815448e015661272ff3a93077"}, "tags": ["los"], "refs": [["stg_los__agents"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__agents.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "personid", "incremental_strategy": "merge"}, "created_at": 1685959752.4559772, "compiled_code": "\nWITH source AS(\nSELECT  personid\n, channel\n, bhid\n, enablealert\n, home_bank_id\n, bcid\n, ccid\n, tlpassword\n, tlavailabilitystatus\n, loggedin_bank\n, acdpassword\n, acdrepid\n, location\n, agentavailability\n, supervisorid\n, agenttype\n, designation\n, defaultemail\n, thresincidents\n, thresoppor\n, sla\n, availstring\n, referencedate\n, wrapuptime\n, shiftstarttime\n, shiftendtime\n, referenceday\n, asgenflag\n, numofopeninci\n, numofopenoppr\n, primarybcgid\n, defaultchannel\n, primarygroupid\n, bodatecreated\n, numofopencamptgt\n, threscamptgt\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n, userfield5\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, primarysegment\n, primaryroleid\n, thresretentities\n, noofopenretentities\n, threscorpentities\n, noofopencorpentities\n, seedavailstring\n, dsaname\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__agents\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__agents)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__agents"}, "model.dga_data_model.los__agent_entity_details": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__agent_entity_details"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "detail_record_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__agent_entity_details"], "unique_id": "model.dga_data_model.los__agent_entity_details", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'detail_record_id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  detail_record_id\r\n, personid\r\n, bank_id\r\n, primarysegment\r\n, designation\r\n, hascardreaderaccess\r\n, signaturetemplate\r\n, tlaccessflag\r\n, primaryroleid\r\n, primarygroupid\r\n, supervisorid\r\n, aut_cal_dist_id\r\n, aut_cal_dist_pwd\r\n, wrapuptime\r\n, tmdate\r\nFROM {{ ref('stg_los__agent_entity_details') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__agent_entity_details.sql", "original_file_path": "models\\base\\los\\los__agent_entity_details.sql", "name": "los__agent_entity_details", "alias": "los__agent_entity_details", "checksum": {"name": "sha256", "checksum": "714a6fd075d41243d6870cdbed3b89a0c6c2e531c69a143749c56514678ad581"}, "tags": ["los"], "refs": [["stg_los__agent_entity_details"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__agent_entity_details.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "detail_record_id", "incremental_strategy": "merge"}, "created_at": 1685959752.4539843, "compiled_code": "\nWITH source AS(\nSELECT  detail_record_id\n, personid\n, bank_id\n, primarysegment\n, designation\n, hascardreaderaccess\n, signaturetemplate\n, tlaccessflag\n, primaryroleid\n, primarygroupid\n, supervisorid\n, aut_cal_dist_id\n, aut_cal_dist_pwd\n, wrapuptime\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__agent_entity_details\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__agent_entity_details)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__agent_entity_details"}, "model.dga_data_model.los__applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__applicant"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "applicantid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicant"], "unique_id": "model.dga_data_model.los__applicant", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'applicantid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantid\r\n, immigrationstatus\r\n, totamount1\r\n, totamount2\r\n, totamount3\r\n, isdeleted\r\n, isassociated\r\n, cifid\r\n, applicationid\r\n, productid\r\n, applicanttype\r\n, relationtype\r\n, title\r\n, firstname\r\n, middlename\r\n, lastname\r\n, dob\r\n, gender\r\n, nationality\r\n, langcode\r\n, resdindicator\r\n, resdtype\r\n, custoccupation\r\n, maritalstatus\r\n, veteran\r\n, yrofschool\r\n, noofdependents\r\n, staffindicator\r\n, custsegment\r\n, subsegment\r\n, custrating\r\n, isblacklistchkdone\r\n, blacklisted\r\n, blacklistnote\r\n, blacklistreason\r\n, isneglistchkdone\r\n, negated\r\n, neglistnote\r\n, neglistreason\r\n, isdedupchkdone\r\n, dedupchknote\r\n, suspended\r\n, suspendednote\r\n, suspendedreason\r\n, status\r\n, statuscode\r\n, basecurrency\r\n, crmentitytype\r\n, minorindicator\r\n, preferredname\r\n, primaryrmi\r\n, primarysolid\r\n, staffid\r\n, nickname\r\n, shortname\r\n, turnednonresidenton\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, parentapplicationid\r\n, applicationreferencenumber\r\n, prodrefnum\r\n, networthweightage\r\n, applntdedupdecision\r\n, applntdedupdecremarks\r\n, applntblacklistdesicion\r\n, applntblacklistdesremarks\r\n, applntnegativlistdesicion\r\n, applntnegativlistdesremarks\r\n, applntkycdesicion\r\n, applntkycdesremarks\r\n, applntkycdescomments\r\n, tmdate\r\n, cntryofcitizenship\r\n, employmentstatus\r\n, foreigntaxcomments\r\n, foreigntaxrepcntry\r\n, foreigntaxreptingstatus\r\n, foreigntaxrptingdate\r\n, freecode1\r\n, freecode2\r\n, freedate1\r\n, freedate2\r\n, freetext1\r\n, freetext10\r\n, freetext2\r\n, freetext6\r\n, freetext8\r\n, grossincome\r\n, grossincomecurrency\r\n, industrytype\r\n, insiderrole\r\n, insidertobank\r\n, isforeignacctaxrepreqd\r\n, jobtitle\r\n, noofdependentchildren\r\n, taxdetdsourccifid\r\n, taxdetdsourctable\r\n, taxid\r\n, nointerection\r\n, donotemail\r\n, donotphone\r\n, nosweepstakes\r\n, notificationflags\r\nFROM {{ ref('stg_los__applicant') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicant.sql", "original_file_path": "models\\base\\los\\los__applicant.sql", "name": "los__applicant", "alias": "los__applicant", "checksum": {"name": "sha256", "checksum": "6641c26305a780d1b52c2faa5264fb683e35da47028619e00c6ed2921d5cae8e"}, "tags": ["los"], "refs": [["stg_los__applicant"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "applicantid", "incremental_strategy": "merge"}, "created_at": 1685959752.4579768, "compiled_code": "\nWITH source AS(\nSELECT  applicantid\n, immigrationstatus\n, totamount1\n, totamount2\n, totamount3\n, isdeleted\n, isassociated\n, cifid\n, applicationid\n, productid\n, applicanttype\n, relationtype\n, title\n, firstname\n, middlename\n, lastname\n, dob\n, gender\n, nationality\n, langcode\n, resdindicator\n, resdtype\n, custoccupation\n, maritalstatus\n, veteran\n, yrofschool\n, noofdependents\n, staffindicator\n, custsegment\n, subsegment\n, custrating\n, isblacklistchkdone\n, blacklisted\n, blacklistnote\n, blacklistreason\n, isneglistchkdone\n, negated\n, neglistnote\n, neglistreason\n, isdedupchkdone\n, dedupchknote\n, suspended\n, suspendednote\n, suspendedreason\n, status\n, statuscode\n, basecurrency\n, crmentitytype\n, minorindicator\n, preferredname\n, primaryrmi\n, primarysolid\n, staffid\n, nickname\n, shortname\n, turnednonresidenton\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, parentapplicationid\n, applicationreferencenumber\n, prodrefnum\n, networthweightage\n, applntdedupdecision\n, applntdedupdecremarks\n, applntblacklistdesicion\n, applntblacklistdesremarks\n, applntnegativlistdesicion\n, applntnegativlistdesremarks\n, applntkycdesicion\n, applntkycdesremarks\n, applntkycdescomments\n, tmdate\n, cntryofcitizenship\n, employmentstatus\n, foreigntaxcomments\n, foreigntaxrepcntry\n, foreigntaxreptingstatus\n, foreigntaxrptingdate\n, freecode1\n, freecode2\n, freedate1\n, freedate2\n, freetext1\n, freetext10\n, freetext2\n, freetext6\n, freetext8\n, grossincome\n, grossincomecurrency\n, industrytype\n, insiderrole\n, insidertobank\n, isforeignacctaxrepreqd\n, jobtitle\n, noofdependentchildren\n, taxdetdsourccifid\n, taxdetdsourctable\n, taxid\n, nointerection\n, donotemail\n, donotphone\n, nosweepstakes\n, notificationflags\nFROM \"oracle_dgaworkzone\".staging.stg_los__applicant\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__applicant)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicant"}, "model.dga_data_model.los__applicantaddress": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.crmuser.applicantaddress"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicantaddress"], "unique_id": "model.dga_data_model.los__applicantaddress", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT\r\n    applicantaddressid\r\n    , applicantid\r\n    , applicationid\r\n    , cifid\r\n    , isassociated\r\n    , isdeleted\r\n    , bank_id\r\n    , bodatecreated\r\n    , bocreatedby\r\n    , bodatemodified\r\n    , bomodifiedby\r\n    , concurdetect_x\r\n    , boaclid\r\n    , securityilhint\r\n    , securityiuhint\r\n    , securityglhint\r\n    , securityguhint\r\n  ,  cast(tmdate as timestamp(3)) as tmdate\r\n\r\nFROM {{ source('crmuser', 'applicantaddress')}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicantaddress.sql", "original_file_path": "models\\base\\los\\los__applicantaddress.sql", "name": "los__applicantaddress", "alias": "los__applicantaddress", "checksum": {"name": "sha256", "checksum": "afd9ceb80e6af1bd8b5b77ca2c1c80c2031967b5a70f2c52ce768a390d46ea87"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicantaddress"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicantaddress.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "table"}, "created_at": 1685959750.6150882, "compiled_code": "\nWITH source AS(\nSELECT\n    applicantaddressid\n    , applicantid\n    , applicationid\n    , cifid\n    , isassociated\n    , isdeleted\n    , bank_id\n    , bodatecreated\n    , bocreatedby\n    , bodatemodified\n    , bomodifiedby\n    , concurdetect_x\n    , boaclid\n    , securityilhint\n    , securityiuhint\n    , securityglhint\n    , securityguhint\n  ,  cast(tmdate as timestamp(3)) as tmdate\n\nFROM oracle_los.crmuser.applicantaddress\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicantaddress"}, "model.dga_data_model.los__applicantcontact": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__applicantcontact"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "applicantcontactid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicantcontact"], "unique_id": "model.dga_data_model.los__applicantcontact", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'applicantcontactid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantcontactid\r\n, applicantid\r\n, appid\r\n, cifid\r\n, prefercommlang\r\n, besttimetocontact\r\n, timezone\r\n, donotemail\r\n, donotmail\r\n, donotphone\r\n, nosweepstakes\r\n, nointerection\r\n, deleteflag\r\n, isassociated\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, prefcommchannel\r\n, prefmobilealerttype\r\n, preflocale\r\n, prefcontactnotype\r\n, prefemailidtype\r\n, crmdemographicid\r\n, preferredmobilealertno\r\n, preferredemail\r\n, preferredcontactno\r\n, psychographicid\r\n, tmdate\r\nFROM {{ ref('stg_los__applicantcontact') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicantcontact.sql", "original_file_path": "models\\base\\los\\los__applicantcontact.sql", "name": "los__applicantcontact", "alias": "los__applicantcontact", "checksum": {"name": "sha256", "checksum": "82b6dccc7efd29c397cc0753aa92f3af48693f4cc85caf5a8cdb26ed70ddcff7"}, "tags": ["los"], "refs": [["stg_los__applicantcontact"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicantcontact.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "applicantcontactid", "incremental_strategy": "merge"}, "created_at": 1685959752.4599812, "compiled_code": "\nWITH source AS(\nSELECT  applicantcontactid\n, applicantid\n, appid\n, cifid\n, prefercommlang\n, besttimetocontact\n, timezone\n, donotemail\n, donotmail\n, donotphone\n, nosweepstakes\n, nointerection\n, deleteflag\n, isassociated\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, prefcommchannel\n, prefmobilealerttype\n, preflocale\n, prefcontactnotype\n, prefemailidtype\n, crmdemographicid\n, preferredmobilealertno\n, preferredemail\n, preferredcontactno\n, psychographicid\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__applicantcontact\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__applicantcontact)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicantcontact"}, "model.dga_data_model.los__applicantcontactphnemllist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__applicantcontactphnemllist"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "applicantcontactphnemllistid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicantcontactphnemllist"], "unique_id": "model.dga_data_model.los__applicantcontactphnemllist", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'applicantcontactphnemllistid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantcontactphnemllistid\r\n, phoneoremail\r\n, phonenumlocalcode\r\n, phonenumcountrycode\r\n, phonenumcitycode\r\n, phoneemailtypevalue\r\n, dateofreq\r\n, extnsion\r\n, deletestatus\r\n, emailid\r\n, applicantcontactid\r\n, dnd\r\n, holdemailflag\r\n, holdemailinitiatedby\r\n, holdemailreason\r\n, crmphoneemailid\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\nFROM {{ ref('stg_los__applicantcontactphnemllist') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicantcontactphnemllist.sql", "original_file_path": "models\\base\\los\\los__applicantcontactphnemllist.sql", "name": "los__applicantcontactphnemllist", "alias": "los__applicantcontactphnemllist", "checksum": {"name": "sha256", "checksum": "9c24fd1ea17b1810a07fcf2f734338353bedd35757ad751c23b0bdbbed4b6dda"}, "tags": ["los"], "refs": [["stg_los__applicantcontactphnemllist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicantcontactphnemllist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "applicantcontactphnemllistid", "incremental_strategy": "merge"}, "created_at": 1685959752.4609892, "compiled_code": "\nWITH source AS(\nSELECT  applicantcontactphnemllistid\n, phoneoremail\n, phonenumlocalcode\n, phonenumcountrycode\n, phonenumcitycode\n, phoneemailtypevalue\n, dateofreq\n, extnsion\n, deletestatus\n, emailid\n, applicantcontactid\n, dnd\n, holdemailflag\n, holdemailinitiatedby\n, holdemailreason\n, crmphoneemailid\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__applicantcontactphnemllist\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__applicantcontactphnemllist)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicantcontactphnemllist"}, "model.dga_data_model.los__applicantidentitydetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__applicantidentitydetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "applicantidentitydetailid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicantidentitydetail"], "unique_id": "model.dga_data_model.los__applicantidentitydetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'applicantidentitydetailid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantidentitydetailid\r\n, doctype\r\n, documentuniqueid\r\n, placeofissue\r\n, cityofissue\r\n, stateofissue\r\n, countryofissue\r\n, docissuedt\r\n, docexpdt\r\n, idissuedorganisation\r\n, applicantid\r\n, docrmks\r\n, deletestatus\r\n, prefuniqueidind\r\n, docverifiedind\r\n, refnum\r\n, status\r\n, scanreqdind\r\n, doccode\r\n, crmdocumentid\r\n, doccodedesc\r\n, doctypedesc\r\n, bank_id\r\n, tmdate\r\nFROM {{ ref('stg_los__applicantidentitydetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicantidentitydetail.sql", "original_file_path": "models\\base\\los\\los__applicantidentitydetail.sql", "name": "los__applicantidentitydetail", "alias": "los__applicantidentitydetail", "checksum": {"name": "sha256", "checksum": "6e40dfc202c3de29f3ea4774c40494217a12d24bfbffd0f74d5d7aa33f9f88f7"}, "tags": ["los"], "refs": [["stg_los__applicantidentitydetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicantidentitydetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "applicantidentitydetailid", "incremental_strategy": "merge"}, "created_at": 1685959752.4629784, "compiled_code": "\nWITH source AS(\nSELECT  applicantidentitydetailid\n, doctype\n, documentuniqueid\n, placeofissue\n, cityofissue\n, stateofissue\n, countryofissue\n, docissuedt\n, docexpdt\n, idissuedorganisation\n, applicantid\n, docrmks\n, deletestatus\n, prefuniqueidind\n, docverifiedind\n, refnum\n, status\n, scanreqdind\n, doccode\n, crmdocumentid\n, doccodedesc\n, doctypedesc\n, bank_id\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__applicantidentitydetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__applicantidentitydetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicantidentitydetail"}, "model.dga_data_model.los__applicantmiscdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__applicantmiscdetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "applicantmiscdetailid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicantmiscdetail"], "unique_id": "model.dga_data_model.los__applicantmiscdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'applicantmiscdetailid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantmiscdetailid\r\n, dateandtime\r\n, applicantsequenceno\r\n, disclosureconsent\r\n, disclosurecontextid\r\n, disclosurecontexttype\r\n, disclosuredateandtime\r\n, disclosureid\r\n, disclosureversion\r\n, ipaddress\r\n, isdeleted\r\n, isassociated\r\n, cifid\r\n, applicationid\r\n, isprintacstmt\r\n, isprintdepnotice\r\n, isexcldcombstmt\r\n, isprintacstndordr\r\n, isprintloannotice\r\n, isconsentreceived\r\n, oralconsrecdate\r\n, writtenconsrecdate\r\n, applicantid\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, receiveelecdiscl\r\n, ethnicity\r\n, color\r\n, nationalorigin\r\n, insidertobank\r\n, insiderrole\r\n, religion\r\n, dispatchmode\r\n, esign_consent_date\r\n, esign_consent_type\r\n, tmdate\r\n, referenceaddress1\r\n, referenceaddress2\r\n, referencename1\r\n, referencename2\r\n, referencephonenumber1\r\n, referencephonenumber2\r\n, referencerelationshiptype1\r\n, referencerelationshiptype2\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\nFROM {{ ref('stg_los__applicantmiscdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicantmiscdetail.sql", "original_file_path": "models\\base\\los\\los__applicantmiscdetail.sql", "name": "los__applicantmiscdetail", "alias": "los__applicantmiscdetail", "checksum": {"name": "sha256", "checksum": "5999732789e6474c768381d06bb5bbcd33c6d441b2ce7c59c57a3112edd9cbf4"}, "tags": ["los"], "refs": [["stg_los__applicantmiscdetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicantmiscdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "applicantmiscdetailid", "incremental_strategy": "merge"}, "created_at": 1685959752.4649796, "compiled_code": "\nWITH source AS(\nSELECT  applicantmiscdetailid\n, dateandtime\n, applicantsequenceno\n, disclosureconsent\n, disclosurecontextid\n, disclosurecontexttype\n, disclosuredateandtime\n, disclosureid\n, disclosureversion\n, ipaddress\n, isdeleted\n, isassociated\n, cifid\n, applicationid\n, isprintacstmt\n, isprintdepnotice\n, isexcldcombstmt\n, isprintacstndordr\n, isprintloannotice\n, isconsentreceived\n, oralconsrecdate\n, writtenconsrecdate\n, applicantid\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, receiveelecdiscl\n, ethnicity\n, color\n, nationalorigin\n, insidertobank\n, insiderrole\n, religion\n, dispatchmode\n, esign_consent_date\n, esign_consent_type\n, tmdate\n, referenceaddress1\n, referenceaddress2\n, referencename1\n, referencename2\n, referencephonenumber1\n, referencephonenumber2\n, referencerelationshiptype1\n, referencerelationshiptype2\n, freetext1\n, freetext2\n, freetext3\n, freetext4\n, freetext5\nFROM \"oracle_dgaworkzone\".staging.stg_los__applicantmiscdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__applicantmiscdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicantmiscdetail"}, "model.dga_data_model.los__applicationdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__applicationdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "applicationdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__applicationdetails"], "unique_id": "model.dga_data_model.los__applicationdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'applicationdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicationdetailsid\r\n, recompeligibility\r\n, fileclosereason\r\n, filecloseremarks\r\n, filecloseresult\r\n, reason\r\n, appldetailssequenceno\r\n, rejectremarks\r\n, productcategory\r\n, productsubcategory\r\n, productclassification\r\n, producttype\r\n, productcode\r\n, productname\r\n, currency\r\n, applrecieveddate\r\n, applreferenceno\r\n, isqualified\r\n, applicationstatus\r\n, frontendratio\r\n, backendratio\r\n, approach\r\n, applicationstage\r\n, agencyrefno\r\n, opportunityid\r\n, completedsteps\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isdeleted\r\n, purposeofloan\r\n, applicationno\r\n, accountnumber\r\n, accountname\r\n, parentapplicationid\r\n, amountrequested\r\n, tenorrequestedmm\r\n, tenorrequesteddd\r\n, intraterequested\r\n, ismandatory\r\n, isproductrejected\r\n, applrejectedstage\r\n, remarks\r\n, applicationstep\r\n, userenteligibleamt\r\n, preapprovedcode\r\n, preapprovedloan\r\n, underwriterid\r\n, underwritername\r\n, interimstatus\r\n, transactiontype\r\n, applicationtype\r\n, syseligibleamt\r\n, enrichmentstatus\r\n, eligibilitystatus\r\n, disposition\r\n, networthweightage\r\n, osproductid\r\n, amountrequestedccy\r\n, cancelremark\r\n, cancelreason\r\n, interest\r\n, apy\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\n, freetext6\r\n, freetext7\r\n, freetext8\r\n, freetext9\r\n, freetext10\r\n, freedate1\r\n, freedate2\r\n, stepduedate\r\n, appduedate\r\n, tmdate\r\n, processflag\r\n, rank() over(partition by applicationdetailsid order by tmdate desc ) rank_id\r\nFROM {{ ref('stg_los__applicationdetails') }}\r\n)\r\nSELECT * FROM source\r\nwhere rank_id = 1\r\n{% if is_incremental() %}\r\n  and tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__applicationdetails.sql", "original_file_path": "models\\base\\los\\los__applicationdetails.sql", "name": "los__applicationdetails", "alias": "los__applicationdetails", "checksum": {"name": "sha256", "checksum": "2e60ad6975d15e70c8bdcb14d9c2f5f701e521b4e4accd44f9d5421b0a03a6b3"}, "tags": ["los"], "refs": [["stg_los__applicationdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__applicationdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "applicationdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.4669807, "compiled_code": "\nWITH source AS(\nSELECT  applicationdetailsid\n, recompeligibility\n, fileclosereason\n, filecloseremarks\n, filecloseresult\n, reason\n, appldetailssequenceno\n, rejectremarks\n, productcategory\n, productsubcategory\n, productclassification\n, producttype\n, productcode\n, productname\n, currency\n, applrecieveddate\n, applreferenceno\n, isqualified\n, applicationstatus\n, frontendratio\n, backendratio\n, approach\n, applicationstage\n, agencyrefno\n, opportunityid\n, completedsteps\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isdeleted\n, purposeofloan\n, applicationno\n, accountnumber\n, accountname\n, parentapplicationid\n, amountrequested\n, tenorrequestedmm\n, tenorrequesteddd\n, intraterequested\n, ismandatory\n, isproductrejected\n, applrejectedstage\n, remarks\n, applicationstep\n, userenteligibleamt\n, preapprovedcode\n, preapprovedloan\n, underwriterid\n, underwritername\n, interimstatus\n, transactiontype\n, applicationtype\n, syseligibleamt\n, enrichmentstatus\n, eligibilitystatus\n, disposition\n, networthweightage\n, osproductid\n, amountrequestedccy\n, cancelremark\n, cancelreason\n, interest\n, apy\n, freetext1\n, freetext2\n, freetext3\n, freetext4\n, freetext5\n, freetext6\n, freetext7\n, freetext8\n, freetext9\n, freetext10\n, freedate1\n, freedate2\n, stepduedate\n, appduedate\n, tmdate\n, processflag\n, rank() over(partition by applicationdetailsid order by tmdate desc ) rank_id\nFROM \"oracle_dgaworkzone\".staging.stg_los__applicationdetails\n)\nSELECT * FROM source\nwhere rank_id = 1\n\n  and tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__applicationdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__applicationdetails"}, "model.dga_data_model.los__appraisal_custom": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_los__appraisal_custom"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "appraisalcustid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__appraisal_custom"], "unique_id": "model.dga_data_model.los__appraisal_custom", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'appraisalcustid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicationid\r\n, appraisalcustid\r\n, isdeleted\r\n, opportunityid\r\n, amtountratiofld\r\n, appraisalcode\r\n, associationid\r\n, remarks\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\n, freeint1\r\n, freeint2\r\n, freeint3\r\n, freeint4\r\n, freeamount1\r\n, freeamount2\r\n, freeamount3\r\n, freeamount4\r\nFROM {{ ref('stg_los__appraisal_custom') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__appraisal_custom.sql", "original_file_path": "models\\base\\los\\los__appraisal_custom.sql", "name": "los__appraisal_custom", "alias": "los__appraisal_custom", "checksum": {"name": "sha256", "checksum": "eb75b8703b9c95a5ebfed0ce3e940776ae0629357a431152d9736c2bf574fed9"}, "tags": ["los"], "refs": [["stg_los__appraisal_custom"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__appraisal_custom.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental", "unique_key": "appraisalcustid", "incremental_strategy": "merge"}, "created_at": 1685959752.4689896, "compiled_code": "\nWITH source AS(\nSELECT  applicationid\n, appraisalcustid\n, isdeleted\n, opportunityid\n, amtountratiofld\n, appraisalcode\n, associationid\n, remarks\n, freetext1\n, freetext2\n, freetext3\n, freetext4\n, freetext5\n, freeint1\n, freeint2\n, freeint3\n, freeint4\n, freeamount1\n, freeamount2\n, freeamount3\n, freeamount4\nFROM \"oracle_dgaworkzone\".staging.stg_los__appraisal_custom\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__appraisal_custom"}, "model.dga_data_model.los__areas": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__areas"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "bodatemodified"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "areasid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__areas"], "unique_id": "model.dga_data_model.los__areas", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'areasid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  areasid\r\n, code\r\n, name\r\n, isdeleted\r\n, freetext1\r\n, freetext2\r\n, bodatemodified\r\n, modifiedby\r\n, bodatecreated\r\n, createdby\r\nFROM {{ ref('stg_los__areas') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where bodatemodified > (select max(bodatemodified) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__areas.sql", "original_file_path": "models\\base\\los\\los__areas.sql", "name": "los__areas", "alias": "los__areas", "checksum": {"name": "sha256", "checksum": "dadb1e26dfd221317c31d97e33d5cd1c4cccf31b69afa87ee1214ee3c0d10789"}, "tags": ["los"], "refs": [["stg_los__areas"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "bodatemodified"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__areas.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "bodatemodified"}, "tags": ["los"], "materialized": "incremental", "unique_key": "areasid", "incremental_strategy": "merge"}, "created_at": 1685959752.470977, "compiled_code": "\nWITH source AS(\nSELECT  areasid\n, code\n, name\n, isdeleted\n, freetext1\n, freetext2\n, bodatemodified\n, modifiedby\n, bodatecreated\n, createdby\nFROM \"oracle_dgaworkzone\".staging.stg_los__areas\n)\nSELECT * FROM source\n\n  where bodatemodified > (select max(bodatemodified) from \"oracle_dgaworkzone\".base.los__areas)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__areas"}, "model.dga_data_model.los__bizcenter": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__bizcenter"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "bcid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__bizcenter"], "unique_id": "model.dga_data_model.los__bizcenter", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'bcid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  bcid\r\n, bcname\r\n, bccode\r\n, bctypeid\r\n, isactive\r\n, region\r\n, manager\r\n, timezone\r\n, houseno\r\n, premisename\r\n, buildinglevel\r\n, streetno\r\n, suburb\r\n, streetname\r\n, locality\r\n, town\r\n, email\r\n, mailstop\r\n, city\r\n, state\r\n, zip\r\n, country\r\n, phone\r\n, fax\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n, userdatefield1\r\n, userdatefield2\r\n, useramtfield1\r\n, useramtfield2\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\nFROM {{ ref('stg_los__bizcenter') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__bizcenter.sql", "original_file_path": "models\\base\\los\\los__bizcenter.sql", "name": "los__bizcenter", "alias": "los__bizcenter", "checksum": {"name": "sha256", "checksum": "cd3204e01f9f3ce63b6ee7793ff205ae8ecd03516abfbec113d7f75a838dd443"}, "tags": ["los"], "refs": [["stg_los__bizcenter"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__bizcenter.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "bcid", "incremental_strategy": "merge"}, "created_at": 1685959752.4719799, "compiled_code": "\nWITH source AS(\nSELECT  bcid\n, bcname\n, bccode\n, bctypeid\n, isactive\n, region\n, manager\n, timezone\n, houseno\n, premisename\n, buildinglevel\n, streetno\n, suburb\n, streetname\n, locality\n, town\n, email\n, mailstop\n, city\n, state\n, zip\n, country\n, phone\n, fax\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n, userdatefield1\n, userdatefield2\n, useramtfield1\n, useramtfield2\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__bizcenter\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__bizcenter)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__bizcenter"}, "model.dga_data_model.los__categories": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__categories"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "categoryid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__categories"], "unique_id": "model.dga_data_model.los__categories", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'categoryid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  categoryid\r\n, bank_id\r\n, remarks\r\n, categorycode\r\n, categorytype\r\n, value\r\n, allowmodify\r\n, rating\r\n, ratingtype\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, del_flg\r\n, tmdate\r\nFROM {{ ref('stg_los__categories') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__categories.sql", "original_file_path": "models\\base\\los\\los__categories.sql", "name": "los__categories", "alias": "los__categories", "checksum": {"name": "sha256", "checksum": "99de99d9be59af9c7905907e6e32c584c1f6d126e51f37102008eb600b3a960f"}, "tags": ["los"], "refs": [["stg_los__categories"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__categories.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "categoryid", "incremental_strategy": "merge"}, "created_at": 1685959752.4739766, "compiled_code": "\nWITH source AS(\nSELECT  categoryid\n, bank_id\n, remarks\n, categorycode\n, categorytype\n, value\n, allowmodify\n, rating\n, ratingtype\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, del_flg\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__categories\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__categories)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__categories"}, "model.dga_data_model.los__category_lang": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__category_lang"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "categorylangid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__category_lang"], "unique_id": "model.dga_data_model.los__category_lang", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'categorylangid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT categorylangid\r\n, bank_id\r\n, categoryid\r\n, localecode\r\n, localetext\r\n, cmlabelcode\r\n, isexceeded\r\n, tmdate\r\nFROM {{ ref('stg_los__category_lang') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__category_lang.sql", "original_file_path": "models\\base\\los\\los__category_lang.sql", "name": "los__category_lang", "alias": "los__category_lang", "checksum": {"name": "sha256", "checksum": "06dee204751fdc0167d15fe8e9a25073204819f0dbcb81b42ff53b096082872b"}, "tags": ["los"], "refs": [["stg_los__category_lang"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__category_lang.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "categorylangid", "incremental_strategy": "merge"}, "created_at": 1685959752.475978, "compiled_code": "\nWITH source AS(\nSELECT categorylangid\n, bank_id\n, categoryid\n, localecode\n, localetext\n, cmlabelcode\n, isexceeded\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__category_lang\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__category_lang)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__category_lang"}, "model.dga_data_model.los__closroutingdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__closroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "closroutingdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__closroutingdetails"], "unique_id": "model.dga_data_model.los__closroutingdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'closroutingdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  closroutingdetailsid\r\n, loginid\r\n, bank_id\r\n, useractiontrayid\r\n, assignedby\r\n, assignedto\r\n, ownerid\r\n, routetostep\r\n, routingreasoncode\r\n, routingcomments\r\n, timestatus\r\n, compliancestatus\r\n, waiverstatus\r\n, userfield1\r\n, userfield2\r\n, userflag1\r\n, userflag2\r\n, routingdate\r\n, routingtime\r\n, applcomments\r\n, stepid\r\n, tmdate\r\n, stepslahours\r\n, steptathours\r\n, stepduedate\r\nFROM {{ ref('stg_los__closroutingdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__closroutingdetails.sql", "original_file_path": "models\\base\\los\\los__closroutingdetails.sql", "name": "los__closroutingdetails", "alias": "los__closroutingdetails", "checksum": {"name": "sha256", "checksum": "245799a3f6670700ba199dcb4c5fe994290eec91a06629da875f985aedf7bef1"}, "tags": ["los"], "refs": [["stg_los__closroutingdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__closroutingdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "closroutingdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.4779775, "compiled_code": "\nWITH source AS(\nSELECT  closroutingdetailsid\n, loginid\n, bank_id\n, useractiontrayid\n, assignedby\n, assignedto\n, ownerid\n, routetostep\n, routingreasoncode\n, routingcomments\n, timestatus\n, compliancestatus\n, waiverstatus\n, userfield1\n, userfield2\n, userflag1\n, userflag2\n, routingdate\n, routingtime\n, applcomments\n, stepid\n, tmdate\n, stepslahours\n, steptathours\n, stepduedate\nFROM \"oracle_dgaworkzone\".staging.stg_los__closroutingdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__closroutingdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__closroutingdetails"}, "model.dga_data_model.los__collateralgeneraldetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__collateralgeneraldetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "collateralgeneraldetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__collateralgeneraldetails"], "unique_id": "model.dga_data_model.los__collateralgeneraldetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'collateralgeneraldetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  collateralgeneraldetailsid\r\n, actualdateofvaluation\r\n, collateralgenseqno\r\n, nextdateofvaluation\r\n, remarks\r\n, thirdpartylienvalue\r\n, valuationagency\r\n, valuemarker\r\n, grosscollateralvalue\r\n, lastvaluationdate\r\n, marginpercnt\r\n, collateralvalue\r\n, ceilinglimit\r\n, collateralid\r\n, collateralcode\r\n, collateralstatus\r\n, collateraltype\r\n, collateralvaluebeforelien\r\n, description\r\n, existingyn\r\n, frequency\r\n, isinno\r\n, unitvalue\r\n, currency\r\n, apportioningmethod\r\n, restrictedvalue\r\n, collateralreferenceno\r\n, bookingstatus\r\n, accessowneragent\r\n, accessassigneeagent\r\n, accessownerbc\r\n, accessownersegment\r\n, accessownergroup\r\n, accountfeesdr\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, iscollateraladded\r\n, collateralvaluemodifyflag\r\n, tmdate\r\n, customcollateralname\r\n, customcollateraltype\r\n, customdescription\r\n, custommortgagetype\r\n, customcollateralofficer\r\n, customtitlenoprefix\r\n, custommodeldescription\r\n, customagreementstartdate\r\n, customagreemenetenddate\r\n, customcountryofregistration\r\n, custombgbankname\r\n, customdescriptionofextra\r\n, customregistrationnumber\r\n, customregofownerplace\r\n, customsecuredtrnxregplace\r\n, custombgstartdate\r\n, custombgenddate\r\n, customsecredtrnxregdate6\r\n, customyearofmanuf\r\n, customexternalorappraisaldate\r\n, customdepositexpirationdate\r\n, customitemtype\r\n, customgoldcode\r\n, custompurchasereceiptno\r\n, customlogbookno\r\n, customenginenumber\r\n, customchassisnumber\r\n, customnewusedrecond\r\n, custommodelnumber\r\n, customregisteredownername\r\n, customroadtaxexpirydate\r\n, customplaceofnotarypublic\r\n, customremarks\r\n, customregisterdate\r\n, customremarksvaluation\r\n, custommsbaccount\r\n, customdeposittenor\r\n, customdeposittenordays\r\n, customcollateralcodeccy\r\n, custominterestrate\r\n, customissuinginstitution\r\n, customissuedate\r\n, customregofownerrightdate6\r\n, customexternalorappraisername\r\n, customregofownernumber\r\n, customofficialvaluation\r\n, customvaluationdate\r\n, customkeyid\r\n, customcontactname\r\n, customcontactno\r\n, customalternatecontactno\r\n, customcollat4qsubtype\r\n, customlandcategory\r\n, customnotarydate\r\n, customprojectcode\r\n, customvaluationreport\r\n, customvaluationexpdate\r\n, customcollateralbranch\r\n, custommaintbranch\r\n, custompowerattno\r\n, custompowerattplace\r\n, customissuebranch\r\n, custompowerattdate\r\n, customstr1\r\n, customstr2\r\n, customstr3\r\n, customstr4\r\n, customusrdate1\r\n, customusrdate2\r\n, customusrdate3\r\n, customofficialvaluer\r\n, customvaluername\r\n, customcountrycode\r\n, customrelationship\r\n, custompurchaseprice\r\n, customappraisalvalue\r\n, customguarantoramount\r\n, customforcesalevalue\r\n, custombranch\r\n, customregisteredownercif\r\n, customextradesc\r\nFROM {{ ref('stg_los__collateralgeneraldetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__collateralgeneraldetails.sql", "original_file_path": "models\\base\\los\\los__collateralgeneraldetails.sql", "name": "los__collateralgeneraldetails", "alias": "los__collateralgeneraldetails", "checksum": {"name": "sha256", "checksum": "252e8b1019aa030c967704d1a78eb6f3f345cfec4581b86bcb21333c4fc1b28b"}, "tags": ["los"], "refs": [["stg_los__collateralgeneraldetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__collateralgeneraldetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "collateralgeneraldetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.530979, "compiled_code": "\nWITH source AS(\nSELECT  collateralgeneraldetailsid\n, actualdateofvaluation\n, collateralgenseqno\n, nextdateofvaluation\n, remarks\n, thirdpartylienvalue\n, valuationagency\n, valuemarker\n, grosscollateralvalue\n, lastvaluationdate\n, marginpercnt\n, collateralvalue\n, ceilinglimit\n, collateralid\n, collateralcode\n, collateralstatus\n, collateraltype\n, collateralvaluebeforelien\n, description\n, existingyn\n, frequency\n, isinno\n, unitvalue\n, currency\n, apportioningmethod\n, restrictedvalue\n, collateralreferenceno\n, bookingstatus\n, accessowneragent\n, accessassigneeagent\n, accessownerbc\n, accessownersegment\n, accessownergroup\n, accountfeesdr\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, iscollateraladded\n, collateralvaluemodifyflag\n, tmdate\n, customcollateralname\n, customcollateraltype\n, customdescription\n, custommortgagetype\n, customcollateralofficer\n, customtitlenoprefix\n, custommodeldescription\n, customagreementstartdate\n, customagreemenetenddate\n, customcountryofregistration\n, custombgbankname\n, customdescriptionofextra\n, customregistrationnumber\n, customregofownerplace\n, customsecuredtrnxregplace\n, custombgstartdate\n, custombgenddate\n, customsecredtrnxregdate6\n, customyearofmanuf\n, customexternalorappraisaldate\n, customdepositexpirationdate\n, customitemtype\n, customgoldcode\n, custompurchasereceiptno\n, customlogbookno\n, customenginenumber\n, customchassisnumber\n, customnewusedrecond\n, custommodelnumber\n, customregisteredownername\n, customroadtaxexpirydate\n, customplaceofnotarypublic\n, customremarks\n, customregisterdate\n, customremarksvaluation\n, custommsbaccount\n, customdeposittenor\n, customdeposittenordays\n, customcollateralcodeccy\n, custominterestrate\n, customissuinginstitution\n, customissuedate\n, customregofownerrightdate6\n, customexternalorappraisername\n, customregofownernumber\n, customofficialvaluation\n, customvaluationdate\n, customkeyid\n, customcontactname\n, customcontactno\n, customalternatecontactno\n, customcollat4qsubtype\n, customlandcategory\n, customnotarydate\n, customprojectcode\n, customvaluationreport\n, customvaluationexpdate\n, customcollateralbranch\n, custommaintbranch\n, custompowerattno\n, custompowerattplace\n, customissuebranch\n, custompowerattdate\n, customstr1\n, customstr2\n, customstr3\n, customstr4\n, customusrdate1\n, customusrdate2\n, customusrdate3\n, customofficialvaluer\n, customvaluername\n, customcountrycode\n, customrelationship\n, custompurchaseprice\n, customappraisalvalue\n, customguarantoramount\n, customforcesalevalue\n, custombranch\n, customregisteredownercif\n, customextradesc\nFROM \"oracle_dgaworkzone\".staging.stg_los__collateralgeneraldetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__collateralgeneraldetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__collateralgeneraldetails"}, "model.dga_data_model.los__collaterallinkage": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__collaterallinkage"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "collaterallinkageid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__collaterallinkage"], "unique_id": "model.dga_data_model.los__collaterallinkage", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'collaterallinkageid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT \tcollaterallinkageid\r\n\t,  collateralgenseqno\r\n\t,  \"PRIMARY\"\r\n\t,  prodrefsequenceno\r\n\t,  collateralgeneraldetailsid\r\n\t,  marginpercnt\r\n\t,  apportionedvalue\r\n\t,  associatedto\r\n\t,  limitrefno\r\n\t,  productrefno\r\n\t,  valuationrequired\r\n\t,  totalapportionedvalue\r\n\t,  applicationrefno\r\n\t,  availablevalue\r\n\t,  isdeleted\r\n\t,  applicationtype\r\n\t,  linkage\r\n\t,  islinkedtocore\r\n\t,  apportionedpercnt\r\n\t,  applicationid\r\n\t,  bank_id\r\n\t,  bodatecreated\r\n\t,  bocreatedby\r\n\t,  bodatemodified\r\n\t,  bomodifiedby\r\n\t,  concurdetect_x\r\n\t,  boaclid\r\n\t,  securityilhint\r\n\t,  securityiuhint\r\n\t,  securityglhint\r\n\t,  securityguhint\r\n\t,  tmdate\r\n\t,  custommaxcovvalue\r\n\t,  maxcovperc\r\nFROM\r\n{{ ref('stg_los__collaterallinkage') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__collaterallinkage.sql", "original_file_path": "models\\base\\los\\los__collaterallinkage.sql", "name": "los__collaterallinkage", "alias": "los__collaterallinkage", "checksum": {"name": "sha256", "checksum": "691237ab20cf26a950bcb7260e1c278ce695f31c0bd6fda06a0f971e2f2bad24"}, "tags": ["los"], "refs": [["stg_los__collaterallinkage"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__collaterallinkage.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "incremental", "unique_key": "collaterallinkageid", "incremental_strategy": "merge"}, "created_at": 1685959750.673169, "compiled_code": "\nWITH source AS(\nSELECT \tcollaterallinkageid\n\t,  collateralgenseqno\n\t,  \"PRIMARY\"\n\t,  prodrefsequenceno\n\t,  collateralgeneraldetailsid\n\t,  marginpercnt\n\t,  apportionedvalue\n\t,  associatedto\n\t,  limitrefno\n\t,  productrefno\n\t,  valuationrequired\n\t,  totalapportionedvalue\n\t,  applicationrefno\n\t,  availablevalue\n\t,  isdeleted\n\t,  applicationtype\n\t,  linkage\n\t,  islinkedtocore\n\t,  apportionedpercnt\n\t,  applicationid\n\t,  bank_id\n\t,  bodatecreated\n\t,  bocreatedby\n\t,  bodatemodified\n\t,  bomodifiedby\n\t,  concurdetect_x\n\t,  boaclid\n\t,  securityilhint\n\t,  securityiuhint\n\t,  securityglhint\n\t,  securityguhint\n\t,  tmdate\n\t,  custommaxcovvalue\n\t,  maxcovperc\nFROM\n\"oracle_dgaworkzone\".staging.stg_los__collaterallinkage\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__collaterallinkage)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__collaterallinkage"}, "model.dga_data_model.los__corpappentitydetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__corpappentitydetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "corpappentitydetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__corpappentitydetails"], "unique_id": "model.dga_data_model.los__corpappentitydetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'corpappentitydetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpappentitydetailsid\r\n, entityname\r\n, snapshot\r\n, overrideriskgrade\r\n, overrideriskreasoncode\r\n, corpapplicationdetailsid\r\n, entityid\r\n, entitytype\r\n, overriddendate\r\n, overriddenby\r\n, watchlistflg\r\n, strictreportmarkflg\r\n, reviewingteam\r\n, proposedriskgrade\r\n, existingriskgrade\r\n, incorpdate\r\n, relshipstdate\r\n, existingexposure\r\n, parentgroupid\r\n, entitysubtype\r\n, proposedexposure\r\n, changeinexposure\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\n, corpapplicantrefno\r\n, isentitybooked\r\nFROM {{ ref('stg_los__corpappentitydetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__corpappentitydetails.sql", "original_file_path": "models\\base\\los\\los__corpappentitydetails.sql", "name": "los__corpappentitydetails", "alias": "los__corpappentitydetails", "checksum": {"name": "sha256", "checksum": "47658e7b691e3ef191a4f257560c78e887af4d0b9b5794ab695456be4cf69ea4"}, "tags": ["los"], "refs": [["stg_los__corpappentitydetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__corpappentitydetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "corpappentitydetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.4799786, "compiled_code": "\nWITH source AS(\nSELECT  corpappentitydetailsid\n, entityname\n, snapshot\n, overrideriskgrade\n, overrideriskreasoncode\n, corpapplicationdetailsid\n, entityid\n, entitytype\n, overriddendate\n, overriddenby\n, watchlistflg\n, strictreportmarkflg\n, reviewingteam\n, proposedriskgrade\n, existingriskgrade\n, incorpdate\n, relshipstdate\n, existingexposure\n, parentgroupid\n, entitysubtype\n, proposedexposure\n, changeinexposure\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\n, corpapplicantrefno\n, isentitybooked\nFROM \"oracle_dgaworkzone\".staging.stg_los__corpappentitydetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__corpappentitydetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__corpappentitydetails"}, "model.dga_data_model.los__corpapplicationdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__corpapplicationdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "corpapplicationdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__corpapplicationdetails"], "unique_id": "model.dga_data_model.los__corpapplicationdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'corpapplicationdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpapplicationdetailsid\r\n, snapshot\r\n, applicationtype\r\n, applicationsubtype\r\n, applnumber\r\n, applicationdesc\r\n, applstartdate\r\n, underwriterid\r\n, salesownerid\r\n, prequalificationflg\r\n, fullreviewdate\r\n, criteriametflg\r\n, priority\r\n, applicationstatus\r\n, interimreviewdate\r\n, applcomments\r\n, writeupcomment\r\n, appclosedate\r\n, appstage\r\n, appdecisiondate\r\n, accessowneragent\r\n, accessassigneeagent\r\n, accessownerbc\r\n, accessownersegment\r\n, accessownergroup\r\n, isaddendumraised\r\n, linkedapplication\r\n, appldecisionstatus\r\n, bcgroup\r\n, processnamespace\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, strusercomment1\r\n, tmdate\r\n, creditdecivaldate\r\nFROM {{ ref('stg_los__corpapplicationdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__corpapplicationdetails.sql", "original_file_path": "models\\base\\los\\los__corpapplicationdetails.sql", "name": "los__corpapplicationdetails", "alias": "los__corpapplicationdetails", "checksum": {"name": "sha256", "checksum": "8914d925505585378e5e7978448ae9393d52fbaf5576cc107448c2fdb86f7e3b"}, "tags": ["los"], "refs": [["stg_los__corpapplicationdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__corpapplicationdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "corpapplicationdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.48198, "compiled_code": "\nWITH source AS(\nSELECT  corpapplicationdetailsid\n, snapshot\n, applicationtype\n, applicationsubtype\n, applnumber\n, applicationdesc\n, applstartdate\n, underwriterid\n, salesownerid\n, prequalificationflg\n, fullreviewdate\n, criteriametflg\n, priority\n, applicationstatus\n, interimreviewdate\n, applcomments\n, writeupcomment\n, appclosedate\n, appstage\n, appdecisiondate\n, accessowneragent\n, accessassigneeagent\n, accessownerbc\n, accessownersegment\n, accessownergroup\n, isaddendumraised\n, linkedapplication\n, appldecisionstatus\n, bcgroup\n, processnamespace\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, strusercomment1\n, tmdate\n, creditdecivaldate\nFROM \"oracle_dgaworkzone\".staging.stg_los__corpapplicationdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__corpapplicationdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__corpapplicationdetails"}, "model.dga_data_model.los__corpapplimitdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__corpapplimitdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "corpapplimitdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__corpapplimitdetails"], "unique_id": "model.dga_data_model.los__corpapplimitdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'corpapplimitdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpapplimitdetailsid\r\n, syndfacilityrefno\r\n, syndfacilitydesc\r\n, agentbankcode\r\n, agentbranchcode\r\n, availableperiodmonths\r\n, availableperioddays\r\n, totalsyndicationlimit\r\n, totalsyndicationlimitccy\r\n, corpappentitydetailsid\r\n, limitclassification\r\n, limitcategory\r\n, purposecode\r\n, limitdescription\r\n, amtderivedchildflg\r\n, netlimitapplicableflg\r\n, existinglimit\r\n, proposedlimit\r\n, existingnetlimit\r\n, existinggrosslimit\r\n, proposednetlimit\r\n, proposedgrosslimit\r\n, existinglimitccy\r\n, proposedlimitccy\r\n, existingnetlimitccy\r\n, existinggrosslimitccy\r\n, proposednetlimitccy\r\n, proposedgrosslimitccy\r\n, limitshared\r\n, effectivedate\r\n, limittermdays\r\n, limittermmonths\r\n, expirydate\r\n, limitreviewdate\r\n, availabilityenddate\r\n, revolvingflg\r\n, committedflg\r\n, indemnityheldflg\r\n, accountsofficer\r\n, primarysrcrepayment\r\n, secondarysrcrepayment\r\n, syndicationflg\r\n, limitstatus\r\n, remarks\r\n, sncdetailid\r\n, underwritingamount\r\n, underwritingamountccy\r\n, underwritingamounthome\r\n, takeholdamount\r\n, takeholdamountccy\r\n, takeholdamounthome\r\n, underwritingamounthomeccy\r\n, takeholdamounthomeccy\r\n, agent\r\n, participant\r\n, underwriter\r\n, isdeleted\r\n, limitrefno\r\n, parentlimitrefno\r\n, proposedlimitinhomeccy\r\n, limitccy\r\n, proposedlimitinlimitccy\r\n, relationshiplevel\r\n, approvedlimit\r\n, approvedlimitccy\r\n, approvedlimithomeccy\r\n, approvedlimitinlimitccy\r\n, approvednetlimit\r\n, approvednetlimitccy\r\n, approvedgrosslimit\r\n, approvedgrosslimitccy\r\n, drawingpwrind\r\n, drawingpwrpcnt\r\n, drawingpwrretained\r\n, offerletterreceiveddate\r\n, offerletterreceived\r\n, intratetablecode\r\n, priorityloan\r\n, ispapfield\r\n, routetostep\r\n, routingreasoncode\r\n, papagent\r\n, limitdecision\r\n, limitdecisioncode\r\n, limitremarks\r\n, dlod\r\n, dlodlimitclassification\r\n, dlodlimitcategory\r\n, existingdaylightlimit\r\n, existingdaylightcurrency\r\n, proposeddaylightlimit\r\n, proposeddaylightcurrency\r\n, dlodlimitstatus\r\n, limitidprefix\r\n, limitidsuffix\r\n, applnumber\r\n, offerlettersentdate\r\n, bookingstatus\r\n, accountfeesdr\r\n, lastapprovedlimit\r\n, partlimitstatus\r\n, snapshot\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, versionnumber\r\n, islimitadded\r\n, existinglimithomeccy\r\n, tmdate\r\n, silverlakebranchcode\r\n, officercode\r\n, availablebalanceindicator\r\n, producttype\r\n, paymentcode\r\n, contractnumber\r\n, contractsignedby\r\n, contractdelegatedby\r\n, unsecuredlimit\r\n, totalderivedvalue\r\n, supportlimit1\r\n, supportlimit2\r\n, securedlimit\r\n, contractdate\r\n, paymentfrequencydays\r\n, interestfrequencydays\r\n, paymentfrequencymonths\r\n, interestfrequencymonths\r\n, facilityseq\r\n, ismainfacility\r\n, mainfacilitycode\r\n, mainfacilityseq\r\n, outputlevel\r\n, islimitmodified\r\n, customcreditapprovedlimit\r\nFROM {{ ref('stg_los__corpapplimitdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__corpapplimitdetails.sql", "original_file_path": "models\\base\\los\\los__corpapplimitdetails.sql", "name": "los__corpapplimitdetails", "alias": "los__corpapplimitdetails", "checksum": {"name": "sha256", "checksum": "f1a4bee79f5a4b202f3777e09629877f6431249e2abae485141d84bb0b1bb4be"}, "tags": ["los"], "refs": [["stg_los__corpapplimitdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__corpapplimitdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "corpapplimitdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.482906, "compiled_code": "\nWITH source AS(\nSELECT  corpapplimitdetailsid\n, syndfacilityrefno\n, syndfacilitydesc\n, agentbankcode\n, agentbranchcode\n, availableperiodmonths\n, availableperioddays\n, totalsyndicationlimit\n, totalsyndicationlimitccy\n, corpappentitydetailsid\n, limitclassification\n, limitcategory\n, purposecode\n, limitdescription\n, amtderivedchildflg\n, netlimitapplicableflg\n, existinglimit\n, proposedlimit\n, existingnetlimit\n, existinggrosslimit\n, proposednetlimit\n, proposedgrosslimit\n, existinglimitccy\n, proposedlimitccy\n, existingnetlimitccy\n, existinggrosslimitccy\n, proposednetlimitccy\n, proposedgrosslimitccy\n, limitshared\n, effectivedate\n, limittermdays\n, limittermmonths\n, expirydate\n, limitreviewdate\n, availabilityenddate\n, revolvingflg\n, committedflg\n, indemnityheldflg\n, accountsofficer\n, primarysrcrepayment\n, secondarysrcrepayment\n, syndicationflg\n, limitstatus\n, remarks\n, sncdetailid\n, underwritingamount\n, underwritingamountccy\n, underwritingamounthome\n, takeholdamount\n, takeholdamountccy\n, takeholdamounthome\n, underwritingamounthomeccy\n, takeholdamounthomeccy\n, agent\n, participant\n, underwriter\n, isdeleted\n, limitrefno\n, parentlimitrefno\n, proposedlimitinhomeccy\n, limitccy\n, proposedlimitinlimitccy\n, relationshiplevel\n, approvedlimit\n, approvedlimitccy\n, approvedlimithomeccy\n, approvedlimitinlimitccy\n, approvednetlimit\n, approvednetlimitccy\n, approvedgrosslimit\n, approvedgrosslimitccy\n, drawingpwrind\n, drawingpwrpcnt\n, drawingpwrretained\n, offerletterreceiveddate\n, offerletterreceived\n, intratetablecode\n, priorityloan\n, ispapfield\n, routetostep\n, routingreasoncode\n, papagent\n, limitdecision\n, limitdecisioncode\n, limitremarks\n, dlod\n, dlodlimitclassification\n, dlodlimitcategory\n, existingdaylightlimit\n, existingdaylightcurrency\n, proposeddaylightlimit\n, proposeddaylightcurrency\n, dlodlimitstatus\n, limitidprefix\n, limitidsuffix\n, applnumber\n, offerlettersentdate\n, bookingstatus\n, accountfeesdr\n, lastapprovedlimit\n, partlimitstatus\n, snapshot\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, versionnumber\n, islimitadded\n, existinglimithomeccy\n, tmdate\n, silverlakebranchcode\n, officercode\n, availablebalanceindicator\n, producttype\n, paymentcode\n, contractnumber\n, contractsignedby\n, contractdelegatedby\n, unsecuredlimit\n, totalderivedvalue\n, supportlimit1\n, supportlimit2\n, securedlimit\n, contractdate\n, paymentfrequencydays\n, interestfrequencydays\n, paymentfrequencymonths\n, interestfrequencymonths\n, facilityseq\n, ismainfacility\n, mainfacilitycode\n, mainfacilityseq\n, outputlevel\n, islimitmodified\n, customcreditapprovedlimit\nFROM \"oracle_dgaworkzone\".staging.stg_los__corpapplimitdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__corpapplimitdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__corpapplimitdetails"}, "model.dga_data_model.los__corpdecisioncode": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__corpdecisioncode"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "corpdecisioncodeid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__corpdecisioncode"], "unique_id": "model.dga_data_model.los__corpdecisioncode", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'corpdecisioncodeid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpdecisioncodeid\r\n, creditcommiteenumber\r\n, creditapprovaldate\r\n, corpapplicationdetailsid\r\n, appldecisioncode\r\n, codedecsription\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, creditcommitteenumber\r\n, tmdate\r\nFROM {{ ref('stg_los__corpdecisioncode') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__corpdecisioncode.sql", "original_file_path": "models\\base\\los\\los__corpdecisioncode.sql", "name": "los__corpdecisioncode", "alias": "los__corpdecisioncode", "checksum": {"name": "sha256", "checksum": "8c12064012da365c733e2801a0ad3cb899848af817443e32f1a6681a42d0542b"}, "tags": ["los"], "refs": [["stg_los__corpdecisioncode"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__corpdecisioncode.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "corpdecisioncodeid", "incremental_strategy": "merge"}, "created_at": 1685959752.4849782, "compiled_code": "\nWITH source AS(\nSELECT  corpdecisioncodeid\n, creditcommiteenumber\n, creditapprovaldate\n, corpapplicationdetailsid\n, appldecisioncode\n, codedecsription\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, creditcommitteenumber\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__corpdecisioncode\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__corpdecisioncode)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__corpdecisioncode"}, "model.dga_data_model.los__creditcardproduct": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__creditcardproduct"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "creditcardproductid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__creditcardproduct"], "unique_id": "model.dga_data_model.los__creditcardproduct", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'creditcardproductid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  creditcardproductid\r\n, applicationdetailsid\r\n, creditcardlimit\r\n, cashwithdrawallimit\r\n, minimumamtduepercent\r\n, accountnumber\r\n, accountname\r\n, currency\r\n, interestratecode\r\n, interestrate\r\n, sequenceno\r\n, embossedname\r\n, validfromdate\r\n, validtilldate\r\n, dispatchmode\r\n, repaymenttype\r\n, addoncardrequired\r\n, billingfrequency\r\n, repaymentmode\r\n, cardtype\r\n, balancetransferrequested\r\n, includeaccruedinterest\r\n, graceperiod\r\n, isdeleted\r\n, biccode\r\n, paysysid\r\n, billingfreqnumbers\r\n, billingfreqweekofmonth\r\n, billingfreqdayofweek\r\n, billingfreqdate\r\n, billingfreqholiday\r\n, billingfreqstartdate\r\n, billingfreqcalendar\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\n, customsecquestion\r\n, custompartmember\r\n, customcrosssalename\r\n, customcrosssaleid\r\n, customcrosssalephone\r\n, customcrosssaleemail\r\n, custompintype\r\n, customcardtype\r\n, rank() over(partition by creditcardproductid order by tmdate desc ) rank_id\r\nFROM {{ ref('stg_los__creditcardproduct') }}\r\n)\r\nSELECT * FROM source\r\nwhere rank_id = 1\r\n{% if is_incremental() %}\r\n  and tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__creditcardproduct.sql", "original_file_path": "models\\base\\los\\los__creditcardproduct.sql", "name": "los__creditcardproduct", "alias": "los__creditcardproduct", "checksum": {"name": "sha256", "checksum": "d96c49e0b88141e94dd7ee3db9c2ebbb97833c79e17247d9f9c3b1eef0854c71"}, "tags": ["los"], "refs": [["stg_los__creditcardproduct"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__creditcardproduct.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "creditcardproductid", "incremental_strategy": "merge"}, "created_at": 1685959752.486977, "compiled_code": "\nWITH source AS(\nSELECT  creditcardproductid\n, applicationdetailsid\n, creditcardlimit\n, cashwithdrawallimit\n, minimumamtduepercent\n, accountnumber\n, accountname\n, currency\n, interestratecode\n, interestrate\n, sequenceno\n, embossedname\n, validfromdate\n, validtilldate\n, dispatchmode\n, repaymenttype\n, addoncardrequired\n, billingfrequency\n, repaymentmode\n, cardtype\n, balancetransferrequested\n, includeaccruedinterest\n, graceperiod\n, isdeleted\n, biccode\n, paysysid\n, billingfreqnumbers\n, billingfreqweekofmonth\n, billingfreqdayofweek\n, billingfreqdate\n, billingfreqholiday\n, billingfreqstartdate\n, billingfreqcalendar\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\n, customsecquestion\n, custompartmember\n, customcrosssalename\n, customcrosssaleid\n, customcrosssalephone\n, customcrosssaleemail\n, custompintype\n, customcardtype\n, rank() over(partition by creditcardproductid order by tmdate desc ) rank_id\nFROM \"oracle_dgaworkzone\".staging.stg_los__creditcardproduct\n)\nSELECT * FROM source\nwhere rank_id = 1\n\n  and tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__creditcardproduct)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__creditcardproduct"}, "model.dga_data_model.los__creditscoringdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__creditscoringdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__creditscoringdetails"], "unique_id": "model.dga_data_model.los__creditscoringdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  scoringapplicationid\r\n, parentapplicationid\r\n, score\r\n, grade\r\n, recommendedmodel\r\n, scoringdate\r\n, scoringuser\r\n, prescreenresult\r\n, dateofupdation\r\n, scoringappstatus\r\n, ewsresults\r\n, monthofewsresult\r\n, remarks\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freenum1\r\n, freenum2\r\n, freenum3\r\n, freedate1\r\n, freedate2\r\n, freedate3\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\nFROM {{ ref('stg_los__creditscoringdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__creditscoringdetails.sql", "original_file_path": "models\\base\\los\\los__creditscoringdetails.sql", "name": "los__creditscoringdetails", "alias": "los__creditscoringdetails", "checksum": {"name": "sha256", "checksum": "65625e1fe999cf203d51f509fdd9e26042af436b9853d5d55eba97278846c0ed"}, "tags": ["los"], "refs": [["stg_los__creditscoringdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__creditscoringdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959752.4889793, "compiled_code": "\nWITH source AS(\nSELECT  scoringapplicationid\n, parentapplicationid\n, score\n, grade\n, recommendedmodel\n, scoringdate\n, scoringuser\n, prescreenresult\n, dateofupdation\n, scoringappstatus\n, ewsresults\n, monthofewsresult\n, remarks\n, freetext1\n, freetext2\n, freetext3\n, freenum1\n, freenum2\n, freenum3\n, freedate1\n, freedate2\n, freedate3\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__creditscoringdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__creditscoringdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__creditscoringdetails"}, "model.dga_data_model.los__custidentitydetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__custidentitydetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "custidentitydetailid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__custidentitydetail"], "unique_id": "model.dga_data_model.los__custidentitydetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'custidentitydetailid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  custidentitydetailid\r\n, documentuniqueid\r\n, documentcode\r\n, doctypedesc\r\n, placeofissue\r\n, cityofissue\r\n, stateofissue\r\n, countryofissue\r\n, docissuedt\r\n, docexpdt\r\n, idissuedby\r\n, fdmadocumentid\r\n, customerdetailid\r\n, doccodedesc\r\n, docrmks\r\n, deletestatus\r\n, prefuniqueidind\r\n, docverifiedind\r\n, refnum\r\n, status\r\n, scanreqdind\r\n, entitytype\r\n, idendoctype\r\n, crmdocumentid\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, filename\r\n, cifid\r\n, parentapplicationid\r\n, tmdate\r\nFROM {{ ref('stg_los__custidentitydetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__custidentitydetail.sql", "original_file_path": "models\\base\\los\\los__custidentitydetail.sql", "name": "los__custidentitydetail", "alias": "los__custidentitydetail", "checksum": {"name": "sha256", "checksum": "cbf5776b51557b66353870d12a088bbf02864845597bca2feafafdf3bd48b779"}, "tags": ["los"], "refs": [["stg_los__custidentitydetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__custidentitydetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "custidentitydetailid", "incremental_strategy": "merge"}, "created_at": 1685959752.4909763, "compiled_code": "\nWITH source AS(\nSELECT  custidentitydetailid\n, documentuniqueid\n, documentcode\n, doctypedesc\n, placeofissue\n, cityofissue\n, stateofissue\n, countryofissue\n, docissuedt\n, docexpdt\n, idissuedby\n, fdmadocumentid\n, customerdetailid\n, doccodedesc\n, docrmks\n, deletestatus\n, prefuniqueidind\n, docverifiedind\n, refnum\n, status\n, scanreqdind\n, entitytype\n, idendoctype\n, crmdocumentid\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, filename\n, cifid\n, parentapplicationid\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__custidentitydetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__custidentitydetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__custidentitydetail"}, "model.dga_data_model.los__customerdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__customerdetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "customerdetailid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__customerdetail"], "unique_id": "model.dga_data_model.los__customerdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'customerdetailid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  customerdetailid\r\n, isapplicantdedupchkdone\r\n, fisrvcalltype\r\n, custsequenceno\r\n, ficallstatus\r\n, kycscore\r\n, kycdate\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, accessowneragent\r\n, accessassigneeagent\r\n, cifid\r\n, custtype\r\n, cifassociationcount\r\n, title\r\n, fname\r\n, lname\r\n, mname\r\n, dob\r\n, gender\r\n, nationality\r\n, nativelangcode\r\n, nonresdindicator\r\n, resdtype\r\n, custoccupation\r\n, maritalstatus\r\n, veteran\r\n, noofyrofschool\r\n, noofdependents\r\n, ageofdependents\r\n, staffindicator\r\n, custsegment\r\n, custsubsegment\r\n, custrating\r\n, ecifnotified\r\n, cifresponseflg\r\n, cifresponsermrk\r\n, deletestatus\r\n, blacklisted\r\n, blacklistnote\r\n, blacklistreason\r\n, isblacklistchkdone\r\n, negated\r\n, neglistnote\r\n, neglistreason\r\n, isneglistchkdone\r\n, isdedupchkdone\r\n, dedupchknote\r\n, suspended\r\n, suspendedreason\r\n, suspendednote\r\n, status\r\n, statuscode\r\n, totalamount3\r\n, totalamount1\r\n, totalamount2\r\n, dedupreasoncode\r\n, bank_id\r\n, staffid\r\n, preferredname\r\n, prirelmanagerid\r\n, shortname\r\n, region\r\n, smsbankingenabledind\r\n, smsbankingmobilenum\r\n, nameinpreflang\r\n, isebankingenabled\r\n, primaryservicecenter\r\n, prospectminind\r\n, relashipopendt\r\n, tfpartyind\r\n, tdstbl\r\n, tdstblcode\r\n, nrbecomingdt\r\n, nickname\r\n, prospectid\r\n, crmentitytype\r\n, surname\r\n, prospecttocustomerconvflag\r\n, preferredaddress\r\n, basecurrency\r\n, primarysolid\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, immigrationstatus\r\n, insidertobank\r\n, insiderrole\r\n, decisionremark\r\n, decisionresult\r\n, employmentstatus\r\n, grossincome\r\n, grossincomecurrency\r\n, industrytype\r\n, isautoapproved\r\n, isguardianrequired\r\n, jobtitle\r\n, noofdependentchildren\r\n, suffix\r\n, taxid\r\n, cntryofcitizenship\r\n, govtempofaclstcntry\r\n, freetext1\r\n, freetext2\r\n, freecode1\r\n, freecode2\r\n, taxdetdsourccifid\r\n, taxdetdsourctable\r\n, isforeignacctaxrepreqd\r\n, foreigntaxrepcntry\r\n, foreigntaxreptingstatus\r\n, foreigntaxrptingdate\r\n, foreigntaxcomments\r\n, insiderciftype\r\n, insidercifid\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\n, freetext6\r\n, freetext7\r\n, freetext8\r\n, freetext9\r\n, freetext10\r\n, freedate1\r\n, freedate2\r\n, tmdate\r\nFROM {{ ref('stg_los__customerdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__customerdetail.sql", "original_file_path": "models\\base\\los\\los__customerdetail.sql", "name": "los__customerdetail", "alias": "los__customerdetail", "checksum": {"name": "sha256", "checksum": "226d1a6da18d5d778a3abf8904bd5a89591380727ca2256d0b9559298c7f85f5"}, "tags": ["los"], "refs": [["stg_los__customerdetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__customerdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "customerdetailid", "incremental_strategy": "merge"}, "created_at": 1685959752.4929802, "compiled_code": "\nWITH source AS(\nSELECT  customerdetailid\n, isapplicantdedupchkdone\n, fisrvcalltype\n, custsequenceno\n, ficallstatus\n, kycscore\n, kycdate\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, accessowneragent\n, accessassigneeagent\n, cifid\n, custtype\n, cifassociationcount\n, title\n, fname\n, lname\n, mname\n, dob\n, gender\n, nationality\n, nativelangcode\n, nonresdindicator\n, resdtype\n, custoccupation\n, maritalstatus\n, veteran\n, noofyrofschool\n, noofdependents\n, ageofdependents\n, staffindicator\n, custsegment\n, custsubsegment\n, custrating\n, ecifnotified\n, cifresponseflg\n, cifresponsermrk\n, deletestatus\n, blacklisted\n, blacklistnote\n, blacklistreason\n, isblacklistchkdone\n, negated\n, neglistnote\n, neglistreason\n, isneglistchkdone\n, isdedupchkdone\n, dedupchknote\n, suspended\n, suspendedreason\n, suspendednote\n, status\n, statuscode\n, totalamount3\n, totalamount1\n, totalamount2\n, dedupreasoncode\n, bank_id\n, staffid\n, preferredname\n, prirelmanagerid\n, shortname\n, region\n, smsbankingenabledind\n, smsbankingmobilenum\n, nameinpreflang\n, isebankingenabled\n, primaryservicecenter\n, prospectminind\n, relashipopendt\n, tfpartyind\n, tdstbl\n, tdstblcode\n, nrbecomingdt\n, nickname\n, prospectid\n, crmentitytype\n, surname\n, prospecttocustomerconvflag\n, preferredaddress\n, basecurrency\n, primarysolid\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, immigrationstatus\n, insidertobank\n, insiderrole\n, decisionremark\n, decisionresult\n, employmentstatus\n, grossincome\n, grossincomecurrency\n, industrytype\n, isautoapproved\n, isguardianrequired\n, jobtitle\n, noofdependentchildren\n, suffix\n, taxid\n, cntryofcitizenship\n, govtempofaclstcntry\n, freetext1\n, freetext2\n, freecode1\n, freecode2\n, taxdetdsourccifid\n, taxdetdsourctable\n, isforeignacctaxrepreqd\n, foreigntaxrepcntry\n, foreigntaxreptingstatus\n, foreigntaxrptingdate\n, foreigntaxcomments\n, insiderciftype\n, insidercifid\n, freetext3\n, freetext4\n, freetext5\n, freetext6\n, freetext7\n, freetext8\n, freetext9\n, freetext10\n, freedate1\n, freedate2\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__customerdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__customerdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__customerdetail"}, "model.dga_data_model.los__decision": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__decision"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "decisionid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__decision"], "unique_id": "model.dga_data_model.los__decision", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'decisionid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  decisionid\r\n, decision\r\n, applicationid\r\n, ruleid\r\n, decisionresult\r\n, userid\r\n, internalscore\r\n, timestamp\r\n, decisioningtype\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isdeleted\r\n, comments\r\n, decisionexpirydate\r\n, groupid\r\n, frontendratio\r\n, backendratio\r\n, piamount\r\n, isparent\r\n, tmdate\r\nFROM {{ ref('stg_los__decision') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__decision.sql", "original_file_path": "models\\base\\los\\los__decision.sql", "name": "los__decision", "alias": "los__decision", "checksum": {"name": "sha256", "checksum": "8a56aa6b7208ceab9934cd10c9cc56a5b68f471c4f22f64a4f27e6b526f2f5b5"}, "tags": ["los"], "refs": [["stg_los__decision"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__decision.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "decisionid", "incremental_strategy": "merge"}, "created_at": 1685959752.49499, "compiled_code": "\nWITH source AS(\nSELECT  decisionid\n, decision\n, applicationid\n, ruleid\n, decisionresult\n, userid\n, internalscore\n, timestamp\n, decisioningtype\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isdeleted\n, comments\n, decisionexpirydate\n, groupid\n, frontendratio\n, backendratio\n, piamount\n, isparent\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__decision\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__decision)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__decision"}, "model.dga_data_model.los__loanproductdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__loanproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "loanproductdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__loanproductdetails"], "unique_id": "model.dga_data_model.los__loanproductdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'loanproductdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  loanproductdetailsid\r\n, offsetaccountnumber\r\n, spread\r\n, sequenceno\r\n, interestratecode\r\n, interestrate\r\n, documentationtype\r\n, iascode\r\n, assumptioneligible\r\n, installmenttype\r\n, repricingplan\r\n, repaymenttype\r\n, repaymentmethod\r\n, ratelockrequired\r\n, autopaydiscountapplicable\r\n, subsidyrequired\r\n, disbtype\r\n, buydownrequired\r\n, excldecredit\r\n, savingshomeflag\r\n, principalsubsidyamount\r\n, principalsubsidycurr\r\n, intbenefitsubsidy\r\n, buydowntype\r\n, currency\r\n, conversionallowedfrom\r\n, conversionallowedto\r\n, escrowaccountreq\r\n, armintladjcapincr\r\n, armintladjcapdecr\r\n, armperiodicadjcapincr\r\n, armperiodicadjcapdecr\r\n, armlifetimeadjcapdecr\r\n, armlifetimeadjcapincr\r\n, armintrmovmntrestrct\r\n, armminchangeintr\r\n, armadvintrratefixreq\r\n, armadvnoticeintchng\r\n, tenormonths\r\n, applicationdetailsid\r\n, amount\r\n, tenordays\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isdeleted\r\n, enrforcreditprotection\r\n, enrollmentfromdate\r\n, enrollmenttodate\r\n, insured\r\n, maxcreproperiod\r\n, minbillamount\r\n, minpaymentapplicable\r\n, nameofinscompany\r\n, noofmissedpayallowed\r\n, promoperiod\r\n, promoperiodintrate\r\n, promoperiodintapplication\r\n, excludereason\r\n, tmdate\r\nFROM {{ ref('stg_los__loanproductdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__loanproductdetails.sql", "original_file_path": "models\\base\\los\\los__loanproductdetails.sql", "name": "los__loanproductdetails", "alias": "los__loanproductdetails", "checksum": {"name": "sha256", "checksum": "a91c45a73a293f192542cd29d37a52bdce3c6a971148e2233c8e119b993ce440"}, "tags": ["los"], "refs": [["stg_los__loanproductdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__loanproductdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "loanproductdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.4969819, "compiled_code": "\nWITH source AS(\nSELECT  loanproductdetailsid\n, offsetaccountnumber\n, spread\n, sequenceno\n, interestratecode\n, interestrate\n, documentationtype\n, iascode\n, assumptioneligible\n, installmenttype\n, repricingplan\n, repaymenttype\n, repaymentmethod\n, ratelockrequired\n, autopaydiscountapplicable\n, subsidyrequired\n, disbtype\n, buydownrequired\n, excldecredit\n, savingshomeflag\n, principalsubsidyamount\n, principalsubsidycurr\n, intbenefitsubsidy\n, buydowntype\n, currency\n, conversionallowedfrom\n, conversionallowedto\n, escrowaccountreq\n, armintladjcapincr\n, armintladjcapdecr\n, armperiodicadjcapincr\n, armperiodicadjcapdecr\n, armlifetimeadjcapdecr\n, armlifetimeadjcapincr\n, armintrmovmntrestrct\n, armminchangeintr\n, armadvintrratefixreq\n, armadvnoticeintchng\n, tenormonths\n, applicationdetailsid\n, amount\n, tenordays\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isdeleted\n, enrforcreditprotection\n, enrollmentfromdate\n, enrollmenttodate\n, insured\n, maxcreproperiod\n, minbillamount\n, minpaymentapplicable\n, nameofinscompany\n, noofmissedpayallowed\n, promoperiod\n, promoperiodintrate\n, promoperiodintapplication\n, excludereason\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__loanproductdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__loanproductdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__loanproductdetails"}, "model.dga_data_model.los__losprocessentity": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__losprocessentity"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "losprocessentityid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__losprocessentity"], "unique_id": "model.dga_data_model.los__losprocessentity", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'losprocessentityid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  losprocessentityid\r\n, processid\r\n, entityid\r\n, entityname\r\n, currentactivityid\r\n, parentactivityid\r\n, processstepstatus\r\n, salesownerid\r\n, salesownergroup\r\n, assigneduserid\r\n, assignedusergroup\r\n, assignedlocationid\r\n, entityowner\r\n, entityownergroup\r\n, entityownerlocationid\r\n, entitystage\r\n, routingtype\r\n, routingcomment\r\n, routingreasonecode\r\n, routingmatrixid\r\n, sla\r\n, activityname\r\n, userfield1\r\n, userfield2\r\n, processname\r\n, losprocessid\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, opportunityproductsid\r\n, entitystep\r\n, tmdate\r\n, rank() over(partition by losprocessentityid order by tmdate desc ) rank_id\r\nFROM {{ ref('stg_los__losprocessentity') }}\r\n)\r\nSELECT * FROM source\r\nwhere rank_id = 1\r\n{% if is_incremental() %}\r\n  and tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__losprocessentity.sql", "original_file_path": "models\\base\\los\\los__losprocessentity.sql", "name": "los__losprocessentity", "alias": "los__losprocessentity", "checksum": {"name": "sha256", "checksum": "2250d06e36f2de4119f048abec90f9c64a8409017872ba84df82018a370d09c9"}, "tags": ["los"], "refs": [["stg_los__losprocessentity"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__losprocessentity.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "losprocessentityid", "incremental_strategy": "merge"}, "created_at": 1685959752.498908, "compiled_code": "\nWITH source AS(\nSELECT  losprocessentityid\n, processid\n, entityid\n, entityname\n, currentactivityid\n, parentactivityid\n, processstepstatus\n, salesownerid\n, salesownergroup\n, assigneduserid\n, assignedusergroup\n, assignedlocationid\n, entityowner\n, entityownergroup\n, entityownerlocationid\n, entitystage\n, routingtype\n, routingcomment\n, routingreasonecode\n, routingmatrixid\n, sla\n, activityname\n, userfield1\n, userfield2\n, processname\n, losprocessid\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, opportunityproductsid\n, entitystep\n, tmdate\n, rank() over(partition by losprocessentityid order by tmdate desc ) rank_id\nFROM \"oracle_dgaworkzone\".staging.stg_los__losprocessentity\n)\nSELECT * FROM source\nwhere rank_id = 1\n\n  and tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__losprocessentity)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__losprocessentity"}, "model.dga_data_model.los__opportunities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__opportunities"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "opportunityid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__opportunities"], "unique_id": "model.dga_data_model.los__opportunities", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'opportunityid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  opportunityid\r\n, productclassification\r\n, authtype\r\n, producttype\r\n, productcode\r\n, productname\r\n, currency\r\n, productcategory\r\n, businesscenter\r\n, dsarepname\r\n, repname\r\n, productsubcategory\r\n, accountbranch\r\n, transactiontype\r\n, assigntransfer\r\n, groupname\r\n, transferuserid\r\n, tier\r\n, isdeleted\r\n, is_ssa_acct\r\n, tempsalesid\r\n, applicationtype\r\n, userstrfield1\r\n, userstrfield2\r\n, userstrfield3\r\n, userstrfield4\r\n, userdatefield\r\n, bank_id\r\n, stopprocescalation\r\n, rejectreason\r\n, lockrollback\r\n, lockrecompute\r\n, salesownergroup\r\n, ownergroup\r\n, oldsalesownerid\r\n, referencetype\r\n, noofrollback\r\n, firstrollbackat\r\n, accountnumber\r\n, leadvalue\r\n, valueunits\r\n, basevalue\r\n, probability\r\n, processstage\r\n, disposition\r\n, leadtype\r\n, opportunitiessource\r\n, description\r\n, leadmode\r\n, campaigntargetid\r\n, reasoncode\r\n, reasondetails\r\n, opportunityname\r\n, caseid\r\n, opportunitytype\r\n, processid\r\n, currentstep\r\n, orgid\r\n, suspectid\r\n, status\r\n, hasattachment\r\n, notes\r\n, additionalnotes\r\n, owneruserid\r\n, assigneduserid\r\n, createduserid\r\n, assignedgroupid\r\n, crmcallid\r\n, mergedwith\r\n, priority\r\n, startdate\r\n, duedate\r\n, competitors\r\n, enddate\r\n, currstepduedate\r\n, region\r\n, ismerger\r\n, assignedbyuserid\r\n, transferredbyuserid\r\n, opportunityfor\r\n, autocreateapplform\r\n, opprstage\r\n, opprstatus\r\n, lastname\r\n, opprchannel\r\n, oppreditable\r\n, promotionoffer\r\n, promotionvalidity\r\n, branchlocation\r\n, processeditable\r\n, oldapplicationid\r\n, channelrefid\r\n, salesownerid\r\n, contactid\r\n, purposeofcredit\r\n, isautomated\r\n, campaignid\r\n, timerstatus\r\n, secoppcaseid\r\n, issecondaryopp\r\n, assignedtime\r\n, slalevel\r\n, ownedlocationid\r\n, assignedlocationid\r\n, isrouted\r\n, esc_due_time\r\n, esc_level\r\n, nocurstepassign\r\n, tatduration\r\n, stopescalation\r\n, entityemail\r\n, manualrouting\r\n, customersegment\r\n, routedtime\r\n, procescduetime\r\n, firstgrownid\r\n, firstbcownid\r\n, firstuserownid\r\n, currnumposesc\r\n, currnumnegesc\r\n, numofposesc\r\n, numofnegesc\r\n, procesclevel\r\n, routeruleforgroup\r\n, routeruleforbc\r\n, routeruleforuser\r\n, escalationattr1\r\n, escalationattr2\r\n, escalationattr3\r\n, createdlocationid\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n, userfield5\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, parentintxnid\r\n, prevstependdate\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, accessowneragent\r\n, accessassigneeagent\r\n, opportunityvalue\r\n, leadsourceid\r\n, quotaid\r\n, cifid\r\n, firstname\r\n, offerid\r\n, optionid\r\n, loanamt\r\n, channelname\r\n, loantenordays\r\n, loantenormonths\r\n, assignedbcgid\r\n, ownerbcgid\r\n, applrecieveddate\r\n, extoriginatorname\r\n, tmdate\r\nFROM {{ ref('stg_los__opportunities') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__opportunities.sql", "original_file_path": "models\\base\\los\\los__opportunities.sql", "name": "los__opportunities", "alias": "los__opportunities", "checksum": {"name": "sha256", "checksum": "c0c4d4f63b2f1dfabaa5e92c2f4a1914dfbf8a4f586d0cf86ee6dec4bb55e6a2"}, "tags": ["los"], "refs": [["stg_los__opportunities"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__opportunities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "opportunityid", "incremental_strategy": "merge"}, "created_at": 1685959752.5009787, "compiled_code": "\nWITH source AS(\nSELECT  opportunityid\n, productclassification\n, authtype\n, producttype\n, productcode\n, productname\n, currency\n, productcategory\n, businesscenter\n, dsarepname\n, repname\n, productsubcategory\n, accountbranch\n, transactiontype\n, assigntransfer\n, groupname\n, transferuserid\n, tier\n, isdeleted\n, is_ssa_acct\n, tempsalesid\n, applicationtype\n, userstrfield1\n, userstrfield2\n, userstrfield3\n, userstrfield4\n, userdatefield\n, bank_id\n, stopprocescalation\n, rejectreason\n, lockrollback\n, lockrecompute\n, salesownergroup\n, ownergroup\n, oldsalesownerid\n, referencetype\n, noofrollback\n, firstrollbackat\n, accountnumber\n, leadvalue\n, valueunits\n, basevalue\n, probability\n, processstage\n, disposition\n, leadtype\n, opportunitiessource\n, description\n, leadmode\n, campaigntargetid\n, reasoncode\n, reasondetails\n, opportunityname\n, caseid\n, opportunitytype\n, processid\n, currentstep\n, orgid\n, suspectid\n, status\n, hasattachment\n, notes\n, additionalnotes\n, owneruserid\n, assigneduserid\n, createduserid\n, assignedgroupid\n, crmcallid\n, mergedwith\n, priority\n, startdate\n, duedate\n, competitors\n, enddate\n, currstepduedate\n, region\n, ismerger\n, assignedbyuserid\n, transferredbyuserid\n, opportunityfor\n, autocreateapplform\n, opprstage\n, opprstatus\n, lastname\n, opprchannel\n, oppreditable\n, promotionoffer\n, promotionvalidity\n, branchlocation\n, processeditable\n, oldapplicationid\n, channelrefid\n, salesownerid\n, contactid\n, purposeofcredit\n, isautomated\n, campaignid\n, timerstatus\n, secoppcaseid\n, issecondaryopp\n, assignedtime\n, slalevel\n, ownedlocationid\n, assignedlocationid\n, isrouted\n, esc_due_time\n, esc_level\n, nocurstepassign\n, tatduration\n, stopescalation\n, entityemail\n, manualrouting\n, customersegment\n, routedtime\n, procescduetime\n, firstgrownid\n, firstbcownid\n, firstuserownid\n, currnumposesc\n, currnumnegesc\n, numofposesc\n, numofnegesc\n, procesclevel\n, routeruleforgroup\n, routeruleforbc\n, routeruleforuser\n, escalationattr1\n, escalationattr2\n, escalationattr3\n, createdlocationid\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n, userfield5\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, parentintxnid\n, prevstependdate\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, accessowneragent\n, accessassigneeagent\n, opportunityvalue\n, leadsourceid\n, quotaid\n, cifid\n, firstname\n, offerid\n, optionid\n, loanamt\n, channelname\n, loantenordays\n, loantenormonths\n, assignedbcgid\n, ownerbcgid\n, applrecieveddate\n, extoriginatorname\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__opportunities\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__opportunities)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__opportunities"}, "model.dga_data_model.los__oscorpcustomerdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__oscorpcustomerdetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "oscorpcustomerdetailid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__oscorpcustomerdetail"], "unique_id": "model.dga_data_model.los__oscorpcustomerdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'oscorpcustomerdetailid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  oscorpcustomerdetailid\r\n, cifid\r\n, shortname\r\n, legalentitytype\r\n, corporatesegment\r\n, registrationnumber\r\n, corporatename\r\n, countryofincorporation\r\n, industrytype\r\n, dateofincorporation\r\n, applicantid\r\n, preferredaddress\r\n, preferredphone\r\n, preferredemail\r\n, primarysolid\r\n, isblacklisted\r\n, isnegated\r\n, issuspended\r\n, isblacklistcheckdone\r\n, isnegativelistcheckdone\r\n, isdedupcheckdone\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isautoapproved\r\n, decisionresult\r\n, decisionremark\r\n, kycscore\r\n, kycdate\r\n, ficallstatus\r\n, fisrvcalltype\r\n, remarks\r\n, creditscorecode\r\n, isforeignacctaxrepreqd\r\n, foreigntaxrepcntry\r\n, foreigntaxreptingstatus\r\n, foreigntaxrptingdate\r\n, foreigntaxcomments\r\n, taxdetdsourccifid\r\n, taxdetdsourctable\r\n, taxid\r\n, freetext1\r\n, freetext2\r\n, freecode1\r\n, freecode2\r\n, publiclytraded\r\n, stocksymbol\r\n, ownedbyforeigner\r\n, ownedbywomen\r\n, ownedbyminority\r\n, publiclyheld\r\n, notforprofit\r\n, prirelmgrid\r\n, stockexname\r\n, healthcode\r\n, isapplicantdedupchkdone\r\n, tmdate\r\n, struserfield1\r\n, struserfield2\r\n, struserfield3\r\n, struserfield4\r\n, struserfield5\r\n, struserfield6\r\n, struserfield7\r\n, struserfield8\r\n, struserfield9\r\n, struserfield10\r\n, struserfield11\r\n, struserfield12\r\n, struserfield13\r\n, struserfield14\r\n, struserfield15\r\n, dateuserfield1\r\n, dateuserfield2\r\n, dateuserfield3\r\n, dateuserfield4\r\n, integeruserfield1\r\n, integeruserfield2\r\n, integeruserfield3\r\n, integeruserfield4\r\n, doubleuserfield1\r\n, doubleuserfield2\r\n, doubleuserfield3\r\n, doubleuserfield4\r\n, relationshipstartdate\r\n, sector\r\n, subsector\r\n, region\r\n, riskrating\r\nFROM {{ ref('stg_los__oscorpcustomerdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__oscorpcustomerdetail.sql", "original_file_path": "models\\base\\los\\los__oscorpcustomerdetail.sql", "name": "los__oscorpcustomerdetail", "alias": "los__oscorpcustomerdetail", "checksum": {"name": "sha256", "checksum": "e8e12c1778e8ad32ed15e88702446dfcd9d8cde16ff4e6c49217742f64cb7aaf"}, "tags": ["los"], "refs": [["stg_los__oscorpcustomerdetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__oscorpcustomerdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "oscorpcustomerdetailid", "incremental_strategy": "merge"}, "created_at": 1685959752.5029862, "compiled_code": "\nWITH source AS(\nSELECT  oscorpcustomerdetailid\n, cifid\n, shortname\n, legalentitytype\n, corporatesegment\n, registrationnumber\n, corporatename\n, countryofincorporation\n, industrytype\n, dateofincorporation\n, applicantid\n, preferredaddress\n, preferredphone\n, preferredemail\n, primarysolid\n, isblacklisted\n, isnegated\n, issuspended\n, isblacklistcheckdone\n, isnegativelistcheckdone\n, isdedupcheckdone\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isautoapproved\n, decisionresult\n, decisionremark\n, kycscore\n, kycdate\n, ficallstatus\n, fisrvcalltype\n, remarks\n, creditscorecode\n, isforeignacctaxrepreqd\n, foreigntaxrepcntry\n, foreigntaxreptingstatus\n, foreigntaxrptingdate\n, foreigntaxcomments\n, taxdetdsourccifid\n, taxdetdsourctable\n, taxid\n, freetext1\n, freetext2\n, freecode1\n, freecode2\n, publiclytraded\n, stocksymbol\n, ownedbyforeigner\n, ownedbywomen\n, ownedbyminority\n, publiclyheld\n, notforprofit\n, prirelmgrid\n, stockexname\n, healthcode\n, isapplicantdedupchkdone\n, tmdate\n, struserfield1\n, struserfield2\n, struserfield3\n, struserfield4\n, struserfield5\n, struserfield6\n, struserfield7\n, struserfield8\n, struserfield9\n, struserfield10\n, struserfield11\n, struserfield12\n, struserfield13\n, struserfield14\n, struserfield15\n, dateuserfield1\n, dateuserfield2\n, dateuserfield3\n, dateuserfield4\n, integeruserfield1\n, integeruserfield2\n, integeruserfield3\n, integeruserfield4\n, doubleuserfield1\n, doubleuserfield2\n, doubleuserfield3\n, doubleuserfield4\n, relationshipstartdate\n, sector\n, subsector\n, region\n, riskrating\nFROM \"oracle_dgaworkzone\".staging.stg_los__oscorpcustomerdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__oscorpcustomerdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__oscorpcustomerdetail"}, "model.dga_data_model.los__oscorpdocumentdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__oscorpdocumentdetail"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "oscorpdocumentdetailid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__oscorpdocumentdetail"], "unique_id": "model.dga_data_model.los__oscorpdocumentdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'oscorpdocumentdetailid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  oscorpdocumentdetailid\r\n, idendoctype\r\n, documentuniqueid\r\n, documentcode\r\n, placeofissue\r\n, cityofissue\r\n, stateofissue\r\n, countryofissue\r\n, docissuedt\r\n, docexpdt\r\n, idissuedby\r\n, oscorpcustomerdetailid\r\n, docrmks\r\n, prefuniqueidind\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, fdmadocumentid\r\n, tmdate\r\nFROM {{ ref('stg_los__oscorpdocumentdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__oscorpdocumentdetail.sql", "original_file_path": "models\\base\\los\\los__oscorpdocumentdetail.sql", "name": "los__oscorpdocumentdetail", "alias": "los__oscorpdocumentdetail", "checksum": {"name": "sha256", "checksum": "4ae1ad5bd4bfe250f05285db6446cf0d01af21086dd4262d0000cd3e9f29113b"}, "tags": ["los"], "refs": [["stg_los__oscorpdocumentdetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__oscorpdocumentdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "oscorpdocumentdetailid", "incremental_strategy": "merge"}, "created_at": 1685959752.5059767, "compiled_code": "\nWITH source AS(\nSELECT  oscorpdocumentdetailid\n, idendoctype\n, documentuniqueid\n, documentcode\n, placeofissue\n, cityofissue\n, stateofissue\n, countryofissue\n, docissuedt\n, docexpdt\n, idissuedby\n, oscorpcustomerdetailid\n, docrmks\n, prefuniqueidind\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, fdmadocumentid\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__oscorpdocumentdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__oscorpdocumentdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__oscorpdocumentdetail"}, "model.dga_data_model.los__oslineproductdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__oslineproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "oslineproductdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__oslineproductdetails"], "unique_id": "model.dga_data_model.los__oslineproductdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'oslineproductdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  oslineproductdetailsid\r\n, excldcreditreport\r\n, sequenceno\r\n, eligibleforratelock\r\n, applicationdetailsid\r\n, limitsought\r\n, drawperioddays\r\n, drawperiodmonths\r\n, repayperioddays\r\n, repayperiodmonths\r\n, reviewdate\r\n, producttype\r\n, repricingplan\r\n, ratelockrequired\r\n, escrowaccountreq\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\n, custombaseintrate\r\n, customminint\r\n, customseqnumber\r\n, customspread\r\n, customstartdate\r\n, customtenordays\r\n, customtenormonths\r\n, customtotalvariance\r\n, customvariance\r\n, customcurrentaccountid\r\n, customeffectiverate\r\n, customenddate\r\n, customfinalintrate\r\n, customintmodrequired\r\n, custominttabcode\r\n, custommaxint\r\n, customstrfield1\r\n, customstrfield2\r\n, customstrfield3\r\n, customint1\r\n, customint2\r\n, customdate1\r\n, customeffectiverate1\r\nFROM {{ ref('stg_los__oslineproductdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__oslineproductdetails.sql", "original_file_path": "models\\base\\los\\los__oslineproductdetails.sql", "name": "los__oslineproductdetails", "alias": "los__oslineproductdetails", "checksum": {"name": "sha256", "checksum": "f9a32ac40bf0e93b985f4b382dbf4d4f6ca0ad364c2d46c225c700c3f85e1983"}, "tags": ["los"], "refs": [["stg_los__oslineproductdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__oslineproductdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "oslineproductdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.5079772, "compiled_code": "\nWITH source AS(\nSELECT  oslineproductdetailsid\n, excldcreditreport\n, sequenceno\n, eligibleforratelock\n, applicationdetailsid\n, limitsought\n, drawperioddays\n, drawperiodmonths\n, repayperioddays\n, repayperiodmonths\n, reviewdate\n, producttype\n, repricingplan\n, ratelockrequired\n, escrowaccountreq\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\n, custombaseintrate\n, customminint\n, customseqnumber\n, customspread\n, customstartdate\n, customtenordays\n, customtenormonths\n, customtotalvariance\n, customvariance\n, customcurrentaccountid\n, customeffectiverate\n, customenddate\n, customfinalintrate\n, customintmodrequired\n, custominttabcode\n, custommaxint\n, customstrfield1\n, customstrfield2\n, customstrfield3\n, customint1\n, customint2\n, customdate1\n, customeffectiverate1\nFROM \"oracle_dgaworkzone\".staging.stg_los__oslineproductdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__oslineproductdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__oslineproductdetails"}, "model.dga_data_model.los__osproduct": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__osproduct"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "osproductid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__osproduct"], "unique_id": "model.dga_data_model.los__osproduct", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'osproductid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  osproductid\r\n, exposurecat\r\n, shadowproductid\r\n, productcategory\r\n, productsubcategory\r\n, productname\r\n, productcode\r\n, productprocessor\r\n, productvalidfrom\r\n, intcompoundingfreqdr\r\n, intcalcfreqtypedr\r\n, intcalcfreqweekdaydr\r\n, intcalcfreqweeknumdr\r\n, intcalcfreqholidaydr\r\n, intcalcfreqstartdatedr\r\n, intcalcfreqcalendardr\r\n, collinterestflg\r\n, productvalidtill\r\n, producttype\r\n, productmanagername\r\n, applformtemplate\r\n, acctemplate\r\n, businessgroup\r\n, region\r\n, permittedsectorcode\r\n, jointholderdsr\r\n, programid\r\n, feepackageid\r\n, validationpackageid\r\n, coolingoffperiod\r\n, coolingoffperioddesc\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, attachmentname\r\n, producthandlingskill\r\n, iasclassification\r\n, availablechannels\r\n, lifecyclestatus\r\n, activate\r\n, statusdescription\r\n, remarks\r\n, authorisedby\r\n, authorisationstatus\r\n, authorisationremarks\r\n, isdeleted\r\n, policypackageid\r\n, repaymentcycle_ftr\r\n, repricing_ftr\r\n, regulatory_ftr\r\n, miscellaneous_ftr\r\n, mandatorydetails_ftr\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, productsecsubcategory\r\n, createdby\r\n, productclassification\r\n, eligibilitypackageid\r\n, creditauthorizationmatrixid\r\n, subsidydetails_ftr\r\n, systemdefinedacnum\r\n, payinterest\r\n, nonresident\r\n, channelflg\r\n, glsubheadcode\r\n, productgroup\r\n, freecode1\r\n, freecode2\r\n, freecode3\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, transactionrestriction\r\n, minageyy\r\n, minagemm\r\n, maxageyy\r\n, maxagemm\r\n, intcompoundingfreqcr\r\n, intcalcfreqtypecr\r\n, intcalcfreqweekdaycr\r\n, intcalcfreqweeknumcr\r\n, intcalcfreqholidaycr\r\n, intcalcfreqstartdatecr\r\n, intcalcfreqcalendarcr\r\n, fcnrflg\r\n, staffschemeflg\r\n, eefcflg\r\n, chequebookallowed\r\n, interest\r\n, apy\r\n, tmdate\r\nFROM {{ ref('stg_los__osproduct') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__osproduct.sql", "original_file_path": "models\\base\\los\\los__osproduct.sql", "name": "los__osproduct", "alias": "los__osproduct", "checksum": {"name": "sha256", "checksum": "8cd9016f524b085c6e28b59e6072e95c837b48b62be90743558e05057d751944"}, "tags": ["los"], "refs": [["stg_los__osproduct"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__osproduct.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "osproductid", "incremental_strategy": "merge"}, "created_at": 1685959752.5099764, "compiled_code": "\nWITH source AS(\nSELECT  osproductid\n, exposurecat\n, shadowproductid\n, productcategory\n, productsubcategory\n, productname\n, productcode\n, productprocessor\n, productvalidfrom\n, intcompoundingfreqdr\n, intcalcfreqtypedr\n, intcalcfreqweekdaydr\n, intcalcfreqweeknumdr\n, intcalcfreqholidaydr\n, intcalcfreqstartdatedr\n, intcalcfreqcalendardr\n, collinterestflg\n, productvalidtill\n, producttype\n, productmanagername\n, applformtemplate\n, acctemplate\n, businessgroup\n, region\n, permittedsectorcode\n, jointholderdsr\n, programid\n, feepackageid\n, validationpackageid\n, coolingoffperiod\n, coolingoffperioddesc\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, attachmentname\n, producthandlingskill\n, iasclassification\n, availablechannels\n, lifecyclestatus\n, activate\n, statusdescription\n, remarks\n, authorisedby\n, authorisationstatus\n, authorisationremarks\n, isdeleted\n, policypackageid\n, repaymentcycle_ftr\n, repricing_ftr\n, regulatory_ftr\n, miscellaneous_ftr\n, mandatorydetails_ftr\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, productsecsubcategory\n, createdby\n, productclassification\n, eligibilitypackageid\n, creditauthorizationmatrixid\n, subsidydetails_ftr\n, systemdefinedacnum\n, payinterest\n, nonresident\n, channelflg\n, glsubheadcode\n, productgroup\n, freecode1\n, freecode2\n, freecode3\n, freetext1\n, freetext2\n, freetext3\n, transactionrestriction\n, minageyy\n, minagemm\n, maxageyy\n, maxagemm\n, intcompoundingfreqcr\n, intcalcfreqtypecr\n, intcalcfreqweekdaycr\n, intcalcfreqweeknumcr\n, intcalcfreqholidaycr\n, intcalcfreqstartdatecr\n, intcalcfreqcalendarcr\n, fcnrflg\n, staffschemeflg\n, eefcflg\n, chequebookallowed\n, interest\n, apy\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__osproduct\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__osproduct)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__osproduct"}, "model.dga_data_model.los__parentapplication": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__parentapplication"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "parentapplicationid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__parentapplication"], "unique_id": "model.dga_data_model.los__parentapplication", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'parentapplicationid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  parentapplicationid\r\n, iscorporateapplication\r\n, disclosureaccepted\r\n, customerdetailid\r\n, applicantid\r\n, issubmitted\r\n, applicationstatus\r\n, applicationreferencenumber\r\n, requestmode\r\n, decisionremark\r\n, decisionresult\r\n, reasondetails\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, ipaddress\r\n, datetime\r\n, disclosurecontextid\r\n, disclosureid\r\n, disclosureversion\r\n, disclosureconsent\r\n, disclosuredatetime\r\n, customercifid\r\n, isapplsubmitted\r\n, parentapplrefnumber\r\n, isforked\r\n, channel\r\n, opportunitiesid\r\n, isdeleted\r\n, applicationstep\r\n, aplicationstage\r\n, interimstatus\r\n, extoriginatorname\r\n, disposition\r\n, overallapplicationdecision\r\n, overalldecisionreason\r\n, overallremarks\r\n, indivapplicantdecisioncd\r\n, indivdecisionremarkscd\r\n, indivapplicantdecisionnl\r\n, indivapplicantdecisionbl\r\n, indivapplicantdecisionad\r\n, indivdecisionremarksbl\r\n, indivdecisionremarksnl\r\n, indivdecisionremarksad\r\n, stepduedate\r\n, appduedate\r\n, rlosfolderflag\r\n, indivapplicantdecision\r\n, indivdecisionremarks\r\n, licenseincremented\r\n, tmdate\r\nFROM {{ ref('stg_los__parentapplication') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__parentapplication.sql", "original_file_path": "models\\base\\los\\los__parentapplication.sql", "name": "los__parentapplication", "alias": "los__parentapplication", "checksum": {"name": "sha256", "checksum": "47c4063783798003ba6e358798f63fc0612a495be0bf42a2aba6d5ca2126f5d1"}, "tags": ["los"], "refs": [["stg_los__parentapplication"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__parentapplication.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "parentapplicationid", "incremental_strategy": "merge"}, "created_at": 1685959752.5120509, "compiled_code": "\nWITH source AS(\nSELECT  parentapplicationid\n, iscorporateapplication\n, disclosureaccepted\n, customerdetailid\n, applicantid\n, issubmitted\n, applicationstatus\n, applicationreferencenumber\n, requestmode\n, decisionremark\n, decisionresult\n, reasondetails\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, ipaddress\n, datetime\n, disclosurecontextid\n, disclosureid\n, disclosureversion\n, disclosureconsent\n, disclosuredatetime\n, customercifid\n, isapplsubmitted\n, parentapplrefnumber\n, isforked\n, channel\n, opportunitiesid\n, isdeleted\n, applicationstep\n, aplicationstage\n, interimstatus\n, extoriginatorname\n, disposition\n, overallapplicationdecision\n, overalldecisionreason\n, overallremarks\n, indivapplicantdecisioncd\n, indivdecisionremarkscd\n, indivapplicantdecisionnl\n, indivapplicantdecisionbl\n, indivapplicantdecisionad\n, indivdecisionremarksbl\n, indivdecisionremarksnl\n, indivdecisionremarksad\n, stepduedate\n, appduedate\n, rlosfolderflag\n, indivapplicantdecision\n, indivdecisionremarks\n, licenseincremented\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__parentapplication\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__parentapplication)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__parentapplication"}, "model.dga_data_model.los__person": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__person"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "personid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__person"], "unique_id": "model.dga_data_model.los__person", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'personid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  personid\r\n, middlename_alt1\r\n, lastname_alt1\r\n, firstname_alt1\r\n, orgid\r\n, persontype\r\n, lastname\r\n, firstname\r\n, gender\r\n, notes\r\n, birth_day\r\n, birth_month\r\n, birth_year\r\n, phone_home1\r\n, phone_home2\r\n, phone_work\r\n, extn\r\n, phone_cell\r\n, fax_home\r\n, fax_work\r\n, email_home\r\n, email_work\r\n, email_palm\r\n, preferredchannelid\r\n, middlename\r\n, salutation\r\n, dob\r\n, tmdate\r\nFROM {{ ref('stg_los__person') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__person.sql", "original_file_path": "models\\base\\los\\los__person.sql", "name": "los__person", "alias": "los__person", "checksum": {"name": "sha256", "checksum": "0e4178520202eeeda3dcfe7f1f5c54368ca261af675587e94801d402995f5496"}, "tags": ["los"], "refs": [["stg_los__person"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__person.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "personid", "incremental_strategy": "merge"}, "created_at": 1685959752.51398, "compiled_code": "\nWITH source AS(\nSELECT  personid\n, middlename_alt1\n, lastname_alt1\n, firstname_alt1\n, orgid\n, persontype\n, lastname\n, firstname\n, gender\n, notes\n, birth_day\n, birth_month\n, birth_year\n, phone_home1\n, phone_home2\n, phone_work\n, extn\n, phone_cell\n, fax_home\n, fax_work\n, email_home\n, email_work\n, email_palm\n, preferredchannelid\n, middlename\n, salutation\n, dob\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__person\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__person)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__person"}, "model.dga_data_model.los__rlosroutingdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__rlosroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "rlosroutingdetailsid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__rlosroutingdetails"], "unique_id": "model.dga_data_model.los__rlosroutingdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'rlosroutingdetailsid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  rlosroutingdetailsid\r\n, bank_id\r\n, opportunitiesid\r\n, assignedby\r\n, assignedto\r\n, applcomments\r\n, routetostep\r\n, routingreasoncode\r\n, routingcomments\r\n, userfield1\r\n, userfield2\r\n, userflag1\r\n, userflag2\r\n, routingdate\r\n, ishistory\r\n, routefromstep\r\n, routeto\r\n, routetype\r\n, transferredby\r\n, transferredto\r\n, transferredfrom\r\n, assignedfrom\r\n, assigneetype\r\n, assignertype\r\n, transfereetype\r\n, transferortype\r\n, opportunityproductsid\r\n, routefromstagestep\r\n, routetostagestep\r\n, decision\r\n, reason\r\n, remarks\r\n, boaclid\r\n, bocreatedby\r\n, bodatecreated\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, securityglhint\r\n, securityguhint\r\n, securityilhint\r\n, securityiuhint\r\n, tmdate\r\nFROM {{ ref('stg_los__rlosroutingdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__rlosroutingdetails.sql", "original_file_path": "models\\base\\los\\los__rlosroutingdetails.sql", "name": "los__rlosroutingdetails", "alias": "los__rlosroutingdetails", "checksum": {"name": "sha256", "checksum": "2fb042aa2f8e66fffa7c576c1a089368b802b96de670191873fb6c8ff4a7846d"}, "tags": ["los"], "refs": [["stg_los__rlosroutingdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__rlosroutingdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "rlosroutingdetailsid", "incremental_strategy": "merge"}, "created_at": 1685959752.5159068, "compiled_code": "\nWITH source AS(\nSELECT  rlosroutingdetailsid\n, bank_id\n, opportunitiesid\n, assignedby\n, assignedto\n, applcomments\n, routetostep\n, routingreasoncode\n, routingcomments\n, userfield1\n, userfield2\n, userflag1\n, userflag2\n, routingdate\n, ishistory\n, routefromstep\n, routeto\n, routetype\n, transferredby\n, transferredto\n, transferredfrom\n, assignedfrom\n, assigneetype\n, assignertype\n, transfereetype\n, transferortype\n, opportunityproductsid\n, routefromstagestep\n, routetostagestep\n, decision\n, reason\n, remarks\n, boaclid\n, bocreatedby\n, bodatecreated\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, securityglhint\n, securityguhint\n, securityilhint\n, securityiuhint\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__rlosroutingdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__rlosroutingdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__rlosroutingdetails"}, "model.dga_data_model.los__rlosworknotes": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__rlosworknotes"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "rlosworknotesid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__rlosworknotes"], "unique_id": "model.dga_data_model.los__rlosworknotes", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'rlosworknotesid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  rlosworknotesid\r\n, parentapplicationid\r\n, notecode\r\n, notedescription\r\n, userid\r\n, step\r\n, stage\r\n, creationdatetime\r\n, deletedflag\r\n, associationtype\r\n, associationid\r\n, remarks\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, tmdate\r\nFROM {{ ref('stg_los__rlosworknotes') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__rlosworknotes.sql", "original_file_path": "models\\base\\los\\los__rlosworknotes.sql", "name": "los__rlosworknotes", "alias": "los__rlosworknotes", "checksum": {"name": "sha256", "checksum": "d61ae8f424a796c3dde5c3ef5a9454b1fbcf456afb173a6ad606add991b69b5b"}, "tags": ["los"], "refs": [["stg_los__rlosworknotes"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__rlosworknotes.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "rlosworknotesid", "incremental_strategy": "merge"}, "created_at": 1685959752.5179088, "compiled_code": "\nWITH source AS(\nSELECT  rlosworknotesid\n, parentapplicationid\n, notecode\n, notedescription\n, userid\n, step\n, stage\n, creationdatetime\n, deletedflag\n, associationtype\n, associationid\n, remarks\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__rlosworknotes\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__rlosworknotes)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__rlosworknotes"}, "model.dga_data_model.los__rollback": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__rollback"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "rollbackid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__rollback"], "unique_id": "model.dga_data_model.los__rollback", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'rollbackid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  rollbackid\r\n, applicationdetailsid\r\n, reasoncode\r\n, reasondesc\r\n, rbfromstage\r\n, rbtostage\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, remarks\r\n, isdeleted\r\n, userid\r\n, rbstep\r\n, parentapplicationid\r\n, rbfromstep\r\n, rbtostep\r\n, tmdate\r\nFROM {{ ref('stg_los__rollback') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__rollback.sql", "original_file_path": "models\\base\\los\\los__rollback.sql", "name": "los__rollback", "alias": "los__rollback", "checksum": {"name": "sha256", "checksum": "e0c7465f6cb4ececcd955d6545f2d2d4db602052323078c40f00e73aa9e79bdf"}, "tags": ["los"], "refs": [["stg_los__rollback"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__rollback.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "rollbackid", "incremental_strategy": "merge"}, "created_at": 1685959752.5189824, "compiled_code": "\nWITH source AS(\nSELECT  rollbackid\n, applicationdetailsid\n, reasoncode\n, reasondesc\n, rbfromstage\n, rbtostage\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, remarks\n, isdeleted\n, userid\n, rbstep\n, parentapplicationid\n, rbfromstep\n, rbtostep\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__rollback\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__rollback)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__rollback"}, "model.dga_data_model.los__slbccodemapping": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.crmuser.slbccodemapping"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__slbccodemapping"], "unique_id": "model.dga_data_model.los__slbccodemapping", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT\r\n  bccode\r\n  , slbranchcode\r\n  , slbranchname\r\n  , specialized_bank\r\nFROM {{ source('crmuser','slbccodemapping')}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__slbccodemapping.sql", "original_file_path": "models\\base\\los\\los__slbccodemapping.sql", "name": "los__slbccodemapping", "alias": "los__slbccodemapping", "checksum": {"name": "sha256", "checksum": "b05b31f40dcc0bd9fb3894546821ccf2435b8c8ff6cc7cca13c638d8ede40b38"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "slbccodemapping"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__slbccodemapping.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "table"}, "created_at": 1685959750.783089, "compiled_code": "\nWITH source AS(\nSELECT\n  bccode\n  , slbranchcode\n  , slbranchname\n  , specialized_bank\nFROM oracle_los.crmuser.slbccodemapping\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__slbccodemapping"}, "model.dga_data_model.los__srmgroups": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__srmgroups"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "groupid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__srmgroups"], "unique_id": "model.dga_data_model.los__srmgroups", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'groupid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  groupid\r\n, bank_id\r\n, groupname_alt1\r\n, acrossentity\r\n, groupname\r\n, notes\r\n, division\r\n, product\r\n, organization\r\n, grouptype\r\n, foreignexchange\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, extensionid\r\n, coordinatorid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, gcifflag\r\n, tmdate\r\nFROM {{ ref('stg_los__srmgroups') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__srmgroups.sql", "original_file_path": "models\\base\\los\\los__srmgroups.sql", "name": "los__srmgroups", "alias": "los__srmgroups", "checksum": {"name": "sha256", "checksum": "fa1847bb20d37c33e68478332c582ae857d60b88b3d8a8c40569a648250b9b69"}, "tags": ["los"], "refs": [["stg_los__srmgroups"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__srmgroups.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "groupid", "incremental_strategy": "merge"}, "created_at": 1685959752.520981, "compiled_code": "\nWITH source AS(\nSELECT  groupid\n, bank_id\n, groupname_alt1\n, acrossentity\n, groupname\n, notes\n, division\n, product\n, organization\n, grouptype\n, foreignexchange\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, extensionid\n, coordinatorid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, gcifflag\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__srmgroups\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__srmgroups)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__srmgroups"}, "model.dga_data_model.los__syncapplicantaddressmap": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.crmuser.syncapplicantaddressmap"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__syncapplicantaddressmap"], "unique_id": "model.dga_data_model.los__syncapplicantaddressmap", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT\r\n    syncapplicantaddressmapid\r\n  , applicantaddressid\r\n  , addressdetailid\r\n  , bank_id\r\n  , bodatecreated\r\n  , bocreatedby\r\n  , bodatemodified\r\n  , bomodifiedby\r\n  , concurdetect_x\r\n  , boaclid\r\n  , securityilhint\r\n  , securityiuhint\r\n  , securityglhint\r\n  , securityguhint\r\n  ,  cast(tmdate as timestamp(3)) as tmdate\r\n\r\nFROM {{ source('crmuser','syncapplicantaddressmap')}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__syncapplicantaddressmap.sql", "original_file_path": "models\\base\\los\\los__syncapplicantaddressmap.sql", "name": "los__syncapplicantaddressmap", "alias": "los__syncapplicantaddressmap", "checksum": {"name": "sha256", "checksum": "78ea5b4ac3b94efb4c245aa70aa836f3de1c9279862fbe3c2916ba5968d83b3d"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "syncapplicantaddressmap"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__syncapplicantaddressmap.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "table"}, "created_at": 1685959750.7891598, "compiled_code": "\nWITH source AS(\nSELECT\n    syncapplicantaddressmapid\n  , applicantaddressid\n  , addressdetailid\n  , bank_id\n  , bodatecreated\n  , bocreatedby\n  , bodatemodified\n  , bomodifiedby\n  , concurdetect_x\n  , boaclid\n  , securityilhint\n  , securityiuhint\n  , securityglhint\n  , securityguhint\n  ,  cast(tmdate as timestamp(3)) as tmdate\n\nFROM oracle_los.crmuser.syncapplicantaddressmap\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__syncapplicantaddressmap"}, "model.dga_data_model.los__transactiondepartment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__transactiondepartment"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "datemodified"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "transactiondepartmentid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__transactiondepartment"], "unique_id": "model.dga_data_model.los__transactiondepartment", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'transactiondepartmentid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  transactiondepartmentid\r\n, bccode\r\n, name\r\n, standartname\r\n, areasid\r\n, isdeleted\r\n, createdby\r\n, modifiedby\r\n, freetext1\r\n, freetext2\r\n, datemodified\r\n, datecreated\r\nFROM {{ ref('stg_los__transactiondepartment') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where datemodified > (select max(datemodified) from {{ this }})\r\n  or datecreated > (select max(datecreated) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__transactiondepartment.sql", "original_file_path": "models\\base\\los\\los__transactiondepartment.sql", "name": "los__transactiondepartment", "alias": "los__transactiondepartment", "checksum": {"name": "sha256", "checksum": "e785a421cde75d64f83b84cfd72113e29a3d860485923a788ddb39e26b5bc5d1"}, "tags": ["los"], "refs": [["stg_los__transactiondepartment"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "datemodified"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__transactiondepartment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "datemodified"}, "tags": ["los"], "materialized": "incremental", "unique_key": "transactiondepartmentid", "incremental_strategy": "merge"}, "created_at": 1685959752.5229778, "compiled_code": "\nWITH source AS(\nSELECT  transactiondepartmentid\n, bccode\n, name\n, standartname\n, areasid\n, isdeleted\n, createdby\n, modifiedby\n, freetext1\n, freetext2\n, datemodified\n, datecreated\nFROM \"oracle_dgaworkzone\".staging.stg_los__transactiondepartment\n)\nSELECT * FROM source\n\n  where datemodified > (select max(datemodified) from \"oracle_dgaworkzone\".base.los__transactiondepartment)\n  or datecreated > (select max(datecreated) from \"oracle_dgaworkzone\".base.los__transactiondepartment)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__transactiondepartment"}, "model.dga_data_model.los__useractiontray": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__useractiontray"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "useractiontrayid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__useractiontray"], "unique_id": "model.dga_data_model.los__useractiontray", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'useractiontrayid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  useractiontrayid\r\n, loginid\r\n, useractiontraytype\r\n, useractiontraytypeid\r\n, assigneeid\r\n, ownerid\r\n, assigneegroupid\r\n, ownergroupid\r\n, userfield1\r\n, userfield2\r\n, userflag1\r\n, userflag2\r\n, applicationstage\r\n, routetype\r\n, routeto\r\n, processnamespace\r\n, bank_id\r\n, bodatecreated\r\n, bocreatedby\r\n, bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, processid\r\n, processname\r\n, stepid\r\n, activityid\r\n, appduedate\r\n, stepduedate\r\n, tmdate\r\nFROM {{ ref('stg_los__useractiontray') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__useractiontray.sql", "original_file_path": "models\\base\\los\\los__useractiontray.sql", "name": "los__useractiontray", "alias": "los__useractiontray", "checksum": {"name": "sha256", "checksum": "88344ae51ad35b549cff7d55e46ae14120602093f2634c3072792fce8bd153e5"}, "tags": ["los"], "refs": [["stg_los__useractiontray"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__useractiontray.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "useractiontrayid", "incremental_strategy": "merge"}, "created_at": 1685959752.52699, "compiled_code": "\nWITH source AS(\nSELECT  useractiontrayid\n, loginid\n, useractiontraytype\n, useractiontraytypeid\n, assigneeid\n, ownerid\n, assigneegroupid\n, ownergroupid\n, userfield1\n, userfield2\n, userflag1\n, userflag2\n, applicationstage\n, routetype\n, routeto\n, processnamespace\n, bank_id\n, bodatecreated\n, bocreatedby\n, bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, processid\n, processname\n, stepid\n, activityid\n, appduedate\n, stepduedate\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__useractiontray\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__useractiontray)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__useractiontray"}, "model.dga_data_model.los__users": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__users"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "personid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__users"], "unique_id": "model.dga_data_model.los__users", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'personid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  personid\r\n, usertype\r\n, loginid\r\n, password\r\n, screenid\r\n, active\r\n, isinternaluser\r\n, available\r\n, locale\r\n, timezone\r\n, cifidaccess\r\n, custrelation\r\n, tmdate\r\nFROM {{ ref('stg_los__users') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__users.sql", "original_file_path": "models\\base\\los\\los__users.sql", "name": "los__users", "alias": "los__users", "checksum": {"name": "sha256", "checksum": "e9388a9ea9d15d2270e425ec375b75d3bf5c094b51ca569c9767a360a3e453ba"}, "tags": ["los"], "refs": [["stg_los__users"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__users.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "personid", "incremental_strategy": "merge"}, "created_at": 1685959752.528978, "compiled_code": "\nWITH source AS(\nSELECT  personid\n, usertype\n, loginid\n, password\n, screenid\n, active\n, isinternaluser\n, available\n, locale\n, timezone\n, cifidaccess\n, custrelation\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__users\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__users)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__users"}, "model.dga_data_model.los__user_groups": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__user_groups"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "groupaccessid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "los", "los__user_groups"], "unique_id": "model.dga_data_model.los__user_groups", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'groupaccessid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  groupaccessid\r\n, bank_id\r\n, roleid\r\n, extensionid\r\n, groupid\r\n, personid\r\n, tmdate\r\nFROM {{ ref('stg_los__user_groups') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\los\\los__user_groups.sql", "original_file_path": "models\\base\\los\\los__user_groups.sql", "name": "los__user_groups", "alias": "los__user_groups", "checksum": {"name": "sha256", "checksum": "f0f12da378eeb59a204db55f386185074de9b344e5fec8a760aa3a9eb928251f"}, "tags": ["los"], "refs": [["stg_los__user_groups"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "tmdate"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\los\\los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los__user_groups.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "tmdate"}, "tags": ["los"], "materialized": "incremental", "unique_key": "groupaccessid", "incremental_strategy": "merge"}, "created_at": 1685959752.524978, "compiled_code": "\nWITH source AS(\nSELECT  groupaccessid\n, bank_id\n, roleid\n, extensionid\n, groupid\n, personid\n, tmdate\nFROM \"oracle_dgaworkzone\".staging.stg_los__user_groups\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".base.los__user_groups)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.los__user_groups"}, "model.dga_data_model.mercury__tbl_applicant_enterprise_income": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_applicant_enterprise_income"], "unique_id": "model.dga_data_model.mercury__tbl_applicant_enterprise_income", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n        id\r\n        , version\r\n        , employer_name\r\n        , is_deleted\r\n        , ward\r\n        , industry\r\n        , profit\r\n        , district\r\n        , customer_profit\r\n        , expenses\r\n        , business_registration_id\r\n        , revenue\r\n        , applicant_income_id\r\n        , weight_of_cap_contrib\r\n        , city\r\n        , address_line1\r\n        , evaluation_period_mth\r\n        , issue_date\r\n        , authorized_capital\r\n        , income\r\n        , remark\r\n        , recent_change_date\r\n        , credit_reputation\r\n        , profit_margin\r\n        , evaluation_period\r\n        , business_production_process\r\n        , recording_method\r\n        , business_scale\r\n        , location_ownership_form\r\n        , original_source\r\n        , inventory\r\n        , output\r\n        , primary_product\r\n        , business_type\r\n  FROM {{ ref('stg_mercury__tbl_applicant_enterprise_income') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_applicant_enterprise_income.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_applicant_enterprise_income.sql", "name": "mercury__tbl_applicant_enterprise_income", "alias": "mercury__tbl_applicant_enterprise_income", "checksum": {"name": "sha256", "checksum": "5e1305c68ed927118ac2f76b24369cfb4c2a5937d9b6def4f63d22182f4e5075"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_applicant_enterprise_income"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_applicant_enterprise_income.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "phuongnt89"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.5799773, "compiled_code": "\nWITH source AS (\n  SELECT\n        id\n        , version\n        , employer_name\n        , is_deleted\n        , ward\n        , industry\n        , profit\n        , district\n        , customer_profit\n        , expenses\n        , business_registration_id\n        , revenue\n        , applicant_income_id\n        , weight_of_cap_contrib\n        , city\n        , address_line1\n        , evaluation_period_mth\n        , issue_date\n        , authorized_capital\n        , income\n        , remark\n        , recent_change_date\n        , credit_reputation\n        , profit_margin\n        , evaluation_period\n        , business_production_process\n        , recording_method\n        , business_scale\n        , location_ownership_form\n        , original_source\n        , inventory\n        , output\n        , primary_product\n        , business_type\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_applicant_enterprise_income\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_applicant_enterprise_income"}, "model.dga_data_model.mercury__tbl_css_eb_applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_css_eb_applicant"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "sync_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_css_eb_applicant"], "unique_id": "model.dga_data_model.mercury__tbl_css_eb_applicant", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n        id\r\n        , version\r\n        , sync_date\r\n        , newest\r\n        , id_ho_so\r\n        , chi_nhanh\r\n        , sync_by\r\n        , cif_num\r\n        , xep_hang\r\n        , full_name\r\n        , business_registration_number\r\n        , eb_application_id\r\n        , muc_dich_captd\r\n        , nganh_kt\r\n        , hook1\r\n        , nhom_kt_chinh\r\n        , hook2\r\n        , khu_vuc\r\n        , lhdn\r\n  FROM {{ ref('stg_mercury__tbl_css_eb_applicant') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_css_eb_applicant.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_css_eb_applicant.sql", "name": "mercury__tbl_css_eb_applicant", "alias": "mercury__tbl_css_eb_applicant", "checksum": {"name": "sha256", "checksum": "d172badc9f889503cc0dc91e37d6b9a745ac1e38636c7b4a9a442ded928c56f1"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_css_eb_applicant"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "sync_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_css_eb_applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "sync_date"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.5709882, "compiled_code": "\nWITH source AS(\n  SELECT\n        id\n        , version\n        , sync_date\n        , newest\n        , id_ho_so\n        , chi_nhanh\n        , sync_by\n        , cif_num\n        , xep_hang\n        , full_name\n        , business_registration_number\n        , eb_application_id\n        , muc_dich_captd\n        , nganh_kt\n        , hook1\n        , nhom_kt_chinh\n        , hook2\n        , khu_vuc\n        , lhdn\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_css_eb_applicant\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_css_eb_applicant"}, "model.dga_data_model.mercury__tbl_doc_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_detail_clean"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_doc_detail"], "unique_id": "model.dga_data_model.mercury__tbl_doc_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n   \t  id\r\n    , version\r\n    , sub_type\r\n    , created_at\r\n    , newest\r\n    , number_prop1\r\n    , updated_at\r\n    , updated_by\r\n    , type\r\n    , process_instance_id\r\n    , created_by\r\n    , doc_version\r\n    , doc_template_id\r\n    , doc_need_list_id\r\n    , byte_prop1\r\n    , draft_version\r\n    , otp_verified\r\n    , is_deleted\r\n    , total_collateral_kvalue\r\n    , total_collateral_value\r\n    , duration\r\n    , ckdt_hmcs\r\n    , ckdt_month\r\n    , ckdt_text\r\n    , details\r\n    , approval_suggestion\r\n    , reject_reason\r\n    , maximum_amount\r\n  FROM {{ ref('stg_mercury__tbl_doc_detail_clean') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_doc_detail.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_doc_detail.sql", "name": "mercury__tbl_doc_detail", "alias": "mercury__tbl_doc_detail", "checksum": {"name": "sha256", "checksum": "0e12934a4778c0ff9dace9b0dcb6e44bad487e93e5c990a0f3faffcdfda506eb"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_doc_detail_clean"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_doc_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.5729764, "compiled_code": "\nWITH source AS (\n  SELECT\n   \t  id\n    , version\n    , sub_type\n    , created_at\n    , newest\n    , number_prop1\n    , updated_at\n    , updated_by\n    , type\n    , process_instance_id\n    , created_by\n    , doc_version\n    , doc_template_id\n    , doc_need_list_id\n    , byte_prop1\n    , draft_version\n    , otp_verified\n    , is_deleted\n    , total_collateral_kvalue\n    , total_collateral_value\n    , duration\n    , ckdt_hmcs\n    , ckdt_month\n    , ckdt_text\n    , details\n    , approval_suggestion\n    , reject_reason\n    , maximum_amount\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_detail_clean\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_doc_detail"}, "model.dga_data_model.mercury__tbl_doc_need_list": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_need_list"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_doc_need_list"], "unique_id": "model.dga_data_model.mercury__tbl_doc_need_list", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n    id\r\n    , version\r\n    , query_params\r\n    , created_at\r\n    , doc_template_code\r\n    , name\r\n    , process_instance_id\r\n    , upload_log_id\r\n    , status\r\n    , is_deleted\r\n    , deleted_at\r\n    , string_prop1\r\n    , otp_required\r\n    , props\r\n    , override_upload_log_id\r\n    , can_auto_generate\r\n    , path\r\n    , ord\r\n    , is_processing\r\n    , override_upload_log_ids\r\n    , generate_error_content\r\n    , eb_request_id\r\n  FROM {{ ref('stg_mercury__tbl_doc_need_list') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_doc_need_list.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_doc_need_list.sql", "name": "mercury__tbl_doc_need_list", "alias": "mercury__tbl_doc_need_list", "checksum": {"name": "sha256", "checksum": "23d9eb392a77e8166bb61768ee159ec210370c3768982ab3abc7cfa18ced874d"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_doc_need_list"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_doc_need_list.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.574977, "compiled_code": "\nWITH source AS(\n  SELECT\n    id\n    , version\n    , query_params\n    , created_at\n    , doc_template_code\n    , name\n    , process_instance_id\n    , upload_log_id\n    , status\n    , is_deleted\n    , deleted_at\n    , string_prop1\n    , otp_required\n    , props\n    , override_upload_log_id\n    , can_auto_generate\n    , path\n    , ord\n    , is_processing\n    , override_upload_log_ids\n    , generate_error_content\n    , eb_request_id\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_need_list\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_doc_need_list"}, "model.dga_data_model.mercury__tbl_doc_no_hist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_no_hist"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_doc_no_hist"], "unique_id": "model.dga_data_model.mercury__tbl_doc_no_hist", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n    id\r\n    , version\r\n    , sub_type\r\n    , created_at\r\n    , number_prop1\r\n    , type\r\n    , process_instance_id\r\n    , created_by\r\n    , inc_num\r\n    , number_prop2\r\n    , composite_doc_no\r\n    , doc_template_id\r\n    , doc_need_list_id\r\n    , approve_date\r\n    , sub_num\r\n  FROM {{ ref('stg_mercury__tbl_doc_no_hist') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_doc_no_hist.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_doc_no_hist.sql", "name": "mercury__tbl_doc_no_hist", "alias": "mercury__tbl_doc_no_hist", "checksum": {"name": "sha256", "checksum": "6205d88ee6f0f20754e761ffcad8eed4ab2fb801dcf99b6e098c958eb564deca"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_doc_no_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_doc_no_hist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.575978, "compiled_code": "\nWITH source AS(\n  SELECT\n    id\n    , version\n    , sub_type\n    , created_at\n    , number_prop1\n    , type\n    , process_instance_id\n    , created_by\n    , inc_num\n    , number_prop2\n    , composite_doc_no\n    , doc_template_id\n    , doc_need_list_id\n    , approve_date\n    , sub_num\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_no_hist\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_doc_no_hist"}, "model.dga_data_model.mercury__tbl_eb_applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_eb_applicant"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_eb_applicant"], "unique_id": "model.dga_data_model.mercury__tbl_eb_applicant", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n   \tid\r\n    , version\r\n    , created_at\r\n    , process_instance_id\r\n    , created_by\r\n    , cif_num\r\n    , full_name\r\n    , eb_application_id\r\n    , business_registration_number\r\n    , branch_name\r\n    , composite_status\r\n    , props\r\n    , row_number() OVER(PARTITION BY VERSION, process_instance_id, created_by, eb_application_id ORDER BY ID DESC) AS rn\r\n  FROM {{ ref('stg_mercury__tbl_eb_applicant') }}\r\n)\r\nSELECT * FROM source\r\nWHERE rn = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_eb_applicant.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_eb_applicant.sql", "name": "mercury__tbl_eb_applicant", "alias": "mercury__tbl_eb_applicant", "checksum": {"name": "sha256", "checksum": "5cc5c68dfb5dc4dc81126ce0ced1196aace3f34a42e7ff76b208d5d73c6d3e0f"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_eb_applicant"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_eb_applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.5779786, "compiled_code": "\nWITH source AS(\n  SELECT\n   \tid\n    , version\n    , created_at\n    , process_instance_id\n    , created_by\n    , cif_num\n    , full_name\n    , eb_application_id\n    , business_registration_number\n    , branch_name\n    , composite_status\n    , props\n    , row_number() OVER(PARTITION BY VERSION, process_instance_id, created_by, eb_application_id ORDER BY ID DESC) AS rn\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_applicant\n)\nSELECT * FROM source\nWHERE rn = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_eb_applicant"}, "model.dga_data_model.mercury__tbl_eb_application": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_eb_application"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "mercury", "mercury__tbl_eb_application"], "unique_id": "model.dga_data_model.mercury__tbl_eb_application", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n    id\r\n    , version\r\n    , css_sync_status\r\n    , is_deleted\r\n    , los_app_ref_num\r\n    , industry\r\n    , customer_segment\r\n    , collateral_count\r\n    , process_instance_id\r\n    , deleted_by\r\n    , other_industry\r\n    , limit_type\r\n    , approval_minutes_type\r\n    , css_id\r\n    , deleted_at\r\n    , created_at\r\n    , editing_purpose\r\n    , approval_suggestion\r\n    , limit_sub_type\r\n    , expire_time\r\n    , created_by\r\n    , status\r\n    , los_sync_status\r\n    , area\r\n    , criteriamet_flg\r\n    , roles\r\n    , composite_status\r\n  FROM {{ ref('stg_mercury__tbl_eb_application') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\mercury\\mercury__tbl_eb_application.sql", "original_file_path": "models\\base\\mercury\\mercury__tbl_eb_application.sql", "name": "mercury__tbl_eb_application", "alias": "mercury__tbl_eb_application", "checksum": {"name": "sha256", "checksum": "04ac2a641aeef8ba810bf3e14e2701d925d26fc3495ef1e3afd34992079946ea"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_eb_application"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\mercury\\mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\mercury\\mercury__tbl_eb_application.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.5789788, "compiled_code": "\nWITH source AS(\n  SELECT\n    id\n    , version\n    , css_sync_status\n    , is_deleted\n    , los_app_ref_num\n    , industry\n    , customer_segment\n    , collateral_count\n    , process_instance_id\n    , deleted_by\n    , other_industry\n    , limit_type\n    , approval_minutes_type\n    , css_id\n    , deleted_at\n    , created_at\n    , editing_purpose\n    , approval_suggestion\n    , limit_sub_type\n    , expire_time\n    , created_by\n    , status\n    , los_sync_status\n    , area\n    , criteriamet_flg\n    , roles\n    , composite_status\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_application\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.mercury__tbl_eb_application"}, "model.dga_data_model.qlhs__customer_active_df": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dbo.customer_active_df"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "qlhs", "qlhs__customer_active_df"], "unique_id": "model.dga_data_model.qlhs__customer_active_df", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nSELECT\r\n    cast(yearmonth AS integer) AS yearmonth\r\n  , cifno\r\n  , cus_open_date\r\n  , cfindi\r\n  , casa\r\n  , fd\r\n  , loan_sl\r\n  , loan_usl\r\n  , loan_oth\r\n  , od\r\n  , pb\r\n  , mcc\r\n  , debit\r\n  , banca_pbo_cas\r\n  , banca_oth\r\n  , spdt\r\n  , ib\r\n  , mb\r\n  , ib_mb\r\n  , sms\r\n  , total\r\n  , \"segment lv2\"\r\n  , \"segment lv1\"\r\n  , fcb\r\n  , inputter\r\n  FROM\r\n    {{ source('dbo', 'customer_active_df' ) }}\r\n\r\n{% if is_incremental() %}\r\n\r\nWHERE yearmonth > (SELECT MAX (yearmonth) FROM {{ this }})\r\n\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\qlhs\\qlhs__customer_active_df.sql", "original_file_path": "models\\base\\qlhs\\qlhs__customer_active_df.sql", "name": "qlhs__customer_active_df", "alias": "qlhs__customer_active_df", "checksum": {"name": "sha256", "checksum": "aff6d7b821e8fc4eca70d6bc884b11c9bb8c0548577bc5677c764b76cba6710e"}, "tags": [], "refs": [], "sources": [["dbo", "customer_active_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\qlhs\\qlhs.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs__customer_active_df.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "incremental"}, "created_at": 1685959752.5799773, "compiled_code": "\nSELECT\n    cast(yearmonth AS integer) AS yearmonth\n  , cifno\n  , cus_open_date\n  , cfindi\n  , casa\n  , fd\n  , loan_sl\n  , loan_usl\n  , loan_oth\n  , od\n  , pb\n  , mcc\n  , debit\n  , banca_pbo_cas\n  , banca_oth\n  , spdt\n  , ib\n  , mb\n  , ib_mb\n  , sms\n  , total\n  , \"segment lv2\"\n  , \"segment lv1\"\n  , fcb\n  , inputter\n  FROM\n    sql_server_qlhs.dbo.customer_active_df\n\n\n\nWHERE yearmonth > (SELECT MAX (yearmonth) FROM \"oracle_dgaworkzone\".base.qlhs__customer_active_df)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.qlhs__customer_active_df"}, "model.dga_data_model.qlhs__customer_product_holding_df": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dbo.customer_product_holding_df"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "qlhs", "qlhs__customer_product_holding_df"], "unique_id": "model.dga_data_model.qlhs__customer_product_holding_df", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nSELECT\r\n    cast(yearmonth AS integer) AS yearmonth\r\n  , cifno\r\n  , cus_name\r\n  , cus_open_date\r\n  , dob\r\n  , cfindi\r\n  , casa\r\n  , fd\r\n  , loan_sl\r\n  , loan_usl\r\n  , loan_oth\r\n  , od\r\n  , pb\r\n  , mcc\r\n  , debit\r\n  , banca_pbo_cas\r\n  , banca_oth\r\n  , spdt\r\n  , ib\r\n  , mb\r\n  , ib_mb\r\n  , sms\r\n  , total\r\n  , fcb\r\n  , tuoi\r\n  , phannhom\r\n  , area_1\r\n  , area_2\r\n  , area_3\r\n  , area_5\r\n  , area_6a\r\n  , area_6b\r\n  , area_7\r\n  , area_8\r\n  , area_9\r\n  , area_10\r\n  , area_11\r\n  , hub_hn_1\r\n  , hub_hn_2\r\n  , hub_hcm\r\n  , hub\r\n  , fcb_area\r\n  , so_vung\r\n  , mien_bac\r\n  , mien_nam\r\n  , \"segment lv2\"\r\n  , \"segment lv1\"\r\n  , inputter\r\n  , gender\r\n  , old_fcb\r\n  FROM\r\n    {{ source('dbo', 'customer_product_holding_df' ) }}\r\n  {% if is_incremental() %}\r\n  WHERE yearmonth > (SELECT MAX (yearmonth) FROM {{ this }})\r\n\r\n  {% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\qlhs\\qlhs__customer_product_holding_df.sql", "original_file_path": "models\\base\\qlhs\\qlhs__customer_product_holding_df.sql", "name": "qlhs__customer_product_holding_df", "alias": "qlhs__customer_product_holding_df", "checksum": {"name": "sha256", "checksum": "d4c64a2e2c03c075c2d9594cb3612ba854713e593dd3785b241f5cbed7de5af4"}, "tags": [], "refs": [], "sources": [["dbo", "customer_product_holding_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\qlhs\\qlhs.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs__customer_product_holding_df.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "incremental"}, "created_at": 1685959752.5809789, "compiled_code": "\nSELECT\n    cast(yearmonth AS integer) AS yearmonth\n  , cifno\n  , cus_name\n  , cus_open_date\n  , dob\n  , cfindi\n  , casa\n  , fd\n  , loan_sl\n  , loan_usl\n  , loan_oth\n  , od\n  , pb\n  , mcc\n  , debit\n  , banca_pbo_cas\n  , banca_oth\n  , spdt\n  , ib\n  , mb\n  , ib_mb\n  , sms\n  , total\n  , fcb\n  , tuoi\n  , phannhom\n  , area_1\n  , area_2\n  , area_3\n  , area_5\n  , area_6a\n  , area_6b\n  , area_7\n  , area_8\n  , area_9\n  , area_10\n  , area_11\n  , hub_hn_1\n  , hub_hn_2\n  , hub_hcm\n  , hub\n  , fcb_area\n  , so_vung\n  , mien_bac\n  , mien_nam\n  , \"segment lv2\"\n  , \"segment lv1\"\n  , inputter\n  , gender\n  , old_fcb\n  FROM\n    sql_server_qlhs.dbo.customer_product_holding_df\n  \n  WHERE yearmonth > (SELECT MAX (yearmonth) FROM \"oracle_dgaworkzone\".base.qlhs__customer_product_holding_df)\n\n  ", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.qlhs__customer_product_holding_df"}, "model.dga_data_model.qlhs__data_toi": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.dbo.data_toi_df"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "qlhs", "qlhs__data_toi"], "unique_id": "model.dga_data_model.qlhs__data_toi", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nSELECT\r\n    cast(yearmonth AS integer) AS yearmonth\r\n  , cifno\r\n  , amt\r\n  , level_i\r\n  , level_ii\r\n  , level_iii\r\n  FROM\r\n    {{ source('dbo', 'data_toi_df' ) }}\r\n  {% if is_incremental() %}\r\n  WHERE CAST (yearmonth AS INTEGER) > (SELECT MAX (yearmonth) FROM {{ this }})\r\n\r\n  {% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\qlhs\\qlhs__data_toi.sql", "original_file_path": "models\\base\\qlhs\\qlhs__data_toi.sql", "name": "qlhs__data_toi", "alias": "qlhs__data_toi", "checksum": {"name": "sha256", "checksum": "7b8e8a32dc791c8f3a4f8c1a53dc03ccf477da9f309c3021bf46e9312f60fd40"}, "tags": [], "refs": [], "sources": [["dbo", "data_toi_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\qlhs\\qlhs.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs__data_toi.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "materialized": "incremental"}, "created_at": 1685959752.5809789, "compiled_code": "\nSELECT\n    cast(yearmonth AS integer) AS yearmonth\n  , cifno\n  , amt\n  , level_i\n  , level_ii\n  , level_iii\n  FROM\n    sql_server_qlhs.dbo.data_toi_df\n  \n  WHERE CAST (yearmonth AS INTEGER) > (SELECT MAX (yearmonth) FROM \"oracle_dgaworkzone\".base.qlhs__data_toi)\n\n  ", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.qlhs__data_toi"}, "model.dga_data_model.tms__tbl_daily_performance": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_tms__tbldailyperformance"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "process_time"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "tms", "tms__tbl_daily_performance"], "unique_id": "model.dga_data_model.tms__tbl_daily_performance", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nSELECT *\r\nFROM {{ ref('stg_tms__tbldailyperformance')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\tms\\tms__tbl_daily_performance.sql", "original_file_path": "models\\base\\tms\\tms__tbl_daily_performance.sql", "name": "tms__tbl_daily_performance", "alias": "tms__tbl_daily_performance", "checksum": {"name": "sha256", "checksum": "5dea0d6bb26b37a047fde9a70b6e310ae8edf3c8c11334a28512fae6e740259c"}, "tags": ["vhkq_daily"], "refs": [["stg_tms__tbldailyperformance"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "process_time"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\tms\\base_tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\tms\\tms__tbl_daily_performance.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "process_time"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.5929067, "compiled_code": "\nSELECT *\nFROM \"oracle_dgaworkzone\".staging.stg_tms__tbldailyperformance", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.tms__tbl_daily_performance"}, "model.dga_data_model.tms__tbl_event": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_tms__tblevent"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "dstart"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "ieventid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "tms", "tms__tbl_event"], "unique_id": "model.dga_data_model.tms__tbl_event", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'ieventid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nSELECT *\r\nFROM {{ ref('stg_tms__tblevent')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\tms\\tms__tbl_event.sql", "original_file_path": "models\\base\\tms\\tms__tbl_event.sql", "name": "tms__tbl_event", "alias": "tms__tbl_event", "checksum": {"name": "sha256", "checksum": "a00cf53ceb1d679d111240ec208660065455d59c11012b4b1d6081c64ad65953"}, "tags": ["vhkq_daily"], "refs": [["stg_tms__tblevent"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "dstart"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\tms\\base_tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\tms\\tms__tbl_event.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "dstart"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "ieventid", "incremental_strategy": "merge"}, "created_at": 1685959752.5949152, "compiled_code": "\nSELECT *\nFROM \"oracle_dgaworkzone\".staging.stg_tms__tblevent", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.tms__tbl_event"}, "model.dga_data_model.tms__tbl_event_history": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_tms__tbleventhistory"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "dstart"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "ieventhistoryid", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "tms", "tms__tbl_event_history"], "unique_id": "model.dga_data_model.tms__tbl_event_history", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'ieventhistoryid',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nSELECT *\r\nFROM  {{ ref('stg_tms__tbleventhistory')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\tms\\tms__tbl_event_history.sql", "original_file_path": "models\\base\\tms\\tms__tbl_event_history.sql", "name": "tms__tbl_event_history", "alias": "tms__tbl_event_history", "checksum": {"name": "sha256", "checksum": "ba52e93a24084f93556bf062b3b5d6b156099da566a68ea0815c17ec8719dc9b"}, "tags": ["vhkq_daily"], "refs": [["stg_tms__tbleventhistory"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "dstart"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\tms\\base_tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\tms\\tms__tbl_event_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "dstart"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "ieventhistoryid", "incremental_strategy": "merge"}, "created_at": 1685959752.5969164, "compiled_code": "\nSELECT *\nFROM  \"oracle_dgaworkzone\".staging.stg_tms__tbleventhistory", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.tms__tbl_event_history"}, "model.dga_data_model.tms__tbl_incident": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_tms__tblincident"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "starttime"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "tms", "tms__tbl_incident"], "unique_id": "model.dga_data_model.tms__tbl_incident", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nSELECT *\r\nFROM  {{ ref('stg_tms__tblincident')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\tms\\tms__tbl_incident.sql", "original_file_path": "models\\base\\tms\\tms__tbl_incident.sql", "name": "tms__tbl_incident", "alias": "tms__tbl_incident", "checksum": {"name": "sha256", "checksum": "f2bbd7643f58f1f0d1993a108a1b72d9f10e73b20321883f740acda0f7864df4"}, "tags": ["vhkq_daily"], "refs": [["stg_tms__tblincident"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "starttime"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\tms\\base_tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\tms\\tms__tbl_incident.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "starttime"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.5989065, "compiled_code": "\nSELECT *\nFROM  \"oracle_dgaworkzone\".staging.stg_tms__tblincident", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.tms__tbl_incident"}, "model.dga_data_model.tms__tbl_incident_history": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_tms__tblincidenthistory"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "starttime"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "tms", "tms__tbl_incident_history"], "unique_id": "model.dga_data_model.tms__tbl_incident_history", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nSELECT *\r\nFROM  {{ ref('stg_tms__tblincidenthistory')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\tms\\tms__tbl_incident_history.sql", "original_file_path": "models\\base\\tms\\tms__tbl_incident_history.sql", "name": "tms__tbl_incident_history", "alias": "tms__tbl_incident_history", "checksum": {"name": "sha256", "checksum": "b9a06e0e15076c6c5fb05a86da40de42f925c7c3da41c8232a414143503d3c81"}, "tags": ["vhkq_daily"], "refs": [["stg_tms__tblincidenthistory"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "starttime"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\tms\\base_tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\tms\\tms__tbl_incident_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "starttime"}, "tags": ["vhkq_daily"], "materialized": "incremental", "unique_key": "id", "incremental_strategy": "merge"}, "created_at": 1685959752.599907, "compiled_code": "\nSELECT *\nFROM  \"oracle_dgaworkzone\".staging.stg_tms__tblincidenthistory", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.tms__tbl_incident_history"}, "model.dga_data_model.vision__build_schedules_details_audit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.build_schedules_details_audit"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "bal_eb_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__build_schedules_details_audit"], "unique_id": "model.dga_data_model.vision__build_schedules_details_audit", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      build_number\r\n    , sub_build_number\r\n    , bsd_sequence\r\n    , country\r\n    , le_book\r\n    , associated_build\r\n    , build_module\r\n    , run_it_at\r\n    , run_it\r\n    , program_type_at\r\n    , program_type\r\n    , progress_percent\r\n    , module_status_at\r\n    , module_status\r\n    , debug_mode\r\n    , start_time\r\n    , end_time\r\n    , date_last_modified\r\n    , date_creation\r\n    , build_name\r\n    , full_build_flag\r\n    , business_date\r\n  FROM {{ source('vision', 'build_schedules_details_audit') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__build_schedules_details_audit.sql", "original_file_path": "models\\base\\vision\\vision__build_schedules_details_audit.sql", "name": "vision__build_schedules_details_audit", "alias": "vision__build_schedules_details_audit", "checksum": {"name": "sha256", "checksum": "d9a41d5083ba685e6bbef57302da200b2d092ba3a3dfeeacff6314c4bd66b814"}, "tags": ["vision_etl", "bal_eb_daily"], "refs": [], "sources": [["vision", "build_schedules_details_audit"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__build_schedules_details_audit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["bal_eb_daily"], "materialized": "table"}, "created_at": 1685959752.6169803, "compiled_code": "\nWITH source AS(\n  SELECT\n      build_number\n    , sub_build_number\n    , bsd_sequence\n    , country\n    , le_book\n    , associated_build\n    , build_module\n    , run_it_at\n    , run_it\n    , program_type_at\n    , program_type\n    , progress_percent\n    , module_status_at\n    , module_status\n    , debug_mode\n    , start_time\n    , end_time\n    , date_last_modified\n    , date_creation\n    , build_name\n    , full_build_flag\n    , business_date\n  FROM oracle_vision.vision.build_schedules_details_audit\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__build_schedules_details_audit"}, "model.dga_data_model.vision__contracts": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_vision_tmp__contracts"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "contract_sequence_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__contracts"], "unique_id": "model.dga_data_model.vision__contracts", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key='contract_sequence_number',\r\n)\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      contract_sequence_number\r\n    , country\r\n    , le_book\r\n    , customer_id\r\n    , contract_id\r\n    , record_type_nt\r\n    , record_type\r\n    , source_id_nt\r\n    , source_id\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , account_officer\r\n    , issue_id\r\n    , deal_type\r\n    , deal_sub_type\r\n    , start_date\r\n    , maturity_date\r\n    , settlement_date\r\n    , days_remaining_mat\r\n    , days_start_mat\r\n    , accrual_status_nt\r\n    , accrual_status\r\n    , contract_status_nt\r\n    , contract_status\r\n    , principal_gl\r\n    , principal_amount\r\n    , mis_currency\r\n    , pool_code\r\n    , interest_rate\r\n    , cost_of_funds_rate\r\n    , gl_enrich_id\r\n    , date_last_modified\r\n    , date_creation\r\n    , status_nt\r\n    , status\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n  FROM {{ ref('stg_vision_tmp__contracts')}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__contracts.sql", "original_file_path": "models\\base\\vision\\vision__contracts.sql", "name": "vision__contracts", "alias": "vision__contracts", "checksum": {"name": "sha256", "checksum": "29c50f4925a21a40f249ff9fec70a12527caeb34a33c8f569afc73ee2881cb85"}, "tags": ["vision_etl"], "refs": [["stg_vision_tmp__contracts"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__contracts.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "incremental", "unique_key": "contract_sequence_number"}, "created_at": 1685959752.6019783, "compiled_code": "\nWITH source AS(\n  SELECT\n      contract_sequence_number\n    , country\n    , le_book\n    , customer_id\n    , contract_id\n    , record_type_nt\n    , record_type\n    , source_id_nt\n    , source_id\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , account_officer\n    , issue_id\n    , deal_type\n    , deal_sub_type\n    , start_date\n    , maturity_date\n    , settlement_date\n    , days_remaining_mat\n    , days_start_mat\n    , accrual_status_nt\n    , accrual_status\n    , contract_status_nt\n    , contract_status\n    , principal_gl\n    , principal_amount\n    , mis_currency\n    , pool_code\n    , interest_rate\n    , cost_of_funds_rate\n    , gl_enrich_id\n    , date_last_modified\n    , date_creation\n    , status_nt\n    , status\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n  FROM \"oracle_dgaworkzone\".staging.stg_vision_tmp__contracts\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__contracts"}, "model.dga_data_model.vision__currency_rates_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.currency_rates_daily"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__currency_rates_daily"], "unique_id": "model.dga_data_model.vision__currency_rates_daily", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , category\r\n    , currency\r\n    , rate_start_month\r\n    , rate_01\r\n    , rate_02\r\n    , rate_03\r\n    , rate_04\r\n    , rate_05\r\n    , rate_06\r\n    , rate_07\r\n    , rate_08\r\n    , rate_09\r\n    , rate_10\r\n    , rate_11\r\n    , rate_12\r\n    , rate_13\r\n    , rate_14\r\n    , rate_15\r\n    , rate_16\r\n    , rate_17\r\n    , rate_18\r\n    , rate_19\r\n    , rate_20\r\n    , rate_21\r\n    , rate_22\r\n    , rate_23\r\n    , rate_24\r\n    , rate_25\r\n    , rate_26\r\n    , rate_27\r\n    , rate_28\r\n    , rate_29\r\n    , rate_30\r\n    , rate_31\r\n    , ccy_rate_status_nt\r\n    , ccy_rate_status\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ source('vision', 'currency_rates_daily') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__currency_rates_daily.sql", "original_file_path": "models\\base\\vision\\vision__currency_rates_daily.sql", "name": "vision__currency_rates_daily", "alias": "vision__currency_rates_daily", "checksum": {"name": "sha256", "checksum": "b677fd8223bd4a5f81ade70a67633c913811cdf2f310c7f3970be59aa81ddf45"}, "tags": ["vision_etl"], "refs": [], "sources": [["vision", "currency_rates_daily"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__currency_rates_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table"}, "created_at": 1685959752.6039782, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , category\n    , currency\n    , rate_start_month\n    , rate_01\n    , rate_02\n    , rate_03\n    , rate_04\n    , rate_05\n    , rate_06\n    , rate_07\n    , rate_08\n    , rate_09\n    , rate_10\n    , rate_11\n    , rate_12\n    , rate_13\n    , rate_14\n    , rate_15\n    , rate_16\n    , rate_17\n    , rate_18\n    , rate_19\n    , rate_20\n    , rate_21\n    , rate_22\n    , rate_23\n    , rate_24\n    , rate_25\n    , rate_26\n    , rate_27\n    , rate_28\n    , rate_29\n    , rate_30\n    , rate_31\n    , ccy_rate_status_nt\n    , ccy_rate_status\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.currency_rates_daily\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__currency_rates_daily"}, "model.dga_data_model.vision__customers": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_vision_tmp__customers"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "customer_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__customers"], "unique_id": "model.dga_data_model.vision__customers", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key='customer_id'\r\n)\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , customer_id\r\n    , customer_name\r\n    , customer_acronym\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , global_customer_id\r\n    , naics_code\r\n    , cb_org_code_at\r\n    , cb_org_code\r\n    , cb_economic_act_code_at\r\n    , cb_economic_act_code\r\n    , cb_domicile\r\n    , cb_nationality\r\n    , cb_residence\r\n    , cb_major_party_indicator\r\n    , customer_id_type_at\r\n    , customer_id_type\r\n    , id_details\r\n    , primary_cid\r\n    , parent_cid\r\n    , ultimate_parent\r\n    , customer_hierarchy_1\r\n    , customer_hierarchy_2\r\n    , customer_hierarchy_3\r\n    , account_officer\r\n    , customer_sex_at\r\n    , customer_sex\r\n    , credit_classification_at\r\n    , credit_classification\r\n    , external_risk_rating_at\r\n    , external_risk_rating\r\n    , obligor_risk_rating_at\r\n    , obligor_risk_rating\r\n    , related_party_at\r\n    , related_party\r\n    , customer_tiering_at\r\n    , customer_tiering\r\n    , sales_acquisition_channel_at\r\n    , sales_acquisition_channel\r\n    , marketing_campaign\r\n    , crosssale_refer_id\r\n    , customer_indicator_at\r\n    , customer_indicator\r\n    , num_of_accounts\r\n    , customer_attribute_1\r\n    , customer_attribute_2\r\n    , customer_attribute_3\r\n    , customer_status_nt\r\n    , customer_status\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n    , customer_open_date\r\n    , comm_address_1\r\n    , comm_address_2\r\n    , comm_city_at\r\n    , comm_city\r\n    , comm_state_at\r\n    , comm_state\r\n    , comm_pin_code\r\n    , phone_number\r\n    , customer_tin\r\n    , customer_type_code_at\r\n    , customer_type_code\r\n    , profit_center\r\n    , customer_segment_at\r\n    , customer_segment\r\n    , customer_user_segment_at\r\n    , customer_user_segment\r\n  FROM {{ ref('stg_vision_tmp__customers') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__customers.sql", "original_file_path": "models\\base\\vision\\vision__customers.sql", "name": "vision__customers", "alias": "vision__customers", "checksum": {"name": "sha256", "checksum": "2c5e6f273c2354be5b14cce9fe3d8317e42dabcad8fa69e509f54fd9c99ad46f"}, "tags": ["vision_etl"], "refs": [["stg_vision_tmp__customers"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__customers.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "incremental", "unique_key": "customer_id"}, "created_at": 1685959752.6049783, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , customer_id\n    , customer_name\n    , customer_acronym\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , global_customer_id\n    , naics_code\n    , cb_org_code_at\n    , cb_org_code\n    , cb_economic_act_code_at\n    , cb_economic_act_code\n    , cb_domicile\n    , cb_nationality\n    , cb_residence\n    , cb_major_party_indicator\n    , customer_id_type_at\n    , customer_id_type\n    , id_details\n    , primary_cid\n    , parent_cid\n    , ultimate_parent\n    , customer_hierarchy_1\n    , customer_hierarchy_2\n    , customer_hierarchy_3\n    , account_officer\n    , customer_sex_at\n    , customer_sex\n    , credit_classification_at\n    , credit_classification\n    , external_risk_rating_at\n    , external_risk_rating\n    , obligor_risk_rating_at\n    , obligor_risk_rating\n    , related_party_at\n    , related_party\n    , customer_tiering_at\n    , customer_tiering\n    , sales_acquisition_channel_at\n    , sales_acquisition_channel\n    , marketing_campaign\n    , crosssale_refer_id\n    , customer_indicator_at\n    , customer_indicator\n    , num_of_accounts\n    , customer_attribute_1\n    , customer_attribute_2\n    , customer_attribute_3\n    , customer_status_nt\n    , customer_status\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n    , customer_open_date\n    , comm_address_1\n    , comm_address_2\n    , comm_city_at\n    , comm_city\n    , comm_state_at\n    , comm_state\n    , comm_pin_code\n    , phone_number\n    , customer_tin\n    , customer_type_code_at\n    , customer_type_code\n    , profit_center\n    , customer_segment_at\n    , customer_segment\n    , customer_user_segment_at\n    , customer_user_segment\n  FROM \"oracle_dgaworkzone\".staging.stg_vision_tmp__customers\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__customers"}, "model.dga_data_model.vision__eb_bal_offbs_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.eb_datasource.huong_atf_vision_mth_2023"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__eb_bal_offbs_monthly"], "unique_id": "model.dga_data_model.vision__eb_bal_offbs_monthly", "raw_code": "{{\r\n  config(\r\n    materialized='incremental'\r\n  )\r\n}}\r\n\r\nWITH source AS (\r\n    SELECT\r\n        year_month\r\n        , customer_id\r\n        , contract_id\r\n        , vision_ouc\r\n        , vision_sbu\r\n        , account_officer\r\n        , cost_center\r\n        , currency\r\n        , sdck\r\n        , sdtb\r\n        , toi\r\n        , brnname\r\n        , type1\r\n        , type2\r\n        , vung\r\n        , masorm\r\n        , nganh_kh\r\n        , brn\r\n        , pgd\r\n        , nam\r\n        , thang\r\n        , issue_date\r\n        , expiry_date\r\n        , trnor\r\n        , tenor_code\r\n        , deal_type\r\n        , so_ref\r\n        , masorm_new\r\n        , masocrm_new\r\n    FROM {{ source('eb_datasource', 'huong_atf_vision_mth_2023') }}\r\n    {% if is_incremental() %}\r\n    WHERE year_month > (SELECT MAX(year_month) FROM {{ this }} )\r\n    {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__eb_bal_offbs_monthly.sql", "original_file_path": "models\\base\\vision\\vision__eb_bal_offbs_monthly.sql", "name": "vision__eb_bal_offbs_monthly", "alias": "vision__eb_bal_offbs_monthly", "checksum": {"name": "sha256", "checksum": "72338df4267fcf033442b4c122a4c635342cf28c3eeb5d899b4f96d0db69453d"}, "tags": ["vision_etl"], "refs": [], "sources": [["eb_datasource", "huong_atf_vision_mth_2023"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__eb_bal_offbs_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "vision_etl", "materialized": "incremental"}, "created_at": 1685959750.8562875, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        year_month\n        , customer_id\n        , contract_id\n        , vision_ouc\n        , vision_sbu\n        , account_officer\n        , cost_center\n        , currency\n        , sdck\n        , sdtb\n        , toi\n        , brnname\n        , type1\n        , type2\n        , vung\n        , masorm\n        , nganh_kh\n        , brn\n        , pgd\n        , nam\n        , thang\n        , issue_date\n        , expiry_date\n        , trnor\n        , tenor_code\n        , deal_type\n        , so_ref\n        , masorm_new\n        , masocrm_new\n    FROM oracle_vision.eb_datasource.huong_atf_vision_mth_2023\n    \n    WHERE year_month > (SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".base.vision__eb_bal_offbs_monthly )\n    \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__eb_bal_offbs_monthly"}, "model.dga_data_model.vision__eb_bal_onbs_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.eb_datasource.zcustomersall_2023"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__eb_bal_onbs_monthly"], "unique_id": "model.dga_data_model.vision__eb_bal_onbs_monthly", "raw_code": "{{\r\n  config(\r\n    materialized='incremental'\r\n  )\r\n}}\r\n\r\nWITH source AS (\r\n    SELECT\r\n        data_date\r\n        , brn\r\n        , cifno\r\n        , contract_id\r\n        , acname\r\n        , cbal\r\n        , qvnd\r\n        , currency\r\n        , vision_sbu\r\n        , app\r\n        , heso\r\n        , dc\r\n        , bank\r\n        , cost_center\r\n        , account_officer\r\n        , nhom_no_truoc_cic\r\n        , start_date\r\n        , ghichu\r\n        , kyhan\r\n        , pgd_goc\r\n        , rate\r\n        , thang\r\n        , nam\r\n        , maturity_date\r\n        , term_qd\r\n        , kyhans\r\n        , currency2\r\n        , brn_goc\r\n        , type1\r\n        , type2\r\n        , type3\r\n        , brnname\r\n        , purcode\r\n        , use_of_fund\r\n        , qvnd_mrate\r\n        , vung\r\n        , nganh_kh\r\n        , trade_loan\r\n        , vision_ouc\r\n        , mrl_line\r\n        , nhom_no_sau_cic\r\n        , masorm_new\r\n        , masocrm_new\r\n    FROM {{ source('eb_datasource', 'zcustomersall_2023') }}\r\n    {% if is_incremental() %}\r\n    WHERE data_date > (SELECT MAX(data_date) FROM {{ this }} )\r\n    {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__eb_bal_onbs_monthly.sql", "original_file_path": "models\\base\\vision\\vision__eb_bal_onbs_monthly.sql", "name": "vision__eb_bal_onbs_monthly", "alias": "vision__eb_bal_onbs_monthly", "checksum": {"name": "sha256", "checksum": "a4bc9ef70b85aefade5be4bcc1d4541f3a2d07484529555f9f4002333cd112ed"}, "tags": ["vision_etl"], "refs": [], "sources": [["eb_datasource", "zcustomersall_2023"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__eb_bal_onbs_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "vision_etl", "materialized": "incremental"}, "created_at": 1685959750.8612874, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        data_date\n        , brn\n        , cifno\n        , contract_id\n        , acname\n        , cbal\n        , qvnd\n        , currency\n        , vision_sbu\n        , app\n        , heso\n        , dc\n        , bank\n        , cost_center\n        , account_officer\n        , nhom_no_truoc_cic\n        , start_date\n        , ghichu\n        , kyhan\n        , pgd_goc\n        , rate\n        , thang\n        , nam\n        , maturity_date\n        , term_qd\n        , kyhans\n        , currency2\n        , brn_goc\n        , type1\n        , type2\n        , type3\n        , brnname\n        , purcode\n        , use_of_fund\n        , qvnd_mrate\n        , vung\n        , nganh_kh\n        , trade_loan\n        , vision_ouc\n        , mrl_line\n        , nhom_no_sau_cic\n        , masorm_new\n        , masocrm_new\n    FROM oracle_vision.eb_datasource.zcustomersall_2023\n    \n    WHERE data_date > (SELECT MAX(data_date) FROM \"oracle_dgaworkzone\".base.vision__eb_bal_onbs_monthly )\n    \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__eb_bal_onbs_monthly"}, "model.dga_data_model.vision__eb_cst_status_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.eb_datasource.trang_thai_kh_2023"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__eb_cst_status_monthly"], "unique_id": "model.dga_data_model.vision__eb_cst_status_monthly", "raw_code": "{{\r\n  config(\r\n    materialized='incremental'\r\n  )\r\n}}\r\n\r\nWITH source AS (\r\n    SELECT\r\n        year_month\r\n        , cifno\r\n        , acname\r\n        , brn\r\n        , nhcd\r\n        , cus_open_date\r\n        , cif_status_final\r\n        , subtype_final\r\n        , type_final\r\n        , chinhanh_cifrm\r\n        , mien_cifrm\r\n        , nganh_kh\r\n        , lad\r\n        , kh_td_status\r\n        , kh_ptd_status\r\n        , thang_kh_td_roibo\r\n        , thang_kh_ptd_roibo\r\n        , thang_kh_roibo_final\r\n        , trangthai_kh_roibo_final\r\n        , dauhieu_kh_roibo\r\n    FROM {{ source('eb_datasource', 'trang_thai_kh_2023') }}\r\n    {% if is_incremental() %}\r\n    WHERE year_month > (SELECT MAX(year_month) FROM {{ this }} )\r\n    {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__eb_cst_status_monthly.sql", "original_file_path": "models\\base\\vision\\vision__eb_cst_status_monthly.sql", "name": "vision__eb_cst_status_monthly", "alias": "vision__eb_cst_status_monthly", "checksum": {"name": "sha256", "checksum": "1e2499b309e3cd481df0ca7d711da80a0f65c7219b0ca0140cd581dbc247a553"}, "tags": ["vision_etl"], "refs": [], "sources": [["eb_datasource", "trang_thai_kh_2023"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__eb_cst_status_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "vision_etl", "materialized": "incremental"}, "created_at": 1685959750.8662877, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        year_month\n        , cifno\n        , acname\n        , brn\n        , nhcd\n        , cus_open_date\n        , cif_status_final\n        , subtype_final\n        , type_final\n        , chinhanh_cifrm\n        , mien_cifrm\n        , nganh_kh\n        , lad\n        , kh_td_status\n        , kh_ptd_status\n        , thang_kh_td_roibo\n        , thang_kh_ptd_roibo\n        , thang_kh_roibo_final\n        , trangthai_kh_roibo_final\n        , dauhieu_kh_roibo\n    FROM oracle_vision.eb_datasource.trang_thai_kh_2023\n    \n    WHERE year_month > (SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".base.vision__eb_cst_status_monthly )\n    \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__eb_cst_status_monthly"}, "model.dga_data_model.vision__eb_prd_holding_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.eb_datasource.tambtt3_sanpham_kh_sudung_2023"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__eb_prd_holding_monthly"], "unique_id": "model.dga_data_model.vision__eb_prd_holding_monthly", "raw_code": "{{\r\n  config(\r\n    materialized='incremental'\r\n  )\r\n}}\r\n\r\nWITH source AS (\r\n    SELECT\r\n        nam\r\n        , thang\r\n        , cifno\r\n        , segment\r\n        , vung\r\n        , brnname\r\n        , product\r\n        , phan_loai_kh\r\n        , CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) AS year_month\r\n    FROM {{ source('eb_datasource', 'tambtt3_sanpham_kh_sudung_2023') }}\r\n    {% if is_incremental() %}\r\n    WHERE CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) > (\r\n        SELECT MAX(year_month) FROM {{ this }}\r\n        )\r\n    {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__eb_prd_holding_monthly.sql", "original_file_path": "models\\base\\vision\\vision__eb_prd_holding_monthly.sql", "name": "vision__eb_prd_holding_monthly", "alias": "vision__eb_prd_holding_monthly", "checksum": {"name": "sha256", "checksum": "ad80d5ddabe34d354b5d376a4e08718babb61f37604c48b97503fdde18433f9e"}, "tags": ["vision_etl"], "refs": [], "sources": [["eb_datasource", "tambtt3_sanpham_kh_sudung_2023"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__eb_prd_holding_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "vision_etl", "materialized": "incremental"}, "created_at": 1685959750.8712876, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        nam\n        , thang\n        , cifno\n        , segment\n        , vung\n        , brnname\n        , product\n        , phan_loai_kh\n        , CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) AS year_month\n    FROM oracle_vision.eb_datasource.tambtt3_sanpham_kh_sudung_2023\n    \n    WHERE CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) > (\n        SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".base.vision__eb_prd_holding_monthly\n        )\n    \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__eb_prd_holding_monthly"}, "model.dga_data_model.vision__eb_toi_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.eb_datasource.zlnthang_cif_ftpnew_2023"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__eb_toi_monthly"], "unique_id": "model.dga_data_model.vision__eb_toi_monthly", "raw_code": "{{\r\n  config(\r\n    materialized='incremental'\r\n  )\r\n}}\r\n\r\nWITH source AS (\r\n    SELECT\r\n        bank\r\n        , brn\r\n        , cifno\r\n        , type\r\n        , curtyp\r\n        , acctgl\r\n        , app\r\n        , thang\r\n        , nam\r\n        , amt\r\n        , dorc\r\n        , dc\r\n        , ghichu\r\n        , pgd\r\n        , sme_chiphi\r\n        , nganh_kh\r\n        , nhom_no_truoc_cic\r\n        , kyhans\r\n        , type1\r\n        , type_org\r\n        , masorm\r\n        , type3\r\n        , type2\r\n        , type4\r\n        , acctno\r\n        , bank1\r\n        , ma_chiphi\r\n        , brn_org\r\n        , brnname\r\n        , vung\r\n        , trade_loan\r\n        , code_new\r\n        , vision_ouc\r\n        , mrl_line\r\n        , code\r\n        , nhom_no_sau_cic\r\n        , masorm_new\r\n        , masocrm_new\r\n        , CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) AS year_month\r\n    FROM {{ source('eb_datasource', 'zlnthang_cif_ftpnew_2023') }}\r\n    {% if is_incremental() %}\r\n    WHERE CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) > (\r\n        SELECT MAX(year_month) FROM {{ this }}\r\n        )\r\n    {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__eb_toi_monthly.sql", "original_file_path": "models\\base\\vision\\vision__eb_toi_monthly.sql", "name": "vision__eb_toi_monthly", "alias": "vision__eb_toi_monthly", "checksum": {"name": "sha256", "checksum": "531ce248e3c5afeba3a947a9ced6bf12219e01dc347da5a18f43991c62ab0210"}, "tags": ["vision_etl"], "refs": [], "sources": [["eb_datasource", "zlnthang_cif_ftpnew_2023"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__eb_toi_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "vision_etl", "materialized": "incremental"}, "created_at": 1685959750.8752873, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        bank\n        , brn\n        , cifno\n        , type\n        , curtyp\n        , acctgl\n        , app\n        , thang\n        , nam\n        , amt\n        , dorc\n        , dc\n        , ghichu\n        , pgd\n        , sme_chiphi\n        , nganh_kh\n        , nhom_no_truoc_cic\n        , kyhans\n        , type1\n        , type_org\n        , masorm\n        , type3\n        , type2\n        , type4\n        , acctno\n        , bank1\n        , ma_chiphi\n        , brn_org\n        , brnname\n        , vung\n        , trade_loan\n        , code_new\n        , vision_ouc\n        , mrl_line\n        , code\n        , nhom_no_sau_cic\n        , masorm_new\n        , masocrm_new\n        , CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) AS year_month\n    FROM oracle_vision.eb_datasource.zlnthang_cif_ftpnew_2023\n    \n    WHERE CAST(CAST(nam AS varchar(4))||lpad(CAST(thang AS varchar(2)),2,'0') AS INT) > (\n        SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".base.vision__eb_toi_monthly\n        )\n    \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__eb_toi_monthly"}, "model.dga_data_model.vision__fin_dly_audit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.fin_dly_audit"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__fin_dly_audit"], "unique_id": "model.dga_data_model.vision__fin_dly_audit", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , adj_reference\r\n    , adj_sequence\r\n    , customer_id\r\n    , gl_enrich_id\r\n    , contract_id\r\n    , office_account\r\n    , bs_gl\r\n    , pl_gl\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , account_officer\r\n    , cost_center\r\n    , currency\r\n    , mis_currency\r\n    , accrual_status_nt\r\n    , accrual_status\r\n    , credit_line\r\n    , pool_code\r\n    , source_id_nt\r\n    , source_id\r\n    , record_type_nt\r\n    , record_type\r\n    , original_ouc\r\n    , financial_attribute_1\r\n    , financial_attribute_2\r\n    , financial_attribute_3\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ source('vision', 'fin_dly_audit') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__fin_dly_audit.sql", "original_file_path": "models\\base\\vision\\vision__fin_dly_audit.sql", "name": "vision__fin_dly_audit", "alias": "vision__fin_dly_audit", "checksum": {"name": "sha256", "checksum": "a6b322aa9570758d2b5d3e03ee6fd52aeeba4364f931dcaf743e09ead3c1cef9"}, "tags": ["vision_etl"], "refs": [], "sources": [["vision", "fin_dly_audit"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__fin_dly_audit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table"}, "created_at": 1685959752.606907, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , adj_reference\n    , adj_sequence\n    , customer_id\n    , gl_enrich_id\n    , contract_id\n    , office_account\n    , bs_gl\n    , pl_gl\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , account_officer\n    , cost_center\n    , currency\n    , mis_currency\n    , accrual_status_nt\n    , accrual_status\n    , credit_line\n    , pool_code\n    , source_id_nt\n    , source_id\n    , record_type_nt\n    , record_type\n    , original_ouc\n    , financial_attribute_1\n    , financial_attribute_2\n    , financial_attribute_3\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.fin_dly_audit\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__fin_dly_audit"}, "model.dga_data_model.vision__fin_dly_balances": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_vision_tmp__fin_dly_balances"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["COUNTRY", "LE_BOOK", "YEAR_MONTH", "SEQUENCE_FD", "DR_CR_BAL_IND", "BAL_TYPE"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__fin_dly_balances"], "unique_id": "model.dga_data_model.vision__fin_dly_balances", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"COUNTRY\", \"LE_BOOK\", \"YEAR_MONTH\", \"SEQUENCE_FD\", \"DR_CR_BAL_IND\", \"BAL_TYPE\"]\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , dr_cr_bal_ind\r\n    , bal_type_nt\r\n    , bal_type\r\n    , bal_start_month\r\n    , balance_01\r\n    , balance_02\r\n    , balance_03\r\n    , balance_04\r\n    , balance_05\r\n    , balance_06\r\n    , balance_07\r\n    , balance_08\r\n    , balance_09\r\n    , balance_10\r\n    , balance_11\r\n    , balance_12\r\n    , balance_13\r\n    , balance_14\r\n    , balance_15\r\n    , balance_16\r\n    , balance_17\r\n    , balance_18\r\n    , balance_19\r\n    , balance_20\r\n    , balance_21\r\n    , balance_22\r\n    , balance_23\r\n    , balance_24\r\n    , balance_25\r\n    , balance_26\r\n    , balance_27\r\n    , balance_28\r\n    , balance_29\r\n    , balance_30\r\n    , balance_31\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ ref('stg_vision_tmp__fin_dly_balances' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__fin_dly_balances.sql", "original_file_path": "models\\base\\vision\\vision__fin_dly_balances.sql", "name": "vision__fin_dly_balances", "alias": "vision__fin_dly_balances", "checksum": {"name": "sha256", "checksum": "ddf7e791411a993255aa577654e15a7f6c1e1f1e593874cfbb364d388bc4788d"}, "tags": ["vision_etl"], "refs": [["stg_vision_tmp__fin_dly_balances"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__fin_dly_balances.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "incremental", "unique_key": ["COUNTRY", "LE_BOOK", "YEAR_MONTH", "SEQUENCE_FD", "DR_CR_BAL_IND", "BAL_TYPE"]}, "created_at": 1685959752.608986, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , dr_cr_bal_ind\n    , bal_type_nt\n    , bal_type\n    , bal_start_month\n    , balance_01\n    , balance_02\n    , balance_03\n    , balance_04\n    , balance_05\n    , balance_06\n    , balance_07\n    , balance_08\n    , balance_09\n    , balance_10\n    , balance_11\n    , balance_12\n    , balance_13\n    , balance_14\n    , balance_15\n    , balance_16\n    , balance_17\n    , balance_18\n    , balance_19\n    , balance_20\n    , balance_21\n    , balance_22\n    , balance_23\n    , balance_24\n    , balance_25\n    , balance_26\n    , balance_27\n    , balance_28\n    , balance_29\n    , balance_30\n    , balance_31\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM \"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_balances\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__fin_dly_balances"}, "model.dga_data_model.vision__fin_dly_headers": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_vision_tmp__fin_dly_headers"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["COUNTRY", "LE_BOOK", "YEAR_MONTH", "SEQUENCE_FD", "CONTRACT_ID", "BS_GL"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__fin_dly_headers"], "unique_id": "model.dga_data_model.vision__fin_dly_headers", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"COUNTRY\", \"LE_BOOK\", \"YEAR_MONTH\", \"SEQUENCE_FD\", \"CONTRACT_ID\", \"BS_GL\"]\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , customer_id\r\n    , gl_enrich_id\r\n    , contract_id\r\n    , office_account\r\n    , bs_gl\r\n    , pl_gl\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , account_officer\r\n    , cost_center\r\n    , currency\r\n    , mis_currency\r\n    , accrual_status_nt\r\n    , accrual_status\r\n    , credit_line\r\n    , pool_code\r\n    , source_id_nt\r\n    , source_id\r\n    , record_type_nt\r\n    , record_type\r\n    , original_ouc\r\n    , financial_attribute_1\r\n    , financial_attribute_2\r\n    , financial_attribute_3\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ ref('stg_vision_tmp__fin_dly_headers' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__fin_dly_headers.sql", "original_file_path": "models\\base\\vision\\vision__fin_dly_headers.sql", "name": "vision__fin_dly_headers", "alias": "vision__fin_dly_headers", "checksum": {"name": "sha256", "checksum": "ba8a2a6149cfab5d37075ae4a76a05e5c5185040f63a9da8f43899834b885209"}, "tags": ["vision_etl"], "refs": [["stg_vision_tmp__fin_dly_headers"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__fin_dly_headers.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "incremental", "unique_key": ["COUNTRY", "LE_BOOK", "YEAR_MONTH", "SEQUENCE_FD", "CONTRACT_ID", "BS_GL"]}, "created_at": 1685959752.609987, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , customer_id\n    , gl_enrich_id\n    , contract_id\n    , office_account\n    , bs_gl\n    , pl_gl\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , account_officer\n    , cost_center\n    , currency\n    , mis_currency\n    , accrual_status_nt\n    , accrual_status\n    , credit_line\n    , pool_code\n    , source_id_nt\n    , source_id\n    , record_type_nt\n    , record_type\n    , original_ouc\n    , financial_attribute_1\n    , financial_attribute_2\n    , financial_attribute_3\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM \"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_headers\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__fin_dly_headers"}, "model.dga_data_model.vision__fin_dly_mappings": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_vision_tmp__fin_dly_mappings"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["COUNTRY", "LE_BOOK", "YEAR_MONTH", "SEQUENCE_FD", "DR_CR_BAL_IND"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__fin_dly_mappings"], "unique_id": "model.dga_data_model.vision__fin_dly_mappings", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"COUNTRY\", \"LE_BOOK\", \"YEAR_MONTH\", \"SEQUENCE_FD\", \"DR_CR_BAL_IND\"]\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , dr_cr_bal_ind\r\n    , frl_line_bs\r\n    , frl_line_pl\r\n    , mrl_line\r\n    , product\r\n    , gl_product\r\n    , ouc_override\r\n    , ouc_product\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ ref('stg_vision_tmp__fin_dly_mappings' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__fin_dly_mappings.sql", "original_file_path": "models\\base\\vision\\vision__fin_dly_mappings.sql", "name": "vision__fin_dly_mappings", "alias": "vision__fin_dly_mappings", "checksum": {"name": "sha256", "checksum": "54e393aeab56971f53eb03deacb38ef3a4e42c24eac7afd4429bc1d11c27f747"}, "tags": ["vision_etl"], "refs": [["stg_vision_tmp__fin_dly_mappings"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__fin_dly_mappings.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "incremental", "unique_key": ["COUNTRY", "LE_BOOK", "YEAR_MONTH", "SEQUENCE_FD", "DR_CR_BAL_IND"]}, "created_at": 1685959752.6119814, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , dr_cr_bal_ind\n    , frl_line_bs\n    , frl_line_pl\n    , mrl_line\n    , product\n    , gl_product\n    , ouc_override\n    , ouc_product\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM \"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_mappings\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__fin_dly_mappings"}, "model.dga_data_model.vision__ftp_term_rates": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_vision__ftp_term_rates"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3", "date_column": "effective_date"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["ftp_rate_id", "effective_date"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__ftp_term_rates"], "unique_id": "model.dga_data_model.vision__ftp_term_rates", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"ftp_rate_id\", \"effective_date\"],\r\n    incremental_strategy = 'merge'\r\n  )\r\n}}\r\nwith dat as(\r\n    SELECT\r\n        ftp_rate_id,\r\n        effective_date,\r\n        ftp_curve,\r\n        ftp_rate_status_nt,\r\n        ftp_rate_status,\r\n        record_indicator_nt,\r\n        record_indicator,\r\n        maker,\r\n        verifier,\r\n        internal_status,\r\n        date_last_modified,\r\n        date_creation,\r\n        insurance_rate,\r\n        required_reserve_rate,\r\n        gl_allocation_rate,\r\n        subsidy,\r\n        addon_deposit_rate,\r\n        addon_lending_rate,\r\n        addon_att_rate1,\r\n        addon_att_rate2,\r\n        addon_att_rate3,\r\n        addon_att_rate4\r\n   FROM {{ ref ('stg_vision__ftp_term_rates') }}\r\n)\r\nselect *\r\nfrom dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__ftp_term_rates.sql", "original_file_path": "models\\base\\vision\\vision__ftp_term_rates.sql", "name": "vision__ftp_term_rates", "alias": "vision__ftp_term_rates", "checksum": {"name": "sha256", "checksum": "53346ebc583caa8f4d917b5a2ef6c3a7e322fdea334a868312cbe2eea9b40a6f"}, "tags": ["vision_etl"], "refs": [["stg_vision__ftp_term_rates"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "effective_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__ftp_term_rates.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "effective_date"}, "tags": ["vision_etl"], "materialized": "incremental", "unique_key": ["ftp_rate_id", "effective_date"], "incremental_strategy": "merge"}, "created_at": 1685959752.6149783, "compiled_code": "\nwith dat as(\n    SELECT\n        ftp_rate_id,\n        effective_date,\n        ftp_curve,\n        ftp_rate_status_nt,\n        ftp_rate_status,\n        record_indicator_nt,\n        record_indicator,\n        maker,\n        verifier,\n        internal_status,\n        date_last_modified,\n        date_creation,\n        insurance_rate,\n        required_reserve_rate,\n        gl_allocation_rate,\n        subsidy,\n        addon_deposit_rate,\n        addon_lending_rate,\n        addon_att_rate1,\n        addon_att_rate2,\n        addon_att_rate3,\n        addon_att_rate4\n   FROM \"oracle_dgaworkzone\".staging.stg_vision__ftp_term_rates\n)\nselect *\nfrom dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__ftp_term_rates"}, "model.dga_data_model.vision__mgt_expanded": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.mgt_expanded"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["vision_etl", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "vision", "vision__mgt_expanded"], "unique_id": "model.dga_data_model.vision__mgt_expanded", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      mgt_line_level\r\n    , mgt_line\r\n    , source_mgt_line\r\n    , source_mgt_balance_sign\r\n    , mrl_line\r\n    , bal_type\r\n    , source_mrl_line\r\n    , source_bal_type\r\n    , source_mrl_balance_sign\r\n    , bal_type_nt\r\n    , mgt_line_level_description\r\n    , source_type_nt\r\n    , source_type\r\n    , mgt_line_description\r\n    , mgt_line_short_desc\r\n    , mgt_type_nt\r\n    , mgt_type\r\n    , mgt_status_nt\r\n    , mgt_status\r\n    , ytd_calc_nt\r\n    , ytd_calc\r\n    , sign_change\r\n    , better_worse_ind\r\n    , conversion\r\n    , maker\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM {{ source('vision', 'mgt_expanded') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\vision\\vision__mgt_expanded.sql", "original_file_path": "models\\base\\vision\\vision__mgt_expanded.sql", "name": "vision__mgt_expanded", "alias": "vision__mgt_expanded", "checksum": {"name": "sha256", "checksum": "fc582d22f3bb6dd57b7d04b55da29382a88babcbda80ee48bc24d7428bf2b91b"}, "tags": ["vision_etl"], "refs": [], "sources": [["vision", "mgt_expanded"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\vision\\vision__mgt_expanded.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table"}, "created_at": 1685959752.6139774, "compiled_code": "\nWITH source AS(\n  SELECT\n      mgt_line_level\n    , mgt_line\n    , source_mgt_line\n    , source_mgt_balance_sign\n    , mrl_line\n    , bal_type\n    , source_mrl_line\n    , source_bal_type\n    , source_mrl_balance_sign\n    , bal_type_nt\n    , mgt_line_level_description\n    , source_type_nt\n    , source_type\n    , mgt_line_description\n    , mgt_line_short_desc\n    , mgt_type_nt\n    , mgt_type\n    , mgt_status_nt\n    , mgt_status\n    , ytd_calc_nt\n    , ytd_calc\n    , sign_change\n    , better_worse_ind\n    , conversion\n    , maker\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.mgt_expanded\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.vision__mgt_expanded"}, "model.dga_data_model.way4__account": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.msb.account"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["way4_daily"], "meta": {"owner": "huyendtk3", "date_column": "cycle_date_from"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "way4", "way4__account"], "unique_id": "model.dga_data_model.way4__account", "raw_code": "{{ config( materialized='table') }}\r\nSELECT\r\n    id\r\n  , acnt_contract__oid\r\n  , code\r\n  , curr\r\n  , acat\r\n  , due_type\r\n  , account_type\r\n  , account_name\r\n  , account_number\r\n  , gl_number\r\n  , acc_templ__id\r\n  , main_account\r\n  , alter_account\r\n  , due_account\r\n  , alter_due_account\r\n  , low_lim_account\r\n  , upp_lim_account\r\n  , low_lim_amount\r\n  , upp_lim_amount\r\n  , begin_balance\r\n  , current_balance\r\n  , total_blocked\r\n  , own_blocked\r\n  , charge_for_open\r\n  , cycle_date_from\r\n  , cycle_date_to\r\n  , interest_rate\r\n  , interest_account\r\n  , is_am_available\r\n  , payment_priority\r\n  , n_of_cycle\r\n  , top_account\r\n  , ageing_priority\r\n  , interest_fee_rate\r\n  , on_date\r\n  , on_date_balance\r\n  , routing_idt\r\n  , apply_dt\r\n  , local_version\r\n  , remote_version\r\nFROM\r\n  {{ source('msb', 'account' ) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\way4\\way4__account.sql", "original_file_path": "models\\base\\way4\\way4__account.sql", "name": "way4__account", "alias": "way4__account", "checksum": {"name": "sha256", "checksum": "6c7e0a1ca420bb61dfe892f048b4388c1f8a086aef4fe7c1ed904ed5494b901e"}, "tags": ["way4_daily"], "refs": [], "sources": [["msb", "account"]], "metrics": [], "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "cycle_date_from"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\way4\\base_way4.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\way4__account.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "cycle_date_from"}, "tags": "way4_daily", "materialized": "table"}, "created_at": 1685959752.6249766, "compiled_code": "\nSELECT\n    id\n  , acnt_contract__oid\n  , code\n  , curr\n  , acat\n  , due_type\n  , account_type\n  , account_name\n  , account_number\n  , gl_number\n  , acc_templ__id\n  , main_account\n  , alter_account\n  , due_account\n  , alter_due_account\n  , low_lim_account\n  , upp_lim_account\n  , low_lim_amount\n  , upp_lim_amount\n  , begin_balance\n  , current_balance\n  , total_blocked\n  , own_blocked\n  , charge_for_open\n  , cycle_date_from\n  , cycle_date_to\n  , interest_rate\n  , interest_account\n  , is_am_available\n  , payment_priority\n  , n_of_cycle\n  , top_account\n  , ageing_priority\n  , interest_fee_rate\n  , on_date\n  , on_date_balance\n  , routing_idt\n  , apply_dt\n  , local_version\n  , remote_version\nFROM\n  oracle_way4.msb.account", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.way4__account"}, "model.dga_data_model.way4__acnt_contract": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_way4__acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["way4_daily"], "meta": {"owner": "huyendtk3", "date_column": "amnd_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "way4", "way4__acnt_contract"], "unique_id": "model.dga_data_model.way4__acnt_contract", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key='id'\r\n  )\r\n}}\r\nSELECT\r\n    amnd_date\r\n  , amnd_state\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , pcat\r\n  , con_cat\r\n  , terminal_category\r\n  , ccat\r\n  , f_i\r\n  , branch\r\n  , service_group\r\n  , contract_number\r\n  , contract_name\r\n  , comment_text\r\n  , base_relation\r\n  , relation_tag\r\n  , acnt_contract__id\r\n  , contr_type\r\n  , contr_subtype__id\r\n  , serv_pack__id\r\n  , old_pack\r\n  , channel\r\n  , acc_scheme__id\r\n  , old_scheme\r\n  , product\r\n  , product_prev\r\n  , parent_product\r\n  , main_product\r\n  , client__id\r\n  , client_type\r\n  , acnt_contract__oid\r\n  , liab_category\r\n  , liab_contract\r\n  , liab_contract_prev\r\n  , behavior_group\r\n  , behavior_type\r\n  , behavior_type_prev\r\n  , check_available\r\n  , check_usage\r\n  , curr\r\n  , old_curr\r\n  , auth_limit_amount\r\n  , base_auth_limit\r\n  , liab_balance\r\n  , liab_blocked\r\n  , own_balance\r\n  , own_blocked\r\n  , sub_balance\r\n  , sub_blocked\r\n  , total_blocked\r\n  , total_balance\r\n  , shared_balance\r\n  , shared_blocked\r\n  , amount_available\r\n  , date_open\r\n  , date_expire\r\n  , last_billing_date\r\n  , next_billing_date\r\n  , last_scan\r\n  , card_expire\r\n  , production_status\r\n  , rbs_member_id\r\n  , rbs_number\r\n  , report_type\r\n  , max_pin_attempts\r\n  , pin_attempts\r\n  , chip_scheme\r\n  , risk_scheme\r\n  , risk_factor\r\n  , risk_factor_prev\r\n  , contr_status\r\n  , merchant_id\r\n  , tr_title\r\n  , tr_company\r\n  , tr_country\r\n  , tr_first_nam\r\n  , tr_last_nam\r\n  , tr_sic\r\n  , add_info_01\r\n  , add_info_02\r\n  , add_info_03\r\n  , add_info_04\r\n  , contract_level\r\n  , ext_data\r\n  , report_address\r\n  , share_balance\r\n  , is_multycurrency\r\n  , enables_item\r\n  , cycle_length\r\n  , interval_type\r\n  , status_category\r\n  , limit_is_active\r\n  , settlement_type\r\n  , is_ready\r\n  , billing_contract\r\n  , auth_seq_n\r\n  , routing_idt\r\n  , apply_dt\r\n  , local_version\r\n  , remote_version\r\nFROM\r\n  {{ ref('stg_way4__acnt_contract')}}\r\nWHERE last_scan > (SELECT MAX(last_scan) FROM {{ this }})", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\way4\\way4__acnt_contract.sql", "original_file_path": "models\\base\\way4\\way4__acnt_contract.sql", "name": "way4__acnt_contract", "alias": "way4__acnt_contract", "checksum": {"name": "sha256", "checksum": "c13f40d0d7fa86822b80c33cc546710ce1543313df82b97bdf563bd8e3821d49"}, "tags": ["way4_daily"], "refs": [["stg_way4__acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "amnd_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\way4\\base_way4.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\way4__acnt_contract.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "amnd_date"}, "tags": "way4_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959752.62798, "compiled_code": "\nSELECT\n    amnd_date\n  , amnd_state\n  , amnd_officer\n  , amnd_prev\n  , id\n  , pcat\n  , con_cat\n  , terminal_category\n  , ccat\n  , f_i\n  , branch\n  , service_group\n  , contract_number\n  , contract_name\n  , comment_text\n  , base_relation\n  , relation_tag\n  , acnt_contract__id\n  , contr_type\n  , contr_subtype__id\n  , serv_pack__id\n  , old_pack\n  , channel\n  , acc_scheme__id\n  , old_scheme\n  , product\n  , product_prev\n  , parent_product\n  , main_product\n  , client__id\n  , client_type\n  , acnt_contract__oid\n  , liab_category\n  , liab_contract\n  , liab_contract_prev\n  , behavior_group\n  , behavior_type\n  , behavior_type_prev\n  , check_available\n  , check_usage\n  , curr\n  , old_curr\n  , auth_limit_amount\n  , base_auth_limit\n  , liab_balance\n  , liab_blocked\n  , own_balance\n  , own_blocked\n  , sub_balance\n  , sub_blocked\n  , total_blocked\n  , total_balance\n  , shared_balance\n  , shared_blocked\n  , amount_available\n  , date_open\n  , date_expire\n  , last_billing_date\n  , next_billing_date\n  , last_scan\n  , card_expire\n  , production_status\n  , rbs_member_id\n  , rbs_number\n  , report_type\n  , max_pin_attempts\n  , pin_attempts\n  , chip_scheme\n  , risk_scheme\n  , risk_factor\n  , risk_factor_prev\n  , contr_status\n  , merchant_id\n  , tr_title\n  , tr_company\n  , tr_country\n  , tr_first_nam\n  , tr_last_nam\n  , tr_sic\n  , add_info_01\n  , add_info_02\n  , add_info_03\n  , add_info_04\n  , contract_level\n  , ext_data\n  , report_address\n  , share_balance\n  , is_multycurrency\n  , enables_item\n  , cycle_length\n  , interval_type\n  , status_category\n  , limit_is_active\n  , settlement_type\n  , is_ready\n  , billing_contract\n  , auth_seq_n\n  , routing_idt\n  , apply_dt\n  , local_version\n  , remote_version\nFROM\n  \"oracle_dgaworkzone\".staging.stg_way4__acnt_contract\nWHERE last_scan > (SELECT MAX(last_scan) FROM \"oracle_dgaworkzone\".base.way4__acnt_contract)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.way4__acnt_contract"}, "model.dga_data_model.way4__cr_limit_log": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_way4__cr_limit_log"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["way4_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "way4", "way4__cr_limit_log"], "unique_id": "model.dga_data_model.way4__cr_limit_log", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'id'\r\n    )\r\n}}\r\nSELECT id,\r\n    acnt_contract_oid,\r\n    doc_id,\r\n    doc_orig_id,\r\n    curr,\r\n    amount,\r\n    result_amount,\r\n    credit_type,\r\n    credit_status,\r\n    credit_class,\r\n    trans_details,\r\n    reason_details,\r\n    posted_dt,\r\n    closed_dt,\r\n    input_dt,\r\n    date_from,\r\n    date_to,\r\n    officer,\r\n    source_contract,\r\n    etl_date\r\nFROM  {{ ref ('stg_way4__cr_limit_log') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\way4\\way4__cr_limit_log.sql", "original_file_path": "models\\base\\way4\\way4__cr_limit_log.sql", "name": "way4__cr_limit_log", "alias": "way4__cr_limit_log", "checksum": {"name": "sha256", "checksum": "76329ff109cf4c09cc37519ffc4637baf0d4683b6f70637e81356f69293a02f8"}, "tags": ["way4_daily"], "refs": [["stg_way4__cr_limit_log"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\way4\\base_way4.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\way4__cr_limit_log.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"date_column": "etl_date"}, "tags": "way4_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959752.6299791, "compiled_code": "\nSELECT id,\n    acnt_contract_oid,\n    doc_id,\n    doc_orig_id,\n    curr,\n    amount,\n    result_amount,\n    credit_type,\n    credit_status,\n    credit_class,\n    trans_details,\n    reason_details,\n    posted_dt,\n    closed_dt,\n    input_dt,\n    date_from,\n    date_to,\n    officer,\n    source_contract,\n    etl_date\nFROM  \"oracle_dgaworkzone\".staging.stg_way4__cr_limit_log", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.way4__cr_limit_log"}, "model.dga_data_model.way4__cs_decision": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.msb.cs_decision"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["way4_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "way4", "way4__cs_decision"], "unique_id": "model.dga_data_model.way4__cs_decision", "raw_code": "{{ config( materialized='table') }}\r\nSELECT\r\n    amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , code\r\n  , name\r\n  , default_result\r\n  , group_code\r\n  , ccat\r\n  , con_cat\r\n  , pcat\r\n  , applies_to\r\n  , add_info\r\n  , on_off_mode\r\n  , domain_code\r\nFROM\r\n  {{ source('msb', 'cs_decision')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\way4\\way4__cs_decision.sql", "original_file_path": "models\\base\\way4\\way4__cs_decision.sql", "name": "way4__cs_decision", "alias": "way4__cs_decision", "checksum": {"name": "sha256", "checksum": "a7c31e3712c68a4798293827cb1de5d2a981effb3cbb1290452187e1a88a4138"}, "tags": ["way4_daily"], "refs": [], "sources": [["msb", "cs_decision"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\way4\\base_way4.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\way4__cs_decision.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "way4_daily", "materialized": "table"}, "created_at": 1685959752.62798, "compiled_code": "\nSELECT\n    amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , code\n  , name\n  , default_result\n  , group_code\n  , ccat\n  , con_cat\n  , pcat\n  , applies_to\n  , add_info\n  , on_off_mode\n  , domain_code\nFROM\n  oracle_way4.msb.cs_decision", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.way4__cs_decision"}, "model.dga_data_model.way4__cs_status_type": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.msb.cs_status_type"]}, "config": {"enabled": true, "alias": null, "schema": "base", "database": null, "tags": ["way4_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "base", "way4", "way4__cs_status_type"], "unique_id": "model.dga_data_model.way4__cs_status_type", "raw_code": "{{ config( materialized='table') }}\r\nSELECT\r\n    amnd_date\r\n  , amnd_officer\r\n  , amnd_state\r\n  , amnd_prev\r\n  , id\r\n  , applies_to\r\n  , group_code\r\n  , code\r\n  , default_value\r\n  , name\r\n  , status_category\r\n  , log_flag\r\n  , pcat\r\n  , con_cat\r\n  , ccat\r\n  , is_primary\r\n  , add_info\r\n  , on_off_mode\r\n  , domain_code\r\n  , domain_type__id\r\n  , is_ready\r\nFROM\r\n  {{ source('msb', 'cs_status_type' ) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "base\\way4\\way4__cs_status_type.sql", "original_file_path": "models\\base\\way4\\way4__cs_status_type.sql", "name": "way4__cs_status_type", "alias": "way4__cs_status_type", "checksum": {"name": "sha256", "checksum": "23333f2e09abb4bdd3168b9e8c9a759e2d0777874ce6612500b1da52d1833a5c"}, "tags": ["way4_daily"], "refs": [], "sources": [["msb", "cs_status_type"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\base\\way4\\base_way4.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\way4__cs_status_type.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "base", "meta": {"owner": "huyendtk3"}, "tags": "way4_daily", "materialized": "table"}, "created_at": 1685959752.62798, "compiled_code": "\nSELECT\n    amnd_date\n  , amnd_officer\n  , amnd_state\n  , amnd_prev\n  , id\n  , applies_to\n  , group_code\n  , code\n  , default_value\n  , name\n  , status_category\n  , log_flag\n  , pcat\n  , con_cat\n  , ccat\n  , is_primary\n  , add_info\n  , on_off_mode\n  , domain_code\n  , domain_type__id\n  , is_ready\nFROM\n  oracle_way4.msb.cs_status_type", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".base.way4__cs_status_type"}, "model.dga_data_model.int_qlhs__bal_mly_eb": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.vision__eb_bal_onbs_monthly", "model.dga_data_model.vision__eb_bal_onbs_monthly", "model.dga_data_model.vision__eb_bal_offbs_monthly"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bal_eb", "int_qlhs__bal_mly_eb"], "unique_id": "model.dga_data_model.int_qlhs__bal_mly_eb", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH eop AS (\r\n    SELECT\r\n        substr(data_date,1,6) AS year_month\r\n        , data_date AS report_date\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , cifno AS customer_number\r\n        , currency\r\n        , cost_center\r\n        , CASE\r\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\r\n            WHEN APP = 'DD' THEN 'CASA'\r\n            WHEN APP = 'CD' THEN 'FD'\r\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\r\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\r\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\r\n            WHEN APP = 'CBI' THEN 'CBI'\r\n            ELSE NULL\r\n            END product\r\n        , kyhan AS term\r\n        , term_qd AS term_in_day\r\n        , masorm_new\r\n        , masocrm_new\r\n        , round(SUM(qvnd),0) AS eop_bal_lcy\r\n    FROM {{ ref('vision__eb_bal_onbs_monthly')}}\r\n    WHERE substr(data_date,1,6) = to_number(to_char(add_months(TO_DATE({{ var('month_id') }},'yyyymm'),-1),'yyyymm'))\r\n    AND data_date = to_char(last_day(TO_DATE(substr(data_date,1,6),'yyyymm')),'yyyymmdd')\r\n    GROUP BY\r\n        data_date\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , cifno\r\n        , currency\r\n        , cost_center\r\n        , CASE\r\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\r\n            WHEN APP = 'DD' THEN 'CASA'\r\n            WHEN APP = 'CD' THEN 'FD'\r\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\r\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\r\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\r\n            WHEN APP = 'CBI' THEN 'CBI'\r\n            ELSE NULL\r\n            END\r\n        , kyhan\r\n        , term_qd\r\n        , masorm_new\r\n        , masocrm_new\r\n), sum_bal AS (\r\n    SELECT\r\n        substr(data_date,1,6) AS year_month\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , cifno AS customer_number\r\n        , currency\r\n        , cost_center\r\n        , CASE\r\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\r\n            WHEN APP = 'DD' THEN 'CASA'\r\n            WHEN APP = 'CD' THEN 'FD'\r\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\r\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\r\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\r\n            WHEN APP = 'CBI' THEN 'CBI'\r\n            ELSE NULL\r\n            END product\r\n        , kyhan AS TERM\r\n        , term_qd AS term_in_day\r\n        , masorm_new\r\n        , masocrm_new\r\n        , to_number(to_char(last_day(TO_DATE(data_date,'yyyymmdd')),'dd')) AS no_of_day\r\n        , SUM(qvnd) AS sum_bal_lcy\r\n    FROM {{ ref('vision__eb_bal_onbs_monthly')}}\r\n    WHERE substr(data_date,1,6) = to_number(to_char(add_months(TO_DATE({{ var('month_id') }},'yyyymm'),-1),'yyyymm'))\r\n    GROUP BY\r\n        substr(data_date,1,6)\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , cifno\r\n        , currency\r\n        , cost_center\r\n        , CASE\r\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\r\n            WHEN APP = 'DD' THEN 'CASA'\r\n            WHEN APP = 'CD' THEN 'FD'\r\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\r\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\r\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\r\n            WHEN APP = 'CBI' THEN 'CBI'\r\n            ELSE NULL\r\n            END\r\n        , kyhan\r\n        , term_qd\r\n        , to_number(to_char(last_day(TO_DATE(data_date,'yyyymmdd')),'dd'))\r\n        , masorm_new\r\n        , masocrm_new\r\n), avg AS (\r\n    SELECT\r\n        year_month\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , customer_number\r\n        , currency\r\n        , cost_center\r\n        , product\r\n        , TERM\r\n        , term_in_day\r\n        , masorm_new\r\n        , masocrm_new\r\n        , round(sum_bal_lcy/no_of_day,0) AS avg_bal_lcy\r\n    FROM sum_bal\r\n), onbs AS (\r\n    SELECT\r\n        to_number(AVG.year_month) AS year_month\r\n        , to_number(to_char(last_day(TO_DATE(AVG.year_month||'01', 'YYYYMMDD')),'YYYYMMDD')) AS report_date\r\n        , nvl(AVG.vision_sbu, eop.vision_sbu) AS vision_sbu\r\n        , nvl(AVG.brn, eop.brn) AS brn\r\n        , nvl(AVG.contract_id, eop.contract_id) AS contract_id\r\n        , nvl(AVG.customer_number, eop.customer_number) AS customer_number\r\n        , nvl(AVG.currency, eop.currency) AS currency\r\n        , 'VN' AS country\r\n        , nvl(AVG.cost_center, eop.cost_center) AS cost_center\r\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv1\r\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv2\r\n        , nvl(AVG.product, eop.product) AS product\r\n        , nvl(AVG.masorm_new, eop.masorm_new) AS masorm_new\r\n        , nvl(AVG.masocrm_new, eop.masocrm_new) AS masocrm_new\r\n        , nvl(AVG.TERM, eop.TERM) AS TERM\r\n        , nvl(AVG.term_in_day, eop.term_in_day) AS term_in_day\r\n        , nvl(eop.eop_bal_lcy, 0) AS eop_bal_lcy\r\n        , AVG.avg_bal_lcy\r\n    FROM AVG\r\n    LEFT JOIN eop\r\n        ON AVG.contract_id = eop.contract_id\r\n        AND AVG.vision_sbu = eop.vision_sbu\r\n        AND AVG.brn = eop.brn\r\n        AND nvl(AVG.product,0) = nvl(eop.product,0)\r\n        AND nvl(AVG.cost_center,0) = nvl(eop.cost_center,0)\r\n        AND nvl(AVG.masorm_new,0) = nvl(eop.masorm_new,0)\r\n        AND nvl(AVG.masocrm_new,0) = nvl(eop.masocrm_new,0)\r\n), offbs AS (\r\n    SELECT\r\n        to_number(year_month) AS year_month\r\n        , to_number(to_char(last_day(TO_DATE(year_month||'01', 'YYYYMMDD')),'YYYYMMDD')) AS report_date\r\n        , vision_sbu\r\n        , CAST (substr(vision_ouc,5,4) AS INT) AS brn\r\n        , contract_id\r\n        , customer_id\r\n        , currency\r\n        , 'VN' AS country\r\n        , cost_center\r\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv1\r\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv2\r\n        , CASE\r\n            WHEN cost_center IN ('LC','UB') THEN 'LC'\r\n            WHEN cost_center = 'BG' THEN 'BG'\r\n            ELSE 'OTHER OFFBS' END product\r\n        , masorm_new\r\n        , masocrm_new\r\n        , CAST(NULL AS VARCHAR2(10)) AS term\r\n        , CAST(NULL AS VARCHAR2(10)) AS term_in_day\r\n        , round(SUM(sdck),0) AS eop_bal_lcy\r\n        , round(SUM(sdtb),0) AS avg_bal_lcy\r\n    FROM {{ ref('vision__eb_bal_offbs_monthly')}}\r\n    WHERE year_month = to_number(to_char(add_months(TO_DATE({{ var('month_id') }},'yyyymm'),-1),'yyyymm'))\r\n    GROUP BY\r\n        year_month\r\n        , vision_sbu\r\n        , vision_ouc\r\n        , contract_id\r\n        , customer_id\r\n        , currency\r\n        , cost_center\r\n        , CASE\r\n            WHEN cost_center IN ('LC','UB') THEN 'LC'\r\n            WHEN cost_center = 'BG' THEN 'BG'\r\n            ELSE 'OTHER OFFBS' END\r\n        , masorm_new\r\n        , masocrm_new\r\n)\r\nSELECT * FROM onbs\r\nUNION ALL\r\nSELECT * FROM offbs", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bal_eb\\int_qlhs__bal_mly_eb.sql", "original_file_path": "models\\int\\bal_eb\\int_qlhs__bal_mly_eb.sql", "name": "int_qlhs__bal_mly_eb", "alias": "int_qlhs__bal_mly_eb", "checksum": {"name": "sha256", "checksum": "616e5322c72239879cc6dbf6aa5764a189850fff640e0f216702c9cb3d482022"}, "tags": ["bal_eb_daily"], "refs": [["vision__eb_bal_onbs_monthly"], ["vision__eb_bal_onbs_monthly"], ["vision__eb_bal_offbs_monthly"]], "sources": [], "metrics": [], "description": "", "columns": {"customer_number": {"name": "customer_number", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bal_eb\\int_bal_eb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_qlhs__bal_mly_eb.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "report_date"}, "tags": "bal_eb_daily", "materialized": "table"}, "created_at": 1685959752.649907, "compiled_code": "\n\nWITH eop AS (\n    SELECT\n        substr(data_date,1,6) AS year_month\n        , data_date AS report_date\n        , vision_sbu\n        , brn\n        , contract_id\n        , cifno AS customer_number\n        , currency\n        , cost_center\n        , CASE\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\n            WHEN APP = 'DD' THEN 'CASA'\n            WHEN APP = 'CD' THEN 'FD'\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\n            WHEN APP = 'CBI' THEN 'CBI'\n            ELSE NULL\n            END product\n        , kyhan AS term\n        , term_qd AS term_in_day\n        , masorm_new\n        , masocrm_new\n        , round(SUM(qvnd),0) AS eop_bal_lcy\n    FROM \"oracle_dgaworkzone\".base.vision__eb_bal_onbs_monthly\n    WHERE substr(data_date,1,6) = to_number(to_char(add_months(TO_DATE(to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYMM')),'yyyymm'),-1),'yyyymm'))\n    AND data_date = to_char(last_day(TO_DATE(substr(data_date,1,6),'yyyymm')),'yyyymmdd')\n    GROUP BY\n        data_date\n        , vision_sbu\n        , brn\n        , contract_id\n        , cifno\n        , currency\n        , cost_center\n        , CASE\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\n            WHEN APP = 'DD' THEN 'CASA'\n            WHEN APP = 'CD' THEN 'FD'\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\n            WHEN APP = 'CBI' THEN 'CBI'\n            ELSE NULL\n            END\n        , kyhan\n        , term_qd\n        , masorm_new\n        , masocrm_new\n), sum_bal AS (\n    SELECT\n        substr(data_date,1,6) AS year_month\n        , vision_sbu\n        , brn\n        , contract_id\n        , cifno AS customer_number\n        , currency\n        , cost_center\n        , CASE\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\n            WHEN APP = 'DD' THEN 'CASA'\n            WHEN APP = 'CD' THEN 'FD'\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\n            WHEN APP = 'CBI' THEN 'CBI'\n            ELSE NULL\n            END product\n        , kyhan AS TERM\n        , term_qd AS term_in_day\n        , masorm_new\n        , masocrm_new\n        , to_number(to_char(last_day(TO_DATE(data_date,'yyyymmdd')),'dd')) AS no_of_day\n        , SUM(qvnd) AS sum_bal_lcy\n    FROM \"oracle_dgaworkzone\".base.vision__eb_bal_onbs_monthly\n    WHERE substr(data_date,1,6) = to_number(to_char(add_months(TO_DATE(to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYMM')),'yyyymm'),-1),'yyyymm'))\n    GROUP BY\n        substr(data_date,1,6)\n        , vision_sbu\n        , brn\n        , contract_id\n        , cifno\n        , currency\n        , cost_center\n        , CASE\n            WHEN cost_center IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDIT CARD'\n            WHEN APP = 'DD' THEN 'CASA'\n            WHEN APP = 'CD' THEN 'FD'\n            WHEN APP = 'LN' AND trade_loan IS NOT NULL THEN 'TRADE LOAN'\n            WHEN APP = 'LN' AND trade_loan IS NULL AND kyhan = 'ST_TC' THEN 'THAU CHI'\n            WHEN APP = 'LN' THEN 'OTHER LOAN'\n            WHEN APP = 'CBI' THEN 'CBI'\n            ELSE NULL\n            END\n        , kyhan\n        , term_qd\n        , to_number(to_char(last_day(TO_DATE(data_date,'yyyymmdd')),'dd'))\n        , masorm_new\n        , masocrm_new\n), avg AS (\n    SELECT\n        year_month\n        , vision_sbu\n        , brn\n        , contract_id\n        , customer_number\n        , currency\n        , cost_center\n        , product\n        , TERM\n        , term_in_day\n        , masorm_new\n        , masocrm_new\n        , round(sum_bal_lcy/no_of_day,0) AS avg_bal_lcy\n    FROM sum_bal\n), onbs AS (\n    SELECT\n        to_number(AVG.year_month) AS year_month\n        , to_number(to_char(last_day(TO_DATE(AVG.year_month||'01', 'YYYYMMDD')),'YYYYMMDD')) AS report_date\n        , nvl(AVG.vision_sbu, eop.vision_sbu) AS vision_sbu\n        , nvl(AVG.brn, eop.brn) AS brn\n        , nvl(AVG.contract_id, eop.contract_id) AS contract_id\n        , nvl(AVG.customer_number, eop.customer_number) AS customer_number\n        , nvl(AVG.currency, eop.currency) AS currency\n        , 'VN' AS country\n        , nvl(AVG.cost_center, eop.cost_center) AS cost_center\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv1\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv2\n        , nvl(AVG.product, eop.product) AS product\n        , nvl(AVG.masorm_new, eop.masorm_new) AS masorm_new\n        , nvl(AVG.masocrm_new, eop.masocrm_new) AS masocrm_new\n        , nvl(AVG.TERM, eop.TERM) AS TERM\n        , nvl(AVG.term_in_day, eop.term_in_day) AS term_in_day\n        , nvl(eop.eop_bal_lcy, 0) AS eop_bal_lcy\n        , AVG.avg_bal_lcy\n    FROM AVG\n    LEFT JOIN eop\n        ON AVG.contract_id = eop.contract_id\n        AND AVG.vision_sbu = eop.vision_sbu\n        AND AVG.brn = eop.brn\n        AND nvl(AVG.product,0) = nvl(eop.product,0)\n        AND nvl(AVG.cost_center,0) = nvl(eop.cost_center,0)\n        AND nvl(AVG.masorm_new,0) = nvl(eop.masorm_new,0)\n        AND nvl(AVG.masocrm_new,0) = nvl(eop.masocrm_new,0)\n), offbs AS (\n    SELECT\n        to_number(year_month) AS year_month\n        , to_number(to_char(last_day(TO_DATE(year_month||'01', 'YYYYMMDD')),'YYYYMMDD')) AS report_date\n        , vision_sbu\n        , CAST (substr(vision_ouc,5,4) AS INT) AS brn\n        , contract_id\n        , customer_id\n        , currency\n        , 'VN' AS country\n        , cost_center\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv1\n        , CAST(NULL AS VARCHAR2(20))  AS mgt_line_short_desc_lv2\n        , CASE\n            WHEN cost_center IN ('LC','UB') THEN 'LC'\n            WHEN cost_center = 'BG' THEN 'BG'\n            ELSE 'OTHER OFFBS' END product\n        , masorm_new\n        , masocrm_new\n        , CAST(NULL AS VARCHAR2(10)) AS term\n        , CAST(NULL AS VARCHAR2(10)) AS term_in_day\n        , round(SUM(sdck),0) AS eop_bal_lcy\n        , round(SUM(sdtb),0) AS avg_bal_lcy\n    FROM \"oracle_dgaworkzone\".base.vision__eb_bal_offbs_monthly\n    WHERE year_month = to_number(to_char(add_months(TO_DATE(to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYMM')),'yyyymm'),-1),'yyyymm'))\n    GROUP BY\n        year_month\n        , vision_sbu\n        , vision_ouc\n        , contract_id\n        , customer_id\n        , currency\n        , cost_center\n        , CASE\n            WHEN cost_center IN ('LC','UB') THEN 'LC'\n            WHEN cost_center = 'BG' THEN 'BG'\n            ELSE 'OTHER OFFBS' END\n        , masorm_new\n        , masocrm_new\n)\nSELECT * FROM onbs\nUNION ALL\nSELECT * FROM offbs", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_qlhs__bal_mly_eb"}, "model.dga_data_model.int_vision__bal_dly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.vision__build_schedules_details_audit", "model.dga_data_model.stg_landing__vision_fin_dly_headers", "model.dga_data_model.stg_landing__vision_mgt_expanded", "model.dga_data_model.stg_landing__vision_mgt_expanded", "model.dga_data_model.stg_landing__vision_fin_dly_balances", "model.dga_data_model.stg_landing__vision_fin_dly_mappings", "model.dga_data_model.stg_landing__vision_currency_rates_daily"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bal_eb", "int_vision__bal_dly"], "unique_id": "model.dga_data_model.int_vision__bal_dly", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH max_rpt_date AS (\r\n    SELECT\r\n        to_number(to_char(MAX(business_date),'yyyymm')) AS year_month,\r\n        to_number(to_char(MAX(business_date),'dd')) AS max_rpt_date\r\n    FROM {{ ref('vision__build_schedules_details_audit')}}\r\n    WHERE 1=1\r\n        AND build_module = 'FINDLYBKUP'\r\n        AND module_status = 'C'\r\n)\r\n, header AS (\r\n    SELECT *\r\n    FROM {{ ref('stg_landing__vision_fin_dly_headers')}}\r\n    WHERE year_month = (SELECT year_month FROM max_rpt_date)\r\n--    WHERE year_month = 202304\r\n)\r\n, itm_lv1 AS (\r\n    SELECT\r\n        mgt_line_level\r\n        , mgt_line\r\n        , mgt_line_short_desc\r\n        , source_bal_type\r\n        , source_type\r\n        , source_mrl_line\r\n    FROM\r\n     {{ ref('stg_landing__vision_mgt_expanded')}}\r\n    WHERE\r\n     mgt_line_level = 1\r\n     AND mgt_line != 'G010000'\r\n     AND source_bal_type = 2\r\n     AND source_type = 0\r\n)\r\n, itm_lv2 AS (\r\n    SELECT\r\n        mgt_line_level\r\n        , mgt_line\r\n        , mgt_line_short_desc\r\n        , source_bal_type\r\n        , source_type\r\n        , source_mrl_line\r\n    FROM\r\n     {{ ref('stg_landing__vision_mgt_expanded')}}\r\n    WHERE\r\n     mgt_line_level = 2\r\n     AND mgt_line != 'G020000'\r\n     AND source_bal_type = 2\r\n     AND source_type = 0\r\n)\r\n, dat AS (\r\n    SELECT\r\n       header.year_month,\r\n       header.vision_sbu,\r\n       header.brn,\r\n       header.cost_center,\r\n       header.bs_gl,\r\n       header.contract_id,\r\n       header.customer_number,\r\n       header.currency,\r\n       header.country,\r\n       header.sequence_fd,\r\n       bal.bal_type,\r\n       map.mrl_line,\r\n       itm_lv2.mgt_line,\r\n       itm_lv1.mgt_line_short_desc mgt_line_short_desc_lv1,\r\n       itm_lv2.mgt_line_short_desc mgt_line_short_desc_lv2,\r\n       round (bal.balance_01 * rate_01) e01_lcy,\r\n            round (bal.balance_02 * rate_02) e02_lcy,\r\n            round (bal.balance_03 * rate_03) e03_lcy,\r\n            round (bal.balance_04 * rate_04) e04_lcy,\r\n            round (bal.balance_05 * rate_05) e05_lcy,\r\n            round (bal.balance_06 * rate_06) e06_lcy,\r\n            round (bal.balance_07 * rate_07) e07_lcy,\r\n            round (bal.balance_08 * rate_08) e08_lcy,\r\n            round (bal.balance_09 * rate_09) e09_lcy,\r\n            round (bal.balance_10 * rate_10) e10_lcy,\r\n            round (bal.balance_11 * rate_11) e11_lcy,\r\n            round (bal.balance_12 * rate_12) e12_lcy,\r\n            round (bal.balance_13 * rate_13) e13_lcy,\r\n            round (bal.balance_14 * rate_14) e14_lcy,\r\n            round (bal.balance_15 * rate_15) e15_lcy,\r\n            round (bal.balance_16 * rate_16) e16_lcy,\r\n            round (bal.balance_17 * rate_17) e17_lcy,\r\n            round (bal.balance_18 * rate_18) e18_lcy,\r\n            round (bal.balance_19 * rate_19) e19_lcy,\r\n            round (bal.balance_20 * rate_20) e20_lcy,\r\n            round (bal.balance_21 * rate_21) e21_lcy,\r\n            round (bal.balance_22 * rate_22) e22_lcy,\r\n            round (bal.balance_23 * rate_23) e23_lcy,\r\n            round (bal.balance_24 * rate_24) e24_lcy,\r\n            round (bal.balance_25 * rate_25) e25_lcy,\r\n            round (bal.balance_26 * rate_26) e26_lcy,\r\n            round (bal.balance_27 * rate_27) e27_lcy,\r\n            round (bal.balance_28 * rate_28) e28_lcy,\r\n            round (bal.balance_29 * rate_29) e29_lcy,\r\n            round (bal.balance_30 * rate_30) e30_lcy,\r\n            round (bal.balance_31 * rate_31) e31_lcy\r\n    FROM header\r\n    LEFT JOIN {{ ref('stg_landing__vision_fin_dly_balances')}} bal\r\n        ON header.country = bal.country\r\n        AND header.le_book = bal.le_book\r\n        AND header.year_month = bal.year_month\r\n        AND header.sequence_fd= bal.sequence_fd\r\n    LEFT JOIN {{ ref('stg_landing__vision_fin_dly_mappings')}} map\r\n        ON bal.country = map.country\r\n        AND bal.le_book = map.le_book\r\n        AND bal.year_month = map.year_month\r\n        AND bal.sequence_fd= map.sequence_fd\r\n        AND bal.dr_cr_bal_ind= map.dr_cr_bal_ind\r\n    LEFT JOIN itm_lv1\r\n        ON map.mrl_line = itm_lv1.source_mrl_line\r\n    LEFT JOIN itm_lv2\r\n        ON map.mrl_line = itm_lv2.source_mrl_line\r\n    LEFT JOIN {{ ref('stg_landing__vision_currency_rates_daily')}} cur\r\n        ON header.country=cur.country\r\n        AND header.le_book=cur.le_book\r\n        AND header.currency=cur.currency\r\n        AND header.year_month=cur.year_month\r\n        AND CATEGORY='MRATE'\r\n    WHERE 1=1\r\n       AND header.record_type != 9999\r\n       AND bal.bal_type IN ('51')\r\n       AND (balance_01+balance_02+balance_03+balance_04+balance_05+balance_06+balance_07+balance_08+balance_09+balance_10+balance_11+balance_12+balance_13+balance_14+balance_15+balance_16+balance_17+balance_18+balance_19+balance_20+balance_21+balance_22+balance_23+balance_24+balance_25+balance_26+balance_27+balance_28+balance_29+balance_30+balance_31)\r\n        <> 0\r\n       AND (itm_lv1.mgt_line_short_desc IN ('CA/SA', 'CBI', 'Loans to Customer', 'Fixed Deposits')\r\n        OR itm_lv2.mgt_line_short_desc IN ('Guarantee', 'CASA', 'Corporate Bonds', 'CBI Bonds', 'Credit Cards',\r\n            'Fixed Deposit', 'Export LCs', 'Loans', 'Overdrafts'))\r\n)\r\n, unpivot AS (\r\n    SELECT *\r\n    FROM dat\r\n    UNPIVOT (\r\n        eop_bal_lcy\r\n        FOR day_of_month IN (\r\n            e01_lcy AS '01',\r\n            e02_lcy AS '02',\r\n            e03_lcy AS '03',\r\n            e04_lcy AS '04',\r\n            e05_lcy AS '05',\r\n            e06_lcy AS '06',\r\n            e07_lcy AS '07',\r\n            e08_lcy AS '08',\r\n            e09_lcy AS '09',\r\n            e10_lcy AS '10',\r\n            e11_lcy AS '11',\r\n            e12_lcy AS '12',\r\n            e13_lcy AS '13',\r\n            e14_lcy AS '14',\r\n            e15_lcy AS '15',\r\n            e16_lcy AS '16',\r\n            e17_lcy AS '17',\r\n            e18_lcy AS '18',\r\n            e19_lcy AS '19',\r\n            e20_lcy AS '20',\r\n            e21_lcy AS '21',\r\n            e22_lcy AS '22',\r\n            e23_lcy AS '23',\r\n            e24_lcy AS '24',\r\n            e25_lcy AS '25',\r\n            e26_lcy AS '26',\r\n            e27_lcy AS '27',\r\n            e28_lcy AS '28',\r\n            e29_lcy AS '29',\r\n            e30_lcy AS '30',\r\n            e31_lcy AS '31'\r\n            )\r\n        )\r\n)\r\n, final AS (\r\n    SELECT unpivot.year_month\r\n        , to_number(unpivot.year_month || unpivot.day_of_month) report_date\r\n        , unpivot.vision_sbu\r\n        , unpivot.brn\r\n        , unpivot.contract_id\r\n        , unpivot.customer_number\r\n        , unpivot.currency\r\n        , unpivot.country\r\n        , unpivot.cost_center\r\n        , unpivot.mgt_line_short_desc_lv1\r\n        , unpivot.mgt_line_short_desc_lv2\r\n        , unpivot.eop_bal_lcy\r\n    FROM unpivot\r\n    LEFT JOIN max_rpt_date ON max_rpt_date.year_month = unpivot.year_month\r\n    WHERE to_number(unpivot.day_of_month) <= max_rpt_date.max_rpt_date\r\n)\r\nSELECT * FROM final", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bal_eb\\int_vision__bal_dly.sql", "original_file_path": "models\\int\\bal_eb\\int_vision__bal_dly.sql", "name": "int_vision__bal_dly", "alias": "int_vision__bal_dly", "checksum": {"name": "sha256", "checksum": "9e5981bc99e8e22db8249a26f9f8f4aa9bcb4585305a5b7440c04919946acb53"}, "tags": ["bal_eb_daily"], "refs": [["vision__build_schedules_details_audit"], ["stg_landing__vision_fin_dly_headers"], ["stg_landing__vision_mgt_expanded"], ["stg_landing__vision_mgt_expanded"], ["stg_landing__vision_fin_dly_balances"], ["stg_landing__vision_fin_dly_mappings"], ["stg_landing__vision_currency_rates_daily"]], "sources": [], "metrics": [], "description": "", "columns": {"contract_id": {"name": "contract_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "customer_number": {"name": "customer_number", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bal_eb\\int_bal_eb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_vision__bal_dly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "report_date"}, "tags": "bal_eb_daily", "materialized": "table"}, "created_at": 1685959752.638979, "compiled_code": "\n\nWITH max_rpt_date AS (\n    SELECT\n        to_number(to_char(MAX(business_date),'yyyymm')) AS year_month,\n        to_number(to_char(MAX(business_date),'dd')) AS max_rpt_date\n    FROM \"oracle_dgaworkzone\".base.vision__build_schedules_details_audit\n    WHERE 1=1\n        AND build_module = 'FINDLYBKUP'\n        AND module_status = 'C'\n)\n, header AS (\n    SELECT *\n    FROM \"oracle_dgaworkzone\".staging.stg_landing__vision_fin_dly_headers\n    WHERE year_month = (SELECT year_month FROM max_rpt_date)\n--    WHERE year_month = 202304\n)\n, itm_lv1 AS (\n    SELECT\n        mgt_line_level\n        , mgt_line\n        , mgt_line_short_desc\n        , source_bal_type\n        , source_type\n        , source_mrl_line\n    FROM\n     \"oracle_dgaworkzone\".staging.stg_landing__vision_mgt_expanded\n    WHERE\n     mgt_line_level = 1\n     AND mgt_line != 'G010000'\n     AND source_bal_type = 2\n     AND source_type = 0\n)\n, itm_lv2 AS (\n    SELECT\n        mgt_line_level\n        , mgt_line\n        , mgt_line_short_desc\n        , source_bal_type\n        , source_type\n        , source_mrl_line\n    FROM\n     \"oracle_dgaworkzone\".staging.stg_landing__vision_mgt_expanded\n    WHERE\n     mgt_line_level = 2\n     AND mgt_line != 'G020000'\n     AND source_bal_type = 2\n     AND source_type = 0\n)\n, dat AS (\n    SELECT\n       header.year_month,\n       header.vision_sbu,\n       header.brn,\n       header.cost_center,\n       header.bs_gl,\n       header.contract_id,\n       header.customer_number,\n       header.currency,\n       header.country,\n       header.sequence_fd,\n       bal.bal_type,\n       map.mrl_line,\n       itm_lv2.mgt_line,\n       itm_lv1.mgt_line_short_desc mgt_line_short_desc_lv1,\n       itm_lv2.mgt_line_short_desc mgt_line_short_desc_lv2,\n       round (bal.balance_01 * rate_01) e01_lcy,\n            round (bal.balance_02 * rate_02) e02_lcy,\n            round (bal.balance_03 * rate_03) e03_lcy,\n            round (bal.balance_04 * rate_04) e04_lcy,\n            round (bal.balance_05 * rate_05) e05_lcy,\n            round (bal.balance_06 * rate_06) e06_lcy,\n            round (bal.balance_07 * rate_07) e07_lcy,\n            round (bal.balance_08 * rate_08) e08_lcy,\n            round (bal.balance_09 * rate_09) e09_lcy,\n            round (bal.balance_10 * rate_10) e10_lcy,\n            round (bal.balance_11 * rate_11) e11_lcy,\n            round (bal.balance_12 * rate_12) e12_lcy,\n            round (bal.balance_13 * rate_13) e13_lcy,\n            round (bal.balance_14 * rate_14) e14_lcy,\n            round (bal.balance_15 * rate_15) e15_lcy,\n            round (bal.balance_16 * rate_16) e16_lcy,\n            round (bal.balance_17 * rate_17) e17_lcy,\n            round (bal.balance_18 * rate_18) e18_lcy,\n            round (bal.balance_19 * rate_19) e19_lcy,\n            round (bal.balance_20 * rate_20) e20_lcy,\n            round (bal.balance_21 * rate_21) e21_lcy,\n            round (bal.balance_22 * rate_22) e22_lcy,\n            round (bal.balance_23 * rate_23) e23_lcy,\n            round (bal.balance_24 * rate_24) e24_lcy,\n            round (bal.balance_25 * rate_25) e25_lcy,\n            round (bal.balance_26 * rate_26) e26_lcy,\n            round (bal.balance_27 * rate_27) e27_lcy,\n            round (bal.balance_28 * rate_28) e28_lcy,\n            round (bal.balance_29 * rate_29) e29_lcy,\n            round (bal.balance_30 * rate_30) e30_lcy,\n            round (bal.balance_31 * rate_31) e31_lcy\n    FROM header\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__vision_fin_dly_balances bal\n        ON header.country = bal.country\n        AND header.le_book = bal.le_book\n        AND header.year_month = bal.year_month\n        AND header.sequence_fd= bal.sequence_fd\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__vision_fin_dly_mappings map\n        ON bal.country = map.country\n        AND bal.le_book = map.le_book\n        AND bal.year_month = map.year_month\n        AND bal.sequence_fd= map.sequence_fd\n        AND bal.dr_cr_bal_ind= map.dr_cr_bal_ind\n    LEFT JOIN itm_lv1\n        ON map.mrl_line = itm_lv1.source_mrl_line\n    LEFT JOIN itm_lv2\n        ON map.mrl_line = itm_lv2.source_mrl_line\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__vision_currency_rates_daily cur\n        ON header.country=cur.country\n        AND header.le_book=cur.le_book\n        AND header.currency=cur.currency\n        AND header.year_month=cur.year_month\n        AND CATEGORY='MRATE'\n    WHERE 1=1\n       AND header.record_type != 9999\n       AND bal.bal_type IN ('51')\n       AND (balance_01+balance_02+balance_03+balance_04+balance_05+balance_06+balance_07+balance_08+balance_09+balance_10+balance_11+balance_12+balance_13+balance_14+balance_15+balance_16+balance_17+balance_18+balance_19+balance_20+balance_21+balance_22+balance_23+balance_24+balance_25+balance_26+balance_27+balance_28+balance_29+balance_30+balance_31)\n        <> 0\n       AND (itm_lv1.mgt_line_short_desc IN ('CA/SA', 'CBI', 'Loans to Customer', 'Fixed Deposits')\n        OR itm_lv2.mgt_line_short_desc IN ('Guarantee', 'CASA', 'Corporate Bonds', 'CBI Bonds', 'Credit Cards',\n            'Fixed Deposit', 'Export LCs', 'Loans', 'Overdrafts'))\n)\n, unpivot AS (\n    SELECT *\n    FROM dat\n    UNPIVOT (\n        eop_bal_lcy\n        FOR day_of_month IN (\n            e01_lcy AS '01',\n            e02_lcy AS '02',\n            e03_lcy AS '03',\n            e04_lcy AS '04',\n            e05_lcy AS '05',\n            e06_lcy AS '06',\n            e07_lcy AS '07',\n            e08_lcy AS '08',\n            e09_lcy AS '09',\n            e10_lcy AS '10',\n            e11_lcy AS '11',\n            e12_lcy AS '12',\n            e13_lcy AS '13',\n            e14_lcy AS '14',\n            e15_lcy AS '15',\n            e16_lcy AS '16',\n            e17_lcy AS '17',\n            e18_lcy AS '18',\n            e19_lcy AS '19',\n            e20_lcy AS '20',\n            e21_lcy AS '21',\n            e22_lcy AS '22',\n            e23_lcy AS '23',\n            e24_lcy AS '24',\n            e25_lcy AS '25',\n            e26_lcy AS '26',\n            e27_lcy AS '27',\n            e28_lcy AS '28',\n            e29_lcy AS '29',\n            e30_lcy AS '30',\n            e31_lcy AS '31'\n            )\n        )\n)\n, final AS (\n    SELECT unpivot.year_month\n        , to_number(unpivot.year_month || unpivot.day_of_month) report_date\n        , unpivot.vision_sbu\n        , unpivot.brn\n        , unpivot.contract_id\n        , unpivot.customer_number\n        , unpivot.currency\n        , unpivot.country\n        , unpivot.cost_center\n        , unpivot.mgt_line_short_desc_lv1\n        , unpivot.mgt_line_short_desc_lv2\n        , unpivot.eop_bal_lcy\n    FROM unpivot\n    LEFT JOIN max_rpt_date ON max_rpt_date.year_month = unpivot.year_month\n    WHERE to_number(unpivot.day_of_month) <= max_rpt_date.max_rpt_date\n)\nSELECT * FROM final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_vision__bal_dly"}, "model.dga_data_model.int_vision__bal_dly_eb": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int_vision__bal_dly"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE year_month >= {{ var(\"month_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bal_eb", "int_vision__bal_dly_eb"], "unique_id": "model.dga_data_model.int_vision__bal_dly_eb", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    pre_hook=['DELETE {{ this }}  WHERE year_month >= {{ var(\"month_id\") }}']\r\n  )\r\n}}\r\n\r\nWITH prd_map AS (\r\n    SELECT\r\n        year_month\r\n        , report_date\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , customer_number\r\n        , currency\r\n        , country\r\n        , cost_center\r\n        , mgt_line_short_desc_lv1\r\n        , mgt_line_short_desc_lv2\r\n        , eop_bal_lcy\r\n        , CASE\r\n            WHEN mgt_line_short_desc_lv2 = 'Fixed Deposit' THEN 'FD'\r\n            WHEN mgt_line_short_desc_lv2 = 'CASA' THEN 'CASA'\r\n            WHEN mgt_line_short_desc_lv2 IN ('CBI Bonds', 'Corporate Bonds') THEN 'CBI'\r\n            WHEN mgt_line_short_desc_lv2 = 'Credit Cards' THEN 'CREDIT CARD'\r\n            WHEN mgt_line_short_desc_lv2 = 'Overdrafts' THEN 'THAU CHI'\r\n            WHEN mgt_line_short_desc_lv2 = 'Loans' OR mgt_line_short_desc_lv1 = 'Loans to Customer' THEN 'OTHER LOAN'\r\n            WHEN mgt_line_short_desc_lv2 = 'Export LCs' AND cost_center IN ('LC','UB') THEN 'LC'\r\n            WHEN mgt_line_short_desc_lv2 = 'Export LCs' AND cost_center IN ('BG') THEN 'BG'\r\n            WHEN mgt_line_short_desc_lv2 = 'Export LCs' AND cost_center NOT IN ('LC','UB', 'BG') THEN 'OTHER OFFBS'\r\n            ELSE NULL\r\n          END product\r\n    FROM\r\n     {{ ref('int_vision__bal_dly')}}\r\n)\r\n, filter_eb AS (\r\n    SELECT\r\n        year_month\r\n        , report_date\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , customer_number\r\n        , currency\r\n        , country\r\n        , cost_center\r\n        , mgt_line_short_desc_lv1\r\n        , mgt_line_short_desc_lv2\r\n        , product\r\n        , CAST(NULL AS varchar2(100)) AS masorm_new\r\n        , CAST(NULL AS varchar2(100)) AS masocrm_new\r\n        , CASE\r\n            WHEN product IN ('OTHER LOAN', 'THAU CHI', 'CREDIT CARD', 'LC', 'BG' ,'CBI', 'OTHER OFFBS')\r\n                THEN eop_bal_lcy*-1\r\n            ELSE eop_bal_lcy\r\n          END eop_bal_lcy\r\n    FROM prd_map\r\n    WHERE product IS NOT NULL\r\n        AND (vision_sbu IN ('SME', 'FDI', 'B', 'MC', 'FI', 'LC', 'ME', 'BB', 'SOE', 'RBTC', 'CB')\r\n            OR substr(vision_sbu,1,4) = 'QLTD')\r\n)\r\nSELECT * FROM filter_eb\r\n{% if is_incremental() %}\r\nWHERE year_month > (SELECT MAX(year_month) FROM {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bal_eb\\int_vision__bal_dly_eb.sql", "original_file_path": "models\\int\\bal_eb\\int_vision__bal_dly_eb.sql", "name": "int_vision__bal_dly_eb", "alias": "int_vision__bal_dly_eb", "checksum": {"name": "sha256", "checksum": "970031cd74d91b9e0b4f05cf42bcb8ab14052c5ea041e441937301d3703b2a69"}, "tags": ["bal_eb_daily"], "refs": [["int_vision__bal_dly"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bal_eb\\int_bal_eb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_vision__bal_dly_eb.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "report_date"}, "tags": "bal_eb_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE year_month >= {{ var(\"month_id\") }}"]}, "created_at": 1685959752.6439917, "compiled_code": "\n\nWITH prd_map AS (\n    SELECT\n        year_month\n        , report_date\n        , vision_sbu\n        , brn\n        , contract_id\n        , customer_number\n        , currency\n        , country\n        , cost_center\n        , mgt_line_short_desc_lv1\n        , mgt_line_short_desc_lv2\n        , eop_bal_lcy\n        , CASE\n            WHEN mgt_line_short_desc_lv2 = 'Fixed Deposit' THEN 'FD'\n            WHEN mgt_line_short_desc_lv2 = 'CASA' THEN 'CASA'\n            WHEN mgt_line_short_desc_lv2 IN ('CBI Bonds', 'Corporate Bonds') THEN 'CBI'\n            WHEN mgt_line_short_desc_lv2 = 'Credit Cards' THEN 'CREDIT CARD'\n            WHEN mgt_line_short_desc_lv2 = 'Overdrafts' THEN 'THAU CHI'\n            WHEN mgt_line_short_desc_lv2 = 'Loans' OR mgt_line_short_desc_lv1 = 'Loans to Customer' THEN 'OTHER LOAN'\n            WHEN mgt_line_short_desc_lv2 = 'Export LCs' AND cost_center IN ('LC','UB') THEN 'LC'\n            WHEN mgt_line_short_desc_lv2 = 'Export LCs' AND cost_center IN ('BG') THEN 'BG'\n            WHEN mgt_line_short_desc_lv2 = 'Export LCs' AND cost_center NOT IN ('LC','UB', 'BG') THEN 'OTHER OFFBS'\n            ELSE NULL\n          END product\n    FROM\n     \"oracle_dgaworkzone\".int.int_vision__bal_dly\n)\n, filter_eb AS (\n    SELECT\n        year_month\n        , report_date\n        , vision_sbu\n        , brn\n        , contract_id\n        , customer_number\n        , currency\n        , country\n        , cost_center\n        , mgt_line_short_desc_lv1\n        , mgt_line_short_desc_lv2\n        , product\n        , CAST(NULL AS varchar2(100)) AS masorm_new\n        , CAST(NULL AS varchar2(100)) AS masocrm_new\n        , CASE\n            WHEN product IN ('OTHER LOAN', 'THAU CHI', 'CREDIT CARD', 'LC', 'BG' ,'CBI', 'OTHER OFFBS')\n                THEN eop_bal_lcy*-1\n            ELSE eop_bal_lcy\n          END eop_bal_lcy\n    FROM prd_map\n    WHERE product IS NOT NULL\n        AND (vision_sbu IN ('SME', 'FDI', 'B', 'MC', 'FI', 'LC', 'ME', 'BB', 'SOE', 'RBTC', 'CB')\n            OR substr(vision_sbu,1,4) = 'QLTD')\n)\nSELECT * FROM filter_eb\n\nWHERE year_month > (SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".int.int_vision__bal_dly_eb)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_vision__bal_dly_eb"}, "model.dga_data_model.int_vision__bal_mly_eb": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int_vision__bal_dly_eb", "model.dga_data_model.int_vision__bal_dly_eb"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE year_month >= {{ var(\"month_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bal_eb", "int_vision__bal_mly_eb"], "unique_id": "model.dga_data_model.int_vision__bal_mly_eb", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    pre_hook=['DELETE {{ this }}  WHERE year_month >= {{ var(\"month_id\") }}']\r\n  )\r\n}}\r\n\r\nWITH max_dt AS (\r\n    SELECT\r\n        MAX(year_month) AS year_month,\r\n        MAX(report_date) AS report_date\r\n    FROM {{ ref('int_vision__bal_dly_eb')}}\r\n), grp_by AS (\r\n    SELECT\r\n        bal_dly.year_month\r\n        , bal_dly.report_date\r\n        , bal_dly.vision_sbu\r\n        , bal_dly.brn\r\n        , bal_dly.contract_id\r\n        , bal_dly.customer_number\r\n        , bal_dly.currency\r\n        , bal_dly.country\r\n        , bal_dly.cost_center\r\n        , bal_dly.mgt_line_short_desc_lv1\r\n        , bal_dly.mgt_line_short_desc_lv2\r\n        , bal_dly.product\r\n        , bal_dly.masorm_new\r\n        , bal_dly.masocrm_new\r\n        , SUM(bal_dly.eop_bal_lcy) AS eop_bal_lcy\r\n        , to_number(to_char(TO_DATE(max(report_date),'yyyymmdd'),'dd')) AS no_of_day\r\n    FROM {{ ref('int_vision__bal_dly_eb')}} bal_dly\r\n    WHERE bal_dly.year_month = {{ var(\"month_id\") }}\r\n    GROUP BY\r\n        bal_dly.year_month\r\n        , bal_dly.report_date\r\n        , bal_dly.vision_sbu\r\n        , bal_dly.brn\r\n        , bal_dly.contract_id\r\n        , bal_dly.customer_number\r\n        , bal_dly.currency\r\n        , bal_dly.country\r\n        , bal_dly.cost_center\r\n        , bal_dly.mgt_line_short_desc_lv1\r\n        , bal_dly.mgt_line_short_desc_lv2\r\n        , bal_dly.product\r\n        , bal_dly.masorm_new\r\n        , bal_dly.masocrm_new\r\n), agg_daily AS (\r\n    SELECT\r\n        year_month\r\n        , report_date\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , customer_number\r\n        , currency\r\n        , country\r\n        , cost_center\r\n        , mgt_line_short_desc_lv1\r\n        , mgt_line_short_desc_lv2\r\n        , product\r\n        , masorm_new\r\n        , masocrm_new\r\n        , CAST(NULL AS varchar2(10))  AS term\r\n        , CAST(NULL AS varchar2(10))  AS term_in_day\r\n        , round(eop_bal_lcy, 0) AS eop_bal_lcy\r\n        , round(SUM(eop_bal_lcy)\r\n            OVER(PARTITION BY contract_id, brn, vision_sbu, cost_center, mgt_line_short_desc_lv1,\r\n                            mgt_line_short_desc_lv2, masorm_new, masocrm_new\r\n            ORDER BY\r\n                report_date\r\n            ROWS UNBOUNDED PRECEDING\r\n              ) / no_of_day, 0) AS avg_bal_lcy\r\n    FROM grp_by\r\n)\r\nSELECT * FROM agg_daily\r\nWHERE report_date = (SELECT report_date FROM max_dt)\r\n{% if is_incremental() %}\r\nAND year_month > (SELECT MAX(year_month) FROM {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bal_eb\\int_vision__bal_mly_eb.sql", "original_file_path": "models\\int\\bal_eb\\int_vision__bal_mly_eb.sql", "name": "int_vision__bal_mly_eb", "alias": "int_vision__bal_mly_eb", "checksum": {"name": "sha256", "checksum": "8922fca41f1fa0cce1f74354305da52565b18085eab47133139822acdbbf45bc"}, "tags": ["bal_eb_daily"], "refs": [["int_vision__bal_dly_eb"], ["int_vision__bal_dly_eb"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bal_eb\\int_bal_eb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_vision__bal_mly_eb.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "report_date"}, "tags": "bal_eb_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE year_month >= {{ var(\"month_id\") }}"]}, "created_at": 1685959752.647978, "compiled_code": "\n\nWITH max_dt AS (\n    SELECT\n        MAX(year_month) AS year_month,\n        MAX(report_date) AS report_date\n    FROM \"oracle_dgaworkzone\".int.int_vision__bal_dly_eb\n), grp_by AS (\n    SELECT\n        bal_dly.year_month\n        , bal_dly.report_date\n        , bal_dly.vision_sbu\n        , bal_dly.brn\n        , bal_dly.contract_id\n        , bal_dly.customer_number\n        , bal_dly.currency\n        , bal_dly.country\n        , bal_dly.cost_center\n        , bal_dly.mgt_line_short_desc_lv1\n        , bal_dly.mgt_line_short_desc_lv2\n        , bal_dly.product\n        , bal_dly.masorm_new\n        , bal_dly.masocrm_new\n        , SUM(bal_dly.eop_bal_lcy) AS eop_bal_lcy\n        , to_number(to_char(TO_DATE(max(report_date),'yyyymmdd'),'dd')) AS no_of_day\n    FROM \"oracle_dgaworkzone\".int.int_vision__bal_dly_eb bal_dly\n    WHERE bal_dly.year_month = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYMM'))\n    GROUP BY\n        bal_dly.year_month\n        , bal_dly.report_date\n        , bal_dly.vision_sbu\n        , bal_dly.brn\n        , bal_dly.contract_id\n        , bal_dly.customer_number\n        , bal_dly.currency\n        , bal_dly.country\n        , bal_dly.cost_center\n        , bal_dly.mgt_line_short_desc_lv1\n        , bal_dly.mgt_line_short_desc_lv2\n        , bal_dly.product\n        , bal_dly.masorm_new\n        , bal_dly.masocrm_new\n), agg_daily AS (\n    SELECT\n        year_month\n        , report_date\n        , vision_sbu\n        , brn\n        , contract_id\n        , customer_number\n        , currency\n        , country\n        , cost_center\n        , mgt_line_short_desc_lv1\n        , mgt_line_short_desc_lv2\n        , product\n        , masorm_new\n        , masocrm_new\n        , CAST(NULL AS varchar2(10))  AS term\n        , CAST(NULL AS varchar2(10))  AS term_in_day\n        , round(eop_bal_lcy, 0) AS eop_bal_lcy\n        , round(SUM(eop_bal_lcy)\n            OVER(PARTITION BY contract_id, brn, vision_sbu, cost_center, mgt_line_short_desc_lv1,\n                            mgt_line_short_desc_lv2, masorm_new, masocrm_new\n            ORDER BY\n                report_date\n            ROWS UNBOUNDED PRECEDING\n              ) / no_of_day, 0) AS avg_bal_lcy\n    FROM grp_by\n)\nSELECT * FROM agg_daily\nWHERE report_date = (SELECT report_date FROM max_dt)\n\nAND year_month > (SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".int.int_vision__bal_mly_eb)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_vision__bal_mly_eb"}, "model.dga_data_model.int__bal_mly_eb": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int_qlhs__bal_mly_eb", "model.dga_data_model.int_vision__bal_mly_eb"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE year_month > to_number(to_char(add_months(TO_DATE({{ var('month_id') }},'yyyymm'),-2),'yyyymm'))", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bal_eb", "int__bal_mly_eb"], "unique_id": "model.dga_data_model.int__bal_mly_eb", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    pre_hook=[\"DELETE {{ this }}  WHERE year_month > to_number(to_char(add_months(TO_DATE({{ var('month_id') }},'yyyymm'),-2),'yyyymm'))\"]\r\n  )\r\n}}\r\n\r\nWITH qlhs AS (\r\n    SELECT\r\n        year_month\r\n        , report_date\r\n        , vision_sbu\r\n        , brn\r\n        , contract_id\r\n        , customer_number\r\n        , currency\r\n        , country\r\n        , cost_center\r\n        , mgt_line_short_desc_lv1\r\n        , mgt_line_short_desc_lv2\r\n        , product\r\n        , masorm_new\r\n        , masocrm_new\r\n        , term\r\n        , term_in_day\r\n        , eop_bal_lcy\r\n        , avg_bal_lcy\r\n        , 'QLHS_EB' AS SOURCE\r\n    FROM {{ ref('int_qlhs__bal_mly_eb')}}\r\n)\r\n, vision AS (\r\n    SELECT\r\n        year_month\r\n        , report_date\r\n        , vision_sbu\r\n        , CAST(brn AS NUMBER) AS brn\r\n        , contract_id\r\n        , customer_number\r\n        , currency\r\n        , country\r\n        , cost_center\r\n        , mgt_line_short_desc_lv1\r\n        , mgt_line_short_desc_lv2\r\n        , product\r\n        , masorm_new\r\n        , masocrm_new\r\n        , term\r\n        , term_in_day\r\n        , eop_bal_lcy\r\n        , avg_bal_lcy\r\n        , 'VISION' AS SOURCE\r\n    FROM {{ ref('int_vision__bal_mly_eb')}}\r\n    WHERE year_month > (SELECT nvl(MAX(year_month),0) FROM qlhs)\r\n)\r\nSELECT * FROM vision\r\n    {% if is_incremental() %}\r\n    WHERE year_month > (SELECT MAX(year_month) FROM {{ this }})\r\n    {% endif %}\r\nUNION ALL\r\nSELECT * FROM qlhs\r\n    {% if is_incremental() %}\r\n    WHERE year_month > (SELECT MAX(year_month) FROM {{ this }})\r\n    {% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bal_eb\\int__bal_mly_eb.sql", "original_file_path": "models\\int\\bal_eb\\int__bal_mly_eb.sql", "name": "int__bal_mly_eb", "alias": "int__bal_mly_eb", "checksum": {"name": "sha256", "checksum": "1d56a4e58c2704319c257925b5b0ad3b46fbf2ebbe036e01f44848b420511a0c"}, "tags": ["bal_eb_daily"], "refs": [["int_qlhs__bal_mly_eb"], ["int_vision__bal_mly_eb"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "report_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bal_eb\\int_bal_eb.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int__bal_mly_eb.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "report_date"}, "tags": "bal_eb_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE year_month > to_number(to_char(add_months(TO_DATE({{ var('month_id') }},'yyyymm'),-2),'yyyymm'))"]}, "created_at": 1685959752.6539812, "compiled_code": "\n\nWITH qlhs AS (\n    SELECT\n        year_month\n        , report_date\n        , vision_sbu\n        , brn\n        , contract_id\n        , customer_number\n        , currency\n        , country\n        , cost_center\n        , mgt_line_short_desc_lv1\n        , mgt_line_short_desc_lv2\n        , product\n        , masorm_new\n        , masocrm_new\n        , term\n        , term_in_day\n        , eop_bal_lcy\n        , avg_bal_lcy\n        , 'QLHS_EB' AS SOURCE\n    FROM \"oracle_dgaworkzone\".int.int_qlhs__bal_mly_eb\n)\n, vision AS (\n    SELECT\n        year_month\n        , report_date\n        , vision_sbu\n        , CAST(brn AS NUMBER) AS brn\n        , contract_id\n        , customer_number\n        , currency\n        , country\n        , cost_center\n        , mgt_line_short_desc_lv1\n        , mgt_line_short_desc_lv2\n        , product\n        , masorm_new\n        , masocrm_new\n        , term\n        , term_in_day\n        , eop_bal_lcy\n        , avg_bal_lcy\n        , 'VISION' AS SOURCE\n    FROM \"oracle_dgaworkzone\".int.int_vision__bal_mly_eb\n    WHERE year_month > (SELECT nvl(MAX(year_month),0) FROM qlhs)\n)\nSELECT * FROM vision\n    \n    WHERE year_month > (SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb)\n    \nUNION ALL\nSELECT * FROM qlhs\n    \n    WHERE year_month > (SELECT MAX(year_month) FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb)\n    ", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__bal_mly_eb"}, "model.dga_data_model.bpm_vhkq__atm_module": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.base.imp_bpm_vhkq__category", "model.dga_data_model.bpm_vhkq__request_atm_tray_detail", "model.dga_data_model.bpm_vhkq__request_atm", "model.dga_data_model.bpm_vhkq__request_atm_detail", "model.dga_data_model.bpm_vhkq__request_atm_card_detail", "model.dga_data_model.bpm_vhkq__process_instance", "model.dga_data_model.bpm_vhkq__process_definition", "model.dga_data_model.bpm_vhkq__atm", "model.dga_data_model.bpm_vhkq__staff_request_atm", "model.dga_data_model.bpm_vhkq__staff"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["updated_at"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bpm_vhkq", "bpm_vhkq__atm_module"], "unique_id": "model.dga_data_model.bpm_vhkq__atm_module", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nwith\r\ndat_amount as (\r\n    select request_atm,\r\n        atm,\r\n        type as atm_tray_type,\r\n        denominationvalue as atm_tray_denominationvalue,\r\n        qty as  atm_tray_qty,\r\n        denominationvalue * qty so_tien\r\n    from {{ ref('bpm_vhkq__request_atm_tray_detail') }}\r\n)\r\n, dat_amount_sum as (\r\n    select request_atm,\r\n        atm,\r\n        sum(so_tien) so_tien,\r\n        sum(atm_tray_qty / 1000) so_bo_tien\r\n    from dat_amount\r\n    group by request_atm,\r\n        atm\r\n)\r\n, source as (\r\n    SELECT distinct\r\n        t1.id as atm_request_id,\r\n        CASE\r\n            WHEN t1.type = 'CT' THEN\r\n                'Ti\u1ebfp - ki\u1ec3m ATM'\r\n            WHEN t1.type = 'OP' THEN\r\n                'L\u1eadp k\u1ebf ho\u1ea1ch ATM'\r\n        END  as process_type,\r\n        case when t5.name = 'Lu\u1ed3ng v\u1eadn h\u00e0nh ATM'\r\n            then 'L\u1eadp k\u1ebf ho\u1ea1ch ATM'\r\n            else t5.name\r\n        end as process_name,\r\n        CASE\r\n            WHEN t1.type = 'CT'\r\n                 AND t1.type_operate = 'CHECK_FUND' THEN\r\n                'Ki\u1ec3m qu\u1ef9'\r\n            WHEN t1.type = 'CT'\r\n                 AND t1.type_operate = 'TO_CHECK_FUND' THEN\r\n                'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n            WHEN t1.type = 'CT'\r\n                 AND t1.type_operate = 'TO_FUND' THEN\r\n                'Ti\u1ebfp qu\u1ef9'\r\n            ELSE\r\n                'L\u1eadp k\u1ebf ho\u1ea1ch ATM'\r\n        END as process_detail,\r\n        t1.created_at,\r\n        t1.updated_at,\r\n        t1.accounting_date,\r\n        t1.approval_date,\r\n        t1.execute_date,\r\n        t1.issued_date_checker,\r\n        t1.plan_date,\r\n        t1.submitted_at,\r\n        t1.verify_date,\r\n        t1.verify_received_date,\r\n        t1.issued_date_recipient,\r\n        t1.approver,\r\n        t1.checker,\r\n        t1.created_by,\r\n        t1.staff_atm,\r\n        t1.submitted_by,\r\n        t1.treasurer_atm,\r\n        t1.unit_manager,\r\n        t1.verifier,\r\n        t1.cbdm,\r\n        t1.recipient,\r\n        t1.status  as request_status,\r\n        t1.is_complete,\r\n        t4.is_disabled,\r\n        t4.disabled_by,\r\n        t4.disabled_at,\r\n        t4.highest_task_definition_key,\r\n        t4.status as process_status_code,\r\n        t8.name  as  process_status_name,\r\n        t1.organization_code as ma_don_vi_vh,\r\n        t2.atm as atm_id,\r\n        t6.code as  atm_code,\r\n        t6.\"GROUP\"  as  atm_group,\r\n        t6.status   as atm_status,\r\n        t6.cycle_status as atm_cycle_status,\r\n        t2.tray_structure as  atm_tray_structure,\r\n        t1.is_branch,\r\n        t1.entry_core,\r\n        t1.entry_number,\r\n        t1.kq_fund_balance,\r\n        t1.kq_is_diff,\r\n        t1.kq_is_hold_card,\r\n        t1.kq_is_seal,\r\n        t1.kq_is_success,\r\n        t1.kq_note,\r\n        t1.kq_total_diff,\r\n        t1.total_fund,\r\n        t1.total_fund_recovery,\r\n        t1.tq_is_seal,\r\n        t1.tq_is_success,\r\n        t1.tq_note,\r\n        t1.ttc_hour_from,\r\n        t1.ttc_hour_to,\r\n        round((TO_DATE(t1.ttc_hour_to, 'HH24:MI:SS') - TO_DATE(t1.ttc_hour_from, 'HH24:MI:SS')) * 24 * 60,0) as number_of_min_transfrom,\r\n        t1.ttc_num_km_from,\r\n        t1.ttc_num_km_to,\r\n        t1.ttc_num_km_to - t1.ttc_num_km_from number_of_km,\r\n        t2.reason_operate,\r\n        t2.optimal_fund_limit,\r\n        t2.regulation_fund_limit,\r\n        t2.total_keys_staff_using,\r\n        t2.total_keys_treasurer_using,\r\n        t2.total_numeric_lock_staff_backup,\r\n        t2.total_numeric_lock_treasurer_backup,\r\n        t9.id staff_request_id,\r\n        t9.USERNAME staff_request_username,\r\n        t9.REQUEST_TYPE staff_REQUEST_TYPE,\r\n        t9.TYPE staff_request_role,\r\n        t10.STAFF_TITLE ,\r\n        t3.CARD_NUMBER,\r\n        t1.ref request_atm_ref,\r\n        t1.last_comment,\r\n        t7.so_tien,\r\n        t7.so_bo_tien\r\n    FROM\r\n        {{ ref('bpm_vhkq__request_atm') }}                       t1\r\n        LEFT JOIN {{ ref('bpm_vhkq__request_atm_detail') }}      t2 ON t1.id = t2.request_atm AND t2.is_deleted = 0\r\n        LEFT JOIN {{ ref('bpm_vhkq__request_atm_card_detail') }} t3 ON t1.id = t3.request_atm and t3.IS_DELETED = 0\r\n        LEFT JOIN {{ ref('bpm_vhkq__process_instance') }}        t4 ON t1.process_instance = t4.id\r\n        LEFT JOIN {{ ref('bpm_vhkq__process_definition') }}      t5 ON t4.process_definition_id = t5.id\r\n        LEFT JOIN {{ ref('bpm_vhkq__atm') }}                     t6 ON t2.atm = t6.id\r\n        LEFT JOIN dat_amount_sum                                 t7 ON t7.request_atm = t1.id AND t7.atm = t2.atm\r\n        left join {{source ('base', 'imp_bpm_vhkq__category') }} t8 on t4.status = t8.code and t8.Business_Type = 'ATM' and t8.Group_Category = 'Process status'\r\n        left join {{ ref('bpm_vhkq__staff_request_atm') }}       t9 on t1.id = t9.request_id\r\n        left join {{ ref('bpm_vhkq__staff') }}                   t10 on t9.staff = t10.id\r\n)\r\nSELECT\r\n    *\r\nFROM\r\n    source\r\nORDER BY\r\n        ATM_REQUEST_ID, ATM_ID, STAFF_REQUEST_ID", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bpm_vhkq\\bpm_vhkq__atm_module.sql", "original_file_path": "models\\int\\bpm_vhkq\\bpm_vhkq__atm_module.sql", "name": "bpm_vhkq__atm_module", "alias": "bpm_vhkq__atm_module", "checksum": {"name": "sha256", "checksum": "3c125203a54844449243a7db4859dac402d43ecca18bd16ae6b5f2bc93e44c2a"}, "tags": ["updated_at"], "refs": [["bpm_vhkq__request_atm_tray_detail"], ["bpm_vhkq__request_atm"], ["bpm_vhkq__request_atm_detail"], ["bpm_vhkq__request_atm_card_detail"], ["bpm_vhkq__process_instance"], ["bpm_vhkq__process_definition"], ["bpm_vhkq__atm"], ["bpm_vhkq__staff_request_atm"], ["bpm_vhkq__staff"]], "sources": [["base", "imp_bpm_vhkq__category"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\bpm_vhkq__atm_module.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "updated_at"}, "tags": ["updated_at"], "materialized": "table"}, "created_at": 1685959752.6599839, "compiled_code": "\nwith\ndat_amount as (\n    select request_atm,\n        atm,\n        type as atm_tray_type,\n        denominationvalue as atm_tray_denominationvalue,\n        qty as  atm_tray_qty,\n        denominationvalue * qty so_tien\n    from \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_tray_detail\n)\n, dat_amount_sum as (\n    select request_atm,\n        atm,\n        sum(so_tien) so_tien,\n        sum(atm_tray_qty / 1000) so_bo_tien\n    from dat_amount\n    group by request_atm,\n        atm\n)\n, source as (\n    SELECT distinct\n        t1.id as atm_request_id,\n        CASE\n            WHEN t1.type = 'CT' THEN\n                'Ti\u1ebfp - ki\u1ec3m ATM'\n            WHEN t1.type = 'OP' THEN\n                'L\u1eadp k\u1ebf ho\u1ea1ch ATM'\n        END  as process_type,\n        case when t5.name = 'Lu\u1ed3ng v\u1eadn h\u00e0nh ATM'\n            then 'L\u1eadp k\u1ebf ho\u1ea1ch ATM'\n            else t5.name\n        end as process_name,\n        CASE\n            WHEN t1.type = 'CT'\n                 AND t1.type_operate = 'CHECK_FUND' THEN\n                'Ki\u1ec3m qu\u1ef9'\n            WHEN t1.type = 'CT'\n                 AND t1.type_operate = 'TO_CHECK_FUND' THEN\n                'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n            WHEN t1.type = 'CT'\n                 AND t1.type_operate = 'TO_FUND' THEN\n                'Ti\u1ebfp qu\u1ef9'\n            ELSE\n                'L\u1eadp k\u1ebf ho\u1ea1ch ATM'\n        END as process_detail,\n        t1.created_at,\n        t1.updated_at,\n        t1.accounting_date,\n        t1.approval_date,\n        t1.execute_date,\n        t1.issued_date_checker,\n        t1.plan_date,\n        t1.submitted_at,\n        t1.verify_date,\n        t1.verify_received_date,\n        t1.issued_date_recipient,\n        t1.approver,\n        t1.checker,\n        t1.created_by,\n        t1.staff_atm,\n        t1.submitted_by,\n        t1.treasurer_atm,\n        t1.unit_manager,\n        t1.verifier,\n        t1.cbdm,\n        t1.recipient,\n        t1.status  as request_status,\n        t1.is_complete,\n        t4.is_disabled,\n        t4.disabled_by,\n        t4.disabled_at,\n        t4.highest_task_definition_key,\n        t4.status as process_status_code,\n        t8.name  as  process_status_name,\n        t1.organization_code as ma_don_vi_vh,\n        t2.atm as atm_id,\n        t6.code as  atm_code,\n        t6.\"GROUP\"  as  atm_group,\n        t6.status   as atm_status,\n        t6.cycle_status as atm_cycle_status,\n        t2.tray_structure as  atm_tray_structure,\n        t1.is_branch,\n        t1.entry_core,\n        t1.entry_number,\n        t1.kq_fund_balance,\n        t1.kq_is_diff,\n        t1.kq_is_hold_card,\n        t1.kq_is_seal,\n        t1.kq_is_success,\n        t1.kq_note,\n        t1.kq_total_diff,\n        t1.total_fund,\n        t1.total_fund_recovery,\n        t1.tq_is_seal,\n        t1.tq_is_success,\n        t1.tq_note,\n        t1.ttc_hour_from,\n        t1.ttc_hour_to,\n        round((TO_DATE(t1.ttc_hour_to, 'HH24:MI:SS') - TO_DATE(t1.ttc_hour_from, 'HH24:MI:SS')) * 24 * 60,0) as number_of_min_transfrom,\n        t1.ttc_num_km_from,\n        t1.ttc_num_km_to,\n        t1.ttc_num_km_to - t1.ttc_num_km_from number_of_km,\n        t2.reason_operate,\n        t2.optimal_fund_limit,\n        t2.regulation_fund_limit,\n        t2.total_keys_staff_using,\n        t2.total_keys_treasurer_using,\n        t2.total_numeric_lock_staff_backup,\n        t2.total_numeric_lock_treasurer_backup,\n        t9.id staff_request_id,\n        t9.USERNAME staff_request_username,\n        t9.REQUEST_TYPE staff_REQUEST_TYPE,\n        t9.TYPE staff_request_role,\n        t10.STAFF_TITLE ,\n        t3.CARD_NUMBER,\n        t1.ref request_atm_ref,\n        t1.last_comment,\n        t7.so_tien,\n        t7.so_bo_tien\n    FROM\n        \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm                       t1\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_detail      t2 ON t1.id = t2.request_atm AND t2.is_deleted = 0\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__request_atm_card_detail t3 ON t1.id = t3.request_atm and t3.IS_DELETED = 0\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__process_instance        t4 ON t1.process_instance = t4.id\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__process_definition      t5 ON t4.process_definition_id = t5.id\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__atm                     t6 ON t2.atm = t6.id\n        LEFT JOIN dat_amount_sum                                 t7 ON t7.request_atm = t1.id AND t7.atm = t2.atm\n        left join oracle_dgaworkzone.base.imp_bpm_vhkq__category t8 on t4.status = t8.code and t8.Business_Type = 'ATM' and t8.Group_Category = 'Process status'\n        left join \"oracle_dgaworkzone\".base.bpm_vhkq__staff_request_atm       t9 on t1.id = t9.request_id\n        left join \"oracle_dgaworkzone\".base.bpm_vhkq__staff                   t10 on t9.staff = t10.id\n)\nSELECT\n    *\nFROM\n    source\nORDER BY\n        ATM_REQUEST_ID, ATM_ID, STAFF_REQUEST_ID", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.bpm_vhkq__atm_module"}, "model.dga_data_model.bpm_vhkq__kq_module": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.base.imp_bpm_vhkq__category", "model.dga_data_model.bpm_vhkq__request_branch", "model.dga_data_model.bpm_vhkq__request_branch_detail", "model.dga_data_model.bpm_vhkq__process_instance", "model.dga_data_model.bpm_vhkq__process_definition", "model.dga_data_model.bpm_vhkq__staff_request_branch", "model.dga_data_model.bpm_vhkq__delivery", "model.dga_data_model.bpm_vhkq__staff", "model.dga_data_model.bpm_vhkq__process_instance_his", "model.dga_data_model.bpm_vhkq__staff"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bpm_vhkq", "bpm_vhkq__kq_module"], "unique_id": "model.dga_data_model.bpm_vhkq__kq_module", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat_vhkq AS (\r\n    SELECT DISTINCT\r\n        t1.id                                request_branch_id,\r\n        t1.type                              process_type_code,\r\n        CASE\r\n            WHEN t1.type LIKE 'INV%' THEN\r\n                'Lu\u1ed3ng ki\u1ec3m k\u00ea'\r\n            WHEN t1.type LIKE 'PI%' THEN\r\n                'Lu\u1ed3ng nh\u1eadp qu\u1ef9'\r\n            WHEN t1.type LIKE 'PO%' THEN\r\n                'Lu\u1ed3ng xu\u1ea5t qu\u1ef9'\r\n            WHEN t1.type LIKE 'SK%' THEN\r\n                'Lu\u1ed3ng x\u1eed l\u00fd th\u1eeba thi\u1ebfu'\r\n        END                                  process_type,\r\n        CASE\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea acqt cu\u1ed1i th\u00e1ng%' THEN\r\n                'Ki\u1ec3m k\u00ea ACQT cu\u1ed1i th\u00e1ng'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea acqt t\u1ea1i kho%' THEN\r\n                'Ki\u1ec3m k\u00ea ACQT t\u1ea1i kho'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ti\u00eau h\u1ee7y atqt%' THEN\r\n                'Ti\u00eau h\u1ee7y ACQT'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%t\u1ed5ng ki\u1ec3m k\u00ea%' THEN\r\n                'T\u1ed5ng ki\u1ec3m k\u00ea'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t atm%' THEN\r\n                'Ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t ATM'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t atm tai vhkq%' THEN\r\n                'Ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t ATM t\u1ea1i VHKQ'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t qu\u1ef9 \u0111\u01a1n v\u1ecb%' THEN\r\n                'Ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t qu\u1ef9 \u0111\u01a1n v\u1ecb'\r\n            WHEN t1.type = 'INV04'\r\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea ts\u0111b \u0111\u1ed9t xu\u1ea5t%' THEN\r\n                'Ki\u1ec3m k\u00ea TS\u0110B \u0111\u1ed9t xu\u1ea5t'\r\n            ELSE\r\n                t6.name\r\n        END                                  process_detail,\r\n        t1.process_instance_id,\r\n        t1.created_at,\r\n        t1.updated_at,\r\n        t1.pay_in_date,\r\n        t1.approval1_date,\r\n        t1.approval_date,\r\n        t1.comment_date,\r\n        t1.detect_date,\r\n        t1.seal_date,\r\n        t1.submitted_at,\r\n        t1.approver,\r\n        t1.approver1,\r\n        t1.created_by,\r\n        t1.updated_by,\r\n        t1.handler,\r\n        t1.fault_user,\r\n        t10.from_user                        submited_by,\r\n--        t7.position,\r\n        t7.POSITION_ID,\r\n--        t7.staff_name,\r\n--        t7.type                              staff_request_type,\r\n        lower(nvl(nvl(t9.username, t11.username),lower(regexp_substr(t7.username, '[^@]+', 1, 1, 'i')) ))      username_nv_tham_gia,\r\n        upper(nvl(t9.type, t7.type))                        loai_hinh_nv_tham_gia,\r\n        nvl(t9.code, t11.code)                        ma_nv_tham_gia,\r\n        upper(nvl(nvl(t9.name, t11.name) , t7. staff_name))                      ten_nv_tham_gia,\r\n        nvl(nvl(t9.position, t11.position), t7.position)                  chuc_danh_nv_tham_gia,\r\n        t1.seal_status,\r\n        t1.status                            request_branch_status,\r\n        t2.is_deleted,\r\n        t3.is_disabled,\r\n        t3.disabled_at,\r\n        t3.disabled_by,\r\n        t3.highest_task_definition_key,\r\n        t3.status                            process_status_code,\r\n        t5.name                              process_status_name,\r\n        CASE\r\n            WHEN t1.organization_receive_code = '042' THEN\r\n                '04205'\r\n            ELSE\r\n                t1.organization_receive_code\r\n        END                                  organization_receive_code,\r\n        CASE\r\n            WHEN t1.organization_receive_code = '042' THEN\r\n                'MSB \u0110\u00f4 Th\u00e0nh'\r\n            ELSE\r\n                t1.organization_receive_name\r\n        END                                  organization_receive_name,\r\n        CASE\r\n            WHEN t1.organization_send_code = '042' THEN\r\n                '04205'\r\n            ELSE\r\n                t1.organization_send_code\r\n        END                                  organization_send_code,\r\n        CASE\r\n            WHEN t1.organization_send_code = '042' THEN\r\n                'MSB \u0110\u00f4 Th\u00e0nh'\r\n            ELSE\r\n                t1.organization_send_name\r\n        END                                  organization_send_name,\r\n        t1.delivery_type,\r\n        t1.over_threshold,\r\n        t1.box_count,\r\n        t1.count_form,\r\n        t1.count_hour,\r\n        t1.count_minute,\r\n        t1.hour_from,\r\n        t1.hour_to,\r\n        round((TO_DATE(t1.hour_to, 'HH24:MI') - TO_DATE(t1.hour_from, 'HH24:MI')) * 24 * 60,0)    number_of_min_transfrom,\r\n        t1.num_km_from,\r\n        t1.num_km_to,\r\n        t1.num_km_to - t1.num_km_from        number_of_km,\r\n        t1.pay_in_hour,\r\n        t1.pay_in_minute,\r\n        t1.skewed_type,\r\n        t1.total_skewed,\r\n        t2.type                              currency_type,\r\n        t2.currency,\r\n        t2.denominationcode,\r\n        t2.denominationvalue,\r\n        t2.qty_actual,\r\n        t2.qty_actual * t2.denominationvalue value_actual,\r\n        t2.qty_back_fund,\r\n        t2.qty_begin_day,\r\n        t2.qty_system,\r\n        t2.qty_system * t2.denominationvalue system_value_actual,\r\n        t2.qty_system_old,\r\n        t2.receive_fund_limit,\r\n        t2.total_add,\r\n        t2.total_begin_day,\r\n        t2.total_old,\r\n        t1.note                              request_branch_note,\r\n        t2.note                              request_branch_detail_note,\r\n        t1.last_comment,\r\n        t1.reason,\r\n        t1.process_reason\r\n--    t1.id request_branch_id,\r\n\r\n    FROM\r\n        {{ ref('bpm_vhkq__request_branch') }}        t1\r\n        LEFT JOIN {{ ref('bpm_vhkq__request_branch_detail') }} t2 ON t1.id = t2.request_branch_id\r\n        LEFT JOIN {{ ref('bpm_vhkq__process_instance') }}     t3 ON t1.process_instance_id = t3.id\r\n        LEFT JOIN {{ ref('bpm_vhkq__process_definition') }}    t4 ON t3.process_definition_id = t4.id\r\n        LEFT JOIN {{source ('base', 'imp_bpm_vhkq__category') }}          t5 ON t3.status = t5.code\r\n                                               AND t5.business_type = 'VHKQ'\r\n                                               AND t5.group_category = 'Process status'\r\n        LEFT JOIN {{source ('base', 'imp_bpm_vhkq__category') }}          t6 ON t1.type = t6.code\r\n                                               AND t6.business_type = 'VHKQ'\r\n                                               AND t6.group_category = 'Process type'\r\n        LEFT JOIN {{ ref('bpm_vhkq__staff_request_branch') }}  t7 ON t1.id = t7.request_branch_id\r\n                                                AND t7.is_deleted = 0\r\n        LEFT JOIN {{ ref('bpm_vhkq__delivery') }}              t8 ON t1.id = t8.request_branch_id\r\n                                           AND t8.is_deleted = 0\r\n        LEFT JOIN {{ ref('bpm_vhkq__staff') }}                 t9 ON t8.staff_id = t9.id --and t9.type = 'AT'\r\n        LEFT JOIN {{ ref('bpm_vhkq__process_instance_his') }}  t10 ON t1.process_instance_id = t10.process_instance_id\r\n                                                        AND t10.status IN ( 'KQ_PI_02', 'KQ_PO_00', 'KQ_INV_00' )\r\n        LEFT JOIN {{ ref('bpm_vhkq__staff') }}                 t11 ON lower(regexp_substr(t7.username, '[^@]+', 1, 1, 'i')) = lower(t11.username)\r\n)\r\nSELECT DISTINCT\r\n    *\r\nFROM\r\n    dat_vhkq\r\nWHERE\r\n    1 = 1\r\nORDER BY\r\n    request_branch_id", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bpm_vhkq\\bpm_vhkq__kq_module.sql", "original_file_path": "models\\int\\bpm_vhkq\\bpm_vhkq__kq_module.sql", "name": "bpm_vhkq__kq_module", "alias": "bpm_vhkq__kq_module", "checksum": {"name": "sha256", "checksum": "ceb0efd8ea992dabca0cb36318177e3398de4707e58fdd99010374008ec8ebe0"}, "tags": ["vhkq_daily"], "refs": [["bpm_vhkq__request_branch"], ["bpm_vhkq__request_branch_detail"], ["bpm_vhkq__process_instance"], ["bpm_vhkq__process_definition"], ["bpm_vhkq__staff_request_branch"], ["bpm_vhkq__delivery"], ["bpm_vhkq__staff"], ["bpm_vhkq__process_instance_his"], ["bpm_vhkq__staff"]], "sources": [["base", "imp_bpm_vhkq__category"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\bpm_vhkq__kq_module.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.661978, "compiled_code": "\nWITH dat_vhkq AS (\n    SELECT DISTINCT\n        t1.id                                request_branch_id,\n        t1.type                              process_type_code,\n        CASE\n            WHEN t1.type LIKE 'INV%' THEN\n                'Lu\u1ed3ng ki\u1ec3m k\u00ea'\n            WHEN t1.type LIKE 'PI%' THEN\n                'Lu\u1ed3ng nh\u1eadp qu\u1ef9'\n            WHEN t1.type LIKE 'PO%' THEN\n                'Lu\u1ed3ng xu\u1ea5t qu\u1ef9'\n            WHEN t1.type LIKE 'SK%' THEN\n                'Lu\u1ed3ng x\u1eed l\u00fd th\u1eeba thi\u1ebfu'\n        END                                  process_type,\n        CASE\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea acqt cu\u1ed1i th\u00e1ng%' THEN\n                'Ki\u1ec3m k\u00ea ACQT cu\u1ed1i th\u00e1ng'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea acqt t\u1ea1i kho%' THEN\n                'Ki\u1ec3m k\u00ea ACQT t\u1ea1i kho'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ti\u00eau h\u1ee7y atqt%' THEN\n                'Ti\u00eau h\u1ee7y ACQT'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%t\u1ed5ng ki\u1ec3m k\u00ea%' THEN\n                'T\u1ed5ng ki\u1ec3m k\u00ea'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t atm%' THEN\n                'Ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t ATM'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t atm tai vhkq%' THEN\n                'Ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t ATM t\u1ea1i VHKQ'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t qu\u1ef9 \u0111\u01a1n v\u1ecb%' THEN\n                'Ki\u1ec3m k\u00ea \u0111\u1ed9t su\u1ea5t qu\u1ef9 \u0111\u01a1n v\u1ecb'\n            WHEN t1.type = 'INV04'\n                 AND lower(t1.note) LIKE '%ki\u1ec3m k\u00ea ts\u0111b \u0111\u1ed9t xu\u1ea5t%' THEN\n                'Ki\u1ec3m k\u00ea TS\u0110B \u0111\u1ed9t xu\u1ea5t'\n            ELSE\n                t6.name\n        END                                  process_detail,\n        t1.process_instance_id,\n        t1.created_at,\n        t1.updated_at,\n        t1.pay_in_date,\n        t1.approval1_date,\n        t1.approval_date,\n        t1.comment_date,\n        t1.detect_date,\n        t1.seal_date,\n        t1.submitted_at,\n        t1.approver,\n        t1.approver1,\n        t1.created_by,\n        t1.updated_by,\n        t1.handler,\n        t1.fault_user,\n        t10.from_user                        submited_by,\n--        t7.position,\n        t7.POSITION_ID,\n--        t7.staff_name,\n--        t7.type                              staff_request_type,\n        lower(nvl(nvl(t9.username, t11.username),lower(regexp_substr(t7.username, '[^@]+', 1, 1, 'i')) ))      username_nv_tham_gia,\n        upper(nvl(t9.type, t7.type))                        loai_hinh_nv_tham_gia,\n        nvl(t9.code, t11.code)                        ma_nv_tham_gia,\n        upper(nvl(nvl(t9.name, t11.name) , t7. staff_name))                      ten_nv_tham_gia,\n        nvl(nvl(t9.position, t11.position), t7.position)                  chuc_danh_nv_tham_gia,\n        t1.seal_status,\n        t1.status                            request_branch_status,\n        t2.is_deleted,\n        t3.is_disabled,\n        t3.disabled_at,\n        t3.disabled_by,\n        t3.highest_task_definition_key,\n        t3.status                            process_status_code,\n        t5.name                              process_status_name,\n        CASE\n            WHEN t1.organization_receive_code = '042' THEN\n                '04205'\n            ELSE\n                t1.organization_receive_code\n        END                                  organization_receive_code,\n        CASE\n            WHEN t1.organization_receive_code = '042' THEN\n                'MSB \u0110\u00f4 Th\u00e0nh'\n            ELSE\n                t1.organization_receive_name\n        END                                  organization_receive_name,\n        CASE\n            WHEN t1.organization_send_code = '042' THEN\n                '04205'\n            ELSE\n                t1.organization_send_code\n        END                                  organization_send_code,\n        CASE\n            WHEN t1.organization_send_code = '042' THEN\n                'MSB \u0110\u00f4 Th\u00e0nh'\n            ELSE\n                t1.organization_send_name\n        END                                  organization_send_name,\n        t1.delivery_type,\n        t1.over_threshold,\n        t1.box_count,\n        t1.count_form,\n        t1.count_hour,\n        t1.count_minute,\n        t1.hour_from,\n        t1.hour_to,\n        round((TO_DATE(t1.hour_to, 'HH24:MI') - TO_DATE(t1.hour_from, 'HH24:MI')) * 24 * 60,0)    number_of_min_transfrom,\n        t1.num_km_from,\n        t1.num_km_to,\n        t1.num_km_to - t1.num_km_from        number_of_km,\n        t1.pay_in_hour,\n        t1.pay_in_minute,\n        t1.skewed_type,\n        t1.total_skewed,\n        t2.type                              currency_type,\n        t2.currency,\n        t2.denominationcode,\n        t2.denominationvalue,\n        t2.qty_actual,\n        t2.qty_actual * t2.denominationvalue value_actual,\n        t2.qty_back_fund,\n        t2.qty_begin_day,\n        t2.qty_system,\n        t2.qty_system * t2.denominationvalue system_value_actual,\n        t2.qty_system_old,\n        t2.receive_fund_limit,\n        t2.total_add,\n        t2.total_begin_day,\n        t2.total_old,\n        t1.note                              request_branch_note,\n        t2.note                              request_branch_detail_note,\n        t1.last_comment,\n        t1.reason,\n        t1.process_reason\n--    t1.id request_branch_id,\n\n    FROM\n        \"oracle_dgaworkzone\".base.bpm_vhkq__request_branch        t1\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__request_branch_detail t2 ON t1.id = t2.request_branch_id\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__process_instance     t3 ON t1.process_instance_id = t3.id\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__process_definition    t4 ON t3.process_definition_id = t4.id\n        LEFT JOIN oracle_dgaworkzone.base.imp_bpm_vhkq__category          t5 ON t3.status = t5.code\n                                               AND t5.business_type = 'VHKQ'\n                                               AND t5.group_category = 'Process status'\n        LEFT JOIN oracle_dgaworkzone.base.imp_bpm_vhkq__category          t6 ON t1.type = t6.code\n                                               AND t6.business_type = 'VHKQ'\n                                               AND t6.group_category = 'Process type'\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__staff_request_branch  t7 ON t1.id = t7.request_branch_id\n                                                AND t7.is_deleted = 0\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__delivery              t8 ON t1.id = t8.request_branch_id\n                                           AND t8.is_deleted = 0\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__staff                 t9 ON t8.staff_id = t9.id --and t9.type = 'AT'\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__process_instance_his  t10 ON t1.process_instance_id = t10.process_instance_id\n                                                        AND t10.status IN ( 'KQ_PI_02', 'KQ_PO_00', 'KQ_INV_00' )\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__staff                 t11 ON lower(regexp_substr(t7.username, '[^@]+', 1, 1, 'i')) = lower(t11.username)\n)\nSELECT DISTINCT\n    *\nFROM\n    dat_vhkq\nWHERE\n    1 = 1\nORDER BY\n    request_branch_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.bpm_vhkq__kq_module"}, "model.dga_data_model.bpm_vhkq__kq_module_unit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.bpm_vhkq__kq_module"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bpm_vhkq", "bpm_vhkq__kq_module_unit"], "unique_id": "model.dga_data_model.bpm_vhkq__kq_module_unit", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nwith dat as (\r\n    select distinct\r\n        request_branch_id,\r\n        process_type_code,\r\n        process_type,\r\n        process_detail,\r\n        created_at,\r\n        updated_at,\r\n        pay_in_date,\r\n        approval1_date,\r\n        approval_date,\r\n        submitted_at,\r\n        approver,\r\n        approver1,\r\n        created_by,\r\n        updated_by,\r\n        submited_by,\r\n        request_branch_status,\r\n        process_status_code,\r\n        process_status_name,\r\n        organization_receive_code,\r\n        organization_receive_name,\r\n        organization_send_code,\r\n        organization_send_name,\r\n        delivery_type,\r\n        currency_type,\r\n        currency,\r\n        request_branch_note,\r\n        request_branch_detail_note,\r\n        process_instance_id,\r\n        box_count,\r\n        hour_from,\r\n        hour_to,\r\n        number_of_min_transfrom,\r\n        num_km_from,\r\n        num_km_to,\r\n        number_of_km,\r\n        pay_in_hour,\r\n        pay_in_minute,\r\n        qty_actual,\r\n        value_actual,\r\n        qty_back_fund,\r\n        qty_begin_day,\r\n        qty_system,\r\n        system_value_actual,\r\n        qty_system_old,\r\n        receive_fund_limit\r\n    FROM\r\n        {{ ref('bpm_vhkq__kq_module')}}\r\n    where 1=1\r\n    and ( IS_DELETED is null or IS_DELETED = 0)\r\n    and IS_DISABLED is null\r\n    and PROCESS_DETAIL is not null\r\n)\r\nSELECT\r\n    request_branch_id,\r\n    process_type_code,\r\n    process_type,\r\n    process_detail,\r\n    created_at,\r\n    updated_at,\r\n    pay_in_date,\r\n    approval1_date,\r\n    approval_date,\r\n    submitted_at,\r\n    approver,\r\n    approver1,\r\n    created_by,\r\n    updated_by,\r\n    submited_by,\r\n    request_branch_status,\r\n    process_status_code,\r\n    process_status_name,\r\n    organization_receive_code,\r\n    organization_receive_name,\r\n    organization_send_code,\r\n    organization_send_name,\r\n    delivery_type,\r\n    currency_type,\r\n    currency,\r\n    request_branch_note,\r\n    request_branch_detail_note,\r\n    process_instance_id,\r\n    box_count,\r\n    hour_from,\r\n    hour_to,\r\n    number_of_min_transfrom,\r\n    num_km_from,\r\n    num_km_to,\r\n    number_of_km,\r\n    pay_in_hour,\r\n    pay_in_minute,\r\n    sum(qty_actual) qty_actual,\r\n    sum(value_actual) value_actual,\r\n    sum(qty_back_fund) qty_back_fund,\r\n    sum(qty_begin_day) qty_begin_day,\r\n    sum(qty_system) qty_system,\r\n    sum(system_value_actual) system_value_actual,\r\n    sum(qty_system_old) qty_system_old,\r\n    sum(receive_fund_limit) receive_fund_limit\r\nfrom   dat\r\ngroup by request_branch_id,\r\n    process_type_code,\r\n    process_type,\r\n    process_detail,\r\n    created_at,\r\n    updated_at,\r\n    pay_in_date,\r\n    approval1_date,\r\n    approval_date,\r\n    submitted_at,\r\n    approver,\r\n    approver1,\r\n    created_by,\r\n    updated_by,\r\n    submited_by,\r\n    request_branch_status,\r\n    process_status_code,\r\n    process_status_name,\r\n    organization_receive_code,\r\n    organization_receive_name,\r\n    organization_send_code,\r\n    organization_send_name,\r\n    delivery_type,\r\n    currency_type,\r\n    currency,\r\n    request_branch_note,\r\n    request_branch_detail_note,\r\n    process_instance_id,\r\n    box_count,\r\n    hour_from,\r\n    hour_to,\r\n    number_of_min_transfrom,\r\n    num_km_from,\r\n    num_km_to,\r\n    number_of_km,\r\n    pay_in_hour,\r\n    pay_in_minute", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bpm_vhkq\\bpm_vhkq__kq_module_unit.sql", "original_file_path": "models\\int\\bpm_vhkq\\bpm_vhkq__kq_module_unit.sql", "name": "bpm_vhkq__kq_module_unit", "alias": "bpm_vhkq__kq_module_unit", "checksum": {"name": "sha256", "checksum": "9a46286c4595135eb36e71217f764401ba230d5b67685a007e07a5a13b4023d9"}, "tags": ["vhkq_daily"], "refs": [["bpm_vhkq__kq_module"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\bpm_vhkq__kq_module_unit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.6629894, "compiled_code": "\nwith dat as (\n    select distinct\n        request_branch_id,\n        process_type_code,\n        process_type,\n        process_detail,\n        created_at,\n        updated_at,\n        pay_in_date,\n        approval1_date,\n        approval_date,\n        submitted_at,\n        approver,\n        approver1,\n        created_by,\n        updated_by,\n        submited_by,\n        request_branch_status,\n        process_status_code,\n        process_status_name,\n        organization_receive_code,\n        organization_receive_name,\n        organization_send_code,\n        organization_send_name,\n        delivery_type,\n        currency_type,\n        currency,\n        request_branch_note,\n        request_branch_detail_note,\n        process_instance_id,\n        box_count,\n        hour_from,\n        hour_to,\n        number_of_min_transfrom,\n        num_km_from,\n        num_km_to,\n        number_of_km,\n        pay_in_hour,\n        pay_in_minute,\n        qty_actual,\n        value_actual,\n        qty_back_fund,\n        qty_begin_day,\n        qty_system,\n        system_value_actual,\n        qty_system_old,\n        receive_fund_limit\n    FROM\n        \"oracle_dgaworkzone\".int.bpm_vhkq__kq_module\n    where 1=1\n    and ( IS_DELETED is null or IS_DELETED = 0)\n    and IS_DISABLED is null\n    and PROCESS_DETAIL is not null\n)\nSELECT\n    request_branch_id,\n    process_type_code,\n    process_type,\n    process_detail,\n    created_at,\n    updated_at,\n    pay_in_date,\n    approval1_date,\n    approval_date,\n    submitted_at,\n    approver,\n    approver1,\n    created_by,\n    updated_by,\n    submited_by,\n    request_branch_status,\n    process_status_code,\n    process_status_name,\n    organization_receive_code,\n    organization_receive_name,\n    organization_send_code,\n    organization_send_name,\n    delivery_type,\n    currency_type,\n    currency,\n    request_branch_note,\n    request_branch_detail_note,\n    process_instance_id,\n    box_count,\n    hour_from,\n    hour_to,\n    number_of_min_transfrom,\n    num_km_from,\n    num_km_to,\n    number_of_km,\n    pay_in_hour,\n    pay_in_minute,\n    sum(qty_actual) qty_actual,\n    sum(value_actual) value_actual,\n    sum(qty_back_fund) qty_back_fund,\n    sum(qty_begin_day) qty_begin_day,\n    sum(qty_system) qty_system,\n    sum(system_value_actual) system_value_actual,\n    sum(qty_system_old) qty_system_old,\n    sum(receive_fund_limit) receive_fund_limit\nfrom   dat\ngroup by request_branch_id,\n    process_type_code,\n    process_type,\n    process_detail,\n    created_at,\n    updated_at,\n    pay_in_date,\n    approval1_date,\n    approval_date,\n    submitted_at,\n    approver,\n    approver1,\n    created_by,\n    updated_by,\n    submited_by,\n    request_branch_status,\n    process_status_code,\n    process_status_name,\n    organization_receive_code,\n    organization_receive_name,\n    organization_send_code,\n    organization_send_name,\n    delivery_type,\n    currency_type,\n    currency,\n    request_branch_note,\n    request_branch_detail_note,\n    process_instance_id,\n    box_count,\n    hour_from,\n    hour_to,\n    number_of_min_transfrom,\n    num_km_from,\n    num_km_to,\n    number_of_km,\n    pay_in_hour,\n    pay_in_minute", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.bpm_vhkq__kq_module_unit"}, "model.dga_data_model.bpm_vhkq__volume_module": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.bpm_vhkq__volume_detail", "model.dga_data_model.bpm_vhkq__volume", "model.dga_data_model.bpm_vhkq__staff", "model.dga_data_model.bpm_vhkq__warehouse"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "check_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bpm_vhkq", "bpm_vhkq__volume_module"], "unique_id": "model.dga_data_model.bpm_vhkq__volume_module", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat_volume AS (\r\nSELECT\r\n    t2.id,\r\n    t2.volume   volume_id,\r\n    t2.check_date,\r\n    t2.code_staff,\r\n    t3.name     staff_name,\r\n    t3.position staff_position,\r\n    t3.type     staff_type,\r\n    t3.username,\r\n    t3.status   staff_status,\r\n    t4.code     warehouse_code,\r\n    t4.name     warehouse_name,\r\n    t4.city,\r\n    t4.domain,\r\n    t2.is_deleted,\r\n    t2.check_gold,\r\n    t2.expenditure_nb_nt,\r\n    t2.expenditure_nb_vnd,\r\n    t2.revenue_nhnn_vnd,\r\n    t2.revenue_tctd_nt,\r\n    t2.revenue_tctd_vnd,\r\n    t2.support_check,\r\n    t2.total_package\r\nFROM\r\n         {{ ref('bpm_vhkq__volume_detail') }}  t2\r\n    JOIN {{ ref('bpm_vhkq__volume') }}     t4 ON t2.volume = t4.id\r\n                                AND t4.status = 'ACTIVE'\r\n    LEFT JOIN {{ ref('bpm_vhkq__staff') }}      t3 ON t2.staff = t3.id\r\n    LEFT JOIN {{ ref('bpm_vhkq__warehouse') }}  t4 ON t3.warehouse_code = t4.code\r\n)\r\nselect *\r\nfrom dat_volume", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bpm_vhkq\\bpm_vhkq__volume_module.sql", "original_file_path": "models\\int\\bpm_vhkq\\bpm_vhkq__volume_module.sql", "name": "bpm_vhkq__volume_module", "alias": "bpm_vhkq__volume_module", "checksum": {"name": "sha256", "checksum": "9fa7bb071ca263ed612e1e065e0d3ad44b8208388867f74be5267382cccff133"}, "tags": ["vhkq_daily"], "refs": [["bpm_vhkq__volume_detail"], ["bpm_vhkq__volume"], ["bpm_vhkq__staff"], ["bpm_vhkq__warehouse"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "check_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\bpm_vhkq__volume_module.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "check_date"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.6649795, "compiled_code": "\nWITH dat_volume AS (\nSELECT\n    t2.id,\n    t2.volume   volume_id,\n    t2.check_date,\n    t2.code_staff,\n    t3.name     staff_name,\n    t3.position staff_position,\n    t3.type     staff_type,\n    t3.username,\n    t3.status   staff_status,\n    t4.code     warehouse_code,\n    t4.name     warehouse_name,\n    t4.city,\n    t4.domain,\n    t2.is_deleted,\n    t2.check_gold,\n    t2.expenditure_nb_nt,\n    t2.expenditure_nb_vnd,\n    t2.revenue_nhnn_vnd,\n    t2.revenue_tctd_nt,\n    t2.revenue_tctd_vnd,\n    t2.support_check,\n    t2.total_package\nFROM\n         \"oracle_dgaworkzone\".base.bpm_vhkq__volume_detail  t2\n    JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__volume     t4 ON t2.volume = t4.id\n                                AND t4.status = 'ACTIVE'\n    LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__staff      t3 ON t2.staff = t3.id\n    LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__warehouse  t4 ON t3.warehouse_code = t4.code\n)\nselect *\nfrom dat_volume", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.bpm_vhkq__volume_module"}, "model.dga_data_model.int__gl_bal": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.base.imp_bpm_vhkq__gl_khoquy", "model.dga_data_model.stg_landing__gl_account_master"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["gl_txn_daily"], "meta": {"owner": "giangtt11", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bpm_vhkq", "int__gl_bal"], "unique_id": "model.dga_data_model.int__gl_bal", "raw_code": "{{\r\n  config(\r\n    materialized='incremental'\r\n  )\r\n}}\r\nWITH dat1 AS (\r\n    SELECT DISTINCT\r\n        f.account_number                                 AS gl_code,\r\n        f.branch_number                                  AS branch_code,\r\n        concat('AM',\r\n               concat(substr(concat('000', f.branch_number),\r\n                             - 3,\r\n                             3),\r\n                      substr(f.account_number, - 3, 3))) AS atm_id,\r\n        f.currency_type                                  AS currency,\r\n        f.current_balance                                AS acy_dr_bal,\r\n        f.number_cr_tdy                                  AS today_no_cr,\r\n        f.amount_cr_tdy                                  AS acy_today_tover_cr,\r\n        f.number_dr_tdy                                  AS today_no_dr,\r\n        f.amount_dr_tdy                                  AS acy_today_tover_dr,\r\n        f.etl_date\r\n    FROM\r\n        {{ ref ( 'stg_landing__gl_account_master') }}  f\r\n    WHERE\r\n        ( ( f.account_number >= 110104001\r\n            AND f.account_number <= 110104999 )\r\n          OR ( f.account_number >= 110101001\r\n               AND f.account_number <= 110101120 ) )\r\n        AND f.foreign_curr_type IS NULL\r\n)\r\nSELECT\r\n    dat1.gl_code,\r\n    dat1.branch_code,\r\n    dat1.atm_id,\r\n    dat2.kq_id,\r\n    dat1.currency,\r\n    dat1.acy_dr_bal,\r\n    dat1.today_no_cr,\r\n    dat1.acy_today_tover_cr,\r\n    dat1.today_no_dr,\r\n    dat1.acy_today_tover_dr,\r\n    dat1.etl_date\r\nFROM\r\n    dat1\r\n    LEFT JOIN {{source ('base', 'imp_bpm_vhkq__gl_khoquy') }} dat2 ON dat1.gl_code = dat2.gl_code\r\n                                                   AND dat1.branch_code = dat2.branch_code\r\n{% if is_incremental() %}\r\nwhere dat1.etl_date > (select max(etl_date) from {{ this }})\r\n--where dat1.etl_date = 2023111\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bpm_vhkq\\int__gl_bal.sql", "original_file_path": "models\\int\\bpm_vhkq\\int__gl_bal.sql", "name": "int__gl_bal", "alias": "int__gl_bal", "checksum": {"name": "sha256", "checksum": "5e93dd77141c5d3387bfc0e0ad08ae32544997e36b0c8c0a99b573257d53d85b"}, "tags": ["gl_txn_daily"], "refs": [["stg_landing__gl_account_master"]], "sources": [["base", "imp_bpm_vhkq__gl_khoquy"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "giangtt11", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\int__gl_bal.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": ["gl_txn_daily"], "materialized": "incremental"}, "created_at": 1685959752.6699786, "compiled_code": "\nWITH dat1 AS (\n    SELECT DISTINCT\n        f.account_number                                 AS gl_code,\n        f.branch_number                                  AS branch_code,\n        concat('AM',\n               concat(substr(concat('000', f.branch_number),\n                             - 3,\n                             3),\n                      substr(f.account_number, - 3, 3))) AS atm_id,\n        f.currency_type                                  AS currency,\n        f.current_balance                                AS acy_dr_bal,\n        f.number_cr_tdy                                  AS today_no_cr,\n        f.amount_cr_tdy                                  AS acy_today_tover_cr,\n        f.number_dr_tdy                                  AS today_no_dr,\n        f.amount_dr_tdy                                  AS acy_today_tover_dr,\n        f.etl_date\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__gl_account_master  f\n    WHERE\n        ( ( f.account_number >= 110104001\n            AND f.account_number <= 110104999 )\n          OR ( f.account_number >= 110101001\n               AND f.account_number <= 110101120 ) )\n        AND f.foreign_curr_type IS NULL\n)\nSELECT\n    dat1.gl_code,\n    dat1.branch_code,\n    dat1.atm_id,\n    dat2.kq_id,\n    dat1.currency,\n    dat1.acy_dr_bal,\n    dat1.today_no_cr,\n    dat1.acy_today_tover_cr,\n    dat1.today_no_dr,\n    dat1.acy_today_tover_dr,\n    dat1.etl_date\nFROM\n    dat1\n    LEFT JOIN oracle_dgaworkzone.base.imp_bpm_vhkq__gl_khoquy dat2 ON dat1.gl_code = dat2.gl_code\n                                                   AND dat1.branch_code = dat2.branch_code\n\nwhere dat1.etl_date > (select max(etl_date) from \"oracle_dgaworkzone\".int.int__gl_bal)\n--where dat1.etl_date = 2023111\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__gl_bal"}, "model.dga_data_model.int__gl_txn": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.base.imp_vhkq__cust_thu_chi_ho", "model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_int__gl_txn_loan", "model.dga_data_model.stg_int__gl_txn_demanddeposit", "model.dga_data_model.stg_int__gl_txn_fixeddeposit", "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung", "model.dga_data_model.stg_int__gl_txn_nhnn_tctd"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"owner": "giangtt11", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "gl_txn_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "bpm_vhkq", "int__gl_txn"], "unique_id": "model.dga_data_model.int__gl_txn", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key = 'gl_txn_id',\r\n    incremental_strategy = 'merge'\r\n  )\r\n}}\r\nWITH dat1 AS (\r\n    SELECT DISTINCT\r\n        t1.transaction_branch,\r\n        t1.transaction_sequence_no,\r\n        t1.transaction_account,\r\n        t1.transaction_dr_cr_code,\r\n        t1.transaction_amount,\r\n        t1.transaction_julian_date,\r\n        t1.currency_type,\r\n        t1.transaction_description,\r\n        t1.transaction_source,\r\n        t1.source_branch,\r\n        t1.transaction_ticket,\r\n        t1.user_name,\r\n        t1.teller_auxillary_trxn_code,\r\n        t1.additional_infomation,\r\n        t1.transaction_reference_number,\r\n        t1.supervisor_id,\r\n        t1.transaction_code,\r\n        t1.transaction_system_code,\r\n        t1.txn_date,\r\n        CASE\r\n            WHEN t2.gl_txn_id IS NOT NULL THEN\r\n                t2.txn_datetime\r\n            WHEN t3.gl_txn_id IS NOT NULL THEN\r\n                t3.txn_datetime\r\n            WHEN t4.gl_txn_id IS NOT NULL THEN\r\n                t4.txn_datetime\r\n            ELSE\r\n                t1.txn_datetime\r\n        END AS txn_datetime,\r\n        t1.subbranch_id,\r\n        CASE\r\n            WHEN t1.teller_auxillary_trxn_code IN ( '0202', '0201' ) THEN\r\n                'GIAO DICH NOI BO KHAC'\r\n            WHEN t1.teller_auxillary_trxn_code IN ( '0850', '0855' ) THEN\r\n                'LUAN CHUYEN NOI BO'\r\n            ELSE\r\n                t1.txn_type\r\n        END txn_type,\r\n        CASE\r\n            WHEN t2.gl_txn_id IS NOT NULL THEN\r\n                t2.txn_type_sub\r\n            WHEN t3.gl_txn_id IS NOT NULL THEN\r\n                t3.txn_type_sub\r\n            WHEN t4.gl_txn_id IS NOT NULL THEN\r\n                t4.txn_type_sub\r\n            ELSE\r\n                t1.txn_type_sub\r\n        END AS txn_type_sub,\r\n        t1.user_name_gr,\r\n        CASE\r\n            WHEN t2.gl_txn_id IS NOT NULL THEN\r\n                to_char(t2.txn_ref)\r\n            WHEN t3.gl_txn_id IS NOT NULL THEN\r\n                to_char(t3.txn_ref)\r\n            WHEN t4.gl_txn_id IS NOT NULL THEN\r\n                to_char(t4.txn_ref)\r\n            ELSE\r\n                t1.txn_ref\r\n        END AS txn_ref,\r\n        CASE\r\n            WHEN t2.gl_txn_id IS NOT NULL THEN\r\n                to_char(t2.account_ref)\r\n            WHEN t3.gl_txn_id IS NOT NULL THEN\r\n                to_char(t3.account_ref)\r\n            WHEN t4.gl_txn_id IS NOT NULL THEN\r\n                to_char(t4.account_ref)\r\n            ELSE\r\n                t1.account_ref\r\n        END AS account_ref,\r\n        CASE\r\n            WHEN t2.gl_txn_id IS NOT NULL THEN\r\n                t2.cif\r\n            WHEN t3.gl_txn_id IS NOT NULL THEN\r\n                t3.cif\r\n            WHEN t4.gl_txn_id IS NOT NULL THEN\r\n                t4.cif\r\n            ELSE\r\n                t1.cif\r\n        END AS cif,\r\n        t1.transaction_account_against,\r\n        t1.etl_date,\r\n        t1.gl_txn_id\r\n    FROM\r\n        {{ ref('stg_int__gl_txn' ) }}                         t1\r\n        LEFT JOIN {{ ref('stg_int__gl_txn_loan' ) }}          t2 ON t1.gl_txn_id = t2.gl_txn_id\r\n        LEFT JOIN {{ ref('stg_int__gl_txn_demanddeposit' ) }} t3 ON t1.gl_txn_id = t3.gl_txn_id\r\n        LEFT JOIN {{ ref('stg_int__gl_txn_fixeddeposit' ) }}  t4 ON t1.gl_txn_id = t4.gl_txn_id\r\n), dat2 AS (\r\n    SELECT DISTINCT\r\n        t1.transaction_branch,\r\n        t1.transaction_sequence_no,\r\n        t1.transaction_account,\r\n        t1.transaction_dr_cr_code,\r\n        t1.transaction_amount,\r\n        t1.transaction_julian_date,\r\n        t1.currency_type,\r\n        t1.transaction_description,\r\n        t1.transaction_source,\r\n        t1.source_branch,\r\n        t1.transaction_ticket,\r\n        t1.user_name,\r\n        t1.teller_auxillary_trxn_code,\r\n        t1.additional_infomation,\r\n        t1.transaction_reference_number,\r\n        t1.supervisor_id,\r\n        t1.transaction_code,\r\n        t1.transaction_system_code,\r\n        t1.txn_date,\r\n        t1.txn_datetime,\r\n        t1.subbranch_id,\r\n        CASE\r\n            WHEN t5.so_tk IS NOT NULL THEN\r\n                'THU CHI HO'\r\n            WHEN t1.txn_type = 'XNK NGOAI TE' THEN\r\n                'XNK NGOAI TE'\r\n            WHEN t7.transaction_ticket IS NOT NULL THEN\r\n                t7.txn_type\r\n            ELSE\r\n                t1.txn_type\r\n        END txn_type,\r\n        t1.txn_type_sub,\r\n        t1.user_name_gr,\r\n        t1.txn_ref,\r\n        t1.account_ref,\r\n        t1.cif,\r\n        CASE\r\n            WHEN t6.transaction_ticket IS NOT NULL THEN\r\n                t6.transaction_account_against\r\n            WHEN t7.transaction_ticket IS NOT NULL THEN\r\n                t7.transaction_account_against\r\n            ELSE\r\n                t1.transaction_account_against\r\n        END transaction_account_against,\r\n        t1.etl_date,\r\n        t1.gl_txn_id\r\n    FROM\r\n        dat1                                                            t1\r\n        LEFT JOIN {{ source ('base', 'imp_vhkq__cust_thu_chi_ho') }}    t5 ON t1.account_ref = to_char(t5.so_tk)\r\n        LEFT JOIN {{ ref('stg_int__gl_txn_update_gl_doi_ung' ) }}       t6 ON t1.transaction_julian_date = t6.transaction_julian_date\r\n                                                                            AND t1.transaction_ticket = t6.transaction_ticket\r\n        LEFT JOIN {{ ref('stg_int__gl_txn_nhnn_tctd' ) }}               t7 ON t1.transaction_julian_date = t7.transaction_julian_date\r\n                                                                            AND t1.transaction_ticket = t7.transaction_ticket\r\n), dat_update_type AS (\r\n    SELECT\r\n        etl_date,\r\n        gl_txn_id,\r\n        CASE\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'FCC|FC COM|FCOM|FC' ) THEN\r\n                'TIEN MAT TAI QUAY' --'KH - GD FCC'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'HT GTGT|HOAN THUE|THUE TNCN|NT GTGT|THU THUE GTGT|GTGT VA TNCN|TNCN, GTGT|NOP THUE|THU THUE' ) THEN\r\n                'TIEN MAT TAI QUAY' --'KH - HT GTGT'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'ATM|HOAN QUY| AM' ) THEN\r\n                'GIAO DICH NOI BO KHAC' --'NB - GDATM'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'THE TD|TTD|XXX|TT THE|TIN DUNG|THANH TOAN THE|TT TD|THU TD|VISA|TAT TOAN THE' ) THEN\r\n                'TIEN MAT TAI QUAY' --'KH - GD TT TTD'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'TIEN DIEN| PD|NSNN| PC|BILL' ) THEN\r\n                'TIEN MAT TAI QUAY' --'KH - GD TT HOA DON/ DV/ NSNN'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'SLTM|TQBS|DAU NGAY|CUOI NGAY|VE TIEN|GIUA NGAY|TIEP QUY BO SUNG|GDV.*(HOAN UNG|TAM UNG)|.*VHKQ.*$|NHAP.*TU|XUAT.*QUY|XUAT TIEN|NHAN QUY|GEL|QTT|HOAN UNG|TAM UNG|KQ\\.HCM|TIEP QUY BO|TQB S|VE T IEN|THUA QUY|VE QUY|MSB CT VE TM|MSB CT NHAP TM|TIEP QUY|MSB.*BO SUNG'\r\n                               ) THEN\r\n                'GIAO DICH NOI BO KHAC' --'NB - DCV NB MSB'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'REM       DV:|REM       GB -|DOI VON|DOI TIEN|DVQTT|VCB|VC BANK|NGOAI THUONG|NGAI THUONG|FI-DV|DV-FI|DOI NGUON|HDDV|0681000012578'\r\n                               ) THEN\r\n                'GIAO DICH NOI BO KHAC' --'Trao \u0111\u1ed5i v\u1ed1n v\u1edbi TCTD'\r\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\r\n                               'NHNN|NH NN' ) THEN\r\n                'GIAO DICH NOI BO KHAC' --'NHNN'\r\n            ELSE\r\n                'TIEN MAT TAI QUAY' --'KXD'\r\n        END txn_type_update\r\n    FROM\r\n        dat2\r\n    WHERE\r\n        txn_type IS NULL\r\n)\r\nSELECT\r\n    dat2.transaction_branch,\r\n    dat2.transaction_sequence_no,\r\n    dat2.transaction_account,\r\n    dat2.transaction_dr_cr_code,\r\n    dat2.transaction_amount,\r\n    dat2.transaction_julian_date,\r\n    dat2.currency_type,\r\n    dat2.transaction_description,\r\n    dat2.transaction_source,\r\n    dat2.source_branch,\r\n    dat2.transaction_ticket,\r\n    dat2.user_name,\r\n    dat2.teller_auxillary_trxn_code,\r\n    dat2.additional_infomation,\r\n    dat2.transaction_reference_number,\r\n    dat2.supervisor_id,\r\n    dat2.transaction_code,\r\n    dat2.transaction_system_code,\r\n    dat2.txn_date,\r\n    dat2.txn_datetime,\r\n    dat2.subbranch_id,\r\n    dat2.txn_type_sub,\r\n    dat2.user_name_gr,\r\n    dat2.txn_ref,\r\n    dat2.account_ref,\r\n    dat2.cif,\r\n    dat2.transaction_account_against,\r\n    dat2.etl_date,\r\n    dat2.gl_txn_id,\r\n    nvl(dat2.txn_type, dat_update_type.txn_type_update) txn_type\r\nFROM\r\n    dat2\r\n    LEFT JOIN dat_update_type ON dat2.etl_date = dat_update_type.etl_date\r\n                                 AND dat2.gl_txn_id = dat_update_type.gl_txn_id", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\bpm_vhkq\\int__gl_txn.sql", "original_file_path": "models\\int\\bpm_vhkq\\int__gl_txn.sql", "name": "int__gl_txn", "alias": "int__gl_txn", "checksum": {"name": "sha256", "checksum": "215fdcd52d60f51e5f06170e735a70f6b30fdee03a2c907466fe3e9663bf9790"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_int__gl_txn"], ["stg_int__gl_txn_loan"], ["stg_int__gl_txn_demanddeposit"], ["stg_int__gl_txn_fixeddeposit"], ["stg_int__gl_txn_update_gl_doi_ung"], ["stg_int__gl_txn_nhnn_tctd"]], "sources": [["base", "imp_vhkq__cust_thu_chi_ho"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\int__gl_txn.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "materialized": "incremental", "unique_key": "gl_txn_id", "incremental_strategy": "merge"}, "created_at": 1685959752.6669817, "compiled_code": "\nWITH dat1 AS (\n    SELECT DISTINCT\n        t1.transaction_branch,\n        t1.transaction_sequence_no,\n        t1.transaction_account,\n        t1.transaction_dr_cr_code,\n        t1.transaction_amount,\n        t1.transaction_julian_date,\n        t1.currency_type,\n        t1.transaction_description,\n        t1.transaction_source,\n        t1.source_branch,\n        t1.transaction_ticket,\n        t1.user_name,\n        t1.teller_auxillary_trxn_code,\n        t1.additional_infomation,\n        t1.transaction_reference_number,\n        t1.supervisor_id,\n        t1.transaction_code,\n        t1.transaction_system_code,\n        t1.txn_date,\n        CASE\n            WHEN t2.gl_txn_id IS NOT NULL THEN\n                t2.txn_datetime\n            WHEN t3.gl_txn_id IS NOT NULL THEN\n                t3.txn_datetime\n            WHEN t4.gl_txn_id IS NOT NULL THEN\n                t4.txn_datetime\n            ELSE\n                t1.txn_datetime\n        END AS txn_datetime,\n        t1.subbranch_id,\n        CASE\n            WHEN t1.teller_auxillary_trxn_code IN ( '0202', '0201' ) THEN\n                'GIAO DICH NOI BO KHAC'\n            WHEN t1.teller_auxillary_trxn_code IN ( '0850', '0855' ) THEN\n                'LUAN CHUYEN NOI BO'\n            ELSE\n                t1.txn_type\n        END txn_type,\n        CASE\n            WHEN t2.gl_txn_id IS NOT NULL THEN\n                t2.txn_type_sub\n            WHEN t3.gl_txn_id IS NOT NULL THEN\n                t3.txn_type_sub\n            WHEN t4.gl_txn_id IS NOT NULL THEN\n                t4.txn_type_sub\n            ELSE\n                t1.txn_type_sub\n        END AS txn_type_sub,\n        t1.user_name_gr,\n        CASE\n            WHEN t2.gl_txn_id IS NOT NULL THEN\n                to_char(t2.txn_ref)\n            WHEN t3.gl_txn_id IS NOT NULL THEN\n                to_char(t3.txn_ref)\n            WHEN t4.gl_txn_id IS NOT NULL THEN\n                to_char(t4.txn_ref)\n            ELSE\n                t1.txn_ref\n        END AS txn_ref,\n        CASE\n            WHEN t2.gl_txn_id IS NOT NULL THEN\n                to_char(t2.account_ref)\n            WHEN t3.gl_txn_id IS NOT NULL THEN\n                to_char(t3.account_ref)\n            WHEN t4.gl_txn_id IS NOT NULL THEN\n                to_char(t4.account_ref)\n            ELSE\n                t1.account_ref\n        END AS account_ref,\n        CASE\n            WHEN t2.gl_txn_id IS NOT NULL THEN\n                t2.cif\n            WHEN t3.gl_txn_id IS NOT NULL THEN\n                t3.cif\n            WHEN t4.gl_txn_id IS NOT NULL THEN\n                t4.cif\n            ELSE\n                t1.cif\n        END AS cif,\n        t1.transaction_account_against,\n        t1.etl_date,\n        t1.gl_txn_id\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_int__gl_txn                         t1\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_int__gl_txn_loan          t2 ON t1.gl_txn_id = t2.gl_txn_id\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_int__gl_txn_demanddeposit t3 ON t1.gl_txn_id = t3.gl_txn_id\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_int__gl_txn_fixeddeposit  t4 ON t1.gl_txn_id = t4.gl_txn_id\n), dat2 AS (\n    SELECT DISTINCT\n        t1.transaction_branch,\n        t1.transaction_sequence_no,\n        t1.transaction_account,\n        t1.transaction_dr_cr_code,\n        t1.transaction_amount,\n        t1.transaction_julian_date,\n        t1.currency_type,\n        t1.transaction_description,\n        t1.transaction_source,\n        t1.source_branch,\n        t1.transaction_ticket,\n        t1.user_name,\n        t1.teller_auxillary_trxn_code,\n        t1.additional_infomation,\n        t1.transaction_reference_number,\n        t1.supervisor_id,\n        t1.transaction_code,\n        t1.transaction_system_code,\n        t1.txn_date,\n        t1.txn_datetime,\n        t1.subbranch_id,\n        CASE\n            WHEN t5.so_tk IS NOT NULL THEN\n                'THU CHI HO'\n            WHEN t1.txn_type = 'XNK NGOAI TE' THEN\n                'XNK NGOAI TE'\n            WHEN t7.transaction_ticket IS NOT NULL THEN\n                t7.txn_type\n            ELSE\n                t1.txn_type\n        END txn_type,\n        t1.txn_type_sub,\n        t1.user_name_gr,\n        t1.txn_ref,\n        t1.account_ref,\n        t1.cif,\n        CASE\n            WHEN t6.transaction_ticket IS NOT NULL THEN\n                t6.transaction_account_against\n            WHEN t7.transaction_ticket IS NOT NULL THEN\n                t7.transaction_account_against\n            ELSE\n                t1.transaction_account_against\n        END transaction_account_against,\n        t1.etl_date,\n        t1.gl_txn_id\n    FROM\n        dat1                                                            t1\n        LEFT JOIN oracle_dgaworkzone.base.imp_vhkq__cust_thu_chi_ho    t5 ON t1.account_ref = to_char(t5.so_tk)\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_int__gl_txn_update_gl_doi_ung       t6 ON t1.transaction_julian_date = t6.transaction_julian_date\n                                                                            AND t1.transaction_ticket = t6.transaction_ticket\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_int__gl_txn_nhnn_tctd               t7 ON t1.transaction_julian_date = t7.transaction_julian_date\n                                                                            AND t1.transaction_ticket = t7.transaction_ticket\n), dat_update_type AS (\n    SELECT\n        etl_date,\n        gl_txn_id,\n        CASE\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'FCC|FC COM|FCOM|FC' ) THEN\n                'TIEN MAT TAI QUAY' --'KH - GD FCC'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'HT GTGT|HOAN THUE|THUE TNCN|NT GTGT|THU THUE GTGT|GTGT VA TNCN|TNCN, GTGT|NOP THUE|THU THUE' ) THEN\n                'TIEN MAT TAI QUAY' --'KH - HT GTGT'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'ATM|HOAN QUY| AM' ) THEN\n                'GIAO DICH NOI BO KHAC' --'NB - GDATM'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'THE TD|TTD|XXX|TT THE|TIN DUNG|THANH TOAN THE|TT TD|THU TD|VISA|TAT TOAN THE' ) THEN\n                'TIEN MAT TAI QUAY' --'KH - GD TT TTD'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'TIEN DIEN| PD|NSNN| PC|BILL' ) THEN\n                'TIEN MAT TAI QUAY' --'KH - GD TT HOA DON/ DV/ NSNN'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'SLTM|TQBS|DAU NGAY|CUOI NGAY|VE TIEN|GIUA NGAY|TIEP QUY BO SUNG|GDV.*(HOAN UNG|TAM UNG)|.*VHKQ.*$|NHAP.*TU|XUAT.*QUY|XUAT TIEN|NHAN QUY|GEL|QTT|HOAN UNG|TAM UNG|KQ\\.HCM|TIEP QUY BO|TQB S|VE T IEN|THUA QUY|VE QUY|MSB CT VE TM|MSB CT NHAP TM|TIEP QUY|MSB.*BO SUNG'\n                               ) THEN\n                'GIAO DICH NOI BO KHAC' --'NB - DCV NB MSB'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'REM       DV:|REM       GB -|DOI VON|DOI TIEN|DVQTT|VCB|VC BANK|NGOAI THUONG|NGAI THUONG|FI-DV|DV-FI|DOI NGUON|HDDV|0681000012578'\n                               ) THEN\n                'GIAO DICH NOI BO KHAC' --'Trao \u0111\u1ed5i v\u1ed1n v\u1edbi TCTD'\n            WHEN REGEXP_LIKE ( upper(additional_infomation),\n                               'NHNN|NH NN' ) THEN\n                'GIAO DICH NOI BO KHAC' --'NHNN'\n            ELSE\n                'TIEN MAT TAI QUAY' --'KXD'\n        END txn_type_update\n    FROM\n        dat2\n    WHERE\n        txn_type IS NULL\n)\nSELECT\n    dat2.transaction_branch,\n    dat2.transaction_sequence_no,\n    dat2.transaction_account,\n    dat2.transaction_dr_cr_code,\n    dat2.transaction_amount,\n    dat2.transaction_julian_date,\n    dat2.currency_type,\n    dat2.transaction_description,\n    dat2.transaction_source,\n    dat2.source_branch,\n    dat2.transaction_ticket,\n    dat2.user_name,\n    dat2.teller_auxillary_trxn_code,\n    dat2.additional_infomation,\n    dat2.transaction_reference_number,\n    dat2.supervisor_id,\n    dat2.transaction_code,\n    dat2.transaction_system_code,\n    dat2.txn_date,\n    dat2.txn_datetime,\n    dat2.subbranch_id,\n    dat2.txn_type_sub,\n    dat2.user_name_gr,\n    dat2.txn_ref,\n    dat2.account_ref,\n    dat2.cif,\n    dat2.transaction_account_against,\n    dat2.etl_date,\n    dat2.gl_txn_id,\n    nvl(dat2.txn_type, dat_update_type.txn_type_update) txn_type\nFROM\n    dat2\n    LEFT JOIN dat_update_type ON dat2.etl_date = dat_update_type.etl_date\n                                 AND dat2.gl_txn_id = dat_update_type.gl_txn_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__gl_txn"}, "model.dga_data_model.int_cic__bond_outstanding": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__daututraiphieu", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_dwh__cydm_rate_history"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__bond_outstanding"], "unique_id": "model.dga_data_model.int_cic__bond_outstanding", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        t1.*\r\n        , t2.macic\r\n        , t2.respond_date AS report_date\r\n        , t2.respond_month AS report_month\r\n        , t2.cic_id\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\r\n            ELSE UPPER(TRIM(t1.ten_tctd))\r\n            END bank_name\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\r\n            ELSE NULL\r\n            END branch_name\r\n        , CASE\r\n            WHEN t1.nhom_no = 0 THEN '1'\r\n            ELSE nvl(to_char(t1.nhom_no),'1')\r\n          END bucket_code\r\n        , CAST(NULL AS varchar2(10)) AS loan_type\r\n    FROM {{ ref('stg_cic__daututraiphieu')}}  t1\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} t2 ON\r\n        t1.client_question_id = t2.client_question_id\r\n        AND t1.respond_date = t2.respond_date\r\n    WHERE t1.client_question_id IS NOT NULL\r\n), bond AS (\r\n    SELECT\r\n        cic.report_date\r\n        , cic.report_month\r\n        , cic.macic\r\n        , cic.client_question_id\r\n        , cic.cic_id\r\n        , cic.product_group\r\n        , cic.product_detail\r\n        , cic.loan_type\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\r\n           AS bank_name\r\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , cic.bucket_code\r\n        , cic.currency_type\r\n        , cic.org_os_amount\r\n        , CASE\r\n            WHEN cic.currency_type = 'VND' THEN 1\r\n            ELSE ccy.mid_rate\r\n          END exchange_rate\r\n        , CASE\r\n            WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\r\n            ELSE ccy.mid_rate * cic.org_os_amount\r\n          END local_os_amount\r\n    FROM\r\n        source cic\r\n    LEFT JOIN {{ ref('stg_dwh__cydm_rate_history') }} ccy ON\r\n        cic.respond_date_j = ccy.datekey\r\n        AND cic.currency_type = ccy.ccy1\r\n)\r\nSELECT * FROM bond", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__bond_outstanding.sql", "original_file_path": "models\\int\\cic\\int_cic__bond_outstanding.sql", "name": "int_cic__bond_outstanding", "alias": "int_cic__bond_outstanding", "checksum": {"name": "sha256", "checksum": "e859925934f36ded9cba9c75bda655343185a9e5922335a0aad6bc86a378b97b"}, "tags": ["cic_daily"], "refs": [["stg_cic__daututraiphieu"], ["int_cic__question_info"], ["stg_dwh__cydm_rate_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__bond_outstanding.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.6769793, "compiled_code": "\nWITH source AS (\n    SELECT\n        t1.*\n        , t2.macic\n        , t2.respond_date AS report_date\n        , t2.respond_month AS report_month\n        , t2.cic_id\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\n            ELSE UPPER(TRIM(t1.ten_tctd))\n            END bank_name\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\n            ELSE NULL\n            END branch_name\n        , CASE\n            WHEN t1.nhom_no = 0 THEN '1'\n            ELSE nvl(to_char(t1.nhom_no),'1')\n          END bucket_code\n        , CAST(NULL AS varchar2(10)) AS loan_type\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__daututraiphieu  t1\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info t2 ON\n        t1.client_question_id = t2.client_question_id\n        AND t1.respond_date = t2.respond_date\n    WHERE t1.client_question_id IS NOT NULL\n), bond AS (\n    SELECT\n        cic.report_date\n        , cic.report_month\n        , cic.macic\n        , cic.client_question_id\n        , cic.cic_id\n        , cic.product_group\n        , cic.product_detail\n        , cic.loan_type\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\n           AS bank_name\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\n        , cic.bucket_code\n        , cic.currency_type\n        , cic.org_os_amount\n        , CASE\n            WHEN cic.currency_type = 'VND' THEN 1\n            ELSE ccy.mid_rate\n          END exchange_rate\n        , CASE\n            WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\n            ELSE ccy.mid_rate * cic.org_os_amount\n          END local_os_amount\n    FROM\n        source cic\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history ccy ON\n        cic.respond_date_j = ccy.datekey\n        AND cic.currency_type = ccy.ccy1\n)\nSELECT * FROM bond", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__bond_outstanding"}, "model.dga_data_model.int_cic__cc_lag_12m": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__dunothetd12thang", "model.dga_data_model.int_cic__question_info"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__cc_lag_12m"], "unique_id": "model.dga_data_model.int_cic__cc_lag_12m", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH unpivot AS (\r\n    SELECT *\r\n    FROM {{ ref('stg_cic__dunothetd12thang')}} a\r\n    UNPIVOT INCLUDE NULLS (\r\n        local_os_amount\r\n        FOR num_month_lag\r\n        IN (\r\n            t12vnd AS to_number('1'),\r\n            t11vnd AS to_number('2'),\r\n            t10vnd AS to_number('3'),\r\n            t9vnd AS to_number('4'),\r\n            t8vnd AS to_number('5'),\r\n            t7vnd AS to_number('6'),\r\n            t6vnd AS to_number('7'),\r\n            t5vnd AS to_number('8'),\r\n            t4vnd AS to_number('9'),\r\n            t3vnd AS to_number('10'),\r\n            t2vnd AS to_number('11'),\r\n            t1vnd AS to_number('12')\r\n        )\r\n    )\r\n), source AS (\r\n    SELECT\r\n          b.macic\r\n        , b.client_question_id AS client_request_id\r\n        , b.respond_date AS report_date\r\n        , b.respond_month AS report_month\r\n        , 'CC' AS product_group\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(a.bank,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\r\n           AS bank\r\n        , regexp_replace(a.branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , a.num_month_lag\r\n        , to_char(add_months(TO_DATE(b.respond_date, 'yyyymmdd'),-1*num_month_lag),'yyyymm') AS month_id\r\n        , nvl(a.local_os_amount,0)*1E6 AS local_os_amount\r\n    FROM unpivot a\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} b ON\r\n        a.client_question_id = b.client_question_id\r\n        AND a.request_date = b.request_date\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__cc_lag_12m.sql", "original_file_path": "models\\int\\cic\\int_cic__cc_lag_12m.sql", "name": "int_cic__cc_lag_12m", "alias": "int_cic__cc_lag_12m", "checksum": {"name": "sha256", "checksum": "ce55a965c95644fa9f298ba46fa51044fc41fbdd0cf62ce8642abaccfd4a20fc"}, "tags": ["cic_daily"], "refs": [["stg_cic__dunothetd12thang"], ["int_cic__question_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__cc_lag_12m.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.67898, "compiled_code": "\nWITH unpivot AS (\n    SELECT *\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__dunothetd12thang a\n    UNPIVOT INCLUDE NULLS (\n        local_os_amount\n        FOR num_month_lag\n        IN (\n            t12vnd AS to_number('1'),\n            t11vnd AS to_number('2'),\n            t10vnd AS to_number('3'),\n            t9vnd AS to_number('4'),\n            t8vnd AS to_number('5'),\n            t7vnd AS to_number('6'),\n            t6vnd AS to_number('7'),\n            t5vnd AS to_number('8'),\n            t4vnd AS to_number('9'),\n            t3vnd AS to_number('10'),\n            t2vnd AS to_number('11'),\n            t1vnd AS to_number('12')\n        )\n    )\n), source AS (\n    SELECT\n          b.macic\n        , b.client_question_id AS client_request_id\n        , b.respond_date AS report_date\n        , b.respond_month AS report_month\n        , 'CC' AS product_group\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(a.bank,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\n           AS bank\n        , regexp_replace(a.branch_name,'\\([^()]*\\)', '') AS branch_name\n        , a.num_month_lag\n        , to_char(add_months(TO_DATE(b.respond_date, 'yyyymmdd'),-1*num_month_lag),'yyyymm') AS month_id\n        , nvl(a.local_os_amount,0)*1E6 AS local_os_amount\n    FROM unpivot a\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info b ON\n        a.client_question_id = b.client_question_id\n        AND a.request_date = b.request_date\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__cc_lag_12m"}, "model.dga_data_model.int_cic__cc_outstanding": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__dunothetd", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_dwh__cydm_rate_history"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__cc_outstanding"], "unique_id": "model.dga_data_model.int_cic__cc_outstanding", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        t1.*\r\n        , t2.macic\r\n        , t2.respond_date AS report_date\r\n        , t2.respond_month AS report_month\r\n        , t2.cic_id\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\r\n            ELSE UPPER(TRIM(t1.ten_tctd))\r\n            END bank_name\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\r\n            ELSE NULL\r\n            END branch_name\r\n        , CAST(NULL AS varchar2(10)) AS loan_type\r\n        , CASE\r\n            WHEN nvl(so_ngay_ctt, 0) < 10 THEN '1'\r\n            WHEN so_ngay_ctt >= 10 AND so_ngay_ctt <= 90 THEN '2'\r\n            WHEN so_ngay_ctt >= 91 AND so_ngay_ctt <= 180 THEN '3'\r\n            WHEN so_ngay_ctt >= 181 AND so_ngay_ctt <= 360 THEN '4'\r\n            WHEN so_ngay_ctt >= 365 THEN '5'\r\n          END bucket_code\r\n    FROM {{ ref('stg_cic__dunothetd')}} t1\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} t2 ON\r\n        t1.client_question_id = t2.client_question_id\r\n        AND t1.respond_date = t2.respond_date\r\n    WHERE t1.client_question_id IS NOT NULL\r\n), tf AS (\r\n    SELECT\r\n        respond_date_j\r\n        , report_date\r\n        , report_month\r\n        , macic\r\n        , client_question_id\r\n        , cic_id\r\n        , product_group\r\n        , product_detail\r\n        , loan_type\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(bank_name,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u00d4\u0323T THA\u0300NH VI\u00caN', 'MTV')\r\n           AS bank_name\r\n        , regexp_replace(branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , bucket_code\r\n        , currency_type\r\n        , CASE\r\n            WHEN bucket_code = 1 THEN SUM(so_tien_ptt) + SUM(ABS(so_tien_ptt - so_tien_ctt))\r\n            ELSE SUM(so_tien_ptt)\r\n          END org_os_amount\r\n    FROM\r\n        source\r\n    GROUP BY\r\n        respond_date_j\r\n        , report_date\r\n        , report_month\r\n        , macic\r\n        , client_question_id\r\n        , cic_id\r\n        , product_group\r\n        , product_detail\r\n        , loan_type\r\n        , bank_name\r\n        , branch_name\r\n        , bucket_code\r\n        , currency_type\r\n), cc AS (\r\n    SELECT\r\n        tf.report_date,\r\n        tf.report_month,\r\n        tf.macic,\r\n        tf.client_question_id,\r\n        tf.cic_id,\r\n        tf.product_group,\r\n        tf.product_detail,\r\n        tf.loan_type,\r\n        tf.bank_name,\r\n        tf.branch_name,\r\n        tf.bucket_code,\r\n        tf.currency_type,\r\n        tf.org_os_amount,\r\n        CASE\r\n            WHEN tf.currency_type = 'VND' THEN 1\r\n            ELSE ccy.mid_rate\r\n        END exchange_rate,\r\n        CASE\r\n            WHEN tf.currency_type = 'VND' THEN tf.org_os_amount*1e6\r\n            ELSE ccy.mid_rate * tf.org_os_amount\r\n        END local_os_amount\r\n    FROM tf\r\n    LEFT JOIN {{ ref('stg_dwh__cydm_rate_history') }} ccy ON\r\n        tf.respond_date_j = ccy.datekey\r\n        AND tf.currency_type = ccy.ccy1\r\n)\r\nSELECT * FROM cc", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__cc_outstanding.sql", "original_file_path": "models\\int\\cic\\int_cic__cc_outstanding.sql", "name": "int_cic__cc_outstanding", "alias": "int_cic__cc_outstanding", "checksum": {"name": "sha256", "checksum": "2af2b6f55c7efdc57a56f90678cedf8f0012f15a8e538057a28ea05a169f023b"}, "tags": ["cic_daily"], "refs": [["stg_cic__dunothetd"], ["int_cic__question_info"], ["stg_dwh__cydm_rate_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__cc_outstanding.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.6769793, "compiled_code": "\nWITH source AS (\n    SELECT\n        t1.*\n        , t2.macic\n        , t2.respond_date AS report_date\n        , t2.respond_month AS report_month\n        , t2.cic_id\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\n            ELSE UPPER(TRIM(t1.ten_tctd))\n            END bank_name\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\n            ELSE NULL\n            END branch_name\n        , CAST(NULL AS varchar2(10)) AS loan_type\n        , CASE\n            WHEN nvl(so_ngay_ctt, 0) < 10 THEN '1'\n            WHEN so_ngay_ctt >= 10 AND so_ngay_ctt <= 90 THEN '2'\n            WHEN so_ngay_ctt >= 91 AND so_ngay_ctt <= 180 THEN '3'\n            WHEN so_ngay_ctt >= 181 AND so_ngay_ctt <= 360 THEN '4'\n            WHEN so_ngay_ctt >= 365 THEN '5'\n          END bucket_code\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__dunothetd t1\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info t2 ON\n        t1.client_question_id = t2.client_question_id\n        AND t1.respond_date = t2.respond_date\n    WHERE t1.client_question_id IS NOT NULL\n), tf AS (\n    SELECT\n        respond_date_j\n        , report_date\n        , report_month\n        , macic\n        , client_question_id\n        , cic_id\n        , product_group\n        , product_detail\n        , loan_type\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(bank_name,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u00d4\u0323T THA\u0300NH VI\u00caN', 'MTV')\n           AS bank_name\n        , regexp_replace(branch_name,'\\([^()]*\\)', '') AS branch_name\n        , bucket_code\n        , currency_type\n        , CASE\n            WHEN bucket_code = 1 THEN SUM(so_tien_ptt) + SUM(ABS(so_tien_ptt - so_tien_ctt))\n            ELSE SUM(so_tien_ptt)\n          END org_os_amount\n    FROM\n        source\n    GROUP BY\n        respond_date_j\n        , report_date\n        , report_month\n        , macic\n        , client_question_id\n        , cic_id\n        , product_group\n        , product_detail\n        , loan_type\n        , bank_name\n        , branch_name\n        , bucket_code\n        , currency_type\n), cc AS (\n    SELECT\n        tf.report_date,\n        tf.report_month,\n        tf.macic,\n        tf.client_question_id,\n        tf.cic_id,\n        tf.product_group,\n        tf.product_detail,\n        tf.loan_type,\n        tf.bank_name,\n        tf.branch_name,\n        tf.bucket_code,\n        tf.currency_type,\n        tf.org_os_amount,\n        CASE\n            WHEN tf.currency_type = 'VND' THEN 1\n            ELSE ccy.mid_rate\n        END exchange_rate,\n        CASE\n            WHEN tf.currency_type = 'VND' THEN tf.org_os_amount*1e6\n            ELSE ccy.mid_rate * tf.org_os_amount\n        END local_os_amount\n    FROM tf\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history ccy ON\n        tf.respond_date_j = ccy.datekey\n        AND tf.currency_type = ccy.ccy1\n)\nSELECT * FROM cc", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__cc_outstanding"}, "model.dga_data_model.int_cic__customer_info": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.generate_surrogate_key"], "nodes": ["model.dga_data_model.stg_cic__customer_info"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__customer_info"], "unique_id": "model.dga_data_model.int_cic__customer_info", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n      macic\r\n    , cif\r\n    , customer_name\r\n    , COALESCE(personal_register_number, corporate_register_number) AS register_number\r\n    , regexp_replace(\r\n        regexp_substr(\r\n            regexp_substr(other_register_number, '[^:]+',1,2,'i')\r\n                    , '[^,]+', 1, 1, 'i')\r\n        , '\\W','') AS other_register_number\r\n    , decode(is_valid_tax_code(TRIM(tax_code))\r\n        , 1, TRIM(tax_code)\r\n        , 0, regexp_replace(tax_code,'[^0-9]+')) AS tax_code\r\n    , CASE\r\n        WHEN TRIM(TRANSLATE(tax_code, CHR(10) || CHR(13) || CHR(09), ' '))  = '9999999999'\r\n            THEN NULL\r\n        WHEN is_valid_tax_code(TRIM(tax_code)) = 1\r\n            THEN TRIM(tax_code)\r\n        WHEN is_valid_tax_code(TRIM(tax_code)) = 0\r\n            AND is_valid_tax_code(TRIM(corporate_register_number)) = 1\r\n            THEN corporate_register_number\r\n        WHEN is_valid_tax_code(TRIM(tax_code)) = 0\r\n            AND regexp_like(tax_code, '^[0-9]{10}-[0-9]$')\r\n            THEN regexp_replace(tax_code,'[^0-9]+')\r\n        ELSE regexp_replace(tax_code,'[^0-9]+')\r\n       END tax_code_final\r\n    , branch_code\r\n    , tong_giam_doc\r\n    , address\r\n    , note\r\n    , etl_date\r\n  FROM {{ ref('stg_cic__customer_info')}}\r\n), hash AS (\r\n  SELECT\r\n      macic\r\n    , cif\r\n    , customer_name\r\n    , register_number\r\n    , other_register_number\r\n    , tax_code\r\n    , CASE\r\n        WHEN LENGTH(tax_code_final) = 13\r\n        THEN substr(tax_code_final,1,10)||'-'||substr(tax_code_final,11,3)\r\n        ELSE tax_code_final\r\n      END tax_code_final\r\n    , branch_code\r\n    , tong_giam_doc\r\n    , address\r\n    , note\r\n    , etl_date\r\n    , {{ dbt_utils.generate_surrogate_key([\r\n                'macic',\r\n                'cif',\r\n                'register_number',\r\n                'tax_code_final',\r\n                'other_register_number'\r\n            ])\r\n        }} AS hash_key\r\n    FROM source\r\n)\r\nSELECT * FROM hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__customer_info.sql", "original_file_path": "models\\int\\cic\\int_cic__customer_info.sql", "name": "int_cic__customer_info", "alias": "int_cic__customer_info", "checksum": {"name": "sha256", "checksum": "075b5feabd2a89bd22f6d4d474ad10411cbc4ee2d65a547e766ddcacef010651"}, "tags": ["cic_daily"], "refs": [["stg_cic__customer_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__customer_info.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.6759784, "compiled_code": "\nWITH source AS (\n  SELECT\n      macic\n    , cif\n    , customer_name\n    , COALESCE(personal_register_number, corporate_register_number) AS register_number\n    , regexp_replace(\n        regexp_substr(\n            regexp_substr(other_register_number, '[^:]+',1,2,'i')\n                    , '[^,]+', 1, 1, 'i')\n        , '\\W','') AS other_register_number\n    , decode(is_valid_tax_code(TRIM(tax_code))\n        , 1, TRIM(tax_code)\n        , 0, regexp_replace(tax_code,'[^0-9]+')) AS tax_code\n    , CASE\n        WHEN TRIM(TRANSLATE(tax_code, CHR(10) || CHR(13) || CHR(09), ' '))  = '9999999999'\n            THEN NULL\n        WHEN is_valid_tax_code(TRIM(tax_code)) = 1\n            THEN TRIM(tax_code)\n        WHEN is_valid_tax_code(TRIM(tax_code)) = 0\n            AND is_valid_tax_code(TRIM(corporate_register_number)) = 1\n            THEN corporate_register_number\n        WHEN is_valid_tax_code(TRIM(tax_code)) = 0\n            AND regexp_like(tax_code, '^[0-9]{10}-[0-9]$')\n            THEN regexp_replace(tax_code,'[^0-9]+')\n        ELSE regexp_replace(tax_code,'[^0-9]+')\n       END tax_code_final\n    , branch_code\n    , tong_giam_doc\n    , address\n    , note\n    , etl_date\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__customer_info\n), hash AS (\n  SELECT\n      macic\n    , cif\n    , customer_name\n    , register_number\n    , other_register_number\n    , tax_code\n    , CASE\n        WHEN LENGTH(tax_code_final) = 13\n        THEN substr(tax_code_final,1,10)||'-'||substr(tax_code_final,11,3)\n        ELSE tax_code_final\n      END tax_code_final\n    , branch_code\n    , tong_giam_doc\n    , address\n    , note\n    , etl_date\n    , \n    \nlower(to_hex(md5(to_utf8(cast(coalesce(cast(macic as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(cif as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(register_number as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tax_code_final as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(other_register_number as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) AS hash_key\n    FROM source\n)\nSELECT * FROM hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__customer_info"}, "model.dga_data_model.int_cic__loan_lag_12m": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__duno12thang", "model.dga_data_model.int_cic__question_info"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__loan_lag_12m"], "unique_id": "model.dga_data_model.int_cic__loan_lag_12m", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH unpivot AS (\r\n    SELECT *\r\n    FROM {{ ref('stg_cic__duno12thang')}} a\r\n    UNPIVOT INCLUDE NULLS (\r\n        local_os_amount\r\n        FOR num_month_lag\r\n        IN (\r\n            t12vnd AS to_number('1'),\r\n            t11vnd AS to_number('2'),\r\n            t10vnd AS to_number('3'),\r\n            t9vnd AS to_number('4'),\r\n            t8vnd AS to_number('5'),\r\n            t7vnd AS to_number('6'),\r\n            t6vnd AS to_number('7'),\r\n            t5vnd AS to_number('8'),\r\n            t4vnd AS to_number('9'),\r\n            t3vnd AS to_number('10'),\r\n            t2vnd AS to_number('11'),\r\n            t1vnd AS to_number('12')\r\n        )\r\n    )\r\n), source AS (\r\n    SELECT\r\n          b.macic\r\n        , b.client_question_id AS client_request_id\r\n        , b.respond_date AS report_date\r\n        , b.respond_month AS report_month\r\n        , 'LN' AS product_group\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(a.bank,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\r\n           AS bank\r\n        , regexp_replace(a.branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , a.num_month_lag\r\n        , to_char(add_months(TO_DATE(b.respond_date, 'yyyymmdd'),-1*num_month_lag),'yyyymm') AS month_id\r\n        , nvl(a.local_os_amount,0)*1E6 AS local_os_amount\r\n    FROM unpivot a\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} b ON\r\n        a.client_question_id = b.client_question_id\r\n        AND a.request_date = b.request_date\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__loan_lag_12m.sql", "original_file_path": "models\\int\\cic\\int_cic__loan_lag_12m.sql", "name": "int_cic__loan_lag_12m", "alias": "int_cic__loan_lag_12m", "checksum": {"name": "sha256", "checksum": "398f6b8881661f3db21264a659cf89d3a87ce813d9e9d128c3d36d233c53cd07"}, "tags": ["cic_daily"], "refs": [["stg_cic__duno12thang"], ["int_cic__question_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__loan_lag_12m.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.67898, "compiled_code": "\nWITH unpivot AS (\n    SELECT *\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__duno12thang a\n    UNPIVOT INCLUDE NULLS (\n        local_os_amount\n        FOR num_month_lag\n        IN (\n            t12vnd AS to_number('1'),\n            t11vnd AS to_number('2'),\n            t10vnd AS to_number('3'),\n            t9vnd AS to_number('4'),\n            t8vnd AS to_number('5'),\n            t7vnd AS to_number('6'),\n            t6vnd AS to_number('7'),\n            t5vnd AS to_number('8'),\n            t4vnd AS to_number('9'),\n            t3vnd AS to_number('10'),\n            t2vnd AS to_number('11'),\n            t1vnd AS to_number('12')\n        )\n    )\n), source AS (\n    SELECT\n          b.macic\n        , b.client_question_id AS client_request_id\n        , b.respond_date AS report_date\n        , b.respond_month AS report_month\n        , 'LN' AS product_group\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(a.bank,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\n           AS bank\n        , regexp_replace(a.branch_name,'\\([^()]*\\)', '') AS branch_name\n        , a.num_month_lag\n        , to_char(add_months(TO_DATE(b.respond_date, 'yyyymmdd'),-1*num_month_lag),'yyyymm') AS month_id\n        , nvl(a.local_os_amount,0)*1E6 AS local_os_amount\n    FROM unpivot a\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info b ON\n        a.client_question_id = b.client_question_id\n        AND a.request_date = b.request_date\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__loan_lag_12m"}, "model.dga_data_model.int_cic__loan_outstanding": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__ttduno", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_dwh__cydm_rate_history"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__loan_outstanding"], "unique_id": "model.dga_data_model.int_cic__loan_outstanding", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        ttduno.*\r\n        , t2.macic\r\n        , t2.respond_date AS report_date\r\n        , t2.respond_month AS report_month\r\n        , t2.cic_id\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^\u2013]+',1,1,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^-]+',1,1,'i')))\r\n            ELSE UPPER(TRIM(ttduno.ten_tctd))\r\n            END bank_name\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^\u2013]+',1,2,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^-]+',1,2,'i')))\r\n            ELSE NULL\r\n            END branch_name\r\n        , CASE\r\n            WHEN ttduno.source_column LIKE 'DNBS%' THEN 'D\u01b0 n\u1ee3 b\u1ed5 sung'\r\n            WHEN ttduno.source_column LIKE 'DNDH%' THEN 'D\u01b0 n\u1ee3 d\u00e0i h\u1ea1n'\r\n            WHEN  ttduno.source_column LIKE 'DNNH%' THEN 'D\u01b0 n\u1ee3 ng\u1eafn h\u1ea1n'\r\n            WHEN ttduno.source_column LIKE 'DNTH%' THEN 'D\u01b0 n\u1ee3 trung h\u1ea1n'\r\n            WHEN ttduno.source_column LIKE 'DNK%' THEN 'D\u01b0 n\u1ee3 kh\u00e1c'\r\n          END product_detail\r\n        , CASE\r\n            WHEN ttduno.source_column LIKE 'DNBS_NXK%' THEN 'All'\r\n            WHEN ttduno.source_column LIKE '%_NDUTC_%' THEN '1'\r\n            WHEN ttduno.source_column LIKE '%_NCCY_%' THEN '2'\r\n            WHEN ttduno.source_column LIKE '%_NDUOITC_%' THEN '3'\r\n            WHEN ttduno.source_column LIKE '%_NNN_%' THEN '4'\r\n            WHEN ttduno.source_column LIKE '%_NCKNMV_%' THEN '4'\r\n          END  bucket_code\r\n        , CASE\r\n            WHEN ttduno.source_column LIKE  '%_USD' THEN 'USD'\r\n            WHEN ttduno.source_column LIKE  '%_VND' THEN 'VND'\r\n          END currency_type\r\n        , CASE\r\n            WHEN ttduno.co_tsbd = 1 THEN 'Secured'\r\n            ELSE 'Unsecured'\r\n          END loan_type\r\n        , 'LN' AS product_group\r\n    FROM {{ ref('stg_cic__ttduno')}} ttduno\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} t2 ON\r\n        ttduno.client_question_id = t2.client_question_id\r\n        AND ttduno.respond_date = t2.respond_date\r\n    WHERE ttduno.client_question_id IS NOT NULL\r\n), loan AS (\r\n    SELECT\r\n        cic.report_date\r\n        , cic.report_month\r\n        , cic.macic\r\n        , cic.client_question_id\r\n        , cic.cic_id\r\n        , cic.product_group\r\n        , cic.product_detail\r\n        , cic.loan_type\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TRA\u0301CH NHI\u00ca\u0323M H\u01af\u0303U HA\u0323N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u00d4\u0323T THA\u0300NH VI\u00caN', 'MTV')\r\n           AS bank_name\r\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , cic.bucket_code\r\n        , cic.currency_type\r\n        , cic.org_os_amount\r\n        , CASE WHEN cic.currency_type = 'VND' THEN 1\r\n            ELSE ccy.mid_rate\r\n          END exchange_rate\r\n        , CASE WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\r\n            ELSE ccy.mid_rate * cic.org_os_amount\r\n          END local_os_amount\r\n    FROM\r\n        source cic\r\n    LEFT JOIN {{ ref('stg_dwh__cydm_rate_history') }} ccy ON\r\n        cic.respond_date_j = ccy.datekey\r\n        AND cic.currency_type = ccy.ccy1\r\n)\r\nSELECT * FROM loan", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__loan_outstanding.sql", "original_file_path": "models\\int\\cic\\int_cic__loan_outstanding.sql", "name": "int_cic__loan_outstanding", "alias": "int_cic__loan_outstanding", "checksum": {"name": "sha256", "checksum": "a17ed6142f53236a01d0a67756ca916e0b6038cd89c87c15bce7a97ac60923e3"}, "tags": ["cic_daily"], "refs": [["stg_cic__ttduno"], ["int_cic__question_info"], ["stg_dwh__cydm_rate_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__loan_outstanding.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.6769793, "compiled_code": "\nWITH source AS (\n    SELECT\n        ttduno.*\n        , t2.macic\n        , t2.respond_date AS report_date\n        , t2.respond_month AS report_month\n        , t2.cic_id\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^\u2013]+',1,1,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^-]+',1,1,'i')))\n            ELSE UPPER(TRIM(ttduno.ten_tctd))\n            END bank_name\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^\u2013]+',1,2,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(ttduno.ten_tctd, '[^-]+',1,2,'i')))\n            ELSE NULL\n            END branch_name\n        , CASE\n            WHEN ttduno.source_column LIKE 'DNBS%' THEN 'D\u01b0 n\u1ee3 b\u1ed5 sung'\n            WHEN ttduno.source_column LIKE 'DNDH%' THEN 'D\u01b0 n\u1ee3 d\u00e0i h\u1ea1n'\n            WHEN  ttduno.source_column LIKE 'DNNH%' THEN 'D\u01b0 n\u1ee3 ng\u1eafn h\u1ea1n'\n            WHEN ttduno.source_column LIKE 'DNTH%' THEN 'D\u01b0 n\u1ee3 trung h\u1ea1n'\n            WHEN ttduno.source_column LIKE 'DNK%' THEN 'D\u01b0 n\u1ee3 kh\u00e1c'\n          END product_detail\n        , CASE\n            WHEN ttduno.source_column LIKE 'DNBS_NXK%' THEN 'All'\n            WHEN ttduno.source_column LIKE '%_NDUTC_%' THEN '1'\n            WHEN ttduno.source_column LIKE '%_NCCY_%' THEN '2'\n            WHEN ttduno.source_column LIKE '%_NDUOITC_%' THEN '3'\n            WHEN ttduno.source_column LIKE '%_NNN_%' THEN '4'\n            WHEN ttduno.source_column LIKE '%_NCKNMV_%' THEN '4'\n          END  bucket_code\n        , CASE\n            WHEN ttduno.source_column LIKE  '%_USD' THEN 'USD'\n            WHEN ttduno.source_column LIKE  '%_VND' THEN 'VND'\n          END currency_type\n        , CASE\n            WHEN ttduno.co_tsbd = 1 THEN 'Secured'\n            ELSE 'Unsecured'\n          END loan_type\n        , 'LN' AS product_group\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__ttduno ttduno\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info t2 ON\n        ttduno.client_question_id = t2.client_question_id\n        AND ttduno.respond_date = t2.respond_date\n    WHERE ttduno.client_question_id IS NOT NULL\n), loan AS (\n    SELECT\n        cic.report_date\n        , cic.report_month\n        , cic.macic\n        , cic.client_question_id\n        , cic.cic_id\n        , cic.product_group\n        , cic.product_detail\n        , cic.loan_type\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TRA\u0301CH NHI\u00ca\u0323M H\u01af\u0303U HA\u0323N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u00d4\u0323T THA\u0300NH VI\u00caN', 'MTV')\n           AS bank_name\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\n        , cic.bucket_code\n        , cic.currency_type\n        , cic.org_os_amount\n        , CASE WHEN cic.currency_type = 'VND' THEN 1\n            ELSE ccy.mid_rate\n          END exchange_rate\n        , CASE WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\n            ELSE ccy.mid_rate * cic.org_os_amount\n          END local_os_amount\n    FROM\n        source cic\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history ccy ON\n        cic.respond_date_j = ccy.datekey\n        AND cic.currency_type = ccy.ccy1\n)\nSELECT * FROM loan", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__loan_outstanding"}, "model.dga_data_model.int_cic__outstanding": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.int_cic__bond_outstanding", "model.dga_data_model.int_cic__cc_outstanding", "model.dga_data_model.int_cic__tf_outstanding", "model.dga_data_model.int_cic__vamc_outstanding", "model.dga_data_model.int_cic__loan_outstanding", "model.dga_data_model.dim__customer", "model.dga_data_model.dim_cic__customer_info"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"client_question_id\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"macic\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__outstanding"], "unique_id": "model.dga_data_model.int_cic__outstanding", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n        post_hook=['{{ create_index_if_not_exists(this, \"client_question_id\")}}',\r\n                '{{ create_index_if_not_exists(this, \"macic\")}}'\r\n              ]\r\n    )\r\n}}\r\nWITH append AS (\r\n    SELECT\r\n        bond.*\r\n    FROM {{ ref('int_cic__bond_outstanding')}} bond\r\n    WHERE bond.local_os_amount <> 0\r\n\r\n    UNION ALL\r\n\r\n    SELECT\r\n        cc.*\r\n    FROM {{ ref('int_cic__cc_outstanding')}} cc\r\n    WHERE cc.local_os_amount <> 0\r\n\r\n    UNION ALL\r\n\r\n    SELECT\r\n        tf.*\r\n    FROM {{ ref('int_cic__tf_outstanding')}} tf\r\n    WHERE tf.local_os_amount <> 0\r\n\r\n    UNION ALL\r\n\r\n    SELECT\r\n        vamc.*\r\n    FROM {{ ref('int_cic__vamc_outstanding')}} vamc\r\n    WHERE vamc.local_os_amount <> 0\r\n\r\n    UNION ALL\r\n\r\n    SELECT\r\n        loan.*\r\n    FROM {{ ref('int_cic__loan_outstanding')}} loan\r\n)\r\n, dim_cst AS (\r\n    SELECT\r\n        dim_cst.*\r\n        , row_number() OVER(PARTITION BY tax_code_final, is_cur_rec ORDER BY contact_date DESC) AS rn\r\n    FROM {{ ref('dim__customer')}} dim_cst\r\n    WHERE is_cur_rec = 1\r\n)\r\n, cte AS (\r\n    SELECT\r\n        append.*\r\n        , nvl(cic_cst.cif, dim_cst.customer_number) AS customer_number\r\n        , dim_cst.tax_code_final\r\n        , FIRST_VALUE(report_date) OVER(PARTITION BY cic_cst.tax_code_final ORDER BY report_date DESC) AS max_report_date\r\n        , CASE\r\n            WHEN report_date = FIRST_VALUE(report_date) OVER(PARTITION BY cic_cst.tax_code_final ORDER BY report_date DESC)\r\n                THEN 1\r\n            ELSE 0\r\n            END is_latest\r\n    FROM append\r\n    LEFT JOIN {{ ref('dim_cic__customer_info')}} cic_cst\r\n        ON append.macic = cic_cst.macic\r\n        AND is_cur_rec = 1\r\n    LEFT JOIN dim_cst\r\n        ON cic_cst.tax_code_final = dim_cst.tax_code_final\r\n        AND dim_cst.rn = 1\r\n)\r\nSELECT * FROM cte", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__outstanding.sql", "original_file_path": "models\\int\\cic\\int_cic__outstanding.sql", "name": "int_cic__outstanding", "alias": "int_cic__outstanding", "checksum": {"name": "sha256", "checksum": "27827bc0a5b095b6e2abc588acad8ba36db58f848d29a866071f8de3753cc268"}, "tags": ["cic_daily"], "refs": [["int_cic__bond_outstanding"], ["int_cic__cc_outstanding"], ["int_cic__tf_outstanding"], ["int_cic__vamc_outstanding"], ["int_cic__loan_outstanding"], ["dim__customer"], ["dim_cic__customer_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__outstanding.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table", "post-hook": ["{{ create_index_if_not_exists(this, \"client_question_id\")}}", "{{ create_index_if_not_exists(this, \"macic\")}}"]}, "created_at": 1685959752.67799, "compiled_code": "\nWITH append AS (\n    SELECT\n        bond.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__bond_outstanding bond\n    WHERE bond.local_os_amount <> 0\n\n    UNION ALL\n\n    SELECT\n        cc.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__cc_outstanding cc\n    WHERE cc.local_os_amount <> 0\n\n    UNION ALL\n\n    SELECT\n        tf.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__tf_outstanding tf\n    WHERE tf.local_os_amount <> 0\n\n    UNION ALL\n\n    SELECT\n        vamc.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__vamc_outstanding vamc\n    WHERE vamc.local_os_amount <> 0\n\n    UNION ALL\n\n    SELECT\n        loan.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__loan_outstanding loan\n)\n, dim_cst AS (\n    SELECT\n        dim_cst.*\n        , row_number() OVER(PARTITION BY tax_code_final, is_cur_rec ORDER BY contact_date DESC) AS rn\n    FROM \"oracle_dgaworkzone\".mart.dim__customer dim_cst\n    WHERE is_cur_rec = 1\n)\n, cte AS (\n    SELECT\n        append.*\n        , nvl(cic_cst.cif, dim_cst.customer_number) AS customer_number\n        , dim_cst.tax_code_final\n        , FIRST_VALUE(report_date) OVER(PARTITION BY cic_cst.tax_code_final ORDER BY report_date DESC) AS max_report_date\n        , CASE\n            WHEN report_date = FIRST_VALUE(report_date) OVER(PARTITION BY cic_cst.tax_code_final ORDER BY report_date DESC)\n                THEN 1\n            ELSE 0\n            END is_latest\n    FROM append\n    LEFT JOIN \"oracle_dgaworkzone\".mart.dim_cic__customer_info cic_cst\n        ON append.macic = cic_cst.macic\n        AND is_cur_rec = 1\n    LEFT JOIN dim_cst\n        ON cic_cst.tax_code_final = dim_cst.tax_code_final\n        AND dim_cst.rn = 1\n)\nSELECT * FROM cte", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__outstanding"}, "model.dga_data_model.int_cic__outstanding_lag_12m": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.int_cic__loan_lag_12m", "model.dga_data_model.int_cic__cc_lag_12m", "model.dga_data_model.dim__customer", "model.dga_data_model.dim_cic__customer_info"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"client_request_id\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"macic\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__outstanding_lag_12m"], "unique_id": "model.dga_data_model.int_cic__outstanding_lag_12m", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n        post_hook=['{{ create_index_if_not_exists(this, \"client_request_id\")}}',\r\n                '{{ create_index_if_not_exists(this, \"macic\")}}'\r\n              ]\r\n    )\r\n}}\r\nWITH append AS (\r\n    SELECT\r\n        loan.*\r\n    FROM {{ ref('int_cic__loan_lag_12m')}} loan\r\n\r\n    UNION ALL\r\n\r\n    SELECT\r\n        cc.*\r\n    FROM {{ ref('int_cic__cc_lag_12m')}} cc\r\n)\r\n, dim_cst AS (\r\n    SELECT\r\n        dim_cst.*\r\n        , row_number() OVER(PARTITION BY tax_code_final, is_cur_rec ORDER BY contact_date DESC) AS rn\r\n    FROM {{ ref('dim__customer')}} dim_cst\r\n    WHERE is_cur_rec = 1\r\n)\r\n, cte AS (\r\n    SELECT\r\n        append.*\r\n        , nvl(cic_cst.cif, dim_cst.customer_number) AS customer_number\r\n        , dim_cst.tax_code_final\r\n    FROM append\r\n    LEFT JOIN {{ ref('dim_cic__customer_info')}} cic_cst\r\n        ON append.macic = cic_cst.macic\r\n        AND is_cur_rec = 1\r\n    LEFT JOIN dim_cst\r\n        ON cic_cst.tax_code_final = dim_cst.tax_code_final\r\n        AND dim_cst.rn = 1\r\n)\r\nSELECT * FROM cte", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__outstanding_lag_12m.sql", "original_file_path": "models\\int\\cic\\int_cic__outstanding_lag_12m.sql", "name": "int_cic__outstanding_lag_12m", "alias": "int_cic__outstanding_lag_12m", "checksum": {"name": "sha256", "checksum": "be646128833d39c968d5119c5940b7d13de9d7b39a3e804b07f84bc35580b174"}, "tags": ["cic_daily"], "refs": [["int_cic__loan_lag_12m"], ["int_cic__cc_lag_12m"], ["dim__customer"], ["dim_cic__customer_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__outstanding_lag_12m.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table", "post-hook": ["{{ create_index_if_not_exists(this, \"client_request_id\")}}", "{{ create_index_if_not_exists(this, \"macic\")}}"]}, "created_at": 1685959752.67898, "compiled_code": "\nWITH append AS (\n    SELECT\n        loan.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__loan_lag_12m loan\n\n    UNION ALL\n\n    SELECT\n        cc.*\n    FROM \"oracle_dgaworkzone\".int.int_cic__cc_lag_12m cc\n)\n, dim_cst AS (\n    SELECT\n        dim_cst.*\n        , row_number() OVER(PARTITION BY tax_code_final, is_cur_rec ORDER BY contact_date DESC) AS rn\n    FROM \"oracle_dgaworkzone\".mart.dim__customer dim_cst\n    WHERE is_cur_rec = 1\n)\n, cte AS (\n    SELECT\n        append.*\n        , nvl(cic_cst.cif, dim_cst.customer_number) AS customer_number\n        , dim_cst.tax_code_final\n    FROM append\n    LEFT JOIN \"oracle_dgaworkzone\".mart.dim_cic__customer_info cic_cst\n        ON append.macic = cic_cst.macic\n        AND is_cur_rec = 1\n    LEFT JOIN dim_cst\n        ON cic_cst.tax_code_final = dim_cst.tax_code_final\n        AND dim_cst.rn = 1\n)\nSELECT * FROM cte", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__outstanding_lag_12m"}, "model.dga_data_model.int_cic__outstanding_lag_12m_smy": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.int_cic__outstanding", "model.dga_data_model.dim__customer", "model.dga_data_model.stg_cic__duno12thang", "model.dga_data_model.stg_cic__dunothetd12thang", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.dim_cic__customer_info"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__outstanding_lag_12m_smy"], "unique_id": "model.dga_data_model.int_cic__outstanding_lag_12m_smy", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH cic_bal AS\r\n(\r\n    SELECT\r\n    *\r\n    FROM {{ ref('int_cic__outstanding')}}\r\n    WHERE tax_code_final IS NOT NULL\r\n    AND bucket_code <> 'All'\r\n)\r\n, bucket_highest_36m AS\r\n(\r\n    SELECT\r\n        DISTINCT tax_code_final\r\n        , FIRST_VALUE(bucket_code) OVER(PARTITION BY tax_code_final ORDER BY bucket_code DESC )\r\n            AS bucket_highest_36m\r\n    FROM cic_bal\r\n    WHERE report_month >= to_char(add_months(sysdate,-36),'yyyymm')\r\n)\r\n, bucket_highest_cur AS\r\n(\r\n    SELECT\r\n        DISTINCT tax_code_final\r\n        , FIRST_VALUE(bucket_code) OVER(PARTITION BY tax_code_final ORDER BY report_date DESC, bucket_code DESC )\r\n            AS bucket_highest_cur\r\n    FROM cic_bal\r\n)\r\n, dim_cst AS (\r\n    SELECT\r\n        dim_cst.*\r\n        , row_number() OVER(PARTITION BY tax_code_final, is_cur_rec ORDER BY contact_date DESC) AS rn\r\n    FROM {{ ref('dim__customer')}} dim_cst\r\n    WHERE is_cur_rec = 1\r\n)\r\n, append_bal AS (\r\n    SELECT *\r\n    FROM {{ ref('stg_cic__duno12thang')}}\r\n    UNION ALL\r\n    SELECT *\r\n    FROM {{ ref('stg_cic__dunothetd12thang')}}\r\n)\r\n, agg_bal AS (\r\n    SELECT\r\n        append_bal.client_question_id\r\n        ,COALESCE(cic_cst_info.cif,dim_cst.customer_number) AS customer_number\r\n        ,dim_cst.tax_code_final\r\n        ,substr(append_bal.request_date,1,4) AS request_year\r\n        ,TO_DATE(append_bal.request_date,'yyyymmdd') AS request_date\r\n        ,TO_DATE(append_bal.respond_date,'yyyymmdd') AS respond_date\r\n        ,SUM(COALESCE(append_bal.t1vnd,0)) AS t_1\r\n        ,SUM(COALESCE(append_bal.t2vnd,0)) AS t_2\r\n        ,SUM(COALESCE(append_bal.t3vnd,0)) AS t_3\r\n        ,SUM(COALESCE(append_bal.t4vnd,0)) AS t_4\r\n        ,SUM(COALESCE(append_bal.t5vnd,0)) AS t_5\r\n        ,SUM(COALESCE(append_bal.t6vnd,0)) AS t_6\r\n        ,SUM(COALESCE(append_bal.t7vnd,0)) AS t_7\r\n        ,SUM(COALESCE(append_bal.t8vnd,0)) AS t_8\r\n        ,SUM(COALESCE(append_bal.t9vnd,0)) AS t_9\r\n        ,SUM(COALESCE(append_bal.t10vnd,0)) AS t_10\r\n        ,SUM(COALESCE(append_bal.t11vnd,0)) AS t_11\r\n        ,SUM(COALESCE(append_bal.t12vnd,0)) AS t_12\r\n    FROM append_bal\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} cic_ques_info\r\n        ON append_bal.client_question_id = cic_ques_info.client_question_id\r\n        AND append_bal.request_date = cic_ques_info.request_date\r\n    LEFT JOIN {{ ref('dim_cic__customer_info')}} cic_cst_info\r\n        ON cic_ques_info.macic = cic_cst_info.macic\r\n        AND cic_cst_info.is_cur_rec = 1\r\n    LEFT JOIN dim_cst\r\n        ON cic_cst_info.tax_code_final = dim_cst.tax_code_final\r\n        AND dim_cst.rn = 1\r\n    GROUP BY\r\n    append_bal.client_question_id\r\n    ,cic_cst_info.cif\r\n    ,dim_cst.customer_number\r\n    ,dim_cst.tax_code_final\r\n    ,append_bal.request_date\r\n    ,append_bal.respond_date\r\n)\r\n, combined_bucket AS (\r\n    SELECT\r\n        agg_bal.*\r\n        ,bucket_highest_36m\r\n        ,bucket_highest_cur\r\n        ,row_number() OVER(PARTITION BY agg_bal.tax_code_final ORDER BY respond_date DESC) rn\r\n    FROM agg_bal\r\n    LEFT JOIN bucket_highest_36m a\r\n    ON agg_bal.tax_code_final = a.tax_code_final\r\n    LEFT JOIN bucket_highest_cur b\r\n    ON agg_bal.tax_code_final = b.tax_code_final\r\n)\r\nSELECT * FROM combined_bucket\r\nWHERE rn = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__outstanding_lag_12m_smy.sql", "original_file_path": "models\\int\\cic\\int_cic__outstanding_lag_12m_smy.sql", "name": "int_cic__outstanding_lag_12m_smy", "alias": "int_cic__outstanding_lag_12m_smy", "checksum": {"name": "sha256", "checksum": "8ceec12c158668879202837374b70d27c38fa2c10a04bda96ead0f7c0bd477b1"}, "tags": ["cic_daily"], "refs": [["int_cic__outstanding"], ["dim__customer"], ["stg_cic__duno12thang"], ["stg_cic__dunothetd12thang"], ["int_cic__question_info"], ["dim_cic__customer_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__outstanding_lag_12m_smy.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959750.9943416, "compiled_code": "\nWITH cic_bal AS\n(\n    SELECT\n    *\n    FROM \"oracle_dgaworkzone\".int.int_cic__outstanding\n    WHERE tax_code_final IS NOT NULL\n    AND bucket_code <> 'All'\n)\n, bucket_highest_36m AS\n(\n    SELECT\n        DISTINCT tax_code_final\n        , FIRST_VALUE(bucket_code) OVER(PARTITION BY tax_code_final ORDER BY bucket_code DESC )\n            AS bucket_highest_36m\n    FROM cic_bal\n    WHERE report_month >= to_char(add_months(sysdate,-36),'yyyymm')\n)\n, bucket_highest_cur AS\n(\n    SELECT\n        DISTINCT tax_code_final\n        , FIRST_VALUE(bucket_code) OVER(PARTITION BY tax_code_final ORDER BY report_date DESC, bucket_code DESC )\n            AS bucket_highest_cur\n    FROM cic_bal\n)\n, dim_cst AS (\n    SELECT\n        dim_cst.*\n        , row_number() OVER(PARTITION BY tax_code_final, is_cur_rec ORDER BY contact_date DESC) AS rn\n    FROM \"oracle_dgaworkzone\".mart.dim__customer dim_cst\n    WHERE is_cur_rec = 1\n)\n, append_bal AS (\n    SELECT *\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__duno12thang\n    UNION ALL\n    SELECT *\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__dunothetd12thang\n)\n, agg_bal AS (\n    SELECT\n        append_bal.client_question_id\n        ,COALESCE(cic_cst_info.cif,dim_cst.customer_number) AS customer_number\n        ,dim_cst.tax_code_final\n        ,substr(append_bal.request_date,1,4) AS request_year\n        ,TO_DATE(append_bal.request_date,'yyyymmdd') AS request_date\n        ,TO_DATE(append_bal.respond_date,'yyyymmdd') AS respond_date\n        ,SUM(COALESCE(append_bal.t1vnd,0)) AS t_1\n        ,SUM(COALESCE(append_bal.t2vnd,0)) AS t_2\n        ,SUM(COALESCE(append_bal.t3vnd,0)) AS t_3\n        ,SUM(COALESCE(append_bal.t4vnd,0)) AS t_4\n        ,SUM(COALESCE(append_bal.t5vnd,0)) AS t_5\n        ,SUM(COALESCE(append_bal.t6vnd,0)) AS t_6\n        ,SUM(COALESCE(append_bal.t7vnd,0)) AS t_7\n        ,SUM(COALESCE(append_bal.t8vnd,0)) AS t_8\n        ,SUM(COALESCE(append_bal.t9vnd,0)) AS t_9\n        ,SUM(COALESCE(append_bal.t10vnd,0)) AS t_10\n        ,SUM(COALESCE(append_bal.t11vnd,0)) AS t_11\n        ,SUM(COALESCE(append_bal.t12vnd,0)) AS t_12\n    FROM append_bal\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info cic_ques_info\n        ON append_bal.client_question_id = cic_ques_info.client_question_id\n        AND append_bal.request_date = cic_ques_info.request_date\n    LEFT JOIN \"oracle_dgaworkzone\".mart.dim_cic__customer_info cic_cst_info\n        ON cic_ques_info.macic = cic_cst_info.macic\n        AND cic_cst_info.is_cur_rec = 1\n    LEFT JOIN dim_cst\n        ON cic_cst_info.tax_code_final = dim_cst.tax_code_final\n        AND dim_cst.rn = 1\n    GROUP BY\n    append_bal.client_question_id\n    ,cic_cst_info.cif\n    ,dim_cst.customer_number\n    ,dim_cst.tax_code_final\n    ,append_bal.request_date\n    ,append_bal.respond_date\n)\n, combined_bucket AS (\n    SELECT\n        agg_bal.*\n        ,bucket_highest_36m\n        ,bucket_highest_cur\n        ,row_number() OVER(PARTITION BY agg_bal.tax_code_final ORDER BY respond_date DESC) rn\n    FROM agg_bal\n    LEFT JOIN bucket_highest_36m a\n    ON agg_bal.tax_code_final = a.tax_code_final\n    LEFT JOIN bucket_highest_cur b\n    ON agg_bal.tax_code_final = b.tax_code_final\n)\nSELECT * FROM combined_bucket\nWHERE rn = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__outstanding_lag_12m_smy"}, "model.dga_data_model.int_cic__question_info": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__thongtinchung", "model.dga_data_model.stg_cic__cicmaster"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__question_info"], "unique_id": "model.dga_data_model.int_cic__question_info", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH cic_question_info AS (\r\nSELECT\r\n    t2.macic AS macic\r\n    , t1.cic_id\r\n    , t1.client_question_id\r\n    , t1.request_date\r\n    , t1.respond_date\r\n    , t1.respond_month\r\n    , RANK()OVER(PARTITION BY T2.macic\r\n        ORDER BY t1.respond_date DESC, t1.request_date DESC) AS row_number\r\n    , RANK()OVER(PARTITION BY t1.client_question_id, t1.ma_tctd\r\n        ORDER BY t1.respond_date DESC, t1.request_date DESC) AS rn_cq_id\r\nFROM {{ ref('stg_cic__thongtinchung')}} t1\r\nLEFT JOIN {{ ref('stg_cic__cicmaster')}} t2 ON t1.cic_id = t2.id\r\nWHERE t1.client_question_id IS NOT NULL\r\n)\r\nSELECT * FROM cic_question_info", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__question_info.sql", "original_file_path": "models\\int\\cic\\int_cic__question_info.sql", "name": "int_cic__question_info", "alias": "int_cic__question_info", "checksum": {"name": "sha256", "checksum": "69d4dc7c4b7b85581e95db91593ac17ca134eeda7d3a245225d8665aa831ae16"}, "tags": ["cic_daily"], "refs": [["stg_cic__thongtinchung"], ["stg_cic__cicmaster"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__question_info.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.6759784, "compiled_code": "\nWITH cic_question_info AS (\nSELECT\n    t2.macic AS macic\n    , t1.cic_id\n    , t1.client_question_id\n    , t1.request_date\n    , t1.respond_date\n    , t1.respond_month\n    , RANK()OVER(PARTITION BY T2.macic\n        ORDER BY t1.respond_date DESC, t1.request_date DESC) AS row_number\n    , RANK()OVER(PARTITION BY t1.client_question_id, t1.ma_tctd\n        ORDER BY t1.respond_date DESC, t1.request_date DESC) AS rn_cq_id\nFROM \"oracle_dgaworkzone\".staging.stg_cic__thongtinchung t1\nLEFT JOIN \"oracle_dgaworkzone\".staging.stg_cic__cicmaster t2 ON t1.cic_id = t2.id\nWHERE t1.client_question_id IS NOT NULL\n)\nSELECT * FROM cic_question_info", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__question_info"}, "model.dga_data_model.int_cic__tf_outstanding": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__camketngoaibang", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_dwh__cydm_rate_history"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__tf_outstanding"], "unique_id": "model.dga_data_model.int_cic__tf_outstanding", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        t1.*\r\n        , t2.macic\r\n        , t2.respond_date AS report_date\r\n        , t2.respond_month AS report_month\r\n        , t2.cic_id\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\r\n            ELSE UPPER(TRIM(t1.ten_tctd))\r\n            END bank_name\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\r\n            ELSE NULL\r\n            END branch_name\r\n        , CASE\r\n            WHEN t1.nhom_no = 0 THEN '1'\r\n            ELSE nvl(to_char(t1.nhom_no),'1')\r\n          END bucket_code\r\n        , CAST(NULL AS varchar2(10)) AS loan_type\r\n    FROM {{ ref('stg_cic__camketngoaibang')}} t1\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} t2 ON\r\n        t1.client_question_id = t2.client_question_id\r\n        AND t1.respond_date = t2.respond_date\r\n    WHERE t1.client_question_id IS NOT NULL\r\n), tf AS (\r\n    SELECT\r\n        cic.report_date\r\n        , cic.report_month\r\n        , cic.macic\r\n        , cic.client_question_id\r\n        , cic.cic_id\r\n        , cic.product_group\r\n        , cic.product_detail\r\n        , cic.loan_type\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u00d4\u0323T THA\u0300NH VI\u00caN', 'MTV')\r\n           AS bank_name\r\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , cic.bucket_code\r\n        , cic.currency_type\r\n        , cic.org_os_amount\r\n        , CASE WHEN cic.currency_type = 'VND' THEN 1\r\n            ELSE ccy.mid_rate\r\n          END exchange_rate\r\n        , CASE WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\r\n            ELSE ccy.mid_rate * cic.org_os_amount\r\n          END local_os_amount\r\n    FROM\r\n        source cic\r\n    LEFT JOIN {{ ref('stg_dwh__cydm_rate_history') }} ccy ON\r\n        cic.respond_date_j = ccy.datekey\r\n        AND cic.currency_type = ccy.ccy1\r\n)\r\nSELECT * FROM tf", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__tf_outstanding.sql", "original_file_path": "models\\int\\cic\\int_cic__tf_outstanding.sql", "name": "int_cic__tf_outstanding", "alias": "int_cic__tf_outstanding", "checksum": {"name": "sha256", "checksum": "1a9475a0c4309922800166848f3a9043aa25278c27a5e233d7b1d731a34362dc"}, "tags": ["cic_daily"], "refs": [["stg_cic__camketngoaibang"], ["int_cic__question_info"], ["stg_dwh__cydm_rate_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__tf_outstanding.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.67799, "compiled_code": "\nWITH source AS (\n    SELECT\n        t1.*\n        , t2.macic\n        , t2.respond_date AS report_date\n        , t2.respond_month AS report_month\n        , t2.cic_id\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\n            ELSE UPPER(TRIM(t1.ten_tctd))\n            END bank_name\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\n            ELSE NULL\n            END branch_name\n        , CASE\n            WHEN t1.nhom_no = 0 THEN '1'\n            ELSE nvl(to_char(t1.nhom_no),'1')\n          END bucket_code\n        , CAST(NULL AS varchar2(10)) AS loan_type\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__camketngoaibang t1\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info t2 ON\n        t1.client_question_id = t2.client_question_id\n        AND t1.respond_date = t2.respond_date\n    WHERE t1.client_question_id IS NOT NULL\n), tf AS (\n    SELECT\n        cic.report_date\n        , cic.report_month\n        , cic.macic\n        , cic.client_question_id\n        , cic.cic_id\n        , cic.product_group\n        , cic.product_detail\n        , cic.loan_type\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u00d4\u0323T THA\u0300NH VI\u00caN', 'MTV')\n           AS bank_name\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\n        , cic.bucket_code\n        , cic.currency_type\n        , cic.org_os_amount\n        , CASE WHEN cic.currency_type = 'VND' THEN 1\n            ELSE ccy.mid_rate\n          END exchange_rate\n        , CASE WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\n            ELSE ccy.mid_rate * cic.org_os_amount\n          END local_os_amount\n    FROM\n        source cic\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history ccy ON\n        cic.respond_date_j = ccy.datekey\n        AND cic.currency_type = ccy.ccy1\n)\nSELECT * FROM tf", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__tf_outstanding"}, "model.dga_data_model.int_cic__vamc_outstanding": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_cic__novamc", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_dwh__cydm_rate_history"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "cic", "int_cic__vamc_outstanding"], "unique_id": "model.dga_data_model.int_cic__vamc_outstanding", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n          t1.*\r\n        , t2.macic\r\n        , t2.respond_date AS report_date\r\n        , t2.respond_month AS report_month\r\n        , t2.cic_id\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\r\n            ELSE UPPER(TRIM(t1.ten_tctd))\r\n            END bank_name\r\n        , CASE\r\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\r\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\r\n            ELSE NULL\r\n            END branch_name\r\n        , CAST(NULL AS varchar2(10)) AS loan_type\r\n    FROM {{ ref('stg_cic__novamc')}} t1\r\n    LEFT JOIN {{ ref('int_cic__question_info')}} t2 ON\r\n        t1.client_question_id = t2.client_question_id\r\n        AND t1.respond_date = t2.respond_date\r\n    WHERE t1.client_question_id IS NOT NULL\r\n), vamc AS (\r\n    SELECT\r\n          cic.report_date\r\n        , cic.report_month\r\n        , cic.macic\r\n        , cic.client_question_id\r\n        , cic.cic_id\r\n        , cic.product_group\r\n        , cic.product_detail\r\n        , cic.loan_type\r\n        , replace(\r\n            replace(\r\n                replace(\r\n                    replace(\r\n                        replace(\r\n                            replace(\r\n                                replace(\r\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\r\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\r\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\r\n                            , 'C\u00d4NG TY', 'CTY')\r\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\r\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\r\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\r\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\r\n           AS bank_name\r\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\r\n        , cic.bucket_code\r\n        , cic.currency_type\r\n        , cic.org_os_amount\r\n        , CASE\r\n            WHEN cic.currency_type = 'VND' THEN 1\r\n            ELSE ccy.mid_rate\r\n          END exchange_rate\r\n        , CASE\r\n            WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\r\n            ELSE ccy.mid_rate * cic.org_os_amount\r\n          END local_os_amount\r\n    FROM\r\n        source cic\r\n    LEFT JOIN {{ ref('stg_dwh__cydm_rate_history') }} ccy ON\r\n        cic.respond_date_j = ccy.datekey\r\n        AND cic.currency_type = ccy.ccy1\r\n)\r\nSELECT * FROM vamc", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\cic\\int_cic__vamc_outstanding.sql", "original_file_path": "models\\int\\cic\\int_cic__vamc_outstanding.sql", "name": "int_cic__vamc_outstanding", "alias": "int_cic__vamc_outstanding", "checksum": {"name": "sha256", "checksum": "e09f0bac8f80d698984c3bc2c1570a5553755461f5bd0e92f45e7d3fddaefe09"}, "tags": ["cic_daily"], "refs": [["stg_cic__novamc"], ["int_cic__question_info"], ["stg_dwh__cydm_rate_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\cic\\int_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\cic\\int_cic__vamc_outstanding.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "phuongnt89"}, "tags": "cic_daily", "materialized": "table"}, "created_at": 1685959752.67799, "compiled_code": "\nWITH source AS (\n    SELECT\n          t1.*\n        , t2.macic\n        , t2.respond_date AS report_date\n        , t2.respond_month AS report_month\n        , t2.cic_id\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,1,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,1,'i')))\n            ELSE UPPER(TRIM(t1.ten_tctd))\n            END bank_name\n        , CASE\n            WHEN instr(ten_tctd, '\u2013') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^\u2013]+',1,2,'i')))\n            WHEN instr(ten_tctd, '-') > 0 THEN UPPER(TRIM(regexp_substr(t1.ten_tctd, '[^-]+',1,2,'i')))\n            ELSE NULL\n            END branch_name\n        , CAST(NULL AS varchar2(10)) AS loan_type\n    FROM \"oracle_dgaworkzone\".staging.stg_cic__novamc t1\n    LEFT JOIN \"oracle_dgaworkzone\".int.int_cic__question_info t2 ON\n        t1.client_question_id = t2.client_question_id\n        AND t1.respond_date = t2.respond_date\n    WHERE t1.client_question_id IS NOT NULL\n), vamc AS (\n    SELECT\n          cic.report_date\n        , cic.report_month\n        , cic.macic\n        , cic.client_question_id\n        , cic.cic_id\n        , cic.product_group\n        , cic.product_detail\n        , cic.loan_type\n        , replace(\n            replace(\n                replace(\n                    replace(\n                        replace(\n                            replace(\n                                replace(\n                                    translate(regexp_replace(cic.bank_name,'\\([^()]*\\)', ''), '()', ' ')\n                                    , 'NG\u00c2N H\u00c0NG', 'NH')\n                                , 'C\u00d4NG TY C\u1ed4 PH\u1ea6N', 'CTCP')\n                            , 'C\u00d4NG TY', 'CTY')\n                        , 'TR\u00c1CH NHI\u1ec6M H\u1eeeU H\u1ea0N', 'TNHH')\n                    , 'QU\u1ef8 T\u00cdN D\u1ee4NG NH\u00c2N D\u00c2N', 'QTDND')\n                , 'TH\u01af\u01a0NG M\u1ea0I C\u1ed4 PH\u1ea6N', 'TMCP')\n            , 'M\u1ed8T TH\u00c0NH VI\u00caN', 'MTV')\n           AS bank_name\n        , regexp_replace(cic.branch_name,'\\([^()]*\\)', '') AS branch_name\n        , cic.bucket_code\n        , cic.currency_type\n        , cic.org_os_amount\n        , CASE\n            WHEN cic.currency_type = 'VND' THEN 1\n            ELSE ccy.mid_rate\n          END exchange_rate\n        , CASE\n            WHEN cic.currency_type = 'VND' THEN cic.org_os_amount*1e6\n            ELSE ccy.mid_rate * cic.org_os_amount\n          END local_os_amount\n    FROM\n        source cic\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history ccy ON\n        cic.respond_date_j = ccy.datekey\n        AND cic.currency_type = ccy.ccy1\n)\nSELECT * FROM vamc", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_cic__vamc_outstanding"}, "model.dga_data_model.int_way4__card": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__card_add_data", "model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.int_way4__contract", "model.dga_data_model.stg_landing__card_f_i"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int_way4__card"], "unique_id": "model.dga_data_model.int_way4__card", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH dat_card_activate_or_close AS (\r\n  SELECT\r\n      amend_date\r\n    , for_id\r\n    , current_value\r\n    , AMND_STATE\r\n    , CASE \r\n        WHEN current_value LIKE '%(Call Issuer) --> 00 (Card OK)%' \r\n          THEN ROW_NUMBER() OVER(PARTITION BY for_id ORDER BY amend_date) \r\n      END AS rn_active\r\n    , CASE \r\n        WHEN current_value LIKE '%-->%(Card Closed)%'\r\n          THEN ROW_NUMBER() OVER(PARTITION BY for_id ORDER BY amend_date DESC) \r\n      END AS rn_close\r\n    FROM\r\n      {{ ref('stg_landing__card_add_data')}}\r\n    WHERE\r\n      (current_value LIKE '%(Call Issuer) --> 00 (Card OK)%'\r\n        OR current_value LIKE '%-->%(Card Closed)%')\r\n)\r\n, dat_result AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.id AS card_id\r\n    , a.acnt_contract__id\r\n    , a.acnt_contract__oid\r\n    , a.liab_contract\r\n    , a.ccat\r\n    , a.branch\r\n    , a.contract_number\r\n    , a.contract_name\r\n    , a.channel\r\n    , a.channel_desc\r\n    , a.product_code_internal\r\n    , a.product_code\r\n    , a.product_name\r\n    , a.product_group\r\n    , a.customer_id_internal\r\n    , a.customer_number\r\n    , decode(COALESCE(a.auth_limit_amount,0), 0, COALESCE(f.auth_limit_amount,0), COALESCE(a.auth_limit_amount,0)) AS auth_limit_amount\r\n    , a.date_open\r\n    , a.date_expire\r\n    , a.last_billing_date\r\n    , a.next_billing_date\r\n    , a.card_expire\r\n    , a.contract_status\r\n    , a.contract_status_name\r\n    , a.tr_first_nam\r\n    , a.tr_last_nam\r\n    , a.cycle_length\r\n    , a.interval_type\r\n    , a.is_ready\r\n    , a.billing_contract\r\n    , a.type_of_card\r\n    , a.amnd_date\r\n    , a.rbs_number\r\n    , a.bpm_loan_id\r\n    , a.card_sales_channel\r\n    , a.add_info_01\r\n    , a.add_info_02\r\n    , a.add_info_03\r\n    , a.add_info_04\r\n    , g.amend_date AS date_activate\r\n    , CASE\r\n        WHEN a.contract_status_name ='Card Closed' THEN gc.amend_date\r\n      END AS close_date\r\n    , fi.bank_code\r\n    , CASE WHEN a.product_name LIKE '% Sub %' THEN 'Sub' ELSE 'Main' END AS product_main_or_sub\r\n  FROM\r\n    {{ ref('stg__card_acnt_contract_plus')}} a \r\n  LEFT JOIN {{ ref('int_way4__contract')}} f ON a.acnt_contract__oid = f.contract_id\r\n  LEFT JOIN dat_card_activate_or_close  g ON a.id = g.for_id AND g.rn_active = 1\r\n  LEFT JOIN dat_card_activate_or_close  gc ON a.id = gc.for_id AND gc.rn_close = 1 AND gc.AMND_STATE = 'A'\r\n  LEFT JOIN {{ ref('stg_landing__card_f_i') }} fi ON a.F_I = fi.ID AND fi.amnd_state='A'\r\n  WHERE\r\n    a.con_cat = 'C'\r\n    AND a.product_code NOT LIKE '%_REL_%'\r\n)\r\n, dat_hash AS (\r\n  SELECT\r\n      etl_date\r\n    , standard_hash(card_id\r\n                      || '#'\r\n                      || acnt_contract__id\r\n                      || '#'\r\n                      || acnt_contract__oid\r\n                      || '#'\r\n                      || liab_contract\r\n                      || '#'\r\n                      || ccat\r\n                      || '#'\r\n                      || branch\r\n                      || '#'\r\n                      || contract_number\r\n                      || '#'\r\n                      || contract_name\r\n                      || '#'\r\n                      || channel\r\n                      || '#'\r\n                      || channel_desc\r\n                      || '#'\r\n                      || product_code_internal\r\n                      || '#'\r\n                      || product_code\r\n                      || '#'\r\n                      || product_name\r\n                      || '#'\r\n                      || product_group\r\n                      || '#'\r\n                      || customer_id_internal\r\n                      || '#'\r\n                      || customer_number\r\n                      || '#'\r\n                      || auth_limit_amount\r\n                      || '#'\r\n                      || date_open\r\n                      || '#'\r\n                      || date_activate\r\n                      || '#'\r\n                      || date_expire\r\n                      || '#'\r\n                      || last_billing_date\r\n                      || '#'\r\n                      || next_billing_date\r\n                      || '#'\r\n                      || card_expire\r\n                      || '#'\r\n                      || contract_status\r\n                      || '#'\r\n                      || contract_status_name\r\n                      || '#'\r\n                      || tr_first_nam\r\n                      || '#'\r\n                      || tr_last_nam\r\n                      || '#'\r\n                      || cycle_length\r\n                      || '#'\r\n                      || interval_type\r\n                      || '#'\r\n                      || is_ready\r\n                      || '#'\r\n                      || billing_contract\r\n                      || '#'\r\n                      || type_of_card\r\n                      || '#'\r\n                      || amnd_date\r\n                      || '#'\r\n                      || rbs_number\r\n                      || '#'\r\n                      || bpm_loan_id\r\n                      || '#'\r\n                      || card_sales_channel\r\n                      || '#'\r\n                      || add_info_01\r\n                      || '#'\r\n                      || add_info_02\r\n                      || '#'\r\n                      || add_info_03\r\n                      || '#'\r\n                      || add_info_04\r\n                      || '#'\r\n                      || close_date\r\n                      || '#'\r\n                      || bank_code\r\n                      || '#'\r\n                      || product_main_or_sub\r\n                      ) AS hash_diff\r\n    , card_id\r\n    , acnt_contract__id\r\n    , acnt_contract__oid\r\n    , liab_contract\r\n    , ccat\r\n    , branch\r\n    , contract_number\r\n    , contract_name\r\n    , channel\r\n    , channel_desc\r\n    , product_code_internal\r\n    , product_code\r\n    , product_name\r\n    , product_group\r\n    , customer_id_internal\r\n    , customer_number\r\n    , auth_limit_amount\r\n    , date_open\r\n    , date_activate\r\n    , date_expire\r\n    , last_billing_date\r\n    , next_billing_date\r\n    , card_expire\r\n    , contract_status\r\n    , contract_status_name\r\n    , tr_first_nam\r\n    , tr_last_nam\r\n    , cycle_length\r\n    , interval_type\r\n    , is_ready\r\n    , billing_contract\r\n    , type_of_card\r\n    , amnd_date\r\n    , rbs_number\r\n    , bpm_loan_id\r\n    , card_sales_channel\r\n    , add_info_01\r\n    , add_info_02\r\n    , add_info_03\r\n    , add_info_04\r\n    , close_date\r\n    , bank_code\r\n    , product_main_or_sub\r\n  FROM\r\n      dat_result\r\n)\r\nSELECT * FROM dat_hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int_way4__card.sql", "original_file_path": "models\\int\\daily\\int_way4__card.sql", "name": "int_way4__card", "alias": "int_way4__card", "checksum": {"name": "sha256", "checksum": "14546ba991c1f315a80679c33a9f9e3e00b90971c93bc6654b40880e3baa382f"}, "tags": ["pkg_daily"], "refs": [["stg_landing__card_add_data"], ["stg__card_acnt_contract_plus"], ["int_way4__contract"], ["stg_landing__card_f_i"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int_way4__card.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table"}, "created_at": 1685959752.7069776, "compiled_code": "\nWITH dat_card_activate_or_close AS (\n  SELECT\n      amend_date\n    , for_id\n    , current_value\n    , AMND_STATE\n    , CASE \n        WHEN current_value LIKE '%(Call Issuer) --> 00 (Card OK)%' \n          THEN ROW_NUMBER() OVER(PARTITION BY for_id ORDER BY amend_date) \n      END AS rn_active\n    , CASE \n        WHEN current_value LIKE '%-->%(Card Closed)%'\n          THEN ROW_NUMBER() OVER(PARTITION BY for_id ORDER BY amend_date DESC) \n      END AS rn_close\n    FROM\n      \"oracle_dgaworkzone\".staging.stg_landing__card_add_data\n    WHERE\n      (current_value LIKE '%(Call Issuer) --> 00 (Card OK)%'\n        OR current_value LIKE '%-->%(Card Closed)%')\n)\n, dat_result AS (\n  SELECT\n      a.etl_date\n    , a.id AS card_id\n    , a.acnt_contract__id\n    , a.acnt_contract__oid\n    , a.liab_contract\n    , a.ccat\n    , a.branch\n    , a.contract_number\n    , a.contract_name\n    , a.channel\n    , a.channel_desc\n    , a.product_code_internal\n    , a.product_code\n    , a.product_name\n    , a.product_group\n    , a.customer_id_internal\n    , a.customer_number\n    , decode(COALESCE(a.auth_limit_amount,0), 0, COALESCE(f.auth_limit_amount,0), COALESCE(a.auth_limit_amount,0)) AS auth_limit_amount\n    , a.date_open\n    , a.date_expire\n    , a.last_billing_date\n    , a.next_billing_date\n    , a.card_expire\n    , a.contract_status\n    , a.contract_status_name\n    , a.tr_first_nam\n    , a.tr_last_nam\n    , a.cycle_length\n    , a.interval_type\n    , a.is_ready\n    , a.billing_contract\n    , a.type_of_card\n    , a.amnd_date\n    , a.rbs_number\n    , a.bpm_loan_id\n    , a.card_sales_channel\n    , a.add_info_01\n    , a.add_info_02\n    , a.add_info_03\n    , a.add_info_04\n    , g.amend_date AS date_activate\n    , CASE\n        WHEN a.contract_status_name ='Card Closed' THEN gc.amend_date\n      END AS close_date\n    , fi.bank_code\n    , CASE WHEN a.product_name LIKE '% Sub %' THEN 'Sub' ELSE 'Main' END AS product_main_or_sub\n  FROM\n    \"oracle_dgaworkzone\".staging.stg__card_acnt_contract_plus a \n  LEFT JOIN \"oracle_dgaworkzone\".int.int_way4__contract f ON a.acnt_contract__oid = f.contract_id\n  LEFT JOIN dat_card_activate_or_close  g ON a.id = g.for_id AND g.rn_active = 1\n  LEFT JOIN dat_card_activate_or_close  gc ON a.id = gc.for_id AND gc.rn_close = 1 AND gc.AMND_STATE = 'A'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_f_i fi ON a.F_I = fi.ID AND fi.amnd_state='A'\n  WHERE\n    a.con_cat = 'C'\n    AND a.product_code NOT LIKE '%_REL_%'\n)\n, dat_hash AS (\n  SELECT\n      etl_date\n    , standard_hash(card_id\n                      || '#'\n                      || acnt_contract__id\n                      || '#'\n                      || acnt_contract__oid\n                      || '#'\n                      || liab_contract\n                      || '#'\n                      || ccat\n                      || '#'\n                      || branch\n                      || '#'\n                      || contract_number\n                      || '#'\n                      || contract_name\n                      || '#'\n                      || channel\n                      || '#'\n                      || channel_desc\n                      || '#'\n                      || product_code_internal\n                      || '#'\n                      || product_code\n                      || '#'\n                      || product_name\n                      || '#'\n                      || product_group\n                      || '#'\n                      || customer_id_internal\n                      || '#'\n                      || customer_number\n                      || '#'\n                      || auth_limit_amount\n                      || '#'\n                      || date_open\n                      || '#'\n                      || date_activate\n                      || '#'\n                      || date_expire\n                      || '#'\n                      || last_billing_date\n                      || '#'\n                      || next_billing_date\n                      || '#'\n                      || card_expire\n                      || '#'\n                      || contract_status\n                      || '#'\n                      || contract_status_name\n                      || '#'\n                      || tr_first_nam\n                      || '#'\n                      || tr_last_nam\n                      || '#'\n                      || cycle_length\n                      || '#'\n                      || interval_type\n                      || '#'\n                      || is_ready\n                      || '#'\n                      || billing_contract\n                      || '#'\n                      || type_of_card\n                      || '#'\n                      || amnd_date\n                      || '#'\n                      || rbs_number\n                      || '#'\n                      || bpm_loan_id\n                      || '#'\n                      || card_sales_channel\n                      || '#'\n                      || add_info_01\n                      || '#'\n                      || add_info_02\n                      || '#'\n                      || add_info_03\n                      || '#'\n                      || add_info_04\n                      || '#'\n                      || close_date\n                      || '#'\n                      || bank_code\n                      || '#'\n                      || product_main_or_sub\n                      ) AS hash_diff\n    , card_id\n    , acnt_contract__id\n    , acnt_contract__oid\n    , liab_contract\n    , ccat\n    , branch\n    , contract_number\n    , contract_name\n    , channel\n    , channel_desc\n    , product_code_internal\n    , product_code\n    , product_name\n    , product_group\n    , customer_id_internal\n    , customer_number\n    , auth_limit_amount\n    , date_open\n    , date_activate\n    , date_expire\n    , last_billing_date\n    , next_billing_date\n    , card_expire\n    , contract_status\n    , contract_status_name\n    , tr_first_nam\n    , tr_last_nam\n    , cycle_length\n    , interval_type\n    , is_ready\n    , billing_contract\n    , type_of_card\n    , amnd_date\n    , rbs_number\n    , bpm_loan_id\n    , card_sales_channel\n    , add_info_01\n    , add_info_02\n    , add_info_03\n    , add_info_04\n    , close_date\n    , bank_code\n    , product_main_or_sub\n  FROM\n      dat_result\n)\nSELECT * FROM dat_hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_way4__card"}, "model.dga_data_model.int_way4__client": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__card_client", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "client_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"id\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"casa_account_number\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"customer_register_number_original\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int_way4__client"], "unique_id": "model.dga_data_model.int_way4__client", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key = 'client_id',\r\n    post_hook=[ '{{ create_index_if_not_exists(this, \"id\")}}',\r\n                '{{ create_index_if_not_exists(this, \"casa_account_number\")}}',\r\n                '{{ create_index_if_not_exists(this, \"customer_register_number_original\")}}'\r\n              ]\r\n  )\r\n}}\r\nWITH client_w_dd_account_rn AS (\r\n  SELECT\r\n      a.client_id\r\n    , a.casa_account_number\r\n    , b.customer_number\r\n    , ROW_NUMBER() OVER(PARTITION BY a.client_id ORDER BY b.date_opened DESC, b.open_time DESC, b.account_number DESC) AS rn\r\n  FROM\r\n    {{ ref('stg_landing__card_acnt_contract')}} a\r\n  INNER JOIN {{ ref('stg_landing__demanddeposit_master001')}} b\r\n    ON a.casa_account_number = b.account_number\r\n  WHERE\r\n    a.amnd_state = 'A'\r\n    AND a.casa_account_number IS NOT NULL\r\n)\r\n, client_w_dd_account AS (\r\n  SELECT\r\n      client_id\r\n    , casa_account_number\r\n    , customer_number\r\n  FROM\r\n    client_w_dd_account_rn\r\n  WHERE\r\n    rn = 1\r\n)\r\n, client_w_customer_number AS (\r\n  SELECT\r\n      a.amnd_date\r\n    , a.id\r\n    , COALESCE(b.customer_number, e.customer_number, C.customer_number, d.customer_number) AS customer_number\r\n    , a.branch_code\r\n    , a.ccat\r\n    , a.customer_shortname\r\n    , a.birth_date\r\n    , a.customer_register_number_original\r\n    , a.customer_register_number\r\n    , a.customer_code_original\r\n    , a.customer_code\r\n    , a.country\r\n    , a.city\r\n    , a.address_line_1\r\n    , a.address_line_2\r\n    , a.phone_mobile\r\n    , a.e_mail\r\n    , a.date_open\r\n    , e.casa_account_number\r\n  FROM\r\n    {{ ref('stg_landing__card_client')}}         a\r\n  LEFT JOIN {{ref('int__customer')}} b ON a.customer_code = b.customer_number\r\n  LEFT JOIN {{ref('int__customer')}} c \r\n    ON a.customer_register_number = c.customer_register_number\r\n      AND trunc(a.birth_date) = trunc(c.date_of_birth)\r\n  LEFT JOIN {{ref('int__customer')}} d\r\n    ON a.customer_register_number = d.tax_code_final\r\n    AND trunc(a.birth_date) = trunc(d.date_of_birth)\r\n  LEFT JOIN client_w_dd_account e ON a.id = e.client_id\r\n  WHERE\r\n    amnd_state = 'A'\r\n)\r\n, client_w_customer_number_rn AS (\r\n  SELECT\r\n      a.*\r\n    , ROW_NUMBER() OVER(PARTITION BY a.id ORDER BY a.customer_number DESC ) AS rn\r\n  FROM\r\n    client_w_customer_number a\r\n)\r\n, client AS (\r\n  SELECT\r\n      to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\n    , amnd_date\r\n    , id\r\n    , customer_number\r\n    , branch_code\r\n    , ccat\r\n    , customer_shortname\r\n    , birth_date\r\n    , customer_register_number_original\r\n    , customer_register_number\r\n    , customer_code_original\r\n    , customer_code\r\n    , country\r\n    , city\r\n    , address_line_1\r\n    , address_line_2\r\n    , phone_mobile\r\n    , e_mail\r\n    , date_open\r\n    , casa_account_number\r\n  FROM\r\n    client_w_customer_number_rn\r\n  WHERE\r\n    rn = 1\r\n) \r\n  SELECT * FROM client", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int_way4__client.sql", "original_file_path": "models\\int\\daily\\int_way4__client.sql", "name": "int_way4__client", "alias": "int_way4__client", "checksum": {"name": "sha256", "checksum": "296ee92fee70a6b74c4c16ba470de4724a67393e3308f6477371808c7f539397"}, "tags": ["pkg_daily"], "refs": [["stg_landing__card_acnt_contract"], ["stg_landing__demanddeposit_master001"], ["stg_landing__card_client"], ["int__customer"], ["int__customer"], ["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int_way4__client.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "unique_key": "client_id", "post-hook": ["{{ create_index_if_not_exists(this, \"id\")}}", "{{ create_index_if_not_exists(this, \"casa_account_number\")}}", "{{ create_index_if_not_exists(this, \"customer_register_number_original\")}}"]}, "created_at": 1685959752.7119787, "compiled_code": "\nWITH client_w_dd_account_rn AS (\n  SELECT\n      a.client_id\n    , a.casa_account_number\n    , b.customer_number\n    , ROW_NUMBER() OVER(PARTITION BY a.client_id ORDER BY b.date_opened DESC, b.open_time DESC, b.account_number DESC) AS rn\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract a\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master001 b\n    ON a.casa_account_number = b.account_number\n  WHERE\n    a.amnd_state = 'A'\n    AND a.casa_account_number IS NOT NULL\n)\n, client_w_dd_account AS (\n  SELECT\n      client_id\n    , casa_account_number\n    , customer_number\n  FROM\n    client_w_dd_account_rn\n  WHERE\n    rn = 1\n)\n, client_w_customer_number AS (\n  SELECT\n      a.amnd_date\n    , a.id\n    , COALESCE(b.customer_number, e.customer_number, C.customer_number, d.customer_number) AS customer_number\n    , a.branch_code\n    , a.ccat\n    , a.customer_shortname\n    , a.birth_date\n    , a.customer_register_number_original\n    , a.customer_register_number\n    , a.customer_code_original\n    , a.customer_code\n    , a.country\n    , a.city\n    , a.address_line_1\n    , a.address_line_2\n    , a.phone_mobile\n    , a.e_mail\n    , a.date_open\n    , e.casa_account_number\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_client         a\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__customer b ON a.customer_code = b.customer_number\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__customer c \n    ON a.customer_register_number = c.customer_register_number\n      AND trunc(a.birth_date) = trunc(c.date_of_birth)\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__customer d\n    ON a.customer_register_number = d.tax_code_final\n    AND trunc(a.birth_date) = trunc(d.date_of_birth)\n  LEFT JOIN client_w_dd_account e ON a.id = e.client_id\n  WHERE\n    amnd_state = 'A'\n)\n, client_w_customer_number_rn AS (\n  SELECT\n      a.*\n    , ROW_NUMBER() OVER(PARTITION BY a.id ORDER BY a.customer_number DESC ) AS rn\n  FROM\n    client_w_customer_number a\n)\n, client AS (\n  SELECT\n      to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\n    , amnd_date\n    , id\n    , customer_number\n    , branch_code\n    , ccat\n    , customer_shortname\n    , birth_date\n    , customer_register_number_original\n    , customer_register_number\n    , customer_code_original\n    , customer_code\n    , country\n    , city\n    , address_line_1\n    , address_line_2\n    , phone_mobile\n    , e_mail\n    , date_open\n    , casa_account_number\n  FROM\n    client_w_customer_number_rn\n  WHERE\n    rn = 1\n) \n  SELECT * FROM client", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_way4__client"}, "model.dga_data_model.int_way4__contract": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.stg__card_acnt_contract_plus"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "contract_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"contract_id\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"contract_id\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"customer_number\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int_way4__contract"], "unique_id": "model.dga_data_model.int_way4__contract", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key = 'contract_id',\r\n    post_hook=['{{ create_index_if_not_exists(this, \"contract_id\")}}',\r\n                '{{ create_index_if_not_exists(this, \"contract_id\")}}',\r\n                '{{ create_index_if_not_exists(this, \"customer_number\")}}',\r\n              ]\r\n  )\r\n}}\r\nWITH dat_result AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.id AS contract_id\r\n    , a.acnt_contract__id\r\n    , a.acnt_contract__oid\r\n    , a.liab_contract\r\n    , a.ccat\r\n    , a.branch\r\n    , a.contract_number\r\n    , a.contract_name\r\n    , a.channel\r\n    , a.channel_desc\r\n    , a.product_code_internal\r\n    , a.product_code\r\n    , a.product_name\r\n    , a.product_group\r\n    , a.customer_id_internal\r\n    , a.customer_number\r\n    , a.auth_limit_amount\r\n    , a.date_open\r\n    , a.date_expire\r\n    , a.last_billing_date\r\n    , a.next_billing_date\r\n    , a.contract_status\r\n    , a.contract_status_name\r\n    , a.tr_first_nam\r\n    , a.tr_last_nam\r\n    , a.cycle_length\r\n    , a.interval_type\r\n    , a.is_ready\r\n    , a.billing_contract\r\n    , a.amnd_date\r\n    , a.rbs_number\r\n    , a.bpm_loan_id\r\n    , a.card_sales_channel\r\n    , a.add_info_01\r\n    , a.add_info_02\r\n    , a.add_info_03\r\n    , a.add_info_04\r\n    , a.los_id\r\n    , a.type_of_contract AS type_of_card\r\n  FROM\r\n    {{ ref('stg__card_acnt_contract_plus')}} a\r\n  WHERE\r\n    a.con_cat = 'A'\r\n)\r\n, dat_cj_liab_contract AS (\r\n  SELECT DISTINCT\r\n    liab_contract\r\n  FROM\r\n    dat_result\r\n  WHERE\r\n    contract_number LIKE '%-O-%'\r\n    OR contract_number LIKE '%-W-%'\r\n    OR contract_number LIKE '%-B-%' \r\n)\r\n, dat_cj_liab_contract_w_los_id AS (\r\n  SELECT\r\n      a.liab_contract\r\n    , b.los_id\r\n    , b.bpm_loan_id\r\n  FROM\r\n    dat_cj_liab_contract a\r\n  LEFT JOIN dat_result b ON a.liab_contract = b.contract_id\r\n)\r\n, dat_hash AS (\r\n  SELECT\r\n      a.etl_date\r\n    , standard_hash(a.contract_id\r\n                      || '#'\r\n                      || a.acnt_contract__id\r\n                      || '#'\r\n                      || a.acnt_contract__oid\r\n                      || '#'\r\n                      || a.liab_contract\r\n                      || '#'\r\n                      || a.ccat\r\n                      || '#'\r\n                      || a.branch\r\n                      || '#'\r\n                      || a.contract_number\r\n                      || '#'\r\n                      || a.contract_name\r\n                      || '#'\r\n                      || a.channel\r\n                      || '#'\r\n                      || a.channel_desc\r\n                      || '#'\r\n                      || a.product_code_internal\r\n                      || '#'\r\n                      || a.product_code\r\n                      || '#'\r\n                      || a.product_name\r\n                      || '#'\r\n                      || a.product_group\r\n                      || '#'\r\n                      || a.customer_id_internal\r\n                      || '#'\r\n                      || a.customer_number\r\n                      || '#'\r\n                      || a.auth_limit_amount\r\n                      || '#'\r\n                      || a.date_open\r\n                      || '#'\r\n                      || a.date_expire\r\n                      || '#'\r\n                      || a.last_billing_date\r\n                      || '#'\r\n                      || a.next_billing_date\r\n                      || '#'\r\n                      || a.contract_status\r\n                      || '#'\r\n                      || a.contract_status_name\r\n                      || '#'\r\n                      || a.tr_first_nam\r\n                      || '#'\r\n                      || a.tr_last_nam\r\n                      || '#'\r\n                      || a.cycle_length\r\n                      || '#'\r\n                      || a.interval_type\r\n                      || '#'\r\n                      || a.is_ready\r\n                      || '#'\r\n                      || a.billing_contract\r\n                      || '#'\r\n                      || a.amnd_date\r\n                      || '#'\r\n                      || a.rbs_number\r\n                      || '#'\r\n                      || b.bpm_loan_id\r\n                      || '#'\r\n                      || a.card_sales_channel\r\n                      || '#'\r\n                      || a.add_info_01\r\n                      || '#'\r\n                      || a.add_info_02\r\n                      || '#'\r\n                      || a.add_info_03\r\n                      || '#'\r\n                      || a.add_info_04\r\n                      || '#'\r\n                      || a.type_of_card\r\n                      ) AS hash_diff\r\n    , a.contract_id\r\n    , a.acnt_contract__id\r\n    , a.acnt_contract__oid\r\n    , a.liab_contract\r\n    , a.ccat\r\n    , a.branch\r\n    , a.contract_number\r\n    , a.contract_name\r\n    , a.channel\r\n    , a.channel_desc\r\n    , a.product_code_internal\r\n    , a.product_code\r\n    , a.product_name\r\n    , a.product_group\r\n    , a.customer_id_internal\r\n    , a.customer_number\r\n    , a.auth_limit_amount\r\n    , a.date_open\r\n    , a.date_expire\r\n    , a.last_billing_date\r\n    , a.next_billing_date\r\n    , a.contract_status\r\n    , a.contract_status_name\r\n    , a.tr_first_nam\r\n    , a.tr_last_nam\r\n    , a.cycle_length\r\n    , a.interval_type\r\n    , a.is_ready\r\n    , a.billing_contract\r\n    , a.amnd_date\r\n    , a.rbs_number\r\n    , b.bpm_loan_id\r\n    , a.card_sales_channel\r\n    , a.add_info_01\r\n    , a.add_info_02\r\n    , a.add_info_03\r\n    , a.add_info_04\r\n    , b.los_id\r\n    , a.type_of_card\r\n  FROM\r\n    dat_result a\r\n  LEFT JOIN dat_cj_liab_contract_w_los_id b ON a.liab_contract = b.liab_contract\r\n)\r\nSELECT * FROM dat_hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int_way4__contract.sql", "original_file_path": "models\\int\\daily\\int_way4__contract.sql", "name": "int_way4__contract", "alias": "int_way4__contract", "checksum": {"name": "sha256", "checksum": "f45070536adb6c36b6469a284b3a60566e0a28b67625c04ce2e25dd4fbd4777e"}, "tags": ["pkg_daily"], "refs": [["stg__card_acnt_contract_plus"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int_way4__contract.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "unique_key": "contract_id", "post-hook": ["{{ create_index_if_not_exists(this, \"contract_id\")}}", "{{ create_index_if_not_exists(this, \"contract_id\")}}", "{{ create_index_if_not_exists(this, \"customer_number\")}}"]}, "created_at": 1685959752.717983, "compiled_code": "\nWITH dat_result AS (\n  SELECT\n      a.etl_date\n    , a.id AS contract_id\n    , a.acnt_contract__id\n    , a.acnt_contract__oid\n    , a.liab_contract\n    , a.ccat\n    , a.branch\n    , a.contract_number\n    , a.contract_name\n    , a.channel\n    , a.channel_desc\n    , a.product_code_internal\n    , a.product_code\n    , a.product_name\n    , a.product_group\n    , a.customer_id_internal\n    , a.customer_number\n    , a.auth_limit_amount\n    , a.date_open\n    , a.date_expire\n    , a.last_billing_date\n    , a.next_billing_date\n    , a.contract_status\n    , a.contract_status_name\n    , a.tr_first_nam\n    , a.tr_last_nam\n    , a.cycle_length\n    , a.interval_type\n    , a.is_ready\n    , a.billing_contract\n    , a.amnd_date\n    , a.rbs_number\n    , a.bpm_loan_id\n    , a.card_sales_channel\n    , a.add_info_01\n    , a.add_info_02\n    , a.add_info_03\n    , a.add_info_04\n    , a.los_id\n    , a.type_of_contract AS type_of_card\n  FROM\n    \"oracle_dgaworkzone\".staging.stg__card_acnt_contract_plus a\n  WHERE\n    a.con_cat = 'A'\n)\n, dat_cj_liab_contract AS (\n  SELECT DISTINCT\n    liab_contract\n  FROM\n    dat_result\n  WHERE\n    contract_number LIKE '%-O-%'\n    OR contract_number LIKE '%-W-%'\n    OR contract_number LIKE '%-B-%' \n)\n, dat_cj_liab_contract_w_los_id AS (\n  SELECT\n      a.liab_contract\n    , b.los_id\n    , b.bpm_loan_id\n  FROM\n    dat_cj_liab_contract a\n  LEFT JOIN dat_result b ON a.liab_contract = b.contract_id\n)\n, dat_hash AS (\n  SELECT\n      a.etl_date\n    , standard_hash(a.contract_id\n                      || '#'\n                      || a.acnt_contract__id\n                      || '#'\n                      || a.acnt_contract__oid\n                      || '#'\n                      || a.liab_contract\n                      || '#'\n                      || a.ccat\n                      || '#'\n                      || a.branch\n                      || '#'\n                      || a.contract_number\n                      || '#'\n                      || a.contract_name\n                      || '#'\n                      || a.channel\n                      || '#'\n                      || a.channel_desc\n                      || '#'\n                      || a.product_code_internal\n                      || '#'\n                      || a.product_code\n                      || '#'\n                      || a.product_name\n                      || '#'\n                      || a.product_group\n                      || '#'\n                      || a.customer_id_internal\n                      || '#'\n                      || a.customer_number\n                      || '#'\n                      || a.auth_limit_amount\n                      || '#'\n                      || a.date_open\n                      || '#'\n                      || a.date_expire\n                      || '#'\n                      || a.last_billing_date\n                      || '#'\n                      || a.next_billing_date\n                      || '#'\n                      || a.contract_status\n                      || '#'\n                      || a.contract_status_name\n                      || '#'\n                      || a.tr_first_nam\n                      || '#'\n                      || a.tr_last_nam\n                      || '#'\n                      || a.cycle_length\n                      || '#'\n                      || a.interval_type\n                      || '#'\n                      || a.is_ready\n                      || '#'\n                      || a.billing_contract\n                      || '#'\n                      || a.amnd_date\n                      || '#'\n                      || a.rbs_number\n                      || '#'\n                      || b.bpm_loan_id\n                      || '#'\n                      || a.card_sales_channel\n                      || '#'\n                      || a.add_info_01\n                      || '#'\n                      || a.add_info_02\n                      || '#'\n                      || a.add_info_03\n                      || '#'\n                      || a.add_info_04\n                      || '#'\n                      || a.type_of_card\n                      ) AS hash_diff\n    , a.contract_id\n    , a.acnt_contract__id\n    , a.acnt_contract__oid\n    , a.liab_contract\n    , a.ccat\n    , a.branch\n    , a.contract_number\n    , a.contract_name\n    , a.channel\n    , a.channel_desc\n    , a.product_code_internal\n    , a.product_code\n    , a.product_name\n    , a.product_group\n    , a.customer_id_internal\n    , a.customer_number\n    , a.auth_limit_amount\n    , a.date_open\n    , a.date_expire\n    , a.last_billing_date\n    , a.next_billing_date\n    , a.contract_status\n    , a.contract_status_name\n    , a.tr_first_nam\n    , a.tr_last_nam\n    , a.cycle_length\n    , a.interval_type\n    , a.is_ready\n    , a.billing_contract\n    , a.amnd_date\n    , a.rbs_number\n    , b.bpm_loan_id\n    , a.card_sales_channel\n    , a.add_info_01\n    , a.add_info_02\n    , a.add_info_03\n    , a.add_info_04\n    , b.los_id\n    , a.type_of_card\n  FROM\n    dat_result a\n  LEFT JOIN dat_cj_liab_contract_w_los_id b ON a.liab_contract = b.liab_contract\n)\nSELECT * FROM dat_hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_way4__contract"}, "model.dga_data_model.int__arrangement": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.stg_landing__bc_user_info", "model.dga_data_model.int__casa_account", "model.dga_data_model.int__casa_account", "model.dga_data_model.int_way4__card", "model.dga_data_model.int_way4__card", "model.dga_data_model.stg_landing__loan_master002", "model.dga_data_model.int__fd_account", "model.dga_data_model.stg_landing__fixeddeposit_master002"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "account_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"unq_id\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"open_date\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"account_number\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"customer_number\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int__arrangement"], "unique_id": "model.dga_data_model.int__arrangement", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key = 'account_number',\r\n    post_hook=['{{ create_index_if_not_exists(this, \"unq_id\")}}',\r\n                '{{ create_index_if_not_exists(this, \"open_date\")}}',\r\n                '{{ create_index_if_not_exists(this, \"account_number\")}}',\r\n                '{{ create_index_if_not_exists(this, \"customer_number\")}}'\r\n              ]\r\n  )\r\n}}\r\nWITH dat_ibmb_rn AS (\r\n  SELECT\r\n      etl_date\r\n    , customer_number\r\n    , user_id\r\n    , to_number(to_char(create_time, 'YYYYMMDD')) AS open_date\r\n    , CASE\r\n        WHEN open_ibs = 'Y' AND open_mbs = 'Y' THEN 'IBMB'\r\n        WHEN open_ibs = 'Y' AND ( open_mbs = 'N' OR open_mbs IS NULL ) THEN 'IB'\r\n        WHEN ( open_ibs = 'N' OR open_ibs IS NULL ) AND open_mbs = 'Y' THEN 'MB'\r\n        END AS product_code\r\n    , ROW_NUMBER() OVER(PARTITION BY customer_number ORDER BY create_time DESC, user_id DESC ) AS rn\r\n  FROM\r\n    {{ ref('stg_landing__bc_user_info')}}\r\n  WHERE\r\n    create_time IS NOT NULL\r\n), dat_ibmb AS (\r\n  SELECT\r\n      etl_date\r\n    , 'IBMB' AS module\r\n    , customer_number\r\n    , user_id AS account_number\r\n    , product_code\r\n    , open_date\r\n    , NULL AS activate_date\r\n  FROM\r\n    dat_ibmb_rn\r\n  WHERE\r\n    rn = 1\r\n)\r\nSELECT\r\n    etl_date\r\n  , standard_hash(module|| '#'|| customer_number|| '#'|| account_number|| '#'|| product_code|| '#'\r\n                  || open_date|| '#'|| activate_date\r\n    ) AS hash_diff\r\n  , module\r\n  , customer_number\r\n  , account_number\r\n  , product_code\r\n  , open_date\r\n  , activate_date\r\n  , NULL AS maturity_date\r\n  , module|| '#'|| customer_number|| '#'|| account_number AS unq_id\r\nFROM\r\n  dat_ibmb\r\nUNION ALL\r\nSELECT\r\n    etl_date\r\n  , standard_hash('CASA' || '#' || customer_number || '#' || account_number || '#' || product_code || '#' || open_date\r\n                    || '#' || NULL\r\n    ) AS hash_diff\r\n  , 'CASA' AS module\r\n  , customer_number\r\n  , account_number\r\n  , product_code\r\n  , open_date\r\n  , NULL AS activate_date\r\n  , NULL AS maturity_date\r\n  , 'CASA' || '#' || customer_number || '#' || account_number AS unq_id\r\nFROM\r\n  {{ ref('int__casa_account') }}\r\nUNION ALL\r\nSELECT\r\n    etl_date\r\n  , standard_hash('OD' || '#' || customer_number || '#' || account_number || '#'|| product_code|| '#'|| od_agreement_date_original\r\n                    || '#'|| NULL  || '#' || od_expiration_date_current\r\n    ) AS hash_diff\r\n  , 'OD' AS module\r\n  , customer_number\r\n  , account_number\r\n  , product_code\r\n  , od_agreement_date_original AS open_date\r\n  , NULL AS activate_date\r\n  , od_expiration_date_current AS maturity_date\r\n  , 'OD' || '#' || customer_number || '#' || account_number AS unq_id\r\nFROM\r\n  {{ ref('int__casa_account') }}\r\nWHERE\r\n  od_agreement_date_original IS NOT NULL\r\nUNION ALL\r\nSELECT\r\n    etl_date\r\n  , standard_hash('CC' || '#' || customer_number || '#'|| card_id|| '#' || product_code|| '#'\r\n                    || to_number(to_char(date_open, 'YYYYMMDD')) || '#'\r\n                    || to_number(to_char(date_activate, 'YYYYMMDD')) || '#'\r\n                    || to_number(to_char(to_date(card_expire , 'YYMM'), 'YYYYMMDD'))\r\n    ) AS hash_diff\r\n  , 'CC' AS module\r\n  , customer_number\r\n  , card_id AS account_number\r\n  , product_code AS product_code\r\n  , to_number(to_char(date_open, 'YYYYMMDD')) AS open_date\r\n  , to_number(to_char(date_activate, 'YYYYMMDD')) AS activate_date\r\n  , to_number(to_char(to_date(card_expire, 'YYMM'), 'YYYYMMDD')) AS maturity_date\r\n  , 'CC' || '#' || customer_number || '#'|| card_id AS unq_id\r\nFROM\r\n  {{ ref('int_way4__card')}}\r\nWHERE\r\n  type_of_card = 'CREDIT_CARD'\r\nUNION ALL\r\nSELECT\r\n    etl_date\r\n  , standard_hash('DC' || '#' || customer_number || '#'|| card_id|| '#' || product_code|| '#'\r\n                    || to_number(to_char(date_open, 'YYYYMMDD')) || '#'\r\n                    || to_number(to_char(date_activate, 'YYYYMMDD')) || '#'\r\n                    || to_number(to_char(to_date(card_expire DEFAULT null ON CONVERSION ERROR, 'YYMM'), 'YYYYMMDD'))\r\n    ) AS hash_diff\r\n  , 'DC' AS module\r\n  , customer_number\r\n  , card_id AS account_number\r\n  , product_code AS product_code\r\n  , to_number(to_char(date_open, 'YYYYMMDD')) AS open_date\r\n  , to_number(to_char(date_activate, 'YYYYMMDD')) AS activate_date\r\n  , to_number(to_char(to_date(card_expire DEFAULT null ON CONVERSION ERROR, 'YYMM'), 'YYYYMMDD')) AS maturity_date\r\n  , 'DC' || '#' || customer_number || '#'|| card_id AS unq_id\r\nFROM\r\n  {{ ref('int_way4__card')}}\r\nWHERE\r\n  type_of_card = 'DEBIT_CARD'\r\nUNION ALL\r\nSELECT\r\n    etl_date\r\n  , standard_hash('LN'|| '#'|| customer_number|| '#'|| account_number|| '#'|| product_code|| '#'\r\n                    || to_number(to_char(to_date(original_loan_date2, 'YYYYDDD'), 'YYYYMMDD'))|| '#'|| NULL || '#'\r\n                    || to_number(to_char(to_date(maturity_date, 'YYYYDDD'), 'YYYYMMDD'))\r\n    ) AS hash_diff\r\n  , 'LN' AS module\r\n  , customer_number\r\n  , account_number\r\n  , loan_type AS product_code\r\n  , to_number(to_char(to_date(original_loan_date2, 'YYYYDDD'), 'YYYYMMDD')) AS open_date\r\n  , NULL AS activate_date\r\n  , to_number(to_char(to_date(maturity_date, 'YYYYDDD'), 'YYYYMMDD')) AS maturity_date\r\n  , 'LN'|| '#'|| customer_number|| '#'|| account_number AS unq_id\r\nFROM\r\n  {{ ref('stg_landing__loan_master002')}}\r\nUNION ALL\r\nSELECT\r\n    a.etl_date\r\n  , standard_hash('FD'|| '#'|| a.customer_number|| '#'|| a.account_number|| '#'|| a.product_code|| '#'\r\n                    || a.open_date|| '#'|| NULL || '#'\r\n                    || to_number(to_char(to_date(b.redemption_date DEFAULT null ON CONVERSION ERROR, 'YYYYDDD'), 'YYYYMMDD'))\r\n    ) AS hash_diff\r\n  , 'FD' AS module\r\n  , a.customer_number\r\n  , a.account_number\r\n  , a.product_code\r\n  , a.open_date\r\n  , NULL AS activate_date\r\n  , to_number(to_char(to_date(b.redemption_date DEFAULT null ON CONVERSION ERROR, 'YYYYDDD'), 'YYYYMMDD')) AS maturity_date\r\n  , 'FD'|| '#'|| a.customer_number|| '#'|| a.account_number AS unq_id\r\nFROM\r\n  {{ ref('int__fd_account')}} a\r\n  LEFT JOIN {{ ref('stg_landing__fixeddeposit_master002')}} b ON a.account_number = b.account_no\r\n                                                      AND b.rec_current_ind = 'Y'", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int__arrangement.sql", "original_file_path": "models\\int\\daily\\int__arrangement.sql", "name": "int__arrangement", "alias": "int__arrangement", "checksum": {"name": "sha256", "checksum": "858ea3c46a38738c97a6b518bb1029074061c08e7eb30c16356b7e730c704ad0"}, "tags": ["pkg_daily"], "refs": [["stg_landing__bc_user_info"], ["int__casa_account"], ["int__casa_account"], ["int_way4__card"], ["int_way4__card"], ["stg_landing__loan_master002"], ["int__fd_account"], ["stg_landing__fixeddeposit_master002"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int__arrangement.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "unique_key": "account_number", "post-hook": ["{{ create_index_if_not_exists(this, \"unq_id\")}}", "{{ create_index_if_not_exists(this, \"open_date\")}}", "{{ create_index_if_not_exists(this, \"account_number\")}}", "{{ create_index_if_not_exists(this, \"customer_number\")}}"]}, "created_at": 1685959752.6849816, "compiled_code": "\nWITH dat_ibmb_rn AS (\n  SELECT\n      etl_date\n    , customer_number\n    , user_id\n    , to_number(to_char(create_time, 'YYYYMMDD')) AS open_date\n    , CASE\n        WHEN open_ibs = 'Y' AND open_mbs = 'Y' THEN 'IBMB'\n        WHEN open_ibs = 'Y' AND ( open_mbs = 'N' OR open_mbs IS NULL ) THEN 'IB'\n        WHEN ( open_ibs = 'N' OR open_ibs IS NULL ) AND open_mbs = 'Y' THEN 'MB'\n        END AS product_code\n    , ROW_NUMBER() OVER(PARTITION BY customer_number ORDER BY create_time DESC, user_id DESC ) AS rn\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__bc_user_info\n  WHERE\n    create_time IS NOT NULL\n), dat_ibmb AS (\n  SELECT\n      etl_date\n    , 'IBMB' AS module\n    , customer_number\n    , user_id AS account_number\n    , product_code\n    , open_date\n    , NULL AS activate_date\n  FROM\n    dat_ibmb_rn\n  WHERE\n    rn = 1\n)\nSELECT\n    etl_date\n  , standard_hash(module|| '#'|| customer_number|| '#'|| account_number|| '#'|| product_code|| '#'\n                  || open_date|| '#'|| activate_date\n    ) AS hash_diff\n  , module\n  , customer_number\n  , account_number\n  , product_code\n  , open_date\n  , activate_date\n  , NULL AS maturity_date\n  , module|| '#'|| customer_number|| '#'|| account_number AS unq_id\nFROM\n  dat_ibmb\nUNION ALL\nSELECT\n    etl_date\n  , standard_hash('CASA' || '#' || customer_number || '#' || account_number || '#' || product_code || '#' || open_date\n                    || '#' || NULL\n    ) AS hash_diff\n  , 'CASA' AS module\n  , customer_number\n  , account_number\n  , product_code\n  , open_date\n  , NULL AS activate_date\n  , NULL AS maturity_date\n  , 'CASA' || '#' || customer_number || '#' || account_number AS unq_id\nFROM\n  \"oracle_dgaworkzone\".int.int__casa_account\nUNION ALL\nSELECT\n    etl_date\n  , standard_hash('OD' || '#' || customer_number || '#' || account_number || '#'|| product_code|| '#'|| od_agreement_date_original\n                    || '#'|| NULL  || '#' || od_expiration_date_current\n    ) AS hash_diff\n  , 'OD' AS module\n  , customer_number\n  , account_number\n  , product_code\n  , od_agreement_date_original AS open_date\n  , NULL AS activate_date\n  , od_expiration_date_current AS maturity_date\n  , 'OD' || '#' || customer_number || '#' || account_number AS unq_id\nFROM\n  \"oracle_dgaworkzone\".int.int__casa_account\nWHERE\n  od_agreement_date_original IS NOT NULL\nUNION ALL\nSELECT\n    etl_date\n  , standard_hash('CC' || '#' || customer_number || '#'|| card_id|| '#' || product_code|| '#'\n                    || to_number(to_char(date_open, 'YYYYMMDD')) || '#'\n                    || to_number(to_char(date_activate, 'YYYYMMDD')) || '#'\n                    || to_number(to_char(to_date(card_expire , 'YYMM'), 'YYYYMMDD'))\n    ) AS hash_diff\n  , 'CC' AS module\n  , customer_number\n  , card_id AS account_number\n  , product_code AS product_code\n  , to_number(to_char(date_open, 'YYYYMMDD')) AS open_date\n  , to_number(to_char(date_activate, 'YYYYMMDD')) AS activate_date\n  , to_number(to_char(to_date(card_expire, 'YYMM'), 'YYYYMMDD')) AS maturity_date\n  , 'CC' || '#' || customer_number || '#'|| card_id AS unq_id\nFROM\n  \"oracle_dgaworkzone\".int.int_way4__card\nWHERE\n  type_of_card = 'CREDIT_CARD'\nUNION ALL\nSELECT\n    etl_date\n  , standard_hash('DC' || '#' || customer_number || '#'|| card_id|| '#' || product_code|| '#'\n                    || to_number(to_char(date_open, 'YYYYMMDD')) || '#'\n                    || to_number(to_char(date_activate, 'YYYYMMDD')) || '#'\n                    || to_number(to_char(to_date(card_expire DEFAULT null ON CONVERSION ERROR, 'YYMM'), 'YYYYMMDD'))\n    ) AS hash_diff\n  , 'DC' AS module\n  , customer_number\n  , card_id AS account_number\n  , product_code AS product_code\n  , to_number(to_char(date_open, 'YYYYMMDD')) AS open_date\n  , to_number(to_char(date_activate, 'YYYYMMDD')) AS activate_date\n  , to_number(to_char(to_date(card_expire DEFAULT null ON CONVERSION ERROR, 'YYMM'), 'YYYYMMDD')) AS maturity_date\n  , 'DC' || '#' || customer_number || '#'|| card_id AS unq_id\nFROM\n  \"oracle_dgaworkzone\".int.int_way4__card\nWHERE\n  type_of_card = 'DEBIT_CARD'\nUNION ALL\nSELECT\n    etl_date\n  , standard_hash('LN'|| '#'|| customer_number|| '#'|| account_number|| '#'|| product_code|| '#'\n                    || to_number(to_char(to_date(original_loan_date2, 'YYYYDDD'), 'YYYYMMDD'))|| '#'|| NULL || '#'\n                    || to_number(to_char(to_date(maturity_date, 'YYYYDDD'), 'YYYYMMDD'))\n    ) AS hash_diff\n  , 'LN' AS module\n  , customer_number\n  , account_number\n  , loan_type AS product_code\n  , to_number(to_char(to_date(original_loan_date2, 'YYYYDDD'), 'YYYYMMDD')) AS open_date\n  , NULL AS activate_date\n  , to_number(to_char(to_date(maturity_date, 'YYYYDDD'), 'YYYYMMDD')) AS maturity_date\n  , 'LN'|| '#'|| customer_number|| '#'|| account_number AS unq_id\nFROM\n  \"oracle_dgaworkzone\".staging.stg_landing__loan_master002\nUNION ALL\nSELECT\n    a.etl_date\n  , standard_hash('FD'|| '#'|| a.customer_number|| '#'|| a.account_number|| '#'|| a.product_code|| '#'\n                    || a.open_date|| '#'|| NULL || '#'\n                    || to_number(to_char(to_date(b.redemption_date DEFAULT null ON CONVERSION ERROR, 'YYYYDDD'), 'YYYYMMDD'))\n    ) AS hash_diff\n  , 'FD' AS module\n  , a.customer_number\n  , a.account_number\n  , a.product_code\n  , a.open_date\n  , NULL AS activate_date\n  , to_number(to_char(to_date(b.redemption_date DEFAULT null ON CONVERSION ERROR, 'YYYYDDD'), 'YYYYMMDD')) AS maturity_date\n  , 'FD'|| '#'|| a.customer_number|| '#'|| a.account_number AS unq_id\nFROM\n  \"oracle_dgaworkzone\".int.int__fd_account a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master002 b ON a.account_number = b.account_no\n                                                      AND b.rec_current_ind = 'Y'", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__arrangement"}, "model.dga_data_model.int__casa_account": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.stg_landing__overdraft_tier001", "model.dga_data_model.int__customer", "model.dga_data_model.stg_landing__jupiter_customer_temp", "model.dga_data_model.stg_landing__jupiter_cif_register_history", "model.dga_data_model.stg_landing__jupiter_account_register_hist", "model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "account_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"open_date\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"account_number\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"customer_number\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int__casa_account"], "unique_id": "model.dga_data_model.int__casa_account", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key = 'account_number',\r\n    post_hook=['{{ create_index_if_not_exists(this, \"open_date\")}}',\r\n                '{{ create_index_if_not_exists(this, \"account_number\")}}',\r\n                '{{ create_index_if_not_exists(this, \"customer_number\")}}',\r\n              ]\r\n  )\r\n}}\r\nWITH dat_all_account AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.customer_number\r\n    , a.account_number\r\n    , a.currency_type\r\n    , a.product_code\r\n    , a.account_name\r\n    , a.open_date\r\n    , a.open_time\r\n    , a.status\r\n    , a.status_date\r\n    , a.workstation_id\r\n    , a.user_id\r\n    , a.branch_code\r\n    , b.subbranch_no\r\n  FROM {{ ref('stg_landing__demanddeposit_master001')}} a\r\n  LEFT JOIN {{ ref('stg_landing__demanddeposit_master002')}} b ON a.account_number = b.account_no AND b.rec_current_ind = 'Y'\r\n)\r\n, dat_overdraft_rn AS (\r\n  SELECT\r\n      account_number\r\n    , rate AS od_rate\r\n    , rate_number AS od_reate_number\r\n    , MIN(agreement_date_7) OVER(PARTITION BY account_number) AS od_agreement_date_original\r\n    , MIN(expiration_date_7) OVER(PARTITION BY account_number) AS od_expiration_date_original\r\n    , agreement_date_7 AS od_agreement_date_current\r\n    , expiration_date_7 AS od_expiration_date_current\r\n    , authorized_limit AS od_authorized_limit\r\n    , draw_limit AS od_draw_limit\r\n    , ROW_NUMBER() OVER(PARTITION BY account_number ORDER BY expiration_date_7 DESC, agreement_date_7 DESC, sequence_number DESC ) AS rn\r\n  FROM\r\n    {{ ref('stg_landing__overdraft_tier001')}}\r\n)\r\n, dat_overdraft AS (\r\n  SELECT\r\n      account_number\r\n    , od_rate\r\n    , od_reate_number\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_agreement_date_original))  AS od_agreement_date_original\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_expiration_date_original)) AS od_expiration_date_original\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_agreement_date_current))   AS od_agreement_date_current\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_expiration_date_current))  AS od_expiration_date_current\r\n    , od_authorized_limit\r\n    , od_draw_limit\r\n  FROM\r\n    dat_overdraft_rn\r\n  WHERE\r\n    rn = 1\r\n)\r\n, dat_all_account_w_od_inf AS (\r\n  SELECT\r\n      a.*\r\n    , b.od_rate AS od_rate_current\r\n    , b.od_reate_number AS od_reate_number_current\r\n    , b.od_agreement_date_original\r\n    , b.od_expiration_date_original\r\n    , b.od_agreement_date_current\r\n    , b.od_expiration_date_current\r\n    , b.od_authorized_limit AS od_authorized_limit_current\r\n    , b.od_draw_limit AS od_draw_limit_current\r\n    , CASE\r\n        WHEN b.account_number IS NOT NULL \r\n          AND od_authorized_limit > 0\r\n          AND od_expiration_date_current > to_number(to_char(sysdate, 'YYYYDDD'))\r\n          AND status = 1 THEN 1\r\n        ELSE 0\r\n      END AS is_overdraft_current\r\n  FROM\r\n    dat_all_account a\r\n  LEFT JOIN dat_overdraft b ON a.account_number = b.account_number\r\n)\r\n, dat_all_account_final_w_source_customer AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.customer_number\r\n    , a.account_number\r\n    , a.currency_type\r\n    , a.product_code\r\n    , a.account_name\r\n    , a.open_date\r\n    , a.open_time\r\n    , a.status\r\n    , a.status_date\r\n    , a.workstation_id\r\n    , a.user_id\r\n    , a.branch_code\r\n    , a.subbranch_no\r\n    , a.od_rate_current\r\n    , a.od_reate_number_current\r\n    , a.od_agreement_date_original\r\n    , a.od_expiration_date_original\r\n    , a.od_agreement_date_current\r\n    , a.od_expiration_date_current\r\n    , a.od_authorized_limit_current\r\n    , a.od_draw_limit_current\r\n    , a.is_overdraft_current\r\n    , ROW_NUMBER() OVER(PARTITION BY a.customer_number ORDER BY a.open_date , a.open_time, a.account_number) AS rn\r\n    , b.source_customer\r\n    , b.division\r\n  FROM\r\n    dat_all_account_w_od_inf a\r\n  LEFT JOIN {{ ref('int__customer')}} b ON a.customer_number = b.customer_number\r\n)\r\n, sale_code AS (\r\n  SELECT\r\n    acc.account_number,\r\n    cif.sale_code,\r\n    is_number(regexp_substr(cif.sale_code, '[^|]+', 1, 1)) AS sale_code_clean\r\n  FROM\r\n    {{ ref('stg_landing__jupiter_customer_temp')}} cus\r\n    INNER JOIN {{ ref('stg_landing__jupiter_cif_register_history')}}  cif ON cus.cif_id = cif.id\r\n    INNER JOIN {{ ref('stg_landing__jupiter_account_register_hist')}} acc ON cus.account_id = acc.id\r\n  WHERE\r\n    acc.status = 'SUCC'\r\n    AND UPPER(checker) LIKE UPPER('EKYC')\r\n    AND UPPER(maker) LIKE UPPER('EKYC')\r\n)\r\n, dat_result_w_sale_code AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.customer_number\r\n    , a.account_number\r\n    , a.currency_type\r\n    , a.product_code\r\n    , a.account_name\r\n    , a.open_date\r\n    , a.open_time\r\n    , a.status\r\n    , a.status_date\r\n    , a.workstation_id\r\n    , a.user_id\r\n    , a.branch_code\r\n    , a.subbranch_no\r\n    , a.od_rate_current\r\n    , a.od_reate_number_current\r\n    , a.od_agreement_date_original\r\n    , a.od_expiration_date_original\r\n    , a.od_agreement_date_current\r\n    , a.od_expiration_date_current\r\n    , a.od_authorized_limit_current\r\n    , a.od_draw_limit_current\r\n    , a.is_overdraft_current\r\n    , b.sale_code\r\n    , CASE\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%ACCESSTRADE%' THEN 1001\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%CBNV%' THEN 1002\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%MSBPAY%' THEN 1003\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%CTV1%' THEN 1004\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%TOBR%' THEN 1005\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%LH%' THEN 1006\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND C.customer_number IS NOT NULL THEN 1007\r\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' THEN 1000\r\n        WHEN UPPER(a.user_id) LIKE '%TKSD01%' THEN 1008\r\n        ELSE 9999\r\n      END AS source_account\r\n  FROM\r\n    dat_all_account_final_w_source_customer a\r\n  LEFT JOIN sale_code b ON a.account_number = b.account_number\r\n  LEFT JOIN {{ ref('int__customer')}} C ON C.division = 'RB' AND b.sale_code_clean = C.customer_number\r\n)\r\n, dat_hash AS (  \r\n  SELECT\r\n      standard_hash(customer_number\r\n                    || '#'\r\n                    || account_number\r\n                    || '#'\r\n                    || currency_type\r\n                    || '#'\r\n                    || product_code\r\n                    || '#'\r\n                    || account_name\r\n                    || '#'\r\n                    || open_date\r\n                    || '#'\r\n                    || open_time\r\n                    || '#'\r\n                    || status\r\n                    || '#'\r\n                    || status_date\r\n                    || '#'\r\n                    || workstation_id\r\n                    || '#'\r\n                    || user_id\r\n                    || '#'\r\n                    || branch_code\r\n                    || '#'\r\n                    || subbranch_no\r\n                    || '#'\r\n                    || od_rate_current\r\n                    || '#'\r\n                    || od_reate_number_current\r\n                    || '#'\r\n                    || od_agreement_date_original\r\n                    || '#'\r\n                    || od_expiration_date_original\r\n                    || '#'\r\n                    || od_agreement_date_current\r\n                    || '#'\r\n                    || od_expiration_date_current\r\n                    || '#'\r\n                    || od_authorized_limit_current\r\n                    || '#'\r\n                    || od_draw_limit_current\r\n                    || '#'\r\n                    || is_overdraft_current\r\n                    || '#'\r\n                    || source_account) AS hash_diff\r\n    , etl_date\r\n    , customer_number\r\n    , account_number\r\n    , currency_type\r\n    , product_code\r\n    , account_name\r\n    , open_date\r\n    , open_time\r\n    , status\r\n    , status_date\r\n    , workstation_id\r\n    , user_id\r\n    , branch_code\r\n    , subbranch_no\r\n    , od_rate_current\r\n    , od_reate_number_current\r\n    , od_agreement_date_original\r\n    , od_expiration_date_original\r\n    , od_agreement_date_current\r\n    , od_expiration_date_current\r\n    , od_authorized_limit_current\r\n    , od_draw_limit_current\r\n    , is_overdraft_current\r\n    , source_account\r\n    , sale_code\r\n  FROM\r\n    dat_result_w_sale_code\r\n)\r\n  SELECT * FROM dat_hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int__casa_account.sql", "original_file_path": "models\\int\\daily\\int__casa_account.sql", "name": "int__casa_account", "alias": "int__casa_account", "checksum": {"name": "sha256", "checksum": "009724caed80ad98e9f297fd04681820858fa1edbf48237235d07e8a0a71fd6a"}, "tags": ["pkg_daily"], "refs": [["stg_landing__demanddeposit_master001"], ["stg_landing__demanddeposit_master002"], ["stg_landing__overdraft_tier001"], ["int__customer"], ["stg_landing__jupiter_customer_temp"], ["stg_landing__jupiter_cif_register_history"], ["stg_landing__jupiter_account_register_hist"], ["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int__casa_account.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "unique_key": "account_number", "post-hook": ["{{ create_index_if_not_exists(this, \"open_date\")}}", "{{ create_index_if_not_exists(this, \"account_number\")}}", "{{ create_index_if_not_exists(this, \"customer_number\")}}"]}, "created_at": 1685959752.6909795, "compiled_code": "\nWITH dat_all_account AS (\n  SELECT\n      a.etl_date\n    , a.customer_number\n    , a.account_number\n    , a.currency_type\n    , a.product_code\n    , a.account_name\n    , a.open_date\n    , a.open_time\n    , a.status\n    , a.status_date\n    , a.workstation_id\n    , a.user_id\n    , a.branch_code\n    , b.subbranch_no\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master001 a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002 b ON a.account_number = b.account_no AND b.rec_current_ind = 'Y'\n)\n, dat_overdraft_rn AS (\n  SELECT\n      account_number\n    , rate AS od_rate\n    , rate_number AS od_reate_number\n    , MIN(agreement_date_7) OVER(PARTITION BY account_number) AS od_agreement_date_original\n    , MIN(expiration_date_7) OVER(PARTITION BY account_number) AS od_expiration_date_original\n    , agreement_date_7 AS od_agreement_date_current\n    , expiration_date_7 AS od_expiration_date_current\n    , authorized_limit AS od_authorized_limit\n    , draw_limit AS od_draw_limit\n    , ROW_NUMBER() OVER(PARTITION BY account_number ORDER BY expiration_date_7 DESC, agreement_date_7 DESC, sequence_number DESC ) AS rn\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__overdraft_tier001\n)\n, dat_overdraft AS (\n  SELECT\n      account_number\n    , od_rate\n    , od_reate_number\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_agreement_date_original))  AS od_agreement_date_original\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_expiration_date_original)) AS od_expiration_date_original\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_agreement_date_current))   AS od_agreement_date_current\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(od_expiration_date_current))  AS od_expiration_date_current\n    , od_authorized_limit\n    , od_draw_limit\n  FROM\n    dat_overdraft_rn\n  WHERE\n    rn = 1\n)\n, dat_all_account_w_od_inf AS (\n  SELECT\n      a.*\n    , b.od_rate AS od_rate_current\n    , b.od_reate_number AS od_reate_number_current\n    , b.od_agreement_date_original\n    , b.od_expiration_date_original\n    , b.od_agreement_date_current\n    , b.od_expiration_date_current\n    , b.od_authorized_limit AS od_authorized_limit_current\n    , b.od_draw_limit AS od_draw_limit_current\n    , CASE\n        WHEN b.account_number IS NOT NULL \n          AND od_authorized_limit > 0\n          AND od_expiration_date_current > to_number(to_char(sysdate, 'YYYYDDD'))\n          AND status = 1 THEN 1\n        ELSE 0\n      END AS is_overdraft_current\n  FROM\n    dat_all_account a\n  LEFT JOIN dat_overdraft b ON a.account_number = b.account_number\n)\n, dat_all_account_final_w_source_customer AS (\n  SELECT\n      a.etl_date\n    , a.customer_number\n    , a.account_number\n    , a.currency_type\n    , a.product_code\n    , a.account_name\n    , a.open_date\n    , a.open_time\n    , a.status\n    , a.status_date\n    , a.workstation_id\n    , a.user_id\n    , a.branch_code\n    , a.subbranch_no\n    , a.od_rate_current\n    , a.od_reate_number_current\n    , a.od_agreement_date_original\n    , a.od_expiration_date_original\n    , a.od_agreement_date_current\n    , a.od_expiration_date_current\n    , a.od_authorized_limit_current\n    , a.od_draw_limit_current\n    , a.is_overdraft_current\n    , ROW_NUMBER() OVER(PARTITION BY a.customer_number ORDER BY a.open_date , a.open_time, a.account_number) AS rn\n    , b.source_customer\n    , b.division\n  FROM\n    dat_all_account_w_od_inf a\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__customer b ON a.customer_number = b.customer_number\n)\n, sale_code AS (\n  SELECT\n    acc.account_number,\n    cif.sale_code,\n    is_number(regexp_substr(cif.sale_code, '[^|]+', 1, 1)) AS sale_code_clean\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__jupiter_customer_temp cus\n    INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__jupiter_cif_register_history  cif ON cus.cif_id = cif.id\n    INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__jupiter_account_register_hist acc ON cus.account_id = acc.id\n  WHERE\n    acc.status = 'SUCC'\n    AND UPPER(checker) LIKE UPPER('EKYC')\n    AND UPPER(maker) LIKE UPPER('EKYC')\n)\n, dat_result_w_sale_code AS (\n  SELECT\n      a.etl_date\n    , a.customer_number\n    , a.account_number\n    , a.currency_type\n    , a.product_code\n    , a.account_name\n    , a.open_date\n    , a.open_time\n    , a.status\n    , a.status_date\n    , a.workstation_id\n    , a.user_id\n    , a.branch_code\n    , a.subbranch_no\n    , a.od_rate_current\n    , a.od_reate_number_current\n    , a.od_agreement_date_original\n    , a.od_expiration_date_original\n    , a.od_agreement_date_current\n    , a.od_expiration_date_current\n    , a.od_authorized_limit_current\n    , a.od_draw_limit_current\n    , a.is_overdraft_current\n    , b.sale_code\n    , CASE\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%ACCESSTRADE%' THEN 1001\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%CBNV%' THEN 1002\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%MSBPAY%' THEN 1003\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%CTV1%' THEN 1004\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%TOBR%' THEN 1005\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND UPPER(b.sale_code) LIKE '%LH%' THEN 1006\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' AND C.customer_number IS NOT NULL THEN 1007\n        WHEN UPPER(a.user_id) LIKE '%EKYC%' THEN 1000\n        WHEN UPPER(a.user_id) LIKE '%TKSD01%' THEN 1008\n        ELSE 9999\n      END AS source_account\n  FROM\n    dat_all_account_final_w_source_customer a\n  LEFT JOIN sale_code b ON a.account_number = b.account_number\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__customer C ON C.division = 'RB' AND b.sale_code_clean = C.customer_number\n)\n, dat_hash AS (  \n  SELECT\n      standard_hash(customer_number\n                    || '#'\n                    || account_number\n                    || '#'\n                    || currency_type\n                    || '#'\n                    || product_code\n                    || '#'\n                    || account_name\n                    || '#'\n                    || open_date\n                    || '#'\n                    || open_time\n                    || '#'\n                    || status\n                    || '#'\n                    || status_date\n                    || '#'\n                    || workstation_id\n                    || '#'\n                    || user_id\n                    || '#'\n                    || branch_code\n                    || '#'\n                    || subbranch_no\n                    || '#'\n                    || od_rate_current\n                    || '#'\n                    || od_reate_number_current\n                    || '#'\n                    || od_agreement_date_original\n                    || '#'\n                    || od_expiration_date_original\n                    || '#'\n                    || od_agreement_date_current\n                    || '#'\n                    || od_expiration_date_current\n                    || '#'\n                    || od_authorized_limit_current\n                    || '#'\n                    || od_draw_limit_current\n                    || '#'\n                    || is_overdraft_current\n                    || '#'\n                    || source_account) AS hash_diff\n    , etl_date\n    , customer_number\n    , account_number\n    , currency_type\n    , product_code\n    , account_name\n    , open_date\n    , open_time\n    , status\n    , status_date\n    , workstation_id\n    , user_id\n    , branch_code\n    , subbranch_no\n    , od_rate_current\n    , od_reate_number_current\n    , od_agreement_date_original\n    , od_expiration_date_original\n    , od_agreement_date_current\n    , od_expiration_date_current\n    , od_authorized_limit_current\n    , od_draw_limit_current\n    , is_overdraft_current\n    , source_account\n    , sale_code\n  FROM\n    dat_result_w_sale_code\n)\n  SELECT * FROM dat_hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__casa_account"}, "model.dga_data_model.int__customer": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["source.dga_data_model.int.int_tax__customer_info", "source.dga_data_model.mart.dim__industry", "model.dga_data_model.stg_landing__loan_master002", "model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__jupiter_cif_register_history", "model.dga_data_model.stg_landing__customer_master001", "model.dga_data_model.stg_landing__customer_master001", "model.dga_data_model.stg_landing__customer_marital_status", "model.dga_data_model.stg_landing__customer_job_infomation", "model.dga_data_model.stg_landing__df_customer_sts_type", "model.dga_data_model.stg__customer_connection_pivot", "model.dga_data_model.stg_landing__customer_address", "model.dga_data_model.stg_landing__customer_master002", "model.dga_data_model.stg_landing__vw_df_customer_active_latest"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"customer_number\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int__customer"], "unique_id": "model.dga_data_model.int__customer", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    post_hook=['{{ create_index_if_not_exists(this, \"customer_number\")}}']\r\n  )\r\n}}\r\nWITH loan_cus AS ( \r\n  SELECT\r\n    l.customer_number\r\n  FROM\r\n    {{ ref('stg_landing__loan_master002')}} l\r\n  WHERE\r\n    l.loan_type LIKE '%DNTN%'\r\n  GROUP BY\r\n    l.customer_number\r\n)\r\n, casa_cus AS (\r\n  SELECT\r\n    c.customer_number\r\n  FROM\r\n    {{ ref('stg_landing__demanddeposit_master001')}} c\r\n  WHERE\r\n    c.product_code LIKE '%S-CA32%'\r\n  GROUP BY\r\n    c.customer_number\r\n)\r\n, jupiter_cus AS (\r\n  SELECT\r\n      a.id\r\n    , a.customer_number\r\n    , a.sale_code\r\n    , a.create_by\r\n    , a.cif_number_company AS customer_company\r\n    , b.customer_number AS customer_refer\r\n    , ROW_NUMBER() OVER(PARTITION BY a.customer_number ORDER BY id) AS rn\r\n  FROM\r\n    {{ ref('stg_landing__jupiter_cif_register_history') }} a\r\n  LEFT JOIN {{ ref('stg_landing__customer_master001')}} b ON a.valid_sale_code = b.customer_number\r\n  WHERE\r\n      a.status = 'SUCC'\r\n)\r\n, dat_cst_general_info AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.bank_number\r\n    , a.branch_number\r\n    , a.customer_number\r\n    , a.customer_shortname\r\n    , a.formatted_short_name\r\n    , a.customer_fullname_locale\r\n    , a.customer_fullname_english\r\n    , a.relationship_manager\r\n    , a.resident_code\r\n    , a.country_of_citizenship\r\n    , a.original_date_of_birth\r\n    , a.date_of_birth\r\n    , a.original_contact_date\r\n    , a.contact_date\r\n    , a.customer_register_number\r\n    , a.id_type_code\r\n    , a.place_of_birth\r\n    , a.marital_status_code\r\n    , b.marital_status_name\r\n    , a.marital_status_date\r\n    , a.gender\r\n    , a.user_id\r\n    , a.workstation_id\r\n    , a.customer_sts_code\r\n    , d.status_name AS customer_sts_name\r\n    , a.customer_status_date\r\n    , a.tax_code_id\r\n    , a.reporting_branch\r\n    , a.department_code\r\n    , a.individual\r\n    , a.division\r\n    , a.business_type AS industry_code\r\n    , c.industry_name\r\n    , a.tax_code_final\r\n    , CASE\r\n        --CIF\r\n        WHEN a.individual = 'Y' AND a.banking_division_infor8 = 'Y' THEN 'CB'\r\n        WHEN a.individual = 'Y' AND a.banking_division_infor1 = 'Y' THEN 'QLTD'\r\n        WHEN a.individual = 'Y' THEN 'RB'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor1 = 'Y' THEN 'QLTD'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor2 = 'Y' THEN 'RBTC'\r\n        WHEN a.individual = 'N' AND a.customer_segmentation2 = 'Y' THEN 'SOE'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor4 = 'Y' AND a.customer_rating = 41 THEN 'B'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor4 = 'Y' THEN 'FI'\r\n        WHEN \r\n          a.individual = 'N'\r\n          AND a.banking_division_infor5 = 'Y'\r\n          AND a.banking_division_infor3 = 'N'\r\n          AND a.banking_division_infor4 = 'N'\r\n          AND a.banking_division_infor6 = 'N'\r\n          AND a.banking_division_infor7 = 'N' \r\n          THEN 'FDI'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor6 = 'Y' THEN 'LC'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor7 = 'Y' THEN 'BB'\r\n        WHEN a.individual = 'N' AND a.banking_division_infor8 = 'Y' THEN 'ME'\r\n        WHEN a.individual = 'N' AND a.customer_segmentation1 = 'Y' THEN 'MC'            \r\n        --LOAN\r\n        WHEN a.banking_division_infor3 = 'Y' AND lc.customer_number IS NOT NULL THEN 'SME'\r\n        WHEN a.banking_division_infor7 = 'Y' AND lc.customer_number IS NOT NULL THEN 'BB'\r\n        WHEN \r\n          a.individual = 'Y'\r\n          AND a.banking_division_infor3 != 'Y'\r\n          AND a.banking_division_infor7 != 'Y'\r\n          AND lc.customer_number IS NOT NULL \r\n          THEN 'RBTC'            \r\n        --CASA\r\n        WHEN a.banking_division_infor2 != 'Y' AND cc.customer_number IS NOT NULL THEN 'BB'\r\n        ELSE 'SME'\r\n      END AS division_lv2\r\n      , industry.industry_dim_id\r\n    FROM\r\n      {{ ref('stg_landing__customer_master001')}} a\r\n    LEFT JOIN {{ ref('stg_landing__customer_marital_status')}} b ON a.marital_status_code = b.cfmstc\r\n    LEFT JOIN {{ ref('stg_landing__customer_job_infomation')}} c ON a.business_type = c.cfbust\r\n    LEFT JOIN {{ ref('stg_landing__df_customer_sts_type')}} d ON a.customer_sts_code = d.status\r\n    LEFT JOIN loan_cus lc ON a.customer_number = lc.customer_number\r\n    LEFT JOIN casa_cus cc ON a.customer_number = cc.customer_number\r\n    LEFT JOIN {{ source('int', 'int_tax__customer_info') }} tax ON a.tax_code_final = tax.tax_code\r\n    LEFT JOIN {{ source('mart', 'dim__industry') }} industry ON tax.ma_nganh_c5_chuan = industry.industry_code_lv5\r\n)\r\n, dat_result AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.bank_number\r\n    , a.branch_number\r\n    , a.customer_number\r\n    , a.customer_shortname\r\n    , a.formatted_short_name\r\n    , a.customer_fullname_locale\r\n    , a.customer_fullname_english\r\n    , a.relationship_manager\r\n    , a.resident_code\r\n    , a.country_of_citizenship\r\n    , a.original_date_of_birth\r\n    , a.date_of_birth\r\n    , a.original_contact_date\r\n    , a.contact_date\r\n    , a.customer_register_number\r\n    , a.id_type_code\r\n    , a.place_of_birth\r\n    , a.marital_status_code\r\n    , a.marital_status_name\r\n    , a.marital_status_date\r\n    , a.gender\r\n    , a.user_id\r\n    , a.workstation_id\r\n    , a.customer_sts_code\r\n    , a.customer_sts_name\r\n    , a.customer_status_date\r\n    , a.tax_code_id\r\n    , a.reporting_branch\r\n    , a.department_code\r\n    , a.individual\r\n    , a.industry_code\r\n    , a.industry_name\r\n    , b.office_phone_address\r\n    , b.home_phone_address\r\n    , b.mobile_phone_address\r\n    , is_mobile_phone(fnc_remove_null_text(b.mobile_phone_address)) AS formatted_mobile_phone_address\r\n    , b.email_address\r\n    , c.customer_address_line_1\r\n    , c.customer_address_line_2\r\n    , c.customer_address_line_3\r\n    , c.customer_address_line_4\r\n    , c.permanent_address_city_name\r\n    , c.permanent_address_city_code\r\n    , c.permanent_address_country\r\n    , a.division_lv2\r\n    , a.industry_dim_id\r\n    , CASE\r\n        WHEN a.division_lv2 IN ( 'CB', 'RB', 'RBTC', 'BB', 'ME' ) THEN 'RB'\r\n        WHEN a.division_lv2 IN ( 'FDI', 'LC', 'MC', 'SME' ) THEN 'EB'\r\n        WHEN a.division_lv2 IN ( 'QLTD', 'SOE', 'B', 'FI' ) THEN 'OTHER'\r\n      END AS division\r\n    , d.biz_line\r\n    , d.id_issue_place\r\n    , d.id_issue_remark\r\n    , d.original_id_issue_date\r\n    , d.id_issue_date\r\n    , CASE\r\n        WHEN is_valid_email(fnc_remove_null_text(b.email_address)) = 1 THEN fnc_remove_null_text(b.email_address)\r\n        ELSE NULL\r\n      END AS valid_format_email_address\r\n    , f.segment_lv1_rb\r\n    , f.segment_lv2_rb\r\n    , tax_code_final\r\n    , g.customer_company\r\n    , g.customer_refer\r\n    , g.sale_code\r\n    , CASE\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%ACCESSTRADE%' THEN 1001 -- ACCESSTRADE\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%CBNV%' THEN 1002 -- CBNV\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%MSBPAY%' THEN 1003 -- Cong thanh toan\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%CTV1%' THEN 1004 -- CTV\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%TOBR%' THEN 1005 -- MKT\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%LH%' THEN 1006 -- Lending Hub\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND customer_refer IS NOT NULL THEN 1007 -- KH GT KH\r\n        WHEN upper(g.create_by) LIKE '%EKYC%' THEN 1000 -- EKYC_OTHER\r\n        ELSE 9999 -- COUNTER\r\n      END AS source_customer\r\n  FROM\r\n    dat_cst_general_info        a\r\n  LEFT JOIN {{ ref('stg__customer_connection_pivot')}} b ON a.customer_number = b.customer_number\r\n  LEFT JOIN {{ ref('stg_landing__customer_address')}} c ON a.customer_number = c.customer_number\r\n  LEFT JOIN {{ ref('stg_landing__customer_master002')}} d ON a.customer_number = d.customer_number AND d.rec_current_ind = 'Y'\r\n  LEFT JOIN {{ ref('stg_landing__vw_df_customer_active_latest')}} f ON a.customer_number = f.customer_number\r\n  LEFT JOIN jupiter_cus g ON a.customer_number = g.customer_number ANd g.rn = 1                    \r\n)\r\n, dat_hash AS (\r\n  SELECT\r\n      etl_date\r\n    , standard_hash(bank_number\r\n                      || '#'\r\n                      || branch_number\r\n                      || '#'\r\n                      || customer_number\r\n                      || '#'\r\n                      || customer_shortname\r\n                      || '#'\r\n                      || formatted_short_name\r\n                      || '#'\r\n                      || customer_fullname_locale\r\n                      || '#'\r\n                      || customer_fullname_english\r\n                      || '#'\r\n                      || relationship_manager\r\n                      || '#'\r\n                      || resident_code\r\n                      || '#'\r\n                      || country_of_citizenship\r\n                      || '#'\r\n                      || original_date_of_birth\r\n                      || '#'\r\n                      || date_of_birth\r\n                      || '#'\r\n                      || original_contact_date\r\n                      || '#'\r\n                      || contact_date\r\n                      || '#'\r\n                      || customer_register_number\r\n                      || '#'\r\n                      || id_type_code\r\n                      || '#'\r\n                      || id_issue_place\r\n                      || '#'\r\n                      || id_issue_remark\r\n                      || '#'\r\n                      || original_id_issue_date\r\n                      || '#'\r\n                      || id_issue_date\r\n                      || '#'\r\n                      || place_of_birth\r\n                      || '#'\r\n                      || marital_status_code\r\n                      || '#'\r\n                      || marital_status_name\r\n                      || '#'\r\n                      || marital_status_date\r\n                      || '#'\r\n                      || gender\r\n                      || '#'\r\n                      || user_id\r\n                      || '#'\r\n                      || workstation_id\r\n                      || '#'\r\n                      || customer_sts_code\r\n                      || '#'\r\n                      || customer_sts_name\r\n                      || '#'\r\n                      || customer_status_date\r\n                      || '#'\r\n                      || tax_code_id\r\n                      || '#'\r\n                      || reporting_branch\r\n                      || '#'\r\n                      || department_code\r\n                      || '#'\r\n                      || individual\r\n                      || '#'\r\n                      || industry_code\r\n                      || '#'\r\n                      || industry_name\r\n                      || '#'\r\n                      || office_phone_address\r\n                      || '#'\r\n                      || home_phone_address\r\n                      || '#'\r\n                      || mobile_phone_address\r\n                      || '#'\r\n                      || formatted_mobile_phone_address\r\n                      || '#'\r\n                      || email_address\r\n                      || '#'\r\n                      || valid_format_email_address\r\n                      || '#'\r\n                      || customer_address_line_1\r\n                      || '#'\r\n                      || customer_address_line_2\r\n                      || '#'\r\n                      || customer_address_line_3\r\n                      || '#'\r\n                      || customer_address_line_4\r\n                      || '#'\r\n                      || permanent_address_city_name\r\n                      || '#'\r\n                      || permanent_address_city_code\r\n                      || '#'\r\n                      || permanent_address_country\r\n                      || '#'\r\n                      || division\r\n                      || '#'\r\n                      || division_lv2\r\n                      || '#'\r\n                      || industry_dim_id\r\n                      || '#'\r\n                      || biz_line\r\n                      || '#'\r\n                      || segment_lv1_rb\r\n                      || '#'\r\n                      || segment_lv2_rb, 'SHA512') AS hash_diff\r\n    , bank_number\r\n    , branch_number\r\n    , customer_number\r\n    , customer_shortname\r\n    , formatted_short_name\r\n    , customer_fullname_locale\r\n    , customer_fullname_english\r\n    , relationship_manager\r\n    , resident_code\r\n    , country_of_citizenship\r\n    , original_date_of_birth\r\n    , date_of_birth\r\n    , original_contact_date\r\n    , contact_date\r\n    , customer_register_number\r\n    , id_type_code\r\n    , id_issue_place\r\n    , id_issue_remark\r\n    , original_id_issue_date\r\n    , id_issue_date\r\n    , place_of_birth\r\n    , marital_status_code\r\n    , marital_status_name\r\n    , marital_status_date\r\n    , gender\r\n    , user_id\r\n    , workstation_id\r\n    , customer_sts_code\r\n    , customer_sts_name\r\n    , customer_status_date\r\n    , tax_code_id\r\n    , reporting_branch\r\n    , department_code\r\n    , individual\r\n    , industry_code\r\n    , industry_name\r\n    , office_phone_address\r\n    , home_phone_address\r\n    , mobile_phone_address\r\n    , formatted_mobile_phone_address\r\n    , email_address\r\n    , valid_format_email_address\r\n    , customer_address_line_1\r\n    , customer_address_line_2\r\n    , customer_address_line_3\r\n    , customer_address_line_4\r\n    , permanent_address_city_name\r\n    , permanent_address_city_code\r\n    , permanent_address_country\r\n    , division\r\n    , division_lv2\r\n    , industry_dim_id\r\n    , biz_line\r\n    , segment_lv1_rb\r\n    , segment_lv2_rb\r\n    , source_customer\r\n    , tax_code_final\r\n    , customer_company\r\n    , customer_refer\r\n    , sale_code\r\n    , 'OOOOOOO' AS subbranch_no\r\n  FROM\r\n    dat_result\r\n)\r\nSELECT * FROM dat_hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int__customer.sql", "original_file_path": "models\\int\\daily\\int__customer.sql", "name": "int__customer", "alias": "int__customer", "checksum": {"name": "sha256", "checksum": "13170dbf7a354551aeada1d1df4e8a6d365f398c4f46a6d1d70d90995fb12cef"}, "tags": ["pkg_daily"], "refs": [["stg_landing__loan_master002"], ["stg_landing__demanddeposit_master001"], ["stg_landing__jupiter_cif_register_history"], ["stg_landing__customer_master001"], ["stg_landing__customer_master001"], ["stg_landing__customer_marital_status"], ["stg_landing__customer_job_infomation"], ["stg_landing__df_customer_sts_type"], ["stg__customer_connection_pivot"], ["stg_landing__customer_address"], ["stg_landing__customer_master002"], ["stg_landing__vw_df_customer_active_latest"]], "sources": [["int", "int_tax__customer_info"], ["mart", "dim__industry"]], "metrics": [], "description": "", "columns": {"customer_number": {"name": "customer_number", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int__customer.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "post-hook": ["{{ create_index_if_not_exists(this, \"customer_number\")}}"]}, "created_at": 1685959752.6939855, "compiled_code": "\nWITH loan_cus AS ( \n  SELECT\n    l.customer_number\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__loan_master002 l\n  WHERE\n    l.loan_type LIKE '%DNTN%'\n  GROUP BY\n    l.customer_number\n)\n, casa_cus AS (\n  SELECT\n    c.customer_number\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master001 c\n  WHERE\n    c.product_code LIKE '%S-CA32%'\n  GROUP BY\n    c.customer_number\n)\n, jupiter_cus AS (\n  SELECT\n      a.id\n    , a.customer_number\n    , a.sale_code\n    , a.create_by\n    , a.cif_number_company AS customer_company\n    , b.customer_number AS customer_refer\n    , ROW_NUMBER() OVER(PARTITION BY a.customer_number ORDER BY id) AS rn\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__jupiter_cif_register_history a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__customer_master001 b ON a.valid_sale_code = b.customer_number\n  WHERE\n      a.status = 'SUCC'\n)\n, dat_cst_general_info AS (\n  SELECT\n      a.etl_date\n    , a.bank_number\n    , a.branch_number\n    , a.customer_number\n    , a.customer_shortname\n    , a.formatted_short_name\n    , a.customer_fullname_locale\n    , a.customer_fullname_english\n    , a.relationship_manager\n    , a.resident_code\n    , a.country_of_citizenship\n    , a.original_date_of_birth\n    , a.date_of_birth\n    , a.original_contact_date\n    , a.contact_date\n    , a.customer_register_number\n    , a.id_type_code\n    , a.place_of_birth\n    , a.marital_status_code\n    , b.marital_status_name\n    , a.marital_status_date\n    , a.gender\n    , a.user_id\n    , a.workstation_id\n    , a.customer_sts_code\n    , d.status_name AS customer_sts_name\n    , a.customer_status_date\n    , a.tax_code_id\n    , a.reporting_branch\n    , a.department_code\n    , a.individual\n    , a.division\n    , a.business_type AS industry_code\n    , c.industry_name\n    , a.tax_code_final\n    , CASE\n        --CIF\n        WHEN a.individual = 'Y' AND a.banking_division_infor8 = 'Y' THEN 'CB'\n        WHEN a.individual = 'Y' AND a.banking_division_infor1 = 'Y' THEN 'QLTD'\n        WHEN a.individual = 'Y' THEN 'RB'\n        WHEN a.individual = 'N' AND a.banking_division_infor1 = 'Y' THEN 'QLTD'\n        WHEN a.individual = 'N' AND a.banking_division_infor2 = 'Y' THEN 'RBTC'\n        WHEN a.individual = 'N' AND a.customer_segmentation2 = 'Y' THEN 'SOE'\n        WHEN a.individual = 'N' AND a.banking_division_infor4 = 'Y' AND a.customer_rating = 41 THEN 'B'\n        WHEN a.individual = 'N' AND a.banking_division_infor4 = 'Y' THEN 'FI'\n        WHEN \n          a.individual = 'N'\n          AND a.banking_division_infor5 = 'Y'\n          AND a.banking_division_infor3 = 'N'\n          AND a.banking_division_infor4 = 'N'\n          AND a.banking_division_infor6 = 'N'\n          AND a.banking_division_infor7 = 'N' \n          THEN 'FDI'\n        WHEN a.individual = 'N' AND a.banking_division_infor6 = 'Y' THEN 'LC'\n        WHEN a.individual = 'N' AND a.banking_division_infor7 = 'Y' THEN 'BB'\n        WHEN a.individual = 'N' AND a.banking_division_infor8 = 'Y' THEN 'ME'\n        WHEN a.individual = 'N' AND a.customer_segmentation1 = 'Y' THEN 'MC'            \n        --LOAN\n        WHEN a.banking_division_infor3 = 'Y' AND lc.customer_number IS NOT NULL THEN 'SME'\n        WHEN a.banking_division_infor7 = 'Y' AND lc.customer_number IS NOT NULL THEN 'BB'\n        WHEN \n          a.individual = 'Y'\n          AND a.banking_division_infor3 != 'Y'\n          AND a.banking_division_infor7 != 'Y'\n          AND lc.customer_number IS NOT NULL \n          THEN 'RBTC'            \n        --CASA\n        WHEN a.banking_division_infor2 != 'Y' AND cc.customer_number IS NOT NULL THEN 'BB'\n        ELSE 'SME'\n      END AS division_lv2\n      , industry.industry_dim_id\n    FROM\n      \"oracle_dgaworkzone\".staging.stg_landing__customer_master001 a\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__customer_marital_status b ON a.marital_status_code = b.cfmstc\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__customer_job_infomation c ON a.business_type = c.cfbust\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_customer_sts_type d ON a.customer_sts_code = d.status\n    LEFT JOIN loan_cus lc ON a.customer_number = lc.customer_number\n    LEFT JOIN casa_cus cc ON a.customer_number = cc.customer_number\n    LEFT JOIN oracle_dgaworkzone.int.int_tax__customer_info tax ON a.tax_code_final = tax.tax_code\n    LEFT JOIN oracle_dgaworkzone.mart.dim__industry industry ON tax.ma_nganh_c5_chuan = industry.industry_code_lv5\n)\n, dat_result AS (\n  SELECT\n      a.etl_date\n    , a.bank_number\n    , a.branch_number\n    , a.customer_number\n    , a.customer_shortname\n    , a.formatted_short_name\n    , a.customer_fullname_locale\n    , a.customer_fullname_english\n    , a.relationship_manager\n    , a.resident_code\n    , a.country_of_citizenship\n    , a.original_date_of_birth\n    , a.date_of_birth\n    , a.original_contact_date\n    , a.contact_date\n    , a.customer_register_number\n    , a.id_type_code\n    , a.place_of_birth\n    , a.marital_status_code\n    , a.marital_status_name\n    , a.marital_status_date\n    , a.gender\n    , a.user_id\n    , a.workstation_id\n    , a.customer_sts_code\n    , a.customer_sts_name\n    , a.customer_status_date\n    , a.tax_code_id\n    , a.reporting_branch\n    , a.department_code\n    , a.individual\n    , a.industry_code\n    , a.industry_name\n    , b.office_phone_address\n    , b.home_phone_address\n    , b.mobile_phone_address\n    , is_mobile_phone(fnc_remove_null_text(b.mobile_phone_address)) AS formatted_mobile_phone_address\n    , b.email_address\n    , c.customer_address_line_1\n    , c.customer_address_line_2\n    , c.customer_address_line_3\n    , c.customer_address_line_4\n    , c.permanent_address_city_name\n    , c.permanent_address_city_code\n    , c.permanent_address_country\n    , a.division_lv2\n    , a.industry_dim_id\n    , CASE\n        WHEN a.division_lv2 IN ( 'CB', 'RB', 'RBTC', 'BB', 'ME' ) THEN 'RB'\n        WHEN a.division_lv2 IN ( 'FDI', 'LC', 'MC', 'SME' ) THEN 'EB'\n        WHEN a.division_lv2 IN ( 'QLTD', 'SOE', 'B', 'FI' ) THEN 'OTHER'\n      END AS division\n    , d.biz_line\n    , d.id_issue_place\n    , d.id_issue_remark\n    , d.original_id_issue_date\n    , d.id_issue_date\n    , CASE\n        WHEN is_valid_email(fnc_remove_null_text(b.email_address)) = 1 THEN fnc_remove_null_text(b.email_address)\n        ELSE NULL\n      END AS valid_format_email_address\n    , f.segment_lv1_rb\n    , f.segment_lv2_rb\n    , tax_code_final\n    , g.customer_company\n    , g.customer_refer\n    , g.sale_code\n    , CASE\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%ACCESSTRADE%' THEN 1001 -- ACCESSTRADE\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%CBNV%' THEN 1002 -- CBNV\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%MSBPAY%' THEN 1003 -- Cong thanh toan\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%CTV1%' THEN 1004 -- CTV\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%TOBR%' THEN 1005 -- MKT\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND upper(g.sale_code) LIKE '%LH%' THEN 1006 -- Lending Hub\n        WHEN upper(g.create_by) LIKE '%EKYC%' AND customer_refer IS NOT NULL THEN 1007 -- KH GT KH\n        WHEN upper(g.create_by) LIKE '%EKYC%' THEN 1000 -- EKYC_OTHER\n        ELSE 9999 -- COUNTER\n      END AS source_customer\n  FROM\n    dat_cst_general_info        a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__customer_connection_pivot b ON a.customer_number = b.customer_number\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__customer_address c ON a.customer_number = c.customer_number\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__customer_master002 d ON a.customer_number = d.customer_number AND d.rec_current_ind = 'Y'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__vw_df_customer_active_latest f ON a.customer_number = f.customer_number\n  LEFT JOIN jupiter_cus g ON a.customer_number = g.customer_number ANd g.rn = 1                    \n)\n, dat_hash AS (\n  SELECT\n      etl_date\n    , standard_hash(bank_number\n                      || '#'\n                      || branch_number\n                      || '#'\n                      || customer_number\n                      || '#'\n                      || customer_shortname\n                      || '#'\n                      || formatted_short_name\n                      || '#'\n                      || customer_fullname_locale\n                      || '#'\n                      || customer_fullname_english\n                      || '#'\n                      || relationship_manager\n                      || '#'\n                      || resident_code\n                      || '#'\n                      || country_of_citizenship\n                      || '#'\n                      || original_date_of_birth\n                      || '#'\n                      || date_of_birth\n                      || '#'\n                      || original_contact_date\n                      || '#'\n                      || contact_date\n                      || '#'\n                      || customer_register_number\n                      || '#'\n                      || id_type_code\n                      || '#'\n                      || id_issue_place\n                      || '#'\n                      || id_issue_remark\n                      || '#'\n                      || original_id_issue_date\n                      || '#'\n                      || id_issue_date\n                      || '#'\n                      || place_of_birth\n                      || '#'\n                      || marital_status_code\n                      || '#'\n                      || marital_status_name\n                      || '#'\n                      || marital_status_date\n                      || '#'\n                      || gender\n                      || '#'\n                      || user_id\n                      || '#'\n                      || workstation_id\n                      || '#'\n                      || customer_sts_code\n                      || '#'\n                      || customer_sts_name\n                      || '#'\n                      || customer_status_date\n                      || '#'\n                      || tax_code_id\n                      || '#'\n                      || reporting_branch\n                      || '#'\n                      || department_code\n                      || '#'\n                      || individual\n                      || '#'\n                      || industry_code\n                      || '#'\n                      || industry_name\n                      || '#'\n                      || office_phone_address\n                      || '#'\n                      || home_phone_address\n                      || '#'\n                      || mobile_phone_address\n                      || '#'\n                      || formatted_mobile_phone_address\n                      || '#'\n                      || email_address\n                      || '#'\n                      || valid_format_email_address\n                      || '#'\n                      || customer_address_line_1\n                      || '#'\n                      || customer_address_line_2\n                      || '#'\n                      || customer_address_line_3\n                      || '#'\n                      || customer_address_line_4\n                      || '#'\n                      || permanent_address_city_name\n                      || '#'\n                      || permanent_address_city_code\n                      || '#'\n                      || permanent_address_country\n                      || '#'\n                      || division\n                      || '#'\n                      || division_lv2\n                      || '#'\n                      || industry_dim_id\n                      || '#'\n                      || biz_line\n                      || '#'\n                      || segment_lv1_rb\n                      || '#'\n                      || segment_lv2_rb, 'SHA512') AS hash_diff\n    , bank_number\n    , branch_number\n    , customer_number\n    , customer_shortname\n    , formatted_short_name\n    , customer_fullname_locale\n    , customer_fullname_english\n    , relationship_manager\n    , resident_code\n    , country_of_citizenship\n    , original_date_of_birth\n    , date_of_birth\n    , original_contact_date\n    , contact_date\n    , customer_register_number\n    , id_type_code\n    , id_issue_place\n    , id_issue_remark\n    , original_id_issue_date\n    , id_issue_date\n    , place_of_birth\n    , marital_status_code\n    , marital_status_name\n    , marital_status_date\n    , gender\n    , user_id\n    , workstation_id\n    , customer_sts_code\n    , customer_sts_name\n    , customer_status_date\n    , tax_code_id\n    , reporting_branch\n    , department_code\n    , individual\n    , industry_code\n    , industry_name\n    , office_phone_address\n    , home_phone_address\n    , mobile_phone_address\n    , formatted_mobile_phone_address\n    , email_address\n    , valid_format_email_address\n    , customer_address_line_1\n    , customer_address_line_2\n    , customer_address_line_3\n    , customer_address_line_4\n    , permanent_address_city_name\n    , permanent_address_city_code\n    , permanent_address_country\n    , division\n    , division_lv2\n    , industry_dim_id\n    , biz_line\n    , segment_lv1_rb\n    , segment_lv2_rb\n    , source_customer\n    , tax_code_final\n    , customer_company\n    , customer_refer\n    , sale_code\n    , 'OOOOOOO' AS subbranch_no\n  FROM\n    dat_result\n)\nSELECT * FROM dat_hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__customer"}, "model.dga_data_model.int__fd_account": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_landing__fixeddeposit_master002", "model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_dwh__fddm_product", "model.dga_data_model.stg_dwh__csdm_branch", "model.dga_data_model.stg_landing__fixeddeposit_master002", "model.dga_data_model.stg_dwh__cydm_rate_history", "model.dga_data_model.stg_landing__fixeddeposit_master001"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "account_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "UPDATE {{ this }} SET etl_date = {{ var('julian_date') }} ", "transaction": true, "index": null}], "pre-hook": [{"sql": "DELETE {{ this }} WHERE open_date = {{ var('date_id') }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int__fd_account"], "unique_id": "model.dga_data_model.int__fd_account", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key= \"account_number\",\r\n    pre_hook=[\"DELETE {{ this }} WHERE open_date = {{ var('date_id') }}\"],\r\n    post_hook=[\"UPDATE {{ this }} SET etl_date = {{ var('julian_date') }} \"\r\n  ]\r\n  )\r\n}}\r\nWITH fd_subbrand AS (\r\n  SELECT\r\n      account_no\r\n    , subbranch_no\r\n  FROM\r\n      {{ ref('stg_landing__fixeddeposit_master002')}}\r\n  WHERE\r\n      rec_current_ind = 'Y'\r\n)\r\n, fd_account_new AS (\r\n  SELECT DISTINCT\r\n      fm.customer_no AS customer_number\r\n    , nvl(fm.account_no, fm2.account_no) AS account_number\r\n    , fm.currency AS currency_type\r\n    , fp.product_code\r\n    , to_number(to_char(to_date(fm.open_date, 'YYYYDDD'), 'YYYYMMDD')) AS open_date\r\n    , fm.term\r\n    , fm.auto_renew\r\n    , cb.branch_code\r\n    , fm.org_amount\r\n  FROM\r\n    {{ ref('stg_landing__fixeddeposit_master003')}} fm\r\n    LEFT JOIN {{ ref('stg_dwh__fddm_product')}} fp ON fm.product_sk = fp.product_sk\r\n    LEFT JOIN {{ ref('stg_dwh__csdm_branch')}} cb ON fm.branch_sk = cb.branch_code_sk\r\n    LEFT JOIN {{ ref('stg_landing__fixeddeposit_master002')}} fm2 ON fm.account_sk = fm2.account_sk\r\n  {% if is_incremental() %}\r\n  WHERE fm.etl_date = {{ var('julian_date') }}\r\n  AND fm.open_date = {{ var('julian_date') }}\r\n)\r\n, fd_account_update AS (\r\n  SELECT\r\n    customer_number\r\n    , account_number\r\n    , currency_type\r\n    , product_code\r\n    , open_date\r\n    , term\r\n    , auto_renew\r\n    , branch_code\r\n    , org_amount\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    currency_type <> 'VND'\r\n    AND account_number IS NOT NULL\r\n)\r\n, fd_account AS (\r\n  SELECT\r\n      CAST(customer_number AS NUMBER) AS customer_number\r\n    , CAST(account_number AS NUMBER) AS account_number\r\n    , CAST(currency_type AS VARCHAR2(4)) AS currency_type\r\n    , CAST(product_code AS VARCHAR2(20)) AS product_code\r\n    , CAST(open_date AS NUMBER) AS open_date\r\n    , CAST(term AS VARCHAR2(10)) AS term\r\n    , CAST(auto_renew AS CHAR(1)) AS auto_renew\r\n    , CAST(branch_code AS NUMBER) AS branch_code\r\n    , CAST(org_amount AS NUMBER) AS org_amount\r\n  FROM fd_account_new\r\n  UNION ALL\r\n  SELECT * FROM fd_account_update\r\n  {% endif %}\r\n)\r\n, fd_account_ex AS (\r\n  SELECT\r\n      fm.customer_number\r\n    , fm.account_number\r\n    , fm.currency_type\r\n    , fm.product_code\r\n    , fm.open_date\r\n    , fm.term\r\n    , fm.auto_renew\r\n    , fm.branch_code\r\n    , fm.org_amount\r\n    , rh.mid_rate\r\n    , CASE \r\n        WHEN fm.currency_type = 'VND' THEN fm.org_amount\r\n        ELSE fm.org_amount * rh.mid_rate \r\n      END AS lcy_org_amount\r\n    , fs.subbranch_no\r\n    , fm1.maturity_date2\r\n  FROM\r\n    fd_account fm \r\n  LEFT JOIN fd_subbrand fs ON fs.account_no = fm.account_number\r\n  LEFT JOIN {{ ref('stg_dwh__cydm_rate_history')}} rh\r\n    ON fm.open_date = to_number(to_char(to_date(rh.datekey, 'YYYYDDD'), 'YYYYMMDD'))\r\n      AND fm.currency_type = rh.ccy1\r\n      AND fm.currency_type <> 'VND'\r\n      AND fm.account_number IS NOT NULL\r\n  LEFT JOIN {{ ref('stg_landing__fixeddeposit_master001')}} fm1 ON fm.account_number = fm1.account_number\r\n)\r\n{% if is_incremental() %}\r\n, fd_account_subbrand AS (\r\n  SELECT\r\n    a.*\r\n    , fs.subbranch_no AS subbranch_no_new\r\n    , fm.maturity_date2 AS maturity_date2_new\r\n  FROM\r\n    {{ this }} a\r\n  LEFT JOIN fd_subbrand fs on fs.account_no = a.account_number\r\n  LEFT JOIN {{ ref('stg_landing__fixeddeposit_master001')}} fm ON fm.account_number = a.account_number\r\n  WHERE a.subbranch_no <> fs.subbranch_no\r\n  OR COALESCE(fm.maturity_date2, 0) <>  COALESCE(a.maturity_date2, 0)\r\n)\r\n, fd_account_ex_m AS (\r\n  SELECT\r\n      COALESCE( fas.customer_number, fae.customer_number) AS customer_number\r\n    , COALESCE( fas.account_number, fae.account_number) AS account_number\r\n    , COALESCE( fas.currency_type, fae.currency_type) AS currency_type\r\n    , COALESCE( fas.product_code, fae.product_code) AS product_code\r\n    , COALESCE( fas.open_date, fae.open_date) AS open_date\r\n    , COALESCE( fas.term, fae.term) AS term\r\n    , COALESCE( fas.auto_renew, fae.auto_renew) AS auto_renew\r\n    , COALESCE( fas.branch_code, fae.branch_code) AS branch_code\r\n    , COALESCE( fas.subbranch_no_new, fae.subbranch_no) AS subbranch_no\r\n    , COALESCE( fas.org_amount, fae.org_amount) AS org_amount\r\n    , COALESCE( fae.lcy_org_amount, fas.lcy_org_amount) AS lcy_org_amount\r\n    , COALESCE( fas.maturity_date2_new, fae.maturity_date2) AS maturity_date2\r\n  FROM\r\n    fd_account_subbrand fas\r\n    FULL JOIN fd_account_ex fae ON fas.account_number = fae.account_number\r\n)\r\n{% endif %}\r\n, fd_hash AS (\r\n  SELECT\r\n      to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\n    , fa.*\r\n    , standard_hash(customer_number\r\n                                      || '#'\r\n                                      || account_number\r\n                                      || '#'\r\n                                      || currency_type\r\n                                      || '#'\r\n                                      || product_code\r\n                                      || '#'\r\n                                      || open_date\r\n                                      || '#'\r\n                                      || term\r\n                                      || '#'\r\n                                      || auto_renew\r\n                                      || '#'\r\n                                      || branch_code\r\n                                      || '#'\r\n                                      || subbranch_no\r\n                                      || '#'\r\n                                      || org_amount\r\n                                      || '#'\r\n                                      || lcy_org_amount) AS hash_diff\r\n\r\n  FROM fd_account_ex_m fa\r\n)\r\nSELECT * FROM fd_hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int__fd_account.sql", "original_file_path": "models\\int\\daily\\int__fd_account.sql", "name": "int__fd_account", "alias": "int__fd_account", "checksum": {"name": "sha256", "checksum": "b2831a3642082283cb14824bc9c137fdd774888d258b204c9da90db4c018a52c"}, "tags": ["pkg_daily"], "refs": [["stg_landing__fixeddeposit_master002"], ["stg_landing__fixeddeposit_master003"], ["stg_dwh__fddm_product"], ["stg_dwh__csdm_branch"], ["stg_landing__fixeddeposit_master002"], ["stg_dwh__cydm_rate_history"], ["stg_landing__fixeddeposit_master001"]], "sources": [], "metrics": [], "description": "", "columns": {"account_number": {"name": "account_number", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int__fd_account.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "incremental", "unique_key": "account_number", "pre-hook": ["DELETE {{ this }} WHERE open_date = {{ var('date_id') }}"], "post-hook": ["UPDATE {{ this }} SET etl_date = {{ var('julian_date') }} "]}, "created_at": 1685959752.6999075, "compiled_code": "\nWITH fd_subbrand AS (\n  SELECT\n      account_no\n    , subbranch_no\n  FROM\n      \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master002\n  WHERE\n      rec_current_ind = 'Y'\n)\n, fd_account_new AS (\n  SELECT DISTINCT\n      fm.customer_no AS customer_number\n    , nvl(fm.account_no, fm2.account_no) AS account_number\n    , fm.currency AS currency_type\n    , fp.product_code\n    , to_number(to_char(to_date(fm.open_date, 'YYYYDDD'), 'YYYYMMDD')) AS open_date\n    , fm.term\n    , fm.auto_renew\n    , cb.branch_code\n    , fm.org_amount\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003 fm\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__fddm_product fp ON fm.product_sk = fp.product_sk\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__csdm_branch cb ON fm.branch_sk = cb.branch_code_sk\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master002 fm2 ON fm.account_sk = fm2.account_sk\n  \n  WHERE fm.etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n  AND fm.open_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, fd_account_update AS (\n  SELECT\n    customer_number\n    , account_number\n    , currency_type\n    , product_code\n    , open_date\n    , term\n    , auto_renew\n    , branch_code\n    , org_amount\n  FROM\n    \"oracle_dgaworkzone\".int.int__fd_account\n  WHERE\n    currency_type <> 'VND'\n    AND account_number IS NOT NULL\n)\n, fd_account AS (\n  SELECT\n      CAST(customer_number AS NUMBER) AS customer_number\n    , CAST(account_number AS NUMBER) AS account_number\n    , CAST(currency_type AS VARCHAR2(4)) AS currency_type\n    , CAST(product_code AS VARCHAR2(20)) AS product_code\n    , CAST(open_date AS NUMBER) AS open_date\n    , CAST(term AS VARCHAR2(10)) AS term\n    , CAST(auto_renew AS CHAR(1)) AS auto_renew\n    , CAST(branch_code AS NUMBER) AS branch_code\n    , CAST(org_amount AS NUMBER) AS org_amount\n  FROM fd_account_new\n  UNION ALL\n  SELECT * FROM fd_account_update\n  \n)\n, fd_account_ex AS (\n  SELECT\n      fm.customer_number\n    , fm.account_number\n    , fm.currency_type\n    , fm.product_code\n    , fm.open_date\n    , fm.term\n    , fm.auto_renew\n    , fm.branch_code\n    , fm.org_amount\n    , rh.mid_rate\n    , CASE \n        WHEN fm.currency_type = 'VND' THEN fm.org_amount\n        ELSE fm.org_amount * rh.mid_rate \n      END AS lcy_org_amount\n    , fs.subbranch_no\n    , fm1.maturity_date2\n  FROM\n    fd_account fm \n  LEFT JOIN fd_subbrand fs ON fs.account_no = fm.account_number\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history rh\n    ON fm.open_date = to_number(to_char(to_date(rh.datekey, 'YYYYDDD'), 'YYYYMMDD'))\n      AND fm.currency_type = rh.ccy1\n      AND fm.currency_type <> 'VND'\n      AND fm.account_number IS NOT NULL\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master001 fm1 ON fm.account_number = fm1.account_number\n)\n\n, fd_account_subbrand AS (\n  SELECT\n    a.*\n    , fs.subbranch_no AS subbranch_no_new\n    , fm.maturity_date2 AS maturity_date2_new\n  FROM\n    \"oracle_dgaworkzone\".int.int__fd_account a\n  LEFT JOIN fd_subbrand fs on fs.account_no = a.account_number\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master001 fm ON fm.account_number = a.account_number\n  WHERE a.subbranch_no <> fs.subbranch_no\n  OR COALESCE(fm.maturity_date2, 0) <>  COALESCE(a.maturity_date2, 0)\n)\n, fd_account_ex_m AS (\n  SELECT\n      COALESCE( fas.customer_number, fae.customer_number) AS customer_number\n    , COALESCE( fas.account_number, fae.account_number) AS account_number\n    , COALESCE( fas.currency_type, fae.currency_type) AS currency_type\n    , COALESCE( fas.product_code, fae.product_code) AS product_code\n    , COALESCE( fas.open_date, fae.open_date) AS open_date\n    , COALESCE( fas.term, fae.term) AS term\n    , COALESCE( fas.auto_renew, fae.auto_renew) AS auto_renew\n    , COALESCE( fas.branch_code, fae.branch_code) AS branch_code\n    , COALESCE( fas.subbranch_no_new, fae.subbranch_no) AS subbranch_no\n    , COALESCE( fas.org_amount, fae.org_amount) AS org_amount\n    , COALESCE( fae.lcy_org_amount, fas.lcy_org_amount) AS lcy_org_amount\n    , COALESCE( fas.maturity_date2_new, fae.maturity_date2) AS maturity_date2\n  FROM\n    fd_account_subbrand fas\n    FULL JOIN fd_account_ex fae ON fas.account_number = fae.account_number\n)\n\n, fd_hash AS (\n  SELECT\n      to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\n    , fa.*\n    , standard_hash(customer_number\n                                      || '#'\n                                      || account_number\n                                      || '#'\n                                      || currency_type\n                                      || '#'\n                                      || product_code\n                                      || '#'\n                                      || open_date\n                                      || '#'\n                                      || term\n                                      || '#'\n                                      || auto_renew\n                                      || '#'\n                                      || branch_code\n                                      || '#'\n                                      || subbranch_no\n                                      || '#'\n                                      || org_amount\n                                      || '#'\n                                      || lcy_org_amount) AS hash_diff\n\n  FROM fd_account_ex_m fa\n)\nSELECT * FROM fd_hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__fd_account"}, "model.dga_data_model.int__ln_account": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index_if_not_exists"], "nodes": ["model.dga_data_model.stg_landing__loan_master002", "model.dga_data_model.stg_dwh__cydm_rate_history", "model.dga_data_model.stg_dwh__loan_master001", "model.dga_data_model.stg_landing__loan_application_facility", "model.dga_data_model.stg_dwh__cydm_rate_history"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "account_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index_if_not_exists(this, \"original_loan_date\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"account_number\")}}", "transaction": true, "index": null}, {"sql": "{{ create_index_if_not_exists(this, \"customer_number\")}}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "daily", "int__ln_account"], "unique_id": "model.dga_data_model.int__ln_account", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key = 'account_number',\r\n    post_hook=['{{ create_index_if_not_exists(this, \"original_loan_date\")}}',\r\n                '{{ create_index_if_not_exists(this, \"account_number\")}}',\r\n                '{{ create_index_if_not_exists(this, \"customer_number\")}}'\r\n              ]\r\n  )\r\n}}\r\nWITH loan_master AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.customer_number\r\n    , a.account_number\r\n    , a.branch_number\r\n    , c.subbranch_no\r\n    , a.status\r\n    , a.loan_type AS product_code\r\n    , a.short_description\r\n    , a.currency_type\r\n    , a.principal_original_amount\r\n    , decode(a.currency_type, 'VND', a.principal_original_amount, a.principal_original_amount * b.mid_rate) AS lcy_principal_original_amount\r\n    , a.original_loan_date2 AS original_loan_date\r\n    , a.original_maturity_date2 AS original_maturity_date\r\n    , a.final_maturity_date2 AS final_maturity_date\r\n    , a.payoff_date2 AS payoff_date\r\n    , a.status_date2 AS status_date\r\n    , a.interest_rate\r\n    , a.interest_term\r\n    , a.interest_term_code\r\n    , a.letter_of_offer_date_7 AS letter_of_offer_date\r\n    , a.principal_term\r\n    , a.principal_term_code\r\n    , a.payment_frequency\r\n    , a.revolving\r\n    , a.rollover_method\r\n    , a.purpose_code\r\n    , c.purpose_name\r\n    , a.past_due_history_flag\r\n    , af_application_no\r\n    , af_application_cif\r\n    , af_branch_code\r\n    , af_currency\r\n    , af_acf_no\r\n    , af_facility_code\r\n    , af_facility_level\r\n    , af_facility_seq\r\n    , af_facility_mother_code\r\n    , af_facility_mother_seq\r\n    , af_apply_limit\r\n    , af_facility_limit\r\n    , af_approved_limit\r\n    , af_facility_rate\r\n    , af_facility_revolving\r\n    , af_facility_term\r\n    , af_facility_term_code\r\n    , af_purpose_code\r\n    , af_decision_center\r\n    , af_secure_unsecured_partial\r\n    , af_acf_status\r\n    , af_date_approved\r\n    , af_date_of_offer\r\n    , af_date_offer_accepted\r\n    , a.officer\r\n    , c.dealer_id\r\n    , a.principal_balance\r\n  FROM\r\n      {{ ref('stg_landing__loan_master002')}}        a\r\n  LEFT JOIN {{ ref('stg_dwh__cydm_rate_history')}} b\r\n    ON a.currency_type = b.ccy1 AND a.original_loan_date2 = b.datekey\r\n  LEFT JOIN {{ ref('stg_dwh__loan_master001')}} c\r\n    ON a.account_number = c.account_no AND c.rec_current_ind = 'Y'\r\n  LEFT JOIN {{ ref('stg_landing__loan_application_facility')}} d\r\n    ON a.aa_no = d.af_application_no\r\n      AND a.facility_code = d.af_facility_code\r\n      AND a.seq_no = d.af_facility_seq\r\n)\r\n, min_exchange_rate AS (\r\n  SELECT\r\n      ccy1\r\n    , mid_rate\r\n    , ROW_NUMBER() OVER(PARTITION BY ccy1 ORDER BY datekey ) AS rn\r\n  FROM\r\n    {{ ref('stg_dwh__cydm_rate_history')}}\r\n)\r\n, dat_result AS (\r\n  SELECT\r\n      etl_date\r\n    , customer_number\r\n    , account_number\r\n    , branch_number AS branch_code\r\n    , subbranch_no\r\n    , status\r\n    , product_code\r\n    , short_description\r\n    , currency_type\r\n    , principal_original_amount\r\n    , nvl(lcy_principal_original_amount, principal_original_amount * mid_rate) AS lcy_principal_original_amount\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(original_loan_date)) AS original_loan_date\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(original_maturity_date)) AS original_maturity_date\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(final_maturity_date)) AS final_maturity_date\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(payoff_date)) AS payoff_date\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(status_date)) AS status_date\r\n    , interest_rate\r\n    , interest_term\r\n    , interest_term_code\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(letter_of_offer_date)) AS letter_of_offer_date\r\n    , principal_term\r\n    , principal_term_code\r\n    , payment_frequency\r\n    , revolving\r\n    , rollover_method\r\n    , purpose_code\r\n    , purpose_name\r\n    , past_due_history_flag\r\n    , af_application_no\r\n    , af_application_cif\r\n    , af_branch_code\r\n    , af_currency\r\n    , af_acf_no\r\n    , af_facility_code\r\n    , af_facility_level\r\n    , af_facility_seq\r\n    , af_facility_mother_code\r\n    , af_facility_mother_seq\r\n    , af_apply_limit\r\n    , af_facility_limit\r\n    , af_approved_limit\r\n    , af_facility_rate\r\n    , af_facility_revolving\r\n    , af_facility_term\r\n    , af_facility_term_code\r\n    , af_purpose_code\r\n    , af_decision_center\r\n    , af_secure_unsecured_partial\r\n    , af_acf_status\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(af_date_approved)) AS af_date_approved\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(af_date_of_offer)) AS af_date_of_offer\r\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(af_date_offer_accepted)) AS af_date_offer_accepted\r\n    , officer\r\n    , dealer_id\r\n    , principal_balance\r\n  FROM\r\n    loan_master       a\r\n  LEFT JOIN min_exchange_rate b ON a.currency_type = b.ccy1 AND b.rn = 1\r\n)\r\n, dat_hash AS (\r\n  SELECT\r\n      etl_date\r\n    , standard_hash(customer_number\r\n                      || '#'\r\n                      || account_number\r\n                      || '#'\r\n                      || branch_code\r\n                      || '#'\r\n                      || subbranch_no\r\n                      || '#'\r\n                      || status\r\n                      || '#'\r\n                      || product_code\r\n                      || '#'\r\n                      || short_description\r\n                      || '#'\r\n                      || currency_type\r\n                      || '#'\r\n                      || principal_original_amount\r\n                      || '#'\r\n                      || lcy_principal_original_amount\r\n                      || '#'\r\n                      || original_loan_date\r\n                      || '#'\r\n                      || original_maturity_date\r\n                      || '#'\r\n                      || final_maturity_date\r\n                      || '#'\r\n                      || payoff_date\r\n                      || '#'\r\n                      || status_date\r\n                      || '#'\r\n                      || interest_rate\r\n                      || '#'\r\n                      || interest_term\r\n                      || '#'\r\n                      || interest_term_code\r\n                      || '#'\r\n                      || letter_of_offer_date\r\n                      || '#'\r\n                      || principal_term\r\n                      || '#'\r\n                      || principal_term_code\r\n                      || '#'\r\n                      || payment_frequency\r\n                      || '#'\r\n                      || revolving\r\n                      || '#'\r\n                      || rollover_method\r\n                      || '#'\r\n                      || purpose_code\r\n                      || '#'\r\n                      || purpose_name\r\n                      || '#'\r\n                      || past_due_history_flag\r\n                      || '#'\r\n                      || af_application_no\r\n                      || '#'\r\n                      || af_application_cif\r\n                      || '#'\r\n                      || af_branch_code\r\n                      || '#'\r\n                      || af_currency\r\n                      || '#'\r\n                      || af_acf_no\r\n                      || '#'\r\n                      || af_facility_code\r\n                      || '#'\r\n                      || af_facility_level\r\n                      || '#'\r\n                      || af_facility_seq\r\n                      || '#'\r\n                      || af_facility_mother_code\r\n                      || '#'\r\n                      || af_facility_mother_seq\r\n                      || '#'\r\n                      || af_apply_limit\r\n                      || '#'\r\n                      || af_facility_limit\r\n                      || '#'\r\n                      || af_approved_limit\r\n                      || '#'\r\n                      || af_facility_rate\r\n                      || '#'\r\n                      || af_facility_revolving\r\n                      || '#'\r\n                      || af_facility_term\r\n                      || '#'\r\n                      || af_facility_term_code\r\n                      || '#'\r\n                      || af_purpose_code\r\n                      || '#'\r\n                      || af_decision_center\r\n                      || '#'\r\n                      || af_secure_unsecured_partial\r\n                      || '#'\r\n                      || af_acf_status\r\n                      || '#'\r\n                      || af_date_approved\r\n                      || '#'\r\n                      || af_date_of_offer\r\n                      || '#'\r\n                      || af_date_offer_accepted\r\n                      || '#'\r\n                      || officer\r\n                      || '#'\r\n                      || principal_balance\r\n                      ) AS hash_diff\r\n    , customer_number\r\n    , account_number\r\n    , branch_code\r\n    , subbranch_no\r\n    , status\r\n    , product_code\r\n    , short_description\r\n    , currency_type\r\n    , principal_original_amount\r\n    , lcy_principal_original_amount\r\n    , original_loan_date\r\n    , original_maturity_date\r\n    , final_maturity_date\r\n    , payoff_date\r\n    , status_date\r\n    , interest_rate\r\n    , interest_term\r\n    , interest_term_code\r\n    , letter_of_offer_date\r\n    , principal_term\r\n    , principal_term_code\r\n    , payment_frequency\r\n    , revolving\r\n    , rollover_method\r\n    , purpose_code\r\n    , purpose_name\r\n    , past_due_history_flag\r\n    , af_application_no\r\n    , af_application_cif\r\n    , af_branch_code\r\n    , af_currency\r\n    , af_acf_no\r\n    , af_facility_code\r\n    , af_facility_level\r\n    , af_facility_seq\r\n    , af_facility_mother_code\r\n    , af_facility_mother_seq\r\n    , af_apply_limit\r\n    , af_facility_limit\r\n    , af_approved_limit\r\n    , af_facility_rate\r\n    , af_facility_revolving\r\n    , af_facility_term\r\n    , af_facility_term_code\r\n    , af_purpose_code\r\n    , af_decision_center\r\n    , af_secure_unsecured_partial\r\n    , af_acf_status\r\n    , af_date_approved\r\n    , af_date_of_offer\r\n    , af_date_offer_accepted\r\n    , officer\r\n    , dealer_id\r\n    , principal_balance\r\n  FROM\r\n      dat_result\r\n)\r\nSELECT * FROM dat_hash", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\daily\\int__ln_account.sql", "original_file_path": "models\\int\\daily\\int__ln_account.sql", "name": "int__ln_account", "alias": "int__ln_account", "checksum": {"name": "sha256", "checksum": "d99dcb65ddd4382e22ff8156f1f2fb9ced7c2b37528cb5fa7f1e3e2184960d3e"}, "tags": ["pkg_daily"], "refs": [["stg_landing__loan_master002"], ["stg_dwh__cydm_rate_history"], ["stg_dwh__loan_master001"], ["stg_landing__loan_application_facility"], ["stg_dwh__cydm_rate_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\daily\\daily_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\int__ln_account.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "unique_key": "account_number", "post-hook": ["{{ create_index_if_not_exists(this, \"original_loan_date\")}}", "{{ create_index_if_not_exists(this, \"account_number\")}}", "{{ create_index_if_not_exists(this, \"customer_number\")}}"]}, "created_at": 1685959752.7059846, "compiled_code": "\nWITH loan_master AS (\n  SELECT\n      a.etl_date\n    , a.customer_number\n    , a.account_number\n    , a.branch_number\n    , c.subbranch_no\n    , a.status\n    , a.loan_type AS product_code\n    , a.short_description\n    , a.currency_type\n    , a.principal_original_amount\n    , decode(a.currency_type, 'VND', a.principal_original_amount, a.principal_original_amount * b.mid_rate) AS lcy_principal_original_amount\n    , a.original_loan_date2 AS original_loan_date\n    , a.original_maturity_date2 AS original_maturity_date\n    , a.final_maturity_date2 AS final_maturity_date\n    , a.payoff_date2 AS payoff_date\n    , a.status_date2 AS status_date\n    , a.interest_rate\n    , a.interest_term\n    , a.interest_term_code\n    , a.letter_of_offer_date_7 AS letter_of_offer_date\n    , a.principal_term\n    , a.principal_term_code\n    , a.payment_frequency\n    , a.revolving\n    , a.rollover_method\n    , a.purpose_code\n    , c.purpose_name\n    , a.past_due_history_flag\n    , af_application_no\n    , af_application_cif\n    , af_branch_code\n    , af_currency\n    , af_acf_no\n    , af_facility_code\n    , af_facility_level\n    , af_facility_seq\n    , af_facility_mother_code\n    , af_facility_mother_seq\n    , af_apply_limit\n    , af_facility_limit\n    , af_approved_limit\n    , af_facility_rate\n    , af_facility_revolving\n    , af_facility_term\n    , af_facility_term_code\n    , af_purpose_code\n    , af_decision_center\n    , af_secure_unsecured_partial\n    , af_acf_status\n    , af_date_approved\n    , af_date_of_offer\n    , af_date_offer_accepted\n    , a.officer\n    , c.dealer_id\n    , a.principal_balance\n  FROM\n      \"oracle_dgaworkzone\".staging.stg_landing__loan_master002        a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history b\n    ON a.currency_type = b.ccy1 AND a.original_loan_date2 = b.datekey\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__loan_master001 c\n    ON a.account_number = c.account_no AND c.rec_current_ind = 'Y'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__loan_application_facility d\n    ON a.aa_no = d.af_application_no\n      AND a.facility_code = d.af_facility_code\n      AND a.seq_no = d.af_facility_seq\n)\n, min_exchange_rate AS (\n  SELECT\n      ccy1\n    , mid_rate\n    , ROW_NUMBER() OVER(PARTITION BY ccy1 ORDER BY datekey ) AS rn\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history\n)\n, dat_result AS (\n  SELECT\n      etl_date\n    , customer_number\n    , account_number\n    , branch_number AS branch_code\n    , subbranch_no\n    , status\n    , product_code\n    , short_description\n    , currency_type\n    , principal_original_amount\n    , nvl(lcy_principal_original_amount, principal_original_amount * mid_rate) AS lcy_principal_original_amount\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(original_loan_date)) AS original_loan_date\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(original_maturity_date)) AS original_maturity_date\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(final_maturity_date)) AS final_maturity_date\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(payoff_date)) AS payoff_date\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(status_date)) AS status_date\n    , interest_rate\n    , interest_term\n    , interest_term_code\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(letter_of_offer_date)) AS letter_of_offer_date\n    , principal_term\n    , principal_term_code\n    , payment_frequency\n    , revolving\n    , rollover_method\n    , purpose_code\n    , purpose_name\n    , past_due_history_flag\n    , af_application_no\n    , af_application_cif\n    , af_branch_code\n    , af_currency\n    , af_acf_no\n    , af_facility_code\n    , af_facility_level\n    , af_facility_seq\n    , af_facility_mother_code\n    , af_facility_mother_seq\n    , af_apply_limit\n    , af_facility_limit\n    , af_approved_limit\n    , af_facility_rate\n    , af_facility_revolving\n    , af_facility_term\n    , af_facility_term_code\n    , af_purpose_code\n    , af_decision_center\n    , af_secure_unsecured_partial\n    , af_acf_status\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(af_date_approved)) AS af_date_approved\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(af_date_of_offer)) AS af_date_of_offer\n    , fnc_convert_date_to_date_id(is_date_yyyyddd(af_date_offer_accepted)) AS af_date_offer_accepted\n    , officer\n    , dealer_id\n    , principal_balance\n  FROM\n    loan_master       a\n  LEFT JOIN min_exchange_rate b ON a.currency_type = b.ccy1 AND b.rn = 1\n)\n, dat_hash AS (\n  SELECT\n      etl_date\n    , standard_hash(customer_number\n                      || '#'\n                      || account_number\n                      || '#'\n                      || branch_code\n                      || '#'\n                      || subbranch_no\n                      || '#'\n                      || status\n                      || '#'\n                      || product_code\n                      || '#'\n                      || short_description\n                      || '#'\n                      || currency_type\n                      || '#'\n                      || principal_original_amount\n                      || '#'\n                      || lcy_principal_original_amount\n                      || '#'\n                      || original_loan_date\n                      || '#'\n                      || original_maturity_date\n                      || '#'\n                      || final_maturity_date\n                      || '#'\n                      || payoff_date\n                      || '#'\n                      || status_date\n                      || '#'\n                      || interest_rate\n                      || '#'\n                      || interest_term\n                      || '#'\n                      || interest_term_code\n                      || '#'\n                      || letter_of_offer_date\n                      || '#'\n                      || principal_term\n                      || '#'\n                      || principal_term_code\n                      || '#'\n                      || payment_frequency\n                      || '#'\n                      || revolving\n                      || '#'\n                      || rollover_method\n                      || '#'\n                      || purpose_code\n                      || '#'\n                      || purpose_name\n                      || '#'\n                      || past_due_history_flag\n                      || '#'\n                      || af_application_no\n                      || '#'\n                      || af_application_cif\n                      || '#'\n                      || af_branch_code\n                      || '#'\n                      || af_currency\n                      || '#'\n                      || af_acf_no\n                      || '#'\n                      || af_facility_code\n                      || '#'\n                      || af_facility_level\n                      || '#'\n                      || af_facility_seq\n                      || '#'\n                      || af_facility_mother_code\n                      || '#'\n                      || af_facility_mother_seq\n                      || '#'\n                      || af_apply_limit\n                      || '#'\n                      || af_facility_limit\n                      || '#'\n                      || af_approved_limit\n                      || '#'\n                      || af_facility_rate\n                      || '#'\n                      || af_facility_revolving\n                      || '#'\n                      || af_facility_term\n                      || '#'\n                      || af_facility_term_code\n                      || '#'\n                      || af_purpose_code\n                      || '#'\n                      || af_decision_center\n                      || '#'\n                      || af_secure_unsecured_partial\n                      || '#'\n                      || af_acf_status\n                      || '#'\n                      || af_date_approved\n                      || '#'\n                      || af_date_of_offer\n                      || '#'\n                      || af_date_offer_accepted\n                      || '#'\n                      || officer\n                      || '#'\n                      || principal_balance\n                      ) AS hash_diff\n    , customer_number\n    , account_number\n    , branch_code\n    , subbranch_no\n    , status\n    , product_code\n    , short_description\n    , currency_type\n    , principal_original_amount\n    , lcy_principal_original_amount\n    , original_loan_date\n    , original_maturity_date\n    , final_maturity_date\n    , payoff_date\n    , status_date\n    , interest_rate\n    , interest_term\n    , interest_term_code\n    , letter_of_offer_date\n    , principal_term\n    , principal_term_code\n    , payment_frequency\n    , revolving\n    , rollover_method\n    , purpose_code\n    , purpose_name\n    , past_due_history_flag\n    , af_application_no\n    , af_application_cif\n    , af_branch_code\n    , af_currency\n    , af_acf_no\n    , af_facility_code\n    , af_facility_level\n    , af_facility_seq\n    , af_facility_mother_code\n    , af_facility_mother_seq\n    , af_apply_limit\n    , af_facility_limit\n    , af_approved_limit\n    , af_facility_rate\n    , af_facility_revolving\n    , af_facility_term\n    , af_facility_term_code\n    , af_purpose_code\n    , af_decision_center\n    , af_secure_unsecured_partial\n    , af_acf_status\n    , af_date_approved\n    , af_date_of_offer\n    , af_date_offer_accepted\n    , officer\n    , dealer_id\n    , principal_balance\n  FROM\n      dat_result\n)\nSELECT * FROM dat_hash", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int__ln_account"}, "model.dga_data_model.agg_clos_limit_tree_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.mart.dim_clos_limit_tree", "model.dga_data_model.fact_clos_decision"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["los_tf", "clos"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "los", "agg_clos_limit_tree_detail"], "unique_id": "model.dga_data_model.agg_clos_limit_tree_detail", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\n\r\nWITH product_level AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        (\r\n            SELECT DISTINCT\r\n                level_2 code,\r\n                2       level_product\r\n            FROM\r\n                {{ source('mart', 'dim_clos_limit_tree') }}\r\n            UNION ALL\r\n            SELECT DISTINCT\r\n                level_3 code,\r\n                3       level_product\r\n            FROM\r\n                {{ source('mart', 'dim_clos_limit_tree') }}\r\n            UNION ALL\r\n            SELECT DISTINCT\r\n                level_4 code,\r\n                4       level_product\r\n            FROM\r\n               {{ source('mart', 'dim_clos_limit_tree') }}\r\n            UNION ALL\r\n            SELECT DISTINCT\r\n                level_5 code,\r\n                5       level_product\r\n            FROM\r\n                {{ source('mart', 'dim_clos_limit_tree') }}\r\n        )\r\n    WHERE\r\n        code IS NOT NULL\r\n), t1 AS (\r\n    SELECT\r\n        \"SOURCE\",\r\n        limit_application_id,\r\n        app_number,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount,\r\n        existing_limt_existing_amt,\r\n        increase_decrease,\r\n        limit_id,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        limit_end_date,\r\n        availability_end_date,\r\n        availableperiod_months,\r\n        availableperiod_days,\r\n        limitdecision,\r\n        limit_classification,\r\n        relationship_level,\r\n        effective_date,\r\n        office_code,\r\n        created_at\r\n    FROM\r\n               {{ ref('fact_clos_decision') }}\r\n        JOIN product_level ON product_level.code = limit_classification\r\n        )\r\n, tb_lv0 AS (\r\n    SELECT\r\n        limit_application_id,\r\n        app_number,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        relationship_level,\r\n        limit_classification,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount\r\n    FROM\r\n        t1\r\n    WHERE\r\n        relationship_level = 0\r\n), tb_lv1 AS (\r\n    SELECT\r\n        limit_application_id,\r\n        app_number,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        relationship_level,\r\n        limit_classification,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount\r\n    FROM\r\n        t1\r\n    WHERE\r\n        relationship_level = 1\r\n), tb_lv2 AS (\r\n    SELECT\r\n        limit_application_id,\r\n        app_number,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        relationship_level,\r\n        limit_classification,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount\r\n    FROM\r\n        t1\r\n    WHERE\r\n        relationship_level = 2\r\n), tb_lv3 AS (\r\n    SELECT\r\n        limit_application_id,\r\n        app_number,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        relationship_level,\r\n        limit_classification,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount\r\n    FROM\r\n        t1\r\n    WHERE\r\n        relationship_level = 3\r\n), tb_lv4 AS (\r\n    SELECT\r\n        limit_application_id,\r\n        app_number,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        relationship_level,\r\n        limit_classification,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount\r\n    FROM\r\n        t1\r\n    WHERE\r\n        relationship_level = 4\r\n), tb_lv5 AS (\r\n    SELECT\r\n        limit_application_id,\r\n        app_number,\r\n        limit_ref_number,\r\n        parent_limit_ref_number,\r\n        relationship_level,\r\n        limit_classification,\r\n        approved_limit,\r\n        proposed_limit,\r\n        final_limit_amount\r\n    FROM\r\n        t1\r\n    WHERE\r\n        relationship_level = 5\r\n), cal_tbl AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n             (\r\n            SELECT\r\n                coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\r\n                , tb_lv4.limit_application_id,\r\n                         tb_lv5.limit_application_id)           AS limit_application_id,\r\n                coalesce(tb_lv0.app_number, tb_lv1.app_number, tb_lv2.app_number, tb_lv3.app_number, tb_lv4.app_number,\r\n                         tb_lv5.app_number)                     AS app_number,\r\n                coalesce(tb_lv2.limit_classification, '000')\r\n                || coalesce(tb_lv3.limit_classification, '000')\r\n                || coalesce(tb_lv4.limit_classification, '000')\r\n                || coalesce(tb_lv5.limit_classification, '000') AS product_id,\r\n                tb_lv0.limit_ref_number                         lv0_limit_ref_number,\r\n                tb_lv0.parent_limit_ref_number                  lv0_parent_limit_ref_number,\r\n                tb_lv0.relationship_level                       lv0_relationship_level,\r\n                tb_lv0.approved_limit                           lv0_approved_limit,\r\n                tb_lv0.proposed_limit                           lv0_proposed_limit,\r\n                tb_lv0.final_limit_amount                       lv0_final_limit_amount,\r\n                tb_lv0.limit_classification                     lv0_limit_classification,\r\n                tb_lv1.limit_ref_number                         lv1_limit_ref_number,\r\n                tb_lv1.parent_limit_ref_number                  lv1_parent_limit_ref_number,\r\n                tb_lv1.relationship_level                       lv1_relationship_level,\r\n                tb_lv1.approved_limit                           lv1_approved_limit,\r\n                tb_lv1.proposed_limit                           lv1_proposed_limit,\r\n                tb_lv1.final_limit_amount                       lv1_final_limit_amount,\r\n                tb_lv1.limit_classification                     lv1_limit_classification,\r\n                tb_lv2.limit_ref_number                         lv2_limit_ref_number,\r\n                tb_lv2.parent_limit_ref_number                  lv2_parent_limit_ref_number,\r\n                tb_lv2.relationship_level                       lv2_relationship_level,\r\n                tb_lv2.approved_limit                           lv2_approved_limit,\r\n                tb_lv2.proposed_limit                           lv2_proposed_limit,\r\n                tb_lv2.final_limit_amount                       lv2_final_limit_amount,\r\n                tb_lv2.limit_classification                     lv2_limit_classification,\r\n                tb_lv3.limit_ref_number                         lv3_limit_ref_number,\r\n                tb_lv3.parent_limit_ref_number                  lv3_parent_limit_ref_number,\r\n                tb_lv3.relationship_level                       lv3_relationship_level,\r\n                tb_lv3.approved_limit                           lv3_approved_limit,\r\n                tb_lv3.proposed_limit                           lv3_proposed_limit,\r\n                tb_lv3.final_limit_amount                       lv3_final_limit_amount,\r\n                tb_lv4.limit_ref_number                         lv4_limit_ref_number,\r\n                tb_lv4.parent_limit_ref_number                  lv4_parent_limit_ref_number,\r\n                tb_lv4.relationship_level                       lv4_relationship_level,\r\n                tb_lv4.approved_limit                           lv4_approved_limit,\r\n                tb_lv4.proposed_limit                           lv4_proposed_limit,\r\n                tb_lv4.final_limit_amount                       lv4_final_limit_amount,\r\n                tb_lv5.limit_ref_number                         lv5_limit_ref_number,\r\n                tb_lv5.parent_limit_ref_number                  lv5_parent_limit_ref_number,\r\n                tb_lv5.relationship_level                       lv5_relationship_level,\r\n                tb_lv5.approved_limit                           lv5_approved_limit,\r\n                tb_lv5.proposed_limit                           lv5_proposed_limit,\r\n                tb_lv5.final_limit_amount                       lv5_final_limit_amount\r\n            FROM\r\n                     tb_lv0 full\r\n                JOIN tb_lv1 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id) = tb_lv1.limit_application_id\r\n                               AND tb_lv1.parent_limit_ref_number = tb_lv0.limit_ref_number\r\n                FULL JOIN tb_lv2 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id) = tb_lv2.limit_application_id\r\n                                    AND tb_lv2.parent_limit_ref_number = tb_lv1.limit_ref_number\r\n                FULL JOIN tb_lv3 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\r\n                ) = tb_lv3.limit_application_id\r\n                                    AND tb_lv3.parent_limit_ref_number = tb_lv2.limit_ref_number\r\n                FULL JOIN tb_lv4 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\r\n                , tb_lv4.limit_application_id) = tb_lv4.limit_application_id\r\n                                    AND tb_lv4.parent_limit_ref_number = tb_lv3.limit_ref_number\r\n                FULL JOIN tb_lv5 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\r\n                , tb_lv4.limit_application_id,\r\n                                                 tb_lv5.limit_application_id) = tb_lv5.limit_application_id\r\n                                    AND tb_lv5.parent_limit_ref_number = tb_lv4.limit_ref_number\r\n        ) t1\r\n        INNER JOIN   {{ source('mart', 'dim_clos_limit_tree') }} USING ( product_id )\r\n), output AS (\r\n    SELECT DISTINCT\r\n        limit_application_id,\r\n        app_number,\r\n        product_id,\r\n        product_name,\r\n        coalesce(lv0_limit_ref_number, lv1_limit_ref_number, lv2_limit_ref_number, lv3_limit_ref_number, lv4_limit_ref_number,\r\n                 lv5_limit_ref_number) first_level_limit_ref_number,\r\n        coalesce(lv5_limit_ref_number, lv4_limit_ref_number, lv3_limit_ref_number, lv2_limit_ref_number, lv1_limit_ref_number,\r\n                 lv0_limit_ref_number) last_level_limit_ref_number,\r\n        CASE\r\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\r\n                lv0_relationship_level\r\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\r\n                lv1_relationship_level\r\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\r\n                lv2_relationship_level\r\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\r\n                lv3_relationship_level\r\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\r\n                lv4_relationship_level\r\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\r\n                lv5_relationship_level\r\n        END                            first_relationship_level,\r\n        CASE\r\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\r\n                lv5_relationship_level\r\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\r\n                lv4_relationship_level\r\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\r\n                lv3_relationship_level\r\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\r\n                lv2_relationship_level\r\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\r\n                lv1_relationship_level\r\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\r\n                lv0_relationship_level\r\n        END                            last_relationship_level,\r\n        CASE\r\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\r\n                lv0_final_limit_amount\r\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\r\n                lv1_final_limit_amount\r\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\r\n                lv2_final_limit_amount\r\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\r\n                lv3_final_limit_amount\r\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\r\n                lv4_final_limit_amount\r\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\r\n                lv5_final_limit_amount\r\n        END                            first_level_amount,\r\n        CASE\r\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\r\n                lv5_final_limit_amount\r\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\r\n                lv4_final_limit_amount\r\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\r\n                lv3_final_limit_amount\r\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\r\n                lv2_final_limit_amount\r\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\r\n                lv1_final_limit_amount\r\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\r\n                lv0_final_limit_amount\r\n        END                            last_level_amount\r\n    FROM\r\n        (\r\n            SELECT\r\n                limit_application_id,\r\n                app_number,\r\n                product_id,\r\n                product_name,\r\n                lv0_limit_ref_number,\r\n                lv1_limit_ref_number,\r\n                lv2_limit_ref_number,\r\n                lv3_limit_ref_number,\r\n                lv4_limit_ref_number,\r\n                lv5_limit_ref_number,\r\n                CASE\r\n                    WHEN lv0_final_limit_amount IS NULL THEN\r\n                        0\r\n                    ELSE\r\n                        lv0_final_limit_amount\r\n                END AS lv0_final_limit_amount,\r\n                CASE\r\n                    WHEN lv1_final_limit_amount IS NULL THEN\r\n                        0\r\n                    ELSE\r\n                        lv1_final_limit_amount\r\n                END AS lv1_final_limit_amount,\r\n                CASE\r\n                    WHEN lv2_final_limit_amount IS NULL THEN\r\n                        0\r\n                    ELSE\r\n                        lv2_final_limit_amount\r\n                END AS lv2_final_limit_amount,\r\n                CASE\r\n                    WHEN lv3_final_limit_amount IS NULL THEN\r\n                        0\r\n                    ELSE\r\n                        lv3_final_limit_amount\r\n                END AS lv3_final_limit_amount,\r\n                CASE\r\n                    WHEN lv4_final_limit_amount IS NULL THEN\r\n                        0\r\n                    ELSE\r\n                        lv4_final_limit_amount\r\n                END AS lv4_final_limit_amount,\r\n                CASE\r\n                    WHEN lv5_final_limit_amount IS NULL THEN\r\n                        0\r\n                    ELSE\r\n                        lv5_final_limit_amount\r\n                END AS lv5_final_limit_amount,\r\n                lv0_relationship_level,\r\n                lv1_relationship_level,\r\n                lv2_relationship_level,\r\n                lv3_relationship_level,\r\n                lv4_relationship_level,\r\n                lv5_relationship_level,\r\n                product_name_group,\r\n                product_sme,\r\n                product_msme,\r\n                sme,\r\n                m_sme\r\n            FROM\r\n                cal_tbl\r\n        )\r\n)\r\n\r\n\r\nSELECT\r\n    *\r\nFROM\r\n    output", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\los\\agg_clos_limit_tree_detail.sql", "original_file_path": "models\\int\\los\\agg_clos_limit_tree_detail.sql", "name": "agg_clos_limit_tree_detail", "alias": "agg_clos_limit_tree_detail", "checksum": {"name": "sha256", "checksum": "fa6c616e1a49459287ac99a6441b69723e953f896348de652bb3cc19fc934395"}, "tags": ["los_tf", "clos"], "refs": [["fact_clos_decision"]], "sources": [["mart", "dim_clos_limit_tree"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\los\\int_los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\agg_clos_limit_tree_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "huyendtk3"}, "tags": ["clos"], "materialized": "table"}, "created_at": 1685959752.7299783, "compiled_code": "\n\nWITH product_level AS (\n    SELECT\n        *\n    FROM\n        (\n            SELECT DISTINCT\n                level_2 code,\n                2       level_product\n            FROM\n                oracle_dgaworkzone.mart.dim_clos_limit_tree\n            UNION ALL\n            SELECT DISTINCT\n                level_3 code,\n                3       level_product\n            FROM\n                oracle_dgaworkzone.mart.dim_clos_limit_tree\n            UNION ALL\n            SELECT DISTINCT\n                level_4 code,\n                4       level_product\n            FROM\n               oracle_dgaworkzone.mart.dim_clos_limit_tree\n            UNION ALL\n            SELECT DISTINCT\n                level_5 code,\n                5       level_product\n            FROM\n                oracle_dgaworkzone.mart.dim_clos_limit_tree\n        )\n    WHERE\n        code IS NOT NULL\n), t1 AS (\n    SELECT\n        \"SOURCE\",\n        limit_application_id,\n        app_number,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount,\n        existing_limt_existing_amt,\n        increase_decrease,\n        limit_id,\n        limit_ref_number,\n        parent_limit_ref_number,\n        limit_end_date,\n        availability_end_date,\n        availableperiod_months,\n        availableperiod_days,\n        limitdecision,\n        limit_classification,\n        relationship_level,\n        effective_date,\n        office_code,\n        created_at\n    FROM\n               \"oracle_dgaworkzone\".mart.fact_clos_decision\n        JOIN product_level ON product_level.code = limit_classification\n        )\n, tb_lv0 AS (\n    SELECT\n        limit_application_id,\n        app_number,\n        limit_ref_number,\n        parent_limit_ref_number,\n        relationship_level,\n        limit_classification,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount\n    FROM\n        t1\n    WHERE\n        relationship_level = 0\n), tb_lv1 AS (\n    SELECT\n        limit_application_id,\n        app_number,\n        limit_ref_number,\n        parent_limit_ref_number,\n        relationship_level,\n        limit_classification,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount\n    FROM\n        t1\n    WHERE\n        relationship_level = 1\n), tb_lv2 AS (\n    SELECT\n        limit_application_id,\n        app_number,\n        limit_ref_number,\n        parent_limit_ref_number,\n        relationship_level,\n        limit_classification,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount\n    FROM\n        t1\n    WHERE\n        relationship_level = 2\n), tb_lv3 AS (\n    SELECT\n        limit_application_id,\n        app_number,\n        limit_ref_number,\n        parent_limit_ref_number,\n        relationship_level,\n        limit_classification,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount\n    FROM\n        t1\n    WHERE\n        relationship_level = 3\n), tb_lv4 AS (\n    SELECT\n        limit_application_id,\n        app_number,\n        limit_ref_number,\n        parent_limit_ref_number,\n        relationship_level,\n        limit_classification,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount\n    FROM\n        t1\n    WHERE\n        relationship_level = 4\n), tb_lv5 AS (\n    SELECT\n        limit_application_id,\n        app_number,\n        limit_ref_number,\n        parent_limit_ref_number,\n        relationship_level,\n        limit_classification,\n        approved_limit,\n        proposed_limit,\n        final_limit_amount\n    FROM\n        t1\n    WHERE\n        relationship_level = 5\n), cal_tbl AS (\n    SELECT\n        *\n    FROM\n             (\n            SELECT\n                coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\n                , tb_lv4.limit_application_id,\n                         tb_lv5.limit_application_id)           AS limit_application_id,\n                coalesce(tb_lv0.app_number, tb_lv1.app_number, tb_lv2.app_number, tb_lv3.app_number, tb_lv4.app_number,\n                         tb_lv5.app_number)                     AS app_number,\n                coalesce(tb_lv2.limit_classification, '000')\n                || coalesce(tb_lv3.limit_classification, '000')\n                || coalesce(tb_lv4.limit_classification, '000')\n                || coalesce(tb_lv5.limit_classification, '000') AS product_id,\n                tb_lv0.limit_ref_number                         lv0_limit_ref_number,\n                tb_lv0.parent_limit_ref_number                  lv0_parent_limit_ref_number,\n                tb_lv0.relationship_level                       lv0_relationship_level,\n                tb_lv0.approved_limit                           lv0_approved_limit,\n                tb_lv0.proposed_limit                           lv0_proposed_limit,\n                tb_lv0.final_limit_amount                       lv0_final_limit_amount,\n                tb_lv0.limit_classification                     lv0_limit_classification,\n                tb_lv1.limit_ref_number                         lv1_limit_ref_number,\n                tb_lv1.parent_limit_ref_number                  lv1_parent_limit_ref_number,\n                tb_lv1.relationship_level                       lv1_relationship_level,\n                tb_lv1.approved_limit                           lv1_approved_limit,\n                tb_lv1.proposed_limit                           lv1_proposed_limit,\n                tb_lv1.final_limit_amount                       lv1_final_limit_amount,\n                tb_lv1.limit_classification                     lv1_limit_classification,\n                tb_lv2.limit_ref_number                         lv2_limit_ref_number,\n                tb_lv2.parent_limit_ref_number                  lv2_parent_limit_ref_number,\n                tb_lv2.relationship_level                       lv2_relationship_level,\n                tb_lv2.approved_limit                           lv2_approved_limit,\n                tb_lv2.proposed_limit                           lv2_proposed_limit,\n                tb_lv2.final_limit_amount                       lv2_final_limit_amount,\n                tb_lv2.limit_classification                     lv2_limit_classification,\n                tb_lv3.limit_ref_number                         lv3_limit_ref_number,\n                tb_lv3.parent_limit_ref_number                  lv3_parent_limit_ref_number,\n                tb_lv3.relationship_level                       lv3_relationship_level,\n                tb_lv3.approved_limit                           lv3_approved_limit,\n                tb_lv3.proposed_limit                           lv3_proposed_limit,\n                tb_lv3.final_limit_amount                       lv3_final_limit_amount,\n                tb_lv4.limit_ref_number                         lv4_limit_ref_number,\n                tb_lv4.parent_limit_ref_number                  lv4_parent_limit_ref_number,\n                tb_lv4.relationship_level                       lv4_relationship_level,\n                tb_lv4.approved_limit                           lv4_approved_limit,\n                tb_lv4.proposed_limit                           lv4_proposed_limit,\n                tb_lv4.final_limit_amount                       lv4_final_limit_amount,\n                tb_lv5.limit_ref_number                         lv5_limit_ref_number,\n                tb_lv5.parent_limit_ref_number                  lv5_parent_limit_ref_number,\n                tb_lv5.relationship_level                       lv5_relationship_level,\n                tb_lv5.approved_limit                           lv5_approved_limit,\n                tb_lv5.proposed_limit                           lv5_proposed_limit,\n                tb_lv5.final_limit_amount                       lv5_final_limit_amount\n            FROM\n                     tb_lv0 full\n                JOIN tb_lv1 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id) = tb_lv1.limit_application_id\n                               AND tb_lv1.parent_limit_ref_number = tb_lv0.limit_ref_number\n                FULL JOIN tb_lv2 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id) = tb_lv2.limit_application_id\n                                    AND tb_lv2.parent_limit_ref_number = tb_lv1.limit_ref_number\n                FULL JOIN tb_lv3 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\n                ) = tb_lv3.limit_application_id\n                                    AND tb_lv3.parent_limit_ref_number = tb_lv2.limit_ref_number\n                FULL JOIN tb_lv4 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\n                , tb_lv4.limit_application_id) = tb_lv4.limit_application_id\n                                    AND tb_lv4.parent_limit_ref_number = tb_lv3.limit_ref_number\n                FULL JOIN tb_lv5 ON coalesce(tb_lv0.limit_application_id, tb_lv1.limit_application_id, tb_lv2.limit_application_id, tb_lv3.limit_application_id\n                , tb_lv4.limit_application_id,\n                                                 tb_lv5.limit_application_id) = tb_lv5.limit_application_id\n                                    AND tb_lv5.parent_limit_ref_number = tb_lv4.limit_ref_number\n        ) t1\n        INNER JOIN   oracle_dgaworkzone.mart.dim_clos_limit_tree USING ( product_id )\n), output AS (\n    SELECT DISTINCT\n        limit_application_id,\n        app_number,\n        product_id,\n        product_name,\n        coalesce(lv0_limit_ref_number, lv1_limit_ref_number, lv2_limit_ref_number, lv3_limit_ref_number, lv4_limit_ref_number,\n                 lv5_limit_ref_number) first_level_limit_ref_number,\n        coalesce(lv5_limit_ref_number, lv4_limit_ref_number, lv3_limit_ref_number, lv2_limit_ref_number, lv1_limit_ref_number,\n                 lv0_limit_ref_number) last_level_limit_ref_number,\n        CASE\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\n                lv0_relationship_level\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\n                lv1_relationship_level\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\n                lv2_relationship_level\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\n                lv3_relationship_level\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\n                lv4_relationship_level\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\n                lv5_relationship_level\n        END                            first_relationship_level,\n        CASE\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\n                lv5_relationship_level\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\n                lv4_relationship_level\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\n                lv3_relationship_level\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\n                lv2_relationship_level\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\n                lv1_relationship_level\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\n                lv0_relationship_level\n        END                            last_relationship_level,\n        CASE\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\n                lv0_final_limit_amount\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\n                lv1_final_limit_amount\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\n                lv2_final_limit_amount\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\n                lv3_final_limit_amount\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\n                lv4_final_limit_amount\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\n                lv5_final_limit_amount\n        END                            first_level_amount,\n        CASE\n            WHEN lv5_limit_ref_number IS NOT NULL THEN\n                lv5_final_limit_amount\n            WHEN lv4_limit_ref_number IS NOT NULL THEN\n                lv4_final_limit_amount\n            WHEN lv3_limit_ref_number IS NOT NULL THEN\n                lv3_final_limit_amount\n            WHEN lv2_limit_ref_number IS NOT NULL THEN\n                lv2_final_limit_amount\n            WHEN lv1_limit_ref_number IS NOT NULL THEN\n                lv1_final_limit_amount\n            WHEN lv0_limit_ref_number IS NOT NULL THEN\n                lv0_final_limit_amount\n        END                            last_level_amount\n    FROM\n        (\n            SELECT\n                limit_application_id,\n                app_number,\n                product_id,\n                product_name,\n                lv0_limit_ref_number,\n                lv1_limit_ref_number,\n                lv2_limit_ref_number,\n                lv3_limit_ref_number,\n                lv4_limit_ref_number,\n                lv5_limit_ref_number,\n                CASE\n                    WHEN lv0_final_limit_amount IS NULL THEN\n                        0\n                    ELSE\n                        lv0_final_limit_amount\n                END AS lv0_final_limit_amount,\n                CASE\n                    WHEN lv1_final_limit_amount IS NULL THEN\n                        0\n                    ELSE\n                        lv1_final_limit_amount\n                END AS lv1_final_limit_amount,\n                CASE\n                    WHEN lv2_final_limit_amount IS NULL THEN\n                        0\n                    ELSE\n                        lv2_final_limit_amount\n                END AS lv2_final_limit_amount,\n                CASE\n                    WHEN lv3_final_limit_amount IS NULL THEN\n                        0\n                    ELSE\n                        lv3_final_limit_amount\n                END AS lv3_final_limit_amount,\n                CASE\n                    WHEN lv4_final_limit_amount IS NULL THEN\n                        0\n                    ELSE\n                        lv4_final_limit_amount\n                END AS lv4_final_limit_amount,\n                CASE\n                    WHEN lv5_final_limit_amount IS NULL THEN\n                        0\n                    ELSE\n                        lv5_final_limit_amount\n                END AS lv5_final_limit_amount,\n                lv0_relationship_level,\n                lv1_relationship_level,\n                lv2_relationship_level,\n                lv3_relationship_level,\n                lv4_relationship_level,\n                lv5_relationship_level,\n                product_name_group,\n                product_sme,\n                product_msme,\n                sme,\n                m_sme\n            FROM\n                cal_tbl\n        )\n)\n\n\nSELECT\n    *\nFROM\n    output", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.agg_clos_limit_tree_detail"}, "model.dga_data_model.int_los__application_relation": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicantidentitydetail", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__creditcardproduct", "model.dga_data_model.stg_rb_los__decision", "model.dga_data_model.stg_rb_los__opportunities", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__applicantaddress", "model.dga_data_model.stg_rb_los__syncapplicantaddressmap", "model.dga_data_model.stg_rb_los__addressdetail", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__slbccodemapping", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_rb_los__person", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "los", "int_los__application_relation"], "unique_id": "model.dga_data_model.int_los__application_relation", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH identity_number AS (\r\n  SELECT\r\n    applicantid\r\n    , LISTAGG(\r\n        CASE prefuniqueidind\r\n          WHEN 'Y' THEN documentuniqueid || '(' || prefuniqueidind || ')'\r\n          ELSE documentuniqueid\r\n        END, ',')\r\n      WITHIN GROUP( ORDER BY applicantidentitydetailid\r\n    ) AS identity_number\r\nFROM\r\n  {{ ref('los__applicantidentitydetail')}}\r\nGROUP BY\r\n    applicantid\r\n)\r\n, phone_number AS (\r\n  SELECT\r\n    t8.applicantid\r\n    , LISTAGG(t81.phonenumlocalcode, ',' ON OVERFLOW TRUNCATE)\r\n      WITHIN GROUP( ORDER BY t81.applicantcontactphnemllistid\r\n      ) AS phone_number\r\nFROM\r\n  {{ ref('stg_rb_los__applicantcontact')}} t8\r\n  INNER JOIN {{ ref('stg_rb_los__applicantcontactphnemllist')}} t81\r\n    ON t81.applicantcontactid = t8.applicantcontactid\r\n      AND t81.bank_id = 'DFBANK1'\r\n      AND t8.deleteflag <> 'Y'\r\n      AND ( t8.prefcontactnotype = 'MP'\r\n        OR t8.prefcontactnotype = 'HP' )\r\nGROUP BY\r\n    t8.applicantid\r\n)\r\n, email AS (\r\n  SELECT\r\n    t8.applicantid\r\n    , LISTAGG(t81.emailid, ',' ON OVERFLOW TRUNCATE)\r\n      WITHIN GROUP( ORDER BY t81.applicantcontactphnemllistid\r\n        ) AS email\r\nFROM\r\n  {{ ref('stg_rb_los__applicantcontact')}} t8\r\n  INNER JOIN {{ ref('stg_rb_los__applicantcontactphnemllist')}} t81\r\n    ON t81.applicantcontactid = t8.applicantcontactid\r\n      AND t81.bank_id = 'DFBANK1'\r\n      AND t8.deleteflag <> 'Y'\r\n      AND t8.prefemailidtype = 'EM'\r\nGROUP BY\r\n    t8.applicantid\r\n)\r\n, accountnumber AS (\r\n  SELECT\r\n      ccp.applicationdetailsid\r\n    , ccp.accountnumber\r\n    , ROW_NUMBER() OVER(PARTITION BY ccp.applicationdetailsid ORDER BY ccp.accountnumber  ) AS rn\r\n  FROM {{ ref('stg_rb_los__creditcardproduct')}} ccp\r\n  WHERE ccp.bank_id = 'DFBANK1' AND ccp.CREDITCARDLIMIT <> 9999999999\r\n)\r\n, filter AS (\r\n  SELECT\r\n    dc.applicationid\r\n    , MIN(dc.timestamp) AS decision_timestamp\r\n  FROM\r\n    {{ ref('stg_rb_los__decision')}} dc\r\n  WHERE\r\n    dc.isdeleted = 'N'\r\n    AND ( dc.decisionresult = 'A'\r\n      OR dc.decisionresult = 'C' )\r\n    AND dc.decisioningtype = 'M'\r\n--     AND ( dc.timestamp BETWEEN '01-JAN-18' AND ( '31-DEC-21' ) )\r\n  GROUP BY\r\n    dc.applicationid\r\n)\r\n, opp AS (\r\n  SELECT DISTINCT\r\n      t5.applicationid\r\n    , t5.lastname AS customer_name\r\n    , t5.dob AS birthday\r\n    , t11.address\r\n    , t2.parentapplrefnumber AS application_id\r\n    , t12.bcname AS biz_name\r\n    , t1.accountbranch as biz_code\r\n    , bc.slbranchname AS branch_name\r\n    , t13.loginid AS rm_account\r\n    , t14.full_name AS rm\r\n    , t5.cifid\r\n    , t6.identity_number\r\n    , pn.phone_number\r\n    , e.email\r\n    , ccp.accountnumber AS card_account_number\r\n    , f.decision_timestamp\r\n  FROM {{ ref('stg_rb_los__opportunities') }}  t1\r\n  INNER JOIN {{ ref('stg_rb_los__parentapplication') }}  t2\r\n    ON t2.opportunitiesid = t1.opportunityid\r\n    AND t2.bank_id = 'DFBANK1'\r\n  INNER JOIN {{ ref('stg_rb_los__applicationdetails') }}  t4\r\n    ON t2.parentapplicationid = t4.parentapplicationid\r\n    AND t4.isdeleted = 'N'\r\n    AND T4.BANK_ID = 'DFBANK1'\r\n  INNER JOIN {{ ref('stg_rb_los__applicant') }}  t5\r\n    ON t5.applicationid = t4.applicationdetailsid\r\n    AND t5.bank_id = 'DFBANK1'\r\n    AND t5.applicanttype = 'M'\r\n  INNER JOIN {{ ref('stg_rb_los__applicantcontact') }}  t8 ON t8.applicantid = t5.applicantid\r\n  INNER JOIN {{ ref('stg_rb_los__applicantcontactphnemllist') }}  t81\r\n    ON t81.applicantcontactid = t8.applicantcontactid\r\n    AND t81.bank_id = 'DFBANK1'\r\n  INNER JOIN {{ ref('stg_rb_los__applicantaddress') }}  t9 ON t9.applicantid = t5.applicantid\r\n  INNER JOIN {{ ref('stg_rb_los__syncapplicantaddressmap') }}  t10 ON t10.applicantaddressid = t9.applicantaddressid\r\n  INNER JOIN {{ ref('stg_rb_los__addressdetail') }}  t11\r\n    ON t11.addressdetailid = t10.addressdetailid\r\n    AND t11.addresstype = 1\r\n    AND t11.ispreferred = 'Y'\r\n  LEFT JOIN {{ ref('stg_rb_los__bizcenter')}} t12 ON t12.bccode = t1.accountbranch\r\n  LEFT JOIN {{ ref('stg_rb_los__slbccodemapping')}} bc ON bc.bccode = t1.accountbranch\r\n  LEFT JOIN {{ ref('stg__los_user')}} t13 ON t13.personid = t1.SALESOWNERID\r\n  LEFT JOIN {{ ref('stg_rb_los__person')}} t14 ON t14.personid = t1.salesownerid\r\n  LEFT JOIN identity_number t6 ON t6.applicantid = t5.applicantid\r\n  LEFT JOIN phone_number pn ON pn.applicantid = t5.applicantid\r\n  LEFT JOIN email e ON e.applicantid = t5.applicantid\r\n  LEFT JOIN accountnumber ccp ON ccp.applicationdetailsid = t4.applicationdetailsid AND ccp.rn = 1\r\n  INNER JOIN filter f ON f.applicationid =  t5.applicationid\r\n)\r\n, relation_info AS (\r\nSELECT DISTINCT\r\n  t5.applicationid\r\n  , t5.cifid AS relation_cifid\r\n  , t5.lastname AS relation_name\r\n  , pn.phone_number AS relation_phone_number\r\n  , cat.vi_localetext AS nguoi_lien_quan\r\n  , cat2.vi_localetext AS quan_he\r\nFROM\r\n{{ ref('stg_rb_los__applicant') }} t5\r\nINNER JOIN {{ ref('stg_rb_los__applicantcontact') }} t8 ON t8.applicantid = t5.applicantid\r\nINNER JOIN {{ ref('stg_rb_los__applicantcontactphnemllist') }} t81\r\n  ON t81.applicantcontactid = t8.applicantcontactid\r\n  AND t81.bank_id = 'DFBANK1'\r\nLEFT JOIN phone_number pn ON pn.applicantid = t5.applicantid\r\nLEFT JOIN {{ ref('stg__los_category')}} cat ON cat.value = t5.applicanttype AND cat.categorytype = 'LOS_ROLE'\r\nLEFT JOIN {{ ref('stg__los_category')}} cat2 ON cat2.value = t5.relationtype AND cat2.categorytype = 'RELATION'\r\nINNER JOIN filter f ON f.applicationid =  t5.applicationid\r\nWHERE t5.bank_id = 'DFBANK1' AND t5.applicanttype <> 'M'\r\n)\r\nSELECT DISTINCT\r\n  opp.application_id\r\n  , opp.cifid as customer_cif\r\n  , opp.customer_name\r\n  , opp.phone_number\r\n  , opp.email\r\n  , opp.birthday\r\n  , opp.address\r\n  , opp.biz_name\r\n  , opp.biz_code\r\n  , opp.branch_name\r\n  , opp.rm_account\r\n  , opp.rm\r\n  , opp.identity_number\r\n  , opp.card_account_number\r\n  , reif.relation_cifid\r\n  , reif.relation_name\r\n  , reif.relation_phone_number\r\n  , reif.nguoi_lien_quan\r\n  , reif.quan_he\r\n  , opp.decision_timestamp\r\nFROM\r\n  opp\r\nLEFT JOIN relation_info reif ON reif.applicationid = opp.applicationid\r\nWHERE reif.relation_name IS NOT NULL", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\los\\int_los__application_relation.sql", "original_file_path": "models\\int\\los\\int_los__application_relation.sql", "name": "int_los__application_relation", "alias": "int_los__application_relation", "checksum": {"name": "sha256", "checksum": "5dc36c4caf657b791f3eea18ac2201edc699571f340b9f7a03e763cf6a72d04e"}, "tags": ["los_tf"], "refs": [["los__applicantidentitydetail"], ["stg_rb_los__applicantcontact"], ["stg_rb_los__applicantcontactphnemllist"], ["stg_rb_los__applicantcontact"], ["stg_rb_los__applicantcontactphnemllist"], ["stg_rb_los__creditcardproduct"], ["stg_rb_los__decision"], ["stg_rb_los__opportunities"], ["stg_rb_los__parentapplication"], ["stg_rb_los__applicationdetails"], ["stg_rb_los__applicant"], ["stg_rb_los__applicantcontact"], ["stg_rb_los__applicantcontactphnemllist"], ["stg_rb_los__applicantaddress"], ["stg_rb_los__syncapplicantaddressmap"], ["stg_rb_los__addressdetail"], ["stg_rb_los__bizcenter"], ["stg_rb_los__slbccodemapping"], ["stg__los_user"], ["stg_rb_los__person"], ["stg_rb_los__applicant"], ["stg_rb_los__applicantcontact"], ["stg_rb_los__applicantcontactphnemllist"], ["stg__los_category"], ["stg__los_category"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los__application_relation.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959751.06933, "compiled_code": "\nWITH identity_number AS (\n  SELECT\n    applicantid\n    , LISTAGG(\n        CASE prefuniqueidind\n          WHEN 'Y' THEN documentuniqueid || '(' || prefuniqueidind || ')'\n          ELSE documentuniqueid\n        END, ',')\n      WITHIN GROUP( ORDER BY applicantidentitydetailid\n    ) AS identity_number\nFROM\n  \"oracle_dgaworkzone\".base.los__applicantidentitydetail\nGROUP BY\n    applicantid\n)\n, phone_number AS (\n  SELECT\n    t8.applicantid\n    , LISTAGG(t81.phonenumlocalcode, ',' ON OVERFLOW TRUNCATE)\n      WITHIN GROUP( ORDER BY t81.applicantcontactphnemllistid\n      ) AS phone_number\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontact t8\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontactphnemllist t81\n    ON t81.applicantcontactid = t8.applicantcontactid\n      AND t81.bank_id = 'DFBANK1'\n      AND t8.deleteflag <> 'Y'\n      AND ( t8.prefcontactnotype = 'MP'\n        OR t8.prefcontactnotype = 'HP' )\nGROUP BY\n    t8.applicantid\n)\n, email AS (\n  SELECT\n    t8.applicantid\n    , LISTAGG(t81.emailid, ',' ON OVERFLOW TRUNCATE)\n      WITHIN GROUP( ORDER BY t81.applicantcontactphnemllistid\n        ) AS email\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontact t8\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontactphnemllist t81\n    ON t81.applicantcontactid = t8.applicantcontactid\n      AND t81.bank_id = 'DFBANK1'\n      AND t8.deleteflag <> 'Y'\n      AND t8.prefemailidtype = 'EM'\nGROUP BY\n    t8.applicantid\n)\n, accountnumber AS (\n  SELECT\n      ccp.applicationdetailsid\n    , ccp.accountnumber\n    , ROW_NUMBER() OVER(PARTITION BY ccp.applicationdetailsid ORDER BY ccp.accountnumber  ) AS rn\n  FROM \"oracle_dgaworkzone\".staging.stg_rb_los__creditcardproduct ccp\n  WHERE ccp.bank_id = 'DFBANK1' AND ccp.CREDITCARDLIMIT <> 9999999999\n)\n, filter AS (\n  SELECT\n    dc.applicationid\n    , MIN(dc.timestamp) AS decision_timestamp\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__decision dc\n  WHERE\n    dc.isdeleted = 'N'\n    AND ( dc.decisionresult = 'A'\n      OR dc.decisionresult = 'C' )\n    AND dc.decisioningtype = 'M'\n--     AND ( dc.timestamp BETWEEN '01-JAN-18' AND ( '31-DEC-21' ) )\n  GROUP BY\n    dc.applicationid\n)\n, opp AS (\n  SELECT DISTINCT\n      t5.applicationid\n    , t5.lastname AS customer_name\n    , t5.dob AS birthday\n    , t11.address\n    , t2.parentapplrefnumber AS application_id\n    , t12.bcname AS biz_name\n    , t1.accountbranch as biz_code\n    , bc.slbranchname AS branch_name\n    , t13.loginid AS rm_account\n    , t14.full_name AS rm\n    , t5.cifid\n    , t6.identity_number\n    , pn.phone_number\n    , e.email\n    , ccp.accountnumber AS card_account_number\n    , f.decision_timestamp\n  FROM \"oracle_dgaworkzone\".staging.stg_rb_los__opportunities  t1\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__parentapplication  t2\n    ON t2.opportunitiesid = t1.opportunityid\n    AND t2.bank_id = 'DFBANK1'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicationdetails  t4\n    ON t2.parentapplicationid = t4.parentapplicationid\n    AND t4.isdeleted = 'N'\n    AND T4.BANK_ID = 'DFBANK1'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicant  t5\n    ON t5.applicationid = t4.applicationdetailsid\n    AND t5.bank_id = 'DFBANK1'\n    AND t5.applicanttype = 'M'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontact  t8 ON t8.applicantid = t5.applicantid\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontactphnemllist  t81\n    ON t81.applicantcontactid = t8.applicantcontactid\n    AND t81.bank_id = 'DFBANK1'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantaddress  t9 ON t9.applicantid = t5.applicantid\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__syncapplicantaddressmap  t10 ON t10.applicantaddressid = t9.applicantaddressid\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__addressdetail  t11\n    ON t11.addressdetailid = t10.addressdetailid\n    AND t11.addresstype = 1\n    AND t11.ispreferred = 'Y'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__bizcenter t12 ON t12.bccode = t1.accountbranch\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__slbccodemapping bc ON bc.bccode = t1.accountbranch\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user t13 ON t13.personid = t1.SALESOWNERID\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__person t14 ON t14.personid = t1.salesownerid\n  LEFT JOIN identity_number t6 ON t6.applicantid = t5.applicantid\n  LEFT JOIN phone_number pn ON pn.applicantid = t5.applicantid\n  LEFT JOIN email e ON e.applicantid = t5.applicantid\n  LEFT JOIN accountnumber ccp ON ccp.applicationdetailsid = t4.applicationdetailsid AND ccp.rn = 1\n  INNER JOIN filter f ON f.applicationid =  t5.applicationid\n)\n, relation_info AS (\nSELECT DISTINCT\n  t5.applicationid\n  , t5.cifid AS relation_cifid\n  , t5.lastname AS relation_name\n  , pn.phone_number AS relation_phone_number\n  , cat.vi_localetext AS nguoi_lien_quan\n  , cat2.vi_localetext AS quan_he\nFROM\n\"oracle_dgaworkzone\".staging.stg_rb_los__applicant t5\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontact t8 ON t8.applicantid = t5.applicantid\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontactphnemllist t81\n  ON t81.applicantcontactid = t8.applicantcontactid\n  AND t81.bank_id = 'DFBANK1'\nLEFT JOIN phone_number pn ON pn.applicantid = t5.applicantid\nLEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cat ON cat.value = t5.applicanttype AND cat.categorytype = 'LOS_ROLE'\nLEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cat2 ON cat2.value = t5.relationtype AND cat2.categorytype = 'RELATION'\nINNER JOIN filter f ON f.applicationid =  t5.applicationid\nWHERE t5.bank_id = 'DFBANK1' AND t5.applicanttype <> 'M'\n)\nSELECT DISTINCT\n  opp.application_id\n  , opp.cifid as customer_cif\n  , opp.customer_name\n  , opp.phone_number\n  , opp.email\n  , opp.birthday\n  , opp.address\n  , opp.biz_name\n  , opp.biz_code\n  , opp.branch_name\n  , opp.rm_account\n  , opp.rm\n  , opp.identity_number\n  , opp.card_account_number\n  , reif.relation_cifid\n  , reif.relation_name\n  , reif.relation_phone_number\n  , reif.nguoi_lien_quan\n  , reif.quan_he\n  , opp.decision_timestamp\nFROM\n  opp\nLEFT JOIN relation_info reif ON reif.applicationid = opp.applicationid\nWHERE reif.relation_name IS NOT NULL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_los__application_relation"}, "model.dga_data_model.int_los__product": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_rb_los__decision", "model.dga_data_model.stg_rb_los__decision", "model.dga_data_model.stg_rb_los__losprocessentity", "model.dga_data_model.stg_rb_los__rlosroutingdetails", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__osproduct", "model.dga_data_model.stg_rb_los__opportunities", "model.dga_data_model.stg_los__transactiondepartmentinfo", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_rb_los__slbccodemapping", "model.dga_data_model.stg_rb_los__oslineproductdetails", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__loanproductdetails", "model.dga_data_model.stg_rb_los__creditcardproduct", "model.dga_data_model.stg_rb_los__addoncarddetails", "model.dga_data_model.stg__los_category"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["los_tf"], "meta": {"owner": "huyendtk3", "date_column": "bodatecreated"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "los", "int_los__product"], "unique_id": "model.dga_data_model.int_los__product", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH approved_date AS (\r\n  SELECT\r\n      applicationid\r\n    , timestamp AS approved_date\r\n    , decisionresult\r\n    , CASE\r\n        WHEN decisionresult = 'R' THEN 'Reject'\r\n        WHEN decisionresult = 'A' THEN 'Approved'\r\n        WHEN decisionresult = 'C' THEN 'Approved with condition'\r\n        WHEN decisionresult = 'B' THEN 'Rollback approved'\r\n        WHEN decisionresult = 'D' THEN 'Rollback rejected'\r\n        WHEN decisionresult = 'F' THEN 'Refer'\r\n        WHEN decisionresult IS NULL THEN 'Pending'\r\n        ELSE 'Khong xac dinh'\r\n      END AS decisionstatus\r\n\r\n    , RANK() OVER(PARTITION BY applicationid ORDER BY decisionid DESC) AS rk\r\n  FROM\r\n    {{ ref('stg_rb_los__decision') }}\r\n  WHERE\r\n    decisioningtype = 'M'\r\n    AND isdeleted = 'N'\r\n)\r\n, decision_date AS (\r\n  SELECT DISTINCT\r\n      applicationid\r\n    , FIRST_VALUE(timestamp) OVER(PARTITION BY applicationid ORDER BY decisionid DESC) AS decision_date\r\n  FROM\r\n    {{ ref('stg_rb_los__decision') }}\r\n)\r\n, first_created AS (\r\n  SELECT\r\n      entityid\r\n    , MIN(CASE WHEN entitystep = 'DAQDENT' THEN bodatecreated END) AS bodatecreated\r\n    , MIN(bodatecreated) AS create_date\r\n  FROM\r\n    {{ ref('stg_rb_los__losprocessentity')}}\r\n  GROUP BY\r\n    entityid\r\n)\r\n, approve_person AS (\r\n  SELECT DISTINCT\r\n      rd.opportunitiesid\r\n    , FIRST_VALUE(CASE WHEN rd.routetostagestep = 'DACUSTMN' THEN u.loginid ELSE NULL END ignore nulls)\r\n        OVER(PARTITION BY rd.opportunitiesid ORDER BY rd.rlosroutingdetailsid DESC range between unbounded preceding and unbounded following) AS approved_by\r\n    , FIRST_VALUE(CASE WHEN rd.routetostagestep = 'DACUSTMN' THEN rd.routetostagestep ELSE NULL END ignore nulls)\r\n        OVER(PARTITION BY rd.opportunitiesid ORDER BY rd.rlosroutingdetailsid DESC range between unbounded preceding and unbounded following) AS route_last_step\r\n  FROM\r\n    {{ ref('stg_rb_los__rlosroutingdetails')}} rd\r\n  LEFT JOIN {{ ref('stg__los_user')}} u ON rd.assignedfrom = u.personid\r\n), application_combo AS (\r\n  SELECT\r\n      parentapplicationid\r\n    , LISTAGG(PRODUCTCATEGORY, ',') WITHIN GROUP( ORDER BY productcategory) AS combo\r\n    , LISTAGG(ApplicationStatus, ',') WITHIN GROUP( ORDER BY productcategory) AS applicationstatus\r\n  FROM\r\n    {{ ref('stg_rb_los__applicationdetails') }}\r\n  WHERE\r\n    isdeleted = 'N'\r\n  GROUP BY\r\n    parentapplicationid\r\n)\r\n, all_application AS (\r\nSELECT\r\n  pra.parentapplrefnumber\r\n  , pra.opportunitiesid\r\n  , pra.customercifid AS customer_number\r\n  , apl.productcategory\r\n  , ac.combo\r\n  , cate2.en_localetext AS application_stage\r\n  , cate3.en_localetext AS application_step -- aplied for creditcard and loan, od l\u1ea5y theo\r\n  , ap.route_last_step\r\n  , ac.applicationstatus\r\n  , CASE\r\n      WHEN apl.applicationstatus = 'O' THEN 'OPEN'\r\n      ELSE 'CLOSED'\r\n    END AS application_status\r\n  , cate.en_localetext AS decision_result\r\n  , d.decisionstatus\r\n  , CASE\r\n      WHEN UPPER(d.decisionstatus) LIKE '%APPROVE%' THEN 'APPROVED'\r\n      WHEN UPPER(d.decisionstatus) LIKE '%REJECT%' THEN 'REJECTED'\r\n      ELSE 'SUBMITTED TO RISK'\r\n    END AS decisionstatus_lb\r\n  , d.approved_date\r\n  , ap.approved_by\r\n  , fc.bodatecreated\r\n  , fc.create_date\r\n  , u.loginid AS bocreatedby\r\n  , u.username AS bocreatefullname\r\n  , u.bcid AS bocreated_bcid\r\n  , u.bccode AS bocreated_bccode\r\n  , u.bcname AS bocreated_bcname\r\n  , cate4.en_localetext AS bizcenter_name\r\n  , opp.accountbranch AS bizcenter_code\r\n  , b.bcname AS bizcenter_bcname\r\n  , b.bcid AS bizcenter_bcid\r\n  , m.SLBRANCHNAME\r\n  , apl.productcode\r\n  , CASE\r\n      WHEN UPPER(apl.productcode) LIKE '%FL%' THEN 'VAYLINHHOAT'\r\n      WHEN UPPER(apl.productcode) LIKE '%QC%' THEN 'TIENNHANH'\r\n      WHEN UPPER(apl.productcode) LIKE '%BNPL%' THEN 'MUATRUOCTRASAU'\r\n      ELSE apl.productcode\r\n    END productcode_lb\r\n  , cate1.en_localetext AS product_classification\r\n  , cate1.vi_localetext AS vi_product_classification\r\n  , op.producttype\r\n  , u1.loginid AS assigned_user\r\n  , u2.home_address AS bm_code\r\n  , u2.loginid AS bmname\r\n  , u3.loginid AS rmname\r\n  , u3.home_address AS rm_code\r\n  , apl.bodatecreated AS apl_bodatecreated\r\n  , apl.bodatemodified AS last_modified_on\r\n  , apl.applicationdetailsid\r\n  , apl.tenorrequestedmm AS tenormonths\r\n  , apl.tenorrequesteddd AS tenordays\r\n  , apl.amountrequested AS amount_request\r\n  , pd.limitsought\r\n  , apl.applicationstep\r\n  , act.cifid\r\n  , cate5.vi_localetext AS vi_product_category\r\n  , ari.area_name\r\n  , dd.decision_date\r\nFROM\r\n  {{ ref('stg_rb_los__parentapplication') }} pra\r\n  INNER JOIN {{ ref('stg_rb_los__applicationdetails')}} apl\r\n    ON ( apl.parentapplicationid = pra.parentapplicationid )\r\n      AND apl.isdeleted = 'N'\r\n      AND apl.bank_id = 'DFBANK1'\r\n  INNER JOIN {{ ref('stg_rb_los__osproduct') }} op ON apl.productcode = op.productcode AND op.isdeleted = 'N'\r\n  INNER JOIN {{ ref('stg_rb_los__opportunities')}} opp ON opp.OPPORTUNITYID = pra.OPPORTUNITIESID\r\n  LEFT JOIN approved_date d ON d.applicationid = apl.applicationdetailsid AND d.rk = 1\r\n  LEFT JOIN approve_person ap ON ap.opportunitiesid = pra.opportunitiesid\r\n  LEFT JOIN application_combo ac ON ac.parentapplicationid = pra.parentapplicationid\r\n  LEFT JOIN {{ ref('stg_los__transactiondepartmentinfo') }} ari ON ari.bccode = opp.accountbranch\r\n  LEFT JOIN {{ ref('stg_rb_los__bizcenter')}} b on b.bccode = opp.accountbranch\r\n  LEFT JOIN decision_date dd ON dd.applicationid = apl.applicationdetailsid\r\n  LEFT JOIN {{ ref('stg_rb_los__bizcenter')}} b on b.bccode = opp.accountbranch\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate\r\n    ON cate.value = d.decisionresult\r\n      AND cate.categorytype = 'DECISION_RESULT'\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate1\r\n    ON cate1.value = op.productsecsubcategory\r\n      AND cate1.categorytype = 'PRODUCT_SECSUBCATEGORY'\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate2\r\n    ON cate2.value = apl.applicationstage\r\n      AND cate2.categorytype = 'APPLICATION_STAGE'\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate3\r\n    ON cate3.value = apl.applicationstep\r\n      AND cate3.categorytype = 'RLOS_APP_STEPS'\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate4\r\n    ON cate4.value = opp.ACCOUNTBRANCH\r\n      AND cate4.categorytype = 'SERVICE_OUTLET'\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate5\r\n    ON cate5.value = apl.productcategory\r\n      AND cate5.categorytype = 'DOC_PRODUCT_CATEGORY'\r\n  LEFT JOIN {{ ref('stg__los_user')}} u ON u.personid = pra.bocreatedby\r\n  LEFT JOIN {{ ref('stg__los_user')}} u1 ON u1.personid = opp.assigneduserid\r\n  LEFT JOIN {{ ref('stg__los_user')}} u2 ON u2.personid = opp.OWNERUSERID\r\n  LEFT JOIN {{ ref('stg__los_user')}} u3 ON u3.personid = opp.SALESOWNERID\r\n  LEFT JOIN first_created fc ON fc.entityid = pra.opportunitiesid\r\n  LEFT JOIN {{ ref('stg_rb_los__slbccodemapping')}} m ON m.bccode = opp.accountbranch\r\n  LEFT JOIN {{ ref('stg_rb_los__oslineproductdetails')}} pd\r\n    ON pd.applicationdetailsid = apl.applicationdetailsid\r\n    AND pd.bank_id = 'DFBANK1'\r\n  LEFT JOIN {{ ref('stg_rb_los__applicant')}} act\r\n    ON act.applicationid = apl.applicationdetailsid\r\n    AND act.bank_id = 'DFBANK1' AND act.applicanttype = 'M'\r\n\r\n),\r\nloan AS (\r\n  SELECT\r\n      al.applicationdetailsid\r\n    , lpd.loanproductdetailsid\r\n    , lpd.tenormonths\r\n    , lpd.tenordays\r\n    , lpd.amount\r\n  FROM\r\n    all_application al\r\n  INNER JOIN {{ ref('stg_rb_los__loanproductdetails')}} lpd ON al.applicationdetailsid = lpd.applicationdetailsid\r\n  WHERE al.productcategory = 1\r\n)\r\n,\r\ncreditcard AS (\r\n  SELECT\r\n    al.applicationdetailsid\r\n    , cc.creditcardlimit AS credit_card_limit\r\n    , cc.validfromdate\r\n    , cc.validtilldate\r\n    , adc.creditcardproductid\r\n    , adc.customway4code\r\n    , adc.addoncarddetailsid\r\n  FROM\r\n    all_application al\r\n  INNER JOIN {{ ref('stg_rb_los__creditcardproduct')}} cc ON al.applicationdetailsid = cc.applicationdetailsid\r\n  INNER JOIN {{ ref('stg_rb_los__addoncarddetails')}} adc ON adc.creditcardproductid = cc.creditcardproductid\r\n  WHERE\r\n    adc.isdeleted = 'N'\r\n    AND adc.existingcif = 'Y'\r\n    AND al.productcategory = 33\r\n)\r\n, merge_product AS (\r\n  SELECT distinct\r\n      CASE\r\n        WHEN cc.applicationdetailsid IS NOT NULL THEN 'credit_card'\r\n        WHEN lpd.applicationdetailsid IS NOT NULL THEN 'loan'\r\n        WHEN al.productcategory = 2 THEN 'overdraft'\r\n      END AS product_type\r\n      , al.parentapplrefnumber\r\n      , al.opportunitiesid\r\n      , al.customer_number\r\n      , al.productcategory\r\n      , al.combo\r\n      , al.application_stage\r\n      , CASE\r\n          WHEN al.productcategory = 2 THEN cate.en_localetext\r\n          ELSE al.application_step\r\n        END AS application_step\r\n      , al.route_last_step\r\n      , al.applicationstatus\r\n      , al.application_status\r\n      , al.decision_result\r\n      , al.decisionstatus\r\n      , al.decisionstatus_lb\r\n      , al.approved_date\r\n      , al.approved_by\r\n      , al.bodatecreated\r\n      , al.bocreatedby\r\n      , al.bocreatefullname\r\n      , al.bocreated_bcid\r\n      , al.bocreated_bccode\r\n      , al.bocreated_bcname\r\n      , al.bizcenter_name\r\n      , al.bizcenter_code\r\n      , al.bizcenter_bcname\r\n      , al.bizcenter_bcid\r\n      , al.slbranchname\r\n      , al.productcode\r\n      , al.productcode_lb\r\n      , al.product_classification\r\n      , al.vi_product_classification\r\n      , al.producttype\r\n      , al.assigned_user\r\n      , al.bm_code\r\n      , al.bmname\r\n      , al.rmname\r\n      , al.rm_code\r\n      , al.apl_bodatecreated\r\n      , al.last_modified_on\r\n      , al.applicationdetailsid\r\n      , CASE\r\n          WHEN cc.applicationdetailsid IS NOT NULL THEN al.tenormonths\r\n          WHEN lpd.applicationdetailsid IS NOT NULL THEN lpd.tenormonths\r\n        END AS tenormonths\r\n      , CASE\r\n          WHEN cc.applicationdetailsid IS NOT NULL THEN al.tenordays\r\n          WHEN lpd.applicationdetailsid IS NOT NULL THEN lpd.tenordays\r\n        END AS tenordays\r\n      , al.amount_request\r\n      , al.limitsought\r\n      , cc.credit_card_limit\r\n      , cc.validfromdate\r\n      , cc.validtilldate\r\n      , cc.creditcardproductid\r\n      , cc.customway4code\r\n      , cc.addoncarddetailsid\r\n      , lpd.loanproductdetailsid\r\n      , lpd.amount\r\n      , CASE\r\n          WHEN al.productcategory = 1 THEN lpd.amount\r\n          WHEN al.productcategory = 2 THEN al.limitsought\r\n          WHEN al.productcategory = 33 AND cc.credit_card_limit <> 9999999999 THEN cc.credit_card_limit\r\n        END AS amountapproved\r\n      , al.cifid\r\n      , al.vi_product_category\r\n      , al.area_name\r\n      , al.decision_date\r\n      , al.create_date\r\n  FROM\r\n    all_application al\r\n  LEFT JOIN creditcard cc ON al.applicationdetailsid = cc.applicationdetailsid\r\n  LEFT JOIN loan lpd ON al.applicationdetailsid = lpd.applicationdetailsid\r\n  LEFT JOIN {{ ref('stg__los_category')}} cate\r\n    ON cate.value = al.applicationstep\r\n    AND cate.categorytype = 'RLOS_APP_STEPS'\r\n  WHERE al.productcategory IN (1, 33, 2)\r\n)\r\nSELECT\r\n  *\r\nFROM merge_product", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\los\\int_los__product.sql", "original_file_path": "models\\int\\los\\int_los__product.sql", "name": "int_los__product", "alias": "int_los__product", "checksum": {"name": "sha256", "checksum": "520f6df26db98af1859a3eff7b5fb87becc834be44b730573f7c05f3a3000ec5"}, "tags": ["los_tf"], "refs": [["stg_rb_los__decision"], ["stg_rb_los__decision"], ["stg_rb_los__losprocessentity"], ["stg_rb_los__rlosroutingdetails"], ["stg__los_user"], ["stg_rb_los__applicationdetails"], ["stg_rb_los__parentapplication"], ["stg_rb_los__applicationdetails"], ["stg_rb_los__osproduct"], ["stg_rb_los__opportunities"], ["stg_los__transactiondepartmentinfo"], ["stg_rb_los__bizcenter"], ["stg_rb_los__bizcenter"], ["stg__los_category"], ["stg__los_category"], ["stg__los_category"], ["stg__los_category"], ["stg__los_category"], ["stg__los_category"], ["stg__los_user"], ["stg__los_user"], ["stg__los_user"], ["stg__los_user"], ["stg_rb_los__slbccodemapping"], ["stg_rb_los__oslineproductdetails"], ["stg_rb_los__applicant"], ["stg_rb_los__loanproductdetails"], ["stg_rb_los__creditcardproduct"], ["stg_rb_los__addoncarddetails"], ["stg__los_category"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "bodatecreated"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\los\\int_los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los__product.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "bodatecreated"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959752.725977, "compiled_code": "\nWITH approved_date AS (\n  SELECT\n      applicationid\n    , timestamp AS approved_date\n    , decisionresult\n    , CASE\n        WHEN decisionresult = 'R' THEN 'Reject'\n        WHEN decisionresult = 'A' THEN 'Approved'\n        WHEN decisionresult = 'C' THEN 'Approved with condition'\n        WHEN decisionresult = 'B' THEN 'Rollback approved'\n        WHEN decisionresult = 'D' THEN 'Rollback rejected'\n        WHEN decisionresult = 'F' THEN 'Refer'\n        WHEN decisionresult IS NULL THEN 'Pending'\n        ELSE 'Khong xac dinh'\n      END AS decisionstatus\n\n    , RANK() OVER(PARTITION BY applicationid ORDER BY decisionid DESC) AS rk\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__decision\n  WHERE\n    decisioningtype = 'M'\n    AND isdeleted = 'N'\n)\n, decision_date AS (\n  SELECT DISTINCT\n      applicationid\n    , FIRST_VALUE(timestamp) OVER(PARTITION BY applicationid ORDER BY decisionid DESC) AS decision_date\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__decision\n)\n, first_created AS (\n  SELECT\n      entityid\n    , MIN(CASE WHEN entitystep = 'DAQDENT' THEN bodatecreated END) AS bodatecreated\n    , MIN(bodatecreated) AS create_date\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__losprocessentity\n  GROUP BY\n    entityid\n)\n, approve_person AS (\n  SELECT DISTINCT\n      rd.opportunitiesid\n    , FIRST_VALUE(CASE WHEN rd.routetostagestep = 'DACUSTMN' THEN u.loginid ELSE NULL END ignore nulls)\n        OVER(PARTITION BY rd.opportunitiesid ORDER BY rd.rlosroutingdetailsid DESC range between unbounded preceding and unbounded following) AS approved_by\n    , FIRST_VALUE(CASE WHEN rd.routetostagestep = 'DACUSTMN' THEN rd.routetostagestep ELSE NULL END ignore nulls)\n        OVER(PARTITION BY rd.opportunitiesid ORDER BY rd.rlosroutingdetailsid DESC range between unbounded preceding and unbounded following) AS route_last_step\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__rlosroutingdetails rd\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u ON rd.assignedfrom = u.personid\n), application_combo AS (\n  SELECT\n      parentapplicationid\n    , LISTAGG(PRODUCTCATEGORY, ',') WITHIN GROUP( ORDER BY productcategory) AS combo\n    , LISTAGG(ApplicationStatus, ',') WITHIN GROUP( ORDER BY productcategory) AS applicationstatus\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__applicationdetails\n  WHERE\n    isdeleted = 'N'\n  GROUP BY\n    parentapplicationid\n)\n, all_application AS (\nSELECT\n  pra.parentapplrefnumber\n  , pra.opportunitiesid\n  , pra.customercifid AS customer_number\n  , apl.productcategory\n  , ac.combo\n  , cate2.en_localetext AS application_stage\n  , cate3.en_localetext AS application_step -- aplied for creditcard and loan, od l\u1ea5y theo\n  , ap.route_last_step\n  , ac.applicationstatus\n  , CASE\n      WHEN apl.applicationstatus = 'O' THEN 'OPEN'\n      ELSE 'CLOSED'\n    END AS application_status\n  , cate.en_localetext AS decision_result\n  , d.decisionstatus\n  , CASE\n      WHEN UPPER(d.decisionstatus) LIKE '%APPROVE%' THEN 'APPROVED'\n      WHEN UPPER(d.decisionstatus) LIKE '%REJECT%' THEN 'REJECTED'\n      ELSE 'SUBMITTED TO RISK'\n    END AS decisionstatus_lb\n  , d.approved_date\n  , ap.approved_by\n  , fc.bodatecreated\n  , fc.create_date\n  , u.loginid AS bocreatedby\n  , u.username AS bocreatefullname\n  , u.bcid AS bocreated_bcid\n  , u.bccode AS bocreated_bccode\n  , u.bcname AS bocreated_bcname\n  , cate4.en_localetext AS bizcenter_name\n  , opp.accountbranch AS bizcenter_code\n  , b.bcname AS bizcenter_bcname\n  , b.bcid AS bizcenter_bcid\n  , m.SLBRANCHNAME\n  , apl.productcode\n  , CASE\n      WHEN UPPER(apl.productcode) LIKE '%FL%' THEN 'VAYLINHHOAT'\n      WHEN UPPER(apl.productcode) LIKE '%QC%' THEN 'TIENNHANH'\n      WHEN UPPER(apl.productcode) LIKE '%BNPL%' THEN 'MUATRUOCTRASAU'\n      ELSE apl.productcode\n    END productcode_lb\n  , cate1.en_localetext AS product_classification\n  , cate1.vi_localetext AS vi_product_classification\n  , op.producttype\n  , u1.loginid AS assigned_user\n  , u2.home_address AS bm_code\n  , u2.loginid AS bmname\n  , u3.loginid AS rmname\n  , u3.home_address AS rm_code\n  , apl.bodatecreated AS apl_bodatecreated\n  , apl.bodatemodified AS last_modified_on\n  , apl.applicationdetailsid\n  , apl.tenorrequestedmm AS tenormonths\n  , apl.tenorrequesteddd AS tenordays\n  , apl.amountrequested AS amount_request\n  , pd.limitsought\n  , apl.applicationstep\n  , act.cifid\n  , cate5.vi_localetext AS vi_product_category\n  , ari.area_name\n  , dd.decision_date\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__parentapplication pra\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicationdetails apl\n    ON ( apl.parentapplicationid = pra.parentapplicationid )\n      AND apl.isdeleted = 'N'\n      AND apl.bank_id = 'DFBANK1'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__osproduct op ON apl.productcode = op.productcode AND op.isdeleted = 'N'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__opportunities opp ON opp.OPPORTUNITYID = pra.OPPORTUNITIESID\n  LEFT JOIN approved_date d ON d.applicationid = apl.applicationdetailsid AND d.rk = 1\n  LEFT JOIN approve_person ap ON ap.opportunitiesid = pra.opportunitiesid\n  LEFT JOIN application_combo ac ON ac.parentapplicationid = pra.parentapplicationid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_los__transactiondepartmentinfo ari ON ari.bccode = opp.accountbranch\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__bizcenter b on b.bccode = opp.accountbranch\n  LEFT JOIN decision_date dd ON dd.applicationid = apl.applicationdetailsid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__bizcenter b on b.bccode = opp.accountbranch\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate\n    ON cate.value = d.decisionresult\n      AND cate.categorytype = 'DECISION_RESULT'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate1\n    ON cate1.value = op.productsecsubcategory\n      AND cate1.categorytype = 'PRODUCT_SECSUBCATEGORY'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate2\n    ON cate2.value = apl.applicationstage\n      AND cate2.categorytype = 'APPLICATION_STAGE'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate3\n    ON cate3.value = apl.applicationstep\n      AND cate3.categorytype = 'RLOS_APP_STEPS'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate4\n    ON cate4.value = opp.ACCOUNTBRANCH\n      AND cate4.categorytype = 'SERVICE_OUTLET'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate5\n    ON cate5.value = apl.productcategory\n      AND cate5.categorytype = 'DOC_PRODUCT_CATEGORY'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u ON u.personid = pra.bocreatedby\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u1 ON u1.personid = opp.assigneduserid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u2 ON u2.personid = opp.OWNERUSERID\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u3 ON u3.personid = opp.SALESOWNERID\n  LEFT JOIN first_created fc ON fc.entityid = pra.opportunitiesid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__slbccodemapping m ON m.bccode = opp.accountbranch\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__oslineproductdetails pd\n    ON pd.applicationdetailsid = apl.applicationdetailsid\n    AND pd.bank_id = 'DFBANK1'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicant act\n    ON act.applicationid = apl.applicationdetailsid\n    AND act.bank_id = 'DFBANK1' AND act.applicanttype = 'M'\n\n),\nloan AS (\n  SELECT\n      al.applicationdetailsid\n    , lpd.loanproductdetailsid\n    , lpd.tenormonths\n    , lpd.tenordays\n    , lpd.amount\n  FROM\n    all_application al\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__loanproductdetails lpd ON al.applicationdetailsid = lpd.applicationdetailsid\n  WHERE al.productcategory = 1\n)\n,\ncreditcard AS (\n  SELECT\n    al.applicationdetailsid\n    , cc.creditcardlimit AS credit_card_limit\n    , cc.validfromdate\n    , cc.validtilldate\n    , adc.creditcardproductid\n    , adc.customway4code\n    , adc.addoncarddetailsid\n  FROM\n    all_application al\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__creditcardproduct cc ON al.applicationdetailsid = cc.applicationdetailsid\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__addoncarddetails adc ON adc.creditcardproductid = cc.creditcardproductid\n  WHERE\n    adc.isdeleted = 'N'\n    AND adc.existingcif = 'Y'\n    AND al.productcategory = 33\n)\n, merge_product AS (\n  SELECT distinct\n      CASE\n        WHEN cc.applicationdetailsid IS NOT NULL THEN 'credit_card'\n        WHEN lpd.applicationdetailsid IS NOT NULL THEN 'loan'\n        WHEN al.productcategory = 2 THEN 'overdraft'\n      END AS product_type\n      , al.parentapplrefnumber\n      , al.opportunitiesid\n      , al.customer_number\n      , al.productcategory\n      , al.combo\n      , al.application_stage\n      , CASE\n          WHEN al.productcategory = 2 THEN cate.en_localetext\n          ELSE al.application_step\n        END AS application_step\n      , al.route_last_step\n      , al.applicationstatus\n      , al.application_status\n      , al.decision_result\n      , al.decisionstatus\n      , al.decisionstatus_lb\n      , al.approved_date\n      , al.approved_by\n      , al.bodatecreated\n      , al.bocreatedby\n      , al.bocreatefullname\n      , al.bocreated_bcid\n      , al.bocreated_bccode\n      , al.bocreated_bcname\n      , al.bizcenter_name\n      , al.bizcenter_code\n      , al.bizcenter_bcname\n      , al.bizcenter_bcid\n      , al.slbranchname\n      , al.productcode\n      , al.productcode_lb\n      , al.product_classification\n      , al.vi_product_classification\n      , al.producttype\n      , al.assigned_user\n      , al.bm_code\n      , al.bmname\n      , al.rmname\n      , al.rm_code\n      , al.apl_bodatecreated\n      , al.last_modified_on\n      , al.applicationdetailsid\n      , CASE\n          WHEN cc.applicationdetailsid IS NOT NULL THEN al.tenormonths\n          WHEN lpd.applicationdetailsid IS NOT NULL THEN lpd.tenormonths\n        END AS tenormonths\n      , CASE\n          WHEN cc.applicationdetailsid IS NOT NULL THEN al.tenordays\n          WHEN lpd.applicationdetailsid IS NOT NULL THEN lpd.tenordays\n        END AS tenordays\n      , al.amount_request\n      , al.limitsought\n      , cc.credit_card_limit\n      , cc.validfromdate\n      , cc.validtilldate\n      , cc.creditcardproductid\n      , cc.customway4code\n      , cc.addoncarddetailsid\n      , lpd.loanproductdetailsid\n      , lpd.amount\n      , CASE\n          WHEN al.productcategory = 1 THEN lpd.amount\n          WHEN al.productcategory = 2 THEN al.limitsought\n          WHEN al.productcategory = 33 AND cc.credit_card_limit <> 9999999999 THEN cc.credit_card_limit\n        END AS amountapproved\n      , al.cifid\n      , al.vi_product_category\n      , al.area_name\n      , al.decision_date\n      , al.create_date\n  FROM\n    all_application al\n  LEFT JOIN creditcard cc ON al.applicationdetailsid = cc.applicationdetailsid\n  LEFT JOIN loan lpd ON al.applicationdetailsid = lpd.applicationdetailsid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate\n    ON cate.value = al.applicationstep\n    AND cate.categorytype = 'RLOS_APP_STEPS'\n  WHERE al.productcategory IN (1, 33, 2)\n)\nSELECT\n  *\nFROM merge_product", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_los__product"}, "model.dga_data_model.int_los__rb": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat_remark", "model.dga_data_model.int_los__product", "model.dga_data_model.stg_rb_los__rlosroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "los", "int_los__rb"], "unique_id": "model.dga_data_model.int_los__rb", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH tat AS (\r\n  SELECT\r\n    parentapplrefnumber\r\n    , approved_date\r\n    , MAX(CASE WHEN is_pheduyet_step = 1 THEN end_time END) AS approved_date_v2\r\n    , MIN(is_ftr) AS ftr\r\n    , MAX(CASE WHEN is_dieuphoi_step = 1 THEN end_time END) AS thoigiandieuphoi\r\n    , MAX(CASE WHEN is_chuyendenbuoc_cj5 = 1 THEN nextstep END) AS chuyendenbuoc\r\n  FROM {{ ref('int_los__tat')}}\r\n  GROUP BY\r\n      parentapplrefnumber\r\n    , approved_date\r\n)\r\n, remarks AS (\r\n  SELECT\r\n    parentapplrefnumber\r\n    ,  to_char(remarks) AS remarks\r\n    , ftr_cjsb\r\n    , ROW_NUMBER() OVER(PARTITION BY parentapplrefnumber ORDER BY ftr_cjsb) rk\r\n  FROM\r\n    {{ ref('int_los__tat_remark')}}\r\n)\r\nSELECT DISTINCT\r\n    ls.parentapplrefnumber\r\n  , ls.bizcenter_code\r\n  , ls.area_name\r\n  , ls.create_date\r\n  , ls.application_status\r\n  , ls.decisionstatus\r\n  , ls.cifid\r\n  , ls.productcode\r\n  , ls.vi_product_classification\r\n  , ls.vi_product_category\r\n  , ls.rmname\r\n  , ls.amount_request\r\n  , ls.amountapproved\r\n  , CASE\r\n      WHEN (UPPER(ls.decisionstatus) LIKE '%APPROVE%' OR UPPER(ls.decisionstatus) LIKE '%REJECT%')\r\n      THEN ls.decision_date\r\n      ELSE NULL\r\n    END AS decision_date\r\n  , ls.productcode_lb\r\n  , ls.decisionstatus_lb\r\n  , COALESCE(tat.approved_date, tat.approved_date_v2) AS approved_date\r\n  , tat.ftr\r\n  , tat.thoigiandieuphoi\r\n  , remarks.ftr_cjsb\r\n  , CASE WHEN UPPER(ls.decisionstatus) LIKE '%REJECT%' THEN remarks.remarks ELSE NULL END ly_do_tu_choi\r\n  , CASE WHEN UPPER(ls.decisionstatus) LIKE '%REJECT%' THEN 'Other' ELSE NULL END ly_do_tu_choi_group\r\n  , tat.chuyendenbuoc\r\nFROM\r\n  {{ ref('int_los__product')}} ls\r\n  LEFT JOIN tat ON ls.parentapplrefnumber = tat.parentapplrefnumber\r\n  LEFT JOIN remarks ON ls.parentapplrefnumber = remarks.parentapplrefnumber AND remarks.rk = 1\r\n  WHERE ls.opportunitiesid IN (SELECT DISTINCT opportunitiesid FROM {{ ref('stg_rb_los__rlosroutingdetails')}})\r\n  AND ls.bodatecreated IS NOT NULL", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\los\\int_los__rb.sql", "original_file_path": "models\\int\\los\\int_los__rb.sql", "name": "int_los__rb", "alias": "int_los__rb", "checksum": {"name": "sha256", "checksum": "d6dc25f104eb388192693f61b34ac1655dc7bce9af4cbdfc5a2356b0ccea3a86"}, "tags": ["los_tf"], "refs": [["int_los__tat"], ["int_los__tat_remark"], ["int_los__product"], ["stg_rb_los__rlosroutingdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los__rb.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959751.0743499, "compiled_code": "\nWITH tat AS (\n  SELECT\n    parentapplrefnumber\n    , approved_date\n    , MAX(CASE WHEN is_pheduyet_step = 1 THEN end_time END) AS approved_date_v2\n    , MIN(is_ftr) AS ftr\n    , MAX(CASE WHEN is_dieuphoi_step = 1 THEN end_time END) AS thoigiandieuphoi\n    , MAX(CASE WHEN is_chuyendenbuoc_cj5 = 1 THEN nextstep END) AS chuyendenbuoc\n  FROM \"oracle_dgaworkzone\".int.int_los__tat\n  GROUP BY\n      parentapplrefnumber\n    , approved_date\n)\n, remarks AS (\n  SELECT\n    parentapplrefnumber\n    ,  to_char(remarks) AS remarks\n    , ftr_cjsb\n    , ROW_NUMBER() OVER(PARTITION BY parentapplrefnumber ORDER BY ftr_cjsb) rk\n  FROM\n    \"oracle_dgaworkzone\".int.int_los__tat_remark\n)\nSELECT DISTINCT\n    ls.parentapplrefnumber\n  , ls.bizcenter_code\n  , ls.area_name\n  , ls.create_date\n  , ls.application_status\n  , ls.decisionstatus\n  , ls.cifid\n  , ls.productcode\n  , ls.vi_product_classification\n  , ls.vi_product_category\n  , ls.rmname\n  , ls.amount_request\n  , ls.amountapproved\n  , CASE\n      WHEN (UPPER(ls.decisionstatus) LIKE '%APPROVE%' OR UPPER(ls.decisionstatus) LIKE '%REJECT%')\n      THEN ls.decision_date\n      ELSE NULL\n    END AS decision_date\n  , ls.productcode_lb\n  , ls.decisionstatus_lb\n  , COALESCE(tat.approved_date, tat.approved_date_v2) AS approved_date\n  , tat.ftr\n  , tat.thoigiandieuphoi\n  , remarks.ftr_cjsb\n  , CASE WHEN UPPER(ls.decisionstatus) LIKE '%REJECT%' THEN remarks.remarks ELSE NULL END ly_do_tu_choi\n  , CASE WHEN UPPER(ls.decisionstatus) LIKE '%REJECT%' THEN 'Other' ELSE NULL END ly_do_tu_choi_group\n  , tat.chuyendenbuoc\nFROM\n  \"oracle_dgaworkzone\".int.int_los__product ls\n  LEFT JOIN tat ON ls.parentapplrefnumber = tat.parentapplrefnumber\n  LEFT JOIN remarks ON ls.parentapplrefnumber = remarks.parentapplrefnumber AND remarks.rk = 1\n  WHERE ls.opportunitiesid IN (SELECT DISTINCT opportunitiesid FROM \"oracle_dgaworkzone\".staging.stg_rb_los__rlosroutingdetails)\n  AND ls.bodatecreated IS NOT NULL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_los__rb"}, "model.dga_data_model.int_los__tat": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_rb_los__losprocessentity", "model.dga_data_model.stg_rb_los__rlosroutingdetails", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__opportunities", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__rlosroutingdetails", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_rb_los__rlosworknotes"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["los_tf"], "meta": {"owner": "huyendtk3", "date_column": "end_time"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "los", "int_los__tat"], "unique_id": "model.dga_data_model.int_los__tat", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH first_created AS (\r\n  SELECT\r\n    entityid\r\n    , MIN(bodatecreated) AS bodatecreated\r\n  FROM\r\n    {{ ref('stg_rb_los__losprocessentity')}}\r\n  GROUP BY\r\n    entityid\r\n)\r\n, pre_approved_date AS (\r\n  SELECT\r\n      pra.parentapplicationid\r\n    , MIN( CASE WHEN rd.routetostagestep = 'DACUSTMN' THEN rd.routingdate END) AS dacustmn_routingdate\r\n    , MAX( CASE WHEN rd.routetostagestep = 'CDAPPRVL' THEN rd.routingdate END) AS cdapprvl_routingdate\r\nFROM\r\n  {{ ref('stg_rb_los__rlosroutingdetails') }} rd\r\n  LEFT JOIN {{ ref('stg_rb_los__parentapplication')}}  pra ON rd.opportunitiesid = pra.opportunitiesid_ref\r\nGROUP BY\r\n  pra.parentapplicationid\r\n)\r\n, pre_approved_date_2 AS (\r\n  SELECT\r\n      parentapplicationid\r\n    , COUNT(DISTINCT productcategory) AS num_cate\r\n  FROM {{ ref('stg_rb_los__applicationdetails')}}\r\n  GROUP BY parentapplicationid\r\n)\r\n, approved_date AS (\r\n  SELECT\r\n    p2.parentapplicationid\r\n    , CASE\r\n        WHEN p2.num_cate > 1 THEN p1.dacustmn_routingdate\r\n        ELSE p1.cdapprvl_routingdate\r\n      END AS approved_date\r\n  FROM\r\n    pre_approved_date_2 p2\r\n  LEFT JOIN pre_approved_date p1 ON p2.parentapplicationid = p1.parentapplicationid\r\n)\r\n, cifid AS (\r\n  SELECT\r\n    DISTINCT\r\n        apc.cifid\r\n      , apl.parentapplicationid\r\n  FROM\r\n    {{ ref('stg_rb_los__applicationdetails')}} apl\r\n  INNER JOIN {{ ref('stg_rb_los__applicant')}} apc\r\n    ON apc.applicationid = apl.applicationdetailsid\r\n      AND apc.bank_id = 'DFBANK1'\r\n      AND apc.applicanttype = 'M'\r\n  WHERE apl.isdeleted = 'N'\r\n    AND apl.bank_id = 'DFBANK1'\r\n)\r\n, t AS (\r\n  SELECT\r\n      pra.parentapplrefnumber\r\n    , apl.cifid\r\n    , pra.parentapplicationid\r\n    , lop.opportunityid\r\n    , CASE\r\n        WHEN ( rd.routeto = 'U' ) THEN 'USER'\r\n        ELSE 'GROUP'\r\n      END AS routeto\r\n    , lu.loginid AS assignedfrom\r\n    , cate.vi_localetext  AS step\r\n    , cate2.vi_localetext AS nextstep\r\n    , rd.routefromstagestep\r\n    , rd.routetostagestep\r\n    , rd.routingdate AS end_time\r\n    , rd.rlosroutingdetailsid\r\n    , rd.transferredto\r\n    , rd.transferredfrom\r\n    , rd.assignertype\r\n    , ad.approved_date\r\n    , CASE\r\n        WHEN cate.vi_localetext = 'Nh\u1eadp li\u1ec7u chi ti\u1ebft' AND cate2.vi_localetext = '\u0110i\u1ec1u ph\u1ed1i'\r\n          THEN ROW_NUMBER()\r\n                OVER (PARTITION BY\r\n                        pra.parentapplrefnumber\r\n                        , CASE WHEN cate.vi_localetext = 'Nh\u1eadp li\u1ec7u chi ti\u1ebft' AND cate2.vi_localetext = '\u0110i\u1ec1u ph\u1ed1i' THEN 1 ELSE 0 END\r\n                      ORDER BY rd.routingdate )\r\n      END AS rk_thoigiandieuphoi\r\n    , CASE\r\n        WHEN cate2.vi_localetext = 'Ph\u00ea duy\u1ec7t'\r\n          THEN ROW_NUMBER()\r\n            OVER (PARTITION BY\r\n                    pra.parentapplrefnumber\r\n                    , CASE WHEN cate2.vi_localetext = 'Ph\u00ea duy\u1ec7t' THEN 1 ELSE 0 END\r\n                  ORDER BY rd.routingdate )\r\n      END AS rk_thoigianpheduyet\r\n    , RANK() OVER (PARTITION BY pra.parentapplrefnumber ORDER BY rd.rlosroutingdetailsid DESC ) AS rk_chuyendenbuoc_cj5\r\n  FROM\r\n    {{ ref('stg_rb_los__opportunities') }} lop\r\n  INNER JOIN {{ ref('stg_rb_los__parentapplication') }} pra\r\n    ON lop.opportunityid = pra.opportunitiesid AND pra.bank_id = 'DFBANK1'\r\n  INNER JOIN {{ ref('stg_rb_los__rlosroutingdetails')}} rd\r\n    ON rd.opportunitiesid = pra.opportunitiesid AND pra.bank_id = 'DFBANK1'\r\n  INNER JOIN cifid apl ON apl.parentapplicationid = pra.parentapplicationid\r\n  LEFT JOIN {{ ref('stg__los_category') }} cate ON cate.value = rd.routefromstagestep AND cate.categorytype = 'RLOS_APP_STEPS'\r\n  LEFT JOIN {{ ref('stg__los_category') }}  cate2 ON cate2.value = rd.routetostagestep AND cate.categorytype = 'RLOS_APP_STEPS'\r\n  LEFT JOIN {{ ref('stg__los_user') }} lu ON lu.personid = rd.assignedfrom\r\n  LEFT JOIN approved_date ad ON ad.parentapplicationid = pra.parentapplicationid\r\n\r\n)\r\n, start_time AS (\r\n  SELECT\r\n      t.parentapplrefnumber\r\n    , t.cifid\r\n    , t.parentapplicationid\r\n    , t.opportunityid\r\n    , t.routeto\r\n    , t.assignedfrom\r\n    , t.step\r\n    , t.nextstep\r\n    , coalesce(LAG(end_time) OVER(PARTITION BY opportunityid ORDER BY rlosroutingdetailsid), fc.bodatecreated) AS start_time\r\n    , t.end_time\r\n    , t.end_time -\r\n        coalesce(LAG(end_time) OVER(PARTITION BY opportunityid ORDER BY rlosroutingdetailsid), fc.bodatecreated) AS tat\r\n    , t.rlosroutingdetailsid\r\n    , t.routefromstagestep\r\n    , u.loginid AS transferredfrom\r\n    , u1.loginid AS transferredto\r\n    , t.assignertype\r\n    , t.approved_date\r\n    , CASE\r\n        WHEN t.step = '\u0110i\u1ec1u ph\u1ed1i' AND t.nextstep = 'Nh\u1eadp li\u1ec7u chi ti\u1ebft' THEN 0\r\n        WHEN t.step = 'Th\u1ea9m \u0111\u1ecbnh 1' AND t.nextstep = 'B\u1ed5 sung' THEN 0\r\n        ELSE 1\r\n      END AS is_ftr\r\n    , CASE\r\n        WHEN t.rk_thoigiandieuphoi = 1 THEN 1\r\n        ELSE 0\r\n      END AS is_dieuphoi_step\r\n    , CASE\r\n        WHEN t.rk_thoigianpheduyet = 1 THEN 1\r\n        ELSE 0\r\n      END AS is_pheduyet_step\r\n    , CASE\r\n        WHEN t.rk_chuyendenbuoc_cj5 = 1 THEN 1\r\n        ELSE 0\r\n      END AS is_chuyendenbuoc_cj5\r\n\r\n  FROM\r\n    t\r\n  LEFT JOIN first_created fc ON fc.entityid = t.opportunityid AND t.routefromstagestep = 'DAQDENT'\r\n  LEFT JOIN {{ ref('stg__los_user') }} u ON u.personid = t.transferredfrom\r\n  LEFT JOIN {{ ref('stg__los_user') }} u1 ON u1.personid = t.transferredto\r\n)\r\n, remark_rk AS (\r\nSELECT\r\n    parentapplicationid\r\n    ,step\r\n    ,userid\r\n    ,tmdate\r\n    , remarks\r\n    , ROW_NUMBER() OVER(PARTITION BY parentapplicationid, step, userid, tmdate order by is_real_remarks) AS rk\r\nFROM\r\n  {{ ref('stg_rb_los__rlosworknotes')}}\r\n)\r\n  SELECT * FROM start_time", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\los\\int_los__tat.sql", "original_file_path": "models\\int\\los\\int_los__tat.sql", "name": "int_los__tat", "alias": "int_los__tat", "checksum": {"name": "sha256", "checksum": "92c6706edbd1c87577f53b9bf1f8f9685a1bda11bb696644ad4d36357c509366"}, "tags": ["los_tf"], "refs": [["stg_rb_los__losprocessentity"], ["stg_rb_los__rlosroutingdetails"], ["stg_rb_los__parentapplication"], ["stg_rb_los__applicationdetails"], ["stg_rb_los__applicationdetails"], ["stg_rb_los__applicant"], ["stg_rb_los__opportunities"], ["stg_rb_los__parentapplication"], ["stg_rb_los__rlosroutingdetails"], ["stg__los_category"], ["stg__los_category"], ["stg__los_user"], ["stg__los_user"], ["stg__los_user"], ["stg_rb_los__rlosworknotes"]], "sources": [], "metrics": [], "description": "", "columns": {"rlosroutingdetailsid": {"name": "rlosroutingdetailsid", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "end_time"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\los\\int_los.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los__tat.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "end_time"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959752.7279892, "compiled_code": "\nWITH first_created AS (\n  SELECT\n    entityid\n    , MIN(bodatecreated) AS bodatecreated\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__losprocessentity\n  GROUP BY\n    entityid\n)\n, pre_approved_date AS (\n  SELECT\n      pra.parentapplicationid\n    , MIN( CASE WHEN rd.routetostagestep = 'DACUSTMN' THEN rd.routingdate END) AS dacustmn_routingdate\n    , MAX( CASE WHEN rd.routetostagestep = 'CDAPPRVL' THEN rd.routingdate END) AS cdapprvl_routingdate\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__rlosroutingdetails rd\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__parentapplication  pra ON rd.opportunitiesid = pra.opportunitiesid_ref\nGROUP BY\n  pra.parentapplicationid\n)\n, pre_approved_date_2 AS (\n  SELECT\n      parentapplicationid\n    , COUNT(DISTINCT productcategory) AS num_cate\n  FROM \"oracle_dgaworkzone\".staging.stg_rb_los__applicationdetails\n  GROUP BY parentapplicationid\n)\n, approved_date AS (\n  SELECT\n    p2.parentapplicationid\n    , CASE\n        WHEN p2.num_cate > 1 THEN p1.dacustmn_routingdate\n        ELSE p1.cdapprvl_routingdate\n      END AS approved_date\n  FROM\n    pre_approved_date_2 p2\n  LEFT JOIN pre_approved_date p1 ON p2.parentapplicationid = p1.parentapplicationid\n)\n, cifid AS (\n  SELECT\n    DISTINCT\n        apc.cifid\n      , apl.parentapplicationid\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__applicationdetails apl\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__applicant apc\n    ON apc.applicationid = apl.applicationdetailsid\n      AND apc.bank_id = 'DFBANK1'\n      AND apc.applicanttype = 'M'\n  WHERE apl.isdeleted = 'N'\n    AND apl.bank_id = 'DFBANK1'\n)\n, t AS (\n  SELECT\n      pra.parentapplrefnumber\n    , apl.cifid\n    , pra.parentapplicationid\n    , lop.opportunityid\n    , CASE\n        WHEN ( rd.routeto = 'U' ) THEN 'USER'\n        ELSE 'GROUP'\n      END AS routeto\n    , lu.loginid AS assignedfrom\n    , cate.vi_localetext  AS step\n    , cate2.vi_localetext AS nextstep\n    , rd.routefromstagestep\n    , rd.routetostagestep\n    , rd.routingdate AS end_time\n    , rd.rlosroutingdetailsid\n    , rd.transferredto\n    , rd.transferredfrom\n    , rd.assignertype\n    , ad.approved_date\n    , CASE\n        WHEN cate.vi_localetext = 'Nh\u1eadp li\u1ec7u chi ti\u1ebft' AND cate2.vi_localetext = '\u0110i\u1ec1u ph\u1ed1i'\n          THEN ROW_NUMBER()\n                OVER (PARTITION BY\n                        pra.parentapplrefnumber\n                        , CASE WHEN cate.vi_localetext = 'Nh\u1eadp li\u1ec7u chi ti\u1ebft' AND cate2.vi_localetext = '\u0110i\u1ec1u ph\u1ed1i' THEN 1 ELSE 0 END\n                      ORDER BY rd.routingdate )\n      END AS rk_thoigiandieuphoi\n    , CASE\n        WHEN cate2.vi_localetext = 'Ph\u00ea duy\u1ec7t'\n          THEN ROW_NUMBER()\n            OVER (PARTITION BY\n                    pra.parentapplrefnumber\n                    , CASE WHEN cate2.vi_localetext = 'Ph\u00ea duy\u1ec7t' THEN 1 ELSE 0 END\n                  ORDER BY rd.routingdate )\n      END AS rk_thoigianpheduyet\n    , RANK() OVER (PARTITION BY pra.parentapplrefnumber ORDER BY rd.rlosroutingdetailsid DESC ) AS rk_chuyendenbuoc_cj5\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__opportunities lop\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__parentapplication pra\n    ON lop.opportunityid = pra.opportunitiesid AND pra.bank_id = 'DFBANK1'\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__rlosroutingdetails rd\n    ON rd.opportunitiesid = pra.opportunitiesid AND pra.bank_id = 'DFBANK1'\n  INNER JOIN cifid apl ON apl.parentapplicationid = pra.parentapplicationid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category cate ON cate.value = rd.routefromstagestep AND cate.categorytype = 'RLOS_APP_STEPS'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_category  cate2 ON cate2.value = rd.routetostagestep AND cate.categorytype = 'RLOS_APP_STEPS'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user lu ON lu.personid = rd.assignedfrom\n  LEFT JOIN approved_date ad ON ad.parentapplicationid = pra.parentapplicationid\n\n)\n, start_time AS (\n  SELECT\n      t.parentapplrefnumber\n    , t.cifid\n    , t.parentapplicationid\n    , t.opportunityid\n    , t.routeto\n    , t.assignedfrom\n    , t.step\n    , t.nextstep\n    , coalesce(LAG(end_time) OVER(PARTITION BY opportunityid ORDER BY rlosroutingdetailsid), fc.bodatecreated) AS start_time\n    , t.end_time\n    , t.end_time -\n        coalesce(LAG(end_time) OVER(PARTITION BY opportunityid ORDER BY rlosroutingdetailsid), fc.bodatecreated) AS tat\n    , t.rlosroutingdetailsid\n    , t.routefromstagestep\n    , u.loginid AS transferredfrom\n    , u1.loginid AS transferredto\n    , t.assignertype\n    , t.approved_date\n    , CASE\n        WHEN t.step = '\u0110i\u1ec1u ph\u1ed1i' AND t.nextstep = 'Nh\u1eadp li\u1ec7u chi ti\u1ebft' THEN 0\n        WHEN t.step = 'Th\u1ea9m \u0111\u1ecbnh 1' AND t.nextstep = 'B\u1ed5 sung' THEN 0\n        ELSE 1\n      END AS is_ftr\n    , CASE\n        WHEN t.rk_thoigiandieuphoi = 1 THEN 1\n        ELSE 0\n      END AS is_dieuphoi_step\n    , CASE\n        WHEN t.rk_thoigianpheduyet = 1 THEN 1\n        ELSE 0\n      END AS is_pheduyet_step\n    , CASE\n        WHEN t.rk_chuyendenbuoc_cj5 = 1 THEN 1\n        ELSE 0\n      END AS is_chuyendenbuoc_cj5\n\n  FROM\n    t\n  LEFT JOIN first_created fc ON fc.entityid = t.opportunityid AND t.routefromstagestep = 'DAQDENT'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u ON u.personid = t.transferredfrom\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__los_user u1 ON u1.personid = t.transferredto\n)\n, remark_rk AS (\nSELECT\n    parentapplicationid\n    ,step\n    ,userid\n    ,tmdate\n    , remarks\n    , ROW_NUMBER() OVER(PARTITION BY parentapplicationid, step, userid, tmdate order by is_real_remarks) AS rk\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__rlosworknotes\n)\n  SELECT * FROM start_time", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_los__tat"}, "model.dga_data_model.int_los__tat_remark": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_rb_los__rlosworknotes", "model.dga_data_model.int_los__tat"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "los", "int_los__tat_remark"], "unique_id": "model.dga_data_model.int_los__tat_remark", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH remark_rk AS (\r\n  SELECT\r\n    parentapplicationid\r\n    , rlosworknotesid\r\n    , step\r\n    , userid\r\n    , tmdate\r\n    , remarks\r\n    , ROW_NUMBER() OVER(PARTITION BY parentapplicationid, step, userid, tmdate order by is_real_remarks) AS rk\r\n  FROM\r\n    {{ ref('stg_rb_los__rlosworknotes')}}\r\n)\r\n, remark AS (\r\n  SELECT\r\n      st.parentapplrefnumber\r\n    , st.parentapplicationid\r\n    , st.routefromstagestep\r\n    , n.rlosworknotesid\r\n    , n.remarks\r\n    , CASE\r\n        WHEN to_char(n.remarks) IS NULL OR to_char(n.remarks) = '\u0110\u00c2Y L\u00c0 H\u1ed2 S\u01a0 NH\u1eacP B\u1edeI ROBOT RPA MERCURY' THEN 1\r\n        ELSE 0\r\n      END AS ftr_cjsb\r\n  FROM\r\n    {{ ref('int_los__tat')}} st\r\n  LEFT JOIN remark_rk n\r\n    ON n.parentapplicationid = st.parentapplicationid\r\n    AND n.step = st.routefromstagestep\r\n    AND n.userid = st.transferredfrom\r\n    AND n.tmdate BETWEEN st.start_time ANd st.end_time\r\n    AND n.rk = 1\r\n\r\n)\r\n  SELECT * FROM remark", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\los\\int_los__tat_remark.sql", "original_file_path": "models\\int\\los\\int_los__tat_remark.sql", "name": "int_los__tat_remark", "alias": "int_los__tat_remark", "checksum": {"name": "sha256", "checksum": "ba4fa2981a4e0e9e11f3c89ca4c2d1d28489686f471069121b54e71417a5240b"}, "tags": ["los_tf"], "refs": [["stg_rb_los__rlosworknotes"], ["int_los__tat"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los__tat_remark.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959751.0783358, "compiled_code": "\nWITH remark_rk AS (\n  SELECT\n    parentapplicationid\n    , rlosworknotesid\n    , step\n    , userid\n    , tmdate\n    , remarks\n    , ROW_NUMBER() OVER(PARTITION BY parentapplicationid, step, userid, tmdate order by is_real_remarks) AS rk\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_rb_los__rlosworknotes\n)\n, remark AS (\n  SELECT\n      st.parentapplrefnumber\n    , st.parentapplicationid\n    , st.routefromstagestep\n    , n.rlosworknotesid\n    , n.remarks\n    , CASE\n        WHEN to_char(n.remarks) IS NULL OR to_char(n.remarks) = '\u0110\u00c2Y L\u00c0 H\u1ed2 S\u01a0 NH\u1eacP B\u1edeI ROBOT RPA MERCURY' THEN 1\n        ELSE 0\n      END AS ftr_cjsb\n  FROM\n    \"oracle_dgaworkzone\".int.int_los__tat st\n  LEFT JOIN remark_rk n\n    ON n.parentapplicationid = st.parentapplicationid\n    AND n.step = st.routefromstagestep\n    AND n.userid = st.transferredfrom\n    AND n.tmdate BETWEEN st.start_time ANd st.end_time\n    AND n.rk = 1\n\n)\n  SELECT * FROM remark", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_los__tat_remark"}, "model.dga_data_model.int_mercury__customer_ckdt": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.mercury__tbl_applicant_enterprise_income", "model.dga_data_model.mercury__tbl_eb_application", "model.dga_data_model.mercury__tbl_eb_applicant", "model.dga_data_model.mercury__tbl_css_eb_applicant", "model.dga_data_model.mercury__tbl_doc_need_list", "model.dga_data_model.mercury__tbl_doc_detail", "model.dga_data_model.mercury__tbl_doc_no_hist"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "mercury", "int_mercury__customer_ckdt"], "unique_id": "model.dga_data_model.int_mercury__customer_ckdt", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH ebIncome AS (\r\n  SELECT\r\n    DISTINCT business_registration_id\r\n    , FIRST_VALUE(revenue) OVER(PARTITION BY business_registration_id ORDER BY ID DESC) AS revenue\r\n  FROM {{ ref('mercury__tbl_applicant_enterprise_income') }} A\r\n)\r\n, source AS (\r\n  SELECT\r\n     ebApplication.process_instance_id,\r\n     ebApplication.css_id,\r\n     ebApplication.los_app_ref_num,\r\n     ebApplication.created_at,\r\n     ebApplication.approval_minutes_type,\r\n     ebApplication.roles,\r\n     ebApplication.created_by,\r\n     ebApplication.customer_segment,\r\n     ebApplication.editing_purpose,\r\n     ebApplication.limit_type,\r\n     ebApplication.limit_sub_type,\r\n     ebApplication.industry,\r\n     ebApplication.other_industry,\r\n     ebApplication.expire_time,\r\n     ebApplication.area,\r\n     ebApplicant.cif_num,\r\n     ebApplicant.business_registration_number,\r\n     ebApplicant.full_name,\r\n     ebApplicant.branch_name,\r\n     cssEb.xep_hang,\r\n     cssEb.nganh_kt,\r\n     cssEb.newest AS css_newest,\r\n     docNeedList.id AS doc_need_list_id,\r\n     docNeedList.props AS doc_need_list_props,\r\n     docDetail.newest AS doc_detail_newest,\r\n     docNoHist.composite_doc_no AS doc_no,\r\n     docNoHist.created_at AS approval_date,\r\n     docDetail.total_collateral_kvalue,\r\n     docDetail.total_collateral_value,\r\n     docDetail.duration,\r\n     docDetail.ckdt_hmcs,\r\n     docDetail.ckdt_month,\r\n     docDetail.maximum_amount,\r\n     docDetail.ckdt_text,\r\n     docDetail.details,\r\n     docDetail.approval_suggestion,\r\n     docDetail.reject_reason,\r\n     ebIncome.revenue\r\n  FROM {{ ref('mercury__tbl_eb_application') }} ebApplication\r\n    LEFT JOIN {{ ref('mercury__tbl_eb_applicant') }} ebApplicant ON\r\n     ebApplicant.eb_application_id = ebApplication.id\r\n    LEFT JOIN {{ ref('mercury__tbl_css_eb_applicant') }} cssEb ON\r\n     cssEb.eb_application_id = ebApplication.id\r\n    LEFT JOIN {{ ref('mercury__tbl_doc_need_list') }} docNeedList ON\r\n     docNeedList.process_instance_id = ebApplication.process_instance_id\r\n    LEFT JOIN {{ ref('mercury__tbl_doc_detail') }} docDetail ON\r\n     docDetail.doc_need_list_id = docNeedList.id\r\n    LEFT JOIN {{ ref('mercury__tbl_doc_no_hist') }} docNoHist ON\r\n     docNoHist.doc_need_list_id = docNeedList.id\r\n    LEFT JOIN ebIncome ON\r\n     ebApplicant.business_registration_number = ebIncome.business_registration_id\r\n\r\n  WHERE 1=1\r\n    AND docNeedList.is_deleted = 0\r\n    AND substr(docNeedList.doc_template_code,1,16) in ('doc_template_008','doc_template_013')\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\mercury\\int_mercury__customer_ckdt.sql", "original_file_path": "models\\int\\mercury\\int_mercury__customer_ckdt.sql", "name": "int_mercury__customer_ckdt", "alias": "int_mercury__customer_ckdt", "checksum": {"name": "sha256", "checksum": "ba21a00d7135b24001a1eddf72ed2b86af364027179620283031878d5c0532a4"}, "tags": ["mercury_daily"], "refs": [["mercury__tbl_applicant_enterprise_income"], ["mercury__tbl_eb_application"], ["mercury__tbl_eb_applicant"], ["mercury__tbl_css_eb_applicant"], ["mercury__tbl_doc_need_list"], ["mercury__tbl_doc_detail"], ["mercury__tbl_doc_no_hist"]], "sources": [], "metrics": [], "description": "", "columns": {"process_instance_id": {"name": "process_instance_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\mercury\\int_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\mercury\\int_mercury__customer_ckdt.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959752.7390063, "compiled_code": "\nWITH ebIncome AS (\n  SELECT\n    DISTINCT business_registration_id\n    , FIRST_VALUE(revenue) OVER(PARTITION BY business_registration_id ORDER BY ID DESC) AS revenue\n  FROM \"oracle_dgaworkzone\".base.mercury__tbl_applicant_enterprise_income A\n)\n, source AS (\n  SELECT\n     ebApplication.process_instance_id,\n     ebApplication.css_id,\n     ebApplication.los_app_ref_num,\n     ebApplication.created_at,\n     ebApplication.approval_minutes_type,\n     ebApplication.roles,\n     ebApplication.created_by,\n     ebApplication.customer_segment,\n     ebApplication.editing_purpose,\n     ebApplication.limit_type,\n     ebApplication.limit_sub_type,\n     ebApplication.industry,\n     ebApplication.other_industry,\n     ebApplication.expire_time,\n     ebApplication.area,\n     ebApplicant.cif_num,\n     ebApplicant.business_registration_number,\n     ebApplicant.full_name,\n     ebApplicant.branch_name,\n     cssEb.xep_hang,\n     cssEb.nganh_kt,\n     cssEb.newest AS css_newest,\n     docNeedList.id AS doc_need_list_id,\n     docNeedList.props AS doc_need_list_props,\n     docDetail.newest AS doc_detail_newest,\n     docNoHist.composite_doc_no AS doc_no,\n     docNoHist.created_at AS approval_date,\n     docDetail.total_collateral_kvalue,\n     docDetail.total_collateral_value,\n     docDetail.duration,\n     docDetail.ckdt_hmcs,\n     docDetail.ckdt_month,\n     docDetail.maximum_amount,\n     docDetail.ckdt_text,\n     docDetail.details,\n     docDetail.approval_suggestion,\n     docDetail.reject_reason,\n     ebIncome.revenue\n  FROM \"oracle_dgaworkzone\".base.mercury__tbl_eb_application ebApplication\n    LEFT JOIN \"oracle_dgaworkzone\".base.mercury__tbl_eb_applicant ebApplicant ON\n     ebApplicant.eb_application_id = ebApplication.id\n    LEFT JOIN \"oracle_dgaworkzone\".base.mercury__tbl_css_eb_applicant cssEb ON\n     cssEb.eb_application_id = ebApplication.id\n    LEFT JOIN \"oracle_dgaworkzone\".base.mercury__tbl_doc_need_list docNeedList ON\n     docNeedList.process_instance_id = ebApplication.process_instance_id\n    LEFT JOIN \"oracle_dgaworkzone\".base.mercury__tbl_doc_detail docDetail ON\n     docDetail.doc_need_list_id = docNeedList.id\n    LEFT JOIN \"oracle_dgaworkzone\".base.mercury__tbl_doc_no_hist docNoHist ON\n     docNoHist.doc_need_list_id = docNeedList.id\n    LEFT JOIN ebIncome ON\n     ebApplicant.business_registration_number = ebIncome.business_registration_id\n\n  WHERE 1=1\n    AND docNeedList.is_deleted = 0\n    AND substr(docNeedList.doc_template_code,1,16) in ('doc_template_008','doc_template_013')\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_mercury__customer_ckdt"}, "model.dga_data_model.int_venus__oppotunity": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "model.dga_data_model.stg_landing__sppl_m_customer", "model.dga_data_model.stg_landing__sppl_m_lead", "model.dga_data_model.stg_landing__sppl_m_campaign", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_team_group", "model.dga_data_model.stg_landing__sppl_m_user", "model.dga_data_model.stg_landing__sppl_m_user"]}, "config": {"enabled": true, "alias": null, "schema": "int", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3", "date_column": "opportunity_date_created"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "int", "fqn": ["dga_data_model", "int", "venus", "int_venus__oppotunity"], "unique_id": "model.dga_data_model.int_venus__oppotunity", "raw_code": "{{\r\n    config(\r\n      materialized='table',\r\n    )\r\n}}\r\nWITH opportunity AS (\r\n  SELECT\r\n    s.id AS opportunity_id\r\n    , CASE\r\n        WHEN c.ID IS NOT NULL THEN c.cif_number\r\n        WHEN lead.ID IS NOT NULL THEN lead.cif_number\r\n      END AS customer_number\r\n    , s.campaign_id\r\n    , s.name AS opportunity_name\r\n    , s.date_created AS opportunity_date_created\r\n    , s.last_updated AS opportunity_last_updated\r\n    , s.last_assign_date\r\n    , cam.date_created AS campaign_date_created\r\n    , cam.expiration_date AS campaign_expiration\r\n    , cam.code AS campaign_code\r\n    , cam.name AS campaign_name\r\n    , u.employee_code AS leader_code\r\n    , u.fullname AS leader_fullname\r\n    , u.username AS leader_username\r\n    , u2.employee_code as sale_code\r\n    , u2.fullname as sale_fullname\r\n    , lead.lead_source_name AS lead_source_name\r\n    , lead.utm_campaign AS utm_campaign\r\n    , lead.utm_content AS utm_content\r\n    , lead.utm_medium AS utm_medium\r\n    , lead.utm_source AS utm_source\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b4.name\r\n        WHEN b.TREE_LEVEL = 3 THEN b3.name\r\n      END AS central\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b4.id\r\n        WHEN b.TREE_LEVEL = 3 THEN b3.id\r\n      END AS central_id\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b3.name\r\n        WHEN b.TREE_LEVEL = 3 THEN b2.name\r\n      END AS area\r\n      , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b3.id\r\n        WHEN b.TREE_LEVEL = 3 THEN b2.id\r\n      END AS area_id\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b2.name\r\n        WHEN b.TREE_LEVEL = 3 THEN b.name\r\n      END AS branch\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b2.id\r\n        WHEN b.TREE_LEVEL = 3 THEN b.id\r\n      END AS branch_id\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b.code\r\n        WHEN b.TREE_LEVEL = 3 THEN null\r\n      END AS pgd\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b.id\r\n        WHEN b.TREE_LEVEL = 3 THEN null\r\n      END AS pgd_id\r\n    , CASE\r\n        WHEN b.TREE_LEVEL = 4 THEN b.name\r\n        WHEN b.TREE_LEVEL = 3 THEN null\r\n      END AS pgd_name\r\n    , tg.name as teamgroup_name\r\n    , tg.id as teamgroup_id\r\n  FROM {{ ref('stg_landing__sppl_m_selling_opportunity')}} s\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_customer')}} c on s.customer_id = c.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_lead')}} lead on s.lead_id = lead.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_campaign')}} cam on s.campaign_id = cam.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_branch')}} b on s.branch_id = b.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_branch')}} b2 on b.parent_id = b2.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_branch')}} b3 on b2.parent_id = b3.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_branch')}} b4 on b3.parent_id = b4.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_team_group')}} tg on s.team_group_id = tg.id\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_user')}} u on tg.email_leader = u.email\r\n  LEFT JOIN {{ ref('stg_landing__sppl_m_user')}} u2 on s.owner_id = u2.id\r\n)\r\n  SELECT * FROM opportunity", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "int\\venus\\int_venus__oppotunity.sql", "original_file_path": "models\\int\\venus\\int_venus__oppotunity.sql", "name": "int_venus__oppotunity", "alias": "int_venus__oppotunity", "checksum": {"name": "sha256", "checksum": "f15d9b6c1401a19f3f2d1429149c60277f96a4e42b63bdd02e64c97c91292414"}, "tags": ["venus_daily"], "refs": [["stg_landing__sppl_m_selling_opportunity"], ["stg_landing__sppl_m_customer"], ["stg_landing__sppl_m_lead"], ["stg_landing__sppl_m_campaign"], ["stg_landing__sppl_m_branch"], ["stg_landing__sppl_m_branch"], ["stg_landing__sppl_m_branch"], ["stg_landing__sppl_m_branch"], ["stg_landing__sppl_m_team_group"], ["stg_landing__sppl_m_user"], ["stg_landing__sppl_m_user"]], "sources": [], "metrics": [], "description": "", "columns": {"opportunity_id": {"name": "opportunity_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "opportunity_date_created"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\int\\venus\\venus_int.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\venus\\int_venus__oppotunity.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "int", "meta": {"date_column": "opportunity_date_created"}, "tags": "venus_daily", "materialized": "table"}, "created_at": 1685959752.748907, "compiled_code": "\nWITH opportunity AS (\n  SELECT\n    s.id AS opportunity_id\n    , CASE\n        WHEN c.ID IS NOT NULL THEN c.cif_number\n        WHEN lead.ID IS NOT NULL THEN lead.cif_number\n      END AS customer_number\n    , s.campaign_id\n    , s.name AS opportunity_name\n    , s.date_created AS opportunity_date_created\n    , s.last_updated AS opportunity_last_updated\n    , s.last_assign_date\n    , cam.date_created AS campaign_date_created\n    , cam.expiration_date AS campaign_expiration\n    , cam.code AS campaign_code\n    , cam.name AS campaign_name\n    , u.employee_code AS leader_code\n    , u.fullname AS leader_fullname\n    , u.username AS leader_username\n    , u2.employee_code as sale_code\n    , u2.fullname as sale_fullname\n    , lead.lead_source_name AS lead_source_name\n    , lead.utm_campaign AS utm_campaign\n    , lead.utm_content AS utm_content\n    , lead.utm_medium AS utm_medium\n    , lead.utm_source AS utm_source\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b4.name\n        WHEN b.TREE_LEVEL = 3 THEN b3.name\n      END AS central\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b4.id\n        WHEN b.TREE_LEVEL = 3 THEN b3.id\n      END AS central_id\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b3.name\n        WHEN b.TREE_LEVEL = 3 THEN b2.name\n      END AS area\n      , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b3.id\n        WHEN b.TREE_LEVEL = 3 THEN b2.id\n      END AS area_id\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b2.name\n        WHEN b.TREE_LEVEL = 3 THEN b.name\n      END AS branch\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b2.id\n        WHEN b.TREE_LEVEL = 3 THEN b.id\n      END AS branch_id\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b.code\n        WHEN b.TREE_LEVEL = 3 THEN null\n      END AS pgd\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b.id\n        WHEN b.TREE_LEVEL = 3 THEN null\n      END AS pgd_id\n    , CASE\n        WHEN b.TREE_LEVEL = 4 THEN b.name\n        WHEN b.TREE_LEVEL = 3 THEN null\n      END AS pgd_name\n    , tg.name as teamgroup_name\n    , tg.id as teamgroup_id\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_opportunity s\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_customer c on s.customer_id = c.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_lead lead on s.lead_id = lead.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_campaign cam on s.campaign_id = cam.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_branch b on s.branch_id = b.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_branch b2 on b.parent_id = b2.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_branch b3 on b2.parent_id = b3.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_branch b4 on b3.parent_id = b4.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_team_group tg on s.team_group_id = tg.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_user u on tg.email_leader = u.email\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_user u2 on s.owner_id = u2.id\n)\n  SELECT * FROM opportunity", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".int.int_venus__oppotunity"}, "model.dga_data_model.dim_bpm__loan_application": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.df_2.bpm_branch_mapping", "source.dga_data_model.df_2.bpm_application", "source.dga_data_model.df_2.jstb_12", "source.dga_data_model.df_2.jstb_111", "source.dga_data_model.df_2.bpm_eb_customer", "source.dga_data_model.df_2.bpm_application_data", "source.dga_data_model.df_2.bpm_opportunity"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["bpm_df"], "meta": {"date_column": "create_date", "owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_thamdinh", "dim_bpm__loan_application"], "unique_id": "model.dga_data_model.dim_bpm__loan_application", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\n\r\n\r\nwith\r\nbpm_branch_mapping as\r\n(select bm.*,\r\n                    row_number() over (partition by branch_id order by etl_Date desc) rn\r\n                from {{ source('df_2','bpm_branch_mapping') }} bm),\r\nbpm_opportunity as\r\n(select opp.*,\r\n                        row_number() over (partition by id order by etl_Date desc) rn\r\n                from {{ source('df_2','bpm_opportunity') }} opp),\r\nbpm_eb_customer as\r\n(select ec.*,\r\n                        row_number() over (partition by id order by etl_date desc) rn\r\n                from {{ source('df_2','bpm_eb_customer') }} ec),\r\nbpm_application_data as\r\n(select ad.*,\r\n                         row_number() over (partition by APPLICATION_ID order by UPDATED_TIMESTAMP desc) rn\r\n               from {{ source('df_2','bpm_application_data') }} ad\r\n                where 1=1\r\n                 AND ad.type = 'APPROVAL'\r\n                 AND ad.key = 'suggestedLimit'\r\n--                 and application_id = '1943b234-b1cf-44f6-a8a1-b3f0ff307532'\r\n                ),\r\n solu as\r\n (select ad.*,\r\n                         row_number() over (partition by APPLICATION_ID order by UPDATED_TIMESTAMP desc) rn\r\n               from {{ source('df_2','bpm_application_data') }} ad\r\n                where 1=1),\r\nid_css as\r\n(select a.*,\r\n                        row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_111') }} a),\r\nci as\r\n(select ci.*,\r\n                        row_number() over (partition by application_id order by ETL_DATE DESC) rn\r\n                from {{ source('df_2','bpm_application_data') }} ci\r\n                where 1=1\r\n                                                     AND ci.type = 'PROPOSAL'\r\n                                                     AND ci.key = 'customerInfo'\r\n                                                     ),\r\n sector as\r\n(select a.*,\r\n                        row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n    from {{ source('df_2','jstb_12') }} a),\r\n\r\n\r\nsrc as\r\n(\r\nSELECT\r\n        -- thong tin khach hang\r\n     app.id                                                                                                                                                                                                                                                                                                        AS app_id,\r\n        ec.cif                                                                                                                                                                                                                                                                                                        AS\r\n    cif,\r\n    ec.business_code                                                                                                                                                                                                                                                                                              AS\r\n    tax_code_full,\r\n    substr(ec.business_code, 1, 10)                                                                                                                                                                                                                                                                               AS\r\n    tax_code,\r\n    ec.corporate_name_vn                                                                                                                                                                                                                                                                                          AS\r\n    ten_doanh_nghiep,\r\n    CAST(APP.INITIATION_DATE AS DATE) CREATE_DATE,\r\n    ec.company_type_desc,\r\n    ec.business_sector_desc,\r\n    sector.sectorLV5,\r\n    sectorLV5Desc,\r\n    coalesce(regexp_extract(sector.sectorLV5,'\\d+'),regexp_extract(sectorLV5Desc, '(\\d+)\\s*-*',1) ) industry_lv5_code,\r\n    regexp_replace(sector.sectorLV5Desc,'(\\d+\\s*-\\s*)|\"','') industry_lv5_name,       -- thong tin khoan vay\r\n    opp.id                                                                                                                                                                                                                                                                                                        AS\r\n    opportunity_id,\r\n    opp.landing_page_id                                                                                                                                                                                                                                                                                           AS\r\n    landing_page_id,\r\n    opp.application_purpose_desc,\r\n    opp.solution_package_desc,\r\n    CASE\r\n        WHEN coalesce(opp.solution_package,solu.solution) = '2'   THEN\r\n            'Hook2'\r\n        WHEN coalesce(opp.solution_package,solu.solution) = '1'   THEN\r\n            'Hook1'\r\n        WHEN coalesce(opp.solution_package,solu.solution) = '3'   THEN\r\n            'M_SME Hook'\r\n        WHEN coalesce(opp.solution_package,solu.solution) = '1,2' or coalesce(opp.solution_package,solu.solution) = '2,1' THEN\r\n            'Combo'\r\n    END                                                                                                                                                                                                                                                                                                           AS\r\n    product,\r\n    opp.loan_type,\r\n    opp.loan_type_desc,\r\n    opp.segment_desc                                                                                                                                                                                                                                                                                              AS\r\n    segment,\r\n    opp.total_credit_limit_needed                                                                                                                                                                                                                                                                                 AS\r\n    limit_requested,\r\n    opp.source app_source,       -- thong tin application\r\n    app.bpm_id  bpm_id,\r\n    app.app_status,\r\n    app.app_status_desc,\r\n    app.branch_name,\r\n    CASE WHEN UPPER(bm.DESCRIPTION) LIKE 'MSB%' then 'RBTC'\r\n    else 'SnD'\r\n    END AS sale_channel,\r\n    CASE\r\n          WHEN LENGTH(APP.BRANCH_ID) < 6  AND UPPER(APP.BRANCH_NAME) LIKE 'CHI NH\u00c1NH%' then substr(APP.BRANCH_NAME, 11, length(APP.BRANCH_NAME) - 10)\r\n          WHEN LENGTH(APP.BRANCH_ID) < 6 THEN APP.BRANCH_NAME\r\n        WHEN bm.description LIKE 'MSB%' THEN\r\n            substr(bm.description, 5, length(bm.description) - 4)\r\n        ELSE\r\n            bm.description\r\n    END                                                                                                                                                                                                                                                                                                           AS\r\n    branch_name_1,\r\n    app.process_flow,\r\n    app.sale_owner_id,\r\n    app.teamlead_id,\r\n    app.hubhead_id,\r\n    app.checklist_status,\r\n    app.finished_date                                                                                                                                                                                                                                                                                             AS\r\n    close_date,\r\n--    ah.rm_first_create_date,\r\n--    ah.tl_first_submit_date,\r\n--    ah.hh_first_submit_date,\r\n--    ah.hh_last_approved_date,\r\n    cast(id_css.revenueLastYear as bigint)                                                                                                                                                                                                                                                    AS\r\n    doanh_thu,\r\n    case when coalesce(opp.solution_package,solu.solution) IN ( '2', '3' ) THEN 'USL'\r\n    else 'SL'\r\n    end as USL_SL\r\nFROM\r\n    {{ source('df_2','bpm_application') }}   app\r\n    LEFT JOIN bpm_branch_mapping bm ON app.branch_id = bm.branch_id\r\n                and bm.rn =1\r\n    LEFT JOIN bpm_opportunity opp ON app.opportunity_id = opp.id\r\n                and opp.rn = 1\r\n    LEFT JOIN bpm_eb_customer ec ON opp.customer_id = ec.id\r\n                and ec.rn = 1\r\n    LEFT JOIN bpm_application_data ad ON ad.application_id = app.id\r\n                and ad.rn = 1\r\n     LEFT JOIN solu on solu.application_id = app.id\r\n                and solu.rn = 1\r\n    left join id_css on ad.id = id_css.key_row_id\r\n                and id_css.rn = 1\r\n    LEFT JOIN ci ON ci.application_id = app.id\r\n                                                     and ci.rn = 1\r\n    left join sector on ci.id = sector.key_row_id\r\n                    and sector.rn = 1\r\nWHERE\r\n    upper(ec.corporate_name_vn) NOT LIKE upper('%test%')\r\n    AND upper(ec.corporate_name_vn) NOT LIKE upper('%[TECH]%')\r\n    AND upper(ec.corporate_name_vn) NOT LIKE upper('%ABC%')\r\n    AND upper(ec.corporate_name_vn) NOT LIKE upper('%1234%')\r\n    AND lower(ec.business_code) NOT IN ( 'ma99iso1' )\r\n    AND ( length(ec.business_code) = 10\r\n          OR length(ec.business_code) = 14 )\r\n)\r\n\r\n, final as\r\n(\r\nSELECT 'BPM' AS source\r\n        ,cif\r\n        ,app_id\r\n        ,landing_page_id\r\n        ,tax_code\r\n        ,tax_code_full as tax_code_branch\r\n\t\t, TRIM(CASE WHEN BRANCH_NAME_1 IN ('Chi nh\u00e1nh Kh\u00e1nh H\u00f2a') THEN 'Kh\u00e1nh H\u00f2a'\r\n\t\t\t\tWHEN BRANCH_NAME_1 IN ('Chi nh\u00e1nh Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh','HCM') THEN 'H\u1ed3 Ch\u00ed Minh'\r\n\t\t\t\twhen branch_name_1 like 'MSB%' THEN substr(BRANCH_NAME_1,0,LENgth(BRANCH_NAME_1)-4)\r\n\t\t\t\tELSE BRANCH_NAME_1 end) AS branch\r\n\t\t,TEN_DOANH_NGHIEP AS customer_name\r\n          ,create_date\r\n\t\t,PRODUCT segment_level1_t\r\n--\t\t,'HubHead' as CAP_PD\r\n--\t\t,12 AS HIEU_LUC_HAN_MUC\r\n\t\t,case when industry_lv5_code  = 'null' then substr(industry_lv5_name,0,5)\r\n        else industry_lv5_code\r\n        end as industry_lv5_code\r\n        ,industry_lv5_name\r\n\t\t,BUSINESS_SECTOR_DESC AS industry_lv0_code\r\n\t\t,DOANH_THU doanh_thu\r\n\t\t,COMPANY_TYPE_DESC AS loai_hinh_dn\r\n\t\t,APPLICATION_PURPOSE_DESC AS muc_dich_chinh\r\n\t\t,case when SEGMENT = 'M_SME' then 'M-SME'\r\n\t\tELSE SEGMENT\r\n\t\t END AS phan_khuc\r\n\t\t,usl_sl -- thamntk2: l\u1ea5y l\u1ea1i theo \u0111\u00fang ph\u00e2n kh\u00fac\r\n\r\n\r\n\t\t,sale_owner_id\r\n\t\t,teamlead_id\r\n\t\t,hubhead_id\r\n\t\t,sale_channel\r\n\r\nFROM\r\n\t\tsrc A\r\nWHERE  1=1\r\nand tax_code NOT IN ('0313497679') -- M\u00c3 C\u00d4NG TY B? SAI\"\r\n)\r\n\r\nselect *\r\nfrom\r\nfinal a", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_thamdinh\\dim_bpm__loan_application.sql", "original_file_path": "models\\mart\\bpm_thamdinh\\dim_bpm__loan_application.sql", "name": "dim_bpm__loan_application", "alias": "dim_bpm__loan_application", "checksum": {"name": "sha256", "checksum": "40ee40d02bfddca452606c7eb5af4c4d96d41a0f7536ec1da52d81278df4f4e5"}, "tags": ["bpm_df"], "refs": [], "sources": [["df_2", "bpm_branch_mapping"], ["df_2", "bpm_application"], ["df_2", "jstb_12"], ["df_2", "jstb_111"], ["df_2", "bpm_eb_customer"], ["df_2", "bpm_application_data"], ["df_2", "bpm_opportunity"]], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "create_date", "owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_thamdinh\\dim_bpm__loan_application.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "tags": ["bpm_df"], "meta": {"date_column": "create_date", "owner": "thaidv3"}, "materialized": "table"}, "created_at": 1685959752.7539797, "compiled_code": "\n\n\n\nwith\nbpm_branch_mapping as\n(select bm.*,\n                    row_number() over (partition by branch_id order by etl_Date desc) rn\n                from oracle_bulanding.df_2.bpm_branch_mapping bm),\nbpm_opportunity as\n(select opp.*,\n                        row_number() over (partition by id order by etl_Date desc) rn\n                from oracle_bulanding.df_2.bpm_opportunity opp),\nbpm_eb_customer as\n(select ec.*,\n                        row_number() over (partition by id order by etl_date desc) rn\n                from oracle_bulanding.df_2.bpm_eb_customer ec),\nbpm_application_data as\n(select ad.*,\n                         row_number() over (partition by APPLICATION_ID order by UPDATED_TIMESTAMP desc) rn\n               from oracle_bulanding.df_2.bpm_application_data ad\n                where 1=1\n                 AND ad.type = 'APPROVAL'\n                 AND ad.key = 'suggestedLimit'\n--                 and application_id = '1943b234-b1cf-44f6-a8a1-b3f0ff307532'\n                ),\n solu as\n (select ad.*,\n                         row_number() over (partition by APPLICATION_ID order by UPDATED_TIMESTAMP desc) rn\n               from oracle_bulanding.df_2.bpm_application_data ad\n                where 1=1),\nid_css as\n(select a.*,\n                        row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_111 a),\nci as\n(select ci.*,\n                        row_number() over (partition by application_id order by ETL_DATE DESC) rn\n                from oracle_bulanding.df_2.bpm_application_data ci\n                where 1=1\n                                                     AND ci.type = 'PROPOSAL'\n                                                     AND ci.key = 'customerInfo'\n                                                     ),\n sector as\n(select a.*,\n                        row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n    from oracle_bulanding.df_2.jstb_12 a),\n\n\nsrc as\n(\nSELECT\n        -- thong tin khach hang\n     app.id                                                                                                                                                                                                                                                                                                        AS app_id,\n        ec.cif                                                                                                                                                                                                                                                                                                        AS\n    cif,\n    ec.business_code                                                                                                                                                                                                                                                                                              AS\n    tax_code_full,\n    substr(ec.business_code, 1, 10)                                                                                                                                                                                                                                                                               AS\n    tax_code,\n    ec.corporate_name_vn                                                                                                                                                                                                                                                                                          AS\n    ten_doanh_nghiep,\n    CAST(APP.INITIATION_DATE AS DATE) CREATE_DATE,\n    ec.company_type_desc,\n    ec.business_sector_desc,\n    sector.sectorLV5,\n    sectorLV5Desc,\n    coalesce(regexp_extract(sector.sectorLV5,'\\d+'),regexp_extract(sectorLV5Desc, '(\\d+)\\s*-*',1) ) industry_lv5_code,\n    regexp_replace(sector.sectorLV5Desc,'(\\d+\\s*-\\s*)|\"','') industry_lv5_name,       -- thong tin khoan vay\n    opp.id                                                                                                                                                                                                                                                                                                        AS\n    opportunity_id,\n    opp.landing_page_id                                                                                                                                                                                                                                                                                           AS\n    landing_page_id,\n    opp.application_purpose_desc,\n    opp.solution_package_desc,\n    CASE\n        WHEN coalesce(opp.solution_package,solu.solution) = '2'   THEN\n            'Hook2'\n        WHEN coalesce(opp.solution_package,solu.solution) = '1'   THEN\n            'Hook1'\n        WHEN coalesce(opp.solution_package,solu.solution) = '3'   THEN\n            'M_SME Hook'\n        WHEN coalesce(opp.solution_package,solu.solution) = '1,2' or coalesce(opp.solution_package,solu.solution) = '2,1' THEN\n            'Combo'\n    END                                                                                                                                                                                                                                                                                                           AS\n    product,\n    opp.loan_type,\n    opp.loan_type_desc,\n    opp.segment_desc                                                                                                                                                                                                                                                                                              AS\n    segment,\n    opp.total_credit_limit_needed                                                                                                                                                                                                                                                                                 AS\n    limit_requested,\n    opp.source app_source,       -- thong tin application\n    app.bpm_id  bpm_id,\n    app.app_status,\n    app.app_status_desc,\n    app.branch_name,\n    CASE WHEN UPPER(bm.DESCRIPTION) LIKE 'MSB%' then 'RBTC'\n    else 'SnD'\n    END AS sale_channel,\n    CASE\n          WHEN LENGTH(APP.BRANCH_ID) < 6  AND UPPER(APP.BRANCH_NAME) LIKE 'CHI NH\u00c1NH%' then substr(APP.BRANCH_NAME, 11, length(APP.BRANCH_NAME) - 10)\n          WHEN LENGTH(APP.BRANCH_ID) < 6 THEN APP.BRANCH_NAME\n        WHEN bm.description LIKE 'MSB%' THEN\n            substr(bm.description, 5, length(bm.description) - 4)\n        ELSE\n            bm.description\n    END                                                                                                                                                                                                                                                                                                           AS\n    branch_name_1,\n    app.process_flow,\n    app.sale_owner_id,\n    app.teamlead_id,\n    app.hubhead_id,\n    app.checklist_status,\n    app.finished_date                                                                                                                                                                                                                                                                                             AS\n    close_date,\n--    ah.rm_first_create_date,\n--    ah.tl_first_submit_date,\n--    ah.hh_first_submit_date,\n--    ah.hh_last_approved_date,\n    cast(id_css.revenueLastYear as bigint)                                                                                                                                                                                                                                                    AS\n    doanh_thu,\n    case when coalesce(opp.solution_package,solu.solution) IN ( '2', '3' ) THEN 'USL'\n    else 'SL'\n    end as USL_SL\nFROM\n    oracle_bulanding.df_2.bpm_application   app\n    LEFT JOIN bpm_branch_mapping bm ON app.branch_id = bm.branch_id\n                and bm.rn =1\n    LEFT JOIN bpm_opportunity opp ON app.opportunity_id = opp.id\n                and opp.rn = 1\n    LEFT JOIN bpm_eb_customer ec ON opp.customer_id = ec.id\n                and ec.rn = 1\n    LEFT JOIN bpm_application_data ad ON ad.application_id = app.id\n                and ad.rn = 1\n     LEFT JOIN solu on solu.application_id = app.id\n                and solu.rn = 1\n    left join id_css on ad.id = id_css.key_row_id\n                and id_css.rn = 1\n    LEFT JOIN ci ON ci.application_id = app.id\n                                                     and ci.rn = 1\n    left join sector on ci.id = sector.key_row_id\n                    and sector.rn = 1\nWHERE\n    upper(ec.corporate_name_vn) NOT LIKE upper('%test%')\n    AND upper(ec.corporate_name_vn) NOT LIKE upper('%[TECH]%')\n    AND upper(ec.corporate_name_vn) NOT LIKE upper('%ABC%')\n    AND upper(ec.corporate_name_vn) NOT LIKE upper('%1234%')\n    AND lower(ec.business_code) NOT IN ( 'ma99iso1' )\n    AND ( length(ec.business_code) = 10\n          OR length(ec.business_code) = 14 )\n)\n\n, final as\n(\nSELECT 'BPM' AS source\n        ,cif\n        ,app_id\n        ,landing_page_id\n        ,tax_code\n        ,tax_code_full as tax_code_branch\n\t\t, TRIM(CASE WHEN BRANCH_NAME_1 IN ('Chi nh\u00e1nh Kh\u00e1nh H\u00f2a') THEN 'Kh\u00e1nh H\u00f2a'\n\t\t\t\tWHEN BRANCH_NAME_1 IN ('Chi nh\u00e1nh Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh','HCM') THEN 'H\u1ed3 Ch\u00ed Minh'\n\t\t\t\twhen branch_name_1 like 'MSB%' THEN substr(BRANCH_NAME_1,0,LENgth(BRANCH_NAME_1)-4)\n\t\t\t\tELSE BRANCH_NAME_1 end) AS branch\n\t\t,TEN_DOANH_NGHIEP AS customer_name\n          ,create_date\n\t\t,PRODUCT segment_level1_t\n--\t\t,'HubHead' as CAP_PD\n--\t\t,12 AS HIEU_LUC_HAN_MUC\n\t\t,case when industry_lv5_code  = 'null' then substr(industry_lv5_name,0,5)\n        else industry_lv5_code\n        end as industry_lv5_code\n        ,industry_lv5_name\n\t\t,BUSINESS_SECTOR_DESC AS industry_lv0_code\n\t\t,DOANH_THU doanh_thu\n\t\t,COMPANY_TYPE_DESC AS loai_hinh_dn\n\t\t,APPLICATION_PURPOSE_DESC AS muc_dich_chinh\n\t\t,case when SEGMENT = 'M_SME' then 'M-SME'\n\t\tELSE SEGMENT\n\t\t END AS phan_khuc\n\t\t,usl_sl -- thamntk2: l\u1ea5y l\u1ea1i theo \u0111\u00fang ph\u00e2n kh\u00fac\n\n\n\t\t,sale_owner_id\n\t\t,teamlead_id\n\t\t,hubhead_id\n\t\t,sale_channel\n\nFROM\n\t\tsrc A\nWHERE  1=1\nand tax_code NOT IN ('0313497679') -- M\u00c3 C\u00d4NG TY B? SAI\"\n)\n\nselect *\nfrom\nfinal a", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim_bpm__loan_application"}, "model.dga_data_model.fact_bpm__loan_application_activities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.df_2.bpm_application", "source.dga_data_model.df_2.bpm_eb_customer", "source.dga_data_model.df_2.bpm_application_history_detail", "source.dga_data_model.df_2.bpm_opportunity"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["bpm_df"], "meta": {"date_column": "start_time", "owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_thamdinh", "fact_bpm__loan_application_activities"], "unique_id": "model.dga_data_model.fact_bpm__loan_application_activities", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nwith output as\r\n(\r\nselect\r\n'BPM' source,\r\nt1.id,\r\nt2.id application_id,\r\nsubstr(t4.business_code, 1, 10) tax_code,\r\nUPPER(t4.corporate_name_vn) customer_name,\r\nt1.created_by user_name,\r\nt1.step application_step_id,\r\nt1.step_desc,\r\nt1.phase,\r\nt1.phase_desc,\r\nt5.type_desc step_decision,\r\ncast(t5.tag_desc as VARCHAR(1000)) step_decision_note,\r\n(from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', t5.created_timestamp)))  at time zone 'Asia/Ho_Chi_Minh'  step_decision_at,\r\n(from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', t1.created_timestamp)))  at time zone 'Asia/Ho_Chi_Minh' start_time,\r\n(from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', lead(t1.created_timestamp ,1)\r\n\tover  (partition by t1.application_id order by t1.created_timestamp))))  at time zone 'Asia/Ho_Chi_Minh' end_time,\r\nrank() over (partition by t1.application_id order by t1.created_timestamp desc) step_order_desc,\r\nrank() over (partition by t1.application_id order by t1.created_timestamp asc) step_order_asc\r\nfrom oracle_bulanding.df_2.bpm_application_history t1\r\nleft join {{ source('df_2', 'bpm_application') }} t2 on t1.application_id = t2.id\r\nleft join {{ source('df_2', 'bpm_opportunity') }} t3 on t2.opportunity_id = t3.id\r\nleft join {{ source('df_2', 'bpm_eb_customer') }} t4 on t3.customer_id = t4.id\r\nleft join {{ source('df_2', 'bpm_application_history_detail') }} t5 on t5.application_history_id = t1.id\r\n)\r\n\r\nselect * from output", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_thamdinh\\fact_bpm__loan_application_activities.sql", "original_file_path": "models\\mart\\bpm_thamdinh\\fact_bpm__loan_application_activities.sql", "name": "fact_bpm__loan_application_activities", "alias": "fact_bpm__loan_application_activities", "checksum": {"name": "sha256", "checksum": "38bbc8ecfd34717125fa4490f6fc0b783a476044587711e81219933e1631f68e"}, "tags": ["bpm_df"], "refs": [], "sources": [["df_2", "bpm_application"], ["df_2", "bpm_eb_customer"], ["df_2", "bpm_application_history_detail"], ["df_2", "bpm_opportunity"]], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "start_time", "owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_thamdinh\\fact_bpm__loan_application_activities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "tags": ["bpm_df"], "meta": {"date_column": "start_time", "owner": "thaidv3"}, "materialized": "table"}, "created_at": 1685959752.7559788, "compiled_code": "\n\nwith output as\n(\nselect\n'BPM' source,\nt1.id,\nt2.id application_id,\nsubstr(t4.business_code, 1, 10) tax_code,\nUPPER(t4.corporate_name_vn) customer_name,\nt1.created_by user_name,\nt1.step application_step_id,\nt1.step_desc,\nt1.phase,\nt1.phase_desc,\nt5.type_desc step_decision,\ncast(t5.tag_desc as VARCHAR(1000)) step_decision_note,\n(from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', t5.created_timestamp)))  at time zone 'Asia/Ho_Chi_Minh'  step_decision_at,\n(from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', t1.created_timestamp)))  at time zone 'Asia/Ho_Chi_Minh' start_time,\n(from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', lead(t1.created_timestamp ,1)\n\tover  (partition by t1.application_id order by t1.created_timestamp))))  at time zone 'Asia/Ho_Chi_Minh' end_time,\nrank() over (partition by t1.application_id order by t1.created_timestamp desc) step_order_desc,\nrank() over (partition by t1.application_id order by t1.created_timestamp asc) step_order_asc\nfrom oracle_bulanding.df_2.bpm_application_history t1\nleft join oracle_bulanding.df_2.bpm_application t2 on t1.application_id = t2.id\nleft join oracle_bulanding.df_2.bpm_opportunity t3 on t2.opportunity_id = t3.id\nleft join oracle_bulanding.df_2.bpm_eb_customer t4 on t3.customer_id = t4.id\nleft join oracle_bulanding.df_2.bpm_application_history_detail t5 on t5.application_history_id = t1.id\n)\n\nselect * from output", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact_bpm__loan_application_activities"}, "model.dga_data_model.fact_bpm__loan_application_decision": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.df_2.jstb_184", "source.dga_data_model.df_2.jstb_145", "source.dga_data_model.df_2.bpm_application_history_detail", "source.dga_data_model.df_2.jstb_3", "source.dga_data_model.df_2.jstb_183", "source.dga_data_model.df_2.jstb_147", "source.dga_data_model.df_2.bpm_opportunity", "source.dga_data_model.df_2.jstb_110", "source.dga_data_model.df_2.jstb_118", "source.dga_data_model.df_2.jstb_171", "source.dga_data_model.df_2.jstb_155", "source.dga_data_model.df_2.jstb_188", "source.dga_data_model.df_2.jstb_159", "source.dga_data_model.df_2.jstb_20363", "source.dga_data_model.df_2.jstb_154", "source.dga_data_model.df_2.jstb_174", "source.dga_data_model.df_2.jstb_240", "source.dga_data_model.df_2.jstb_189", "source.dga_data_model.df_2.jstb_135", "source.dga_data_model.df_2.jstb_122", "source.dga_data_model.df_2.jstb_123", "source.dga_data_model.df_2.bpm_application_history", "source.dga_data_model.df_2.jstb_143", "source.dga_data_model.df_2.jstb_152", "source.dga_data_model.df_2.bpm_branch_mapping", "source.dga_data_model.df_2.jstb_111", "source.dga_data_model.df_2.jstb_153", "source.dga_data_model.df_2.bpm_application_data"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["bpm_df"], "meta": {"date_column": "tat", "owner": "thaidv3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_thamdinh", "fact_bpm__loan_application_decision"], "unique_id": "model.dga_data_model.fact_bpm__loan_application_decision", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nwith\r\nbpm_branch_mapping as\r\n(select bm.*, row_number() over (partition by branch_id order by etl_Date desc) rn\r\n                from {{ source('df_2','bpm_branch_mapping') }} bm),\r\nbpm_opportunity as\r\n(select opp.*, row_number() over (partition by id order by etl_Date desc) rn\r\n                from {{ source('df_2','bpm_opportunity') }} opp),\r\nbpm_application_history as\r\n(\r\n        SELECT\r\n            application_id,\r\n            type_desc,\r\n            tag_desc\r\n        FROM\r\n                 {{ source('df_2','bpm_application_history_detail') }} ahd\r\n            JOIN {{ source('df_2','bpm_application_history') }} ah ON ahd.application_history_id = ah.id\r\n        WHERE\r\n            ah.step = 'PD-42' ),\r\nad as\r\n(select ad.*,\r\n                    row_number() over (partition by application_id order by UPDATED_TIMESTAMP DESC) RN\r\n               from {{ source('df_2','bpm_application_data') }} ad\r\n                where 1=1\r\n                 AND ad.type = 'APPROVAL'\r\n                 AND ad.key = 'suggestedLimit'\r\n\r\n                ),\r\n\r\nhook_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_110') }} a) ,\r\n\r\nhook_total_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_123') }} a) ,\r\n\r\ncombo_hook1_total_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_153') }} a),\r\n\r\ncombo_hook2_total_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_155') }} a),\r\nid_css as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_111') }} a),\r\nhook_overdraft as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_118') }} a),\r\ncombo_hook1_overdraft as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_143') }} a),\r\ncombo_hook2_overdraft as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_145') }} a),\r\nhook_credit_Card as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_122') }} a),\r\ncombo_hook1_credit_Card as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_152') }} a),\r\ncombo_hook2_credit_Card as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_154') }} a),\r\nhook_short_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_147') }} a),\r\ncombo_hook1_short_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_183') }} a),\r\ncombo_hook2_short_limit as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_184') }} a),\r\nhook_payment_guarantee as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_159' ) }} a),\r\ncombo_hook1_payment_guarantee as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_188') }} a),\r\ncombo_hook2_payment_guarantee as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_189' ) }} a),\r\nhook_LC as\r\n(select a.* , row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_135') }} a),\r\ncombo_hook1_LC as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_171') }} a),\r\ncombo_hook2_LC as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_174') }} a),\r\nckdt as\r\n(select ckdt.*,\r\n                row_number() over (partition by application_id order by ETL_DATE DESC) rn\r\n                from {{ source('df_2','bpm_application_data') }} ckdt\r\n                where 1=1\r\n                                                       AND ckdt.type = 'APPROVAL'\r\n                                                       AND ckdt.key = 'creditRequirements'\r\n                                                       ),\r\ntat as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_20363') }} a),\r\nrevenueRoutingRequirement as\r\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n                from {{ source('df_2','jstb_240') }} a),\r\nci as\r\n(select ci.*, row_number() over (partition by application_id order by ETL_DATE DESC) rn\r\n                from {{ source('df_2','bpm_application_data') }} ci\r\n                where 1=1\r\n                                                     AND ci.type = 'PROPOSAL'\r\n                                                     AND ci.key = 'customerInfo'\r\n                                                     ),\r\n    ti as\r\n    (select ci.*,\r\n                        row_number() over (partition by application_id order by UPDATED_TIMESTAMP DESC) rn\r\n                from {{ source('df_2','bpm_application_data') }} ci\r\n                where 1=1\r\n                                                     AND ci.type = 'APPROVAL'\r\n                                                     and lower(key) = 'collateral'\r\n                                                     ),\r\n     TSDB as (select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\r\n    from {{ source('df_2','jstb_3') }} a),\r\n\r\nsrc as\r\n(\r\nSELECT\r\n    app.id                                                                                                                                                                                                                                                                                                        AS\r\n    app_id,\r\n   (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00',  app.finished_date )))  at time zone 'Asia/Ho_Chi_Minh' AS approved_date,\r\n    app.app_status_desc,\r\n    dc.type_desc                                                                                                                                                                                                                                                                                                  AS\r\n    decision,\r\n    case when app.app_status_desc = '\u0110\u00f3ng h\u1ed3 s\u01a1' then app.reason_cancel_desc\r\n    else    dc.tag_desc\r\n    end as reject_reason,\r\n    coalesce(cast(hook_short_limit.shortLoanLimitVal as double), cast(combo_hook1_short_limit.shortLoanLimitVal  as double) + cast(combo_hook2_short_limit.shortLoanLimitVal  as double))             AS\r\n    han_muc_cho_vay_ngan_han,\r\n    0 han_muc_cho_vay_trung_han,\r\n    0 han_muc_cho_vay_dai_han,\r\n    coalesce(cast(hook_lc.releaseLimitVal as double), cast(combo_hook1_lc.releaseLimitVal as double) + cast(combo_hook2_lc.releaseLimitVal as double)) AS han_muc_lc,\r\n    coalesce(cast(hook_payment_guarantee.paymentGuaranteeVal as double), cast(combo_hook1_payment_guarantee.paymentGuaranteeVal as double) + cast(combo_hook2_payment_guarantee.paymentGuaranteeVal as double)) AS han_muc_cho_bao_lanh,\r\n    coalesce(cast(hook_credit_Card.creditCardVal as double),\r\n    \t\t cast(combo_hook1_credit_Card.creditCardVal as double) + cast(combo_hook2_credit_Card.creditCardVal as double)) AS han_muc_the_tin_dung,\r\n    coalesce(cast(hook_overdraft.overdraftVal as double),\r\n    \t\t cast(combo_hook1_overdraft.overdraftVal as double) +  cast(combo_hook2_overdraft.overdraftVal as double)) AS han_muc_thau_chi,\r\n    CASE\r\n        WHEN opp.solution_package IN ( '2', '1', '3' ) THEN\r\n            coalesce(cast(hook_total_limit.totalLimitVal as double), cast(hook_limit.hookVal  as double))\r\n        WHEN opp.solution_package = '1,2' THEN\r\n            cast(combo_hook1_total_limit.totalLimitVal as double) + cast(combo_hook2_total_limit.totalLimitVal as double)\r\n    END                                                                                                                                                                                                                                                                                                           AS\r\n    total_limit\r\n    ,12 AS hieu_luc_han_muc\r\n    ,'HubHead' as cap_pd\r\n    ,case when revenueRoutingRequirement.revenueroutingrequirement = 'null' THEN NULL\r\n    when  cast(regexp_extract(revenueRoutingRequirement.revenueroutingrequirement,'[^\"\"\"\"]+') as double) < 1e6 then cast(regexp_extract(revenueRoutingRequirement.revenueroutingrequirement,'[^\"\"\"\"]+') as double) *1e6\r\n    else cast(regexp_extract(revenueRoutingRequirement.revenueroutingrequirement,'[^\"\"\"\"]+') as double)\r\n    END AS ckdt,\r\n     regexp_extract(id_css.cssId,'[\\d]+')  id_css,\r\n    regexp_extract(id_css.rating,'[^\"\"\"\"]+')  grade_t,\r\n  --  (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', date_parse(regexp_extract(tat.tat,'[\\d\\-\\: ]+'), '%d-%m-%Y %H:%i:%s'))))  at time zone 'Asia/Ho_Chi_Minh' tat,\r\n    date_parse(regexp_extract(tat.tat,'[\\d\\-\\: ]+'), '%d-%m-%Y %H:%i:%s') at time zone 'Asia/Ho_Chi_Minh' tat,\r\n --   (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', app.start_tat_date   )))  at time zone 'Asia/Ho_Chi_Minh'  tat_start_date,\r\n     app.start_tat_date at time zone 'Asia/Ho_Chi_Minh'  tat_start_date,\r\n    cast( regexp_extract(tsdb.valuation,'[\\d]+') as bigint) tsdb,\r\n    regexp_extract(tsdb.type,'[^\"\"\"\"]+') type_tsdb,\r\n    cast(regexp_extract(tsdb.ltv,'[^\"\"\"\"]+') as double) ltv,\r\n        opp.application_purpose_desc,\r\n    CASE\r\n        WHEN opp.solution_package = '2'   THEN\r\n            'Hook2'\r\n        WHEN opp.solution_package = '1'   THEN\r\n            'Hook1'\r\n        WHEN opp.solution_package = '3'   THEN\r\n            'Hook MSME'\r\n        WHEN opp.solution_package = '1,2' THEN\r\n            'Combo'\r\n    END                                                                                                                                                                                                                                                                                                           AS\r\n    product,\r\n    opp.loan_type_desc\r\nFROM\r\n    oracle_bulanding.df_2.bpm_application   app\r\n    LEFT JOIN bpm_branch_mapping  bm ON app.branch_id = bm.branch_id and bm.rn =1\r\n    LEFT JOIN bpm_opportunity opp ON app.opportunity_id = opp.id and opp.rn = 1\r\n    LEFT JOIN bpm_application_history  dc ON app.id = dc.application_id\r\n    LEFT JOIN ad ON ad.application_id = app.id AND AD.RN = 1\r\n    left join hook_limit on ad.id = hook_limit.key_row_id and hook_limit.rn = 1\r\n    left join hook_total_limit on ad.id = hook_total_limit.key_row_id  and hook_total_limit.rn = 1\r\n    left join combo_hook1_total_limit on ad.id = combo_hook1_total_limit.key_row_id and combo_hook1_total_limit.rn = 1\r\n    left join combo_hook2_total_limit on ad.id = combo_hook2_total_limit.key_row_id and combo_hook2_total_limit.rn = 1\r\n    left join id_css on ad.id = id_css.key_row_id and id_css.rn = 1\r\n    left join hook_overdraft on ad.id = hook_overdraft.key_row_id and hook_overdraft.rn = 1\r\n    left join combo_hook1_overdraft on ad.id = combo_hook1_overdraft.key_row_id and combo_hook1_overdraft.rn = 1\r\n    left join combo_hook2_overdraft on ad.id = combo_hook2_overdraft.key_row_id and combo_hook2_overdraft.rn = 1\r\n    left join hook_credit_Card on ad.id = hook_credit_Card.key_row_id and hook_credit_Card.rn =1\r\n    left join combo_hook1_credit_Card on ad.id = combo_hook1_credit_Card.key_row_id and combo_hook1_credit_Card.rn = 1\r\n    left join combo_hook2_credit_Card on ad.id = combo_hook2_credit_Card.key_row_id and combo_hook2_credit_Card.rn = 1\r\n    left join hook_short_limit on ad.id = hook_short_limit.key_row_id and hook_short_limit.rn  =1\r\n    left join combo_hook1_short_limit on ad.id = combo_hook1_short_limit.key_row_id and combo_hook1_short_limit.rn = 1\r\n    left join combo_hook2_short_limit on ad.id = combo_hook2_short_limit.key_row_id and combo_hook2_short_limit.rn = 1\r\n    left join hook_payment_guarantee on ad.id = hook_payment_guarantee.key_row_id and hook_payment_guarantee.rn = 1\r\n    left join combo_hook1_payment_guarantee on ad.id = combo_hook1_payment_guarantee.key_row_id and combo_hook1_payment_guarantee.rn = 1\r\n    left join combo_hook2_payment_guarantee on ad.id = combo_hook2_payment_guarantee.key_row_id and combo_hook2_payment_guarantee.rn = 1\r\n    left join hook_LC on ad.id = hook_LC.key_row_id and hook_LC.rn = 1\r\n    left join combo_hook1_LC on ad.id = combo_hook1_LC.key_row_id and combo_hook1_LC.rn = 1\r\n    left join combo_hook2_LC on ad.id = combo_hook2_LC.key_row_id and combo_hook2_LC.rn = 1\r\n\tLEFT JOIN ckdt ON ckdt.application_id = app.id and ckdt.rn =1\r\n    left join tat on app.id = tat.key_row_id and tat.rn = 1\r\n    left join revenueRoutingRequirement on ckdt.id =  revenueRoutingRequirement.key_row_id  and revenueRoutingRequirement.rn = 1\r\n    LEFT JOIN ci ON ci.application_id = app.id and ci.rn = 1\r\n    left join ti on ci.application_id = ti.application_id and TI.RN = 1\r\n    left join TSDB on ti.id = TSDB.key_row_id and TSDB.rn = 1\r\nWHERE\r\n    APP.APP_STATUS = 'PD-42'\r\n    or app.APP_STATUS_DESC = '\u0110\u00f3ng h\u1ed3 s\u01a1'\r\n)\r\n\r\nSELECT a.* FROM SRC a\r\nwhere ltv is not null", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_thamdinh\\fact_bpm__loan_application_decision.sql", "original_file_path": "models\\mart\\bpm_thamdinh\\fact_bpm__loan_application_decision.sql", "name": "fact_bpm__loan_application_decision", "alias": "fact_bpm__loan_application_decision", "checksum": {"name": "sha256", "checksum": "69a851e9dad7bf618b1c04d7c4fc81b8444b787f59e9613f1d737e406231b610"}, "tags": ["bpm_df"], "refs": [], "sources": [["df_2", "jstb_184"], ["df_2", "jstb_145"], ["df_2", "bpm_application_history_detail"], ["df_2", "jstb_3"], ["df_2", "jstb_183"], ["df_2", "jstb_147"], ["df_2", "bpm_opportunity"], ["df_2", "jstb_110"], ["df_2", "jstb_118"], ["df_2", "jstb_171"], ["df_2", "jstb_155"], ["df_2", "jstb_188"], ["df_2", "jstb_159"], ["df_2", "jstb_20363"], ["df_2", "jstb_154"], ["df_2", "jstb_174"], ["df_2", "jstb_240"], ["df_2", "jstb_189"], ["df_2", "jstb_135"], ["df_2", "jstb_122"], ["df_2", "jstb_123"], ["df_2", "bpm_application_history"], ["df_2", "jstb_143"], ["df_2", "jstb_152"], ["df_2", "bpm_branch_mapping"], ["df_2", "jstb_111"], ["df_2", "jstb_153"], ["df_2", "bpm_application_data"]], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "tat", "owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_thamdinh\\fact_bpm__loan_application_decision.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "tags": ["bpm_df"], "meta": {"date_column": "tat", "owner": "thaidv3"}, "materialized": "table"}, "created_at": 1685959752.7889466, "compiled_code": "\nwith\nbpm_branch_mapping as\n(select bm.*, row_number() over (partition by branch_id order by etl_Date desc) rn\n                from oracle_bulanding.df_2.bpm_branch_mapping bm),\nbpm_opportunity as\n(select opp.*, row_number() over (partition by id order by etl_Date desc) rn\n                from oracle_bulanding.df_2.bpm_opportunity opp),\nbpm_application_history as\n(\n        SELECT\n            application_id,\n            type_desc,\n            tag_desc\n        FROM\n                 oracle_bulanding.df_2.bpm_application_history_detail ahd\n            JOIN oracle_bulanding.df_2.bpm_application_history ah ON ahd.application_history_id = ah.id\n        WHERE\n            ah.step = 'PD-42' ),\nad as\n(select ad.*,\n                    row_number() over (partition by application_id order by UPDATED_TIMESTAMP DESC) RN\n               from oracle_bulanding.df_2.bpm_application_data ad\n                where 1=1\n                 AND ad.type = 'APPROVAL'\n                 AND ad.key = 'suggestedLimit'\n\n                ),\n\nhook_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_110 a) ,\n\nhook_total_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_123 a) ,\n\ncombo_hook1_total_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_153 a),\n\ncombo_hook2_total_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_155 a),\nid_css as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_111 a),\nhook_overdraft as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_118 a),\ncombo_hook1_overdraft as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_143 a),\ncombo_hook2_overdraft as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_145 a),\nhook_credit_Card as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_122 a),\ncombo_hook1_credit_Card as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_152 a),\ncombo_hook2_credit_Card as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_154 a),\nhook_short_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_147 a),\ncombo_hook1_short_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_183 a),\ncombo_hook2_short_limit as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_184 a),\nhook_payment_guarantee as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_159 a),\ncombo_hook1_payment_guarantee as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_188 a),\ncombo_hook2_payment_guarantee as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_189 a),\nhook_LC as\n(select a.* , row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_135 a),\ncombo_hook1_LC as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_171 a),\ncombo_hook2_LC as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_174 a),\nckdt as\n(select ckdt.*,\n                row_number() over (partition by application_id order by ETL_DATE DESC) rn\n                from oracle_bulanding.df_2.bpm_application_data ckdt\n                where 1=1\n                                                       AND ckdt.type = 'APPROVAL'\n                                                       AND ckdt.key = 'creditRequirements'\n                                                       ),\ntat as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_20363 a),\nrevenueRoutingRequirement as\n(select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n                from oracle_bulanding.df_2.jstb_240 a),\nci as\n(select ci.*, row_number() over (partition by application_id order by ETL_DATE DESC) rn\n                from oracle_bulanding.df_2.bpm_application_data ci\n                where 1=1\n                                                     AND ci.type = 'PROPOSAL'\n                                                     AND ci.key = 'customerInfo'\n                                                     ),\n    ti as\n    (select ci.*,\n                        row_number() over (partition by application_id order by UPDATED_TIMESTAMP DESC) rn\n                from oracle_bulanding.df_2.bpm_application_data ci\n                where 1=1\n                                                     AND ci.type = 'APPROVAL'\n                                                     and lower(key) = 'collateral'\n                                                     ),\n     TSDB as (select a.*, row_number() over (partition by key_row_id order by ETL_dATE DESC) rn\n    from oracle_bulanding.df_2.jstb_3 a),\n\nsrc as\n(\nSELECT\n    app.id                                                                                                                                                                                                                                                                                                        AS\n    app_id,\n   (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00',  app.finished_date )))  at time zone 'Asia/Ho_Chi_Minh' AS approved_date,\n    app.app_status_desc,\n    dc.type_desc                                                                                                                                                                                                                                                                                                  AS\n    decision,\n    case when app.app_status_desc = '\u0110\u00f3ng h\u1ed3 s\u01a1' then app.reason_cancel_desc\n    else    dc.tag_desc\n    end as reject_reason,\n    coalesce(cast(hook_short_limit.shortLoanLimitVal as double), cast(combo_hook1_short_limit.shortLoanLimitVal  as double) + cast(combo_hook2_short_limit.shortLoanLimitVal  as double))             AS\n    han_muc_cho_vay_ngan_han,\n    0 han_muc_cho_vay_trung_han,\n    0 han_muc_cho_vay_dai_han,\n    coalesce(cast(hook_lc.releaseLimitVal as double), cast(combo_hook1_lc.releaseLimitVal as double) + cast(combo_hook2_lc.releaseLimitVal as double)) AS han_muc_lc,\n    coalesce(cast(hook_payment_guarantee.paymentGuaranteeVal as double), cast(combo_hook1_payment_guarantee.paymentGuaranteeVal as double) + cast(combo_hook2_payment_guarantee.paymentGuaranteeVal as double)) AS han_muc_cho_bao_lanh,\n    coalesce(cast(hook_credit_Card.creditCardVal as double),\n    \t\t cast(combo_hook1_credit_Card.creditCardVal as double) + cast(combo_hook2_credit_Card.creditCardVal as double)) AS han_muc_the_tin_dung,\n    coalesce(cast(hook_overdraft.overdraftVal as double),\n    \t\t cast(combo_hook1_overdraft.overdraftVal as double) +  cast(combo_hook2_overdraft.overdraftVal as double)) AS han_muc_thau_chi,\n    CASE\n        WHEN opp.solution_package IN ( '2', '1', '3' ) THEN\n            coalesce(cast(hook_total_limit.totalLimitVal as double), cast(hook_limit.hookVal  as double))\n        WHEN opp.solution_package = '1,2' THEN\n            cast(combo_hook1_total_limit.totalLimitVal as double) + cast(combo_hook2_total_limit.totalLimitVal as double)\n    END                                                                                                                                                                                                                                                                                                           AS\n    total_limit\n    ,12 AS hieu_luc_han_muc\n    ,'HubHead' as cap_pd\n    ,case when revenueRoutingRequirement.revenueroutingrequirement = 'null' THEN NULL\n    when  cast(regexp_extract(revenueRoutingRequirement.revenueroutingrequirement,'[^\"\"\"\"]+') as double) < 1e6 then cast(regexp_extract(revenueRoutingRequirement.revenueroutingrequirement,'[^\"\"\"\"]+') as double) *1e6\n    else cast(regexp_extract(revenueRoutingRequirement.revenueroutingrequirement,'[^\"\"\"\"]+') as double)\n    END AS ckdt,\n     regexp_extract(id_css.cssId,'[\\d]+')  id_css,\n    regexp_extract(id_css.rating,'[^\"\"\"\"]+')  grade_t,\n  --  (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', date_parse(regexp_extract(tat.tat,'[\\d\\-\\: ]+'), '%d-%m-%Y %H:%i:%s'))))  at time zone 'Asia/Ho_Chi_Minh' tat,\n    date_parse(regexp_extract(tat.tat,'[\\d\\-\\: ]+'), '%d-%m-%Y %H:%i:%s') at time zone 'Asia/Ho_Chi_Minh' tat,\n --   (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', app.start_tat_date   )))  at time zone 'Asia/Ho_Chi_Minh'  tat_start_date,\n     app.start_tat_date at time zone 'Asia/Ho_Chi_Minh'  tat_start_date,\n    cast( regexp_extract(tsdb.valuation,'[\\d]+') as bigint) tsdb,\n    regexp_extract(tsdb.type,'[^\"\"\"\"]+') type_tsdb,\n    cast(regexp_extract(tsdb.ltv,'[^\"\"\"\"]+') as double) ltv,\n        opp.application_purpose_desc,\n    CASE\n        WHEN opp.solution_package = '2'   THEN\n            'Hook2'\n        WHEN opp.solution_package = '1'   THEN\n            'Hook1'\n        WHEN opp.solution_package = '3'   THEN\n            'Hook MSME'\n        WHEN opp.solution_package = '1,2' THEN\n            'Combo'\n    END                                                                                                                                                                                                                                                                                                           AS\n    product,\n    opp.loan_type_desc\nFROM\n    oracle_bulanding.df_2.bpm_application   app\n    LEFT JOIN bpm_branch_mapping  bm ON app.branch_id = bm.branch_id and bm.rn =1\n    LEFT JOIN bpm_opportunity opp ON app.opportunity_id = opp.id and opp.rn = 1\n    LEFT JOIN bpm_application_history  dc ON app.id = dc.application_id\n    LEFT JOIN ad ON ad.application_id = app.id AND AD.RN = 1\n    left join hook_limit on ad.id = hook_limit.key_row_id and hook_limit.rn = 1\n    left join hook_total_limit on ad.id = hook_total_limit.key_row_id  and hook_total_limit.rn = 1\n    left join combo_hook1_total_limit on ad.id = combo_hook1_total_limit.key_row_id and combo_hook1_total_limit.rn = 1\n    left join combo_hook2_total_limit on ad.id = combo_hook2_total_limit.key_row_id and combo_hook2_total_limit.rn = 1\n    left join id_css on ad.id = id_css.key_row_id and id_css.rn = 1\n    left join hook_overdraft on ad.id = hook_overdraft.key_row_id and hook_overdraft.rn = 1\n    left join combo_hook1_overdraft on ad.id = combo_hook1_overdraft.key_row_id and combo_hook1_overdraft.rn = 1\n    left join combo_hook2_overdraft on ad.id = combo_hook2_overdraft.key_row_id and combo_hook2_overdraft.rn = 1\n    left join hook_credit_Card on ad.id = hook_credit_Card.key_row_id and hook_credit_Card.rn =1\n    left join combo_hook1_credit_Card on ad.id = combo_hook1_credit_Card.key_row_id and combo_hook1_credit_Card.rn = 1\n    left join combo_hook2_credit_Card on ad.id = combo_hook2_credit_Card.key_row_id and combo_hook2_credit_Card.rn = 1\n    left join hook_short_limit on ad.id = hook_short_limit.key_row_id and hook_short_limit.rn  =1\n    left join combo_hook1_short_limit on ad.id = combo_hook1_short_limit.key_row_id and combo_hook1_short_limit.rn = 1\n    left join combo_hook2_short_limit on ad.id = combo_hook2_short_limit.key_row_id and combo_hook2_short_limit.rn = 1\n    left join hook_payment_guarantee on ad.id = hook_payment_guarantee.key_row_id and hook_payment_guarantee.rn = 1\n    left join combo_hook1_payment_guarantee on ad.id = combo_hook1_payment_guarantee.key_row_id and combo_hook1_payment_guarantee.rn = 1\n    left join combo_hook2_payment_guarantee on ad.id = combo_hook2_payment_guarantee.key_row_id and combo_hook2_payment_guarantee.rn = 1\n    left join hook_LC on ad.id = hook_LC.key_row_id and hook_LC.rn = 1\n    left join combo_hook1_LC on ad.id = combo_hook1_LC.key_row_id and combo_hook1_LC.rn = 1\n    left join combo_hook2_LC on ad.id = combo_hook2_LC.key_row_id and combo_hook2_LC.rn = 1\n\tLEFT JOIN ckdt ON ckdt.application_id = app.id and ckdt.rn =1\n    left join tat on app.id = tat.key_row_id and tat.rn = 1\n    left join revenueRoutingRequirement on ckdt.id =  revenueRoutingRequirement.key_row_id  and revenueRoutingRequirement.rn = 1\n    LEFT JOIN ci ON ci.application_id = app.id and ci.rn = 1\n    left join ti on ci.application_id = ti.application_id and TI.RN = 1\n    left join TSDB on ti.id = TSDB.key_row_id and TSDB.rn = 1\nWHERE\n    APP.APP_STATUS = 'PD-42'\n    or app.APP_STATUS_DESC = '\u0110\u00f3ng h\u1ed3 s\u01a1'\n)\n\nSELECT a.* FROM SRC a\nwhere ltv is not null", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact_bpm__loan_application_decision"}, "model.dga_data_model.dim__atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["snapshot.dga_data_model.stg_mart__atm_dim", "snapshot.dga_data_model.stg_mart__atm_dim"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "atm_dim_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_vhkq", "dim__atm"], "unique_id": "model.dga_data_model.dim__atm", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'atm_dim_id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nwith dat_insert as (\r\n    SELECT\r\n        dbt_scd_id atm_dim_id,\r\n        atm_code,\r\n        series_number,\r\n        number_cycle_fund,\r\n        address,\r\n        group_atm,\r\n        status,\r\n        optimal_fund_limit,\r\n        regulation_fund_limit,\r\n        donvi_quanly,\r\n        kq_code,\r\n        distance_to_hub,\r\n        location_type,\r\n        tinh_thanh,\r\n        locality,\r\n        salary_date,\r\n        CASE\r\n            WHEN trunc(dbt_valid_from) = trunc(sysdate) THEN\r\n                trunc(sysdate - 1)\r\n            ELSE\r\n                trunc(dbt_valid_from)\r\n        END        eff_from_date,\r\n        CASE\r\n            WHEN dbt_valid_to IS NULL THEN\r\n                TO_DATE(29990101, 'yyyymmdd')\r\n            WHEN trunc(dbt_valid_to) = trunc(sysdate) THEN\r\n                trunc(sysdate - 1)\r\n            ELSE\r\n                trunc(dbt_valid_to)\r\n        END        eff_to_date,\r\n        unit_manage_info\r\n    FROM\r\n         {{ ref ( 'stg_mart__atm_dim' )}}\r\n    WHERE trunc(dbt_valid_from) = trunc(sysdate)\r\n)\r\n,dat_update as (\r\n    SELECT\r\n        dbt_scd_id atm_dim_id,\r\n        atm_code,\r\n        series_number,\r\n        number_cycle_fund,\r\n        address,\r\n        group_atm,\r\n        status,\r\n        optimal_fund_limit,\r\n        regulation_fund_limit,\r\n        donvi_quanly,\r\n        kq_code,\r\n        distance_to_hub,\r\n        location_type,\r\n        tinh_thanh,\r\n        locality,\r\n        salary_date,\r\n        CASE\r\n            WHEN trunc(dbt_valid_from) = trunc(sysdate) THEN\r\n                trunc(sysdate - 1)\r\n            ELSE\r\n                trunc(dbt_valid_from)\r\n        END        eff_from_date,\r\n        CASE\r\n            WHEN dbt_valid_to IS NULL THEN\r\n                TO_DATE(29990101, 'yyyymmdd')\r\n            WHEN trunc(dbt_valid_to) = trunc(sysdate) THEN\r\n                trunc(sysdate - 1)\r\n            ELSE\r\n                trunc(dbt_valid_to)\r\n        END        eff_to_date,\r\n        unit_manage_info\r\n    FROM\r\n        {{ ref ( 'stg_mart__atm_dim' )}}\r\n    WHERE trunc(dbt_valid_to) = trunc(sysdate)\r\n)\r\nselect *\r\nfrom dat_insert\r\nunion\r\nselect *\r\nfrom dat_update", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_vhkq\\dim__atm.sql", "original_file_path": "models\\mart\\bpm_vhkq\\dim__atm.sql", "name": "dim__atm", "alias": "dim__atm", "checksum": {"name": "sha256", "checksum": "3522135f3815e35fe22c47104f2a69912882be8a8a2bf936db5901a2ceba73fd"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_mart__atm_dim"], ["stg_mart__atm_dim"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_vhkq\\mart_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_vhkq\\dim__atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "incremental", "unique_key": "atm_dim_id", "incremental_strategy": "merge"}, "created_at": 1685959752.797978, "compiled_code": "\nwith dat_insert as (\n    SELECT\n        dbt_scd_id atm_dim_id,\n        atm_code,\n        series_number,\n        number_cycle_fund,\n        address,\n        group_atm,\n        status,\n        optimal_fund_limit,\n        regulation_fund_limit,\n        donvi_quanly,\n        kq_code,\n        distance_to_hub,\n        location_type,\n        tinh_thanh,\n        locality,\n        salary_date,\n        CASE\n            WHEN trunc(dbt_valid_from) = trunc(sysdate) THEN\n                trunc(sysdate - 1)\n            ELSE\n                trunc(dbt_valid_from)\n        END        eff_from_date,\n        CASE\n            WHEN dbt_valid_to IS NULL THEN\n                TO_DATE(29990101, 'yyyymmdd')\n            WHEN trunc(dbt_valid_to) = trunc(sysdate) THEN\n                trunc(sysdate - 1)\n            ELSE\n                trunc(dbt_valid_to)\n        END        eff_to_date,\n        unit_manage_info\n    FROM\n         \"oracle_dgaworkzone\".staging.stg_mart__atm_dim\n    WHERE trunc(dbt_valid_from) = trunc(sysdate)\n)\n,dat_update as (\n    SELECT\n        dbt_scd_id atm_dim_id,\n        atm_code,\n        series_number,\n        number_cycle_fund,\n        address,\n        group_atm,\n        status,\n        optimal_fund_limit,\n        regulation_fund_limit,\n        donvi_quanly,\n        kq_code,\n        distance_to_hub,\n        location_type,\n        tinh_thanh,\n        locality,\n        salary_date,\n        CASE\n            WHEN trunc(dbt_valid_from) = trunc(sysdate) THEN\n                trunc(sysdate - 1)\n            ELSE\n                trunc(dbt_valid_from)\n        END        eff_from_date,\n        CASE\n            WHEN dbt_valid_to IS NULL THEN\n                TO_DATE(29990101, 'yyyymmdd')\n            WHEN trunc(dbt_valid_to) = trunc(sysdate) THEN\n                trunc(sysdate - 1)\n            ELSE\n                trunc(dbt_valid_to)\n        END        eff_to_date,\n        unit_manage_info\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_mart__atm_dim\n    WHERE trunc(dbt_valid_to) = trunc(sysdate)\n)\nselect *\nfrom dat_insert\nunion\nselect *\nfrom dat_update", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim__atm"}, "model.dga_data_model.dim__subbranch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["snapshot.dga_data_model.stg_mart__sub_branch"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": "merge", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "subbranch_dim_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_vhkq", "dim__subbranch"], "unique_id": "model.dga_data_model.dim__subbranch", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key = 'subbranch_dim_id',\r\n        incremental_strategy = 'merge'\r\n    )\r\n}}\r\nSELECT\r\n    dbt_scd_id                                          AS subbranch_dim_id,\r\n    line,\r\n    organization_code,\r\n    subbranch_id,\r\n    organization_name                                   AS subbranch_name,\r\n    warehouse_code,\r\n    fund_begin_day_usd,\r\n    fund_begin_day_vnd,\r\n    distance_organization_to_warehouse                  AS distance_subbranch_to_warehouse,\r\n    status,\r\n    truc_thuoc_cn_pgd,\r\n    warehouse_type,\r\n    CASE WHEN subbranch_id in ('37101','37103')\r\n            THEN RANK()\r\n                        OVER(PARTITION BY subbranch_id\r\n                             ORDER BY\r\n                                 warehouse_code desc, dbt_valid_from desc\r\n                        )\r\n        ELSE RANK()\r\n                    OVER(PARTITION BY subbranch_id\r\n                         ORDER BY\r\n                             warehouse_code, dbt_valid_from desc\r\n                    )\r\n    END rnk,\r\n    subbranch_type,\r\n    trunc(dbt_updated_at)                               AS updated_at,\r\n    trunc(dbt_valid_from)                               AS eff_from_date,\r\n    nvl(dbt_valid_to,TO_DATE(29990101, 'yyyymmdd'))     AS eff_to_date\r\nFROM\r\n    {{ ref ('stg_mart__sub_branch')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_vhkq\\dim__subbranch.sql", "original_file_path": "models\\mart\\bpm_vhkq\\dim__subbranch.sql", "name": "dim__subbranch", "alias": "dim__subbranch", "checksum": {"name": "sha256", "checksum": "f6ecf4ab336e79d50628b6d93d60da87b91f3d6060cad2c8485ca37f342b6818"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_mart__sub_branch"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_vhkq\\mart_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_vhkq\\dim__subbranch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "incremental", "unique_key": "subbranch_dim_id", "incremental_strategy": "merge"}, "created_at": 1685959752.799911, "compiled_code": "\nSELECT\n    dbt_scd_id                                          AS subbranch_dim_id,\n    line,\n    organization_code,\n    subbranch_id,\n    organization_name                                   AS subbranch_name,\n    warehouse_code,\n    fund_begin_day_usd,\n    fund_begin_day_vnd,\n    distance_organization_to_warehouse                  AS distance_subbranch_to_warehouse,\n    status,\n    truc_thuoc_cn_pgd,\n    warehouse_type,\n    CASE WHEN subbranch_id in ('37101','37103')\n            THEN RANK()\n                        OVER(PARTITION BY subbranch_id\n                             ORDER BY\n                                 warehouse_code desc, dbt_valid_from desc\n                        )\n        ELSE RANK()\n                    OVER(PARTITION BY subbranch_id\n                         ORDER BY\n                             warehouse_code, dbt_valid_from desc\n                    )\n    END rnk,\n    subbranch_type,\n    trunc(dbt_updated_at)                               AS updated_at,\n    trunc(dbt_valid_from)                               AS eff_from_date,\n    nvl(dbt_valid_to,TO_DATE(29990101, 'yyyymmdd'))     AS eff_to_date\nFROM\n    \"oracle_dgaworkzone\".staging.stg_mart__sub_branch", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim__subbranch"}, "model.dga_data_model.fact__atm_cash_in_cycle": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_atm__update_chu_ky", "model.dga_data_model.stg_atm__cashout_sum", "model.dga_data_model.stg_atm__update_chu_ky", "model.dga_data_model.stg_atm__cashout_sum"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["transaction_id"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_vhkq", "fact__atm_cash_in_cycle"], "unique_id": "model.dga_data_model.fact__atm_cash_in_cycle", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"transaction_id\"]\r\n  )\r\n}}\r\nWITH dat_prev AS (\r\n    SELECT\r\n        t1.*,\r\n        t2.report_date            AS cash_out_prev_date,\r\n        t2.transaction_amount     AS cash_out_prev_amount,\r\n        t2.min_transaction_amount AS prev_min_cash_out,\r\n        t2.max_transaction_amount AS prev_max_cash_out\r\n    FROM\r\n         {{ ref ('stg_atm__update_chu_ky')}} t1\r\n        LEFT JOIN {{ ref ('stg_atm__cashout_sum')}} t2 ON t2.report_date >= t1.cash_in_date_prev\r\n                                                     AND t2.report_date < t1.report_date\r\n                                                     AND t1.atm_dim_id = t2.atm_dim_id\r\n), dat_next AS (\r\n    SELECT\r\n        t1.*,\r\n        t3.report_date            AS cash_out_next_date,\r\n        t3.transaction_amount     AS cash_out_next_amount,\r\n        t3.min_transaction_amount AS min_cash_out,\r\n        t3.max_transaction_amount AS max_cash_out\r\n    FROM\r\n         {{ ref ('stg_atm__update_chu_ky')}} t1\r\n        LEFT JOIN {{ ref ('stg_atm__cashout_sum')}}   t3 ON t3.report_date >= t1.report_date\r\n                                                     AND t3.report_date < t1.cash_in_date_next_upd\r\n                                                     AND t1.atm_dim_id = t3.atm_dim_id\r\n), dat_prev_sum AS (\r\n    SELECT\r\n        report_date,\r\n        last_cash_in,\r\n        atm_dim_id,\r\n        transaction_id,\r\n        process_detail,\r\n        atm_code,\r\n        transaction_amount        AS cash_in_amount,\r\n        cash_in_amount_prev,\r\n        cash_in_amount_next,\r\n        chu_ky_prev               AS prev_cycle,\r\n        SUM(cash_out_prev_amount) AS prev_sum_cash_out,\r\n        MIN(prev_min_cash_out)    AS prev_min_cash_out,\r\n        MAX(prev_max_cash_out)    AS prev_max_cash_out\r\n    FROM\r\n        dat_prev\r\n    GROUP BY\r\n        report_date,\r\n        last_cash_in,\r\n        atm_dim_id,\r\n        transaction_id,\r\n        process_detail,\r\n        atm_code,\r\n        transaction_amount,\r\n        cash_in_amount_prev,\r\n        cash_in_amount_next,\r\n        chu_ky_prev\r\n), dat_next_sum AS (\r\n    SELECT\r\n        report_date,\r\n        last_cash_in,\r\n        atm_dim_id,\r\n        transaction_id,\r\n        atm_code,\r\n        transaction_amount        AS cash_in_amount,\r\n        cash_in_amount_prev,\r\n        cash_in_amount_next,\r\n        chu_ky_next               AS cycle,\r\n        SUM(cash_out_next_amount) AS sum_cash_out,\r\n        MIN(min_cash_out)         AS min_cash_out,\r\n        MAX(max_cash_out)         AS max_cash_out\r\n    FROM\r\n        dat_next\r\n    GROUP BY\r\n        report_date,\r\n        last_cash_in,\r\n        atm_dim_id,\r\n        transaction_id,\r\n        atm_code,\r\n        transaction_amount,\r\n        cash_in_amount_prev,\r\n        cash_in_amount_next,\r\n        chu_ky_next\r\n)\r\nSELECT\r\n    t1.*,\r\n    t2.prev_cycle,\r\n    t2.prev_sum_cash_out,\r\n    t2.prev_min_cash_out,\r\n    t2.prev_max_cash_out\r\nFROM\r\n    dat_next_sum t1\r\n    LEFT JOIN dat_prev_sum t2 ON t1.transaction_id = t2.transaction_id\r\nWHERE\r\n    1 = 1\r\n    AND t1.report_date >= sysdate - 30\r\nORDER BY\r\n    t1.atm_code,\r\n    t2.report_date", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_vhkq\\fact__atm_cash_in_cycle.sql", "original_file_path": "models\\mart\\bpm_vhkq\\fact__atm_cash_in_cycle.sql", "name": "fact__atm_cash_in_cycle", "alias": "fact__atm_cash_in_cycle", "checksum": {"name": "sha256", "checksum": "90e44405aad80b7b6204e6c9fda57823af8af28f8e15f928bd5dd8cd6c2beb04"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_atm__update_chu_ky"], ["stg_atm__cashout_sum"], ["stg_atm__update_chu_ky"], ["stg_atm__cashout_sum"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_vhkq\\mart_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_vhkq\\fact__atm_cash_in_cycle.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "incremental", "unique_key": ["transaction_id"]}, "created_at": 1685959752.8049893, "compiled_code": "\nWITH dat_prev AS (\n    SELECT\n        t1.*,\n        t2.report_date            AS cash_out_prev_date,\n        t2.transaction_amount     AS cash_out_prev_amount,\n        t2.min_transaction_amount AS prev_min_cash_out,\n        t2.max_transaction_amount AS prev_max_cash_out\n    FROM\n         \"oracle_dgaworkzone\".staging.stg_atm__update_chu_ky t1\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_atm__cashout_sum t2 ON t2.report_date >= t1.cash_in_date_prev\n                                                     AND t2.report_date < t1.report_date\n                                                     AND t1.atm_dim_id = t2.atm_dim_id\n), dat_next AS (\n    SELECT\n        t1.*,\n        t3.report_date            AS cash_out_next_date,\n        t3.transaction_amount     AS cash_out_next_amount,\n        t3.min_transaction_amount AS min_cash_out,\n        t3.max_transaction_amount AS max_cash_out\n    FROM\n         \"oracle_dgaworkzone\".staging.stg_atm__update_chu_ky t1\n        LEFT JOIN \"oracle_dgaworkzone\".staging.stg_atm__cashout_sum   t3 ON t3.report_date >= t1.report_date\n                                                     AND t3.report_date < t1.cash_in_date_next_upd\n                                                     AND t1.atm_dim_id = t3.atm_dim_id\n), dat_prev_sum AS (\n    SELECT\n        report_date,\n        last_cash_in,\n        atm_dim_id,\n        transaction_id,\n        process_detail,\n        atm_code,\n        transaction_amount        AS cash_in_amount,\n        cash_in_amount_prev,\n        cash_in_amount_next,\n        chu_ky_prev               AS prev_cycle,\n        SUM(cash_out_prev_amount) AS prev_sum_cash_out,\n        MIN(prev_min_cash_out)    AS prev_min_cash_out,\n        MAX(prev_max_cash_out)    AS prev_max_cash_out\n    FROM\n        dat_prev\n    GROUP BY\n        report_date,\n        last_cash_in,\n        atm_dim_id,\n        transaction_id,\n        process_detail,\n        atm_code,\n        transaction_amount,\n        cash_in_amount_prev,\n        cash_in_amount_next,\n        chu_ky_prev\n), dat_next_sum AS (\n    SELECT\n        report_date,\n        last_cash_in,\n        atm_dim_id,\n        transaction_id,\n        atm_code,\n        transaction_amount        AS cash_in_amount,\n        cash_in_amount_prev,\n        cash_in_amount_next,\n        chu_ky_next               AS cycle,\n        SUM(cash_out_next_amount) AS sum_cash_out,\n        MIN(min_cash_out)         AS min_cash_out,\n        MAX(max_cash_out)         AS max_cash_out\n    FROM\n        dat_next\n    GROUP BY\n        report_date,\n        last_cash_in,\n        atm_dim_id,\n        transaction_id,\n        atm_code,\n        transaction_amount,\n        cash_in_amount_prev,\n        cash_in_amount_next,\n        chu_ky_next\n)\nSELECT\n    t1.*,\n    t2.prev_cycle,\n    t2.prev_sum_cash_out,\n    t2.prev_min_cash_out,\n    t2.prev_max_cash_out\nFROM\n    dat_next_sum t1\n    LEFT JOIN dat_prev_sum t2 ON t1.transaction_id = t2.transaction_id\nWHERE\n    1 = 1\n    AND t1.report_date >= sysdate - 30\nORDER BY\n    t1.atm_code,\n    t2.report_date", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact__atm_cash_in_cycle"}, "model.dga_data_model.fact__atm_cost_performance": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.int__gl_bal", "model.dga_data_model.dim__atm", "model.dga_data_model.vision__ftp_term_rates", "model.dga_data_model.fact__atm_daily"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["report_date", "atm_dim_id"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_vhkq", "fact__atm_cost_performance"], "unique_id": "model.dga_data_model.fact__atm_cost_performance", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"report_date\", \"atm_dim_id\"]\r\n  )\r\n}}\r\nWITH\r\ndat_rate_max as (\r\n    SELECT\r\n        *\r\n    FROM\r\n        base.vision__ftp_term_rates\r\n    WHERE\r\n            ftp_rate_id = 'POOL9_REM_INTERBANK'\r\n        AND effective_date IN (\r\n            SELECT\r\n                MAX(effective_date) max_effective_date\r\n            FROM\r\n                base.vision__ftp_term_rates\r\n            WHERE\r\n                ftp_rate_id = 'POOL9_REM_INTERBANK'\r\n        )\r\n)\r\n,dat_tonquy AS (\r\n    SELECT\r\n        t1.etl_date,\r\n        t3.atm_dim_id,\r\n        t1.atm_id                           AS atm_code,\r\n        t1.currency,\r\n        t1.acy_dr_bal,\r\n        nvl(t2.ftp_curve,t4.ftp_curve)      AS ftp_curve,\r\n        ROUND(t1.acy_dr_bal * nvl(t2.ftp_curve,t4.ftp_curve) / (100*365) , 2) AS capital_cost\r\n    FROM\r\n            {{ ref ('int__gl_bal')}}  t1\r\n        JOIN {{ ref ('dim__atm')}}          t3 ON t1.atm_id = t3.atm_code\r\n                                 AND TO_DATE(t1.etl_date, 'yyyyddd') >= t3.eff_from_date\r\n                                 AND TO_DATE(etl_date, 'yyyyddd') < t3.eff_to_date\r\n        LEFT JOIN {{ ref ('vision__ftp_term_rates')}} t2 ON t1.etl_date = TO_NUMBER(to_char(t2.effective_date, 'yyyyddd'))\r\n                                          AND t2.ftp_rate_id = 'POOL9_REM_INTERBANK'\r\n        LEFT JOIN dat_rate_max t4 ON 1=1\r\n    WHERE\r\n            1 = 1\r\n        AND t1.etl_date > ( SELECT to_char(sysdate - 60,'yyyyddd') FROM dual)\r\n        AND t1.currency = 'VND'\r\n        AND t1.gl_code >= 110104001\r\n        AND t1.gl_code <= 110104999\r\n    ORDER BY\r\n        etl_date,\r\n        atm_id\r\n), dat_transform AS (\r\n    SELECT\r\n        report_date,\r\n        atm_dim_id,\r\n        atm_code,\r\n        SUM(number_km_update)           AS umber_km_update,\r\n        SUM(number_km_update * 18000)   AS logistics_cost\r\n    FROM\r\n        {{ref ('fact__atm_daily')}}\r\n    WHERE\r\n        process_detail <> 'Cash_out_from_customer'\r\n        AND report_date > (SELECT sysdate - 60 FROM dual)\r\n    GROUP BY\r\n        report_date,\r\n        atm_dim_id,\r\n        atm_code\r\n)\r\nSELECT\r\n    nvl(TO_DATE(t1.etl_date, 'yyyyddd'),\r\n        t2.report_date)               AS report_date,\r\n    nvl(t1.atm_dim_id, t2.atm_dim_id) AS atm_dim_id,\r\n    nvl(t1.atm_code, t2.atm_code)     AS atm_code,\r\n    t1.acy_dr_bal,\r\n    t1.capital_cost,\r\n    t2.logistics_cost,\r\n    CASE WHEN t1.acy_dr_bal < 0 THEN 1\r\n    ELSE 0\r\n    END HACH_TOAN_LOI\r\nFROM\r\n    dat_tonquy    t1\r\n    FULL OUTER JOIN dat_transform t2 ON TO_DATE(t1.etl_date, 'yyyyddd') = t2.report_date\r\n                                        AND t1.atm_dim_id = t2.atm_dim_id", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_vhkq\\fact__atm_cost_performance.sql", "original_file_path": "models\\mart\\bpm_vhkq\\fact__atm_cost_performance.sql", "name": "fact__atm_cost_performance", "alias": "fact__atm_cost_performance", "checksum": {"name": "sha256", "checksum": "1a063e6301bab7ebcbdc82847adce9470e21509991331ab31bebac09c1ab2485"}, "tags": ["vhkq_atm_daily"], "refs": [["int__gl_bal"], ["dim__atm"], ["vision__ftp_term_rates"], ["fact__atm_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_vhkq\\mart_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_vhkq\\fact__atm_cost_performance.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "incremental", "unique_key": ["report_date", "atm_dim_id"]}, "created_at": 1685959752.800986, "compiled_code": "\nWITH\ndat_rate_max as (\n    SELECT\n        *\n    FROM\n        base.vision__ftp_term_rates\n    WHERE\n            ftp_rate_id = 'POOL9_REM_INTERBANK'\n        AND effective_date IN (\n            SELECT\n                MAX(effective_date) max_effective_date\n            FROM\n                base.vision__ftp_term_rates\n            WHERE\n                ftp_rate_id = 'POOL9_REM_INTERBANK'\n        )\n)\n,dat_tonquy AS (\n    SELECT\n        t1.etl_date,\n        t3.atm_dim_id,\n        t1.atm_id                           AS atm_code,\n        t1.currency,\n        t1.acy_dr_bal,\n        nvl(t2.ftp_curve,t4.ftp_curve)      AS ftp_curve,\n        ROUND(t1.acy_dr_bal * nvl(t2.ftp_curve,t4.ftp_curve) / (100*365) , 2) AS capital_cost\n    FROM\n            \"oracle_dgaworkzone\".int.int__gl_bal  t1\n        JOIN \"oracle_dgaworkzone\".mart.dim__atm          t3 ON t1.atm_id = t3.atm_code\n                                 AND TO_DATE(t1.etl_date, 'yyyyddd') >= t3.eff_from_date\n                                 AND TO_DATE(etl_date, 'yyyyddd') < t3.eff_to_date\n        LEFT JOIN \"oracle_dgaworkzone\".base.vision__ftp_term_rates t2 ON t1.etl_date = TO_NUMBER(to_char(t2.effective_date, 'yyyyddd'))\n                                          AND t2.ftp_rate_id = 'POOL9_REM_INTERBANK'\n        LEFT JOIN dat_rate_max t4 ON 1=1\n    WHERE\n            1 = 1\n        AND t1.etl_date > ( SELECT to_char(sysdate - 60,'yyyyddd') FROM dual)\n        AND t1.currency = 'VND'\n        AND t1.gl_code >= 110104001\n        AND t1.gl_code <= 110104999\n    ORDER BY\n        etl_date,\n        atm_id\n), dat_transform AS (\n    SELECT\n        report_date,\n        atm_dim_id,\n        atm_code,\n        SUM(number_km_update)           AS umber_km_update,\n        SUM(number_km_update * 18000)   AS logistics_cost\n    FROM\n        \"oracle_dgaworkzone\".mart.fact__atm_daily\n    WHERE\n        process_detail <> 'Cash_out_from_customer'\n        AND report_date > (SELECT sysdate - 60 FROM dual)\n    GROUP BY\n        report_date,\n        atm_dim_id,\n        atm_code\n)\nSELECT\n    nvl(TO_DATE(t1.etl_date, 'yyyyddd'),\n        t2.report_date)               AS report_date,\n    nvl(t1.atm_dim_id, t2.atm_dim_id) AS atm_dim_id,\n    nvl(t1.atm_code, t2.atm_code)     AS atm_code,\n    t1.acy_dr_bal,\n    t1.capital_cost,\n    t2.logistics_cost,\n    CASE WHEN t1.acy_dr_bal < 0 THEN 1\n    ELSE 0\n    END HACH_TOAN_LOI\nFROM\n    dat_tonquy    t1\n    FULL OUTER JOIN dat_transform t2 ON TO_DATE(t1.etl_date, 'yyyyddd') = t2.report_date\n                                        AND t1.atm_dim_id = t2.atm_dim_id", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact__atm_cost_performance"}, "model.dga_data_model.fact__atm_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mart_vhkq__atm_cash_daily", "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus", "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus", "model.dga_data_model.dim__atm"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["transaction_date_time", "transaction_id", "process_detail", "atm_code"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "bpm_vhkq", "fact__atm_daily"], "unique_id": "model.dga_data_model.fact__atm_daily", "raw_code": "{{\r\n  config(\r\n    materialized = \"incremental\",\r\n    unique_key=[\"transaction_date_time\", \"transaction_id\", \"process_detail\", \"atm_code\"]\r\n  )\r\n}}\r\nwith dat as (\r\nSELECT\r\n    report_date,\r\n    transaction_date_time,\r\n    transaction_id,\r\n    process_detail,\r\n    reason_operate,\r\n    atm_code,\r\n    tuyen_atm_id,\r\n    transaction_amount,\r\n    so_bo_tien,\r\n    number_of_min_transfrom,\r\n    ttc_num_km_from,\r\n    ttc_num_km_to,\r\n    number_of_km_actual,\r\n    number_km_update,\r\n    NULL                            request_category,\r\n    report_date - cash_in_date_prev chu_ky_thuc_te,\r\n    total_fund_recovery,\r\n    total_fund_recovery_upd,\r\n    cash_in_transaction_id_prev,\r\n    cash_in_date_prev,\r\n    cash_in_amount_prev,\r\n    CASE\r\n        WHEN process_detail = 'Ki\u1ec3m qu\u1ef9' THEN\r\n            NULL\r\n        WHEN cash_in_amount_prev = 0     THEN\r\n            0\r\n        ELSE\r\n            round(total_fund_recovery_upd / cash_in_amount_prev, 4)\r\n    END                             ty_le_ton_quy,\r\n    transaction_error,\r\n    transaction_error_dim_id,\r\n    transaction_error_detail_lv2,\r\n    report_date                     posting_date\r\n    FROM {{ ref ('stg_mart_vhkq__atm_cash_daily')}}\r\n    UNION\r\n    SELECT\r\n        trunc(transaction_date)  report_date,\r\n        transaction_date         transaction_date_time,\r\n        id                       transaction_id,\r\n        'Cash_out_from_customer' process_detail,\r\n        NULL                     reason_operate,\r\n        am_id                    atm_code,\r\n        NULL                     tuyen_atm_id,\r\n        transaction_amount,\r\n        NULL                     so_bo_tien,\r\n        NULL                     number_of_min_transfrom,\r\n        NULL                     ttc_num_km_from,\r\n        NULL                     ttc_num_km_to,\r\n        NULL                     number_of_km_actual,\r\n        NULL                     number_km_update,\r\n        request_category,\r\n        NULL                     chu_ky_thuc_te,\r\n        NULL                     total_fund_recovery,\r\n        NULL                     total_fund_recovery_upd,\r\n        NULL                     cash_in_transaction_id_prev,\r\n        NULL                     cash_in_date_prev,\r\n        NULL                     cash_in_amount_prev,\r\n        NULL                     ty_le_ton_quy,\r\n        transaction_error,\r\n        transaction_error_dim_id,\r\n        NULL                     transaction_error_detail_lv2,\r\n        posting_date\r\n    FROM {{ ref ('stg_mart_vhkq__atm_cash_out_cus')}} t1\r\n    UNION\r\n    SELECT\r\n        trunc(transaction_date)  report_date,\r\n        transaction_date         transaction_date_time,\r\n        id                       transaction_id,\r\n        'Cash_out_from_customer' process_detail,\r\n        NULL                     reason_operate,\r\n        am_id                    atm_code,\r\n        NULL                     tuyen_atm_id,\r\n        transaction_amount,\r\n        NULL                     so_bo_tien,\r\n        NULL                     number_of_min_transfrom,\r\n        NULL                     ttc_num_km_from,\r\n        NULL                     ttc_num_km_to,\r\n        NULL                     number_of_km_actual,\r\n        NULL                     number_km_update,\r\n        request_category,\r\n        NULL                     chu_ky_thuc_te,\r\n        NULL                     total_fund_recovery,\r\n        NULL                     total_fund_recovery_upd,\r\n        NULL                     cash_in_transaction_id_prev,\r\n        NULL                     cash_in_date_prev,\r\n        NULL                     cash_in_amount_prev,\r\n        NULL                     ty_le_ton_quy,\r\n        transaction_error,\r\n        transaction_error_dim_id,\r\n        NULL                     transaction_error_detail_lv2,\r\n        posting_date\r\n    FROM {{ ref ('stg_mart_vhkq__atm_cash_out_cus_sus')}} t1\r\n)\r\nSELECT\r\n    dat.report_date,\r\n    dat.transaction_date_time,\r\n    CASE\r\n        WHEN TO_NUMBER(to_char(transaction_date_time, 'hh24miss')) BETWEEN 80000 AND 170000 THEN\r\n            'Trong gi\u1edd l\u00e0m vi\u1ec7c'\r\n        ELSE\r\n            'Ngo\u00e0i gi\u1edd l\u00e0m vi\u1ec7c'\r\n    END AS working_time,\r\n    dat_atm.atm_dim_id,\r\n    dat.transaction_id,\r\n    dat.process_detail,\r\n    dat.reason_operate,\r\n    dat.atm_code,\r\n    dat.tuyen_atm_id,\r\n    dat.transaction_amount,\r\n    dat.so_bo_tien,\r\n    dat.number_of_min_transfrom,\r\n    dat.ttc_num_km_from,\r\n    dat.ttc_num_km_to,\r\n    dat.number_of_km_actual,\r\n    dat.number_km_update,\r\n    dat.request_category,\r\n    dat.chu_ky_thuc_te,\r\n    dat.total_fund_recovery,\r\n    dat.total_fund_recovery_upd,\r\n    dat.cash_in_transaction_id_prev,\r\n    dat.cash_in_date_prev,\r\n    dat.cash_in_amount_prev,\r\n    dat.ty_le_ton_quy,\r\n    dat.transaction_error,\r\n    dat.transaction_error_dim_id,\r\n    dat.transaction_error_detail_lv2,\r\n    dat.posting_date\r\nFROM\r\n    dat\r\nLEFT JOIN {{ ref ('dim__atm')}} dat_atm ON dat.atm_code = dat_atm.atm_code\r\n                                        AND dat.report_date >= dat_atm.eff_from_date\r\n                                        AND dat.report_date < dat_atm.eff_to_date", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\bpm_vhkq\\fact__atm_daily.sql", "original_file_path": "models\\mart\\bpm_vhkq\\fact__atm_daily.sql", "name": "fact__atm_daily", "alias": "fact__atm_daily", "checksum": {"name": "sha256", "checksum": "5f8aadd37f70d93422ba7ea520069c602627cd6eaa4bae874f86102011961e7e"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_mart_vhkq__atm_cash_daily"], ["stg_mart_vhkq__atm_cash_out_cus"], ["stg_mart_vhkq__atm_cash_out_cus_sus"], ["dim__atm"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\bpm_vhkq\\mart_bpm_vhkq.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\bpm_vhkq\\fact__atm_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "incremental", "unique_key": ["transaction_date_time", "transaction_id", "process_detail", "atm_code"]}, "created_at": 1685959752.8029835, "compiled_code": "\nwith dat as (\nSELECT\n    report_date,\n    transaction_date_time,\n    transaction_id,\n    process_detail,\n    reason_operate,\n    atm_code,\n    tuyen_atm_id,\n    transaction_amount,\n    so_bo_tien,\n    number_of_min_transfrom,\n    ttc_num_km_from,\n    ttc_num_km_to,\n    number_of_km_actual,\n    number_km_update,\n    NULL                            request_category,\n    report_date - cash_in_date_prev chu_ky_thuc_te,\n    total_fund_recovery,\n    total_fund_recovery_upd,\n    cash_in_transaction_id_prev,\n    cash_in_date_prev,\n    cash_in_amount_prev,\n    CASE\n        WHEN process_detail = 'Ki\u1ec3m qu\u1ef9' THEN\n            NULL\n        WHEN cash_in_amount_prev = 0     THEN\n            0\n        ELSE\n            round(total_fund_recovery_upd / cash_in_amount_prev, 4)\n    END                             ty_le_ton_quy,\n    transaction_error,\n    transaction_error_dim_id,\n    transaction_error_detail_lv2,\n    report_date                     posting_date\n    FROM \"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm_cash_daily\n    UNION\n    SELECT\n        trunc(transaction_date)  report_date,\n        transaction_date         transaction_date_time,\n        id                       transaction_id,\n        'Cash_out_from_customer' process_detail,\n        NULL                     reason_operate,\n        am_id                    atm_code,\n        NULL                     tuyen_atm_id,\n        transaction_amount,\n        NULL                     so_bo_tien,\n        NULL                     number_of_min_transfrom,\n        NULL                     ttc_num_km_from,\n        NULL                     ttc_num_km_to,\n        NULL                     number_of_km_actual,\n        NULL                     number_km_update,\n        request_category,\n        NULL                     chu_ky_thuc_te,\n        NULL                     total_fund_recovery,\n        NULL                     total_fund_recovery_upd,\n        NULL                     cash_in_transaction_id_prev,\n        NULL                     cash_in_date_prev,\n        NULL                     cash_in_amount_prev,\n        NULL                     ty_le_ton_quy,\n        transaction_error,\n        transaction_error_dim_id,\n        NULL                     transaction_error_detail_lv2,\n        posting_date\n    FROM \"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm_cash_out_cus t1\n    UNION\n    SELECT\n        trunc(transaction_date)  report_date,\n        transaction_date         transaction_date_time,\n        id                       transaction_id,\n        'Cash_out_from_customer' process_detail,\n        NULL                     reason_operate,\n        am_id                    atm_code,\n        NULL                     tuyen_atm_id,\n        transaction_amount,\n        NULL                     so_bo_tien,\n        NULL                     number_of_min_transfrom,\n        NULL                     ttc_num_km_from,\n        NULL                     ttc_num_km_to,\n        NULL                     number_of_km_actual,\n        NULL                     number_km_update,\n        request_category,\n        NULL                     chu_ky_thuc_te,\n        NULL                     total_fund_recovery,\n        NULL                     total_fund_recovery_upd,\n        NULL                     cash_in_transaction_id_prev,\n        NULL                     cash_in_date_prev,\n        NULL                     cash_in_amount_prev,\n        NULL                     ty_le_ton_quy,\n        transaction_error,\n        transaction_error_dim_id,\n        NULL                     transaction_error_detail_lv2,\n        posting_date\n    FROM \"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm_cash_out_cus_sus t1\n)\nSELECT\n    dat.report_date,\n    dat.transaction_date_time,\n    CASE\n        WHEN TO_NUMBER(to_char(transaction_date_time, 'hh24miss')) BETWEEN 80000 AND 170000 THEN\n            'Trong gi\u1edd l\u00e0m vi\u1ec7c'\n        ELSE\n            'Ngo\u00e0i gi\u1edd l\u00e0m vi\u1ec7c'\n    END AS working_time,\n    dat_atm.atm_dim_id,\n    dat.transaction_id,\n    dat.process_detail,\n    dat.reason_operate,\n    dat.atm_code,\n    dat.tuyen_atm_id,\n    dat.transaction_amount,\n    dat.so_bo_tien,\n    dat.number_of_min_transfrom,\n    dat.ttc_num_km_from,\n    dat.ttc_num_km_to,\n    dat.number_of_km_actual,\n    dat.number_km_update,\n    dat.request_category,\n    dat.chu_ky_thuc_te,\n    dat.total_fund_recovery,\n    dat.total_fund_recovery_upd,\n    dat.cash_in_transaction_id_prev,\n    dat.cash_in_date_prev,\n    dat.cash_in_amount_prev,\n    dat.ty_le_ton_quy,\n    dat.transaction_error,\n    dat.transaction_error_dim_id,\n    dat.transaction_error_detail_lv2,\n    dat.posting_date\nFROM\n    dat\nLEFT JOIN \"oracle_dgaworkzone\".mart.dim__atm dat_atm ON dat.atm_code = dat_atm.atm_code\n                                        AND dat.report_date >= dat_atm.eff_from_date\n                                        AND dat.report_date < dat_atm.eff_to_date", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact__atm_daily"}, "model.dga_data_model.dim_cic__customer_info": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int_cic__customer_info"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "eff_fm_dt"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["merge_key"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || macic WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "cic", "dim_cic__customer_info"], "unique_id": "model.dga_data_model.dim_cic__customer_info", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key=['merge_key'],\r\n    post_hook=[\"UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || macic WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)\"]\r\n  )\r\n}}\r\nWITH using_clause AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('int_cic__customer_info')}}\r\n)\r\n, updates AS (\r\n  SELECT\r\n      0 AS is_cur_rec\r\n    , o.eff_fm_dt\r\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\r\n    , o.macic\r\n    , o.cif\r\n    , o.customer_name\r\n    , o.register_number\r\n    , o.other_register_number\r\n    , o.tax_code\r\n    , o.tax_code_final\r\n    , o.branch_code\r\n    , o.tong_giam_doc\r\n    , o.address\r\n    , o.note\r\n    , o.hash_key\r\n    , 1 || '_' || o.macic AS merge_key\r\n  FROM {{ this }} o\r\n  {% if is_incremental() %}\r\n  LEFT JOIN using_clause uc ON o.macic = uc.macic\r\n  WHERE\r\n    o.hash_key <> uc.hash_key\r\n    AND o.is_cur_rec = 1\r\n  {% endif %}\r\n)\r\n, inserts AS (\r\n  SELECT\r\n      1 AS is_cur_rec\r\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_fm_dt\r\n    , to_date('01-JAN-2999') AS eff_to_dt\r\n    , uc.macic\r\n    , uc.cif\r\n    , uc.customer_name\r\n    , uc.register_number\r\n    , uc.other_register_number\r\n    , uc.tax_code\r\n    , uc.tax_code_final\r\n    , uc.branch_code\r\n    , uc.tong_giam_doc\r\n    , uc.address\r\n    , uc.note\r\n    , uc.hash_key\r\n    , CAST(NULL AS varchar2(20)) AS merge_key\r\n  FROM using_clause uc\r\n  {% if is_incremental() %}\r\n  LEFT JOIN {{ this }} o ON\r\n    o.macic = uc.macic\r\n    AND o.is_cur_rec = 1\r\n  WHERE\r\n    o.macic IS NULL\r\n    OR o.hash_key <> uc.hash_key\r\n  {% endif %}\r\n)\r\nSELECT * FROM updates\r\nUNION\r\nSELECT * FROM inserts", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\cic\\dim_cic__customer_info.sql", "original_file_path": "models\\mart\\cic\\dim_cic__customer_info.sql", "name": "dim_cic__customer_info", "alias": "dim_cic__customer_info", "checksum": {"name": "sha256", "checksum": "cf1aa562842557db48ecc3f29027320fa7d02fd7f5285e947911b7eb9385d0b6"}, "tags": ["cic_daily"], "refs": [["int_cic__customer_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "eff_fm_dt"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\cic\\mart_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\cic\\dim_cic__customer_info.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "eff_fm_dt"}, "tags": "cic_daily", "materialized": "incremental", "unique_key": ["merge_key"], "post-hook": ["UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || macic WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)"]}, "created_at": 1685959752.8079815, "compiled_code": "\nWITH using_clause AS (\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".int.int_cic__customer_info\n)\n, updates AS (\n  SELECT\n      0 AS is_cur_rec\n    , o.eff_fm_dt\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\n    , o.macic\n    , o.cif\n    , o.customer_name\n    , o.register_number\n    , o.other_register_number\n    , o.tax_code\n    , o.tax_code_final\n    , o.branch_code\n    , o.tong_giam_doc\n    , o.address\n    , o.note\n    , o.hash_key\n    , 1 || '_' || o.macic AS merge_key\n  FROM \"oracle_dgaworkzone\".mart.dim_cic__customer_info o\n  \n  LEFT JOIN using_clause uc ON o.macic = uc.macic\n  WHERE\n    o.hash_key <> uc.hash_key\n    AND o.is_cur_rec = 1\n  \n)\n, inserts AS (\n  SELECT\n      1 AS is_cur_rec\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_fm_dt\n    , to_date('01-JAN-2999') AS eff_to_dt\n    , uc.macic\n    , uc.cif\n    , uc.customer_name\n    , uc.register_number\n    , uc.other_register_number\n    , uc.tax_code\n    , uc.tax_code_final\n    , uc.branch_code\n    , uc.tong_giam_doc\n    , uc.address\n    , uc.note\n    , uc.hash_key\n    , CAST(NULL AS varchar2(20)) AS merge_key\n  FROM using_clause uc\n  \n  LEFT JOIN \"oracle_dgaworkzone\".mart.dim_cic__customer_info o ON\n    o.macic = uc.macic\n    AND o.is_cur_rec = 1\n  WHERE\n    o.macic IS NULL\n    OR o.hash_key <> uc.hash_key\n  \n)\nSELECT * FROM updates\nUNION\nSELECT * FROM inserts", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim_cic__customer_info"}, "model.dga_data_model.dim_clos_application_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__corpapplicationdetails", "model.dga_data_model.los__corpappentitydetails", "model.dga_data_model.los__users", "model.dga_data_model.los__oscorpcustomerdetail"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["clos"], "meta": {"owner": "thaidv3", "date_column": "app_created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "clos", "dim_clos_application_detail"], "unique_id": "model.dga_data_model.dim_clos_application_detail", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\n\r\nwith dim_app as\r\n(\r\nSelect\r\nt2.corpappentitydetailsid id,\r\nt1.applnumber app_number,\r\nt3.loginid sale_user_name,\r\ncoalesce(\r\nfirst_value(case when t2.entitytype = 'Parent Group' then t2.entityid end) over(partition by t1.applnumber order by t2.corpappentitydetailsid),\r\n            t2.parentgroupid, t2.entityid) customer_group_id,\r\n    t2.entityid as customer_id,\r\n    t4.taxid customer_tax_code,\r\n    t2.entityname as customer_name,\r\n    t2.entitytype as customer_type,\r\n --t3.prirelmgrid as Primary_RelationShip_Manager_ID,\r\nt1.bodatecreated app_created_at,\r\nt1.bodatemodified last_modified_at,\r\nt1.applstartdate app_start_time,\r\nt1.appclosedate app_close_time,\r\n case\r\n    when t1.ApplDecisionStatus = 'A' then 'APPROVED'\r\n    when t1.AppLDecisionStatus = 'R' then 'RECOMMENDED'\r\n    when t1.ApplDecisionStatus = 'NR' then 'NOT RECOMMENDED'\r\n    when t1.ApplDecisionStatus = 'C' then 'CANCELLED'\r\n    when t1.ApplDecisionStatus = 'W' then 'WITHDRAWN'\r\n end as app_current_decision,\r\nt1.applicationstatus app_current_status,\r\nt1.applcomments app_comment,\r\nt1.appdecisiondate app_decision_date,\r\nt1.fullreviewdate full_review_time\r\nfrom {{ ref('los__corpapplicationdetails') }} t1\r\nleft join {{ ref('los__corpappentitydetails') }} t2 on t2.corpapplicationdetailsid = t1.corpapplicationdetailsid\r\nleft join {{ ref('los__users') }} t3 on t1.salesownerid = t3.personid\r\nleft join {{ ref('los__oscorpcustomerdetail') }} t4 on t4.cifid = t2.entityid\r\n)\r\nSelect * from dim_app", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\clos\\dim_clos_application_detail.sql", "original_file_path": "models\\mart\\clos\\dim_clos_application_detail.sql", "name": "dim_clos_application_detail", "alias": "dim_clos_application_detail", "checksum": {"name": "sha256", "checksum": "d3ac9c7a3a223fa8df4a67777cbf9f4c45b97c5abd755060526965d02634b219"}, "tags": ["clos"], "refs": [["los__corpapplicationdetails"], ["los__corpappentitydetails"], ["los__users"], ["los__oscorpcustomerdetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "app_created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\clos\\clos.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\clos\\dim_clos_application_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "app_created_at"}, "tags": "clos", "materialized": "table"}, "created_at": 1685959752.8129804, "compiled_code": "\n\nwith dim_app as\n(\nSelect\nt2.corpappentitydetailsid id,\nt1.applnumber app_number,\nt3.loginid sale_user_name,\ncoalesce(\nfirst_value(case when t2.entitytype = 'Parent Group' then t2.entityid end) over(partition by t1.applnumber order by t2.corpappentitydetailsid),\n            t2.parentgroupid, t2.entityid) customer_group_id,\n    t2.entityid as customer_id,\n    t4.taxid customer_tax_code,\n    t2.entityname as customer_name,\n    t2.entitytype as customer_type,\n --t3.prirelmgrid as Primary_RelationShip_Manager_ID,\nt1.bodatecreated app_created_at,\nt1.bodatemodified last_modified_at,\nt1.applstartdate app_start_time,\nt1.appclosedate app_close_time,\n case\n    when t1.ApplDecisionStatus = 'A' then 'APPROVED'\n    when t1.AppLDecisionStatus = 'R' then 'RECOMMENDED'\n    when t1.ApplDecisionStatus = 'NR' then 'NOT RECOMMENDED'\n    when t1.ApplDecisionStatus = 'C' then 'CANCELLED'\n    when t1.ApplDecisionStatus = 'W' then 'WITHDRAWN'\n end as app_current_decision,\nt1.applicationstatus app_current_status,\nt1.applcomments app_comment,\nt1.appdecisiondate app_decision_date,\nt1.fullreviewdate full_review_time\nfrom \"oracle_dgaworkzone\".base.los__corpapplicationdetails t1\nleft join \"oracle_dgaworkzone\".base.los__corpappentitydetails t2 on t2.corpapplicationdetailsid = t1.corpapplicationdetailsid\nleft join \"oracle_dgaworkzone\".base.los__users t3 on t1.salesownerid = t3.personid\nleft join \"oracle_dgaworkzone\".base.los__oscorpcustomerdetail t4 on t4.cifid = t2.entityid\n)\nSelect * from dim_app", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim_clos_application_detail"}, "model.dga_data_model.fact_clos_application_activities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_los__corpapplicationdetails", "model.dga_data_model.stg_los__useractiontray", "model.dga_data_model.dim_clos_application_detail", "model.dga_data_model.los__users", "model.dga_data_model.los__closroutingdetails", "model.dga_data_model.los__users", "model.dga_data_model.los__useractiontray", "model.dga_data_model.los__corpapplicationdetails", "model.dga_data_model.los__users"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["clos"], "meta": {"owner": "thaidv3", "date_column": "start_time"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "clos", "fact_clos_application_activities"], "unique_id": "model.dga_data_model.fact_clos_application_activities", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n  )\r\n}}\r\nwith\r\ncorpapplicationdetails as\r\n(\r\nselect t.*,\r\nrow_number() over (partition by corpapplicationdetailsid order by coalesce(bodatemodified, tmdate) desc ) app_date_ranking\r\nfrom {{ ref('stg_los__corpapplicationdetails') }}  t\r\n),\r\nuseractiontray as\r\n(\r\nselect t.*,\r\nrow_number() over (partition by useractiontrayid order by coalesce(bodatemodified, tmdate) desc ) tray_date_ranking\r\nfrom {{ ref('stg_los__useractiontray') }}  t\r\n),\r\ndim_corp_limit_application as\r\n(\r\nSELECT *\r\nFROM {{ ref('dim_clos_application_detail') }}\r\nwhere customer_group_id = customer_id or customer_type = 'Parent Group'\r\n),\r\ndecision as\r\n(\r\nSELECT corpapplicationdetailsid id\r\n, 'LOS' source\r\n, t1.applnumber as app_id\r\n, t2.useractiontrayid\r\n, applstartdate app_start_at\r\n, appclosedate app_close_at\r\n, applicationstatus app_status\r\n, appdecisiondate app_decision_at\r\n, t1.creditdecivaldate as credit_decision_validity_at\r\n, t1.fullreviewdate as complete_review_at\r\n, t1.corpapplicationdetailsid\r\n, coalesce(t1.bodatemodified, t2.bodatemodified, t1.tmdate) bodatemodified\r\n, case\r\n    when t1.ApplDecisionStatus = 'A' then 'APPROVED'\r\n    when t1.AppLDecisionStatus = 'R' then 'RECOMMENDED'\r\n    when t1.ApplDecisionStatus = 'NR' then 'NOT RECOMMENDED'\r\n    when t1.ApplDecisionStatus = 'C' then 'CANCELLED'\r\n    when t1.ApplDecisionStatus = 'W' then 'WITHDRAWN'\r\n end as app_decision\r\n, t2.stepid step_name\r\n, useractiontraytypeid\r\n, row_number() over (partition by corpapplicationdetailsid,stepid order by t1.bodatemodified desc) decision_order_desc\r\nFROM corpapplicationdetails t1\r\nleft join useractiontray t2 on t2.useractiontraytypeid = t1.corpapplicationdetailsid\r\n\t\t\t\t\t\t\tand t1.app_date_ranking = t2.tray_date_ranking\r\nleft join {{ ref('los__users') }} t3 on t1.salesownerid = t3.personid\r\n)\r\n\r\n,\r\n\r\nrouting as\r\n(\r\n\tselect closroutingdetailsid id\r\n\t, t1.useractiontrayid\r\n\t, t4.applnumber app_id\r\n\t, t2.loginid owner_user_name\r\n    , t5.loginid sale_user_name\r\n\t, t1.applcomments step_comment\r\n\t, t1.stepid step_name\r\n\t, cast(routingdate as timestamp(6)) start_time\r\n\t, lead(cast(routingdate as timestamp(6)), 1) over(partition by t1.useractiontrayid order by routingdate) end_time\r\n\t, row_number() over (partition by t1.useractiontrayid, t1.stepid order by routingdate  desc) step_ranking\r\n\t, row_number() over (partition by t1.useractiontrayid order by routingdate  desc) step_order_desc\r\n\t, row_number() over (partition by t1.useractiontrayid order by routingdate  asc) step_order_asc\r\n\tfrom  {{ ref('los__closroutingdetails') }}  t1\r\n    left join {{ ref('los__users') }}  t2 on t1.ownerid = t2.personid\r\n    left join (Select distinct useractiontrayid, useractiontraytypeid from {{ ref('los__useractiontray') }}  )  t3 on t1.useractiontrayid = t3.useractiontrayid\r\n    left join (Select distinct applnumber, corpapplicationdetailsid, appclosedate,salesownerid  from {{ ref('los__corpapplicationdetails') }} ) t4 on t3.useractiontraytypeid = t4.corpapplicationdetailsid\r\n    left join {{ ref('los__users') }} t5 on t4.salesownerid = t5.personid\r\n),\r\n\r\noutput as\r\n(\r\nselect\r\n  routing.id\r\n, dim_corp_limit_application.id limit_application_id\r\n--, routing.app_id\r\n--, routing.useractiontrayid step_tray_id\r\n--, decision.id decision_id\r\n, owner_user_name\r\n, routing.step_name\r\n, case when routing.step_name like 'DATACAPTURE%' then 'Tr\u00ecnh c\u1ea5p t\u00edn d\u1ee5ng'\r\n\t when routing.step_name like 'ATTACHCOLLAT%' then 'B\u1ed5 sung t\u00e0i s\u1ea3n'\r\n\t when routing.step_name like 'PACUSTCONSENT' then '\u0110\u00e0m ph\u00e1n KH sau PD'\r\n\t when routing.step_name like 'DISTRIBUTION' then '\u0110i\u1ec1u ph\u1ed1i th\u1ea9m \u0111\u1ecbnh'\r\n\t when routing.step_name like 'PALIMITDOC' then 'Ho\u00e0n thi\u1ec7n h\u1ed3 s\u01a1 m\u1edf h\u1ea1n m\u1ee9c'\r\n\t when routing.step_name like 'PACOMPLDOC%' then 'Ho\u00e0n thi\u1ec7n h\u1ed3 s\u01a1 sau PD'\r\n\t when routing.step_name like 'PABOOKLIMIT' then 'M\u1edf h\u1ea1n m\u1ee9c'\r\n\t when routing.step_name like 'CREDITDECISION%' then 'Ph\u00ea duy\u1ec7t'\r\n\t when routing.step_name like 'CREDITAPPRAISAL%' then 'T\u00e1i th\u1ea9m/Th\u1ea9m \u0111\u1ecbnh'\r\n\t when routing.step_name like 'PACOLLATBOOK' then 'T\u1ea1o TS\u0110B'\r\n\tend as step_desc\r\n, step_comment\r\n, REGEXP_SUBSTR(routing.step_name, '\\d+') phase\r\n, case when routing.step_name like 'DATACAPTURE%'\r\n\t\tor routing.step_name like 'ATTACHCOLLAT%'\r\n\t\tor routing.step_name like 'DISTRIBUTION'\r\n\t\tor routing.step_name like 'CREDITAPPRAISAL%'\r\n\t\tthen 'Pre - Approval'\r\n       when routing.step_name like 'PACUSTCONSENT'\r\n\t\tor routing.step_name like 'PACOMPLDOC%'\r\n\t\tor routing.step_name like 'PACOLLATBOOK'\r\n\t\tor routing.step_name like 'PALIMITDOC'\r\n\t\tor routing.step_name like 'PABOOKLIMIT'\r\n\t\tthen 'Post - Apporval'\r\n       when routing.step_name like 'CREDITDECISION%'\r\n\t\tthen 'Credit Decision'\r\n\t  end as phase_desc\r\n, app_decision as step_decision\r\n, app_status\r\n, app_decision_at step_decision_at\r\n, start_time\r\n, end_time\r\n, step_order_desc\r\n, step_order_asc\r\nfrom routing\r\nleft join decision on routing.useractiontrayid = decision.useractiontrayid\r\n\t--\t\t\t\tand date(decision.bodatemodified) = date(routing.start_time)\r\n\t\t\t\t\tand routing.step_name = decision.step_name\r\n\t\t\t\t\tand routing.step_ranking = decision.decision_order_desc\r\nleft join dim_corp_limit_application on dim_corp_limit_application.app_number = routing.app_id\r\n)\r\n\r\nSelect * from output\r\n{% if is_incremental() %}\r\n  where start_time > (select max(start_time) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\clos\\fact_clos_application_activities.sql", "original_file_path": "models\\mart\\clos\\fact_clos_application_activities.sql", "name": "fact_clos_application_activities", "alias": "fact_clos_application_activities", "checksum": {"name": "sha256", "checksum": "b0fbe8ab29654746bf657870705f9c868841e24c1c89e13b8a464ac0c0e8e2ac"}, "tags": ["clos"], "refs": [["stg_los__corpapplicationdetails"], ["stg_los__useractiontray"], ["dim_clos_application_detail"], ["los__users"], ["los__closroutingdetails"], ["los__users"], ["los__useractiontray"], ["los__corpapplicationdetails"], ["los__users"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "start_time"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\clos\\clos.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\clos\\fact_clos_application_activities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "start_time"}, "tags": "clos", "materialized": "incremental"}, "created_at": 1685959752.8099794, "compiled_code": "\nwith\ncorpapplicationdetails as\n(\nselect t.*,\nrow_number() over (partition by corpapplicationdetailsid order by coalesce(bodatemodified, tmdate) desc ) app_date_ranking\nfrom \"oracle_dgaworkzone\".staging.stg_los__corpapplicationdetails  t\n),\nuseractiontray as\n(\nselect t.*,\nrow_number() over (partition by useractiontrayid order by coalesce(bodatemodified, tmdate) desc ) tray_date_ranking\nfrom \"oracle_dgaworkzone\".staging.stg_los__useractiontray  t\n),\ndim_corp_limit_application as\n(\nSELECT *\nFROM \"oracle_dgaworkzone\".mart.dim_clos_application_detail\nwhere customer_group_id = customer_id or customer_type = 'Parent Group'\n),\ndecision as\n(\nSELECT corpapplicationdetailsid id\n, 'LOS' source\n, t1.applnumber as app_id\n, t2.useractiontrayid\n, applstartdate app_start_at\n, appclosedate app_close_at\n, applicationstatus app_status\n, appdecisiondate app_decision_at\n, t1.creditdecivaldate as credit_decision_validity_at\n, t1.fullreviewdate as complete_review_at\n, t1.corpapplicationdetailsid\n, coalesce(t1.bodatemodified, t2.bodatemodified, t1.tmdate) bodatemodified\n, case\n    when t1.ApplDecisionStatus = 'A' then 'APPROVED'\n    when t1.AppLDecisionStatus = 'R' then 'RECOMMENDED'\n    when t1.ApplDecisionStatus = 'NR' then 'NOT RECOMMENDED'\n    when t1.ApplDecisionStatus = 'C' then 'CANCELLED'\n    when t1.ApplDecisionStatus = 'W' then 'WITHDRAWN'\n end as app_decision\n, t2.stepid step_name\n, useractiontraytypeid\n, row_number() over (partition by corpapplicationdetailsid,stepid order by t1.bodatemodified desc) decision_order_desc\nFROM corpapplicationdetails t1\nleft join useractiontray t2 on t2.useractiontraytypeid = t1.corpapplicationdetailsid\n\t\t\t\t\t\t\tand t1.app_date_ranking = t2.tray_date_ranking\nleft join \"oracle_dgaworkzone\".base.los__users t3 on t1.salesownerid = t3.personid\n)\n\n,\n\nrouting as\n(\n\tselect closroutingdetailsid id\n\t, t1.useractiontrayid\n\t, t4.applnumber app_id\n\t, t2.loginid owner_user_name\n    , t5.loginid sale_user_name\n\t, t1.applcomments step_comment\n\t, t1.stepid step_name\n\t, cast(routingdate as timestamp(6)) start_time\n\t, lead(cast(routingdate as timestamp(6)), 1) over(partition by t1.useractiontrayid order by routingdate) end_time\n\t, row_number() over (partition by t1.useractiontrayid, t1.stepid order by routingdate  desc) step_ranking\n\t, row_number() over (partition by t1.useractiontrayid order by routingdate  desc) step_order_desc\n\t, row_number() over (partition by t1.useractiontrayid order by routingdate  asc) step_order_asc\n\tfrom  \"oracle_dgaworkzone\".base.los__closroutingdetails  t1\n    left join \"oracle_dgaworkzone\".base.los__users  t2 on t1.ownerid = t2.personid\n    left join (Select distinct useractiontrayid, useractiontraytypeid from \"oracle_dgaworkzone\".base.los__useractiontray  )  t3 on t1.useractiontrayid = t3.useractiontrayid\n    left join (Select distinct applnumber, corpapplicationdetailsid, appclosedate,salesownerid  from \"oracle_dgaworkzone\".base.los__corpapplicationdetails ) t4 on t3.useractiontraytypeid = t4.corpapplicationdetailsid\n    left join \"oracle_dgaworkzone\".base.los__users t5 on t4.salesownerid = t5.personid\n),\n\noutput as\n(\nselect\n  routing.id\n, dim_corp_limit_application.id limit_application_id\n--, routing.app_id\n--, routing.useractiontrayid step_tray_id\n--, decision.id decision_id\n, owner_user_name\n, routing.step_name\n, case when routing.step_name like 'DATACAPTURE%' then 'Tr\u00ecnh c\u1ea5p t\u00edn d\u1ee5ng'\n\t when routing.step_name like 'ATTACHCOLLAT%' then 'B\u1ed5 sung t\u00e0i s\u1ea3n'\n\t when routing.step_name like 'PACUSTCONSENT' then '\u0110\u00e0m ph\u00e1n KH sau PD'\n\t when routing.step_name like 'DISTRIBUTION' then '\u0110i\u1ec1u ph\u1ed1i th\u1ea9m \u0111\u1ecbnh'\n\t when routing.step_name like 'PALIMITDOC' then 'Ho\u00e0n thi\u1ec7n h\u1ed3 s\u01a1 m\u1edf h\u1ea1n m\u1ee9c'\n\t when routing.step_name like 'PACOMPLDOC%' then 'Ho\u00e0n thi\u1ec7n h\u1ed3 s\u01a1 sau PD'\n\t when routing.step_name like 'PABOOKLIMIT' then 'M\u1edf h\u1ea1n m\u1ee9c'\n\t when routing.step_name like 'CREDITDECISION%' then 'Ph\u00ea duy\u1ec7t'\n\t when routing.step_name like 'CREDITAPPRAISAL%' then 'T\u00e1i th\u1ea9m/Th\u1ea9m \u0111\u1ecbnh'\n\t when routing.step_name like 'PACOLLATBOOK' then 'T\u1ea1o TS\u0110B'\n\tend as step_desc\n, step_comment\n, REGEXP_SUBSTR(routing.step_name, '\\d+') phase\n, case when routing.step_name like 'DATACAPTURE%'\n\t\tor routing.step_name like 'ATTACHCOLLAT%'\n\t\tor routing.step_name like 'DISTRIBUTION'\n\t\tor routing.step_name like 'CREDITAPPRAISAL%'\n\t\tthen 'Pre - Approval'\n       when routing.step_name like 'PACUSTCONSENT'\n\t\tor routing.step_name like 'PACOMPLDOC%'\n\t\tor routing.step_name like 'PACOLLATBOOK'\n\t\tor routing.step_name like 'PALIMITDOC'\n\t\tor routing.step_name like 'PABOOKLIMIT'\n\t\tthen 'Post - Apporval'\n       when routing.step_name like 'CREDITDECISION%'\n\t\tthen 'Credit Decision'\n\t  end as phase_desc\n, app_decision as step_decision\n, app_status\n, app_decision_at step_decision_at\n, start_time\n, end_time\n, step_order_desc\n, step_order_asc\nfrom routing\nleft join decision on routing.useractiontrayid = decision.useractiontrayid\n\t--\t\t\t\tand date(decision.bodatemodified) = date(routing.start_time)\n\t\t\t\t\tand routing.step_name = decision.step_name\n\t\t\t\t\tand routing.step_ranking = decision.decision_order_desc\nleft join dim_corp_limit_application on dim_corp_limit_application.app_number = routing.app_id\n)\n\nSelect * from output\n\n  where start_time > (select max(start_time) from \"oracle_dgaworkzone\".mart.fact_clos_application_activities)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact_clos_application_activities"}, "model.dga_data_model.fact_clos_decision": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__corpapplicationdetails", "model.dga_data_model.los__users", "model.dga_data_model.los__corpappentitydetails", "model.dga_data_model.los__corpapplimitdetails"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["clos"], "meta": {"owner": "thaidv3", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "clos", "fact_clos_decision"], "unique_id": "model.dga_data_model.fact_clos_decision", "raw_code": "{{\r\n  config(\r\n    materialized = \"table\",\r\n  )\r\n}}\r\n\r\nwith\r\ndecision as\r\n(\r\nSELECT 'LOS' source\r\n, t6.corpappentitydetailsid limit_application_id\r\n, t1.applnumber as app_number\r\n--, t4.taxid tax_code\r\n,t6.customcreditapprovedlimit as approved_limit,\r\nt6.proposedlimit as proposed_limit,\r\nt6.approvedlimit as final_limit_amount,\r\nt6.existinglimit as existing_limt_existing_amt,\r\nt6.proposedlimit - t6.existinglimit as increase_decrease,\r\nt6.limitidsuffix as limit_id,\r\nt6.limitrefno as limit_ref_number,\r\nt6.parentlimitrefno as parent_limit_ref_number,\r\nt6.expirydate as limit_end_date,\r\nt6.availabilityenddate as availability_end_date,\r\nt6.availableperiodmonths as availableperiod_months,\r\nt6.availableperioddays as availableperiod_days\r\n--, t1.creditdecivaldate as credit_decision_validity_at\r\n--, t1.fullreviewdate as complete_review_at\r\n--, t2.applstartdate app_start_at\r\n--, t2.appclosedate app_close_at\r\n--, t2.applicationstatus app_status\r\n--, t2.appdecisiondate app_decision_at\r\n,t6.limitdecision\r\n,t6.limitclassification as limit_classification,\r\nt6.relationshiplevel as relationship_level,\r\nt6.effectivedate as effective_date,\r\nt6.officercode as office_code,\r\nt6.bodatecreated created_at\r\nFROM {{ ref('los__corpapplicationdetails') }} t1\r\nleft join {{ ref('los__users') }}  t3 on t1.salesownerid = t3.personid\r\nleft join {{ ref('los__corpappentitydetails') }}  t3 on t3.corpapplicationdetailsid = t1.corpapplicationdetailsid\r\n--join base.los__oscorpcustomerdetail t4 on t4.cifid = t3.entityid\r\nleft join {{ ref('los__corpapplimitdetails') }} t6 on t6.corpappentitydetailsid = t3.corpappentitydetailsid and t6.isdeleted != 'Y'\r\n\r\n)\r\n\r\nSelect  * from decision", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\clos\\fact_clos_decision.sql", "original_file_path": "models\\mart\\clos\\fact_clos_decision.sql", "name": "fact_clos_decision", "alias": "fact_clos_decision", "checksum": {"name": "sha256", "checksum": "2f4521e9475f3b4d4097d40192d2ec13b87cc7c01094975f041ec312a7bcd13c"}, "tags": ["clos"], "refs": [["los__corpapplicationdetails"], ["los__users"], ["los__corpappentitydetails"], ["los__corpapplimitdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\clos\\clos.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\clos\\fact_clos_decision.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "created_at"}, "tags": "clos", "materialized": "table"}, "created_at": 1685959752.8109787, "compiled_code": "\n\nwith\ndecision as\n(\nSELECT 'LOS' source\n, t6.corpappentitydetailsid limit_application_id\n, t1.applnumber as app_number\n--, t4.taxid tax_code\n,t6.customcreditapprovedlimit as approved_limit,\nt6.proposedlimit as proposed_limit,\nt6.approvedlimit as final_limit_amount,\nt6.existinglimit as existing_limt_existing_amt,\nt6.proposedlimit - t6.existinglimit as increase_decrease,\nt6.limitidsuffix as limit_id,\nt6.limitrefno as limit_ref_number,\nt6.parentlimitrefno as parent_limit_ref_number,\nt6.expirydate as limit_end_date,\nt6.availabilityenddate as availability_end_date,\nt6.availableperiodmonths as availableperiod_months,\nt6.availableperioddays as availableperiod_days\n--, t1.creditdecivaldate as credit_decision_validity_at\n--, t1.fullreviewdate as complete_review_at\n--, t2.applstartdate app_start_at\n--, t2.appclosedate app_close_at\n--, t2.applicationstatus app_status\n--, t2.appdecisiondate app_decision_at\n,t6.limitdecision\n,t6.limitclassification as limit_classification,\nt6.relationshiplevel as relationship_level,\nt6.effectivedate as effective_date,\nt6.officercode as office_code,\nt6.bodatecreated created_at\nFROM \"oracle_dgaworkzone\".base.los__corpapplicationdetails t1\nleft join \"oracle_dgaworkzone\".base.los__users  t3 on t1.salesownerid = t3.personid\nleft join \"oracle_dgaworkzone\".base.los__corpappentitydetails  t3 on t3.corpapplicationdetailsid = t1.corpapplicationdetailsid\n--join base.los__oscorpcustomerdetail t4 on t4.cifid = t3.entityid\nleft join \"oracle_dgaworkzone\".base.los__corpapplimitdetails t6 on t6.corpappentitydetailsid = t3.corpappentitydetailsid and t6.isdeleted != 'Y'\n\n)\n\nSelect  * from decision", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact_clos_decision"}, "model.dga_data_model.dim_cms__loan_application": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.df_2.cj3_staff", "source.dga_data_model.df_2.cj3_history_assign_lead", "source.dga_data_model.df_2.cj3_history_update_loan", "source.dga_data_model.df_2.bpm_branch_mapping", "source.dga_data_model.df_2.cj3_leads_info", "source.dga_data_model.df_2.cj3_loan_application", "source.dga_data_model.df_2.cj3_leads_activities", "source.dga_data_model.df_2.thuvh3_tax_code_test", "source.dga_data_model.df_2.cj3_file_upload_loan"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["cms_df"], "meta": {"owner": "thaidv3", "date_column": "created_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "cms", "dim_cms__loan_application"], "unique_id": "model.dga_data_model.dim_cms__loan_application", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH cj3_history_assign_lead AS (\r\n    SELECT\r\n        a.*,\r\n        ROW_NUMBER()\r\n        OVER(PARTITION BY a.business_id\r\n             ORDER BY\r\n                 a.created_at DESC\r\n        ) rn\r\n    FROM\r\n        {{ source('df_2','cj3_history_assign_lead') }} a\r\n), cj3_history_update_loan AS (\r\n    SELECT\r\n        loan_application_id,\r\n        MAX(created_at) AS submit_date\r\n    FROM\r\n        {{ source('df_2','cj3_history_update_loan') }}\r\n    WHERE\r\n            bpm_submit_status = 'SUCESS'\r\n        AND role_code = 'ROLE_RM'\r\n    GROUP BY\r\n        loan_application_id\r\n), cj3_staff AS (\r\n    SELECT\r\n        a.*,\r\n        ROW_NUMBER()\r\n        OVER(PARTITION BY user_name\r\n             ORDER BY\r\n                 user_name\r\n        ) rn\r\n    FROM\r\n        {{ source('df_2', 'cj3_staff') }} a\r\n), cj3_file_upload_loan AS (\r\n    SELECT\r\n        a.*,\r\n        ROW_NUMBER()\r\n        OVER(PARTITION BY loan_application_id\r\n             ORDER BY\r\n                 a.ekyc_status DESC, a.updated_at DESC\r\n        ) rn\r\n    FROM\r\n        {{ source('df_2', 'cj3_file_upload_loan') }} a\r\n    WHERE\r\n        ekyc_status IS NOT NULL\r\n), cte AS (\r\n    SELECT\r\n        cast(lo.loan_application_id as VARCHAR(400)) loan_application_id,\r\n        lo.lead_activities_id,\r\n        cast(lo.landing_page_id as VARCHAR(400)) landing_page_id,\r\n        (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', lo.created_at)))  at time zone 'Asia/Ho_Chi_Minh' created_date, ---- UTC + 7\r\n        cast(substr(lo.business_id, 1, 10) as VARCHAR(400))                                           taxcode,\r\n        cast(lo.business_id as VARCHAR(400)) business_id,\r\n        cast(lo.business_name as VARCHAR(400)) business_name,\r\n        cast(lo.business_type as VARCHAR(400)) business_type,\r\n        cast(lo.company_size as VARCHAR(400)) company_size,\r\n        cast(lo.company_type as VARCHAR(400)) company_type,\r\n        la.recent_revenue,\r\n        cast(lo.package_type as VARCHAR(400)) package_type,\r\n        lo.loan_package_id,\r\n\r\n        CASE\r\n            WHEN lo.loan_package_id IN ( 3, 4, 5 ) THEN\r\n                'Main'\r\n            WHEN lo.loan_package_id = 1\r\n                 AND lo.company_size = 'SME' THEN\r\n                'Hook2'\r\n            WHEN lo.loan_package_id IN (1,2)\r\n                 AND lo.company_size = 'M_SME' THEN\r\n                'M_SME Hook'\r\n            WHEN lo.loan_package_id = 2\r\n                 AND lo.company_size = 'SME' THEN\r\n                'Hook1'\r\n        END                                                                    AS product,\r\n        CASE\r\n            WHEN lo.loan_package_id IN ( 4, 5 ) THEN\r\n                'T\u00e1i c\u1ea5p'\r\n            ELSE\r\n                'C\u1ea5p m\u1edbi'\r\n        END                                                                    AS type_loan,\r\n        lo.submit_status,\r\n        lo.bpm_status,\r\n        cast(lo.bpm_profile_status as VARCHAR(400)) bpm_profile_status,\r\n        cast(lo.profile_status as VARCHAR(400)) profile_status,\r\n        CASE\r\n            WHEN lo.submit_status <> 1                      THEN\r\n                'Thu h\u1ed3 s\u01a1'\r\n            WHEN lo.profile_status = 'SUA_UPLOAD_HOSO'      THEN\r\n                'B\u1ed5 sung h\u1ed3 s\u01a1'\r\n            WHEN lo.profile_status IN ( 'NOP_DU', 'NOP_OFFLINE' ) THEN\r\n                'N\u1ed9p \u0111\u1ee7 h\u1ed3 s\u01a1'\r\n            WHEN lo.profile_status = 'HS_CHO_THAM_DINH'     THEN\r\n                'Ch\u1edd th\u1ea9m \u0111\u1ecbnh'\r\n            WHEN lo.profile_status = 'HS_CHO_PHE_DUYET'     THEN\r\n                'Ch\u1edd ph\u00ea duy\u1ec7t'\r\n            WHEN lo.profile_status = 'PHE_DUYET_THANH_CONG' THEN\r\n                '\u0110\u00e3 ph\u00ea duy\u1ec7t'\r\n            ELSE\r\n                NULL\r\n        END                                                                    AS loan_status_final,\r\n        cast(lo.partner as VARCHAR(400)) partner,\r\n        la.point_prerating                                                     qualified,\r\n        cast( (case when lo.partner = 'MISA' THEN 'MISA'\r\n            when la.utm_campaign IS NOT NULL THEN 'MKT'\r\n            when la.leads_source_mkt in ('MKT', 'KHAC') THEN 'MKT'\r\n            when la.leads_source_mkt = 'RM' THEN 'RM'\r\n        ELSE la.leads_source_mkt end) as VARCHAR(400) ) leads_source_mkt,\r\n        cast(la.contact_name as VARCHAR(400)) contact_name,\r\n        cast(la.email as VARCHAR(400)) email,\r\n        cast(la.phone_number as VARCHAR(400)) phone_number,\r\n        cast(la.phone_number_management_1 as VARCHAR(400)) phone_number_management_1,\r\n        cast(la.phone_number_management_2 as VARCHAR(400)) phone_number_management_2,\r\n        CASE\r\n            WHEN la.phone_number = s.mobile_number\r\n                 OR la.phone_number_management_1 = s.mobile_number\r\n                 OR la.phone_number_management_2 = s.mobile_number THEN\r\n                0\r\n            ELSE\r\n                1\r\n        END                                                                    AS selfserve_flag,\r\n        ful.ekyc_status,\r\n        cast(la.utm_campaign as VARCHAR(400)) utm_campaign,\r\n        cast(ha.hub_id as VARCHAR(400)) hub_id,\r\n        cast(REPLACE(TRIM(CASE\r\n            WHEN bm.description LIKE 'MSB%' THEN\r\n                substr(bm.description,\r\n                       5,\r\n                       length(bm.description) - 4)\r\n            ELSE\r\n                bm.description\r\n        end), 'HCM', 'H\u1ed3 Ch\u00ed Minh') as VARCHAR(400))                                                                     AS hub_name, --HO CHI MINH\r\n--        ha.USER_NAME_RM,\r\n        cast(s.user_name as VARCHAR(400)) user_name,\r\n        cast(s.full_name as VARCHAR(400)) full_name,\r\n        cast(la.crm_note as VARCHAR(1000)) crm_note,\r\n        cast(cj3_leads_info.region_activity as VARCHAR(400)) region_activity,\r\n        CASE\r\n            WHEN substr(lo.business_id, 1, 10) IN (\r\n                SELECT DISTINCT\r\n                    tax_code\r\n                FROM\r\n                    {{ source('df_2', 'thuvh3_tax_code_test') }}\r\n            )\r\n                 OR upper(lo.business_name) LIKE '%TEST%'\r\n                 OR upper(lo.business_name) LIKE '%ABC%'\r\n                 OR upper(lo.business_name) LIKE '%[TE%'\r\n                 OR upper(lo.business_id) LIKE '%DEL%'\r\n                 OR upper(lo.crm_note) LIKE '%TEST%' THEN\r\n                1\r\n            ELSE\r\n                0\r\n        END                                                                    AS test_flag\r\n    FROM\r\n        {{ source('df_2', 'cj3_loan_application') }}    lo\r\n        LEFT JOIN {{ source('df_2', 'cj3_leads_activities') }}      la ON lo.lead_activities_id = la.id\r\n        LEFT JOIN cj3_history_assign_lead                               ha ON lo.business_id = ha.business_id\r\n                                                AND ha.rn = 1\r\n        LEFT JOIN cj3_history_update_loan                               submit_bpm ON lo.loan_application_id = submit_bpm.loan_application_id\r\n        LEFT JOIN cj3_staff                                             s ON ha.rm_id = s.id\r\n                                 AND s.rn = 1\r\n        LEFT JOIN cj3_file_upload_loan                                  ful ON lo.loan_application_id = ful.loan_application_id\r\n                                              AND ful.rn = 1\r\n        LEFT JOIN {{ source('df_2', 'bpm_branch_mapping') }} bm ON ha.hub_id = bm.branch_id\r\n        LEFT JOIN {{ source('df_2', 'cj3_leads_info') }} cj3_leads_info on lo.business_id = cj3_leads_info.business_id\r\n)\r\nSELECT\r\n   *\r\nFROM\r\n    cte", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\cms\\dim_cms__loan_application.sql", "original_file_path": "models\\mart\\cms\\dim_cms__loan_application.sql", "name": "dim_cms__loan_application", "alias": "dim_cms__loan_application", "checksum": {"name": "sha256", "checksum": "b5f0abbda6b4eeb397578ac2cd21ce6111acc6d06364cf33cfffe8312c3b2474"}, "tags": ["cms_df"], "refs": [], "sources": [["df_2", "cj3_staff"], ["df_2", "cj3_history_assign_lead"], ["df_2", "cj3_history_update_loan"], ["df_2", "bpm_branch_mapping"], ["df_2", "cj3_leads_info"], ["df_2", "cj3_loan_application"], ["df_2", "cj3_leads_activities"], ["df_2", "thuvh3_tax_code_test"], ["df_2", "cj3_file_upload_loan"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "created_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\cms\\cms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\cms\\dim_cms__loan_application.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "created_date"}, "tags": ["cms_df"], "materialized": "table"}, "created_at": 1685959752.8149886, "compiled_code": "\nWITH cj3_history_assign_lead AS (\n    SELECT\n        a.*,\n        ROW_NUMBER()\n        OVER(PARTITION BY a.business_id\n             ORDER BY\n                 a.created_at DESC\n        ) rn\n    FROM\n        oracle_bulanding.df_2.cj3_history_assign_lead a\n), cj3_history_update_loan AS (\n    SELECT\n        loan_application_id,\n        MAX(created_at) AS submit_date\n    FROM\n        oracle_bulanding.df_2.cj3_history_update_loan\n    WHERE\n            bpm_submit_status = 'SUCESS'\n        AND role_code = 'ROLE_RM'\n    GROUP BY\n        loan_application_id\n), cj3_staff AS (\n    SELECT\n        a.*,\n        ROW_NUMBER()\n        OVER(PARTITION BY user_name\n             ORDER BY\n                 user_name\n        ) rn\n    FROM\n        oracle_bulanding.df_2.cj3_staff a\n), cj3_file_upload_loan AS (\n    SELECT\n        a.*,\n        ROW_NUMBER()\n        OVER(PARTITION BY loan_application_id\n             ORDER BY\n                 a.ekyc_status DESC, a.updated_at DESC\n        ) rn\n    FROM\n        oracle_bulanding.df_2.cj3_file_upload_loan a\n    WHERE\n        ekyc_status IS NOT NULL\n), cte AS (\n    SELECT\n        cast(lo.loan_application_id as VARCHAR(400)) loan_application_id,\n        lo.lead_activities_id,\n        cast(lo.landing_page_id as VARCHAR(400)) landing_page_id,\n        (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', lo.created_at)))  at time zone 'Asia/Ho_Chi_Minh' created_date, ---- UTC + 7\n        cast(substr(lo.business_id, 1, 10) as VARCHAR(400))                                           taxcode,\n        cast(lo.business_id as VARCHAR(400)) business_id,\n        cast(lo.business_name as VARCHAR(400)) business_name,\n        cast(lo.business_type as VARCHAR(400)) business_type,\n        cast(lo.company_size as VARCHAR(400)) company_size,\n        cast(lo.company_type as VARCHAR(400)) company_type,\n        la.recent_revenue,\n        cast(lo.package_type as VARCHAR(400)) package_type,\n        lo.loan_package_id,\n\n        CASE\n            WHEN lo.loan_package_id IN ( 3, 4, 5 ) THEN\n                'Main'\n            WHEN lo.loan_package_id = 1\n                 AND lo.company_size = 'SME' THEN\n                'Hook2'\n            WHEN lo.loan_package_id IN (1,2)\n                 AND lo.company_size = 'M_SME' THEN\n                'M_SME Hook'\n            WHEN lo.loan_package_id = 2\n                 AND lo.company_size = 'SME' THEN\n                'Hook1'\n        END                                                                    AS product,\n        CASE\n            WHEN lo.loan_package_id IN ( 4, 5 ) THEN\n                'T\u00e1i c\u1ea5p'\n            ELSE\n                'C\u1ea5p m\u1edbi'\n        END                                                                    AS type_loan,\n        lo.submit_status,\n        lo.bpm_status,\n        cast(lo.bpm_profile_status as VARCHAR(400)) bpm_profile_status,\n        cast(lo.profile_status as VARCHAR(400)) profile_status,\n        CASE\n            WHEN lo.submit_status <> 1                      THEN\n                'Thu h\u1ed3 s\u01a1'\n            WHEN lo.profile_status = 'SUA_UPLOAD_HOSO'      THEN\n                'B\u1ed5 sung h\u1ed3 s\u01a1'\n            WHEN lo.profile_status IN ( 'NOP_DU', 'NOP_OFFLINE' ) THEN\n                'N\u1ed9p \u0111\u1ee7 h\u1ed3 s\u01a1'\n            WHEN lo.profile_status = 'HS_CHO_THAM_DINH'     THEN\n                'Ch\u1edd th\u1ea9m \u0111\u1ecbnh'\n            WHEN lo.profile_status = 'HS_CHO_PHE_DUYET'     THEN\n                'Ch\u1edd ph\u00ea duy\u1ec7t'\n            WHEN lo.profile_status = 'PHE_DUYET_THANH_CONG' THEN\n                '\u0110\u00e3 ph\u00ea duy\u1ec7t'\n            ELSE\n                NULL\n        END                                                                    AS loan_status_final,\n        cast(lo.partner as VARCHAR(400)) partner,\n        la.point_prerating                                                     qualified,\n        cast( (case when lo.partner = 'MISA' THEN 'MISA'\n            when la.utm_campaign IS NOT NULL THEN 'MKT'\n            when la.leads_source_mkt in ('MKT', 'KHAC') THEN 'MKT'\n            when la.leads_source_mkt = 'RM' THEN 'RM'\n        ELSE la.leads_source_mkt end) as VARCHAR(400) ) leads_source_mkt,\n        cast(la.contact_name as VARCHAR(400)) contact_name,\n        cast(la.email as VARCHAR(400)) email,\n        cast(la.phone_number as VARCHAR(400)) phone_number,\n        cast(la.phone_number_management_1 as VARCHAR(400)) phone_number_management_1,\n        cast(la.phone_number_management_2 as VARCHAR(400)) phone_number_management_2,\n        CASE\n            WHEN la.phone_number = s.mobile_number\n                 OR la.phone_number_management_1 = s.mobile_number\n                 OR la.phone_number_management_2 = s.mobile_number THEN\n                0\n            ELSE\n                1\n        END                                                                    AS selfserve_flag,\n        ful.ekyc_status,\n        cast(la.utm_campaign as VARCHAR(400)) utm_campaign,\n        cast(ha.hub_id as VARCHAR(400)) hub_id,\n        cast(REPLACE(TRIM(CASE\n            WHEN bm.description LIKE 'MSB%' THEN\n                substr(bm.description,\n                       5,\n                       length(bm.description) - 4)\n            ELSE\n                bm.description\n        end), 'HCM', 'H\u1ed3 Ch\u00ed Minh') as VARCHAR(400))                                                                     AS hub_name, --HO CHI MINH\n--        ha.USER_NAME_RM,\n        cast(s.user_name as VARCHAR(400)) user_name,\n        cast(s.full_name as VARCHAR(400)) full_name,\n        cast(la.crm_note as VARCHAR(1000)) crm_note,\n        cast(cj3_leads_info.region_activity as VARCHAR(400)) region_activity,\n        CASE\n            WHEN substr(lo.business_id, 1, 10) IN (\n                SELECT DISTINCT\n                    tax_code\n                FROM\n                    oracle_bulanding.df_2.thuvh3_tax_code_test\n            )\n                 OR upper(lo.business_name) LIKE '%TEST%'\n                 OR upper(lo.business_name) LIKE '%ABC%'\n                 OR upper(lo.business_name) LIKE '%[TE%'\n                 OR upper(lo.business_id) LIKE '%DEL%'\n                 OR upper(lo.crm_note) LIKE '%TEST%' THEN\n                1\n            ELSE\n                0\n        END                                                                    AS test_flag\n    FROM\n        oracle_bulanding.df_2.cj3_loan_application    lo\n        LEFT JOIN oracle_bulanding.df_2.cj3_leads_activities      la ON lo.lead_activities_id = la.id\n        LEFT JOIN cj3_history_assign_lead                               ha ON lo.business_id = ha.business_id\n                                                AND ha.rn = 1\n        LEFT JOIN cj3_history_update_loan                               submit_bpm ON lo.loan_application_id = submit_bpm.loan_application_id\n        LEFT JOIN cj3_staff                                             s ON ha.rm_id = s.id\n                                 AND s.rn = 1\n        LEFT JOIN cj3_file_upload_loan                                  ful ON lo.loan_application_id = ful.loan_application_id\n                                              AND ful.rn = 1\n        LEFT JOIN oracle_bulanding.df_2.bpm_branch_mapping bm ON ha.hub_id = bm.branch_id\n        LEFT JOIN oracle_bulanding.df_2.cj3_leads_info cj3_leads_info on lo.business_id = cj3_leads_info.business_id\n)\nSELECT\n   *\nFROM\n    cte", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim_cms__loan_application"}, "model.dga_data_model.fact_cms__loan_application_activities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.df_2.cj3_staff", "source.dga_data_model.df_2.cj3_history_assign_lead", "source.dga_data_model.df_2.cj3_history_update_loan", "source.dga_data_model.df_2.cj3_loan_application", "source.dga_data_model.df_2.cj3_file_upload_loan", "source.dga_data_model.df_2.cj3_loan_application_tracking"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["cms_df"], "meta": {"owner": "thaidv3", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "cms", "fact_cms__loan_application_activities"], "unique_id": "model.dga_data_model.fact_cms__loan_application_activities", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH cj3_loan_application AS (\r\n    SELECT\r\n        loan_application_id,\r\n        created_at,\r\n        'REGISTER' app_status,\r\n        ''         user_id,\r\n        'CUSTOMER' role\r\n    FROM\r\n        {{ source('df_2','cj3_loan_application') }}\r\n), cj3_file_first_upload_loan AS (\r\n    SELECT\r\n        loan_application_id,\r\n        created_at,\r\n        'FIRST_UPLOAD' app_status,\r\n        ''             user_id,\r\n        'CUSTOMER'     role\r\n    FROM\r\n        (\r\n            SELECT\r\n                a.*,\r\n                ROW_NUMBER()\r\n                OVER(PARTITION BY loan_application_id\r\n                     ORDER BY\r\n                         created_at ASC\r\n                ) rn\r\n            FROM\r\n                {{ source('df_2', 'cj3_file_upload_loan') }} a\r\n        ) file_upload\r\n    WHERE\r\n        file_upload.rn = 1\r\n), cj3_file_last_upload_loan AS (\r\n    SELECT\r\n        loan_application_id,\r\n        created_at,\r\n        'LAST_UPLOAD' app_status,\r\n        ''            user_id,\r\n        'CUSTOMER'    role\r\n    FROM\r\n        (\r\n            SELECT\r\n                a.*,\r\n                ROW_NUMBER()\r\n                OVER(PARTITION BY loan_application_id\r\n                     ORDER BY\r\n                         created_at DESC\r\n                ) rn\r\n            FROM\r\n                {{ source('df_2','cj3_file_upload_loan') }} a\r\n        ) file_upload\r\n    WHERE\r\n        file_upload.rn = 1\r\n), cj3_history_update_loan_confirm AS (\r\n    SELECT\r\n        loan_application_id,\r\n        created_at,\r\n        'CSD_CONFIRM' app_status,\r\n        staff_name    user_id,\r\n        'CRM'         role\r\n    FROM\r\n        (\r\n            SELECT\r\n                a1.*,\r\n                ROW_NUMBER()\r\n                OVER(PARTITION BY a1.business_id\r\n                     ORDER BY\r\n                         a1.created_at DESC\r\n                ) rn\r\n            FROM\r\n                (\r\n                    SELECT\r\n                        a.*\r\n                    FROM\r\n                        {{ source('df_2','cj3_history_update_loan') }} a\r\n                    WHERE\r\n                            profile_status = 'NOP_DU'\r\n                        AND role_code = 'ROLE_CRM'\r\n                ) a1\r\n        ) csd_confirm\r\n    WHERE\r\n        csd_confirm.rn = 1\r\n), cj3_history_assign_lead AS (\r\n    SELECT\r\n        loan_application_id,\r\n        created_at,\r\n        'CSD_DISTRIBUTION' app_status,\r\n        staff_assign_name  user_id,\r\n        'CRM'              role\r\n    FROM\r\n        (\r\n            SELECT\r\n                a.*,\r\n                ROW_NUMBER()\r\n                OVER(PARTITION BY a.business_id\r\n                     ORDER BY\r\n                         a.created_at DESC\r\n                ) rn\r\n            FROM\r\n                {{ source('df_2','cj3_history_assign_lead') }} a\r\n            WHERE\r\n                a.staff_assign_id NOT IN (\r\n                    SELECT DISTINCT\r\n                        staff_leader_id\r\n                    FROM\r\n                        {{ source('df_2','cj3_staff') }}\r\n                    WHERE\r\n                        staff_leader_id IS NOT NULL\r\n                )\r\n        ) phanbo\r\n    WHERE\r\n            1 = 1\r\n        AND phanbo.rn = 1\r\n        AND loan_application_id IS NOT NULL\r\n), cj3_loan_application_tracking AS (\r\n    SELECT\r\n        loan_application_id,\r\n        created_at,\r\n        'CSD_CHECK' app_status,\r\n        staff_name  user_id,\r\n        'CRM'       role\r\n    FROM\r\n        (\r\n            SELECT\r\n                a.*,\r\n                ROW_NUMBER()\r\n                OVER(PARTITION BY loan_application_id\r\n                     ORDER BY\r\n                         created_at ASC\r\n                ) rn\r\n            FROM\r\n                {{ source('df_2','cj3_loan_application_tracking') }} a\r\n        ) csd_check\r\n    WHERE\r\n        csd_check.rn = 1\r\n), cj3_history_update_loan_submit AS (\r\n    SELECT\r\n        loan_application_id,\r\n        submit_date,\r\n        'BPM_SUBMIT' app_status,\r\n        staff_name   user_id,\r\n        'RM'         role\r\n    FROM\r\n        (\r\n            SELECT\r\n                loan_application_id,\r\n                MAX(created_at) AS submit_date,\r\n                staff_name\r\n--select *\r\n            FROM\r\n                {{ source('df_2','cj3_history_update_loan') }}\r\n            WHERE\r\n                    bpm_submit_status = 'SUCESS'\r\n                AND role_code = 'ROLE_RM'\r\n            GROUP BY\r\n                loan_application_id,\r\n                staff_name\r\n        ) submit_bpm\r\n), output AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_loan_application\r\n    UNION ALL\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_file_first_upload_loan\r\n    UNION ALL\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_file_last_upload_loan\r\n    UNION ALL\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_history_update_loan_confirm\r\n    UNION ALL\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_history_assign_lead\r\n    UNION ALL\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_loan_application_tracking\r\n    UNION ALL\r\n    SELECT\r\n        *\r\n    FROM\r\n        cj3_history_update_loan_submit\r\n)\r\n\r\nSELECT\r\n    cast(loan_application_id as VARCHAR(1000) ) loan_application_id,\r\n    (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', created_at)))  at time zone 'Asia/Ho_Chi_Minh' created_at,\r\n    app_status,\r\n    cast(user_id as VARCHAR(1000) ) user_id,\r\n    role\r\nFROM\r\n    output", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\cms\\fact_cms__loan_application_activities.sql", "original_file_path": "models\\mart\\cms\\fact_cms__loan_application_activities.sql", "name": "fact_cms__loan_application_activities", "alias": "fact_cms__loan_application_activities", "checksum": {"name": "sha256", "checksum": "de72e33bc8932fe1e9c9f8b6080817cdaeb9139afd3ee5d7620f177bcbad2bbf"}, "tags": ["cms_df"], "refs": [], "sources": [["df_2", "cj3_staff"], ["df_2", "cj3_history_assign_lead"], ["df_2", "cj3_history_update_loan"], ["df_2", "cj3_loan_application"], ["df_2", "cj3_file_upload_loan"], ["df_2", "cj3_loan_application_tracking"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\cms\\cms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\cms\\fact_cms__loan_application_activities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "created_at"}, "tags": ["cms_df"], "materialized": "table"}, "created_at": 1685959752.8169785, "compiled_code": "\nWITH cj3_loan_application AS (\n    SELECT\n        loan_application_id,\n        created_at,\n        'REGISTER' app_status,\n        ''         user_id,\n        'CUSTOMER' role\n    FROM\n        oracle_bulanding.df_2.cj3_loan_application\n), cj3_file_first_upload_loan AS (\n    SELECT\n        loan_application_id,\n        created_at,\n        'FIRST_UPLOAD' app_status,\n        ''             user_id,\n        'CUSTOMER'     role\n    FROM\n        (\n            SELECT\n                a.*,\n                ROW_NUMBER()\n                OVER(PARTITION BY loan_application_id\n                     ORDER BY\n                         created_at ASC\n                ) rn\n            FROM\n                oracle_bulanding.df_2.cj3_file_upload_loan a\n        ) file_upload\n    WHERE\n        file_upload.rn = 1\n), cj3_file_last_upload_loan AS (\n    SELECT\n        loan_application_id,\n        created_at,\n        'LAST_UPLOAD' app_status,\n        ''            user_id,\n        'CUSTOMER'    role\n    FROM\n        (\n            SELECT\n                a.*,\n                ROW_NUMBER()\n                OVER(PARTITION BY loan_application_id\n                     ORDER BY\n                         created_at DESC\n                ) rn\n            FROM\n                oracle_bulanding.df_2.cj3_file_upload_loan a\n        ) file_upload\n    WHERE\n        file_upload.rn = 1\n), cj3_history_update_loan_confirm AS (\n    SELECT\n        loan_application_id,\n        created_at,\n        'CSD_CONFIRM' app_status,\n        staff_name    user_id,\n        'CRM'         role\n    FROM\n        (\n            SELECT\n                a1.*,\n                ROW_NUMBER()\n                OVER(PARTITION BY a1.business_id\n                     ORDER BY\n                         a1.created_at DESC\n                ) rn\n            FROM\n                (\n                    SELECT\n                        a.*\n                    FROM\n                        oracle_bulanding.df_2.cj3_history_update_loan a\n                    WHERE\n                            profile_status = 'NOP_DU'\n                        AND role_code = 'ROLE_CRM'\n                ) a1\n        ) csd_confirm\n    WHERE\n        csd_confirm.rn = 1\n), cj3_history_assign_lead AS (\n    SELECT\n        loan_application_id,\n        created_at,\n        'CSD_DISTRIBUTION' app_status,\n        staff_assign_name  user_id,\n        'CRM'              role\n    FROM\n        (\n            SELECT\n                a.*,\n                ROW_NUMBER()\n                OVER(PARTITION BY a.business_id\n                     ORDER BY\n                         a.created_at DESC\n                ) rn\n            FROM\n                oracle_bulanding.df_2.cj3_history_assign_lead a\n            WHERE\n                a.staff_assign_id NOT IN (\n                    SELECT DISTINCT\n                        staff_leader_id\n                    FROM\n                        oracle_bulanding.df_2.cj3_staff\n                    WHERE\n                        staff_leader_id IS NOT NULL\n                )\n        ) phanbo\n    WHERE\n            1 = 1\n        AND phanbo.rn = 1\n        AND loan_application_id IS NOT NULL\n), cj3_loan_application_tracking AS (\n    SELECT\n        loan_application_id,\n        created_at,\n        'CSD_CHECK' app_status,\n        staff_name  user_id,\n        'CRM'       role\n    FROM\n        (\n            SELECT\n                a.*,\n                ROW_NUMBER()\n                OVER(PARTITION BY loan_application_id\n                     ORDER BY\n                         created_at ASC\n                ) rn\n            FROM\n                oracle_bulanding.df_2.cj3_loan_application_tracking a\n        ) csd_check\n    WHERE\n        csd_check.rn = 1\n), cj3_history_update_loan_submit AS (\n    SELECT\n        loan_application_id,\n        submit_date,\n        'BPM_SUBMIT' app_status,\n        staff_name   user_id,\n        'RM'         role\n    FROM\n        (\n            SELECT\n                loan_application_id,\n                MAX(created_at) AS submit_date,\n                staff_name\n--select *\n            FROM\n                oracle_bulanding.df_2.cj3_history_update_loan\n            WHERE\n                    bpm_submit_status = 'SUCESS'\n                AND role_code = 'ROLE_RM'\n            GROUP BY\n                loan_application_id,\n                staff_name\n        ) submit_bpm\n), output AS (\n    SELECT\n        *\n    FROM\n        cj3_loan_application\n    UNION ALL\n    SELECT\n        *\n    FROM\n        cj3_file_first_upload_loan\n    UNION ALL\n    SELECT\n        *\n    FROM\n        cj3_file_last_upload_loan\n    UNION ALL\n    SELECT\n        *\n    FROM\n        cj3_history_update_loan_confirm\n    UNION ALL\n    SELECT\n        *\n    FROM\n        cj3_history_assign_lead\n    UNION ALL\n    SELECT\n        *\n    FROM\n        cj3_loan_application_tracking\n    UNION ALL\n    SELECT\n        *\n    FROM\n        cj3_history_update_loan_submit\n)\n\nSELECT\n    cast(loan_application_id as VARCHAR(1000) ) loan_application_id,\n    (from_unixtime(date_diff('second', timestamp '1970-01-01 00:00:00', created_at)))  at time zone 'Asia/Ho_Chi_Minh' created_at,\n    app_status,\n    cast(user_id as VARCHAR(1000) ) user_id,\n    role\nFROM\n    output", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fact_cms__loan_application_activities"}, "model.dga_data_model.dim__arrangement": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int__arrangement"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "eff_fm_dt"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["merge_key"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || unq_id WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "dim__arrangement"], "unique_id": "model.dga_data_model.dim__arrangement", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key=['merge_key'],\r\n    post_hook=[\"UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || unq_id WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)\"]\r\n  )\r\n}}\r\nWITH using_clause AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('int__arrangement')}}\r\n)\r\n, updates AS (\r\n  SELECT\r\n      0 AS is_cur_rec\r\n    , o.eff_fm_dt\r\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\r\n    , o.module\r\n    , o.customer_number\r\n    , o.account_number\r\n    , o.product_code\r\n    , o.open_date\r\n    , o.activate_date\r\n    , o.hash_diff\r\n    , o.unq_id\r\n    , 1 || '_' || o.unq_id as merge_key\r\n    , o.maturity_date\r\n  FROM {{ this }} o\r\n  {% if is_incremental() %}\r\n  LEFT JOIN using_clause uc ON o.unq_id =  uc.unq_id\r\n  WHERE o.hash_diff <> uc.hash_diff\r\n  AND o.is_cur_rec = 1\r\n  {% endif %}\r\n)\r\n, inserts AS (\r\n  SELECT\r\n      1 AS is_cur_rec\r\n    , to_date(uc.etl_date, 'YYYYDDD') eff_fm_dt\r\n    , to_date('01-JAN-2999') AS eff_to_dt\r\n    , uc.module\r\n    , uc.customer_number\r\n    , CAST( uc.account_number AS VARCHAR2(200)) AS account_number\r\n    , uc.product_code\r\n    , uc.open_date\r\n    , uc.activate_date\r\n    , uc.hash_diff\r\n    , CAST( uc.unq_id AS NVARCHAR2(100)) AS unq_id\r\n    , NULL AS merge_key\r\n    , uc.maturity_date\r\n  FROM using_clause uc\r\n  {% if is_incremental() %}\r\n  LEFT JOIN {{ this }} o ON o.unq_id =  uc.unq_id AND o.is_cur_rec = 1\r\n  WHERE\r\n    o.unq_id IS NULL\r\n    OR o.hash_diff <> uc.hash_diff\r\n  {% endif %}\r\n)\r\nSELECT * FROM updates\r\nUNION\r\nSELECT * FROM inserts", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\dim__arrangement.sql", "original_file_path": "models\\mart\\daily\\dim__arrangement.sql", "name": "dim__arrangement", "alias": "dim__arrangement", "checksum": {"name": "sha256", "checksum": "93641f1797fb5cf4bbe9532273f4355bb89e6352b600812ec88aa21d405b880a"}, "tags": ["pkg_daily"], "refs": [["int__arrangement"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "eff_fm_dt"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\dim__arrangement.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "eff_fm_dt"}, "tags": "pkg_daily", "materialized": "incremental", "unique_key": ["merge_key"], "post-hook": ["UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || unq_id WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)"]}, "created_at": 1685959752.8239775, "compiled_code": "\nWITH using_clause AS (\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".int.int__arrangement\n)\n, updates AS (\n  SELECT\n      0 AS is_cur_rec\n    , o.eff_fm_dt\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\n    , o.module\n    , o.customer_number\n    , o.account_number\n    , o.product_code\n    , o.open_date\n    , o.activate_date\n    , o.hash_diff\n    , o.unq_id\n    , 1 || '_' || o.unq_id as merge_key\n    , o.maturity_date\n  FROM \"oracle_dgaworkzone\".mart.dim__arrangement o\n  \n  LEFT JOIN using_clause uc ON o.unq_id =  uc.unq_id\n  WHERE o.hash_diff <> uc.hash_diff\n  AND o.is_cur_rec = 1\n  \n)\n, inserts AS (\n  SELECT\n      1 AS is_cur_rec\n    , to_date(uc.etl_date, 'YYYYDDD') eff_fm_dt\n    , to_date('01-JAN-2999') AS eff_to_dt\n    , uc.module\n    , uc.customer_number\n    , CAST( uc.account_number AS VARCHAR2(200)) AS account_number\n    , uc.product_code\n    , uc.open_date\n    , uc.activate_date\n    , uc.hash_diff\n    , CAST( uc.unq_id AS NVARCHAR2(100)) AS unq_id\n    , NULL AS merge_key\n    , uc.maturity_date\n  FROM using_clause uc\n  \n  LEFT JOIN \"oracle_dgaworkzone\".mart.dim__arrangement o ON o.unq_id =  uc.unq_id AND o.is_cur_rec = 1\n  WHERE\n    o.unq_id IS NULL\n    OR o.hash_diff <> uc.hash_diff\n  \n)\nSELECT * FROM updates\nUNION\nSELECT * FROM inserts", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim__arrangement"}, "model.dga_data_model.dim__casa_account": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.star", "macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int__casa_account", "model.dga_data_model.int__casa_account"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "eff_fm_dt"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["merge_key"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || account_number WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1) ", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "dim__casa_account"], "unique_id": "model.dga_data_model.dim__casa_account", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key=['merge_key'],\r\n    post_hook=[\"UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || account_number WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1) \"]\r\n  )\r\n}}\r\nWITH using_clause AS (\r\n  SELECT\r\n    {{ dbt_utils.star(from=ref('int__casa_account'), except=[\"source_account\"]) }}\r\n    , CAST(source_account AS VARCHAR(100)) AS source_account\r\n  FROM\r\n    {{ ref('int__casa_account')}}\r\n)\r\n, updates AS (\r\n  SELECT\r\n      0 AS is_cur_rec\r\n    , o.eff_fm_dt\r\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\r\n    , o.customer_number\r\n    , o.account_number\r\n    , o.currency_type\r\n    , o.product_code\r\n    , o.account_name\r\n    , o.open_date\r\n    , o.open_time\r\n    , o.status\r\n    , o.status_date\r\n    , o.workstation_id\r\n    , o.user_id\r\n    , o.branch_code\r\n    , o.subbranch_no\r\n    , o.od_rate_current\r\n    , o.od_reate_number_current\r\n    , o.od_agreement_date_original\r\n    , o.od_expiration_date_original\r\n    , o.od_agreement_date_current\r\n    , o.od_expiration_date_current\r\n    , o.od_authorized_limit_current\r\n    , o.od_draw_limit_current\r\n    , o.is_overdraft_current\r\n    , o.source_account\r\n    , o.hash_diff\r\n    , 1 || '_' || o.account_number as merge_key\r\n  FROM {{ this }} o\r\n  {% if is_incremental() %}\r\n  LEFT JOIN using_clause uc ON o.account_number =  uc.account_number\r\n  WHERE o.hash_diff <> uc.hash_diff\r\n  AND o.is_cur_rec = 1\r\n  {% endif %}\r\n)\r\n, inserts AS (\r\n  SELECT\r\n      1 AS is_cur_rec\r\n    , to_date(uc.etl_date, 'YYYYDDD') eff_fm_dt\r\n    , to_date('01-JAN-2999') AS eff_to_dt\r\n    , uc.customer_number\r\n    , uc.account_number\r\n    , uc.currency_type\r\n    , uc.product_code\r\n    , uc.account_name\r\n    , uc.open_date\r\n    , uc.open_time\r\n    , uc.status\r\n    , uc.status_date\r\n    , uc.workstation_id\r\n    , uc.user_id\r\n    , uc.branch_code\r\n    , uc.subbranch_no\r\n    , uc.od_rate_current\r\n    , uc.od_reate_number_current\r\n    , uc.od_agreement_date_original\r\n    , uc.od_expiration_date_original\r\n    , uc.od_agreement_date_current\r\n    , uc.od_expiration_date_current\r\n    , uc.od_authorized_limit_current\r\n    , uc.od_draw_limit_current\r\n    , uc.is_overdraft_current\r\n    , uc.source_account\r\n    , uc.hash_diff\r\n    , null AS merge_key\r\n  FROM using_clause uc\r\n  {% if is_incremental() %}\r\n  LEFT JOIN {{ this }} o ON o.account_number =  uc.account_number AND o.is_cur_rec = 1\r\n  WHERE\r\n    o.account_number IS NULL\r\n    OR o.hash_diff <> uc.hash_diff\r\n  {% endif %}\r\n)\r\nSELECT * FROM updates\r\nUNION\r\nSELECT * FROM inserts", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\dim__casa_account.sql", "original_file_path": "models\\mart\\daily\\dim__casa_account.sql", "name": "dim__casa_account", "alias": "dim__casa_account", "checksum": {"name": "sha256", "checksum": "90a0989b5d22ad053f6ce1d34ff3034fa95eff416f0ccf4f4f29efd8ffae7777"}, "tags": ["pkg_daily"], "refs": [["int__casa_account"], ["int__casa_account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "eff_fm_dt"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\dim__casa_account.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "eff_fm_dt"}, "tags": "pkg_daily", "materialized": "incremental", "unique_key": ["merge_key"], "post-hook": ["UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || account_number WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1) "]}, "created_at": 1685959752.8279774, "compiled_code": "\nWITH using_clause AS (\n  SELECT\n    \"hash_diff\",\n  \"etl_date\",\n  \"customer_number\",\n  \"account_number\",\n  \"currency_type\",\n  \"product_code\",\n  \"account_name\",\n  \"open_date\",\n  \"open_time\",\n  \"status\",\n  \"status_date\",\n  \"workstation_id\",\n  \"user_id\",\n  \"branch_code\",\n  \"subbranch_no\",\n  \"od_rate_current\",\n  \"od_reate_number_current\",\n  \"od_agreement_date_original\",\n  \"od_expiration_date_original\",\n  \"od_agreement_date_current\",\n  \"od_expiration_date_current\",\n  \"od_authorized_limit_current\",\n  \"od_draw_limit_current\",\n  \"is_overdraft_current\",\n  \"sale_code\"\n    , CAST(source_account AS VARCHAR(100)) AS source_account\n  FROM\n    \"oracle_dgaworkzone\".int.int__casa_account\n)\n, updates AS (\n  SELECT\n      0 AS is_cur_rec\n    , o.eff_fm_dt\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\n    , o.customer_number\n    , o.account_number\n    , o.currency_type\n    , o.product_code\n    , o.account_name\n    , o.open_date\n    , o.open_time\n    , o.status\n    , o.status_date\n    , o.workstation_id\n    , o.user_id\n    , o.branch_code\n    , o.subbranch_no\n    , o.od_rate_current\n    , o.od_reate_number_current\n    , o.od_agreement_date_original\n    , o.od_expiration_date_original\n    , o.od_agreement_date_current\n    , o.od_expiration_date_current\n    , o.od_authorized_limit_current\n    , o.od_draw_limit_current\n    , o.is_overdraft_current\n    , o.source_account\n    , o.hash_diff\n    , 1 || '_' || o.account_number as merge_key\n  FROM \"oracle_dgaworkzone\".mart.dim__casa_account o\n  \n  LEFT JOIN using_clause uc ON o.account_number =  uc.account_number\n  WHERE o.hash_diff <> uc.hash_diff\n  AND o.is_cur_rec = 1\n  \n)\n, inserts AS (\n  SELECT\n      1 AS is_cur_rec\n    , to_date(uc.etl_date, 'YYYYDDD') eff_fm_dt\n    , to_date('01-JAN-2999') AS eff_to_dt\n    , uc.customer_number\n    , uc.account_number\n    , uc.currency_type\n    , uc.product_code\n    , uc.account_name\n    , uc.open_date\n    , uc.open_time\n    , uc.status\n    , uc.status_date\n    , uc.workstation_id\n    , uc.user_id\n    , uc.branch_code\n    , uc.subbranch_no\n    , uc.od_rate_current\n    , uc.od_reate_number_current\n    , uc.od_agreement_date_original\n    , uc.od_expiration_date_original\n    , uc.od_agreement_date_current\n    , uc.od_expiration_date_current\n    , uc.od_authorized_limit_current\n    , uc.od_draw_limit_current\n    , uc.is_overdraft_current\n    , uc.source_account\n    , uc.hash_diff\n    , null AS merge_key\n  FROM using_clause uc\n  \n  LEFT JOIN \"oracle_dgaworkzone\".mart.dim__casa_account o ON o.account_number =  uc.account_number AND o.is_cur_rec = 1\n  WHERE\n    o.account_number IS NULL\n    OR o.hash_diff <> uc.hash_diff\n  \n)\nSELECT * FROM updates\nUNION\nSELECT * FROM inserts", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim__casa_account"}, "model.dga_data_model.dim__customer": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "eff_fm_dt"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["merge_key"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || customer_number WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "dim__customer"], "unique_id": "model.dga_data_model.dim__customer", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    unique_key=['merge_key'],\r\n    post_hook=[\"UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || customer_number WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)\"]\r\n  )\r\n}}\r\nWITH using_clause AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('int__customer')}}\r\n)\r\n, updates AS (\r\n  SELECT\r\n      0 AS is_cur_rec\r\n    , o.eff_fm_dt\r\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\r\n    , o.bank_number\r\n    , o.branch_number\r\n    , o.customer_number\r\n    , o.customer_shortname\r\n    , o.formatted_short_name\r\n    , o.customer_fullname_locale\r\n    , o.customer_fullname_english\r\n    , o.relationship_manager\r\n    , o.resident_code\r\n    , o.country_of_citizenship\r\n    , o.original_date_of_birth\r\n    , o.date_of_birth\r\n    , o.original_contact_date\r\n    , o.contact_date\r\n    , o.customer_register_number\r\n    , o.id_type_code\r\n    , o.id_issue_place\r\n    , o.id_issue_remark\r\n    , o.original_id_issue_date\r\n    , o.id_issue_date\r\n    , o.place_of_birth\r\n    , o.marital_status_code\r\n    , o.marital_status_name\r\n    , o.marital_status_date\r\n    , o.gender\r\n    , o.user_id\r\n    , o.workstation_id\r\n    , o.customer_sts_code\r\n    , o.customer_sts_name\r\n    , o.customer_status_date\r\n    , o.tax_code_id\r\n    , o.reporting_branch\r\n    , o.department_code\r\n    , o.individual\r\n    , o.industry_code\r\n    , o.industry_name\r\n    , o.office_phone_address\r\n    , o.home_phone_address\r\n    , o.mobile_phone_address\r\n    , o.formatted_mobile_phone_address\r\n    , o.email_address\r\n    , o.valid_format_email_address\r\n    , o.customer_address_line_1\r\n    , o.customer_address_line_2\r\n    , o.customer_address_line_3\r\n    , o.customer_address_line_4\r\n    , o.permanent_address_city_name\r\n    , o.permanent_address_city_code\r\n    , o.permanent_address_country\r\n    , o.division\r\n    , o.industry_dim_id\r\n    , o.biz_line\r\n    , o.segment_lv1_rb\r\n    , o.segment_lv2_rb\r\n    , o.source_customer\r\n    , o.subbranch_no\r\n    , o.tax_code_final\r\n    , o.customer_company\r\n    , o.hash_diff\r\n    , 1 || '_' || o.customer_number as merge_key\r\n  FROM {{ this }} o\r\n  {% if is_incremental() %}\r\n  INNER JOIN using_clause uc ON o.customer_number =  uc.customer_number\r\n  WHERE o.is_cur_rec = 1 AND o.hash_diff <> uc.hash_diff\r\n  {% endif %}\r\n)\r\n, inserts AS (\r\n  SELECT\r\n      1 AS is_cur_rec\r\n    , to_date(uc.etl_date, 'YYYYDDD') eff_fm_dt\r\n    , to_date('01-JAN-2999') AS eff_to_dt\r\n    , uc.bank_number\r\n    , uc.branch_number\r\n    , uc.customer_number\r\n    , uc.customer_shortname\r\n    , uc.formatted_short_name\r\n    , uc.customer_fullname_locale\r\n    , uc.customer_fullname_english\r\n    , uc.relationship_manager\r\n    , uc.resident_code\r\n    , uc.country_of_citizenship\r\n    , uc.original_date_of_birth\r\n    , uc.date_of_birth\r\n    , uc.original_contact_date\r\n    , uc.contact_date\r\n    , uc.customer_register_number\r\n    , uc.id_type_code\r\n    , CAST(uc.id_issue_place AS nvarchar2(200)) AS id_issue_place\r\n    , CAST(uc.id_issue_remark AS NVARCHAR2(200)) AS id_issue_remark\r\n    , uc.original_id_issue_date\r\n    , uc.id_issue_date\r\n    , uc.place_of_birth\r\n    , uc.marital_status_code\r\n    , uc.marital_status_name\r\n    , uc.marital_status_date\r\n    , uc.gender\r\n    , uc.user_id\r\n    , uc.workstation_id\r\n    , uc.customer_sts_code\r\n    , uc.customer_sts_name\r\n    , uc.customer_status_date\r\n    , uc.tax_code_id\r\n    , uc.reporting_branch\r\n    , uc.department_code\r\n    , uc.individual\r\n    , uc.industry_code\r\n    , uc.industry_name\r\n    , CAST(uc.office_phone_address AS VARCHAR2(200)) AS office_phone_address\r\n    , CAST(uc.home_phone_address AS VARCHAR2(200)) AS home_phone_address\r\n    , CAST(uc.mobile_phone_address AS VARCHAR2(200)) AS mobile_phone_address\r\n    , CAST(uc.formatted_mobile_phone_address AS VARCHAR2(200)) AS formatted_mobile_phone_address\r\n    , CAST(uc.email_address AS VARCHAR2(200)) AS email_address\r\n    , CAST(uc.valid_format_email_address AS VARCHAR2(200)) AS valid_format_email_address\r\n    , uc.customer_address_line_1\r\n    , uc.customer_address_line_2\r\n    , uc.customer_address_line_3\r\n    , uc.customer_address_line_4\r\n    , uc.permanent_address_city_name\r\n    , uc.permanent_address_city_code\r\n    , uc.permanent_address_country\r\n    , uc.division\r\n    , to_number(is_number(uc.industry_dim_id)) AS industry_dim_id\r\n    , uc.biz_line\r\n    , CAST(uc.segment_lv1_rb AS VARCHAR2(200)) AS segment_lv1_rb\r\n    , CAST(uc.segment_lv2_rb AS VARCHAR2(200)) AS segment_lv2_rb\r\n    , CAST(uc.source_customer AS VARCHAR2(200)) AS source_customer\r\n    , CAST(uc.subbranch_no AS NUMBER) AS subbranch_no\r\n    , CAST(uc.tax_code_final AS VARCHAR2(200)) AS tax_code_final\r\n    , uc.customer_company\r\n    , uc.hash_diff\r\n    , null AS merge_key\r\n  FROM using_clause uc\r\n  {% if is_incremental() %}\r\n  LEFT JOIN {{ this }} o ON o.customer_number =  uc.customer_number AND o.is_cur_rec = 1\r\n  WHERE\r\n    o.customer_number IS NULL\r\n    OR o.hash_diff <> uc.hash_diff\r\n  {% endif %}\r\n)\r\nSELECT * FROM updates\r\nUNION\r\nSELECT * FROM inserts", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\dim__customer.sql", "original_file_path": "models\\mart\\daily\\dim__customer.sql", "name": "dim__customer", "alias": "dim__customer", "checksum": {"name": "sha256", "checksum": "ad5b282401b71dcff0a5c8c13d9f71b94dd8dc2f30d54de74f594943d9141f5d"}, "tags": ["pkg_daily"], "refs": [["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "eff_fm_dt"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\dim__customer.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "eff_fm_dt"}, "tags": "pkg_daily", "materialized": "incremental", "unique_key": ["merge_key"], "post-hook": ["UPDATE {{ this }} SET merge_key = is_cur_rec || '_' || customer_number WHERE merge_key is null or is_cur_rec <> SUBSTR(merge_key, 1, Instr(merge_key, '_', -1, 1) -1)"]}, "created_at": 1685959752.8309774, "compiled_code": "\nWITH using_clause AS (\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".int.int__customer\n)\n, updates AS (\n  SELECT\n      0 AS is_cur_rec\n    , o.eff_fm_dt\n    , to_date(uc.etl_date, 'YYYYDDD') AS eff_to_dt\n    , o.bank_number\n    , o.branch_number\n    , o.customer_number\n    , o.customer_shortname\n    , o.formatted_short_name\n    , o.customer_fullname_locale\n    , o.customer_fullname_english\n    , o.relationship_manager\n    , o.resident_code\n    , o.country_of_citizenship\n    , o.original_date_of_birth\n    , o.date_of_birth\n    , o.original_contact_date\n    , o.contact_date\n    , o.customer_register_number\n    , o.id_type_code\n    , o.id_issue_place\n    , o.id_issue_remark\n    , o.original_id_issue_date\n    , o.id_issue_date\n    , o.place_of_birth\n    , o.marital_status_code\n    , o.marital_status_name\n    , o.marital_status_date\n    , o.gender\n    , o.user_id\n    , o.workstation_id\n    , o.customer_sts_code\n    , o.customer_sts_name\n    , o.customer_status_date\n    , o.tax_code_id\n    , o.reporting_branch\n    , o.department_code\n    , o.individual\n    , o.industry_code\n    , o.industry_name\n    , o.office_phone_address\n    , o.home_phone_address\n    , o.mobile_phone_address\n    , o.formatted_mobile_phone_address\n    , o.email_address\n    , o.valid_format_email_address\n    , o.customer_address_line_1\n    , o.customer_address_line_2\n    , o.customer_address_line_3\n    , o.customer_address_line_4\n    , o.permanent_address_city_name\n    , o.permanent_address_city_code\n    , o.permanent_address_country\n    , o.division\n    , o.industry_dim_id\n    , o.biz_line\n    , o.segment_lv1_rb\n    , o.segment_lv2_rb\n    , o.source_customer\n    , o.subbranch_no\n    , o.tax_code_final\n    , o.customer_company\n    , o.hash_diff\n    , 1 || '_' || o.customer_number as merge_key\n  FROM \"oracle_dgaworkzone\".mart.dim__customer o\n  \n  INNER JOIN using_clause uc ON o.customer_number =  uc.customer_number\n  WHERE o.is_cur_rec = 1 AND o.hash_diff <> uc.hash_diff\n  \n)\n, inserts AS (\n  SELECT\n      1 AS is_cur_rec\n    , to_date(uc.etl_date, 'YYYYDDD') eff_fm_dt\n    , to_date('01-JAN-2999') AS eff_to_dt\n    , uc.bank_number\n    , uc.branch_number\n    , uc.customer_number\n    , uc.customer_shortname\n    , uc.formatted_short_name\n    , uc.customer_fullname_locale\n    , uc.customer_fullname_english\n    , uc.relationship_manager\n    , uc.resident_code\n    , uc.country_of_citizenship\n    , uc.original_date_of_birth\n    , uc.date_of_birth\n    , uc.original_contact_date\n    , uc.contact_date\n    , uc.customer_register_number\n    , uc.id_type_code\n    , CAST(uc.id_issue_place AS nvarchar2(200)) AS id_issue_place\n    , CAST(uc.id_issue_remark AS NVARCHAR2(200)) AS id_issue_remark\n    , uc.original_id_issue_date\n    , uc.id_issue_date\n    , uc.place_of_birth\n    , uc.marital_status_code\n    , uc.marital_status_name\n    , uc.marital_status_date\n    , uc.gender\n    , uc.user_id\n    , uc.workstation_id\n    , uc.customer_sts_code\n    , uc.customer_sts_name\n    , uc.customer_status_date\n    , uc.tax_code_id\n    , uc.reporting_branch\n    , uc.department_code\n    , uc.individual\n    , uc.industry_code\n    , uc.industry_name\n    , CAST(uc.office_phone_address AS VARCHAR2(200)) AS office_phone_address\n    , CAST(uc.home_phone_address AS VARCHAR2(200)) AS home_phone_address\n    , CAST(uc.mobile_phone_address AS VARCHAR2(200)) AS mobile_phone_address\n    , CAST(uc.formatted_mobile_phone_address AS VARCHAR2(200)) AS formatted_mobile_phone_address\n    , CAST(uc.email_address AS VARCHAR2(200)) AS email_address\n    , CAST(uc.valid_format_email_address AS VARCHAR2(200)) AS valid_format_email_address\n    , uc.customer_address_line_1\n    , uc.customer_address_line_2\n    , uc.customer_address_line_3\n    , uc.customer_address_line_4\n    , uc.permanent_address_city_name\n    , uc.permanent_address_city_code\n    , uc.permanent_address_country\n    , uc.division\n    , to_number(is_number(uc.industry_dim_id)) AS industry_dim_id\n    , uc.biz_line\n    , CAST(uc.segment_lv1_rb AS VARCHAR2(200)) AS segment_lv1_rb\n    , CAST(uc.segment_lv2_rb AS VARCHAR2(200)) AS segment_lv2_rb\n    , CAST(uc.source_customer AS VARCHAR2(200)) AS source_customer\n    , CAST(uc.subbranch_no AS NUMBER) AS subbranch_no\n    , CAST(uc.tax_code_final AS VARCHAR2(200)) AS tax_code_final\n    , uc.customer_company\n    , uc.hash_diff\n    , null AS merge_key\n  FROM using_clause uc\n  \n  LEFT JOIN \"oracle_dgaworkzone\".mart.dim__customer o ON o.customer_number =  uc.customer_number AND o.is_cur_rec = 1\n  WHERE\n    o.customer_number IS NULL\n    OR o.hash_diff <> uc.hash_diff\n  \n)\nSELECT * FROM updates\nUNION\nSELECT * FROM inserts", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim__customer"}, "model.dga_data_model.dim__date": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.df_date_dim @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "dim__date"], "unique_id": "model.dga_data_model.dim__date", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nSELECT\r\n  date_id\r\n  , month_id\r\n  , julian_date\r\n  , date_value\r\n  , date_formatted_name\r\n  , date_name\r\n  , year_id\r\n  , year_start_date\r\n  , year_end_date\r\n  , quarter_num\r\n  , quarter_name\r\n  , quarter_start_date\r\n  , quarter_end_date\r\n  , year_quarter_name\r\n  , month_num\r\n  , month_short_name\r\n  , month_long_name\r\n  , month_start_date\r\n  , month_end_date\r\n  , year_month_name_1\r\n  , year_month_num_1\r\n  , year_month_name_2\r\n  , year_month_num_2\r\n  , week_of_year_num\r\n  , week_of_month_num\r\n  , week_start_date\r\n  , week_end_date\r\n  , year_week_num\r\n  , year_week_name\r\n  , weekday_num\r\n  , weekday_name\r\n  , is_holiday\r\nFROM \r\n  {{ source('daily_bulanding', 'df_date_dim @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\dim__date.sql", "original_file_path": "models\\mart\\daily\\dim__date.sql", "name": "dim__date", "alias": "dim__date", "checksum": {"name": "sha256", "checksum": "6a0ac8f353a3367a1e1f7f4dcfaa079732e8218297e00feca554e954ebaca93b"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "df_date_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\dim__date.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "table"}, "created_at": 1685959751.15733, "compiled_code": "\nSELECT\n  date_id\n  , month_id\n  , julian_date\n  , date_value\n  , date_formatted_name\n  , date_name\n  , year_id\n  , year_start_date\n  , year_end_date\n  , quarter_num\n  , quarter_name\n  , quarter_start_date\n  , quarter_end_date\n  , year_quarter_name\n  , month_num\n  , month_short_name\n  , month_long_name\n  , month_start_date\n  , month_end_date\n  , year_month_name_1\n  , year_month_num_1\n  , year_month_name_2\n  , year_month_num_2\n  , week_of_year_num\n  , week_of_month_num\n  , week_start_date\n  , week_end_date\n  , year_week_num\n  , year_week_name\n  , weekday_num\n  , weekday_name\n  , is_holiday\nFROM \n  oracle_bulanding.df_2.df_date_dim @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.dim__date"}, "model.dga_data_model.fct__agg_casa_bal_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.demanddeposit_master003 @DGA_READ_BULANDING_DBL", "model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__demanddeposit_master002"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__agg_casa_bal_daily"], "unique_id": "model.dga_data_model.fct__agg_casa_bal_daily", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}']\r\n    )\r\n}}\r\nWITH all_account AS (\r\n  SELECT\r\n    {{ var(\"date_id\") }} AS date_id\r\n    , account_number\r\n    , customer_number\r\n  FROM\r\n    {{ ref('stg_landing__demanddeposit_master001')}}\r\n  WHERE\r\n    date_opened <= {{ var('julian_date')}}\r\n)\r\n, bal_t_minus_1 AS (\r\n  SELECT /*+ parallel(demanddeposit_master002, 16) */\r\n      b.account_no AS account_number\r\n    , SUM(greatest(a.lcy_ledger_bal, 0)) AS eop_bal\r\n  FROM\r\n    {{ source('daily_bulanding', 'demanddeposit_master003 @DGA_READ_BULANDING_DBL') }} a\r\n    LEFT JOIN {{ ref('stg_landing__demanddeposit_master002')}} b ON a.account_no_sk = b.account_no_sk\r\n  WHERE\r\n    a.etl_date = {{ var('julian_date')}}\r\n  GROUP BY\r\n      a.etl_date\r\n    , b.account_no\r\n)\r\n, bal_last_month AS (\r\n  SELECT\r\n      account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id = {{ var('last_month_end_date')}}\r\n)\r\n, bal_lag_1_month AS (\r\n  SELECT\r\n    account_number\r\n  , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id = {{ var('lag_1_month')}}\r\n)\r\n, bal_lag_3_month AS (\r\n  SELECT\r\n      account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id = {{ var('lag_3_month')}}\r\n)\r\n, bal_lag_6_month AS (\r\n  SELECT\r\n      account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id = {{ var('lag_6_month')}}\r\n)\r\n, bal_lag_9_month AS (\r\n  SELECT\r\n      account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id = {{ var('lag_9_month')}}\r\n)\r\n, bal_lag_12_month AS (\r\n  SELECT\r\n      account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id = {{ var('lag_12_month')}}\r\n)\r\n, dat_casa_bal_avg_mtd AS (\r\n  SELECT\r\n      date_id\r\n    , account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id BETWEEN {{var(\"start_month_date\")}} AND {{ var(\"date_id\") }}\r\n  UNION ALL\r\n  SELECT\r\n      {{ var(\"date_id\") }}\r\n    , account_number\r\n    , eop_bal\r\n  FROM\r\n    bal_t_minus_1\r\n)\r\n, bal_avg_mtd AS (\r\n  SELECT\r\n    account_number\r\n  , round(AVG(eop_bal)) AS avg_bal_mtd\r\n  FROM\r\n    dat_casa_bal_avg_mtd\r\n  GROUP BY\r\n    account_number\r\n)\r\n, bal_sum_eop AS (\r\n  SELECT\r\n      account_number\r\n    , SUM(eop_bal) AS sum_eop_bal_mtd\r\n  FROM\r\n    dat_casa_bal_avg_mtd\r\n  GROUP BY\r\n    account_number\r\n)\r\n, sumup AS (\r\n  SELECT\r\n      a.date_id\r\n    , a.customer_number\r\n    , a.account_number\r\n    , COALESCE(b.eop_bal, 0) AS eop_bal\r\n    , COALESCE(c.eop_bal, 0) AS eop_bal_last_month\r\n    , COALESCE(d.eop_bal, 0) AS eop_bal_lag_1_month\r\n    , COALESCE(e.eop_bal, 0) AS eop_bal_lag_3_month\r\n    , COALESCE(f.eop_bal, 0) AS eop_bal_lag_6_month\r\n    , COALESCE(g.eop_bal, 0) AS eop_bal_lag_9_month\r\n    , COALESCE(h.eop_bal, 0) AS eop_bal_lag_12_month\r\n    , COALESCE(i.avg_bal_mtd, 0) AS avg_bal_mtd\r\n    , COALESCE(j.sum_eop_bal_mtd, 0) AS sum_eop_bal_mtd\r\n  FROM\r\n    all_account  a\r\n  LEFT JOIN bal_t_minus_1 b ON a.account_number = b.account_number\r\n  LEFT JOIN bal_last_month c ON a.account_number = c.account_number\r\n  LEFT JOIN bal_lag_1_month d ON a.account_number = d.account_number\r\n  LEFT JOIN bal_lag_3_month e ON a.account_number = e.account_number\r\n  LEFT JOIN bal_lag_6_month f ON a.account_number = f.account_number\r\n  LEFT JOIN bal_lag_9_month g ON a.account_number = g.account_number\r\n  LEFT JOIN bal_lag_12_month h ON a.account_number = h.account_number\r\n  LEFT JOIN bal_avg_mtd i ON a.account_number = i.account_number\r\n  LEFT JOIN bal_sum_eop j ON a.account_number = j.account_number\r\n)\r\n  SELECT * FROM sumup", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__agg_casa_bal_daily.sql", "original_file_path": "models\\mart\\daily\\fct__agg_casa_bal_daily.sql", "name": "fct__agg_casa_bal_daily", "alias": "fct__agg_casa_bal_daily", "checksum": {"name": "sha256", "checksum": "3860a85dd56fe1250be87e8ed3759986dcaff67a911226883e371df6c0b6a2de"}, "tags": ["pkg_daily"], "refs": [["stg_landing__demanddeposit_master001"], ["stg_landing__demanddeposit_master002"]], "sources": [["daily_bulanding", "demanddeposit_master003 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__agg_casa_bal_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}"]}, "created_at": 1685959752.8349795, "compiled_code": "\nWITH all_account AS (\n  SELECT\n    to_number(to_char(sysdate - 1, 'YYYYMMDD')) AS date_id\n    , account_number\n    , customer_number\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master001\n  WHERE\n    date_opened <= to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, bal_t_minus_1 AS (\n  SELECT /*+ parallel(demanddeposit_master002, 16) */\n      b.account_no AS account_number\n    , SUM(greatest(a.lcy_ledger_bal, 0)) AS eop_bal\n  FROM\n    oracle_bulanding.df_2.demanddeposit_master003 @DGA_READ_BULANDING_DBL a\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002 b ON a.account_no_sk = b.account_no_sk\n  WHERE\n    a.etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n  GROUP BY\n      a.etl_date\n    , b.account_no\n)\n, bal_last_month AS (\n  SELECT\n      account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id = to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'month')  - interval '1' day, 'YYYYMMDD'))\n)\n, bal_lag_1_month AS (\n  SELECT\n    account_number\n  , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 1), 'YYYYMMDD'))\n)\n, bal_lag_3_month AS (\n  SELECT\n      account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 3), 'YYYYMMDD'))\n)\n, bal_lag_6_month AS (\n  SELECT\n      account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 6), 'YYYYMMDD'))\n)\n, bal_lag_9_month AS (\n  SELECT\n      account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 9), 'YYYYMMDD'))\n)\n, bal_lag_12_month AS (\n  SELECT\n      account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 12), 'YYYYMMDD'))\n)\n, dat_casa_bal_avg_mtd AS (\n  SELECT\n      date_id\n    , account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily\n  WHERE\n    date_id BETWEEN to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'),'MM'), 'YYYYMMDD')) AND to_number(to_char(sysdate - 1, 'YYYYMMDD'))\n  UNION ALL\n  SELECT\n      to_number(to_char(sysdate - 1, 'YYYYMMDD'))\n    , account_number\n    , eop_bal\n  FROM\n    bal_t_minus_1\n)\n, bal_avg_mtd AS (\n  SELECT\n    account_number\n  , round(AVG(eop_bal)) AS avg_bal_mtd\n  FROM\n    dat_casa_bal_avg_mtd\n  GROUP BY\n    account_number\n)\n, bal_sum_eop AS (\n  SELECT\n      account_number\n    , SUM(eop_bal) AS sum_eop_bal_mtd\n  FROM\n    dat_casa_bal_avg_mtd\n  GROUP BY\n    account_number\n)\n, sumup AS (\n  SELECT\n      a.date_id\n    , a.customer_number\n    , a.account_number\n    , COALESCE(b.eop_bal, 0) AS eop_bal\n    , COALESCE(c.eop_bal, 0) AS eop_bal_last_month\n    , COALESCE(d.eop_bal, 0) AS eop_bal_lag_1_month\n    , COALESCE(e.eop_bal, 0) AS eop_bal_lag_3_month\n    , COALESCE(f.eop_bal, 0) AS eop_bal_lag_6_month\n    , COALESCE(g.eop_bal, 0) AS eop_bal_lag_9_month\n    , COALESCE(h.eop_bal, 0) AS eop_bal_lag_12_month\n    , COALESCE(i.avg_bal_mtd, 0) AS avg_bal_mtd\n    , COALESCE(j.sum_eop_bal_mtd, 0) AS sum_eop_bal_mtd\n  FROM\n    all_account  a\n  LEFT JOIN bal_t_minus_1 b ON a.account_number = b.account_number\n  LEFT JOIN bal_last_month c ON a.account_number = c.account_number\n  LEFT JOIN bal_lag_1_month d ON a.account_number = d.account_number\n  LEFT JOIN bal_lag_3_month e ON a.account_number = e.account_number\n  LEFT JOIN bal_lag_6_month f ON a.account_number = f.account_number\n  LEFT JOIN bal_lag_9_month g ON a.account_number = g.account_number\n  LEFT JOIN bal_lag_12_month h ON a.account_number = h.account_number\n  LEFT JOIN bal_avg_mtd i ON a.account_number = i.account_number\n  LEFT JOIN bal_sum_eop j ON a.account_number = j.account_number\n)\n  SELECT * FROM sumup", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily"}, "model.dga_data_model.fct__agg_casa_txn_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fct__trans_casa"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__agg_casa_txn_daily"], "unique_id": "model.dga_data_model.fct__agg_casa_txn_daily", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        pre_hook=['DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}']\r\n    )\r\n}}\r\nWITH dat_result AS (\r\n  SELECT\r\n      to_char(to_date(trn_date, 'YYYYDDD'), 'YYYYMM') AS month_id\r\n    , to_char(to_date(trn_date, 'YYYYDDD'), 'YYYYMMDD') AS date_id\r\n    , customer_number\r\n    , account_no AS account_number\r\n    , trn_date AS transaction_date\r\n    , dorc_ind AS debit_credit_code\r\n    , channel_level1\r\n    , channel_level2\r\n    , SUM(lcy_amount) AS sum_lcy_txn_amount\r\n    , COUNT(*) AS count_txn\r\n  FROM\r\n    {{ ref('fct__trans_casa')}}\r\n  GROUP BY\r\n      month_id\r\n    , date_id\r\n    , customer_number\r\n    , account_no\r\n    , trn_date\r\n    , dorc_ind\r\n    , channel_level1\r\n    , channel_level2\r\n)\r\n  SELECT\r\n    *\r\n  FROM\r\n    dat_result", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__agg_casa_txn_daily.sql", "original_file_path": "models\\mart\\daily\\fct__agg_casa_txn_daily.sql", "name": "fct__agg_casa_txn_daily", "alias": "fct__agg_casa_txn_daily", "checksum": {"name": "sha256", "checksum": "b8acf033b535af67e104c4eedeb246f3b512b4a7f203b479c6735b7fcf0c0cce"}, "tags": ["pkg_daily"], "refs": [["fct__trans_casa"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__agg_casa_txn_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}"]}, "created_at": 1685959752.8379784, "compiled_code": "\nWITH dat_result AS (\n  SELECT\n      to_char(to_date(trn_date, 'YYYYDDD'), 'YYYYMM') AS month_id\n    , to_char(to_date(trn_date, 'YYYYDDD'), 'YYYYMMDD') AS date_id\n    , customer_number\n    , account_no AS account_number\n    , trn_date AS transaction_date\n    , dorc_ind AS debit_credit_code\n    , channel_level1\n    , channel_level2\n    , SUM(lcy_amount) AS sum_lcy_txn_amount\n    , COUNT(*) AS count_txn\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__trans_casa\n  GROUP BY\n      month_id\n    , date_id\n    , customer_number\n    , account_no\n    , trn_date\n    , dorc_ind\n    , channel_level1\n    , channel_level2\n)\n  SELECT\n    *\n  FROM\n    dat_result", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_casa_txn_daily"}, "model.dga_data_model.fct__agg_fd_bal_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_landing__fixeddeposit_master003"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__agg_fd_bal_daily"], "unique_id": "model.dga_data_model.fct__agg_fd_bal_daily", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}']\r\n    )\r\n}}\r\nWITH acc_cus AS (\r\n  SELECT DISTINCT\r\n      account_no AS account_number\r\n    , customer_no AS customer_number\r\n    , RANK() OVER(PARTITION BY account_no ORDER BY etl_date DESC) AS rn\r\n  FROM {{ ref('stg_landing__fixeddeposit_master003')}}\r\n  WHERE\r\n    etl_date BETWEEN {{ var('start_month_julian_date')}} AND {{ var('julian_date')}}\r\n)\r\n, expired_fd_ac AS (\r\n  SELECT\r\n    account_number\r\n    , customer_number\r\n  FROM acc_cus\r\n  WHERE\r\n    rn = 1\r\n  MINUS\r\n  SELECT DISTINCT\r\n    account_no,\r\n    customer_no AS customer_number\r\n  FROM {{ ref('stg_landing__fixeddeposit_master003')}}\r\n  WHERE\r\n    etl_date = {{ var('julian_date')}}\r\n)\r\n, dat_fd_bal  AS (\r\n  SELECT\r\n    {{ var(\"date_id\") }} AS date_id\r\n    , customer_no AS customer_number\r\n    , account_no AS account_number\r\n    , lcy_ledger_bal AS eop_bal\r\n  FROM\r\n    {{ ref('stg_landing__fixeddeposit_master003')}}\r\n  WHERE\r\n    etl_date = {{ var('julian_date')}}\r\n  UNION\r\n  SELECT\r\n      {{ var(\"date_id\") }} AS date_id\r\n    , customer_number\r\n    , account_number\r\n    , 0 AS eop_bal\r\n  FROM expired_fd_ac  efa\r\n)\r\n, dat_fd_bal_last_month AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_fd_bal a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('last_month_end_date')}}\r\n)\r\n, dat_fd_bal_lag_1_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_fd_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_1_month')}}\r\n)\r\n, dat_fd_bal_lag_3_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_fd_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_3_month')}}\r\n)\r\n, dat_fd_bal_lag_6_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_fd_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_6_month')}}\r\n)\r\n, dat_fd_bal_lag_9_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_fd_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_9_month')}}\r\n)\r\n, dat_fd_bal_lag_12_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_fd_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_12_month')}}\r\n)\r\n, dat_fd_bal_sum_eop_mtd_1 AS (\r\n  SELECT\r\n      to_number(to_char(to_date(etl_date, 'YYYYDDD'), 'YYYYMMDD')) AS date_id\r\n    , account_no AS account_number\r\n    , lcy_ledger_bal AS eop_bal\r\n  FROM\r\n    {{ ref('stg_landing__fixeddeposit_master003')}}\r\n  WHERE\r\n      etl_date BETWEEN {{var(\"start_month_julian_date\")}} AND {{ var(\"julian_date\") }}\r\n)\r\n, dat_fd_bal_sum_eop_mtd AS (\r\n  SELECT\r\n      account_number\r\n    , SUM(eop_bal) AS sum_eop_bal_mtd\r\n  FROM\r\n      dat_fd_bal_sum_eop_mtd_1\r\n  GROUP BY\r\n    account_number\r\n)\r\n, sumup AS (\r\n  SELECT\r\n      a.date_id\r\n    , a.customer_number\r\n    , a.account_number\r\n    , COALESCE(a.eop_bal, 0) AS eop_bal\r\n    , COALESCE(b.eop_bal, 0) AS eop_bal_last_month\r\n    , COALESCE(c.eop_bal, 0) AS eop_bal_lag_1_month\r\n    , COALESCE(d.eop_bal, 0) AS eop_bal_lag_3_month\r\n    , COALESCE(e.eop_bal, 0) AS eop_bal_lag_6_month\r\n    , COALESCE(f.eop_bal, 0) AS eop_bal_lag_9_month\r\n    , COALESCE(g.eop_bal, 0) AS eop_bal_lag_12_month\r\n    , COALESCE(h.sum_eop_bal_mtd, 0) AS sum_eop_bal_mtd\r\n  FROM\r\n    dat_fd_bal             a\r\n  LEFT JOIN dat_fd_bal_last_month b ON a.account_number = b.account_number\r\n  LEFT JOIN dat_fd_bal_lag_1_mth c ON a.account_number = c.account_number\r\n  LEFT JOIN dat_fd_bal_lag_3_mth d ON a.account_number = d.account_number\r\n  LEFT JOIN dat_fd_bal_lag_6_mth e ON a.account_number = e.account_number\r\n  LEFT JOIN dat_fd_bal_lag_9_mth f ON a.account_number = f.account_number\r\n  LEFT JOIN dat_fd_bal_lag_12_mth g ON a.account_number = g.account_number\r\n  LEFT JOIN dat_fd_bal_sum_eop_mtd h ON a.account_number = h.account_number\r\n)\r\n  SELECT * FROM sumup", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__agg_fd_bal_daily.sql", "original_file_path": "models\\mart\\daily\\fct__agg_fd_bal_daily.sql", "name": "fct__agg_fd_bal_daily", "alias": "fct__agg_fd_bal_daily", "checksum": {"name": "sha256", "checksum": "50e1c1607bad82b177f33de10c93269423f000730f51df7010b8ca86e385fdd6"}, "tags": ["pkg_daily"], "refs": [["stg_landing__fixeddeposit_master003"], ["stg_landing__fixeddeposit_master003"], ["stg_landing__fixeddeposit_master003"], ["stg_landing__fixeddeposit_master003"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__agg_fd_bal_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}"]}, "created_at": 1685959752.8419907, "compiled_code": "\nWITH acc_cus AS (\n  SELECT DISTINCT\n      account_no AS account_number\n    , customer_no AS customer_number\n    , RANK() OVER(PARTITION BY account_no ORDER BY etl_date DESC) AS rn\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003\n  WHERE\n    etl_date BETWEEN to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'),'MM'), 'YYYYDDD')) AND to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, expired_fd_ac AS (\n  SELECT\n    account_number\n    , customer_number\n  FROM acc_cus\n  WHERE\n    rn = 1\n  MINUS\n  SELECT DISTINCT\n    account_no,\n    customer_no AS customer_number\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003\n  WHERE\n    etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, dat_fd_bal  AS (\n  SELECT\n    to_number(to_char(sysdate - 1, 'YYYYMMDD')) AS date_id\n    , customer_no AS customer_number\n    , account_no AS account_number\n    , lcy_ledger_bal AS eop_bal\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003\n  WHERE\n    etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n  UNION\n  SELECT\n      to_number(to_char(sysdate - 1, 'YYYYMMDD')) AS date_id\n    , customer_number\n    , account_number\n    , 0 AS eop_bal\n  FROM expired_fd_ac  efa\n)\n, dat_fd_bal_last_month AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_fd_bal a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'month')  - interval '1' day, 'YYYYMMDD'))\n)\n, dat_fd_bal_lag_1_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_fd_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 1), 'YYYYMMDD'))\n)\n, dat_fd_bal_lag_3_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_fd_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 3), 'YYYYMMDD'))\n)\n, dat_fd_bal_lag_6_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_fd_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 6), 'YYYYMMDD'))\n)\n, dat_fd_bal_lag_9_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_fd_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 9), 'YYYYMMDD'))\n)\n, dat_fd_bal_lag_12_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_fd_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 12), 'YYYYMMDD'))\n)\n, dat_fd_bal_sum_eop_mtd_1 AS (\n  SELECT\n      to_number(to_char(to_date(etl_date, 'YYYYDDD'), 'YYYYMMDD')) AS date_id\n    , account_no AS account_number\n    , lcy_ledger_bal AS eop_bal\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003\n  WHERE\n      etl_date BETWEEN to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'),'MM'), 'YYYYDDD')) AND to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, dat_fd_bal_sum_eop_mtd AS (\n  SELECT\n      account_number\n    , SUM(eop_bal) AS sum_eop_bal_mtd\n  FROM\n      dat_fd_bal_sum_eop_mtd_1\n  GROUP BY\n    account_number\n)\n, sumup AS (\n  SELECT\n      a.date_id\n    , a.customer_number\n    , a.account_number\n    , COALESCE(a.eop_bal, 0) AS eop_bal\n    , COALESCE(b.eop_bal, 0) AS eop_bal_last_month\n    , COALESCE(c.eop_bal, 0) AS eop_bal_lag_1_month\n    , COALESCE(d.eop_bal, 0) AS eop_bal_lag_3_month\n    , COALESCE(e.eop_bal, 0) AS eop_bal_lag_6_month\n    , COALESCE(f.eop_bal, 0) AS eop_bal_lag_9_month\n    , COALESCE(g.eop_bal, 0) AS eop_bal_lag_12_month\n    , COALESCE(h.sum_eop_bal_mtd, 0) AS sum_eop_bal_mtd\n  FROM\n    dat_fd_bal             a\n  LEFT JOIN dat_fd_bal_last_month b ON a.account_number = b.account_number\n  LEFT JOIN dat_fd_bal_lag_1_mth c ON a.account_number = c.account_number\n  LEFT JOIN dat_fd_bal_lag_3_mth d ON a.account_number = d.account_number\n  LEFT JOIN dat_fd_bal_lag_6_mth e ON a.account_number = e.account_number\n  LEFT JOIN dat_fd_bal_lag_9_mth f ON a.account_number = f.account_number\n  LEFT JOIN dat_fd_bal_lag_12_mth g ON a.account_number = g.account_number\n  LEFT JOIN dat_fd_bal_sum_eop_mtd h ON a.account_number = h.account_number\n)\n  SELECT * FROM sumup", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily"}, "model.dga_data_model.fct__agg_ln_bal_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_dwh__lnft_master", "model.dga_data_model.stg_landing__loan_master001_2020001_2021212", "model.dga_data_model.stg_dwh__loan_master001", "model.dga_data_model.stg_landing__customer_master002"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }} WHERE date_id = {{ var(\"date_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__agg_ln_bal_daily"], "unique_id": "model.dga_data_model.fct__agg_ln_bal_daily", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }} WHERE date_id = {{ var(\"date_id\") }}']\r\n    )\r\n}}\r\nWITH loan_master_bal AS (\r\n  SELECT\r\n      *\r\n  FROM\r\n    {{ ref('stg_dwh__lnft_master')}}\r\n  UNION ALL\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('stg_landing__loan_master001_2020001_2021212')}}\r\n)\r\n, dat_ln_bal AS (\r\n  SELECT DISTINCT\r\n      {{ var(\"date_id\") }}  AS date_id\r\n    , c.customer_number\r\n    , b.account_no AS account_number\r\n    , a.status\r\n    , a.lcy_outstanding_bal AS eop_bal\r\n  FROM\r\n    loan_master_bal     a\r\n  LEFT JOIN {{ ref('stg_dwh__loan_master001')}} b ON a.account_no_sk = b.account_no_sk\r\n  LEFT JOIN {{ ref('stg_landing__customer_master002')}} c ON a.customer_sk = c.customer_sk\r\n  WHERE\r\n    a.etl_date = {{ var('julian_date')}}\r\n)\r\n, dat_ln_bal_sum_eop_mtd_1 AS (\r\n  SELECT\r\n      date_id\r\n    , account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id BETWEEN {{ var('start_month_date')}} AND {{ var(\"date_id\") }}\r\n  UNION ALL\r\n  SELECT\r\n      {{ var(\"date_id\") }} AS date_id\r\n    , account_number\r\n    , eop_bal\r\n  FROM\r\n    dat_ln_bal\r\n)\r\n, dat_od_bal_sum_eop_mtd AS (\r\n  SELECT\r\n      account_number\r\n    , SUM(eop_bal) AS sum_eop_bal_mtd\r\n  FROM\r\n    dat_ln_bal_sum_eop_mtd_1\r\n  GROUP BY\r\n    account_number\r\n)\r\n, sumup AS (\r\n  SELECT\r\n      a.date_id\r\n    , a.customer_number\r\n    , a.account_number\r\n    , a.status\r\n    , a.eop_bal\r\n    , b.sum_eop_bal_mtd\r\n  FROM\r\n    dat_ln_bal a\r\n  LEFT JOIN dat_od_bal_sum_eop_mtd b ON a.account_number = b.account_number\r\n)\r\nSELECT * FROM sumup", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__agg_ln_bal_daily.sql", "original_file_path": "models\\mart\\daily\\fct__agg_ln_bal_daily.sql", "name": "fct__agg_ln_bal_daily", "alias": "fct__agg_ln_bal_daily", "checksum": {"name": "sha256", "checksum": "77e060cc0893fc360a721396388717342feae654035eb65a24ccd97dd35ed18b"}, "tags": ["pkg_daily"], "refs": [["stg_dwh__lnft_master"], ["stg_landing__loan_master001_2020001_2021212"], ["stg_dwh__loan_master001"], ["stg_landing__customer_master002"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__agg_ln_bal_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }} WHERE date_id = {{ var(\"date_id\") }}"]}, "created_at": 1685959752.8459873, "compiled_code": "\nWITH loan_master_bal AS (\n  SELECT\n      *\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_dwh__lnft_master\n  UNION ALL\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__loan_master001_2020001_2021212\n)\n, dat_ln_bal AS (\n  SELECT DISTINCT\n      to_number(to_char(sysdate - 1, 'YYYYMMDD'))  AS date_id\n    , c.customer_number\n    , b.account_no AS account_number\n    , a.status\n    , a.lcy_outstanding_bal AS eop_bal\n  FROM\n    loan_master_bal     a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__loan_master001 b ON a.account_no_sk = b.account_no_sk\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__customer_master002 c ON a.customer_sk = c.customer_sk\n  WHERE\n    a.etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, dat_ln_bal_sum_eop_mtd_1 AS (\n  SELECT\n      date_id\n    , account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_ln_bal_daily\n  WHERE\n    date_id BETWEEN to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'),'MM'), 'YYYYMMDD')) AND to_number(to_char(sysdate - 1, 'YYYYMMDD'))\n  UNION ALL\n  SELECT\n      to_number(to_char(sysdate - 1, 'YYYYMMDD')) AS date_id\n    , account_number\n    , eop_bal\n  FROM\n    dat_ln_bal\n)\n, dat_od_bal_sum_eop_mtd AS (\n  SELECT\n      account_number\n    , SUM(eop_bal) AS sum_eop_bal_mtd\n  FROM\n    dat_ln_bal_sum_eop_mtd_1\n  GROUP BY\n    account_number\n)\n, sumup AS (\n  SELECT\n      a.date_id\n    , a.customer_number\n    , a.account_number\n    , a.status\n    , a.eop_bal\n    , b.sum_eop_bal_mtd\n  FROM\n    dat_ln_bal a\n  LEFT JOIN dat_od_bal_sum_eop_mtd b ON a.account_number = b.account_number\n)\nSELECT * FROM sumup", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_ln_bal_daily"}, "model.dga_data_model.fct__agg_od_bal_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_dwh__crtb_odtier"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__agg_od_bal_daily"], "unique_id": "model.dga_data_model.fct__agg_od_bal_daily", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}']\r\n    )\r\n}}\r\nWITH dat_od_bal_rn AS (\r\n  SELECT\r\n      etl_date\r\n    , seq_number\r\n    , rate_number\r\n    , author_limit_amount\r\n    , customer_no\r\n    , account_no\r\n    , balance\r\n    , ROW_NUMBER() OVER(PARTITION BY account_no ORDER BY expiration_date DESC, agreement_date DESC, seq_number DESC) AS rn\r\n  FROM\r\n    {{ ref('stg_dwh__crtb_odtier')}}\r\n  WHERE\r\n    etl_date = {{ var('julian_date')}}\r\n)\r\n, dat_od_bal AS (\r\n  SELECT\r\n      {{ var(\"date_id\") }} AS date_id\r\n    , rate_number\r\n    , author_limit_amount\r\n    , customer_no AS customer_number\r\n    , account_no  AS account_number\r\n    , balance     AS eop_bal\r\n  FROM\r\n    dat_od_bal_rn\r\n  WHERE\r\n    rn = 1\r\n)\r\n, dat_od_bal_last_month AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n      dat_od_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('last_month_end_date')}}\r\n)\r\n, dat_od_bal_lag_1_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_od_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_1_month')}}\r\n)\r\n, dat_od_bal_lag_3_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_od_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_3_month')}}\r\n)\r\n, dat_od_bal_lag_6_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_od_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_6_month')}}\r\n)\r\n, dat_od_bal_lag_9_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_od_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_9_month')}}\r\n)\r\n, dat_od_bal_lag_12_mth AS (\r\n  SELECT\r\n      a.account_number\r\n    , b.eop_bal\r\n  FROM\r\n    dat_od_bal              a\r\n  LEFT JOIN {{ this }} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('lag_12_month')}}\r\n)\r\n, dat_od_bal_sum_eop_mtd_1 AS (\r\n  SELECT\r\n      date_id\r\n    , account_number\r\n    , eop_bal\r\n  FROM\r\n    {{ this }}\r\n  WHERE\r\n    date_id BETWEEN {{ var('start_month_date')}} AND {{ var(\"date_id\") }}\r\n  UNION ALL\r\n  SELECT\r\n      {{ var(\"date_id\") }}\r\n    , account_number\r\n    , eop_bal\r\n  FROM\r\n    dat_od_bal\r\n)\r\n, dat_od_bal_sum_eop_mtd AS (\r\n  SELECT\r\n      account_number\r\n    , SUM(eop_bal) AS sum_eop_bal_mtd\r\n  FROM\r\n    dat_od_bal_sum_eop_mtd_1\r\n  GROUP BY\r\n    account_number\r\n)\r\n, sumup AS (\r\n  SELECT\r\n      a.date_id\r\n    , a.customer_number\r\n    , a.account_number\r\n    , a.rate_number\r\n    , a.author_limit_amount\r\n    , COALESCE(a.eop_bal, 0) AS eop_bal\r\n    , COALESCE(b.eop_bal, 0) AS eop_bal_last_month\r\n    , COALESCE(c.eop_bal, 0) AS eop_bal_lag_1_month\r\n    , COALESCE(d.eop_bal, 0) AS eop_bal_lag_3_month\r\n    , COALESCE(e.eop_bal, 0) AS eop_bal_lag_6_month\r\n    , COALESCE(f.eop_bal, 0) AS eop_bal_lag_9_month\r\n    , COALESCE(g.eop_bal, 0) AS eop_bal_lag_12_month\r\n    , COALESCE(h.sum_eop_bal_mtd, 0) AS sum_eop_bal_mtd\r\n  FROM\r\n    dat_od_bal                     a\r\n  LEFT JOIN dat_od_bal_last_month b ON a.account_number = b.account_number\r\n  LEFT JOIN dat_od_bal_lag_1_mth c ON a.account_number = c.account_number\r\n  LEFT JOIN dat_od_bal_lag_3_mth d ON a.account_number = d.account_number\r\n  LEFT JOIN dat_od_bal_lag_6_mth e ON a.account_number = e.account_number\r\n  LEFT JOIN dat_od_bal_lag_9_mth f ON a.account_number = f.account_number\r\n  LEFT JOIN dat_od_bal_lag_12_mth g ON a.account_number = g.account_number\r\n  LEFT JOIN dat_od_bal_sum_eop_mtd h ON a.account_number = h.account_number\r\n)\r\nSELECT * FROM sumup", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__agg_od_bal_daily.sql", "original_file_path": "models\\mart\\daily\\fct__agg_od_bal_daily.sql", "name": "fct__agg_od_bal_daily", "alias": "fct__agg_od_bal_daily", "checksum": {"name": "sha256", "checksum": "cb4e3d72f56381196590c0fbce2a9dda898ea9782e81f79f65d34c7e3a6e3940"}, "tags": ["pkg_daily"], "refs": [["stg_dwh__crtb_odtier"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__agg_od_bal_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}"]}, "created_at": 1685959752.8499079, "compiled_code": "\nWITH dat_od_bal_rn AS (\n  SELECT\n      etl_date\n    , seq_number\n    , rate_number\n    , author_limit_amount\n    , customer_no\n    , account_no\n    , balance\n    , ROW_NUMBER() OVER(PARTITION BY account_no ORDER BY expiration_date DESC, agreement_date DESC, seq_number DESC) AS rn\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_dwh__crtb_odtier\n  WHERE\n    etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, dat_od_bal AS (\n  SELECT\n      to_number(to_char(sysdate - 1, 'YYYYMMDD')) AS date_id\n    , rate_number\n    , author_limit_amount\n    , customer_no AS customer_number\n    , account_no  AS account_number\n    , balance     AS eop_bal\n  FROM\n    dat_od_bal_rn\n  WHERE\n    rn = 1\n)\n, dat_od_bal_last_month AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n      dat_od_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'month')  - interval '1' day, 'YYYYMMDD'))\n)\n, dat_od_bal_lag_1_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_od_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 1), 'YYYYMMDD'))\n)\n, dat_od_bal_lag_3_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_od_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 3), 'YYYYMMDD'))\n)\n, dat_od_bal_lag_6_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_od_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 6), 'YYYYMMDD'))\n)\n, dat_od_bal_lag_9_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_od_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 9), 'YYYYMMDD'))\n)\n, dat_od_bal_lag_12_mth AS (\n  SELECT\n      a.account_number\n    , b.eop_bal\n  FROM\n    dat_od_bal              a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(add_months(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), - 12), 'YYYYMMDD'))\n)\n, dat_od_bal_sum_eop_mtd_1 AS (\n  SELECT\n      date_id\n    , account_number\n    , eop_bal\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily\n  WHERE\n    date_id BETWEEN to_number(to_char(trunc(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'),'MM'), 'YYYYMMDD')) AND to_number(to_char(sysdate - 1, 'YYYYMMDD'))\n  UNION ALL\n  SELECT\n      to_number(to_char(sysdate - 1, 'YYYYMMDD'))\n    , account_number\n    , eop_bal\n  FROM\n    dat_od_bal\n)\n, dat_od_bal_sum_eop_mtd AS (\n  SELECT\n      account_number\n    , SUM(eop_bal) AS sum_eop_bal_mtd\n  FROM\n    dat_od_bal_sum_eop_mtd_1\n  GROUP BY\n    account_number\n)\n, sumup AS (\n  SELECT\n      a.date_id\n    , a.customer_number\n    , a.account_number\n    , a.rate_number\n    , a.author_limit_amount\n    , COALESCE(a.eop_bal, 0) AS eop_bal\n    , COALESCE(b.eop_bal, 0) AS eop_bal_last_month\n    , COALESCE(c.eop_bal, 0) AS eop_bal_lag_1_month\n    , COALESCE(d.eop_bal, 0) AS eop_bal_lag_3_month\n    , COALESCE(e.eop_bal, 0) AS eop_bal_lag_6_month\n    , COALESCE(f.eop_bal, 0) AS eop_bal_lag_9_month\n    , COALESCE(g.eop_bal, 0) AS eop_bal_lag_12_month\n    , COALESCE(h.sum_eop_bal_mtd, 0) AS sum_eop_bal_mtd\n  FROM\n    dat_od_bal                     a\n  LEFT JOIN dat_od_bal_last_month b ON a.account_number = b.account_number\n  LEFT JOIN dat_od_bal_lag_1_mth c ON a.account_number = c.account_number\n  LEFT JOIN dat_od_bal_lag_3_mth d ON a.account_number = d.account_number\n  LEFT JOIN dat_od_bal_lag_6_mth e ON a.account_number = e.account_number\n  LEFT JOIN dat_od_bal_lag_9_mth f ON a.account_number = f.account_number\n  LEFT JOIN dat_od_bal_lag_12_mth g ON a.account_number = g.account_number\n  LEFT JOIN dat_od_bal_sum_eop_mtd h ON a.account_number = h.account_number\n)\nSELECT * FROM sumup", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily"}, "model.dga_data_model.fct__trans_card": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.dga_data_model.stg_landing__card_currency", "model.dga_data_model.stg_landing__card_m_transaction", "model.dga_data_model.stg_landing__way4_trans_type", "model.dga_data_model.stg_landing__card_doc", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.int_way4__card", "model.dga_data_model.stg__card_acnt_contract_plus"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "posting_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__trans_card"], "unique_id": "model.dga_data_model.fct__trans_card", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n        unique_key='id',\r\n    )\r\n}}\r\nWITH cte_currency AS (\r\n  SELECT\r\n    code\r\n    , name AS currency\r\n  FROM\r\n    {{ ref('stg_landing__card_currency')}}\r\n  WHERE\r\n    amnd_state = 'A'\r\n)\r\n, cte_card_m_transaction AS (\r\n  SELECT\r\n    doc__oid\r\n    , SUM(local_amount) as local_amount\r\n  FROM\r\n    {{ ref('stg_landing__card_m_transaction')}}\r\n  WHERE\r\n    service_class = 'T'\r\n    AND entry_type IN ('B','S')\r\n    AND posting_date = to_date(20230501, 'YYYYMMDD')\r\n--     {% if is_incremental() %}\r\n--     AND posting_date >= (SELECT max(posting_date) FROM {{ this }})\r\n--     {% endif %}\r\n  GROUP BY doc__oid\r\n)\r\n, way4_type AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('stg_landing__way4_trans_type')}}\r\n  WHERE\r\n    amnd_state = 'A'\r\n)\r\n  SELECT\r\n    doc.id\r\n    ,doc.amnd_date\r\n    ,doc.posting_date\r\n    ,doc.transaction_date\r\n    ,doc.is_authorization\r\n    ,doc.posting_status\r\n    ,doc.request_category\r\n    ,doc.return_code\r\n    ,doc.merchant_id\r\n    ,doc.doc__orig__id\r\n    ,doc.ret_ref_number\r\n    ,settlement_amount\r\n    ,cur_settle.currency AS settlement_currency\r\n    ,doc.transaction_amount\r\n    ,cur_trans.currency  AS transaction_currency\r\n    ,mt.local_amount AS txn_amt_lcy\r\n    ,sic_code\r\n    ,scnl.channel_desc AS src_cnl\r\n    ,tcnl.channel_desc AS trg_cnl\r\n    ,doc.source_member_id\r\n    ,doc.source_number\r\n    ,doc.source_reg_num\r\n    ,doc.trans_condition\r\n    ,doc.target_contract\r\n    ,doc.target_number\r\n    ,doc.transaction_city\r\n    ,doc.transaction_country\r\n    ,doc.transaction_location\r\n    ,tp.name AS trans_type\r\n    ,tp.dr_cr\r\n    ,cntr.type_of_card\r\n    ,doc.source_code\r\n    ,doc.outward_status\r\n    ,doc.service_class\r\n    ,CASE\r\n        WHEN tp.name = 'ATM' THEN 'ATM'\r\n        WHEN doc.trans_condition IN ('NMR2','NMR','NMO2','NNK','NMO','NMN','PET','TET','PES','TES'\r\n                                    ,'NEV2','TEV2','NEV','TEV','NEU2','TEU2','NEU','TEU','SEU') THEN 'Online'\r\n        WHEN doc.trans_condition IN ('POSL','POSK','POEL','POEK','PO1L','PO1K','POTL','POTK','POUL','POUK'\r\n                                    ,'POVL','POVK') THEN 'POS'\r\n        ELSE 'Others'\r\n      END AS trans_channel\r\n    , cntr.card_id\r\n    , acnt.acnt_contract__oid\r\n    , nvl(acnt.ACNT_CONTRACT__ID,doc.target_contract) AS acnt_contract__id\r\n  FROM\r\n    {{ ref('stg_landing__card_doc')}} doc\r\n  JOIN way4_type tp ON doc.transaction_type = tp.id\r\n  LEFT JOIN {{ ref('stg_landing__df_card_channel')}} scnl ON doc.source_channel = scnl.channel_code\r\n  LEFT JOIN {{ ref('stg_landing__df_card_channel')}} tcnl ON doc.target_channel = tcnl.channel_code\r\n  JOIN {{ ref('int_way4__card')}} cntr ON doc.target_number = cntr.contract_number\r\n  LEFT JOIN cte_currency cur_trans ON doc.transaction_currency = cur_trans.code\r\n  LEFT JOIN cte_currency cur_settle ON doc.settlement_currency = cur_settle.code\r\n  LEFT JOIN cte_card_m_transaction mt ON doc.id = mt.doc__oid\r\n  LEFT JOIN {{ ref('stg__card_acnt_contract_plus')}} acnt ON doc.target_contract = acnt.id AND acnt.AMND_STATE = 'A'\r\n  WHERE\r\n    doc.is_authorization = 'N'\r\n    AND doc.posting_status = 'P'\r\n    AND tp.name IN ('Retail','ATM','Cash','Unique')\r\n    AND doc.posting_date = to_date(20230501, 'YYYYMMDD')\r\n--     {% if is_incremental() %}\r\n--     AND doc.posting_date >= (SELECT max(posting_date) FROM {{ this }})\r\n--     {% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__trans_card.sql", "original_file_path": "models\\mart\\daily\\fct__trans_card.sql", "name": "fct__trans_card", "alias": "fct__trans_card", "checksum": {"name": "sha256", "checksum": "ac0ab17acbe7c333b6a2f9602bcbc15058776dc48aab59d4c6273c78b58b0951"}, "tags": ["pkg_daily"], "refs": [["stg_landing__card_currency"], ["stg_landing__card_m_transaction"], ["stg_landing__way4_trans_type"], ["stg_landing__card_doc"], ["stg_landing__df_card_channel"], ["stg_landing__df_card_channel"], ["int_way4__card"], ["stg__card_acnt_contract_plus"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "posting_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__trans_card.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "posting_date"}, "tags": "pkg_daily", "materialized": "table", "unique_key": "id"}, "created_at": 1685959752.8509905, "compiled_code": "\nWITH cte_currency AS (\n  SELECT\n    code\n    , name AS currency\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_currency\n  WHERE\n    amnd_state = 'A'\n)\n, cte_card_m_transaction AS (\n  SELECT\n    doc__oid\n    , SUM(local_amount) as local_amount\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_m_transaction\n  WHERE\n    service_class = 'T'\n    AND entry_type IN ('B','S')\n    AND posting_date = to_date(20230501, 'YYYYMMDD')\n--     \n  GROUP BY doc__oid\n)\n, way4_type AS (\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__way4_trans_type\n  WHERE\n    amnd_state = 'A'\n)\n  SELECT\n    doc.id\n    ,doc.amnd_date\n    ,doc.posting_date\n    ,doc.transaction_date\n    ,doc.is_authorization\n    ,doc.posting_status\n    ,doc.request_category\n    ,doc.return_code\n    ,doc.merchant_id\n    ,doc.doc__orig__id\n    ,doc.ret_ref_number\n    ,settlement_amount\n    ,cur_settle.currency AS settlement_currency\n    ,doc.transaction_amount\n    ,cur_trans.currency  AS transaction_currency\n    ,mt.local_amount AS txn_amt_lcy\n    ,sic_code\n    ,scnl.channel_desc AS src_cnl\n    ,tcnl.channel_desc AS trg_cnl\n    ,doc.source_member_id\n    ,doc.source_number\n    ,doc.source_reg_num\n    ,doc.trans_condition\n    ,doc.target_contract\n    ,doc.target_number\n    ,doc.transaction_city\n    ,doc.transaction_country\n    ,doc.transaction_location\n    ,tp.name AS trans_type\n    ,tp.dr_cr\n    ,cntr.type_of_card\n    ,doc.source_code\n    ,doc.outward_status\n    ,doc.service_class\n    ,CASE\n        WHEN tp.name = 'ATM' THEN 'ATM'\n        WHEN doc.trans_condition IN ('NMR2','NMR','NMO2','NNK','NMO','NMN','PET','TET','PES','TES'\n                                    ,'NEV2','TEV2','NEV','TEV','NEU2','TEU2','NEU','TEU','SEU') THEN 'Online'\n        WHEN doc.trans_condition IN ('POSL','POSK','POEL','POEK','PO1L','PO1K','POTL','POTK','POUL','POUK'\n                                    ,'POVL','POVK') THEN 'POS'\n        ELSE 'Others'\n      END AS trans_channel\n    , cntr.card_id\n    , acnt.acnt_contract__oid\n    , nvl(acnt.ACNT_CONTRACT__ID,doc.target_contract) AS acnt_contract__id\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_doc doc\n  JOIN way4_type tp ON doc.transaction_type = tp.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_card_channel scnl ON doc.source_channel = scnl.channel_code\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_card_channel tcnl ON doc.target_channel = tcnl.channel_code\n  JOIN \"oracle_dgaworkzone\".int.int_way4__card cntr ON doc.target_number = cntr.contract_number\n  LEFT JOIN cte_currency cur_trans ON doc.transaction_currency = cur_trans.code\n  LEFT JOIN cte_currency cur_settle ON doc.settlement_currency = cur_settle.code\n  LEFT JOIN cte_card_m_transaction mt ON doc.id = mt.doc__oid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__card_acnt_contract_plus acnt ON doc.target_contract = acnt.id AND acnt.AMND_STATE = 'A'\n  WHERE\n    doc.is_authorization = 'N'\n    AND doc.posting_status = 'P'\n    AND tp.name IN ('Retail','ATM','Cash','Unique')\n    AND doc.posting_date = to_date(20230501, 'YYYYMMDD')\n--     ", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__trans_card"}, "model.dga_data_model.fct__trans_casa": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_dwh__demanddeposit_transaction001", "model.dga_data_model.stg_landing__df_casa_channel_trn_type", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.int__casa_account", "model.dga_data_model.stg_dwh__csdm_transaction_code", "model.dga_data_model.stg_dwh__dddm_product", "model.dga_data_model.stg_dwh__csdm_branch", "model.dga_data_model.stg_dwh__csdm_branch", "model.dga_data_model.dim__date"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__trans_casa"], "unique_id": "model.dga_data_model.fct__trans_casa", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH dat_casa_trans AS (\r\n  SELECT\r\n      a.*\r\n    , b.tltxds AS channel_desc_it\r\n    , C.account_no\r\n    , d.customer_number\r\n  FROM\r\n    {{ ref('stg_dwh__demanddeposit_transaction001')}} a\r\n    LEFT JOIN {{ ref('stg_landing__df_casa_channel_trn_type')}} b ON a.channel_trn = b.tltxcd\r\n    LEFT JOIN {{ ref('stg_landing__demanddeposit_master002')}} C ON a.account_no_sk = C.account_no_sk\r\n    LEFT JOIN {{ ref('int__casa_account')}} d ON C.account_no = d.account_number\r\n  WHERE\r\n    a.trn_date  = {{ var('julian_date')}}\r\n  )\r\n, dat_casa_trans_channel_lv2 AS (\r\n  SELECT\r\n      a.*\r\n    , CASE\r\n      -- AUTO\r\n      -- Autopay\r\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1321' THEN 'AUTO Autopay'\r\n        WHEN user_id LIKE 'AUTO%' THEN 'AUTO Autopay'\r\n        WHEN user_id LIKE 'CADPAYTL' THEN 'AUTO Autopay'\r\n      -- Fee\r\n        WHEN user_id LIKE 'FEE%' OR user_id = 'MSBSWEE' THEN 'AUTO Fee'\r\n        WHEN upper(channel_desc_it) LIKE 'CHG' THEN 'AUTO Fee'\r\n        WHEN channel_trn IN ( '0800', '0801' ) THEN 'AUTO Fee'\r\n        WHEN user_id LIKE 'PLUT%' OR user_id = 'MSBPAY' THEN 'AUTO Fee'\r\n      -- Interest\r\n        WHEN upper(channel_desc_it) LIKE '%ODINT%' THEN 'AUTO Interest'\r\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1022' THEN 'AUTO Interest'\r\n      -- POS\r\n      -- Online\r\n        WHEN channel_trn LIKE 'DGBMC%' OR channel_trn LIKE 'MC%' THEN 'POS Online'\r\n        WHEN channel_trn LIKE 'AIRP%' THEN 'POS Online'\r\n        WHEN upper(remark) LIKE '%THANH TOAN TRUC TUYEN%' THEN 'POS Online'\r\n      -- Transaction\r\n        WHEN upper(remark) LIKE '%GIAO DICH POS%' THEN 'POS Transaction'\r\n      -- ATM\r\n      -- Transfer\r\n        WHEN channel_desc_it LIKE '%Smrt IBT Bank trf-CA%' OR channel_desc_it LIKE '%ATM-3rdPty Trf-CA/CA%' THEN'ATM Transfer'\r\n      -- Withdraw\r\n        WHEN channel_desc_it LIKE '%Smrtlnk csh wdl-CA%'\r\n          OR channel_desc_it LIKE '%Debit Card Wdl-CA OS%'\r\n          OR channel_desc_it LIKE '%VisDebitCardWdl-CAOS%'\r\n          OR channel_desc_it LIKE '%ATM Cash WDL - CA%' \r\n          THEN 'ATM Withdraw'\r\n      -- IBMB\r\n      -- eWallet\r\n        WHEN user_id LIKE 'EGWTL%' THEN 'IBMB eWallet'\r\n      -- QR\r\n        WHEN channel_trn LIKE 'DBQR%' OR channel_trn LIKE 'QR%' THEN 'IBMB QR'\r\n      -- Bill pay\r\n        WHEN user_id LIKE 'EBANK%'\r\n          AND ( channel_trn LIKE 'EVN%'\r\n                OR channel_trn LIKE 'BWA%' ) \r\n          THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISBL%' THEN 'IBMB Billpay'\r\n        WHEN ( user_id LIKE 'EBANK%' OR user_id LIKE 'DGB%' )\r\n          AND ( channel_trn LIKE 'OP1321%' OR channel_trn LIKE 'PO1321%' OR channel_trn LIKE 'VP1321%' ) \r\n          THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'EBANK%'\r\n          AND ( channel_trn LIKE 'EP1321%' OR channel_trn LIKE 'NP1321%' )\r\n          AND upper(remark) LIKE '%THANH TOAN CHO HD%' \r\n          THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = 'NP1321B' THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'IBPRU%' AND channel_trn LIKE 'IBPRU%' THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'TAXONLINE%' AND channel_trn LIKE 'TO%' THEN 'IBMB Billpay'\r\n      -- Topup\r\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISTP%' THEN 'IBMB Topup'\r\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND upper(remark) LIKE '%TOPUP%' THEN 'IBMB Topup'\r\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND ( upper(remark) LIKE '%BUY CARD%' AND upper(remark) LIKE '%PREPAID%' ) THEN 'IBMB Topup'\r\n      -- Product\r\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = '3220' AND channel_desc_it LIKE 'FD%' THEN 'IBMB Product'\r\n        WHEN channel_trn = '3603' AND channel_desc_it = 'FD Add on By Trf' THEN 'IBMB Product'\r\n        WHEN user_id LIKE 'CK%' AND channel_trn LIKE 'CK%' THEN 'IBMB Product'\r\n        WHEN user_id LIKE 'GNV%' AND channel_trn LIKE '%1321GNV' THEN 'IBMB Product'\r\n        WHEN user_id LIKE 'EBANK%'\r\n          AND ( channel_trn = 'EB1321FCS' OR channel_trn LIKE 'EB3320%' OR channel_trn LIKE 'EB3603%' ) \r\n          THEN 'IBMB Product'\r\n      -- Transaction\r\n        WHEN user_id LIKE 'ECOMNAPAS%' THEN 'IBMB Transaction'\r\n        WHEN user_id LIKE 'IB%' AND user_id LIKE '%247' THEN 'IBMB Transaction'\r\n        WHEN user_id LIKE 'MSBDEB%' AND channel_trn LIKE 'DEBI' THEN 'IBMB Transaction'\r\n        WHEN ( user_id LIKE 'EBANK%'AND channel_trn LIKE 'EB%' )\r\n          OR ( user_id LIKE 'DGB%' AND channel_trn LIKE 'MB%' ) \r\n          THEN 'IBMB Transaction'\r\n        WHEN user_id LIKE 'ACQ%' AND channel_trn LIKE 'ACQ%' THEN 'IBMB Transaction'\r\n      -- COUNTER\r\n      -- Billpay\r\n        WHEN ( user_id LIKE 'DD%' OR user_id LIKE 'COUNTER%' OR user_id LIKE '%TELLER%' )\r\n          AND ( channel_trn LIKE 'BLING%' OR channel_trn LIKE 'BWA%' OR channel_trn LIKE 'EVN%' ) \r\n          THEN 'COUNTER Billpay'\r\n      -- Product\r\n        WHEN ( user_id LIKE 'DD%' OR user_id LIKE 'XD%' OR user_id LIKE 'XP%' OR user_id LIKE 'DP%' OR user_id LIKE 'LN%' )\r\n          AND ( channel_desc_it LIKE 'LN%' OR channel_desc_it LIKE 'FD%' ) \r\n          THEN 'COUNTER Product'\r\n        WHEN ( user_id LIKE 'IBDS%' AND channel_trn LIKE 'BOND%' )\r\n          OR ( user_id LIKE 'DSB%' AND channel_trn LIKE 'DSB%' ) \r\n          THEN 'COUNTER Product'\r\n      -- Transaction\r\n        ELSE 'COUNTER Transaction'\r\n      END AS channel_level2\r\n  FROM\r\n    dat_casa_trans a\r\n)\r\n, dat_casa_trans_channel_lv1 AS (\r\n  SELECT\r\n      a.*\r\n    , CASE\r\n        WHEN channel_level2 LIKE 'AUTO%' THEN 'AUTO'\r\n        WHEN channel_level2 LIKE 'ATM%' THEN 'ATM'\r\n        WHEN channel_level2 LIKE 'IBMB%' THEN 'IBMB'\r\n        WHEN channel_level2 LIKE 'POS%' THEN 'POS'\r\n        WHEN channel_level2 LIKE 'COUNTER%' THEN 'COUNTER'\r\n        ELSE 'OTHER'\r\n      END AS channel_level1\r\n  FROM\r\n    dat_casa_trans_channel_lv2 a\r\n)\r\n, dat_casa_code AS (\r\n  SELECT \r\n    a.*\r\n    , b_trg.trn_code\r\n    , c_trg.product_code\r\n    , d_trg.branch_code AS ac_branch_code\r\n    , e_trg.branch_code AS trn_branch_code\r\n    , h.julian_date\r\n    , h.month_id\r\n    , h.date_id\r\n  FROM \r\n    dat_casa_trans_channel_lv1 a \r\n  LEFT JOIN {{ ref('stg_dwh__csdm_transaction_code')}} b_trg ON a.trn_sk = b_trg.tran_sk\r\n  LEFT JOIN {{ ref('stg_dwh__dddm_product') }} c_trg ON a.product_sk = c_trg.product_sk\r\n  LEFT JOIN {{ ref('stg_dwh__csdm_branch')}} d_trg ON a.ac_branch_sk = d_trg.branch_code_sk\r\n  LEFT JOIN {{ ref('stg_dwh__csdm_branch')}} e_trg ON a.trn_branch_sk = e_trg.branch_code_sk\r\n  LEFT JOIN {{ ref('dim__date')}} h ON a.trn_date = h.julian_date\r\n)\r\n  SELECT * FROM dat_casa_code", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__trans_casa.sql", "original_file_path": "models\\mart\\daily\\fct__trans_casa.sql", "name": "fct__trans_casa", "alias": "fct__trans_casa", "checksum": {"name": "sha256", "checksum": "3e1926f5ce003a92df598bd0cbfad963c75a12f3c117d548dddc6dfdcbe7bfc4"}, "tags": ["pkg_daily"], "refs": [["stg_dwh__demanddeposit_transaction001"], ["stg_landing__df_casa_channel_trn_type"], ["stg_landing__demanddeposit_master002"], ["int__casa_account"], ["stg_dwh__csdm_transaction_code"], ["stg_dwh__dddm_product"], ["stg_dwh__csdm_branch"], ["stg_dwh__csdm_branch"], ["dim__date"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__trans_casa.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "table"}, "created_at": 1685959752.8529851, "compiled_code": "\nWITH dat_casa_trans AS (\n  SELECT\n      a.*\n    , b.tltxds AS channel_desc_it\n    , C.account_no\n    , d.customer_number\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_dwh__demanddeposit_transaction001 a\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_casa_channel_trn_type b ON a.channel_trn = b.tltxcd\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002 C ON a.account_no_sk = C.account_no_sk\n    LEFT JOIN \"oracle_dgaworkzone\".int.int__casa_account d ON C.account_no = d.account_number\n  WHERE\n    a.trn_date  = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n  )\n, dat_casa_trans_channel_lv2 AS (\n  SELECT\n      a.*\n    , CASE\n      -- AUTO\n      -- Autopay\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1321' THEN 'AUTO Autopay'\n        WHEN user_id LIKE 'AUTO%' THEN 'AUTO Autopay'\n        WHEN user_id LIKE 'CADPAYTL' THEN 'AUTO Autopay'\n      -- Fee\n        WHEN user_id LIKE 'FEE%' OR user_id = 'MSBSWEE' THEN 'AUTO Fee'\n        WHEN upper(channel_desc_it) LIKE 'CHG' THEN 'AUTO Fee'\n        WHEN channel_trn IN ( '0800', '0801' ) THEN 'AUTO Fee'\n        WHEN user_id LIKE 'PLUT%' OR user_id = 'MSBPAY' THEN 'AUTO Fee'\n      -- Interest\n        WHEN upper(channel_desc_it) LIKE '%ODINT%' THEN 'AUTO Interest'\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1022' THEN 'AUTO Interest'\n      -- POS\n      -- Online\n        WHEN channel_trn LIKE 'DGBMC%' OR channel_trn LIKE 'MC%' THEN 'POS Online'\n        WHEN channel_trn LIKE 'AIRP%' THEN 'POS Online'\n        WHEN upper(remark) LIKE '%THANH TOAN TRUC TUYEN%' THEN 'POS Online'\n      -- Transaction\n        WHEN upper(remark) LIKE '%GIAO DICH POS%' THEN 'POS Transaction'\n      -- ATM\n      -- Transfer\n        WHEN channel_desc_it LIKE '%Smrt IBT Bank trf-CA%' OR channel_desc_it LIKE '%ATM-3rdPty Trf-CA/CA%' THEN'ATM Transfer'\n      -- Withdraw\n        WHEN channel_desc_it LIKE '%Smrtlnk csh wdl-CA%'\n          OR channel_desc_it LIKE '%Debit Card Wdl-CA OS%'\n          OR channel_desc_it LIKE '%VisDebitCardWdl-CAOS%'\n          OR channel_desc_it LIKE '%ATM Cash WDL - CA%' \n          THEN 'ATM Withdraw'\n      -- IBMB\n      -- eWallet\n        WHEN user_id LIKE 'EGWTL%' THEN 'IBMB eWallet'\n      -- QR\n        WHEN channel_trn LIKE 'DBQR%' OR channel_trn LIKE 'QR%' THEN 'IBMB QR'\n      -- Bill pay\n        WHEN user_id LIKE 'EBANK%'\n          AND ( channel_trn LIKE 'EVN%'\n                OR channel_trn LIKE 'BWA%' ) \n          THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISBL%' THEN 'IBMB Billpay'\n        WHEN ( user_id LIKE 'EBANK%' OR user_id LIKE 'DGB%' )\n          AND ( channel_trn LIKE 'OP1321%' OR channel_trn LIKE 'PO1321%' OR channel_trn LIKE 'VP1321%' ) \n          THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'EBANK%'\n          AND ( channel_trn LIKE 'EP1321%' OR channel_trn LIKE 'NP1321%' )\n          AND upper(remark) LIKE '%THANH TOAN CHO HD%' \n          THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = 'NP1321B' THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'IBPRU%' AND channel_trn LIKE 'IBPRU%' THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'TAXONLINE%' AND channel_trn LIKE 'TO%' THEN 'IBMB Billpay'\n      -- Topup\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISTP%' THEN 'IBMB Topup'\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND upper(remark) LIKE '%TOPUP%' THEN 'IBMB Topup'\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND ( upper(remark) LIKE '%BUY CARD%' AND upper(remark) LIKE '%PREPAID%' ) THEN 'IBMB Topup'\n      -- Product\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = '3220' AND channel_desc_it LIKE 'FD%' THEN 'IBMB Product'\n        WHEN channel_trn = '3603' AND channel_desc_it = 'FD Add on By Trf' THEN 'IBMB Product'\n        WHEN user_id LIKE 'CK%' AND channel_trn LIKE 'CK%' THEN 'IBMB Product'\n        WHEN user_id LIKE 'GNV%' AND channel_trn LIKE '%1321GNV' THEN 'IBMB Product'\n        WHEN user_id LIKE 'EBANK%'\n          AND ( channel_trn = 'EB1321FCS' OR channel_trn LIKE 'EB3320%' OR channel_trn LIKE 'EB3603%' ) \n          THEN 'IBMB Product'\n      -- Transaction\n        WHEN user_id LIKE 'ECOMNAPAS%' THEN 'IBMB Transaction'\n        WHEN user_id LIKE 'IB%' AND user_id LIKE '%247' THEN 'IBMB Transaction'\n        WHEN user_id LIKE 'MSBDEB%' AND channel_trn LIKE 'DEBI' THEN 'IBMB Transaction'\n        WHEN ( user_id LIKE 'EBANK%'AND channel_trn LIKE 'EB%' )\n          OR ( user_id LIKE 'DGB%' AND channel_trn LIKE 'MB%' ) \n          THEN 'IBMB Transaction'\n        WHEN user_id LIKE 'ACQ%' AND channel_trn LIKE 'ACQ%' THEN 'IBMB Transaction'\n      -- COUNTER\n      -- Billpay\n        WHEN ( user_id LIKE 'DD%' OR user_id LIKE 'COUNTER%' OR user_id LIKE '%TELLER%' )\n          AND ( channel_trn LIKE 'BLING%' OR channel_trn LIKE 'BWA%' OR channel_trn LIKE 'EVN%' ) \n          THEN 'COUNTER Billpay'\n      -- Product\n        WHEN ( user_id LIKE 'DD%' OR user_id LIKE 'XD%' OR user_id LIKE 'XP%' OR user_id LIKE 'DP%' OR user_id LIKE 'LN%' )\n          AND ( channel_desc_it LIKE 'LN%' OR channel_desc_it LIKE 'FD%' ) \n          THEN 'COUNTER Product'\n        WHEN ( user_id LIKE 'IBDS%' AND channel_trn LIKE 'BOND%' )\n          OR ( user_id LIKE 'DSB%' AND channel_trn LIKE 'DSB%' ) \n          THEN 'COUNTER Product'\n      -- Transaction\n        ELSE 'COUNTER Transaction'\n      END AS channel_level2\n  FROM\n    dat_casa_trans a\n)\n, dat_casa_trans_channel_lv1 AS (\n  SELECT\n      a.*\n    , CASE\n        WHEN channel_level2 LIKE 'AUTO%' THEN 'AUTO'\n        WHEN channel_level2 LIKE 'ATM%' THEN 'ATM'\n        WHEN channel_level2 LIKE 'IBMB%' THEN 'IBMB'\n        WHEN channel_level2 LIKE 'POS%' THEN 'POS'\n        WHEN channel_level2 LIKE 'COUNTER%' THEN 'COUNTER'\n        ELSE 'OTHER'\n      END AS channel_level1\n  FROM\n    dat_casa_trans_channel_lv2 a\n)\n, dat_casa_code AS (\n  SELECT \n    a.*\n    , b_trg.trn_code\n    , c_trg.product_code\n    , d_trg.branch_code AS ac_branch_code\n    , e_trg.branch_code AS trn_branch_code\n    , h.julian_date\n    , h.month_id\n    , h.date_id\n  FROM \n    dat_casa_trans_channel_lv1 a \n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__csdm_transaction_code b_trg ON a.trn_sk = b_trg.tran_sk\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__dddm_product c_trg ON a.product_sk = c_trg.product_sk\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__csdm_branch d_trg ON a.ac_branch_sk = d_trg.branch_code_sk\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__csdm_branch e_trg ON a.trn_branch_sk = e_trg.branch_code_sk\n  LEFT JOIN \"oracle_dgaworkzone\".mart.dim__date h ON a.trn_date = h.julian_date\n)\n  SELECT * FROM dat_casa_code", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__trans_casa"}, "model.dga_data_model.fct__trans_casa_mpayroll": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__trans_casa_mpayroll"], "unique_id": "model.dga_data_model.fct__trans_casa_mpayroll", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    pre_hook=['DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}']\r\n  )\r\n}}\r\nWITH dat_credit_txn AS (\r\n  SELECT\r\n    a.*\r\n  FROM\r\n    {{ ref('fct__trans_casa')}} a\r\n  WHERE\r\n    ( ( user_id LIKE 'TS%' AND REGEXP_LIKE ( remark, 'SALARY|LUONG', 'i' ) )\r\n      OR ( user_id = 'EBANKING09' AND REGEXP_LIKE ( remark, 'SALARY|LUONG', 'i' ) ) OR remark LIKE 'SALARY%' )\r\n    AND NOT REGEXP_LIKE ( remark\r\n    , 'MSB HOAN TRA|TRA SOAT|VISA|MASTERCARD|ATM|SAMSUNG PAY|JOY|HOAN TIEN|UNG TIEN|HTGD|BOI HOAN|BAO CO|HOAN PHI|TRA SOAT|HT TRICH NO THUA|HT-CHE-DO-BAO-HIEM|MSB-chuc-mung-quy-khach|HOAN TIEN|HOAN DU CO|MSB-CHUC-MUNG|MSB HOAN DU CO|MSB-chi-thuong|QR CODE|MSB HOAN SO TIEN|MSB-chuyen-qua-Khao-Sat|MSB HOAN GD'\r\n    , 'i' )\r\n    AND NOT REGEXP_LIKE ( remark\r\n    , 'TNR---Thanh-toan-ti\\?n-mua-l\\?i-g\\?c|TNR---Thanh-toan-tien-mua-lai-goc|TNR---Thanh-toan-ti\\?n-lai|TNR---Thanh-toan-tien-lai|TNR---Thanh-toan-ti\\?n-g\\?c-va-lai|TNR---Thanh-toan-tien-goc-va-lai|TNR---T\\?t-toan-g\\?c-va-tr\\?-lai|TNR---Tat-toan-goc-va-tra-lai'\r\n    , 'i' )\r\n    AND dorc_ind = 'C'\r\n    AND lcy_amount <> 0\r\n    AND trn_date  = {{ var('julian_date')}}\r\n)\r\n, dat_debit_txn AS (\r\n  SELECT\r\n    a.*\r\n  FROM\r\n      {{ ref('fct__trans_casa')}} a\r\n  WHERE\r\n    dorc_ind = 'D'\r\n    AND lcy_amount <> 0\r\n    AND trn_date  = {{ var('julian_date')}}\r\n)\r\n, dat_pymt_txn_raw AS (\r\n  SELECT\r\n      to_char(to_date(a.trn_date, 'YYYYDDD'), 'YYYYMM') AS month_id\r\n    , to_char(to_date(a.trn_date, 'YYYYDDD'), 'YYYYMMDD') AS date_id\r\n    , a.txn_id\r\n    , a.trn_date AS transaction_date\r\n    , a.trn_time\r\n    , a.currency\r\n    , a.acy_amount\r\n    , a.exchange_rate\r\n    , a.lcy_amount AS lcy_transaction_amount\r\n    , a.eqv_tramt\r\n    , a.remark\r\n    , a.channel_trn\r\n    , a.seq_number\r\n    , a.user_id\r\n    , b.trn_code AS src_trn_code\r\n    , b.product_code AS src_product_code\r\n    , b.ac_branch_code AS src_ac_branch_code\r\n    , b.trn_branch_code AS src_trn_branch_code\r\n    , b.account_no AS src_account_number\r\n    , b.customer_number AS src_customer_number\r\n    , a.trn_code AS trg_trn_code\r\n    , a.product_code AS trg_product_code\r\n    , a.ac_branch_code AS trg_ac_branch_code\r\n    , a.trn_branch_code AS trg_trn_branch_code\r\n    , a.account_no AS trg_account_number\r\n    , a.customer_number AS trg_customer_number\r\n  FROM\r\n    dat_credit_txn a\r\n  LEFT JOIN dat_debit_txn  b ON a.txn_id = b.txn_id\r\n)\r\nSELECT * FROM dat_pymt_txn_raw", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__trans_casa_mpayroll.sql", "original_file_path": "models\\mart\\daily\\fct__trans_casa_mpayroll.sql", "name": "fct__trans_casa_mpayroll", "alias": "fct__trans_casa_mpayroll", "checksum": {"name": "sha256", "checksum": "763a7406149b26db03416ce45278268cd4fb2bce111502ed92dac77e98a12c3e"}, "tags": ["pkg_daily"], "refs": [["fct__trans_casa"], ["fct__trans_casa"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "date_id"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\daily\\daily_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__trans_casa_mpayroll.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "date_id"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE date_id = {{ var(\"date_id\") }}"]}, "created_at": 1685959752.8559816, "compiled_code": "\nWITH dat_credit_txn AS (\n  SELECT\n    a.*\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__trans_casa a\n  WHERE\n    ( ( user_id LIKE 'TS%' AND REGEXP_LIKE ( remark, 'SALARY|LUONG', 'i' ) )\n      OR ( user_id = 'EBANKING09' AND REGEXP_LIKE ( remark, 'SALARY|LUONG', 'i' ) ) OR remark LIKE 'SALARY%' )\n    AND NOT REGEXP_LIKE ( remark\n    , 'MSB HOAN TRA|TRA SOAT|VISA|MASTERCARD|ATM|SAMSUNG PAY|JOY|HOAN TIEN|UNG TIEN|HTGD|BOI HOAN|BAO CO|HOAN PHI|TRA SOAT|HT TRICH NO THUA|HT-CHE-DO-BAO-HIEM|MSB-chuc-mung-quy-khach|HOAN TIEN|HOAN DU CO|MSB-CHUC-MUNG|MSB HOAN DU CO|MSB-chi-thuong|QR CODE|MSB HOAN SO TIEN|MSB-chuyen-qua-Khao-Sat|MSB HOAN GD'\n    , 'i' )\n    AND NOT REGEXP_LIKE ( remark\n    , 'TNR---Thanh-toan-ti\\?n-mua-l\\?i-g\\?c|TNR---Thanh-toan-tien-mua-lai-goc|TNR---Thanh-toan-ti\\?n-lai|TNR---Thanh-toan-tien-lai|TNR---Thanh-toan-ti\\?n-g\\?c-va-lai|TNR---Thanh-toan-tien-goc-va-lai|TNR---T\\?t-toan-g\\?c-va-tr\\?-lai|TNR---Tat-toan-goc-va-tra-lai'\n    , 'i' )\n    AND dorc_ind = 'C'\n    AND lcy_amount <> 0\n    AND trn_date  = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, dat_debit_txn AS (\n  SELECT\n    a.*\n  FROM\n      \"oracle_dgaworkzone\".mart.fct__trans_casa a\n  WHERE\n    dorc_ind = 'D'\n    AND lcy_amount <> 0\n    AND trn_date  = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, dat_pymt_txn_raw AS (\n  SELECT\n      to_char(to_date(a.trn_date, 'YYYYDDD'), 'YYYYMM') AS month_id\n    , to_char(to_date(a.trn_date, 'YYYYDDD'), 'YYYYMMDD') AS date_id\n    , a.txn_id\n    , a.trn_date AS transaction_date\n    , a.trn_time\n    , a.currency\n    , a.acy_amount\n    , a.exchange_rate\n    , a.lcy_amount AS lcy_transaction_amount\n    , a.eqv_tramt\n    , a.remark\n    , a.channel_trn\n    , a.seq_number\n    , a.user_id\n    , b.trn_code AS src_trn_code\n    , b.product_code AS src_product_code\n    , b.ac_branch_code AS src_ac_branch_code\n    , b.trn_branch_code AS src_trn_branch_code\n    , b.account_no AS src_account_number\n    , b.customer_number AS src_customer_number\n    , a.trn_code AS trg_trn_code\n    , a.product_code AS trg_product_code\n    , a.ac_branch_code AS trg_ac_branch_code\n    , a.trn_branch_code AS trg_trn_branch_code\n    , a.account_no AS trg_account_number\n    , a.customer_number AS trg_customer_number\n  FROM\n    dat_credit_txn a\n  LEFT JOIN dat_debit_txn  b ON a.txn_id = b.txn_id\n)\nSELECT * FROM dat_pymt_txn_raw", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__trans_casa_mpayroll"}, "model.dga_data_model.fct__trans_casa_test": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.staging.temp_daily_transaction_remark_define_product", "model.dga_data_model.stg__ddft_transaction_map_ibmb", "model.dga_data_model.dim__arrangement", "model.dga_data_model.stg_dwh__csdm_transaction_code", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.int__casa_account", "model.dga_data_model.stg_landing__df_casa_channel_trn_type", "model.dga_data_model.dim__date"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE trn_date = {{ var(\"julian_date\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "daily", "fct__trans_casa_test"], "unique_id": "model.dga_data_model.fct__trans_casa_test", "raw_code": "{{\r\n  config(\r\n    materialized='incremental',\r\n    pre_hook=['DELETE {{ this }}  WHERE trn_date = {{ var(\"julian_date\") }}']\r\n  )\r\n}}\r\nWITH source_data AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('stg__ddft_transaction_map_ibmb')}} a\r\n  WHERE\r\n    a.trn_date  = {{ var('julian_date')}}\r\n)\r\n, txn_id_count AS (\r\n  SELECT\r\n      txn_id\r\n    , COUNT(*) AS number_txn\r\n  FROM\r\n    source_data a\r\n  GROUP BY\r\n      txn_id\r\n)\r\n, all_txn AS (\r\n  SELECT\r\n      a.txn_id\r\n    , b.trn_ref_no\r\n    , b.src_ref_no\r\n    , b.sub_ref_no\r\n    , b.affect_code\r\n    , b.trn_sk\r\n    , b.trn_time\r\n    , b.trn_date\r\n    , b.value_date\r\n    , b.currency\r\n    , b.dorc_ind\r\n    , b.acy_amount\r\n    , b.exchange_rate\r\n    , b.lcy_amount\r\n    , b.product_sk\r\n    , b.status\r\n    , b.channel\r\n    , b.channel_trn\r\n    , b.ac_branch_sk\r\n    , b.trn_branch_sk\r\n    , b.account_no_sk\r\n    , b.customer_sk\r\n    , b.gl_code_sk\r\n    , b.maker_sk\r\n    , b.checker_sk\r\n    , b.related_person\r\n    , b.related_account\r\n    , b.trf_sys\r\n    , b.trf_bank_sk\r\n    , b.remark\r\n    , b.seq_number\r\n    , b.posting_order\r\n    , b.before_balance\r\n    , b.current_balance\r\n    , b.user_id\r\n    , b.eqv_tramt\r\n    , CASE\r\n        WHEN b.trf_sys is not null then b.trf_sys\r\n        WHEN b.trf_sys is null and b.user_id like '%GNV%' THEN  'INTERNAL'\r\n        WHEN b.trf_sys is null and a.number_txn = 1 AND b.lcy_amount <> 0 THEN  'EXTERNAL'\r\n        WHEN b.trf_sys is null and a.number_txn = 2 AND b.lcy_amount <> 0 THEN 'INTERNAL'\r\n        ELSE 'OTHER'\r\n    END AS external_internal_txn\r\n    , b.beneficiary_bank_id\r\n    , b.beneficiary_bank_name\r\n    , b.value_type\r\n    FROM\r\n      txn_id_count a\r\n    LEFT JOIN source_data b ON a.txn_id = b.txn_id\r\n)\r\n, cus AS (\r\nselect\r\n   ACCOUNT_NUMBER\r\n   ,CUSTOMER_NUMBER\r\n   ,ROW_nUMBER() OVER(PARTITION BY ACCOUNT_NUMBER ORDER BY EFF_FM_DT DESC) AS RN\r\nfrom\r\n  {{ ref('dim__arrangement') }}\r\nWHERE\r\n  IS_CUR_REC = 1\r\n\r\n)\r\n  SELECT\r\n    all_txn.*\r\n    , trncode.trn_code\r\n    , trncode.description as trn_desc\r\n    , channel.tltxds  as channel_trn_desc\r\n    , CASE\r\n        WHEN all_txn.user_id = 'AUTOPAYFC' THEN 'AUTO LoanAndCredit Payment'\r\n        WHEN all_txn.user_id LIKE 'OD%' AND all_txn.channel_trn = 'OIH_1321' THEN 'AUTO Autopay'\r\n        WHEN all_txn.user_id LIKE 'AUTO%' THEN 'AUTO Autopay'\r\n        WHEN all_txn.user_id LIKE 'CADPAYTL' THEN 'AUTO Autopay'\r\n        WHEN all_txn.user_id LIKE 'FEE%' OR all_txn.user_id = 'MSBSWEE' THEN 'AUTO Fee'\r\n        WHEN upper(channel.tltxds) LIKE 'CHG' THEN 'AUTO Fee'\r\n        WHEN all_txn.channel_trn IN ('W0800','CCS0800','0800','EB0800','0801','CK0800','GO0800','BLING0800', 'PLUTS0800') THEN 'AUTO Fee'\r\n        WHEN all_txn.user_id LIKE 'PLUT%'  OR all_txn.user_id = 'MSBPAY' THEN 'AUTO Fee'\r\n        WHEN upper(channel.tltxds) LIKE '%ODINT%' THEN 'AUTO Interest'\r\n        WHEN all_txn.user_id LIKE 'OD%' AND all_txn.channel_trn = 'OIH_1022' THEN 'AUTO Interest'\r\n        WHEN all_txn.channel_trn LIKE 'DGBMC%'OR all_txn.channel_trn LIKE 'MC%' THEN 'POS Online'\r\n        WHEN all_txn.channel_trn LIKE 'AIRP%' THEN 'POS Online'\r\n        WHEN upper(all_txn.remark) LIKE '%THANH TOAN TRUC TUYEN%' THEN 'POS Online'\r\n        WHEN upper(all_txn.remark) LIKE '%GIAO DICH POS%' THEN 'POS Transaction'\r\n        WHEN channel.tltxds LIKE '%Smrt IBT Bank trf-CA%' OR channel.tltxds LIKE '%ATM-3rdPty Trf-CA/CA%' THEN 'ATM Transfer'\r\n        WHEN upper(channel.tltxds) like '%WDL%' THEN 'ATM Withdraw'\r\n        WHEN all_txn.user_id LIKE 'EGWTL%' THEN 'IBMB eWallet'\r\n        WHEN all_txn.channel_trn LIKE 'DBQR%' OR all_txn.channel_trn LIKE 'QR%' THEN 'IBMB QR'\r\n        WHEN all_txn.user_id LIKE 'EBANK%'\r\n            AND ( all_txn.channel_trn LIKE 'EVN%'OR all_txn.channel_trn LIKE 'BWA%' ) THEN 'IBMB Billpay'\r\n        WHEN all_txn.user_id LIKE 'MB%' AND all_txn.channel_trn LIKE 'IRISBL%' THEN 'IBMB Billpay'\r\n        WHEN ( all_txn.user_id LIKE 'EBANK%' OR all_txn.user_id LIKE 'DGB%' )\r\n            AND ( all_txn.channel_trn LIKE 'OP1321%'\r\n                OR all_txn.channel_trn LIKE 'PO1321%'\r\n                OR all_txn.channel_trn LIKE 'VP1321%' ) THEN 'IBMB Billpay'\r\n        WHEN all_txn.user_id LIKE 'EBANK%'\r\n            AND ( all_txn.channel_trn LIKE 'EP1321%'\r\n                OR all_txn.channel_trn LIKE 'NP1321%' )\r\n            AND upper(all_txn.remark) LIKE '%THANH TOAN CHO HD%' THEN 'IBMB Billpay'\r\n        WHEN all_txn.user_id LIKE 'EBANK%' AND all_txn.channel_trn = 'NP1321B' THEN 'IBMB Billpay'\r\n        WHEN ( all_txn.user_id LIKE 'IBPRU%' AND all_txn.channel_trn LIKE 'IBPRU%' ) THEN 'IBMB Billpay'\r\n        WHEN all_txn.user_id LIKE 'TAXONLINE%' AND all_txn.channel_trn LIKE 'TO%' THEN 'IBMB Billpay'\r\n        WHEN all_txn.user_id LIKE 'MB%' AND all_txn.channel_trn LIKE 'IRISTP%' THEN 'IBMB Topup'\r\n        WHEN all_txn.user_id LIKE 'DGB%'\r\n            AND all_txn.channel_trn LIKE 'EP%'\r\n            AND ( upper(all_txn.remark) LIKE '%TOPUP%' ) THEN 'IBMB Topup'\r\n        WHEN all_txn.user_id LIKE 'DGB%'\r\n            AND all_txn.channel_trn LIKE 'EP%'\r\n            AND ( upper(all_txn.remark) LIKE '%BUY CARD%'\r\n                AND upper(all_txn.remark) LIKE '%PREPAID%' ) THEN 'IBMB Topup'\r\n        WHEN all_txn.user_id LIKE 'EBANK%'\r\n            AND all_txn.channel_trn = '3220'\r\n            AND channel.tltxds LIKE 'FD%' THEN 'IBMB Product'\r\n        WHEN all_txn.channel_trn = '3603' AND channel.tltxds = 'FD Add on By Trf' THEN 'IBMB Product'\r\n        WHEN all_txn.user_id LIKE 'CK%' AND all_txn.channel_trn LIKE 'CK%' THEN 'IBMB Product'\r\n        WHEN all_txn.user_id LIKE 'EBANK%'\r\n            AND ( all_txn.channel_trn = 'EB1321FCS'\r\n                OR all_txn.channel_trn LIKE 'EB3320%'\r\n                OR all_txn.channel_trn LIKE 'EB3603%' ) THEN 'IBMB Product'\r\n        WHEN all_txn.user_id LIKE 'ECOMNAPAS%' THEN 'IBMB Transaction'\r\n        WHEN all_txn.user_id LIKE 'IB%' AND all_txn.user_id LIKE '%247' THEN 'IBMB Transaction'\r\n        WHEN all_txn.user_id LIKE 'MSBDEB%' AND all_txn.channel_trn LIKE 'DEBI' THEN 'IBMB Transaction'\r\n        WHEN ( all_txn.user_id LIKE 'EBANK%'AND all_txn.channel_trn LIKE 'EB%' )\r\n            OR ( all_txn.user_id LIKE 'DGB%'AND all_txn.channel_trn LIKE 'MB%' ) THEN 'IBMB Transaction'\r\n        WHEN all_txn.user_id LIKE 'ACQ%' AND all_txn.channel_trn LIKE 'ACQ%' THEN 'IBMB Transaction'\r\n        WHEN all_txn.user_id LIKE 'GNV%' AND all_txn.channel_trn LIKE '%1321GNV' THEN 'Online Disbursement'\r\n        WHEN ( all_txn.user_id LIKE 'DD%' OR all_txn.user_id LIKE 'COUNTER%' OR all_txn.user_id LIKE '%TELLER%' )\r\n            AND ( all_txn.channel_trn LIKE 'BLING%'\r\n                OR all_txn.channel_trn LIKE 'BWA%'\r\n                OR all_txn.channel_trn LIKE 'EVN%' ) THEN 'COUNTER Billpay'\r\n        WHEN ( all_txn.user_id LIKE 'DD%'\r\n                OR all_txn.user_id LIKE 'XD%'\r\n                OR all_txn.user_id LIKE 'XP%'\r\n                OR all_txn.user_id LIKE 'DP%'\r\n                OR all_txn.user_id LIKE 'LN%' )\r\n            AND (channel.tltxds LIKE 'LN%' OR channel.tltxds LIKE 'FD%' ) THEN 'COUNTER Product'\r\n        WHEN ( all_txn.user_id LIKE 'IBDS%' AND all_txn.channel_trn LIKE 'BOND%' )\r\n            OR ( all_txn.user_id LIKE 'DSB%' AND all_txn.channel_trn LIKE 'DSB%' ) THEN 'COUNTER Product'\r\n        WHEN trncode.description = 'CLOSING DEBIT INTEREST' THEN 'COUNTER Closing'\r\n        WHEN trncode.trn_code IN ('155', '160', '169', '180', '269') THEN 'COUNTER Fee and Interest'\r\n        WHEN all_txn.user_id LIKE 'GNV%' AND all_txn.channel_trn LIKE '%1321GNV' THEN 'Online Disbursement'\r\n        ELSE 'COUNTER Transaction'\r\n    END AS channel_level2\r\n    , CASE\r\n        WHEN all_txn.user_id LIKE 'IBDS%'\r\n          OR all_txn.channel_trn LIKE 'BOND%'\r\n          OR all_txn.user_id LIKE 'DSB%'\r\n          OR all_txn.channel_trn LIKE 'DSB%' THEN 'BOND'\r\n        WHEN all_txn.dorc_ind = 'D'\r\n          AND (all_txn.user_id LIKE'DD%'\r\n            OR all_txn.user_id LIKE 'XD%'\r\n            OR all_txn.user_id LIKE 'XP%'\r\n            OR all_txn.user_id LIKE 'DP%'\r\n            OR all_txn.user_id LIKE 'LN%'\r\n            OR all_txn.channel_trn = '3220'\r\n            OR all_txn.channel_trn = '3603')\r\n          AND (channel.tltxds  LIKE '%FD%') THEN 'FD'\r\n        WHEN all_txn.dorc_ind = 'D' AND UPPER(all_txn.remark) LIKE '%BAO HIEM%' THEN 'BANCA'\r\n        WHEN remark.TYPE IS NOT NULL THEN remark.TYPE\r\n    END AS channel_product_type\r\n    , c.account_no AS account_number\r\n    , d.customer_number\r\n    , dated.date_id AS trans_date_id\r\n    , cus.customer_number AS related_customer_number\r\n  FROM\r\n  all_txn\r\n  LEFT JOIN {{ ref('stg_dwh__csdm_transaction_code')}} trncode ON all_txn.trn_sk = trncode.tran_sk\r\n  LEFT JOIN {{ ref('stg_landing__demanddeposit_master002')}} C ON all_txn.account_no_sk = C.account_no_sk\r\n  LEFT JOIN {{ ref('int__casa_account')}} d ON C.account_no = d.account_number\r\n  LEFT JOIN {{ ref('stg_landing__df_casa_channel_trn_type')}} channel ON all_txn.channel_trn = trim(channel.tltxcd)\r\n  LEFT JOIN {{ ref('dim__date') }} dated ON all_txn.trn_date = dated.julian_date\r\n  LEFT JOIN {{ source('staging', 'temp_daily_transaction_remark_define_product') }} remark\r\n    ON all_txn.txn_id = remark.txn_id\r\n    AND all_txn.dorc_ind = remark.dorc_ind\r\n  LEFT JOIN cus  ON cus.ACCOUNT_NUMBER = all_txn.RELATED_ACCOUNT ANd cus.rn = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\daily\\fct__trans_casa_test.sql", "original_file_path": "models\\mart\\daily\\fct__trans_casa_test.sql", "name": "fct__trans_casa_test", "alias": "fct__trans_casa_test", "checksum": {"name": "sha256", "checksum": "65ae1a518e87dc0dc5f623d6219d52a0ba34886caf96f36a2e1c1556e7f82b74"}, "tags": ["pkg_daily"], "refs": [["stg__ddft_transaction_map_ibmb"], ["dim__arrangement"], ["stg_dwh__csdm_transaction_code"], ["stg_landing__demanddeposit_master002"], ["int__casa_account"], ["stg_landing__df_casa_channel_trn_type"], ["dim__date"]], "sources": [["staging", "temp_daily_transaction_remark_define_product"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\daily\\fct__trans_casa_test.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE trn_date = {{ var(\"julian_date\") }}"]}, "created_at": 1685959751.2643309, "compiled_code": "\nWITH source_data AS (\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".staging.stg__ddft_transaction_map_ibmb a\n  WHERE\n    a.trn_date  = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n)\n, txn_id_count AS (\n  SELECT\n      txn_id\n    , COUNT(*) AS number_txn\n  FROM\n    source_data a\n  GROUP BY\n      txn_id\n)\n, all_txn AS (\n  SELECT\n      a.txn_id\n    , b.trn_ref_no\n    , b.src_ref_no\n    , b.sub_ref_no\n    , b.affect_code\n    , b.trn_sk\n    , b.trn_time\n    , b.trn_date\n    , b.value_date\n    , b.currency\n    , b.dorc_ind\n    , b.acy_amount\n    , b.exchange_rate\n    , b.lcy_amount\n    , b.product_sk\n    , b.status\n    , b.channel\n    , b.channel_trn\n    , b.ac_branch_sk\n    , b.trn_branch_sk\n    , b.account_no_sk\n    , b.customer_sk\n    , b.gl_code_sk\n    , b.maker_sk\n    , b.checker_sk\n    , b.related_person\n    , b.related_account\n    , b.trf_sys\n    , b.trf_bank_sk\n    , b.remark\n    , b.seq_number\n    , b.posting_order\n    , b.before_balance\n    , b.current_balance\n    , b.user_id\n    , b.eqv_tramt\n    , CASE\n        WHEN b.trf_sys is not null then b.trf_sys\n        WHEN b.trf_sys is null and b.user_id like '%GNV%' THEN  'INTERNAL'\n        WHEN b.trf_sys is null and a.number_txn = 1 AND b.lcy_amount <> 0 THEN  'EXTERNAL'\n        WHEN b.trf_sys is null and a.number_txn = 2 AND b.lcy_amount <> 0 THEN 'INTERNAL'\n        ELSE 'OTHER'\n    END AS external_internal_txn\n    , b.beneficiary_bank_id\n    , b.beneficiary_bank_name\n    , b.value_type\n    FROM\n      txn_id_count a\n    LEFT JOIN source_data b ON a.txn_id = b.txn_id\n)\n, cus AS (\nselect\n   ACCOUNT_NUMBER\n   ,CUSTOMER_NUMBER\n   ,ROW_nUMBER() OVER(PARTITION BY ACCOUNT_NUMBER ORDER BY EFF_FM_DT DESC) AS RN\nfrom\n  \"oracle_dgaworkzone\".mart.dim__arrangement\nWHERE\n  IS_CUR_REC = 1\n\n)\n  SELECT\n    all_txn.*\n    , trncode.trn_code\n    , trncode.description as trn_desc\n    , channel.tltxds  as channel_trn_desc\n    , CASE\n        WHEN all_txn.user_id = 'AUTOPAYFC' THEN 'AUTO LoanAndCredit Payment'\n        WHEN all_txn.user_id LIKE 'OD%' AND all_txn.channel_trn = 'OIH_1321' THEN 'AUTO Autopay'\n        WHEN all_txn.user_id LIKE 'AUTO%' THEN 'AUTO Autopay'\n        WHEN all_txn.user_id LIKE 'CADPAYTL' THEN 'AUTO Autopay'\n        WHEN all_txn.user_id LIKE 'FEE%' OR all_txn.user_id = 'MSBSWEE' THEN 'AUTO Fee'\n        WHEN upper(channel.tltxds) LIKE 'CHG' THEN 'AUTO Fee'\n        WHEN all_txn.channel_trn IN ('W0800','CCS0800','0800','EB0800','0801','CK0800','GO0800','BLING0800', 'PLUTS0800') THEN 'AUTO Fee'\n        WHEN all_txn.user_id LIKE 'PLUT%'  OR all_txn.user_id = 'MSBPAY' THEN 'AUTO Fee'\n        WHEN upper(channel.tltxds) LIKE '%ODINT%' THEN 'AUTO Interest'\n        WHEN all_txn.user_id LIKE 'OD%' AND all_txn.channel_trn = 'OIH_1022' THEN 'AUTO Interest'\n        WHEN all_txn.channel_trn LIKE 'DGBMC%'OR all_txn.channel_trn LIKE 'MC%' THEN 'POS Online'\n        WHEN all_txn.channel_trn LIKE 'AIRP%' THEN 'POS Online'\n        WHEN upper(all_txn.remark) LIKE '%THANH TOAN TRUC TUYEN%' THEN 'POS Online'\n        WHEN upper(all_txn.remark) LIKE '%GIAO DICH POS%' THEN 'POS Transaction'\n        WHEN channel.tltxds LIKE '%Smrt IBT Bank trf-CA%' OR channel.tltxds LIKE '%ATM-3rdPty Trf-CA/CA%' THEN 'ATM Transfer'\n        WHEN upper(channel.tltxds) like '%WDL%' THEN 'ATM Withdraw'\n        WHEN all_txn.user_id LIKE 'EGWTL%' THEN 'IBMB eWallet'\n        WHEN all_txn.channel_trn LIKE 'DBQR%' OR all_txn.channel_trn LIKE 'QR%' THEN 'IBMB QR'\n        WHEN all_txn.user_id LIKE 'EBANK%'\n            AND ( all_txn.channel_trn LIKE 'EVN%'OR all_txn.channel_trn LIKE 'BWA%' ) THEN 'IBMB Billpay'\n        WHEN all_txn.user_id LIKE 'MB%' AND all_txn.channel_trn LIKE 'IRISBL%' THEN 'IBMB Billpay'\n        WHEN ( all_txn.user_id LIKE 'EBANK%' OR all_txn.user_id LIKE 'DGB%' )\n            AND ( all_txn.channel_trn LIKE 'OP1321%'\n                OR all_txn.channel_trn LIKE 'PO1321%'\n                OR all_txn.channel_trn LIKE 'VP1321%' ) THEN 'IBMB Billpay'\n        WHEN all_txn.user_id LIKE 'EBANK%'\n            AND ( all_txn.channel_trn LIKE 'EP1321%'\n                OR all_txn.channel_trn LIKE 'NP1321%' )\n            AND upper(all_txn.remark) LIKE '%THANH TOAN CHO HD%' THEN 'IBMB Billpay'\n        WHEN all_txn.user_id LIKE 'EBANK%' AND all_txn.channel_trn = 'NP1321B' THEN 'IBMB Billpay'\n        WHEN ( all_txn.user_id LIKE 'IBPRU%' AND all_txn.channel_trn LIKE 'IBPRU%' ) THEN 'IBMB Billpay'\n        WHEN all_txn.user_id LIKE 'TAXONLINE%' AND all_txn.channel_trn LIKE 'TO%' THEN 'IBMB Billpay'\n        WHEN all_txn.user_id LIKE 'MB%' AND all_txn.channel_trn LIKE 'IRISTP%' THEN 'IBMB Topup'\n        WHEN all_txn.user_id LIKE 'DGB%'\n            AND all_txn.channel_trn LIKE 'EP%'\n            AND ( upper(all_txn.remark) LIKE '%TOPUP%' ) THEN 'IBMB Topup'\n        WHEN all_txn.user_id LIKE 'DGB%'\n            AND all_txn.channel_trn LIKE 'EP%'\n            AND ( upper(all_txn.remark) LIKE '%BUY CARD%'\n                AND upper(all_txn.remark) LIKE '%PREPAID%' ) THEN 'IBMB Topup'\n        WHEN all_txn.user_id LIKE 'EBANK%'\n            AND all_txn.channel_trn = '3220'\n            AND channel.tltxds LIKE 'FD%' THEN 'IBMB Product'\n        WHEN all_txn.channel_trn = '3603' AND channel.tltxds = 'FD Add on By Trf' THEN 'IBMB Product'\n        WHEN all_txn.user_id LIKE 'CK%' AND all_txn.channel_trn LIKE 'CK%' THEN 'IBMB Product'\n        WHEN all_txn.user_id LIKE 'EBANK%'\n            AND ( all_txn.channel_trn = 'EB1321FCS'\n                OR all_txn.channel_trn LIKE 'EB3320%'\n                OR all_txn.channel_trn LIKE 'EB3603%' ) THEN 'IBMB Product'\n        WHEN all_txn.user_id LIKE 'ECOMNAPAS%' THEN 'IBMB Transaction'\n        WHEN all_txn.user_id LIKE 'IB%' AND all_txn.user_id LIKE '%247' THEN 'IBMB Transaction'\n        WHEN all_txn.user_id LIKE 'MSBDEB%' AND all_txn.channel_trn LIKE 'DEBI' THEN 'IBMB Transaction'\n        WHEN ( all_txn.user_id LIKE 'EBANK%'AND all_txn.channel_trn LIKE 'EB%' )\n            OR ( all_txn.user_id LIKE 'DGB%'AND all_txn.channel_trn LIKE 'MB%' ) THEN 'IBMB Transaction'\n        WHEN all_txn.user_id LIKE 'ACQ%' AND all_txn.channel_trn LIKE 'ACQ%' THEN 'IBMB Transaction'\n        WHEN all_txn.user_id LIKE 'GNV%' AND all_txn.channel_trn LIKE '%1321GNV' THEN 'Online Disbursement'\n        WHEN ( all_txn.user_id LIKE 'DD%' OR all_txn.user_id LIKE 'COUNTER%' OR all_txn.user_id LIKE '%TELLER%' )\n            AND ( all_txn.channel_trn LIKE 'BLING%'\n                OR all_txn.channel_trn LIKE 'BWA%'\n                OR all_txn.channel_trn LIKE 'EVN%' ) THEN 'COUNTER Billpay'\n        WHEN ( all_txn.user_id LIKE 'DD%'\n                OR all_txn.user_id LIKE 'XD%'\n                OR all_txn.user_id LIKE 'XP%'\n                OR all_txn.user_id LIKE 'DP%'\n                OR all_txn.user_id LIKE 'LN%' )\n            AND (channel.tltxds LIKE 'LN%' OR channel.tltxds LIKE 'FD%' ) THEN 'COUNTER Product'\n        WHEN ( all_txn.user_id LIKE 'IBDS%' AND all_txn.channel_trn LIKE 'BOND%' )\n            OR ( all_txn.user_id LIKE 'DSB%' AND all_txn.channel_trn LIKE 'DSB%' ) THEN 'COUNTER Product'\n        WHEN trncode.description = 'CLOSING DEBIT INTEREST' THEN 'COUNTER Closing'\n        WHEN trncode.trn_code IN ('155', '160', '169', '180', '269') THEN 'COUNTER Fee and Interest'\n        WHEN all_txn.user_id LIKE 'GNV%' AND all_txn.channel_trn LIKE '%1321GNV' THEN 'Online Disbursement'\n        ELSE 'COUNTER Transaction'\n    END AS channel_level2\n    , CASE\n        WHEN all_txn.user_id LIKE 'IBDS%'\n          OR all_txn.channel_trn LIKE 'BOND%'\n          OR all_txn.user_id LIKE 'DSB%'\n          OR all_txn.channel_trn LIKE 'DSB%' THEN 'BOND'\n        WHEN all_txn.dorc_ind = 'D'\n          AND (all_txn.user_id LIKE'DD%'\n            OR all_txn.user_id LIKE 'XD%'\n            OR all_txn.user_id LIKE 'XP%'\n            OR all_txn.user_id LIKE 'DP%'\n            OR all_txn.user_id LIKE 'LN%'\n            OR all_txn.channel_trn = '3220'\n            OR all_txn.channel_trn = '3603')\n          AND (channel.tltxds  LIKE '%FD%') THEN 'FD'\n        WHEN all_txn.dorc_ind = 'D' AND UPPER(all_txn.remark) LIKE '%BAO HIEM%' THEN 'BANCA'\n        WHEN remark.TYPE IS NOT NULL THEN remark.TYPE\n    END AS channel_product_type\n    , c.account_no AS account_number\n    , d.customer_number\n    , dated.date_id AS trans_date_id\n    , cus.customer_number AS related_customer_number\n  FROM\n  all_txn\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_dwh__csdm_transaction_code trncode ON all_txn.trn_sk = trncode.tran_sk\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002 C ON all_txn.account_no_sk = C.account_no_sk\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__casa_account d ON C.account_no = d.account_number\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_casa_channel_trn_type channel ON all_txn.channel_trn = trim(channel.tltxcd)\n  LEFT JOIN \"oracle_dgaworkzone\".mart.dim__date dated ON all_txn.trn_date = dated.julian_date\n  LEFT JOIN oracle_dgaworkzone.staging.temp_daily_transaction_remark_define_product remark\n    ON all_txn.txn_id = remark.txn_id\n    AND all_txn.dorc_ind = remark.dorc_ind\n  LEFT JOIN cus  ON cus.ACCOUNT_NUMBER = all_txn.RELATED_ACCOUNT ANd cus.rn = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__trans_casa_test"}, "model.dga_data_model.fct__agg_casa_bal_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.dim__date", "model.dga_data_model.fct__agg_casa_bal_daily"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_monthly"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "monthly", "fct__agg_casa_bal_monthly"], "unique_id": "model.dga_data_model.fct__agg_casa_bal_monthly", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}']\r\n    )\r\n}}\r\nWITH dat_date_dim AS (\r\n  SELECT\r\n      date_id\r\n    , month_id\r\n  FROM\r\n    {{ ref('dim__date')}}\r\n  WHERE\r\n    julian_date BETWEEN 2020001 AND {{ var('end_month_julian_date_m')}}\r\n    AND date_value = month_end_date\r\n)\r\n, dat_result AS (\r\n  SELECT\r\n      a.month_id\r\n    , b.date_id\r\n    , b.customer_number\r\n    , b.account_number\r\n    , b.eop_bal\r\n    , b.sum_eop_bal_mtd\r\n    , LAG(b.eop_bal, 1, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_1_month\r\n    , LAG(b.eop_bal, 3, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_3_month\r\n    , LAG(b.eop_bal, 6, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_6_month\r\n    , LAG(b.eop_bal, 9, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_9_month\r\n    , LAG(b.eop_bal, 12, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_12_month\r\n    , b.avg_bal_mtd AS avg_bal\r\n    , LAG(b.avg_bal_mtd, 1, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_1_month\r\n    , LAG(b.avg_bal_mtd, 3, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_3_month\r\n    , LAG(b.avg_bal_mtd, 6, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_6_month\r\n    , LAG(b.avg_bal_mtd, 9, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_9_month\r\n    , LAG(b.avg_bal_mtd, 12, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_12_month\r\n  FROM\r\n    dat_date_dim a\r\n  LEFT JOIN {{ ref('fct__agg_casa_bal_daily')}} b ON a.date_id = b.date_id\r\n)\r\n, results AS (\r\n  SELECT\r\n      month_id\r\n    , customer_number\r\n    , account_number\r\n    , eop_bal\r\n    , sum_eop_bal_mtd AS sum_accu_eop_bal\r\n    , eop_bal_lag_1_month\r\n    , eop_bal_lag_3_month\r\n    , eop_bal_lag_6_month\r\n    , eop_bal_lag_9_month\r\n    , eop_bal_lag_12_month\r\n    , avg_bal\r\n    , avg_bal_lag_1_month\r\n    , avg_bal_lag_3_month\r\n    , avg_bal_lag_6_month\r\n    , avg_bal_lag_9_month\r\n    , avg_bal_lag_12_month\r\n  FROM\r\n    dat_result\r\n  WHERE\r\n    month_id = {{ var('month_id_m')}}\r\n)\r\nSELECT * FROM results", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\monthly\\fct__agg_casa_bal_monthly.sql", "original_file_path": "models\\mart\\monthly\\fct__agg_casa_bal_monthly.sql", "name": "fct__agg_casa_bal_monthly", "alias": "fct__agg_casa_bal_monthly", "checksum": {"name": "sha256", "checksum": "2018f91452f2f2031e6872cf6c04da491a14810d81644d260c102c30118b3eee"}, "tags": ["pkg_monthly"], "refs": [["dim__date"], ["fct__agg_casa_bal_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\monthly\\fct__agg_casa_bal_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_monthly", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}"]}, "created_at": 1685959751.273345, "compiled_code": "\nWITH dat_date_dim AS (\n  SELECT\n      date_id\n    , month_id\n  FROM\n    \"oracle_dgaworkzone\".mart.dim__date\n  WHERE\n    julian_date BETWEEN 2020001 AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYDDD'))\n    AND date_value = month_end_date\n)\n, dat_result AS (\n  SELECT\n      a.month_id\n    , b.date_id\n    , b.customer_number\n    , b.account_number\n    , b.eop_bal\n    , b.sum_eop_bal_mtd\n    , LAG(b.eop_bal, 1, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_1_month\n    , LAG(b.eop_bal, 3, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_3_month\n    , LAG(b.eop_bal, 6, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_6_month\n    , LAG(b.eop_bal, 9, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_9_month\n    , LAG(b.eop_bal, 12, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS eop_bal_lag_12_month\n    , b.avg_bal_mtd AS avg_bal\n    , LAG(b.avg_bal_mtd, 1, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_1_month\n    , LAG(b.avg_bal_mtd, 3, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_3_month\n    , LAG(b.avg_bal_mtd, 6, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_6_month\n    , LAG(b.avg_bal_mtd, 9, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_9_month\n    , LAG(b.avg_bal_mtd, 12, 0) OVER(PARTITION BY b.account_number ORDER BY a.month_id) AS avg_bal_lag_12_month\n  FROM\n    dat_date_dim a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_casa_bal_daily b ON a.date_id = b.date_id\n)\n, results AS (\n  SELECT\n      month_id\n    , customer_number\n    , account_number\n    , eop_bal\n    , sum_eop_bal_mtd AS sum_accu_eop_bal\n    , eop_bal_lag_1_month\n    , eop_bal_lag_3_month\n    , eop_bal_lag_6_month\n    , eop_bal_lag_9_month\n    , eop_bal_lag_12_month\n    , avg_bal\n    , avg_bal_lag_1_month\n    , avg_bal_lag_3_month\n    , avg_bal_lag_6_month\n    , avg_bal_lag_9_month\n    , avg_bal_lag_12_month\n  FROM\n    dat_result\n  WHERE\n    month_id = to_number(to_char(sysdate - interval '1' month, 'YYYYMM'))\n)\nSELECT * FROM results", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_casa_bal_monthly"}, "model.dga_data_model.fct__agg_casa_txn_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all", "model.dga_data_model.stg_landing__df_casa_channel_trn_type", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.int__casa_account"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_monthly"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "monthly", "fct__agg_casa_txn_monthly"], "unique_id": "model.dga_data_model.fct__agg_casa_txn_monthly", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}']\r\n    )\r\n}}\r\nWITH dat_casa_trans AS (\r\n  SELECT\r\n      a.*\r\n    , b.tltxds AS channel_desc_it\r\n    , c.account_no\r\n    , d.customer_number AS customer_number\r\n  FROM\r\n      {{ ref('stg_landing__vw_df_demanddeposit_transaction001_union_all')}} a\r\n  LEFT JOIN {{ ref('stg_landing__df_casa_channel_trn_type')}} b ON a.channel_trn = b.tltxcd\r\n  LEFT JOIN {{ ref('stg_landing__demanddeposit_master002')}} c ON a.account_no_sk = c.account_no_sk\r\n  LEFT JOIN {{ ref('int__casa_account')}} d ON c.account_no = d.account_number\r\n  WHERE\r\n    a.trn_date BETWEEN {{ var('start_month_julian_date_m')}} AND {{ var('end_month_julian_date_m')}}\r\n)\r\n, dat_casa_trans_channel_lv2 AS (\r\n  SELECT\r\n      a.customer_number\r\n    , a.account_no\r\n    , a.dorc_ind\r\n    , a.lcy_amount\r\n    , CASE\r\n    -- AUTO\r\n    -- Autopay\r\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1321' THEN 'AUTO Autopay'\r\n        WHEN user_id LIKE 'AUTO%' THEN 'AUTO Autopay'\r\n        WHEN user_id LIKE 'CADPAYTL' THEN 'AUTO Autopay'\r\n    -- Fee\r\n        WHEN user_id LIKE 'FEE%' OR user_id = 'MSBSWEE' THEN 'AUTO Fee'\r\n        WHEN upper(channel_desc_it) LIKE 'CHG' THEN 'AUTO Fee'\r\n        WHEN channel_trn IN ( '0800', '0801' ) THEN 'AUTO Fee'\r\n        WHEN user_id LIKE 'PLUT%' OR user_id = 'MSBPAY' THEN 'AUTO Fee'\r\n    -- Interest\r\n        WHEN upper(channel_desc_it) LIKE '%ODINT%' THEN 'AUTO Interest'\r\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1022' THEN 'AUTO Interest'\r\n   -- POS\r\n   -- Online\r\n        WHEN channel_trn LIKE 'DGBMC%' OR channel_trn LIKE 'MC%' THEN 'POS Online'\r\n        WHEN channel_trn LIKE 'AIRP%' THEN 'POS Online'\r\n        WHEN upper(remark) LIKE '%THANH TOAN TRUC TUYEN%' THEN 'POS Online'\r\n    -- Transaction\r\n        WHEN upper(remark) LIKE '%GIAO DICH POS%' THEN 'POS Transaction'\r\n    -- ATM\r\n    -- Transfer\r\n        WHEN channel_desc_it LIKE '%Smrt IBT Bank trf-CA%'\r\n          OR channel_desc_it LIKE '%ATM-3rdPty Trf-CA/CA%' THEN 'ATM Transfer'\r\n    -- Withdraw\r\n        WHEN channel_desc_it LIKE '%Smrtlnk csh wdl-CA%'\r\n          OR channel_desc_it LIKE '%Debit Card Wdl-CA OS%'\r\n          OR channel_desc_it LIKE '%VisDebitCardWdl-CAOS%'\r\n          OR channel_desc_it LIKE '%ATM Cash WDL - CA%' THEN 'ATM Withdraw'\r\n    -- IBMB\r\n    -- eWallet\r\n        WHEN user_id LIKE 'EGWTL%' THEN 'IBMB eWallet'\r\n    -- QR\r\n        WHEN channel_trn LIKE 'DBQR%' OR channel_trn LIKE 'QR%' THEN 'IBMB QR'\r\n    -- Bill pay\r\n        WHEN user_id LIKE 'EBANK%' AND ( channel_trn LIKE 'EVN%'\r\n                OR channel_trn LIKE 'BWA%' ) THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISBL%' THEN 'IBMB Billpay'\r\n        WHEN ( user_id LIKE 'EBANK' OR user_id LIKE 'DGB%' )\r\n          AND ( channel_trn LIKE 'OP1321%'\r\n            OR channel_trn LIKE 'PO1321%'\r\n            OR channel_trn LIKE 'VP1321%' ) THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'EBANK%'\r\n          AND ( channel_trn LIKE 'EP1321%'\r\n              OR channel_trn LIKE 'NP1321%' )\r\n          AND upper(remark) LIKE '%THANH TOAN CHO HD%' THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = 'NP1321B' THEN 'IBMB Billpay'\r\n        WHEN ( user_id LIKE 'IBPRU%' AND channel_trn LIKE 'IBPRU%' ) THEN 'IBMB Billpay'\r\n        WHEN user_id LIKE 'TAXONLINE%' AND channel_trn LIKE 'TO%' THEN 'IBMB Billpay'\r\n    -- Topup\r\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISTP%' THEN 'IBMB Topup'\r\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND ( upper(remark) LIKE '%TOPUP%' ) THEN 'IBMB Topup'\r\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND ( upper(remark) LIKE '%BUY CARD%' AND upper(remark) LIKE '%PREPAID%' ) THEN 'IBMB Topup'\r\n    -- Product\r\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = '3220' AND channel_desc_it LIKE 'FD%' THEN 'IBMB Product'\r\n        WHEN channel_trn = '3603' AND channel_desc_it = 'FD Add on By Trf' THEN 'IBMB Product'\r\n        WHEN user_id LIKE 'CK%' AND channel_trn LIKE 'CK%' THEN 'IBMB Product'\r\n        WHEN user_id LIKE 'GNV%' AND channel_trn LIKE '%1321GNV' THEN 'IBMB Product'\r\n        WHEN user_id LIKE 'EBANK%'\r\n          AND ( channel_trn = 'EB1321FCS'\r\n            OR channel_trn LIKE 'EB3320%'\r\n            OR channel_trn LIKE 'EB3603%' ) THEN 'IBMB Product'\r\n    -- Transaction\r\n        WHEN user_id LIKE 'ECOMNAPAS%' THEN 'IBMB Transaction'\r\n        WHEN user_id LIKE 'IB%' AND user_id LIKE '%247' THEN 'IBMB Transaction'\r\n        WHEN user_id LIKE 'MSBDEB%' AND channel_trn LIKE 'DEBI' THEN 'IBMB Transaction'\r\n        WHEN ( user_id LIKE 'EBANK%' AND channel_trn LIKE 'EB%' )\r\n          OR ( user_id LIKE 'DGB%' AND channel_trn LIKE 'MB%' ) THEN 'IBMB Transaction'\r\n        WHEN user_id LIKE 'ACQ%' AND channel_trn LIKE 'ACQ%' THEN 'IBMB Transaction'\r\n    -- COUNTER\r\n    -- Billpay\r\n        WHEN ( user_id LIKE 'DD%'\r\n            OR user_id LIKE 'COUNTER%'\r\n            OR user_id LIKE '%TELLER%' )\r\n          AND ( channel_trn LIKE 'BLING%'\r\n            OR channel_trn LIKE 'BWA%'\r\n            OR channel_trn LIKE 'EVN%' ) THEN 'COUNTER Billpay'\r\n    -- Product\r\n        WHEN ( user_id LIKE 'DD%'\r\n            OR user_id LIKE 'XD%'\r\n            OR user_id LIKE 'XP%'\r\n            OR user_id LIKE 'DP%'\r\n            OR user_id LIKE 'LN%' )\r\n          AND ( channel_desc_it LIKE 'LN%'\r\n            OR channel_desc_it LIKE 'FD%' ) THEN 'COUNTER Product'\r\n        WHEN ( user_id LIKE 'IBDS%' AND channel_trn LIKE 'BOND%' )\r\n          OR ( user_id LIKE 'DSB%' AND channel_trn LIKE 'DSB%' ) THEN 'COUNTER Product'\r\n    -- Transaction\r\n      ELSE 'COUNTER Transaction'\r\n    END AS channel_level2\r\n  FROM\r\n    dat_casa_trans a\r\n)\r\n, dat_casa_trans_channel_lv1 AS (\r\n  SELECT\r\n      a.customer_number\r\n    , a.account_no\r\n    , a.dorc_ind\r\n    , a.lcy_amount\r\n    , a.channel_level2\r\n    , CASE\r\n        WHEN channel_level2 LIKE 'AUTO%' THEN 'AUTO'\r\n        WHEN channel_level2 LIKE 'ATM%' THEN 'ATM'\r\n        WHEN channel_level2 LIKE 'IBMB%' THEN 'IBMB'\r\n        WHEN channel_level2 LIKE 'POS%' THEN 'POS'\r\n        WHEN channel_level2 LIKE 'COUNTER%' THEN 'COUNTER'\r\n        ELSE 'OTHER'\r\n      END AS channel_level1\r\n  FROM\r\n    dat_casa_trans_channel_lv2 a\r\n)\r\n, dat_casa_trans_w_channel AS (\r\n  SELECT\r\n      customer_number\r\n    , account_no\r\n    , dorc_ind\r\n    , lcy_amount\r\n    , channel_level1\r\n    , channel_level2\r\n  FROM\r\n    dat_casa_trans_channel_lv1\r\n)\r\n, dat_result AS (\r\n  SELECT\r\n      customer_number\r\n    , account_no\r\n    , dorc_ind\r\n    , channel_level1\r\n    , channel_level2\r\n    , MAX(lcy_amount)        AS max_lcy_transaction_amount\r\n    , MIN(lcy_amount)        AS min_lcy_transaction_amount\r\n    , round(AVG(lcy_amount)) AS avg_lcy_transaction_amount\r\n    , SUM(lcy_amount)        AS sum_lcy_transaction_amount\r\n    , COUNT(*)               AS count_transaction\r\n  FROM\r\n      dat_casa_trans_w_channel\r\n  GROUP BY\r\n      customer_number\r\n    , account_no\r\n    , dorc_ind\r\n    , channel_level1\r\n    , channel_level2\r\n)\r\n, results AS (\r\n  SELECT\r\n      {{ var('month_id_m')}} AS month_id\r\n    , customer_number\r\n    , account_no AS account_number\r\n    , dorc_ind AS debit_credit_code\r\n    , channel_level1\r\n    , channel_level2\r\n    , max_lcy_transaction_amount AS max_lcy_txn_amount\r\n    , min_lcy_transaction_amount AS min_lcy_txn_amount\r\n    , avg_lcy_transaction_amount AS avg_lcy_txn_amount\r\n    , sum_lcy_transaction_amount AS sum_lcy_txn_amount\r\n    , count_transaction AS COUNT_TXN\r\n  FROM\r\n    dat_result\r\n)\r\nSELECT * FROM results", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\monthly\\fct__agg_casa_txn_monthly.sql", "original_file_path": "models\\mart\\monthly\\fct__agg_casa_txn_monthly.sql", "name": "fct__agg_casa_txn_monthly", "alias": "fct__agg_casa_txn_monthly", "checksum": {"name": "sha256", "checksum": "b857e5a7770d6d8f9819953a108d2320c7de53fbb71c110169ff9e33e0e78fe5"}, "tags": ["pkg_monthly"], "refs": [["stg_landing__vw_df_demanddeposit_transaction001_union_all"], ["stg_landing__df_casa_channel_trn_type"], ["stg_landing__demanddeposit_master002"], ["int__casa_account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\monthly\\fct__agg_casa_txn_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_monthly", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}"]}, "created_at": 1685959751.279335, "compiled_code": "\nWITH dat_casa_trans AS (\n  SELECT\n      a.*\n    , b.tltxds AS channel_desc_it\n    , c.account_no\n    , d.customer_number AS customer_number\n  FROM\n      \"oracle_dgaworkzone\".staging.stg_landing__vw_df_demanddeposit_transaction001_union_all a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_casa_channel_trn_type b ON a.channel_trn = b.tltxcd\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002 c ON a.account_no_sk = c.account_no_sk\n  LEFT JOIN \"oracle_dgaworkzone\".int.int__casa_account d ON c.account_no = d.account_number\n  WHERE\n    a.trn_date BETWEEN to_number(to_char(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM'), 'YYYYDDD')) AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYDDD'))\n)\n, dat_casa_trans_channel_lv2 AS (\n  SELECT\n      a.customer_number\n    , a.account_no\n    , a.dorc_ind\n    , a.lcy_amount\n    , CASE\n    -- AUTO\n    -- Autopay\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1321' THEN 'AUTO Autopay'\n        WHEN user_id LIKE 'AUTO%' THEN 'AUTO Autopay'\n        WHEN user_id LIKE 'CADPAYTL' THEN 'AUTO Autopay'\n    -- Fee\n        WHEN user_id LIKE 'FEE%' OR user_id = 'MSBSWEE' THEN 'AUTO Fee'\n        WHEN upper(channel_desc_it) LIKE 'CHG' THEN 'AUTO Fee'\n        WHEN channel_trn IN ( '0800', '0801' ) THEN 'AUTO Fee'\n        WHEN user_id LIKE 'PLUT%' OR user_id = 'MSBPAY' THEN 'AUTO Fee'\n    -- Interest\n        WHEN upper(channel_desc_it) LIKE '%ODINT%' THEN 'AUTO Interest'\n        WHEN user_id LIKE 'OD%' AND channel_trn = 'OIH_1022' THEN 'AUTO Interest'\n   -- POS\n   -- Online\n        WHEN channel_trn LIKE 'DGBMC%' OR channel_trn LIKE 'MC%' THEN 'POS Online'\n        WHEN channel_trn LIKE 'AIRP%' THEN 'POS Online'\n        WHEN upper(remark) LIKE '%THANH TOAN TRUC TUYEN%' THEN 'POS Online'\n    -- Transaction\n        WHEN upper(remark) LIKE '%GIAO DICH POS%' THEN 'POS Transaction'\n    -- ATM\n    -- Transfer\n        WHEN channel_desc_it LIKE '%Smrt IBT Bank trf-CA%'\n          OR channel_desc_it LIKE '%ATM-3rdPty Trf-CA/CA%' THEN 'ATM Transfer'\n    -- Withdraw\n        WHEN channel_desc_it LIKE '%Smrtlnk csh wdl-CA%'\n          OR channel_desc_it LIKE '%Debit Card Wdl-CA OS%'\n          OR channel_desc_it LIKE '%VisDebitCardWdl-CAOS%'\n          OR channel_desc_it LIKE '%ATM Cash WDL - CA%' THEN 'ATM Withdraw'\n    -- IBMB\n    -- eWallet\n        WHEN user_id LIKE 'EGWTL%' THEN 'IBMB eWallet'\n    -- QR\n        WHEN channel_trn LIKE 'DBQR%' OR channel_trn LIKE 'QR%' THEN 'IBMB QR'\n    -- Bill pay\n        WHEN user_id LIKE 'EBANK%' AND ( channel_trn LIKE 'EVN%'\n                OR channel_trn LIKE 'BWA%' ) THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISBL%' THEN 'IBMB Billpay'\n        WHEN ( user_id LIKE 'EBANK' OR user_id LIKE 'DGB%' )\n          AND ( channel_trn LIKE 'OP1321%'\n            OR channel_trn LIKE 'PO1321%'\n            OR channel_trn LIKE 'VP1321%' ) THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'EBANK%'\n          AND ( channel_trn LIKE 'EP1321%'\n              OR channel_trn LIKE 'NP1321%' )\n          AND upper(remark) LIKE '%THANH TOAN CHO HD%' THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = 'NP1321B' THEN 'IBMB Billpay'\n        WHEN ( user_id LIKE 'IBPRU%' AND channel_trn LIKE 'IBPRU%' ) THEN 'IBMB Billpay'\n        WHEN user_id LIKE 'TAXONLINE%' AND channel_trn LIKE 'TO%' THEN 'IBMB Billpay'\n    -- Topup\n        WHEN user_id LIKE 'MB%' AND channel_trn LIKE 'IRISTP%' THEN 'IBMB Topup'\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND ( upper(remark) LIKE '%TOPUP%' ) THEN 'IBMB Topup'\n        WHEN user_id LIKE 'DGB%' AND channel_trn LIKE 'EP%' AND ( upper(remark) LIKE '%BUY CARD%' AND upper(remark) LIKE '%PREPAID%' ) THEN 'IBMB Topup'\n    -- Product\n        WHEN user_id LIKE 'EBANK%' AND channel_trn = '3220' AND channel_desc_it LIKE 'FD%' THEN 'IBMB Product'\n        WHEN channel_trn = '3603' AND channel_desc_it = 'FD Add on By Trf' THEN 'IBMB Product'\n        WHEN user_id LIKE 'CK%' AND channel_trn LIKE 'CK%' THEN 'IBMB Product'\n        WHEN user_id LIKE 'GNV%' AND channel_trn LIKE '%1321GNV' THEN 'IBMB Product'\n        WHEN user_id LIKE 'EBANK%'\n          AND ( channel_trn = 'EB1321FCS'\n            OR channel_trn LIKE 'EB3320%'\n            OR channel_trn LIKE 'EB3603%' ) THEN 'IBMB Product'\n    -- Transaction\n        WHEN user_id LIKE 'ECOMNAPAS%' THEN 'IBMB Transaction'\n        WHEN user_id LIKE 'IB%' AND user_id LIKE '%247' THEN 'IBMB Transaction'\n        WHEN user_id LIKE 'MSBDEB%' AND channel_trn LIKE 'DEBI' THEN 'IBMB Transaction'\n        WHEN ( user_id LIKE 'EBANK%' AND channel_trn LIKE 'EB%' )\n          OR ( user_id LIKE 'DGB%' AND channel_trn LIKE 'MB%' ) THEN 'IBMB Transaction'\n        WHEN user_id LIKE 'ACQ%' AND channel_trn LIKE 'ACQ%' THEN 'IBMB Transaction'\n    -- COUNTER\n    -- Billpay\n        WHEN ( user_id LIKE 'DD%'\n            OR user_id LIKE 'COUNTER%'\n            OR user_id LIKE '%TELLER%' )\n          AND ( channel_trn LIKE 'BLING%'\n            OR channel_trn LIKE 'BWA%'\n            OR channel_trn LIKE 'EVN%' ) THEN 'COUNTER Billpay'\n    -- Product\n        WHEN ( user_id LIKE 'DD%'\n            OR user_id LIKE 'XD%'\n            OR user_id LIKE 'XP%'\n            OR user_id LIKE 'DP%'\n            OR user_id LIKE 'LN%' )\n          AND ( channel_desc_it LIKE 'LN%'\n            OR channel_desc_it LIKE 'FD%' ) THEN 'COUNTER Product'\n        WHEN ( user_id LIKE 'IBDS%' AND channel_trn LIKE 'BOND%' )\n          OR ( user_id LIKE 'DSB%' AND channel_trn LIKE 'DSB%' ) THEN 'COUNTER Product'\n    -- Transaction\n      ELSE 'COUNTER Transaction'\n    END AS channel_level2\n  FROM\n    dat_casa_trans a\n)\n, dat_casa_trans_channel_lv1 AS (\n  SELECT\n      a.customer_number\n    , a.account_no\n    , a.dorc_ind\n    , a.lcy_amount\n    , a.channel_level2\n    , CASE\n        WHEN channel_level2 LIKE 'AUTO%' THEN 'AUTO'\n        WHEN channel_level2 LIKE 'ATM%' THEN 'ATM'\n        WHEN channel_level2 LIKE 'IBMB%' THEN 'IBMB'\n        WHEN channel_level2 LIKE 'POS%' THEN 'POS'\n        WHEN channel_level2 LIKE 'COUNTER%' THEN 'COUNTER'\n        ELSE 'OTHER'\n      END AS channel_level1\n  FROM\n    dat_casa_trans_channel_lv2 a\n)\n, dat_casa_trans_w_channel AS (\n  SELECT\n      customer_number\n    , account_no\n    , dorc_ind\n    , lcy_amount\n    , channel_level1\n    , channel_level2\n  FROM\n    dat_casa_trans_channel_lv1\n)\n, dat_result AS (\n  SELECT\n      customer_number\n    , account_no\n    , dorc_ind\n    , channel_level1\n    , channel_level2\n    , MAX(lcy_amount)        AS max_lcy_transaction_amount\n    , MIN(lcy_amount)        AS min_lcy_transaction_amount\n    , round(AVG(lcy_amount)) AS avg_lcy_transaction_amount\n    , SUM(lcy_amount)        AS sum_lcy_transaction_amount\n    , COUNT(*)               AS count_transaction\n  FROM\n      dat_casa_trans_w_channel\n  GROUP BY\n      customer_number\n    , account_no\n    , dorc_ind\n    , channel_level1\n    , channel_level2\n)\n, results AS (\n  SELECT\n      to_number(to_char(sysdate - interval '1' month, 'YYYYMM')) AS month_id\n    , customer_number\n    , account_no AS account_number\n    , dorc_ind AS debit_credit_code\n    , channel_level1\n    , channel_level2\n    , max_lcy_transaction_amount AS max_lcy_txn_amount\n    , min_lcy_transaction_amount AS min_lcy_txn_amount\n    , avg_lcy_transaction_amount AS avg_lcy_txn_amount\n    , sum_lcy_transaction_amount AS sum_lcy_txn_amount\n    , count_transaction AS COUNT_TXN\n  FROM\n    dat_result\n)\nSELECT * FROM results", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_casa_txn_monthly"}, "model.dga_data_model.fct__agg_fd_bal_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_monthly"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "monthly", "fct__agg_fd_bal_monthly"], "unique_id": "model.dga_data_model.fct__agg_fd_bal_monthly", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}']\r\n    )\r\n}}\r\nWITH dat_account_rn AS (\r\n  SELECT DISTINCT\r\n      {{ var('month_id_m')}} AS month_id\r\n    , customer_number\r\n    , account_number\r\n    , ROW_NUMBER() OVER(PARTITION BY account_number ORDER BY date_id DESC) AS rn\r\n  FROM\r\n    {{ ref('fct__agg_fd_bal_daily')}}\r\n  WHERE\r\n    date_id BETWEEN {{ var('start_month_date_m')}} AND {{ var('end_month_date_m')}}\r\n)\r\n, dat_account AS (\r\n  SELECT\r\n      *\r\n  FROM\r\n    dat_account_rn\r\n  WHERE\r\n      rn = 1\r\n)\r\n, dat_eop_bal AS (\r\n  SELECT\r\n      a.account_number\r\n    , nvl(b.eop_bal, 0) AS eop_bal\r\n  FROM\r\n      dat_account             a\r\n  LEFT JOIN {{ ref('fct__agg_fd_bal_daily')}} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('end_month_date_m')}}\r\n)\r\n, dat_sum_accu_eop_bal AS (\r\n  SELECT\r\n      a.account_number\r\n    , nvl(SUM(b.eop_bal), 0) AS sum_accu_eop_bal\r\n  FROM\r\n    dat_account             a\r\n  LEFT JOIN {{ ref('fct__agg_fd_bal_daily')}} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id BETWEEN {{ var('start_month_date_m')}} AND {{ var('end_month_date_m')}}\r\n  GROUP BY\r\n      a.account_number\r\n)\r\n, results AS (\r\n  SELECT\r\n      a.month_id\r\n    , a.customer_number\r\n    , a.account_number\r\n    , b.eop_bal\r\n    , c.sum_accu_eop_bal\r\n  FROM\r\n      dat_account          a\r\n  LEFT JOIN dat_eop_bal b ON a.account_number = b.account_number\r\n  LEFT JOIN dat_sum_accu_eop_bal c ON a.account_number = c.account_number\r\n)\r\nSELECT * FROM results", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\monthly\\fct__agg_fd_bal_monthly.sql", "original_file_path": "models\\mart\\monthly\\fct__agg_fd_bal_monthly.sql", "name": "fct__agg_fd_bal_monthly", "alias": "fct__agg_fd_bal_monthly", "checksum": {"name": "sha256", "checksum": "4375a07fae7ba38fa4a1072af1065141572ae6ed746227bb0aa354a26bb72760"}, "tags": ["pkg_monthly"], "refs": [["fct__agg_fd_bal_daily"], ["fct__agg_fd_bal_daily"], ["fct__agg_fd_bal_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\monthly\\fct__agg_fd_bal_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_monthly", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}"]}, "created_at": 1685959751.2873297, "compiled_code": "\nWITH dat_account_rn AS (\n  SELECT DISTINCT\n      to_number(to_char(sysdate - interval '1' month, 'YYYYMM')) AS month_id\n    , customer_number\n    , account_number\n    , ROW_NUMBER() OVER(PARTITION BY account_number ORDER BY date_id DESC) AS rn\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily\n  WHERE\n    date_id BETWEEN to_number(to_char(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM'), 'YYYYMMDD')) AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYMMDD'))\n)\n, dat_account AS (\n  SELECT\n      *\n  FROM\n    dat_account_rn\n  WHERE\n      rn = 1\n)\n, dat_eop_bal AS (\n  SELECT\n      a.account_number\n    , nvl(b.eop_bal, 0) AS eop_bal\n  FROM\n      dat_account             a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYMMDD'))\n)\n, dat_sum_accu_eop_bal AS (\n  SELECT\n      a.account_number\n    , nvl(SUM(b.eop_bal), 0) AS sum_accu_eop_bal\n  FROM\n    dat_account             a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_fd_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id BETWEEN to_number(to_char(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM'), 'YYYYMMDD')) AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYMMDD'))\n  GROUP BY\n      a.account_number\n)\n, results AS (\n  SELECT\n      a.month_id\n    , a.customer_number\n    , a.account_number\n    , b.eop_bal\n    , c.sum_accu_eop_bal\n  FROM\n      dat_account          a\n  LEFT JOIN dat_eop_bal b ON a.account_number = b.account_number\n  LEFT JOIN dat_sum_accu_eop_bal c ON a.account_number = c.account_number\n)\nSELECT * FROM results", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_fd_bal_monthly"}, "model.dga_data_model.fct__agg_ln_bal_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fct__agg_ln_bal_daily", "model.dga_data_model.fct__agg_ln_bal_daily", "model.dga_data_model.fct__agg_ln_bal_daily"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_monthly"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "monthly", "fct__agg_ln_bal_monthly"], "unique_id": "model.dga_data_model.fct__agg_ln_bal_monthly", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}']\r\n    )\r\n}}\r\nWITH dat_account_rn AS (\r\n  SELECT DISTINCT\r\n      {{ var('month_id_m')}} AS month_id\r\n    , customer_number\r\n    , account_number\r\n    , ROW_NUMBER() OVER(PARTITION BY account_number ORDER BY date_id DESC) AS rn\r\n  FROM\r\n    {{ ref('fct__agg_ln_bal_daily')}}\r\n  WHERE\r\n    date_id BETWEEN {{ var('start_month_date_m')}} AND {{ var('end_month_date_m')}}\r\n)\r\n, dat_account AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    dat_account_rn\r\n  WHERE\r\n    rn = 1\r\n)\r\n, dat_eop_bal AS (\r\n  SELECT\r\n      a.account_number\r\n    , nvl(b.eop_bal, 0) AS eop_bal\r\n  FROM\r\n    dat_account a\r\n  LEFT JOIN {{ ref('fct__agg_ln_bal_daily')}} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id = {{ var('end_month_date_m')}}\r\n)\r\n, dat_sum_accu_eop_bal AS (\r\n  SELECT\r\n      a.account_number\r\n    , nvl(SUM(b.eop_bal), 0) AS sum_accu_eop_bal\r\n  FROM\r\n    dat_account             a\r\n  LEFT JOIN {{ ref('fct__agg_ln_bal_daily')}} b\r\n    ON a.account_number = b.account_number\r\n    AND b.date_id BETWEEN {{ var('start_month_date_m')}} AND {{ var('end_month_date_m')}}\r\n  GROUP BY\r\n    a.account_number\r\n)\r\n, results AS (\r\n  SELECT\r\n    a.month_id\r\n  , a.customer_number\r\n  , a.account_number\r\n  , b.eop_bal\r\n  , c.sum_accu_eop_bal\r\n  FROM\r\n    dat_account a\r\n    LEFT JOIN dat_eop_bal b ON a.account_number = b.account_number\r\n    LEFT JOIN dat_sum_accu_eop_bal c ON a.account_number = c.account_number\r\n)\r\nSELECT * FROM results", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\monthly\\fct__agg_ln_bal_monthly.sql", "original_file_path": "models\\mart\\monthly\\fct__agg_ln_bal_monthly.sql", "name": "fct__agg_ln_bal_monthly", "alias": "fct__agg_ln_bal_monthly", "checksum": {"name": "sha256", "checksum": "477aef158fb0af1395bd9052a5425aa7b9877f73f122f30baf6b4946719774a1"}, "tags": ["pkg_monthly"], "refs": [["fct__agg_ln_bal_daily"], ["fct__agg_ln_bal_daily"], ["fct__agg_ln_bal_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\monthly\\fct__agg_ln_bal_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_monthly", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}"]}, "created_at": 1685959751.2963314, "compiled_code": "\nWITH dat_account_rn AS (\n  SELECT DISTINCT\n      to_number(to_char(sysdate - interval '1' month, 'YYYYMM')) AS month_id\n    , customer_number\n    , account_number\n    , ROW_NUMBER() OVER(PARTITION BY account_number ORDER BY date_id DESC) AS rn\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__agg_ln_bal_daily\n  WHERE\n    date_id BETWEEN to_number(to_char(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM'), 'YYYYMMDD')) AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYMMDD'))\n)\n, dat_account AS (\n  SELECT\n    *\n  FROM\n    dat_account_rn\n  WHERE\n    rn = 1\n)\n, dat_eop_bal AS (\n  SELECT\n      a.account_number\n    , nvl(b.eop_bal, 0) AS eop_bal\n  FROM\n    dat_account a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_ln_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id = to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYMMDD'))\n)\n, dat_sum_accu_eop_bal AS (\n  SELECT\n      a.account_number\n    , nvl(SUM(b.eop_bal), 0) AS sum_accu_eop_bal\n  FROM\n    dat_account             a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_ln_bal_daily b\n    ON a.account_number = b.account_number\n    AND b.date_id BETWEEN to_number(to_char(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM'), 'YYYYMMDD')) AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYMMDD'))\n  GROUP BY\n    a.account_number\n)\n, results AS (\n  SELECT\n    a.month_id\n  , a.customer_number\n  , a.account_number\n  , b.eop_bal\n  , c.sum_accu_eop_bal\n  FROM\n    dat_account a\n    LEFT JOIN dat_eop_bal b ON a.account_number = b.account_number\n    LEFT JOIN dat_sum_accu_eop_bal c ON a.account_number = c.account_number\n)\nSELECT * FROM results", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_ln_bal_monthly"}, "model.dga_data_model.fct__agg_od_bal_monthly": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.dim__date", "model.dga_data_model.fct__agg_od_bal_daily"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["pkg_monthly"], "meta": {"owner": "huyendtk3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": [{"sql": "DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}", "transaction": true, "index": null}]}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "monthly", "fct__agg_od_bal_monthly"], "unique_id": "model.dga_data_model.fct__agg_od_bal_monthly", "raw_code": "{{\r\n    config(\r\n      materialized='incremental',\r\n      pre_hook=['DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}']\r\n    )\r\n}}\r\nWITH dat_date_dim AS (\r\n  SELECT\r\n      date_id\r\n    , month_id\r\n  FROM\r\n    {{ ref('dim__date')}}\r\n  WHERE\r\n    julian_date BETWEEN 2020001 AND {{ var('end_month_julian_date_m')}}\r\n    AND date_value = month_end_date\r\n)\r\n, dat_result AS (\r\n  SELECT\r\n      a.month_id\r\n    , b.date_id\r\n    , b.customer_number\r\n    , b.account_number\r\n    , b.eop_bal\r\n    , b.sum_eop_bal_mtd\r\n  FROM\r\n    dat_date_dim a\r\n  LEFT JOIN {{ ref('fct__agg_od_bal_daily') }} b ON a.date_id = b.date_id\r\n)\r\n, results AS (\r\n  SELECT\r\n      month_id\r\n    , customer_number\r\n    , account_number\r\n    , eop_bal\r\n    , sum_eop_bal_mtd AS sum_accu_eop_bal\r\n  FROM\r\n    dat_result\r\n  WHERE\r\n    month_id = {{ var('month_id_m')}}\r\n)\r\nSELECT * FROM results", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\monthly\\fct__agg_od_bal_monthly.sql", "original_file_path": "models\\mart\\monthly\\fct__agg_od_bal_monthly.sql", "name": "fct__agg_od_bal_monthly", "alias": "fct__agg_od_bal_monthly", "checksum": {"name": "sha256", "checksum": "00dd5993612eefa791821e47e2a7cb36dbda19627d8c74e7b9cbe10901b627cf"}, "tags": ["pkg_monthly"], "refs": [["dim__date"], ["fct__agg_od_bal_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\monthly\\fct__agg_od_bal_monthly.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "huyendtk3"}, "tags": "pkg_monthly", "materialized": "incremental", "pre-hook": ["DELETE {{ this }}  WHERE month_id = {{ var(\"month_id_m\") }}"]}, "created_at": 1685959751.3063304, "compiled_code": "\nWITH dat_date_dim AS (\n  SELECT\n      date_id\n    , month_id\n  FROM\n    \"oracle_dgaworkzone\".mart.dim__date\n  WHERE\n    julian_date BETWEEN 2020001 AND to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - interval '1' month, 'YYYYMM')), 'YYYYMM')), 'YYYYDDD'))\n    AND date_value = month_end_date\n)\n, dat_result AS (\n  SELECT\n      a.month_id\n    , b.date_id\n    , b.customer_number\n    , b.account_number\n    , b.eop_bal\n    , b.sum_eop_bal_mtd\n  FROM\n    dat_date_dim a\n  LEFT JOIN \"oracle_dgaworkzone\".mart.fct__agg_od_bal_daily b ON a.date_id = b.date_id\n)\n, results AS (\n  SELECT\n      month_id\n    , customer_number\n    , account_number\n    , eop_bal\n    , sum_eop_bal_mtd AS sum_accu_eop_bal\n  FROM\n    dat_result\n  WHERE\n    month_id = to_number(to_char(sysdate - interval '1' month, 'YYYYMM'))\n)\nSELECT * FROM results", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_od_bal_monthly"}, "model.dga_data_model.report_eb_cashflow__cst_smy": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dga.tunglt_eb_health_financing", "source.dga_data_model.mart.dim__industry", "model.dga_data_model.dwh__ccl_pln", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.dim__customer"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["eb_rpt_cashflow"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "report", "eb_daily", "report_eb_cashflow__cst_smy"], "unique_id": "model.dga_data_model.report_eb_cashflow__cst_smy", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH nhom_no AS\r\n(\r\n    SELECT * FROM\r\n    (\r\n        SELECT\r\n            A.*\r\n            ,row_number() OVER(PARTITION BY cif ORDER BY import_date DESC,pln_sau_cic DESC) AS rn\r\n        FROM {{ ref('dwh__ccl_pln')}} A\r\n        WHERE pln_sau_cic IS NOT NULL\r\n    )\r\n    WHERE rn = 1\r\n)\r\n,final AS\r\n(\r\n    SELECT\r\n        DISTINCT A.cif\r\n        ,A.tax_code\r\n        ,A.ckdt\r\n        ,b.pln_sau_cic\r\n        ,C.revenue\r\n        ,D.customer_fullname_locale\r\n        ,nvl(E.msb_segment,'Kh\u00e1c') AS nhom_nganh_msb\r\n    FROM {{ ref('report_eb_cashflow__detail')}} A\r\n    LEFT JOIN nhom_no b\r\n        ON A.cif = b.cif\r\n    LEFT JOIN {{ source('dga', 'tunglt_eb_health_financing') }} c\r\n        ON A.tax_code = C.tax_code\r\n        AND C.YEAR = 2021\r\n    LEFT JOIN {{ ref('dim__customer')}} D\r\n        ON to_number(is_number(A.cif)) = D.customer_number\r\n        AND is_cur_rec = 1\r\n    LEFT JOIN {{ source('mart', 'dim__industry') }} E\r\n        ON D.industry_dim_id = E.industry_dim_id\r\n)\r\nSELECT * FROM final", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\report\\eb_daily\\report_eb_cashflow__cst_smy.sql", "original_file_path": "models\\mart\\report\\eb_daily\\report_eb_cashflow__cst_smy.sql", "name": "report_eb_cashflow__cst_smy", "alias": "report_eb_cashflow__cst_smy", "checksum": {"name": "sha256", "checksum": "9ee5b1fa74c6c872e7b0e0276732eaf1fe55461607f0f2e12b4b1c4acc240244"}, "tags": ["eb_rpt_cashflow"], "refs": [["dwh__ccl_pln"], ["report_eb_cashflow__detail"], ["dim__customer"]], "sources": [["dga", "tunglt_eb_health_financing"], ["mart", "dim__industry"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\report\\eb_daily\\eb_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\report\\eb_daily\\report_eb_cashflow__cst_smy.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "phuongnt89"}, "tags": ["eb_rpt_cashflow"], "materialized": "table"}, "created_at": 1685959752.8759809, "compiled_code": "\n\nWITH nhom_no AS\n(\n    SELECT * FROM\n    (\n        SELECT\n            A.*\n            ,row_number() OVER(PARTITION BY cif ORDER BY import_date DESC,pln_sau_cic DESC) AS rn\n        FROM \"oracle_dgaworkzone\".base.dwh__ccl_pln A\n        WHERE pln_sau_cic IS NOT NULL\n    )\n    WHERE rn = 1\n)\n,final AS\n(\n    SELECT\n        DISTINCT A.cif\n        ,A.tax_code\n        ,A.ckdt\n        ,b.pln_sau_cic\n        ,C.revenue\n        ,D.customer_fullname_locale\n        ,nvl(E.msb_segment,'Kh\u00e1c') AS nhom_nganh_msb\n    FROM \"oracle_dgaworkzone\".mart.report_eb_cashflow__detail A\n    LEFT JOIN nhom_no b\n        ON A.cif = b.cif\n    LEFT JOIN oracle_dgaworkzone.dga.tunglt_eb_health_financing c\n        ON A.tax_code = C.tax_code\n        AND C.YEAR = 2021\n    LEFT JOIN \"oracle_dgaworkzone\".mart.dim__customer D\n        ON to_number(is_number(A.cif)) = D.customer_number\n        AND is_cur_rec = 1\n    LEFT JOIN oracle_dgaworkzone.mart.dim__industry E\n        ON D.industry_dim_id = E.industry_dim_id\n)\nSELECT * FROM final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.report_eb_cashflow__cst_smy"}, "model.dga_data_model.report_eb_cashflow__detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dga.anlt4_eb_txn_processed", "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL", "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL", "source.dga_data_model.dga.thuvh3_eb_dm_luyke", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int_mercury__customer_ckdt", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["eb_rpt_cashflow"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "report", "eb_daily", "report_eb_cashflow__detail"], "unique_id": "model.dga_data_model.report_eb_cashflow__detail", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH t1 AS\r\n(\r\n    SELECT\r\n        substr(dayid,1,6) AS yearmonth\r\n        ,FIRST_VALUE(dayid) OVER(ORDER BY dayid DESC) AS max_dayid\r\n        ,dayid\r\n        ,to_char(customer_number) AS customer_number\r\n        ,account_no\r\n        ,debit_credit\r\n        ,channel\r\n        ,channel_trn\r\n        ,internal_external_final\r\n        ,receiver_type\r\n        ,trn_amt\r\n    FROM {{ source('dga', 'anlt4_eb_txn_processed') }}\r\n    WHERE\r\n        dayid >= 20220101\r\n        AND NOT (LOWER(remark) LIKE '%msb hoan tra giao dich chuyen khoan 247%' AND user_id LIKE 'CV%')\r\n)\r\n,txn AS\r\n(\r\n    SELECT\r\n        yearmonth\r\n        ,max_dayid\r\n        ,to_char(customer_number) AS customer_number\r\n        ,account_no\r\n        ,debit_credit\r\n        ,channel\r\n        ,channel_trn\r\n        ,internal_external_final\r\n        ,receiver_type\r\n        ,SUM(trn_amt) AS trn_amt\r\n    FROM  t1\r\n    GROUP BY\r\n        yearmonth\r\n        ,max_dayid\r\n        ,customer_number\r\n        ,account_no\r\n        ,debit_credit\r\n        ,channel\r\n        ,channel_trn\r\n        ,internal_external_final\r\n        ,receiver_type\r\n)\r\n,segment_cttd_final AS\r\n(\r\n    SELECT DISTINCT cif,segment_cttd FROM\r\n    (\r\n        SELECT\r\n            A.*\r\n            ,RANK() OVER(PARTITION BY cif ORDER BY yearmonth DESC) AS rn\r\n        FROM {{ source('dga', 'thuvh3_eb_dm_luyke') }} A\r\n        WHERE segment_cttd IS NOT NULL\r\n    )\r\n    WHERE rn = 1\r\n)\r\n,listcif AS\r\n(\r\n    SELECT\r\n        DISTINCT to_char(year_month) AS yearmonth\r\n        ,customer_number AS cif\r\n        ,vision_sbu\r\n    FROM {{ ref('int__bal_mly_eb')}} A\r\n    WHERE 1= 1\r\n    AND vision_sbu IN ('SME','FDI','MC','LC','QLTD1','QLTD2','BB','RBTC')\r\n    AND year_month >= 202201\r\n)\r\n,note_tindung AS\r\n(\r\n    SELECT\r\n        DISTINCT to_char(year_month) AS yearmonth\r\n        ,customer_number AS cif\r\n        ,MAX(note_tindung) AS note_tindung\r\n    FROM\r\n    (\r\n        SELECT\r\n            CASE WHEN product IN ('OTHER LOAN','BG','LC') THEN 1 ELSE 0 END note_tindung\r\n            ,A.*\r\n        FROM {{ ref('int__bal_mly_eb')}} A\r\n        WHERE year_month >= 202201\r\n    )\r\n    GROUP BY year_month,customer_number\r\n)\r\n, bpm_approve AS\r\n(\r\n    SELECT\r\n        b.ckdt\r\n        ,TO_DATE(to_char(b.approved_date,'dd-MON-yy')) AS ngay_phe_duyet\r\n        ,A.*\r\n    FROM {{ source('bpm_bulanding', 'thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL') }} a\r\n    LEFT JOIN {{ source('bpm_bulanding', 'thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL') }} b\r\n        ON A.app_id = b.app_id\r\n)\r\n,ckdt_df AS\r\n(\r\n    SELECT * FROM\r\n    (\r\n        SELECT\r\n            A.*\r\n            ,row_number () OVER(PARTITION BY taxcode ORDER BY ngay_phe_duyet DESC ) AS rn\r\n        FROM bpm_approve A\r\n        WHERE ckdt IS NOT NULL\r\n    ) A\r\n    WHERE rn = 1\r\n)\r\n,T2 AS\r\n(\r\n    SELECT\r\n        COALESCE(to_char(b.customer_number),to_char(C.customer_number),A.cif_num) AS customer_number\r\n        ,A.*\r\n    FROM {{ ref('int_mercury__customer_ckdt')}} A\r\n    LEFT JOIN {{ ref('int__customer')}} b\r\n    ON A.business_registration_number = b.tax_code_final\r\n    LEFT JOIN {{ ref('int__customer')}} C\r\n    ON A.business_registration_number = C.customer_register_number\r\n)\r\n,ckdt_bpm AS\r\n(\r\n    SELECT * FROM\r\n    (\r\n        SELECT\r\n            A.*\r\n            ,row_number () OVER(PARTITION BY customer_number ORDER BY nvl(approval_date,'01-jan-1900') DESC) AS rn\r\n        FROM T2 A\r\n        WHERE (editing_purpose <> '\u0110i\u1ec1u ch\u1ec9nh' OR approval_suggestion = '\u0110\u1ed3ng \u00fd')\r\n         AND (css_newest = 1 OR  doc_detail_newest = 1)\r\n         AND ckdt_hmcs <> 0\r\n    ) A\r\n    WHERE rn = 1\r\n)\r\n,final AS\r\n(\r\n    SELECT\r\n    A.yearmonth\r\n    ,A.cif\r\n    ,E.tax_code_final AS tax_code\r\n    ,CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END vision_sbu_lv1\r\n    ,nvl(segment_cttd_final.segment_cttd,CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END)\r\n        AS vision_sbu_lv2\r\n    ,D.account_no\r\n    ,D.debit_credit\r\n    ,D.channel\r\n    ,D.channel_trn\r\n    ,D.internal_external_final\r\n    ,D.receiver_type\r\n    ,D.trn_amt\r\n    ,COALESCE(ckdt_bpm.ckdt_hmcs,ckdt_df.ckdt) AS ckdt\r\n    ,nvl(ckdt_bpm.limit_sub_type,ckdt_df.segment_level1_t) AS solution\r\n    ,COALESCE(to_char(ckdt_bpm.approval_date,'yyyymmdd'),to_char(ckdt_df.ngay_phe_duyet,'yyyymmdd')) AS approved_date\r\n    ,note_tindung.note_tindung\r\n    ,D.max_dayid\r\n    ,CASE WHEN LENGTH(account_no) = 14 AND substr(account_no,4,2) IN ('31','07') THEN 'KYQUY'\r\n          WHEN LENGTH(account_no) = 13 AND substr(account_no,3,2) IN ('31','07') THEN 'KYQUY'\r\n          WHEN LENGTH(account_no) = 14 AND substr(account_no,4,2) IN ('13') THEN 'GIANNGAN'\r\n          WHEN LENGTH(account_no) = 13 AND substr(account_no,3,2) IN ('13') THEN 'GIANNGAN'\r\n          ELSE NULL END kyquy_giaingan\r\n    FROM listcif A\r\n    LEFT JOIN txn D\r\n    ON A.cif = D.customer_number\r\n    AND A.yearmonth = D.yearmonth\r\n    LEFT JOIN {{ ref('int__customer')}} E\r\n    ON A.cif = to_char(E.customer_number)\r\n    LEFT JOIN ckdt_bpm\r\n    ON E.tax_code_final = ckdt_bpm.business_registration_number\r\n    LEFT JOIN ckdt_df\r\n    ON E.tax_code_final = ckdt_df.taxcode\r\n    LEFT JOIN segment_cttd_final\r\n    ON A.cif = to_char(segment_cttd_final.cif)\r\n    LEFT JOIN note_tindung\r\n    ON A.cif = note_tindung.cif\r\n    AND A.yearmonth = note_tindung.yearmonth\r\n)\r\nSELECT * FROM final\r\nWHERE cif <> '0'\r\nORDER BY yearmonth, cif", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\report\\eb_daily\\report_eb_cashflow__detail.sql", "original_file_path": "models\\mart\\report\\eb_daily\\report_eb_cashflow__detail.sql", "name": "report_eb_cashflow__detail", "alias": "report_eb_cashflow__detail", "checksum": {"name": "sha256", "checksum": "f551da3c63e88b5f02bf46b0a025c89d55415e7605888878a4c0b74f9b5d2c07"}, "tags": ["eb_rpt_cashflow"], "refs": [["int__bal_mly_eb"], ["int__bal_mly_eb"], ["int_mercury__customer_ckdt"], ["int__customer"], ["int__customer"], ["int__customer"]], "sources": [["dga", "anlt4_eb_txn_processed"], ["bpm_bulanding", "thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL"], ["bpm_bulanding", "thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL"], ["dga", "thuvh3_eb_dm_luyke"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\report\\eb_daily\\eb_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\report\\eb_daily\\report_eb_cashflow__detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "phuongnt89"}, "tags": ["eb_rpt_cashflow"], "materialized": "table"}, "created_at": 1685959752.8739877, "compiled_code": "\n\nWITH t1 AS\n(\n    SELECT\n        substr(dayid,1,6) AS yearmonth\n        ,FIRST_VALUE(dayid) OVER(ORDER BY dayid DESC) AS max_dayid\n        ,dayid\n        ,to_char(customer_number) AS customer_number\n        ,account_no\n        ,debit_credit\n        ,channel\n        ,channel_trn\n        ,internal_external_final\n        ,receiver_type\n        ,trn_amt\n    FROM oracle_dgaworkzone.dga.anlt4_eb_txn_processed\n    WHERE\n        dayid >= 20220101\n        AND NOT (LOWER(remark) LIKE '%msb hoan tra giao dich chuyen khoan 247%' AND user_id LIKE 'CV%')\n)\n,txn AS\n(\n    SELECT\n        yearmonth\n        ,max_dayid\n        ,to_char(customer_number) AS customer_number\n        ,account_no\n        ,debit_credit\n        ,channel\n        ,channel_trn\n        ,internal_external_final\n        ,receiver_type\n        ,SUM(trn_amt) AS trn_amt\n    FROM  t1\n    GROUP BY\n        yearmonth\n        ,max_dayid\n        ,customer_number\n        ,account_no\n        ,debit_credit\n        ,channel\n        ,channel_trn\n        ,internal_external_final\n        ,receiver_type\n)\n,segment_cttd_final AS\n(\n    SELECT DISTINCT cif,segment_cttd FROM\n    (\n        SELECT\n            A.*\n            ,RANK() OVER(PARTITION BY cif ORDER BY yearmonth DESC) AS rn\n        FROM oracle_dgaworkzone.dga.thuvh3_eb_dm_luyke A\n        WHERE segment_cttd IS NOT NULL\n    )\n    WHERE rn = 1\n)\n,listcif AS\n(\n    SELECT\n        DISTINCT to_char(year_month) AS yearmonth\n        ,customer_number AS cif\n        ,vision_sbu\n    FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb A\n    WHERE 1= 1\n    AND vision_sbu IN ('SME','FDI','MC','LC','QLTD1','QLTD2','BB','RBTC')\n    AND year_month >= 202201\n)\n,note_tindung AS\n(\n    SELECT\n        DISTINCT to_char(year_month) AS yearmonth\n        ,customer_number AS cif\n        ,MAX(note_tindung) AS note_tindung\n    FROM\n    (\n        SELECT\n            CASE WHEN product IN ('OTHER LOAN','BG','LC') THEN 1 ELSE 0 END note_tindung\n            ,A.*\n        FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb A\n        WHERE year_month >= 202201\n    )\n    GROUP BY year_month,customer_number\n)\n, bpm_approve AS\n(\n    SELECT\n        b.ckdt\n        ,TO_DATE(to_char(b.approved_date,'dd-MON-yy')) AS ngay_phe_duyet\n        ,A.*\n    FROM oracle_bulanding.df_2.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL a\n    LEFT JOIN oracle_bulanding.df_2.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL b\n        ON A.app_id = b.app_id\n)\n,ckdt_df AS\n(\n    SELECT * FROM\n    (\n        SELECT\n            A.*\n            ,row_number () OVER(PARTITION BY taxcode ORDER BY ngay_phe_duyet DESC ) AS rn\n        FROM bpm_approve A\n        WHERE ckdt IS NOT NULL\n    ) A\n    WHERE rn = 1\n)\n,T2 AS\n(\n    SELECT\n        COALESCE(to_char(b.customer_number),to_char(C.customer_number),A.cif_num) AS customer_number\n        ,A.*\n    FROM \"oracle_dgaworkzone\".int.int_mercury__customer_ckdt A\n    LEFT JOIN \"oracle_dgaworkzone\".int.int__customer b\n    ON A.business_registration_number = b.tax_code_final\n    LEFT JOIN \"oracle_dgaworkzone\".int.int__customer C\n    ON A.business_registration_number = C.customer_register_number\n)\n,ckdt_bpm AS\n(\n    SELECT * FROM\n    (\n        SELECT\n            A.*\n            ,row_number () OVER(PARTITION BY customer_number ORDER BY nvl(approval_date,'01-jan-1900') DESC) AS rn\n        FROM T2 A\n        WHERE (editing_purpose <> '\u0110i\u1ec1u ch\u1ec9nh' OR approval_suggestion = '\u0110\u1ed3ng \u00fd')\n         AND (css_newest = 1 OR  doc_detail_newest = 1)\n         AND ckdt_hmcs <> 0\n    ) A\n    WHERE rn = 1\n)\n,final AS\n(\n    SELECT\n    A.yearmonth\n    ,A.cif\n    ,E.tax_code_final AS tax_code\n    ,CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END vision_sbu_lv1\n    ,nvl(segment_cttd_final.segment_cttd,CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END)\n        AS vision_sbu_lv2\n    ,D.account_no\n    ,D.debit_credit\n    ,D.channel\n    ,D.channel_trn\n    ,D.internal_external_final\n    ,D.receiver_type\n    ,D.trn_amt\n    ,COALESCE(ckdt_bpm.ckdt_hmcs,ckdt_df.ckdt) AS ckdt\n    ,nvl(ckdt_bpm.limit_sub_type,ckdt_df.segment_level1_t) AS solution\n    ,COALESCE(to_char(ckdt_bpm.approval_date,'yyyymmdd'),to_char(ckdt_df.ngay_phe_duyet,'yyyymmdd')) AS approved_date\n    ,note_tindung.note_tindung\n    ,D.max_dayid\n    ,CASE WHEN LENGTH(account_no) = 14 AND substr(account_no,4,2) IN ('31','07') THEN 'KYQUY'\n          WHEN LENGTH(account_no) = 13 AND substr(account_no,3,2) IN ('31','07') THEN 'KYQUY'\n          WHEN LENGTH(account_no) = 14 AND substr(account_no,4,2) IN ('13') THEN 'GIANNGAN'\n          WHEN LENGTH(account_no) = 13 AND substr(account_no,3,2) IN ('13') THEN 'GIANNGAN'\n          ELSE NULL END kyquy_giaingan\n    FROM listcif A\n    LEFT JOIN txn D\n    ON A.cif = D.customer_number\n    AND A.yearmonth = D.yearmonth\n    LEFT JOIN \"oracle_dgaworkzone\".int.int__customer E\n    ON A.cif = to_char(E.customer_number)\n    LEFT JOIN ckdt_bpm\n    ON E.tax_code_final = ckdt_bpm.business_registration_number\n    LEFT JOIN ckdt_df\n    ON E.tax_code_final = ckdt_df.taxcode\n    LEFT JOIN segment_cttd_final\n    ON A.cif = to_char(segment_cttd_final.cif)\n    LEFT JOIN note_tindung\n    ON A.cif = note_tindung.cif\n    AND A.yearmonth = note_tindung.yearmonth\n)\nSELECT * FROM final\nWHERE cif <> '0'\nORDER BY yearmonth, cif", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.report_eb_cashflow__detail"}, "model.dga_data_model.report_eb_cust360__casa_trans_agg": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dga.thuvh3_eb_dm_luyke", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.fct__agg_casa_txn_daily", "model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["eb_rpt_cust360"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "report", "eb_daily", "report_eb_cust360__casa_trans_agg"], "unique_id": "model.dga_data_model.report_eb_cust360__casa_trans_agg", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\n--source cte\r\nWITH segment AS (\r\n    SELECT\r\n        A.*\r\n        ,RANK() OVER(PARTITION BY cif ORDER BY yearmonth DESC) AS rn\r\n    FROM {{ source('dga', 'thuvh3_eb_dm_luyke') }} A\r\n    WHERE segment_cttd IS NOT NULL\r\n)\r\n, list_cif AS\r\n(\r\n    SELECT\r\n        DISTINCT to_char(year_month) AS year_month\r\n        , customer_number\r\n        , vision_sbu\r\n        , CASE WHEN product IN ('OTHER LOAN','BG','LC') THEN 1 ELSE 0 END is_credit_cust\r\n    FROM {{ ref('int__bal_mly_eb')}}\r\n    WHERE year_month >= 202201\r\n    AND (vision_sbu IN ('SME','FDI','MC','LC','BB','RBTC') OR substr(vision_sbu,1,4) = 'QLTD')\r\n)\r\n, txn AS (\r\n    SELECT\r\n        month_id AS year_month\r\n        ,to_char(customer_number) AS customer_number\r\n        ,account_number\r\n        ,debit_credit_code\r\n        ,SUM(sum_lcy_txn_amount) AS trn_amt\r\n    FROM {{ ref('fct__agg_casa_txn_daily')}} A\r\n    WHERE date_id >= 20220101\r\n    GROUP BY\r\n        month_id\r\n        ,customer_number\r\n        ,account_number\r\n        ,debit_credit_code\r\n)\r\n--transform cte\r\n,segment_cttd_final AS\r\n(\r\n    SELECT\r\n        DISTINCT cif\r\n        ,segment_cttd\r\n    FROM SEGMENT\r\n    WHERE rn = 1\r\n)\r\n,is_credit_cust AS\r\n(\r\n    SELECT\r\n        DISTINCT to_char(year_month) AS year_month\r\n        ,customer_number AS cif\r\n        ,MAX(is_credit_cust) AS is_credit_cust\r\n    FROM list_cif\r\n    GROUP BY\r\n        year_month\r\n        ,customer_number\r\n)\r\n, combined AS\r\n(\r\n    SELECT\r\n    A.year_month\r\n    ,A.customer_number\r\n    ,E.tax_code_final AS tax_code\r\n    ,CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END vision_sbu_lv1\r\n    ,nvl(segment_cttd_final.segment_cttd, CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END)\r\n        AS vision_sbu_lv2\r\n    ,D.account_number\r\n    ,D.debit_credit_code\r\n    ,D.trn_amt\r\n    ,is_credit_cust.is_credit_cust\r\n    FROM list_cif A\r\n    LEFT JOIN txn D\r\n        ON A.customer_number = D.customer_number\r\n        AND A.year_month = D.year_month\r\n    LEFT JOIN {{ ref('int__customer')}}  E\r\n        ON A.customer_number = to_char(E.customer_number)\r\n    LEFT JOIN segment_cttd_final\r\n        ON A.customer_number = to_char(segment_cttd_final.cif)\r\n    LEFT JOIN is_credit_cust\r\n        ON A.customer_number = is_credit_cust.cif\r\n        AND A.year_month = is_credit_cust.year_month\r\n)\r\nSELECT * FROM combined\r\nWHERE customer_number <> '0'\r\nORDER BY year_month, customer_number", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\report\\eb_daily\\report_eb_cust360__casa_trans_agg.sql", "original_file_path": "models\\mart\\report\\eb_daily\\report_eb_cust360__casa_trans_agg.sql", "name": "report_eb_cust360__casa_trans_agg", "alias": "report_eb_cust360__casa_trans_agg", "checksum": {"name": "sha256", "checksum": "e46c94e616e6e36004ea0db81cec57d2a319c0e4a479edf725937fda70f42a68"}, "tags": ["eb_rpt_cust360"], "refs": [["int__bal_mly_eb"], ["fct__agg_casa_txn_daily"], ["int__customer"]], "sources": [["dga", "thuvh3_eb_dm_luyke"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\report\\eb_daily\\eb_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\report\\eb_daily\\report_eb_cust360__casa_trans_agg.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "phuongnt89"}, "tags": ["eb_rpt_cust360"], "materialized": "table"}, "created_at": 1685959752.8699071, "compiled_code": "\n\n--source cte\nWITH segment AS (\n    SELECT\n        A.*\n        ,RANK() OVER(PARTITION BY cif ORDER BY yearmonth DESC) AS rn\n    FROM oracle_dgaworkzone.dga.thuvh3_eb_dm_luyke A\n    WHERE segment_cttd IS NOT NULL\n)\n, list_cif AS\n(\n    SELECT\n        DISTINCT to_char(year_month) AS year_month\n        , customer_number\n        , vision_sbu\n        , CASE WHEN product IN ('OTHER LOAN','BG','LC') THEN 1 ELSE 0 END is_credit_cust\n    FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb\n    WHERE year_month >= 202201\n    AND (vision_sbu IN ('SME','FDI','MC','LC','BB','RBTC') OR substr(vision_sbu,1,4) = 'QLTD')\n)\n, txn AS (\n    SELECT\n        month_id AS year_month\n        ,to_char(customer_number) AS customer_number\n        ,account_number\n        ,debit_credit_code\n        ,SUM(sum_lcy_txn_amount) AS trn_amt\n    FROM \"oracle_dgaworkzone\".mart.fct__agg_casa_txn_daily A\n    WHERE date_id >= 20220101\n    GROUP BY\n        month_id\n        ,customer_number\n        ,account_number\n        ,debit_credit_code\n)\n--transform cte\n,segment_cttd_final AS\n(\n    SELECT\n        DISTINCT cif\n        ,segment_cttd\n    FROM SEGMENT\n    WHERE rn = 1\n)\n,is_credit_cust AS\n(\n    SELECT\n        DISTINCT to_char(year_month) AS year_month\n        ,customer_number AS cif\n        ,MAX(is_credit_cust) AS is_credit_cust\n    FROM list_cif\n    GROUP BY\n        year_month\n        ,customer_number\n)\n, combined AS\n(\n    SELECT\n    A.year_month\n    ,A.customer_number\n    ,E.tax_code_final AS tax_code\n    ,CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END vision_sbu_lv1\n    ,nvl(segment_cttd_final.segment_cttd, CASE WHEN A.vision_sbu IN ('SME','MC') THEN 'SnD' ELSE A.vision_sbu END)\n        AS vision_sbu_lv2\n    ,D.account_number\n    ,D.debit_credit_code\n    ,D.trn_amt\n    ,is_credit_cust.is_credit_cust\n    FROM list_cif A\n    LEFT JOIN txn D\n        ON A.customer_number = D.customer_number\n        AND A.year_month = D.year_month\n    LEFT JOIN \"oracle_dgaworkzone\".int.int__customer  E\n        ON A.customer_number = to_char(E.customer_number)\n    LEFT JOIN segment_cttd_final\n        ON A.customer_number = to_char(segment_cttd_final.cif)\n    LEFT JOIN is_credit_cust\n        ON A.customer_number = is_credit_cust.cif\n        AND A.year_month = is_credit_cust.year_month\n)\nSELECT * FROM combined\nWHERE customer_number <> '0'\nORDER BY year_month, customer_number", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.report_eb_cust360__casa_trans_agg"}, "model.dga_data_model.report_eb_cust360__prd_smy": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.vision__eb_toi_monthly"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["eb_rpt_cust360"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "report", "eb_daily", "report_eb_cust360__prd_smy"], "unique_id": "model.dga_data_model.report_eb_cust360__prd_smy", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH eop AS (\r\n    SELECT\r\n        to_char(year_month) AS year_month\r\n        ,customer_number\r\n        ,product\r\n        ,vision_sbu\r\n        ,SUM(eop_bal_lcy) AS amount\r\n        ,'SDCK' AS SOURCE\r\n    FROM {{ ref('int__bal_mly_eb')}}\r\n    GROUP BY\r\n        year_month\r\n        ,customer_number\r\n        ,product\r\n        ,vision_sbu\r\n),\r\navg AS (\r\n    SELECT\r\n        to_char(year_month) AS year_month\r\n        ,customer_number\r\n        ,product\r\n        ,vision_sbu\r\n        ,SUM(avg_bal_lcy) AS amount\r\n        ,'SDBQ' AS SOURCE\r\n    FROM {{ ref('int__bal_mly_eb')}}\r\n    GROUP BY\r\n        year_month\r\n        ,customer_number\r\n        ,product\r\n        ,vision_sbu\r\n),\r\ntoi_prd AS (\r\n    SELECT\r\n        to_char(year_month) AS year_month\r\n        , cifno AS customer_number\r\n        , CASE\r\n            WHEN TYPE IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDITCARD' ELSE\r\n                    (CASE WHEN UPPER(A.code_new) LIKE 'A.1.A%' THEN 'CASA'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.1.B%' THEN 'FD'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.2.A%' THEN\r\n                                    (CASE WHEN trade_loan IS NULL THEN CASE WHEN kyhans = 'ST_TC' THEN 'THAU CHI' ELSE 'OTHER LOAN' END\r\n                                     ELSE 'TRADE LOAN'\r\n                                     END)\r\n                            WHEN UPPER(A.code_new) LIKE 'A.2.B.%' THEN 'CBI'\r\n                            WHEN UPPER(A.code_new) = 'A.3.A.2.A' THEN 'TTR'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.B%' THEN 'FX'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.1%' THEN 'BG'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.2%' THEN 'LC'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.3%' THEN 'NHO THU'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.D%' THEN 'BANCA'\r\n                    END)\r\n             END AS product\r\n        , CASE WHEN bank LIKE '%SME%' THEN 'SME'\r\n             WHEN bank LIKE '%LC%' THEN 'LC'\r\n             ELSE bank END vision_sbu\r\n        , round(SUM(amt)) AS amount\r\n        , 'TOI' AS SOURCE\r\n    FROM {{ ref('vision__eb_toi_monthly')}} A\r\n    WHERE cifno <> '0'\r\n    GROUP BY\r\n        year_month\r\n        , cifno\r\n        , CASE\r\n            WHEN TYPE IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDITCARD' ELSE\r\n                    (CASE WHEN UPPER(A.code_new) LIKE 'A.1.A%' THEN 'CASA'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.1.B%' THEN 'FD'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.2.A%' THEN\r\n                                    (CASE WHEN trade_loan IS NULL THEN CASE WHEN kyhans = 'ST_TC' THEN 'THAU CHI' ELSE 'OTHER LOAN' END\r\n                                     ELSE 'TRADE LOAN'\r\n                                     END)\r\n                            WHEN UPPER(A.code_new) LIKE 'A.2.B.%' THEN 'CBI'\r\n                            WHEN UPPER(A.code_new) = 'A.3.A.2.A' THEN 'TTR'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.B%' THEN 'FX'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.1%' THEN 'BG'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.2%' THEN 'LC'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.3%' THEN 'NHO THU'\r\n                            WHEN UPPER(A.code_new) LIKE 'A.3.D%' THEN 'BANCA'\r\n                    END)\r\n             END\r\n        , CASE WHEN bank LIKE '%SME%' THEN 'SME'\r\n             WHEN bank LIKE '%LC%' THEN 'LC'\r\n             ELSE bank END\r\n)\r\n, append AS (\r\n    SELECT * FROM eop\r\n    UNION ALL\r\n    SELECT * FROM avg\r\n    UNION ALL\r\n    SELECT * FROM toi_prd\r\n    WHERE product IS NOT NULL\r\n)\r\n, pivot AS (\r\n    SELECT * FROM\r\n    (\r\n      SELECT *\r\n      FROM append\r\n    )\r\n    PIVOT\r\n    (\r\n      SUM(amount)\r\n      FOR SOURCE IN ('SDCK' sdck, 'SDBQ' sdbq, 'TOI' toi)\r\n    )\r\n    ORDER BY year_month DESC\r\n)\r\n\r\nSELECT * FROM pivot", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\report\\eb_daily\\report_eb_cust360__prd_smy.sql", "original_file_path": "models\\mart\\report\\eb_daily\\report_eb_cust360__prd_smy.sql", "name": "report_eb_cust360__prd_smy", "alias": "report_eb_cust360__prd_smy", "checksum": {"name": "sha256", "checksum": "14155e755d889ce98e607e5bdcecf4a1a1a13ec3d15bbce49c72b42fe5e29e44"}, "tags": ["eb_rpt_cust360"], "refs": [["int__bal_mly_eb"], ["int__bal_mly_eb"], ["vision__eb_toi_monthly"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\report\\eb_daily\\eb_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\report\\eb_daily\\report_eb_cust360__prd_smy.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "phuongnt89"}, "tags": ["eb_rpt_cust360"], "materialized": "table"}, "created_at": 1685959752.872982, "compiled_code": "\n\nWITH eop AS (\n    SELECT\n        to_char(year_month) AS year_month\n        ,customer_number\n        ,product\n        ,vision_sbu\n        ,SUM(eop_bal_lcy) AS amount\n        ,'SDCK' AS SOURCE\n    FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb\n    GROUP BY\n        year_month\n        ,customer_number\n        ,product\n        ,vision_sbu\n),\navg AS (\n    SELECT\n        to_char(year_month) AS year_month\n        ,customer_number\n        ,product\n        ,vision_sbu\n        ,SUM(avg_bal_lcy) AS amount\n        ,'SDBQ' AS SOURCE\n    FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb\n    GROUP BY\n        year_month\n        ,customer_number\n        ,product\n        ,vision_sbu\n),\ntoi_prd AS (\n    SELECT\n        to_char(year_month) AS year_month\n        , cifno AS customer_number\n        , CASE\n            WHEN TYPE IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDITCARD' ELSE\n                    (CASE WHEN UPPER(A.code_new) LIKE 'A.1.A%' THEN 'CASA'\n                            WHEN UPPER(A.code_new) LIKE 'A.1.B%' THEN 'FD'\n                            WHEN UPPER(A.code_new) LIKE 'A.2.A%' THEN\n                                    (CASE WHEN trade_loan IS NULL THEN CASE WHEN kyhans = 'ST_TC' THEN 'THAU CHI' ELSE 'OTHER LOAN' END\n                                     ELSE 'TRADE LOAN'\n                                     END)\n                            WHEN UPPER(A.code_new) LIKE 'A.2.B.%' THEN 'CBI'\n                            WHEN UPPER(A.code_new) = 'A.3.A.2.A' THEN 'TTR'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.B%' THEN 'FX'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.1%' THEN 'BG'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.2%' THEN 'LC'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.3%' THEN 'NHO THU'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.D%' THEN 'BANCA'\n                    END)\n             END AS product\n        , CASE WHEN bank LIKE '%SME%' THEN 'SME'\n             WHEN bank LIKE '%LC%' THEN 'LC'\n             ELSE bank END vision_sbu\n        , round(SUM(amt)) AS amount\n        , 'TOI' AS SOURCE\n    FROM \"oracle_dgaworkzone\".base.vision__eb_toi_monthly A\n    WHERE cifno <> '0'\n    GROUP BY\n        year_month\n        , cifno\n        , CASE\n            WHEN TYPE IN ('PCORPT','PCORPB','PCORPD','PCORPVBA','PCORPVBC') THEN 'CREDITCARD' ELSE\n                    (CASE WHEN UPPER(A.code_new) LIKE 'A.1.A%' THEN 'CASA'\n                            WHEN UPPER(A.code_new) LIKE 'A.1.B%' THEN 'FD'\n                            WHEN UPPER(A.code_new) LIKE 'A.2.A%' THEN\n                                    (CASE WHEN trade_loan IS NULL THEN CASE WHEN kyhans = 'ST_TC' THEN 'THAU CHI' ELSE 'OTHER LOAN' END\n                                     ELSE 'TRADE LOAN'\n                                     END)\n                            WHEN UPPER(A.code_new) LIKE 'A.2.B.%' THEN 'CBI'\n                            WHEN UPPER(A.code_new) = 'A.3.A.2.A' THEN 'TTR'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.B%' THEN 'FX'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.1%' THEN 'BG'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.2%' THEN 'LC'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.C.3%' THEN 'NHO THU'\n                            WHEN UPPER(A.code_new) LIKE 'A.3.D%' THEN 'BANCA'\n                    END)\n             END\n        , CASE WHEN bank LIKE '%SME%' THEN 'SME'\n             WHEN bank LIKE '%LC%' THEN 'LC'\n             ELSE bank END\n)\n, append AS (\n    SELECT * FROM eop\n    UNION ALL\n    SELECT * FROM avg\n    UNION ALL\n    SELECT * FROM toi_prd\n    WHERE product IS NOT NULL\n)\n, pivot AS (\n    SELECT * FROM\n    (\n      SELECT *\n      FROM append\n    )\n    PIVOT\n    (\n      SUM(amount)\n      FOR SOURCE IN ('SDCK' sdck, 'SDBQ' sdbq, 'TOI' toi)\n    )\n    ORDER BY year_month DESC\n)\n\nSELECT * FROM pivot", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.report_eb_cust360__prd_smy"}, "model.dga_data_model.report_eb__cst_smy_pivot": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["eb_rpt_cashflow"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "report", "eb_daily", "report_eb__cst_smy_pivot"], "unique_id": "model.dga_data_model.report_eb__cst_smy_pivot", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH cif_cashflow AS (\r\n    SELECT\r\n        DISTINCT yearmonth AS year_month\r\n        , cif AS customer_number\r\n    FROM {{ ref('report_eb_cashflow__detail')}}\r\n), cif_bal AS (\r\n    SELECT\r\n        DISTINCT to_char(year_month) AS year_month\r\n        , customer_number\r\n    FROM {{ ref('int__bal_mly_eb')}}\r\n), cif_all AS (\r\n    SELECT\r\n        year_month\r\n        , customer_number\r\n    FROM cif_cashflow\r\n    UNION ALL\r\n    SELECT\r\n        year_month\r\n        , customer_number\r\n    FROM cif_bal\r\n), cif_distinct AS (\r\n    SELECT\r\n        DISTINCT year_month\r\n            , customer_number\r\n    FROM cif_all\r\n), balance AS\r\n(\r\n    SELECT\r\n        CASE WHEN LENGTH(contract_id) = 14 AND substr(contract_id,4,2) = 31 THEN 'KY QUY'\r\n             WHEN LENGTH(contract_id) = 13 AND substr(contract_id,3,2) = 31 THEN 'KY QUY'\r\n             ELSE product END new_product\r\n        ,A.*\r\n    FROM {{ ref('int__bal_mly_eb')}} A\r\n    WHERE product IS NOT NULL\r\n)\r\n,balance_prd AS (\r\n    SELECT\r\n        to_char(year_month) AS year_month\r\n        ,customer_number\r\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM = 'ST' THEN eop_bal_lcy ELSE 0 END) eop_st\r\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM IN ('MT','LT') THEN eop_bal_lcy ELSE 0 END) eop_mt_lt\r\n        ,SUM(CASE WHEN new_product IN ('BG') THEN eop_bal_lcy ELSE 0 END) eop_bg\r\n        ,SUM(CASE WHEN new_product IN ('LC') THEN eop_bal_lcy ELSE 0 END) eop_lc\r\n        ,SUM(CASE WHEN new_product IN ('CASA') THEN eop_bal_lcy ELSE 0 END) eop_casa\r\n        ,SUM(CASE WHEN new_product IN ('KY QUY') THEN eop_bal_lcy ELSE 0 END) eop_kyquy\r\n        ,SUM(CASE WHEN new_product IN ('FD') THEN eop_bal_lcy ELSE 0 END) eop_fd\r\n        ,SUM(CASE WHEN new_product IN ('THAU CHI') THEN eop_bal_lcy ELSE 0 END) eop_thauchi\r\n        ,SUM(CASE WHEN new_product IN ('CREDITCARD') THEN eop_bal_lcy ELSE 0 END) eop_creditcard\r\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM = 'ST' THEN avg_bal_lcy ELSE 0 END) avg_st\r\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM IN ('MT','LT') THEN avg_bal_lcy ELSE 0 END) avg_mt_lt\r\n        ,SUM(CASE WHEN new_product IN ('BG') THEN avg_bal_lcy ELSE 0 END) avg_bg\r\n        ,SUM(CASE WHEN new_product IN ('LC') THEN avg_bal_lcy ELSE 0 END) avg_lc\r\n        ,SUM(CASE WHEN new_product IN ('CASA') THEN avg_bal_lcy ELSE 0 END) avg_casa\r\n        ,SUM(CASE WHEN new_product IN ('KY QUY') THEN avg_bal_lcy ELSE 0 END) avg_kyquy\r\n        ,SUM(CASE WHEN new_product IN ('FD') THEN avg_bal_lcy ELSE 0 END) avg_fd\r\n        ,SUM(CASE WHEN new_product IN ('THAU CHI') THEN avg_bal_lcy ELSE 0 END) avg_thauchi\r\n        ,SUM(CASE WHEN new_product IN ('CREDITCARD') THEN avg_bal_lcy ELSE 0 END) avg_creditcard\r\n    FROM  balance\r\n    GROUP BY\r\n        year_month\r\n        ,customer_number\r\n)\r\n, cashflow AS (\r\n    SELECT\r\n        yearmonth AS year_month\r\n        ,cif AS customer_number\r\n        ,SUM(CASE WHEN debit_credit = 'C' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_co\r\n        ,SUM(CASE WHEN debit_credit = 'C' AND internal_external_final = 'INTERNAL' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_co_internal\r\n        ,SUM(CASE WHEN debit_credit = 'C' AND receiver_type IN ('DN kh\u00e1c C\u00d3 t\u00e0i kho\u1ea3n t\u1ea1i MSB','DN kh\u00e1c KH\u00d4NG c\u00f3 t\u00e0i kho\u1ea3n t\u1ea1i MSB','Non-define' ) THEN trn_amt ELSE 0 END) AS doanh_so_ghi_co_tu_doi_tac\r\n        ,SUM(CASE WHEN debit_credit = 'D' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_no\r\n        ,SUM(CASE WHEN debit_credit = 'D' AND channel_trn IN ( '8212', 'EB8212','BPM8212') THEN trn_amt ELSE 0 END) AS doanh_so_ghi_no_nuoc_ngoai\r\n        ,SUM(CASE WHEN debit_credit = 'D' AND internal_external_final = 'INTERNAL' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_no_internal\r\n        ,SUM(ckdt) AS ckdt\r\n    FROM {{ ref('report_eb_cashflow__detail')}}\r\n    GROUP BY\r\n        yearmonth\r\n        ,cif\r\n), combined AS (\r\n    SELECT\r\n        substr(cif.year_month,1,4) AS year\r\n        , cif.year_month\r\n        , cif.customer_number\r\n        , D.tax_code_final\r\n        , D.customer_fullname_locale\r\n        , nvl(b.doanh_so_ghi_co,0) AS doanh_so_ghi_co\r\n        , nvl(b.doanh_so_ghi_co_internal,0) AS doanh_so_ghi_co_internal\r\n        , nvl(b.doanh_so_ghi_co_tu_doi_tac,0) AS doanh_so_ghi_co_tu_doi_tac\r\n        , nvl(b.doanh_so_ghi_no,0) AS doanh_so_ghi_no\r\n        , nvl(b.doanh_so_ghi_no_nuoc_ngoai,0) AS doanh_so_ghi_no_nuoc_ngoai\r\n        , nvl(b.doanh_so_ghi_no_internal,0) AS doanh_so_ghi_no_internal\r\n        , nvl(b.ckdt,0) AS ckdt\r\n        , nvl(C.eop_st,0) AS eop_st\r\n        , nvl(C.eop_mt_lt,0) AS eop_mt_lt\r\n        , nvl(C.eop_bg,0) AS eop_bg\r\n        , nvl(C.eop_lc,0) AS eop_lc\r\n        , nvl(C.eop_casa,0) AS eop_casa\r\n        , nvl(C.eop_kyquy,0) AS eop_kyquy\r\n        , nvl(C.eop_fd,0) AS eop_fd\r\n        , nvl(C.eop_thauchi,0) AS eop_thauchi\r\n        , nvl(C.eop_creditcard,0) AS eop_creditcard\r\n        , nvl(C.avg_st,0) AS avg_st\r\n        , nvl(C.avg_mt_lt,0) AS avg_mt_lt\r\n        , nvl(C.avg_bg,0) AS avg_bg\r\n        , nvl(C.avg_lc,0) AS avg_lc\r\n        , nvl(C.avg_casa,0) AS avg_casa\r\n        , nvl(C.avg_kyquy,0) AS avg_kyquy\r\n        , nvl(C.avg_fd,0) AS avg_fd\r\n        , nvl(C.avg_thauchi,0) AS avg_thauchi\r\n        , nvl(C.avg_creditcard,0) AS avg_creditcard\r\n    FROM cif_distinct cif\r\n    LEFT JOIN cashflow b\r\n    ON cif.year_month = b.year_month\r\n    AND cif.customer_number = b.customer_number\r\n    LEFT JOIN balance_prd C\r\n    ON cif.year_month = C.year_month\r\n    AND cif.customer_number = C.customer_number\r\n    LEFT JOIN {{ ref('int__customer')}} D\r\n    ON cif.customer_number = to_char(D.customer_number)\r\n)\r\nSELECT * FROM combined\r\nORDER BY year_month DESC", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\report\\eb_daily\\report_eb__cst_smy_pivot.sql", "original_file_path": "models\\mart\\report\\eb_daily\\report_eb__cst_smy_pivot.sql", "name": "report_eb__cst_smy_pivot", "alias": "report_eb__cst_smy_pivot", "checksum": {"name": "sha256", "checksum": "a289b3b1bed2a2a996466b7b26f746e3c3f2ecd03cf6d6865df2bfc2e2b06309"}, "tags": ["eb_rpt_cashflow"], "refs": [["report_eb_cashflow__detail"], ["int__bal_mly_eb"], ["int__bal_mly_eb"], ["report_eb_cashflow__detail"], ["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\report\\eb_daily\\eb_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\report\\eb_daily\\report_eb__cst_smy_pivot.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "phuongnt89"}, "tags": ["eb_rpt_cashflow"], "materialized": "table"}, "created_at": 1685959752.8769774, "compiled_code": "\n\nWITH cif_cashflow AS (\n    SELECT\n        DISTINCT yearmonth AS year_month\n        , cif AS customer_number\n    FROM \"oracle_dgaworkzone\".mart.report_eb_cashflow__detail\n), cif_bal AS (\n    SELECT\n        DISTINCT to_char(year_month) AS year_month\n        , customer_number\n    FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb\n), cif_all AS (\n    SELECT\n        year_month\n        , customer_number\n    FROM cif_cashflow\n    UNION ALL\n    SELECT\n        year_month\n        , customer_number\n    FROM cif_bal\n), cif_distinct AS (\n    SELECT\n        DISTINCT year_month\n            , customer_number\n    FROM cif_all\n), balance AS\n(\n    SELECT\n        CASE WHEN LENGTH(contract_id) = 14 AND substr(contract_id,4,2) = 31 THEN 'KY QUY'\n             WHEN LENGTH(contract_id) = 13 AND substr(contract_id,3,2) = 31 THEN 'KY QUY'\n             ELSE product END new_product\n        ,A.*\n    FROM \"oracle_dgaworkzone\".int.int__bal_mly_eb A\n    WHERE product IS NOT NULL\n)\n,balance_prd AS (\n    SELECT\n        to_char(year_month) AS year_month\n        ,customer_number\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM = 'ST' THEN eop_bal_lcy ELSE 0 END) eop_st\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM IN ('MT','LT') THEN eop_bal_lcy ELSE 0 END) eop_mt_lt\n        ,SUM(CASE WHEN new_product IN ('BG') THEN eop_bal_lcy ELSE 0 END) eop_bg\n        ,SUM(CASE WHEN new_product IN ('LC') THEN eop_bal_lcy ELSE 0 END) eop_lc\n        ,SUM(CASE WHEN new_product IN ('CASA') THEN eop_bal_lcy ELSE 0 END) eop_casa\n        ,SUM(CASE WHEN new_product IN ('KY QUY') THEN eop_bal_lcy ELSE 0 END) eop_kyquy\n        ,SUM(CASE WHEN new_product IN ('FD') THEN eop_bal_lcy ELSE 0 END) eop_fd\n        ,SUM(CASE WHEN new_product IN ('THAU CHI') THEN eop_bal_lcy ELSE 0 END) eop_thauchi\n        ,SUM(CASE WHEN new_product IN ('CREDITCARD') THEN eop_bal_lcy ELSE 0 END) eop_creditcard\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM = 'ST' THEN avg_bal_lcy ELSE 0 END) avg_st\n        ,SUM(CASE WHEN new_product IN ('TRADELOAN','OTHER LOAN') AND TERM IN ('MT','LT') THEN avg_bal_lcy ELSE 0 END) avg_mt_lt\n        ,SUM(CASE WHEN new_product IN ('BG') THEN avg_bal_lcy ELSE 0 END) avg_bg\n        ,SUM(CASE WHEN new_product IN ('LC') THEN avg_bal_lcy ELSE 0 END) avg_lc\n        ,SUM(CASE WHEN new_product IN ('CASA') THEN avg_bal_lcy ELSE 0 END) avg_casa\n        ,SUM(CASE WHEN new_product IN ('KY QUY') THEN avg_bal_lcy ELSE 0 END) avg_kyquy\n        ,SUM(CASE WHEN new_product IN ('FD') THEN avg_bal_lcy ELSE 0 END) avg_fd\n        ,SUM(CASE WHEN new_product IN ('THAU CHI') THEN avg_bal_lcy ELSE 0 END) avg_thauchi\n        ,SUM(CASE WHEN new_product IN ('CREDITCARD') THEN avg_bal_lcy ELSE 0 END) avg_creditcard\n    FROM  balance\n    GROUP BY\n        year_month\n        ,customer_number\n)\n, cashflow AS (\n    SELECT\n        yearmonth AS year_month\n        ,cif AS customer_number\n        ,SUM(CASE WHEN debit_credit = 'C' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_co\n        ,SUM(CASE WHEN debit_credit = 'C' AND internal_external_final = 'INTERNAL' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_co_internal\n        ,SUM(CASE WHEN debit_credit = 'C' AND receiver_type IN ('DN kh\u00e1c C\u00d3 t\u00e0i kho\u1ea3n t\u1ea1i MSB','DN kh\u00e1c KH\u00d4NG c\u00f3 t\u00e0i kho\u1ea3n t\u1ea1i MSB','Non-define' ) THEN trn_amt ELSE 0 END) AS doanh_so_ghi_co_tu_doi_tac\n        ,SUM(CASE WHEN debit_credit = 'D' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_no\n        ,SUM(CASE WHEN debit_credit = 'D' AND channel_trn IN ( '8212', 'EB8212','BPM8212') THEN trn_amt ELSE 0 END) AS doanh_so_ghi_no_nuoc_ngoai\n        ,SUM(CASE WHEN debit_credit = 'D' AND internal_external_final = 'INTERNAL' THEN trn_amt ELSE 0 END) AS doanh_so_ghi_no_internal\n        ,SUM(ckdt) AS ckdt\n    FROM \"oracle_dgaworkzone\".mart.report_eb_cashflow__detail\n    GROUP BY\n        yearmonth\n        ,cif\n), combined AS (\n    SELECT\n        substr(cif.year_month,1,4) AS year\n        , cif.year_month\n        , cif.customer_number\n        , D.tax_code_final\n        , D.customer_fullname_locale\n        , nvl(b.doanh_so_ghi_co,0) AS doanh_so_ghi_co\n        , nvl(b.doanh_so_ghi_co_internal,0) AS doanh_so_ghi_co_internal\n        , nvl(b.doanh_so_ghi_co_tu_doi_tac,0) AS doanh_so_ghi_co_tu_doi_tac\n        , nvl(b.doanh_so_ghi_no,0) AS doanh_so_ghi_no\n        , nvl(b.doanh_so_ghi_no_nuoc_ngoai,0) AS doanh_so_ghi_no_nuoc_ngoai\n        , nvl(b.doanh_so_ghi_no_internal,0) AS doanh_so_ghi_no_internal\n        , nvl(b.ckdt,0) AS ckdt\n        , nvl(C.eop_st,0) AS eop_st\n        , nvl(C.eop_mt_lt,0) AS eop_mt_lt\n        , nvl(C.eop_bg,0) AS eop_bg\n        , nvl(C.eop_lc,0) AS eop_lc\n        , nvl(C.eop_casa,0) AS eop_casa\n        , nvl(C.eop_kyquy,0) AS eop_kyquy\n        , nvl(C.eop_fd,0) AS eop_fd\n        , nvl(C.eop_thauchi,0) AS eop_thauchi\n        , nvl(C.eop_creditcard,0) AS eop_creditcard\n        , nvl(C.avg_st,0) AS avg_st\n        , nvl(C.avg_mt_lt,0) AS avg_mt_lt\n        , nvl(C.avg_bg,0) AS avg_bg\n        , nvl(C.avg_lc,0) AS avg_lc\n        , nvl(C.avg_casa,0) AS avg_casa\n        , nvl(C.avg_kyquy,0) AS avg_kyquy\n        , nvl(C.avg_fd,0) AS avg_fd\n        , nvl(C.avg_thauchi,0) AS avg_thauchi\n        , nvl(C.avg_creditcard,0) AS avg_creditcard\n    FROM cif_distinct cif\n    LEFT JOIN cashflow b\n    ON cif.year_month = b.year_month\n    AND cif.customer_number = b.customer_number\n    LEFT JOIN balance_prd C\n    ON cif.year_month = C.year_month\n    AND cif.customer_number = C.customer_number\n    LEFT JOIN \"oracle_dgaworkzone\".int.int__customer D\n    ON cif.customer_number = to_char(D.customer_number)\n)\nSELECT * FROM combined\nORDER BY year_month DESC", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.report_eb__cst_smy_pivot"}, "model.dga_data_model.report_eb__cst_smy_pivot_khsx": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dga.tunglt_eb_acct_khsx", "model.dga_data_model.report_eb__cst_smy_pivot"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["eb_rpt_cashflow"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "report", "eb_daily", "report_eb__cst_smy_pivot_khsx"], "unique_id": "model.dga_data_model.report_eb__cst_smy_pivot_khsx", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n\r\nWITH dat AS (\r\n    SELECT\r\n        a.year\r\n        , year_month\r\n        , customer_number\r\n        , tax_code_final\r\n        , customer_fullname_locale\r\n        , doanh_so_ghi_co\r\n        , doanh_so_ghi_co_internal\r\n        , doanh_so_ghi_co_tu_doi_tac\r\n        , doanh_so_ghi_no\r\n        , doanh_so_ghi_no_nuoc_ngoai\r\n        , doanh_so_ghi_no_internal\r\n        , ckdt\r\n        , eop_st\r\n        , eop_mt_lt\r\n        , eop_bg\r\n        , eop_lc\r\n        , eop_casa\r\n        , eop_kyquy\r\n        , eop_fd\r\n        , eop_thauchi\r\n        , eop_creditcard\r\n        , avg_st\r\n        , avg_mt_lt\r\n        , avg_bg\r\n        , avg_lc\r\n        , avg_casa\r\n        , avg_kyquy\r\n        , avg_fd\r\n        , avg_thauchi\r\n        , avg_creditcard\r\n    FROM {{ ref('report_eb__cst_smy_pivot')}} a\r\n    LEFT JOIN {{ source('dga', 'tunglt_eb_acct_khsx') }} b\r\n        ON a.year = to_char(b.year)\r\n        AND a.customer_number = b.cifno\r\n    WHERE b.cifno IS NOT NULL\r\n)\r\nSELECT * FROM dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\report\\eb_daily\\report_eb__cst_smy_pivot_khsx.sql", "original_file_path": "models\\mart\\report\\eb_daily\\report_eb__cst_smy_pivot_khsx.sql", "name": "report_eb__cst_smy_pivot_khsx", "alias": "report_eb__cst_smy_pivot_khsx", "checksum": {"name": "sha256", "checksum": "04da58fefa08f0b508307d557ba1e8134fe2348278baf24a9acbac8c65cd959d"}, "tags": ["eb_rpt_cashflow"], "refs": [["report_eb__cst_smy_pivot"]], "sources": [["dga", "tunglt_eb_acct_khsx"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\report\\eb_daily\\eb_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\report\\eb_daily\\report_eb__cst_smy_pivot_khsx.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"owner": "phuongnt89"}, "tags": ["eb_rpt_cashflow"], "materialized": "table"}, "created_at": 1685959752.877978, "compiled_code": "\n\nWITH dat AS (\n    SELECT\n        a.year\n        , year_month\n        , customer_number\n        , tax_code_final\n        , customer_fullname_locale\n        , doanh_so_ghi_co\n        , doanh_so_ghi_co_internal\n        , doanh_so_ghi_co_tu_doi_tac\n        , doanh_so_ghi_no\n        , doanh_so_ghi_no_nuoc_ngoai\n        , doanh_so_ghi_no_internal\n        , ckdt\n        , eop_st\n        , eop_mt_lt\n        , eop_bg\n        , eop_lc\n        , eop_casa\n        , eop_kyquy\n        , eop_fd\n        , eop_thauchi\n        , eop_creditcard\n        , avg_st\n        , avg_mt_lt\n        , avg_bg\n        , avg_lc\n        , avg_casa\n        , avg_kyquy\n        , avg_fd\n        , avg_thauchi\n        , avg_creditcard\n    FROM \"oracle_dgaworkzone\".mart.report_eb__cst_smy_pivot a\n    LEFT JOIN oracle_dgaworkzone.dga.tunglt_eb_acct_khsx b\n        ON a.year = to_char(b.year)\n        AND a.customer_number = b.cifno\n    WHERE b.cifno IS NOT NULL\n)\nSELECT * FROM dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.report_eb__cst_smy_pivot_khsx"}, "model.dga_data_model.fct__agg_card_txn_first_last": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fct__trans_card_bk"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["ym", "card_id"], "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "test", "fct__agg_card_txn_first_last"], "unique_id": "model.dga_data_model.fct__agg_card_txn_first_last", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key=['ym', 'card_id']\r\n    )\r\n}}\r\nWITH cte1 AS (\r\n  SELECT\r\n      {{ var('month_id')}} AS ym\r\n    , target_number\r\n    , card_id\r\n    , acnt_contract__oid\r\n    , id\r\n    , sic_code\r\n    , trans_channel\r\n    , posting_date\r\n    , ROW_NUMBER() OVER(PARTITION BY card_id ORDER BY posting_date, amnd_date, transaction_date, id) AS rn_a\r\n    , ROW_NUMBER() OVER(PARTITION BY card_id ORDER BY posting_date DESC, amnd_date DESC, transaction_date DESC, id DESC) AS rn_d\r\n  FROM\r\n    {{ ref('fct__trans_card_bk')}}\r\n  WHERE\r\n    posting_date <= to_date({{ var('end_month_date') }}, 'YYYYMMDD')\r\n)\r\n, first_last_date AS (\r\nSELECT\r\n      f.ym\r\n    , f.target_number\r\n    , f.card_id\r\n    , f.acnt_contract__oid\r\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.id END) AS first_txn\r\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.sic_code END)  AS first_sic_code\r\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.trans_channel END)  AS first_trans_channel\r\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.posting_date END)  AS first_date\r\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.id END) AS last_txn\r\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.sic_code END)  AS last_sic_code\r\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.trans_channel END)  AS last_trans_channel\r\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.posting_date END)  AS last_date\r\nFROM\r\n    cte1 f\r\nGROUP BY\r\n    f.ym\r\n  , f.target_number\r\n  , f.card_id\r\n  , f.acnt_contract__oid\r\n)\r\nSELECT * FROM first_last_date", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\test\\fct__agg_card_txn_first_last.sql", "original_file_path": "models\\mart\\test\\fct__agg_card_txn_first_last.sql", "name": "fct__agg_card_txn_first_last", "alias": "fct__agg_card_txn_first_last", "checksum": {"name": "sha256", "checksum": "04b23fe44e1e0f0122f3dcbe5f446fc01e532e20d6fb8d90dcf8885146518c35"}, "tags": [], "refs": [["fct__trans_card_bk"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\test\\fct__agg_card_txn_first_last.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "materialized": "incremental", "unique_key": ["ym", "card_id"]}, "created_at": 1685959751.3253386, "compiled_code": "\nWITH cte1 AS (\n  SELECT\n      to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYMM')) AS ym\n    , target_number\n    , card_id\n    , acnt_contract__oid\n    , id\n    , sic_code\n    , trans_channel\n    , posting_date\n    , ROW_NUMBER() OVER(PARTITION BY card_id ORDER BY posting_date, amnd_date, transaction_date, id) AS rn_a\n    , ROW_NUMBER() OVER(PARTITION BY card_id ORDER BY posting_date DESC, amnd_date DESC, transaction_date DESC, id DESC) AS rn_d\n  FROM\n    \"oracle_dgaworkzone\".mart.fct__trans_card_bk\n  WHERE\n    posting_date <= to_date(to_number(to_char(LAST_DAY(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD')), 'YYYYMMDD')), 'YYYYMMDD')\n)\n, first_last_date AS (\nSELECT\n      f.ym\n    , f.target_number\n    , f.card_id\n    , f.acnt_contract__oid\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.id END) AS first_txn\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.sic_code END)  AS first_sic_code\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.trans_channel END)  AS first_trans_channel\n    , MAX(CASE WHEN f.rn_a = 1 THEN f.posting_date END)  AS first_date\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.id END) AS last_txn\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.sic_code END)  AS last_sic_code\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.trans_channel END)  AS last_trans_channel\n    , MAX(CASE WHEN f.rn_d = 1 THEN f.posting_date END)  AS last_date\nFROM\n    cte1 f\nGROUP BY\n    f.ym\n  , f.target_number\n  , f.card_id\n  , f.acnt_contract__oid\n)\nSELECT * FROM first_last_date", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__agg_card_txn_first_last"}, "model.dga_data_model.fct__trans_card_bk": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL", "source.dga_data_model.daily_bulanding.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL", "model.dga_data_model.stg_landing__card_currency", "model.dga_data_model.stg_landing__way4_trans_type", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.int_way4__card", "model.dga_data_model.stg__card_acnt_contract_plus_bk"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "test", "fct__trans_card_bk"], "unique_id": "model.dga_data_model.fct__trans_card_bk", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key='id'\r\n    )\r\n}}\r\nWITH cte_currency AS (\r\n  SELECT\r\n    code\r\n    , name AS currency\r\n  FROM\r\n    {{ ref('stg_landing__card_currency')}}\r\n  WHERE\r\n    amnd_state = 'A'\r\n)\r\n, cte_card_m_transaction AS (\r\n  SELECT\r\n    doc__oid\r\n    , SUM(local_amount) as local_amount\r\n  FROM\r\n    {{ source('daily_bulanding', 'card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL') }}\r\n  WHERE\r\n    service_class = 'T'\r\n    AND entry_type IN ('B','S')\r\n    AND posting_date = to_date({{ var('date_id')}}, 'YYYYMMDD')\r\n  GROUP BY doc__oid\r\n)\r\n, way4_type AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n    {{ ref('stg_landing__way4_trans_type')}}\r\n  WHERE\r\n    amnd_state = 'A'\r\n)\r\n  SELECT\r\n    doc.id\r\n    ,doc.amnd_date\r\n    ,doc.posting_date\r\n    ,doc.trans_date AS transaction_date\r\n    ,doc.is_authorization\r\n    ,doc.posting_status\r\n    ,doc.request_category\r\n    ,doc.return_code\r\n    ,doc.merchant_id\r\n    ,doc.doc__orig__id\r\n    ,doc.ret_ref_number\r\n    ,SETTL_AMOUNT settlement_amount\r\n    ,cur_settle.currency AS settlement_currency\r\n    ,doc.TRANS_AMOUNT transaction_amount\r\n    ,cur_trans.currency  AS transaction_currency\r\n    ,mt.local_amount AS txn_amt_lcy\r\n    ,sic_code\r\n    ,scnl.channel_desc AS src_cnl\r\n    ,tcnl.channel_desc AS trg_cnl\r\n    ,doc.source_member_id\r\n    ,doc.source_number\r\n    ,doc.source_reg_num\r\n    ,doc.trans_condition\r\n    ,doc.target_contract\r\n    ,doc.target_number\r\n    ,doc.TRANS_CITY transaction_city\r\n    ,doc.TRANS_COUNTRY transaction_country\r\n    ,doc.TRANS_DETAILS transaction_location\r\n    ,tp.name AS trans_type\r\n    ,tp.dr_cr\r\n    ,cntr.type_of_card\r\n    ,doc.source_code\r\n    ,doc.outward_status\r\n    ,doc.service_class\r\n    ,CASE\r\n        WHEN tp.name = 'ATM' THEN 'ATM'\r\n        WHEN doc.trans_condition IN ('NMR2','NMR','NMO2','NNK','NMO','NMN','PET','TET','PES','TES'\r\n                                    ,'NEV2','TEV2','NEV','TEV','NEU2','TEU2','NEU','TEU','SEU') THEN 'Online'\r\n        WHEN doc.trans_condition IN ('POSL','POSK','POEL','POEK','PO1L','PO1K','POTL','POTK','POUL','POUK'\r\n                                    ,'POVL','POVK') THEN 'POS'\r\n        ELSE 'Others'\r\n      END AS trans_channel\r\n    , cntr.card_id\r\n    , acnt.acnt_contract__oid\r\n    , nvl(acnt.ACNT_CONTRACT__ID,doc.target_contract) AS acnt_contract__id\r\n  FROM\r\n    {{ source('daily_bulanding', 'card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL') }} doc\r\n  JOIN way4_type tp ON doc.trans_type = tp.id\r\n  LEFT JOIN {{ ref('stg_landing__df_card_channel')}} scnl ON doc.source_channel = scnl.channel_code\r\n  LEFT JOIN {{ ref('stg_landing__df_card_channel')}} tcnl ON doc.target_channel = tcnl.channel_code\r\n  JOIN {{ ref('int_way4__card')}} cntr ON doc.target_number = cntr.contract_number\r\n  LEFT JOIN cte_currency cur_trans ON doc.trans_curr = cur_trans.code\r\n  LEFT JOIN cte_currency cur_settle ON doc.settl_curr = cur_settle.code\r\n  LEFT JOIN cte_card_m_transaction mt ON doc.id = mt.doc__oid\r\n  LEFT JOIN {{ ref('stg__card_acnt_contract_plus_bk')}} acnt ON doc.target_contract = acnt.id AND acnt.AMND_STATE = 'A'\r\n  WHERE\r\n    doc.is_authorization = 'N'\r\n    AND doc.posting_status = 'P'\r\n    AND tp.name IN ('Retail','ATM','Cash','Unique')\r\n    AND doc.posting_date = to_date({{ var('date_id')}}, 'YYYYMMDD')", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\test\\fct__trans_card_bk.sql", "original_file_path": "models\\mart\\test\\fct__trans_card_bk.sql", "name": "fct__trans_card_bk", "alias": "fct__trans_card_bk", "checksum": {"name": "sha256", "checksum": "e9b11347a1c63156096cfe18da02b47bcb3b36982457b157a1dde70a3303646b"}, "tags": [], "refs": [["stg_landing__card_currency"], ["stg_landing__way4_trans_type"], ["stg_landing__df_card_channel"], ["stg_landing__df_card_channel"], ["int_way4__card"], ["stg__card_acnt_contract_plus_bk"]], "sources": [["daily_bulanding", "card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL"], ["daily_bulanding", "card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\test\\fct__trans_card_bk.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959751.332261, "compiled_code": "\nWITH cte_currency AS (\n  SELECT\n    code\n    , name AS currency\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_currency\n  WHERE\n    amnd_state = 'A'\n)\n, cte_card_m_transaction AS (\n  SELECT\n    doc__oid\n    , SUM(local_amount) as local_amount\n  FROM\n    oracle_bulanding.df_2.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL\n  WHERE\n    service_class = 'T'\n    AND entry_type IN ('B','S')\n    AND posting_date = to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD')\n  GROUP BY doc__oid\n)\n, way4_type AS (\n  SELECT\n    *\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__way4_trans_type\n  WHERE\n    amnd_state = 'A'\n)\n  SELECT\n    doc.id\n    ,doc.amnd_date\n    ,doc.posting_date\n    ,doc.trans_date AS transaction_date\n    ,doc.is_authorization\n    ,doc.posting_status\n    ,doc.request_category\n    ,doc.return_code\n    ,doc.merchant_id\n    ,doc.doc__orig__id\n    ,doc.ret_ref_number\n    ,SETTL_AMOUNT settlement_amount\n    ,cur_settle.currency AS settlement_currency\n    ,doc.TRANS_AMOUNT transaction_amount\n    ,cur_trans.currency  AS transaction_currency\n    ,mt.local_amount AS txn_amt_lcy\n    ,sic_code\n    ,scnl.channel_desc AS src_cnl\n    ,tcnl.channel_desc AS trg_cnl\n    ,doc.source_member_id\n    ,doc.source_number\n    ,doc.source_reg_num\n    ,doc.trans_condition\n    ,doc.target_contract\n    ,doc.target_number\n    ,doc.TRANS_CITY transaction_city\n    ,doc.TRANS_COUNTRY transaction_country\n    ,doc.TRANS_DETAILS transaction_location\n    ,tp.name AS trans_type\n    ,tp.dr_cr\n    ,cntr.type_of_card\n    ,doc.source_code\n    ,doc.outward_status\n    ,doc.service_class\n    ,CASE\n        WHEN tp.name = 'ATM' THEN 'ATM'\n        WHEN doc.trans_condition IN ('NMR2','NMR','NMO2','NNK','NMO','NMN','PET','TET','PES','TES'\n                                    ,'NEV2','TEV2','NEV','TEV','NEU2','TEU2','NEU','TEU','SEU') THEN 'Online'\n        WHEN doc.trans_condition IN ('POSL','POSK','POEL','POEK','PO1L','PO1K','POTL','POTK','POUL','POUK'\n                                    ,'POVL','POVK') THEN 'POS'\n        ELSE 'Others'\n      END AS trans_channel\n    , cntr.card_id\n    , acnt.acnt_contract__oid\n    , nvl(acnt.ACNT_CONTRACT__ID,doc.target_contract) AS acnt_contract__id\n  FROM\n    oracle_bulanding.df_2.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL doc\n  JOIN way4_type tp ON doc.trans_type = tp.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_card_channel scnl ON doc.source_channel = scnl.channel_code\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_card_channel tcnl ON doc.target_channel = tcnl.channel_code\n  JOIN \"oracle_dgaworkzone\".int.int_way4__card cntr ON doc.target_number = cntr.contract_number\n  LEFT JOIN cte_currency cur_trans ON doc.trans_curr = cur_trans.code\n  LEFT JOIN cte_currency cur_settle ON doc.settl_curr = cur_settle.code\n  LEFT JOIN cte_card_m_transaction mt ON doc.id = mt.doc__oid\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg__card_acnt_contract_plus_bk acnt ON doc.target_contract = acnt.id AND acnt.AMND_STATE = 'A'\n  WHERE\n    doc.is_authorization = 'N'\n    AND doc.posting_status = 'P'\n    AND tp.name IN ('Retail','ATM','Cash','Unique')\n    AND doc.posting_date = to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD')", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__trans_card_bk"}, "model.dga_data_model.fct__acc_opportunity_step": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "model.dga_data_model.stg_landing__sppl_m_account_planning", "model.dga_data_model.stg_landing__sppl_m_activities", "model.dga_data_model.stg_landing__sppl_m_flow_activities_status", "model.dga_data_model.stg_landing__sppl_m_selling_status", "model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "model.dga_data_model.stg_landing__sppl_m_activities", "model.dga_data_model.stg_landing__sppl_m_flow_activities_status", "model.dga_data_model.stg_landing__sppl_m_selling_status"]}, "config": {"enabled": true, "alias": null, "schema": "mart", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3", "date_column": "nhan_lead_date_created"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "mart", "fqn": ["dga_data_model", "mart", "venus", "fct__acc_opportunity_step"], "unique_id": "model.dga_data_model.fct__acc_opportunity_step", "raw_code": "{{\r\n    config(\r\n      materialized='table',\r\n    )\r\n}}\r\nWITH first_3_step_status AS (\r\n  SELECT\r\n      s.id AS opportunity_id\r\n    , fas.vn_step_status\r\n    , ss.code\r\n    , fas.date_created\r\n    , fas.last_updated\r\n    , CASE ss.code\r\n        WHEN 'SLKH' THEN 1\r\n        WHEN 'TTTT' THEN 2\r\n        WHEN 'TBSP' THEN 3\r\n      END AS step_rank\r\n  FROM\r\n    {{ ref('stg_landing__sppl_m_selling_opportunity') }} s\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_account_planning')}} ap ON s.account_planning_id = ap.id\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_activities')}} a ON ap.activities_id = a.id\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_flow_activities_status') }} fas ON fas.activities_id = a.id\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_selling_status')}} ss ON fas.selling_status_id = ss.id\r\n  WHERE ss.code IN ('SLKH', 'TTTT' , 'TBSP' )\r\n)\r\n, last_4_step_stastus AS (\r\n  SELECT\r\n      s.id AS opportunity_id\r\n    , fas.vn_step_status\r\n    , ss.code\r\n    , fas.date_created\r\n    , fas.last_updated\r\n    , CASE ss.code\r\n        WHEN 'XLTC' THEN 4\r\n        WHEN 'QTHS' THEN 5\r\n        WHEN 'ASP' THEN 6\r\n        WHEN 'CSSB' THEN 7\r\n      END AS step_rank\r\n  FROM\r\n    {{ ref('stg_landing__sppl_m_selling_opportunity') }} s\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_activities')}} a ON s.activities_id = a.id\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_flow_activities_status') }} fas ON fas.activities_id = a.id\r\n  INNER JOIN {{ ref('stg_landing__sppl_m_selling_status')}} ss ON fas.selling_status_id = ss.id\r\n  WHERE ss.code in ('XLTC', 'QTHS', 'ASP', 'CSSB')\r\n)\r\n, step_status AS (\r\n  SELECT * FROM first_3_step_status\r\n  UNION\r\n  SELECT * FROM last_4_step_stastus\r\n)\r\n, lag_status AS (\r\n  SELECT\r\n    a.*\r\n    , LAG(vn_step_status) OVER(PARTITION BY opportunity_id ORDER BY step_rank) AS fommer_step_status\r\n  FROM\r\n    step_status a\r\n)\r\n, step_status_revised AS (\r\n  SELECT\r\n    opportunity_id\r\n    , code\r\n    , CASE\r\n        WHEN code = 'SLKH' THEN date_created\r\n        WHEN fommer_step_status IS NULL THEN date_created\r\n        WHEN fommer_step_status = 'Ho\u00e0n th\u00e0nh' THEN date_created\r\n        ELSE NULL\r\n      END AS date_created\r\n    , CASE\r\n        WHEN code = 'SLKH' THEN last_updated\r\n        WHEN fommer_step_status IS NULL THEN last_updated\r\n        WHEN fommer_step_status = 'Ho\u00e0n th\u00e0nh' THEN last_updated\r\n        ELSE NULL\r\n      END AS last_updated\r\n    , CASE\r\n        WHEN code = 'SLKH' THEN vn_step_status\r\n        WHEN fommer_step_status IS NULL THEN vn_step_status\r\n        WHEN fommer_step_status = 'Ho\u00e0n th\u00e0nh' THEN vn_step_status\r\n        ELSE NULL\r\n      END AS vn_step_status\r\n  FROM lag_status\r\n\r\n)\r\n, pivot_step AS (\r\n  SELECT\r\n      *\r\n  FROM\r\n    step_status_revised\r\n  PIVOT (\r\n      MAX(vn_step_status) AS status\r\n    , MAX(date_created) AS date_created\r\n    , MAX(last_updated) AS last_updated\r\n  FOR code IN (\r\n    'SLKH' AS slkh\r\n  , 'TTTT' AS tttt\r\n  , 'TBSP' AS tbsp\r\n  , 'XLTC' AS xltc\r\n  , 'QTHS' AS qths\r\n  , 'ASP' AS asp\r\n  , 'CSSB' AS cssb )\r\n      )\r\n)\r\n\r\nSELECT\r\n    opportunity_id\r\n  , slkh_status AS nhan_lead_status\r\n  , slkh_date_created AS nhan_lead_date_created\r\n  , tttt_status AS tiep_can_status\r\n  , tttt_date_created AS tiep_can_date_created\r\n  , tbsp_status AS trinh_bay_sp_status\r\n  , CASE\r\n      WHEN tbsp_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN tttt_last_updated\r\n      WHEN tbsp_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN tbsp_last_updated\r\n      ELSE NULL\r\n    END AS trinh_bay_sp_date_created\r\n  , xltc_status AS xu_ly_tu_choi_status\r\n  , CASE\r\n      WHEN xltc_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN tbsp_last_updated\r\n      WHEN xltc_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN xltc_last_updated\r\n      ELSE NULL\r\n    END AS xu_ly_tu_choi_date_created\r\n  , qths_status AS trinh_ho_so_status\r\n  , CASE\r\n      WHEN qths_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN xltc_last_updated\r\n      WHEN qths_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN qths_last_updated\r\n      ELSE NULL\r\n    END AS trinh_ho_so_date_created\r\n  , asp_status AS active_status\r\n  , CASE\r\n      WHEN asp_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN qths_last_updated\r\n      WHEN asp_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN asp_last_updated\r\n      ELSE NULL\r\n    END AS active_date_created\r\n  , cssb_status AS cham_soc_sau_ban_status\r\n  , CASE\r\n      WHEN cssb_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN asp_last_updated\r\n      WHEN cssb_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN cssb_last_updated\r\n      ELSE NULL\r\n    END AS cham_soc_sau_ban_date_created\r\nFROM\r\n  pivot_step", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "mart\\venus\\fct__acc_opportunity_step.sql", "original_file_path": "models\\mart\\venus\\fct__acc_opportunity_step.sql", "name": "fct__acc_opportunity_step", "alias": "fct__acc_opportunity_step", "checksum": {"name": "sha256", "checksum": "a1e4807bd9d64e2d96c7d19b33677f5968499a105972d73db9e135b73e7eff84"}, "tags": ["venus_daily"], "refs": [["stg_landing__sppl_m_selling_opportunity"], ["stg_landing__sppl_m_account_planning"], ["stg_landing__sppl_m_activities"], ["stg_landing__sppl_m_flow_activities_status"], ["stg_landing__sppl_m_selling_status"], ["stg_landing__sppl_m_selling_opportunity"], ["stg_landing__sppl_m_activities"], ["stg_landing__sppl_m_flow_activities_status"], ["stg_landing__sppl_m_selling_status"]], "sources": [], "metrics": [], "description": "", "columns": {"opportunity_id": {"name": "opportunity_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "nhan_lead_date_created"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\mart\\venus\\venus_mart.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\venus\\fct__acc_opportunity_step.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "mart", "meta": {"date_column": "nhan_lead_date_created"}, "tags": "venus_daily", "materialized": "table"}, "created_at": 1685959752.87998, "compiled_code": "\nWITH first_3_step_status AS (\n  SELECT\n      s.id AS opportunity_id\n    , fas.vn_step_status\n    , ss.code\n    , fas.date_created\n    , fas.last_updated\n    , CASE ss.code\n        WHEN 'SLKH' THEN 1\n        WHEN 'TTTT' THEN 2\n        WHEN 'TBSP' THEN 3\n      END AS step_rank\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_opportunity s\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_account_planning ap ON s.account_planning_id = ap.id\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_activities a ON ap.activities_id = a.id\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_flow_activities_status fas ON fas.activities_id = a.id\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_status ss ON fas.selling_status_id = ss.id\n  WHERE ss.code IN ('SLKH', 'TTTT' , 'TBSP' )\n)\n, last_4_step_stastus AS (\n  SELECT\n      s.id AS opportunity_id\n    , fas.vn_step_status\n    , ss.code\n    , fas.date_created\n    , fas.last_updated\n    , CASE ss.code\n        WHEN 'XLTC' THEN 4\n        WHEN 'QTHS' THEN 5\n        WHEN 'ASP' THEN 6\n        WHEN 'CSSB' THEN 7\n      END AS step_rank\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_opportunity s\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_activities a ON s.activities_id = a.id\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_flow_activities_status fas ON fas.activities_id = a.id\n  INNER JOIN \"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_status ss ON fas.selling_status_id = ss.id\n  WHERE ss.code in ('XLTC', 'QTHS', 'ASP', 'CSSB')\n)\n, step_status AS (\n  SELECT * FROM first_3_step_status\n  UNION\n  SELECT * FROM last_4_step_stastus\n)\n, lag_status AS (\n  SELECT\n    a.*\n    , LAG(vn_step_status) OVER(PARTITION BY opportunity_id ORDER BY step_rank) AS fommer_step_status\n  FROM\n    step_status a\n)\n, step_status_revised AS (\n  SELECT\n    opportunity_id\n    , code\n    , CASE\n        WHEN code = 'SLKH' THEN date_created\n        WHEN fommer_step_status IS NULL THEN date_created\n        WHEN fommer_step_status = 'Ho\u00e0n th\u00e0nh' THEN date_created\n        ELSE NULL\n      END AS date_created\n    , CASE\n        WHEN code = 'SLKH' THEN last_updated\n        WHEN fommer_step_status IS NULL THEN last_updated\n        WHEN fommer_step_status = 'Ho\u00e0n th\u00e0nh' THEN last_updated\n        ELSE NULL\n      END AS last_updated\n    , CASE\n        WHEN code = 'SLKH' THEN vn_step_status\n        WHEN fommer_step_status IS NULL THEN vn_step_status\n        WHEN fommer_step_status = 'Ho\u00e0n th\u00e0nh' THEN vn_step_status\n        ELSE NULL\n      END AS vn_step_status\n  FROM lag_status\n\n)\n, pivot_step AS (\n  SELECT\n      *\n  FROM\n    step_status_revised\n  PIVOT (\n      MAX(vn_step_status) AS status\n    , MAX(date_created) AS date_created\n    , MAX(last_updated) AS last_updated\n  FOR code IN (\n    'SLKH' AS slkh\n  , 'TTTT' AS tttt\n  , 'TBSP' AS tbsp\n  , 'XLTC' AS xltc\n  , 'QTHS' AS qths\n  , 'ASP' AS asp\n  , 'CSSB' AS cssb )\n      )\n)\n\nSELECT\n    opportunity_id\n  , slkh_status AS nhan_lead_status\n  , slkh_date_created AS nhan_lead_date_created\n  , tttt_status AS tiep_can_status\n  , tttt_date_created AS tiep_can_date_created\n  , tbsp_status AS trinh_bay_sp_status\n  , CASE\n      WHEN tbsp_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN tttt_last_updated\n      WHEN tbsp_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN tbsp_last_updated\n      ELSE NULL\n    END AS trinh_bay_sp_date_created\n  , xltc_status AS xu_ly_tu_choi_status\n  , CASE\n      WHEN xltc_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN tbsp_last_updated\n      WHEN xltc_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN xltc_last_updated\n      ELSE NULL\n    END AS xu_ly_tu_choi_date_created\n  , qths_status AS trinh_ho_so_status\n  , CASE\n      WHEN qths_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN xltc_last_updated\n      WHEN qths_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN qths_last_updated\n      ELSE NULL\n    END AS trinh_ho_so_date_created\n  , asp_status AS active_status\n  , CASE\n      WHEN asp_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN qths_last_updated\n      WHEN asp_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN asp_last_updated\n      ELSE NULL\n    END AS active_date_created\n  , cssb_status AS cham_soc_sau_ban_status\n  , CASE\n      WHEN cssb_status IN ('Ho\u00e0n th\u00e0nh', 'Th\u1ea5t b\u1ea1i') THEN asp_last_updated\n      WHEN cssb_status = '\u0110ang th\u1ef1c hi\u1ec7n' THEN cssb_last_updated\n      ELSE NULL\n    END AS cham_soc_sau_ban_date_created\nFROM\n  pivot_step", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".mart.fct__acc_opportunity_step"}, "model.dga_data_model.stg_bpm_vhkq__atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.atm"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__atm"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__atm", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH source AS(\r\n  select id,\r\n    address,\r\n    content,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cycle_status,\r\n    fund_balance,\r\n    fund_ratio,\r\n    \"group\",\r\n    latest_cycle_receive_fund,\r\n    cast(latest_receive_fund_at as timestamp(3)) as latest_receive_fund_at,\r\n    receive_fund_limit,\r\n    status,\r\n    cast(updated_at as timestamp(3)) as updated_at,\r\n    code,\r\n    content_operate,\r\n    cast(last_to_fund_at as timestamp(3)) as last_to_fund_at,\r\n    cast(latest_fund_at as timestamp(3)) as latest_fund_at,\r\n    location,\r\n    \"model\",\r\n    number_cycle_fund,\r\n    numeric_lock_qty,\r\n    optimal_fund_limit,\r\n    reason_operate,\r\n    regulation_fund_limit,\r\n    series_number,\r\n    total_keys,\r\n    total_keys_staff_using,\r\n    total_keys_treasurer_using,\r\n    total_numeric_lock_staff_backup,\r\n    total_numeric_lock_treasurer_backup,\r\n    tray_qty,\r\n    unit_code,\r\n    unit_code_manage,\r\n    atm_category_tray,\r\n    organization_code,\r\n    warehouse,\r\n    warehouse_organization\r\n  FROM\r\n    {{ source('ms_kho_quy', 'atm' ) }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__atm.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__atm.sql", "name": "stg_bpm_vhkq__atm", "alias": "stg_bpm_vhkq__atm", "checksum": {"name": "sha256", "checksum": "589a228d07d89a51c1d1ae4f86db4d063937c81518d789893e29935b8d5da754"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "atm"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8849075, "compiled_code": "\nWITH source AS(\n  select id,\n    address,\n    content,\n    cast(created_at as timestamp(3)) as created_at,\n    cycle_status,\n    fund_balance,\n    fund_ratio,\n    \"group\",\n    latest_cycle_receive_fund,\n    cast(latest_receive_fund_at as timestamp(3)) as latest_receive_fund_at,\n    receive_fund_limit,\n    status,\n    cast(updated_at as timestamp(3)) as updated_at,\n    code,\n    content_operate,\n    cast(last_to_fund_at as timestamp(3)) as last_to_fund_at,\n    cast(latest_fund_at as timestamp(3)) as latest_fund_at,\n    location,\n    \"model\",\n    number_cycle_fund,\n    numeric_lock_qty,\n    optimal_fund_limit,\n    reason_operate,\n    regulation_fund_limit,\n    series_number,\n    total_keys,\n    total_keys_staff_using,\n    total_keys_treasurer_using,\n    total_numeric_lock_staff_backup,\n    total_numeric_lock_treasurer_backup,\n    tray_qty,\n    unit_code,\n    unit_code_manage,\n    atm_category_tray,\n    organization_code,\n    warehouse,\n    warehouse_organization\n  FROM\n    mysql_bpm_119.ms_kho_quy.atm\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm"}, "model.dga_data_model.stg_bpm_vhkq__atm_category_tray": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.atm_category_tray"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__atm_category_tray"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__atm_category_tray", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    code,\r\n    name,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'atm_category_tray') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__atm_category_tray.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__atm_category_tray.sql", "name": "stg_bpm_vhkq__atm_category_tray", "alias": "stg_bpm_vhkq__atm_category_tray", "checksum": {"name": "sha256", "checksum": "af975d16754bb1c7b09de90ed2a8048190f63c8bba1e9daa5ef4b721da951105"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "atm_category_tray"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__atm_category_tray.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8869069, "compiled_code": "\nWITH source AS(\n select id,\n    code,\n    name,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.atm_category_tray\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm_category_tray"}, "model.dga_data_model.stg_bpm_vhkq__atm_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.atm_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__atm_detail"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__atm_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    denomination,\r\n    name,\r\n    qty,\r\n    seal_status,\r\n    tray_type,\r\n    atm_id,\r\n    denominationcode,\r\n    denominationvalue,\r\n    \"type\",\r\n    atm_category_tray,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'atm_detail') }}\r\n\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__atm_detail.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__atm_detail.sql", "name": "stg_bpm_vhkq__atm_detail", "alias": "stg_bpm_vhkq__atm_detail", "checksum": {"name": "sha256", "checksum": "9a7973b98878a1c6023c571168c7056d829b02cf5417f31cb556aac07cb1f202"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "atm_detail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__atm_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8889885, "compiled_code": "\nWITH source AS(\n select id,\n    denomination,\n    name,\n    qty,\n    seal_status,\n    tray_type,\n    atm_id,\n    denominationcode,\n    denominationvalue,\n    \"type\",\n    atm_category_tray,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.atm_detail\n\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm_detail"}, "model.dga_data_model.stg_bpm_vhkq__attachment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.attachment"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__attachment"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__attachment", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    \"data\",\r\n    extension,\r\n    isdeleted,\r\n    name,\r\n    \"path\",\r\n    request_id,\r\n    request_type,\r\n    \"size\",\r\n    \"type\",\r\n    \"uuid\",\r\n    type_upload,\r\n    version_id,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'attachment') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__attachment.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__attachment.sql", "name": "stg_bpm_vhkq__attachment", "alias": "stg_bpm_vhkq__attachment", "checksum": {"name": "sha256", "checksum": "30a53b0d93da2c8cf72ec3deca0954c0158e7f5aa6edcdcea8c9ffab3acee47f"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "attachment"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__attachment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8899798, "compiled_code": "\nWITH source AS(\n select id,\n    \"data\",\n    extension,\n    isdeleted,\n    name,\n    \"path\",\n    request_id,\n    request_type,\n    \"size\",\n    \"type\",\n    \"uuid\",\n    type_upload,\n    version_id,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.attachment\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__attachment"}, "model.dga_data_model.stg_bpm_vhkq__category": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.category"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__category"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__category", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    code,\r\n    datacode,\r\n    datavalue,\r\n    description,\r\n    isdeleted,\r\n    name,\r\n    orderby,\r\n    orderby1\r\n  FROM {{ source('ms_kho_quy', 'category') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__category.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__category.sql", "name": "stg_bpm_vhkq__category", "alias": "stg_bpm_vhkq__category", "checksum": {"name": "sha256", "checksum": "0a997d7649cb943f141ab3edce93844f98087806adbe38d61f5f66e154af7272"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "category"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__category.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8909795, "compiled_code": "\nWITH source AS(\n select id,\n    code,\n    datacode,\n    datavalue,\n    description,\n    isdeleted,\n    name,\n    orderby,\n    orderby1\n  FROM mysql_bpm_119.ms_kho_quy.category\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__category"}, "model.dga_data_model.stg_bpm_vhkq__delivery": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.delivery"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__delivery"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__delivery", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    is_deleted,\r\n    note,\r\n    \"type\",\r\n    request_branch_id,\r\n    staff_id,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'delivery') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__delivery.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__delivery.sql", "name": "stg_bpm_vhkq__delivery", "alias": "stg_bpm_vhkq__delivery", "checksum": {"name": "sha256", "checksum": "3378a8faa68c0e4ec6747a36df995647d3beafed05abfca573b7131fb6a20432"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "delivery"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__delivery.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8929896, "compiled_code": "\nWITH source AS(\n select id,\n    is_deleted,\n    note,\n    \"type\",\n    request_branch_id,\n    staff_id,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.delivery\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__delivery"}, "model.dga_data_model.stg_bpm_vhkq__doc_no": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.doc_no"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__doc_no"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__doc_no", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    code,\r\n    composite_doc_no,\r\n    description,\r\n    name,\r\n    num,\r\n    \"year\",\r\n    organization_code,\r\n    organization_name\r\n  FROM {{ source('ms_kho_quy', 'doc_no') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__doc_no.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__doc_no.sql", "name": "stg_bpm_vhkq__doc_no", "alias": "stg_bpm_vhkq__doc_no", "checksum": {"name": "sha256", "checksum": "d3b975d54f4fbf59b6d3ccc150e18094af70437151811391ae2901304a81f0b8"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "doc_no"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__doc_no.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.89498, "compiled_code": "\nWITH source AS(\n select id,\n    code,\n    composite_doc_no,\n    description,\n    name,\n    num,\n    \"year\",\n    organization_code,\n    organization_name\n  FROM mysql_bpm_119.ms_kho_quy.doc_no\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__doc_no"}, "model.dga_data_model.stg_bpm_vhkq__mail_log": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.mail_log"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__mail_log"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__mail_log", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    content,\r\n    send_to,\r\n    title,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'mail_log') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__mail_log.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__mail_log.sql", "name": "stg_bpm_vhkq__mail_log", "alias": "stg_bpm_vhkq__mail_log", "checksum": {"name": "sha256", "checksum": "de47740877cafbd0457bc46893cb70352a04611a13a40008483e2ff157af7ee5"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "mail_log"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__mail_log.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.895982, "compiled_code": "\nWITH source AS(\n select id,\n    content,\n    send_to,\n    title,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.mail_log\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__mail_log"}, "model.dga_data_model.stg_bpm_vhkq__position": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.position"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__position"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__position", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    description,\r\n    is_deleted,\r\n    name,\r\n    order_by\r\n  FROM {{ source('ms_kho_quy', 'position') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__position.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__position.sql", "name": "stg_bpm_vhkq__position", "alias": "stg_bpm_vhkq__position", "checksum": {"name": "sha256", "checksum": "8da3e71715c9bdafe1ed50b8a9d149783694a5063b0659d8b234a9357199123d"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "position"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__position.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8979783, "compiled_code": "\nWITH source AS(\n select id,\n    description,\n    is_deleted,\n    name,\n    order_by\n  FROM mysql_bpm_119.ms_kho_quy.position\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__position"}, "model.dga_data_model.stg_bpm_vhkq__process_definition": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.process_definition"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__process_definition"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__process_definition", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    code,\r\n    created_by,\r\n    name,\r\n    process_definition_id,\r\n    updated_by,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'process_definition') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__process_definition.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__process_definition.sql", "name": "stg_bpm_vhkq__process_definition", "alias": "stg_bpm_vhkq__process_definition", "checksum": {"name": "sha256", "checksum": "f4045da1aba544406885065ef7ce9d47eeffa22ad058230fd48909ea12765213"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "process_definition"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__process_definition.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.8999074, "compiled_code": "\nWITH source AS(\n select id,\n    code,\n    created_by,\n    name,\n    process_definition_id,\n    updated_by,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.process_definition\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__process_definition"}, "model.dga_data_model.stg_bpm_vhkq__process_instance": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.process_instance"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__process_instance"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__process_instance", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    bpm_process_definition_id,\r\n    created_by,\r\n    cast(disabled_at as timestamp(3)) as disabled_at,\r\n    disabled_by,\r\n    highest_task_definition_key,\r\n    is_deleted,\r\n    is_disabled,\r\n    process_instance_id,\r\n    ref_id,\r\n    request_code,\r\n    status,\r\n    task_definition_key,\r\n    user_name,\r\n    process_definition_id,\r\n    bpm_task_id,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'process_instance') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__process_instance.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__process_instance.sql", "name": "stg_bpm_vhkq__process_instance", "alias": "stg_bpm_vhkq__process_instance", "checksum": {"name": "sha256", "checksum": "dbc35bb79a4fd3ec457d7bb4bdb3d8997e4dd6ebe95611383049ebb3ad5ea2e3"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "process_instance"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__process_instance.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.901985, "compiled_code": "\nWITH source AS(\n select id,\n    bpm_process_definition_id,\n    created_by,\n    cast(disabled_at as timestamp(3)) as disabled_at,\n    disabled_by,\n    highest_task_definition_key,\n    is_deleted,\n    is_disabled,\n    process_instance_id,\n    ref_id,\n    request_code,\n    status,\n    task_definition_key,\n    user_name,\n    process_definition_id,\n    bpm_task_id,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.process_instance\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__process_instance"}, "model.dga_data_model.stg_bpm_vhkq__process_instance_his": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.process_instance_his"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__process_instance_his"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__process_instance_his", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    \"action\",\r\n    bpm_process_instance_id,\r\n    comment,\r\n    from_task_definition_key,\r\n    from_task_id,\r\n    cast(from_time as timestamp(3)) as from_time,\r\n    from_user,\r\n    status,\r\n    to_task_definition_key,\r\n    to_task_id,\r\n    cast(to_time as timestamp(3)) as to_time,\r\n    to_user,\r\n    process_instance_id,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'process_instance_his') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__process_instance_his.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__process_instance_his.sql", "name": "stg_bpm_vhkq__process_instance_his", "alias": "stg_bpm_vhkq__process_instance_his", "checksum": {"name": "sha256", "checksum": "8f93af8f41254661e3e536e80a059eac3c3fdcfbb8aa2acf74dd56cc429a47a8"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "process_instance_his"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__process_instance_his.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9039073, "compiled_code": "\nWITH source AS(\n select id,\n    \"action\",\n    bpm_process_instance_id,\n    comment,\n    from_task_definition_key,\n    from_task_id,\n    cast(from_time as timestamp(3)) as from_time,\n    from_user,\n    status,\n    to_task_definition_key,\n    to_task_id,\n    cast(to_time as timestamp(3)) as to_time,\n    to_user,\n    process_instance_id,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.process_instance_his\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__process_instance_his"}, "model.dga_data_model.stg_bpm_vhkq__request_atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_atm"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_atm"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_atm", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at,\r\n    cast(accounting_date as timestamp(3)) as accounting_date,\r\n    cast(approval_date as timestamp(3)) as approval_date,\r\n    cast(execute_date as timestamp(3)) as execute_date,\r\n    cast(issued_date_checker as timestamp(3)) as issued_date_checker,\r\n    cast(plan_date as timestamp(3)) as plan_date,\r\n    cast(submitted_at as timestamp(3)) as submitted_at,\r\n    cast(verify_date as timestamp(3)) as verify_date,\r\n    cast(verify_received_date as timestamp(3)) as verify_received_date,\r\n    cast(issued_date_recipient as timestamp(3)) as issued_date_recipient,\r\n    process_instance_id,\r\n    accounting_code_core,\r\n    approver,\r\n    atm_code,\r\n    atm_id,\r\n    checker,\r\n    checker_name,\r\n    code_bbpd,\r\n    created_by,\r\n    entry_core,\r\n    entry_number,\r\n    \"group\",\r\n    id_identity_checker,\r\n    is_complete,\r\n    issued_by_checker,\r\n    kq_fund_balance,\r\n    kq_is_diff,\r\n    kq_is_hold_card,\r\n    kq_is_seal,\r\n    kq_is_success,\r\n    kq_note,\r\n    kq_seal_status,\r\n    kq_total_diff,\r\n    last_comment,\r\n    organization_code,\r\n    \"ref\",\r\n    staff_atm,\r\n    status,\r\n    submitted_by,\r\n    total_fund,\r\n    total_fund_recovery,\r\n    tq_is_seal,\r\n    tq_is_success,\r\n    tq_note,\r\n    tq_seal_status,\r\n    treasurer_atm,\r\n    ttc_hour_from,\r\n    ttc_hour_to,\r\n    ttc_num_km_from,\r\n    ttc_num_km_to,\r\n    \"type\",\r\n    type_operate,\r\n    unit_manager,\r\n    update_by,\r\n    verifier,\r\n    verifier_name,\r\n    process_instance,\r\n    cbdm,\r\n    cbdm_name,\r\n    id_identity_recipient,\r\n    is_branch,\r\n    issued_by_recipient,\r\n    recipient,\r\n    recipient_name\r\n\r\n  FROM {{ source('ms_kho_quy', 'request_atm') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm.sql", "name": "stg_bpm_vhkq__request_atm", "alias": "stg_bpm_vhkq__request_atm", "checksum": {"name": "sha256", "checksum": "2695b5109ff6e63ba8879f28324fb8ad1ccee250e2eed90d8e3a9f05ce9cd22a"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_atm"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9069798, "compiled_code": "\nWITH source AS(\n select id,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at,\n    cast(accounting_date as timestamp(3)) as accounting_date,\n    cast(approval_date as timestamp(3)) as approval_date,\n    cast(execute_date as timestamp(3)) as execute_date,\n    cast(issued_date_checker as timestamp(3)) as issued_date_checker,\n    cast(plan_date as timestamp(3)) as plan_date,\n    cast(submitted_at as timestamp(3)) as submitted_at,\n    cast(verify_date as timestamp(3)) as verify_date,\n    cast(verify_received_date as timestamp(3)) as verify_received_date,\n    cast(issued_date_recipient as timestamp(3)) as issued_date_recipient,\n    process_instance_id,\n    accounting_code_core,\n    approver,\n    atm_code,\n    atm_id,\n    checker,\n    checker_name,\n    code_bbpd,\n    created_by,\n    entry_core,\n    entry_number,\n    \"group\",\n    id_identity_checker,\n    is_complete,\n    issued_by_checker,\n    kq_fund_balance,\n    kq_is_diff,\n    kq_is_hold_card,\n    kq_is_seal,\n    kq_is_success,\n    kq_note,\n    kq_seal_status,\n    kq_total_diff,\n    last_comment,\n    organization_code,\n    \"ref\",\n    staff_atm,\n    status,\n    submitted_by,\n    total_fund,\n    total_fund_recovery,\n    tq_is_seal,\n    tq_is_success,\n    tq_note,\n    tq_seal_status,\n    treasurer_atm,\n    ttc_hour_from,\n    ttc_hour_to,\n    ttc_num_km_from,\n    ttc_num_km_to,\n    \"type\",\n    type_operate,\n    unit_manager,\n    update_by,\n    verifier,\n    verifier_name,\n    process_instance,\n    cbdm,\n    cbdm_name,\n    id_identity_recipient,\n    is_branch,\n    issued_by_recipient,\n    recipient,\n    recipient_name\n\n  FROM mysql_bpm_119.ms_kho_quy.request_atm\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm"}, "model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_atm_card_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_atm_card_detail"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    is_deleted,\r\n    name,\r\n    \"number\" as card_number,\r\n    request_atm,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'request_atm_card_detail') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_card_detail.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_card_detail.sql", "name": "stg_bpm_vhkq__request_atm_card_detail", "alias": "stg_bpm_vhkq__request_atm_card_detail", "checksum": {"name": "sha256", "checksum": "136eed2c833332f9cc558e338dd747c4654f660c7f6c63131ddb5fe2e1ef448e"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_atm_card_detail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_card_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.908978, "compiled_code": "\nWITH source AS(\n select id,\n    is_deleted,\n    name,\n    \"number\" as card_number,\n    request_atm,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.request_atm_card_detail\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_card_detail"}, "model.dga_data_model.stg_bpm_vhkq__request_atm_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_atm_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_atm_detail"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_atm_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    address,\r\n    code,\r\n    content_operate,\r\n    cycle_status,\r\n    \"group\",\r\n    is_deleted,\r\n    cast(last_to_fund_at as timestamp(3)) as last_to_fund_at,\r\n    number_cycle_fund,\r\n    optimal_fund_limit,\r\n    reason_operate,\r\n    regulation_fund_limit,\r\n    total_keys_staff_using,\r\n    total_keys_treasurer_using,\r\n    total_numeric_lock_staff_backup,\r\n    total_numeric_lock_treasurer_backup,\r\n    tray_structure,\r\n    atm,\r\n    request_atm,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'request_atm_detail') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_detail.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_detail.sql", "name": "stg_bpm_vhkq__request_atm_detail", "alias": "stg_bpm_vhkq__request_atm_detail", "checksum": {"name": "sha256", "checksum": "4e37a79d8e596f584300e5a7734008dd729e4f504b629d380d78fa5c2dd04a79"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_atm_detail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9109826, "compiled_code": "\nWITH source AS(\n select id,\n    address,\n    code,\n    content_operate,\n    cycle_status,\n    \"group\",\n    is_deleted,\n    cast(last_to_fund_at as timestamp(3)) as last_to_fund_at,\n    number_cycle_fund,\n    optimal_fund_limit,\n    reason_operate,\n    regulation_fund_limit,\n    total_keys_staff_using,\n    total_keys_treasurer_using,\n    total_numeric_lock_staff_backup,\n    total_numeric_lock_treasurer_backup,\n    tray_structure,\n    atm,\n    request_atm,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.request_atm_detail\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_detail"}, "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_atm_tray_control"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_atm_tray_control"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    denominationcode,\r\n    denominationvalue,\r\n    is_deleted,\r\n    name,\r\n    qty_bill,\r\n    qty_bill_reject,\r\n    qty_bill_retract,\r\n    qty_tray,\r\n    qty_tray_reject,\r\n    qty_tray_retract,\r\n    \"type\",\r\n    atm,\r\n    request_atm,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'request_atm_tray_control') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_tray_control.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_tray_control.sql", "name": "stg_bpm_vhkq__request_atm_tray_control", "alias": "stg_bpm_vhkq__request_atm_tray_control", "checksum": {"name": "sha256", "checksum": "fa84ca8b5f6abce5da059abc9cce253f2f9678a0c5e4f6ab8841e5a01edf36d6"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_atm_tray_control"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_tray_control.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9129906, "compiled_code": "\nWITH source AS(\n select id,\n    denominationcode,\n    denominationvalue,\n    is_deleted,\n    name,\n    qty_bill,\n    qty_bill_reject,\n    qty_bill_retract,\n    qty_tray,\n    qty_tray_reject,\n    qty_tray_retract,\n    \"type\",\n    atm,\n    request_atm,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.request_atm_tray_control\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_tray_control"}, "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_atm_tray_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_atm_tray_detail"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    denominationcode,\r\n    denominationvalue,\r\n    is_deleted,\r\n    name,\r\n    qty,\r\n    \"type\",\r\n    atm,\r\n    request_atm,\r\n    request_atm_detail,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'request_atm_tray_detail') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_tray_detail.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_tray_detail.sql", "name": "stg_bpm_vhkq__request_atm_tray_detail", "alias": "stg_bpm_vhkq__request_atm_tray_detail", "checksum": {"name": "sha256", "checksum": "b7b8f59e4e852510bdd5aa6fe269f209df5122f3e6e2d8dbc6ed25a0ea314687"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_atm_tray_detail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_atm_tray_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9149785, "compiled_code": "\nWITH source AS(\n select id,\n    denominationcode,\n    denominationvalue,\n    is_deleted,\n    name,\n    qty,\n    \"type\",\n    atm,\n    request_atm,\n    request_atm_detail,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.request_atm_tray_detail\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_atm_tray_detail"}, "model.dga_data_model.stg_bpm_vhkq__request_branch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_branch"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_branch"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_branch", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    approver,\r\n    approver1,\r\n    bag_acqt_count,\r\n    bag_acqt_count_change,\r\n    bag_ctkt_count,\r\n    bag_ctkt_count_change,\r\n    bag_count,\r\n    bag_hstntd_count,\r\n    bag_hstntd_count_change,\r\n    bag_other_count,\r\n    bag_other_count_change,\r\n    bag_tntd_count,\r\n    bag_tntd_count_change,\r\n    bag_tsbd_count,\r\n    bag_tsbd_count_change,\r\n    box_count,\r\n    count_form,\r\n    count_hour,\r\n    count_minute,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at,\r\n    cast(pay_in_date as timestamp(3)) as pay_in_date,\r\n    cast(approval1_date as timestamp(3)) as approval1_date,\r\n    cast(approval_date as timestamp(3)) as approval_date,\r\n    cast(comment_date as timestamp(3)) as comment_date,\r\n    cast(detect_date as timestamp(3)) as detect_date,\r\n    cast(seal_date as timestamp(3)) as seal_date,\r\n    cast(submitted_at as timestamp(3)) as submitted_at,\r\n    created_by,\r\n    delivery_type,\r\n    fund_begin_day_usd,\r\n    fund_begin_day_vnd,\r\n    joint_balance,\r\n    last_comment,\r\n    organization_receive_code,\r\n    organization_receive_name,\r\n    organization_send_code,\r\n    organization_send_name,\r\n    other,\r\n    other_change,\r\n    pay_in_hour,\r\n    pay_in_minute,\r\n    reason,\r\n    seal_status,\r\n    status,\r\n    \"type\",\r\n    unbalance_types,\r\n    updated_by,\r\n    process_instance_id,\r\n    code_bbpd,\r\n    comment_fi,\r\n    conclusion,\r\n    currency,\r\n    entry_core,\r\n    entry_core_process,\r\n    fault_person,\r\n    fault_user,\r\n    handler,\r\n    note,\r\n    over_threshold,\r\n    process_reason,\r\n    process_type,\r\n    refid,\r\n    skewed_type,\r\n    total_skewed,\r\n    user_fi,\r\n    \"ref\",\r\n    line,\r\n    hour_from,\r\n    hour_to,\r\n    num_km_from,\r\n    num_km_to,\r\n    type_skewed\r\n  FROM {{ source('ms_kho_quy', 'request_branch') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_branch.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_branch.sql", "name": "stg_bpm_vhkq__request_branch", "alias": "stg_bpm_vhkq__request_branch", "checksum": {"name": "sha256", "checksum": "a926e63c6b1b1fcf9f0da2b78e48c917bf3ef69ac94d95b38385e1c683332bc1"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_branch"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_branch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9179075, "compiled_code": "\nWITH source AS(\n select id,\n    approver,\n    approver1,\n    bag_acqt_count,\n    bag_acqt_count_change,\n    bag_ctkt_count,\n    bag_ctkt_count_change,\n    bag_count,\n    bag_hstntd_count,\n    bag_hstntd_count_change,\n    bag_other_count,\n    bag_other_count_change,\n    bag_tntd_count,\n    bag_tntd_count_change,\n    bag_tsbd_count,\n    bag_tsbd_count_change,\n    box_count,\n    count_form,\n    count_hour,\n    count_minute,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at,\n    cast(pay_in_date as timestamp(3)) as pay_in_date,\n    cast(approval1_date as timestamp(3)) as approval1_date,\n    cast(approval_date as timestamp(3)) as approval_date,\n    cast(comment_date as timestamp(3)) as comment_date,\n    cast(detect_date as timestamp(3)) as detect_date,\n    cast(seal_date as timestamp(3)) as seal_date,\n    cast(submitted_at as timestamp(3)) as submitted_at,\n    created_by,\n    delivery_type,\n    fund_begin_day_usd,\n    fund_begin_day_vnd,\n    joint_balance,\n    last_comment,\n    organization_receive_code,\n    organization_receive_name,\n    organization_send_code,\n    organization_send_name,\n    other,\n    other_change,\n    pay_in_hour,\n    pay_in_minute,\n    reason,\n    seal_status,\n    status,\n    \"type\",\n    unbalance_types,\n    updated_by,\n    process_instance_id,\n    code_bbpd,\n    comment_fi,\n    conclusion,\n    currency,\n    entry_core,\n    entry_core_process,\n    fault_person,\n    fault_user,\n    handler,\n    note,\n    over_threshold,\n    process_reason,\n    process_type,\n    refid,\n    skewed_type,\n    total_skewed,\n    user_fi,\n    \"ref\",\n    line,\n    hour_from,\n    hour_to,\n    num_km_from,\n    num_km_to,\n    type_skewed\n  FROM mysql_bpm_119.ms_kho_quy.request_branch\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_branch"}, "model.dga_data_model.stg_bpm_vhkq__request_branch_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.request_branch_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__request_branch_detail"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__request_branch_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    currency,\r\n    denominationcode,\r\n    denominationvalue,\r\n    editable,\r\n    is_deleted,\r\n    qty_actual,\r\n    qty_back_fund,\r\n    qty_begin_day,\r\n    qty_system,\r\n    qty_system_old,\r\n    receive_fund_limit,\r\n    total_add,\r\n    total_begin_day,\r\n    total_old,\r\n    \"type\",\r\n    request_branch_id,\r\n    note,\r\n    line,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'request_branch_detail') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__request_branch_detail.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_branch_detail.sql", "name": "stg_bpm_vhkq__request_branch_detail", "alias": "stg_bpm_vhkq__request_branch_detail", "checksum": {"name": "sha256", "checksum": "4e71951dc6bdb27eaff25f315bcd372e29445522d865c4f74be984428fda360e"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "request_branch_detail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__request_branch_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9199812, "compiled_code": "\nWITH source AS(\n select id,\n    currency,\n    denominationcode,\n    denominationvalue,\n    editable,\n    is_deleted,\n    qty_actual,\n    qty_back_fund,\n    qty_begin_day,\n    qty_system,\n    qty_system_old,\n    receive_fund_limit,\n    total_add,\n    total_begin_day,\n    total_old,\n    \"type\",\n    request_branch_id,\n    note,\n    line,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.request_branch_detail\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__request_branch_detail"}, "model.dga_data_model.stg_bpm_vhkq__skewed_threshold": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.skewed_threshold"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__skewed_threshold"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__skewed_threshold", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select  id,\r\n    amount,\r\n    created_by,\r\n    currency,\r\n    is_deleted,\r\n    status,\r\n    updated_by,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'skewed_threshold') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__skewed_threshold.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__skewed_threshold.sql", "name": "stg_bpm_vhkq__skewed_threshold", "alias": "stg_bpm_vhkq__skewed_threshold", "checksum": {"name": "sha256", "checksum": "399b1b2c4009ce38bf2fc604421c3d1a6a15a987e32da61b1f855c1f6f05f135"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "skewed_threshold"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__skewed_threshold.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9219792, "compiled_code": "\nWITH source AS(\n select  id,\n    amount,\n    created_by,\n    currency,\n    is_deleted,\n    status,\n    updated_by,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.skewed_threshold\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__skewed_threshold"}, "model.dga_data_model.stg_bpm_vhkq__staff": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.staff"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__staff"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__staff", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    code,\r\n    email,\r\n    id_identity,\r\n    issued_by,\r\n    cast(issued_date as timestamp(3)) as issued_date,\r\n    name,\r\n    \"position\",\r\n    \"type\",\r\n    warehouse_code,\r\n    username,\r\n    atm_group_position,\r\n    branch_name,\r\n    concurrent_position,\r\n    created_by,\r\n    cast(decision_date as timestamp(3)) as decision_date,\r\n    decision_number,\r\n    cast(from_date as timestamp(3)) as from_date,\r\n    is_belong_branch,\r\n    license_plate_number,\r\n    manage_unit,\r\n    phone_number,\r\n    protection_rating,\r\n    staff_title,\r\n    status,\r\n    warehouse_name,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'staff') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__staff.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff.sql", "name": "stg_bpm_vhkq__staff", "alias": "stg_bpm_vhkq__staff", "checksum": {"name": "sha256", "checksum": "21f3359166bb46b67bfa9c0389c0f6e8af181401af9684fc383397650b59d55e"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "staff"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9239783, "compiled_code": "\nWITH source AS(\n select id,\n    code,\n    email,\n    id_identity,\n    issued_by,\n    cast(issued_date as timestamp(3)) as issued_date,\n    name,\n    \"position\",\n    \"type\",\n    warehouse_code,\n    username,\n    atm_group_position,\n    branch_name,\n    concurrent_position,\n    created_by,\n    cast(decision_date as timestamp(3)) as decision_date,\n    decision_number,\n    cast(from_date as timestamp(3)) as from_date,\n    is_belong_branch,\n    license_plate_number,\n    manage_unit,\n    phone_number,\n    protection_rating,\n    staff_title,\n    status,\n    warehouse_name,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.staff\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff"}, "model.dga_data_model.stg_bpm_vhkq__staff_assignment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.staff_assignment"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__staff_assignment"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__staff_assignment", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    assigner,\r\n    assigner_name,\r\n    created_by,\r\n    doc_code,\r\n    is_branch,\r\n    is_deleted,\r\n    last_comment,\r\n    organization_code,\r\n    organization_name,\r\n    status,\r\n    submitted_by,\r\n    \"type\",\r\n    cast(start_date_effect as timestamp(3)) as start_date_effect,\r\n    cast(end_date_effect as timestamp(3)) as end_date_effect,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at,\r\n    cast(submitted_at as timestamp(3)) as submitted_at\r\n  FROM {{ source('ms_kho_quy', 'staff_assignment') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__staff_assignment.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_assignment.sql", "name": "stg_bpm_vhkq__staff_assignment", "alias": "stg_bpm_vhkq__staff_assignment", "checksum": {"name": "sha256", "checksum": "a72d6a41d2e019cdcf182663099b0190065dd95bf841b56bbc0879881dcd0504"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "staff_assignment"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_assignment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9259849, "compiled_code": "\nWITH source AS(\n select id,\n    assigner,\n    assigner_name,\n    created_by,\n    doc_code,\n    is_branch,\n    is_deleted,\n    last_comment,\n    organization_code,\n    organization_name,\n    status,\n    submitted_by,\n    \"type\",\n    cast(start_date_effect as timestamp(3)) as start_date_effect,\n    cast(end_date_effect as timestamp(3)) as end_date_effect,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at,\n    cast(submitted_at as timestamp(3)) as submitted_at\n  FROM mysql_bpm_119.ms_kho_quy.staff_assignment\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_assignment"}, "model.dga_data_model.stg_bpm_vhkq__staff_request_atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.staff_request_atm"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__staff_request_atm"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__staff_request_atm", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    key_num,\r\n    request_atm_id,\r\n    staff_id,\r\n    id_identity,\r\n    is_deleted,\r\n    issued_by,\r\n    cast(issued_date as timestamp(3)) as issued_date,\r\n    name,\r\n    request_id,\r\n    request_type,\r\n    \"type\",\r\n    username,\r\n    staff,\r\n    \"group\",\r\n    is_belong_branch,\r\n    is_choose,\r\n    phone_number,\r\n    position_name,\r\n    staff_type,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'staff_request_atm') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__staff_request_atm.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_request_atm.sql", "name": "stg_bpm_vhkq__staff_request_atm", "alias": "stg_bpm_vhkq__staff_request_atm", "checksum": {"name": "sha256", "checksum": "ebee2790b6de591304ebd6ae253cd1c7767bf9696bc46500282796c08327db73"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "staff_request_atm"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_request_atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9279861, "compiled_code": "\nWITH source AS(\n select id,\n    key_num,\n    request_atm_id,\n    staff_id,\n    id_identity,\n    is_deleted,\n    issued_by,\n    cast(issued_date as timestamp(3)) as issued_date,\n    name,\n    request_id,\n    request_type,\n    \"type\",\n    username,\n    staff,\n    \"group\",\n    is_belong_branch,\n    is_choose,\n    phone_number,\n    position_name,\n    staff_type,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.staff_request_atm\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_request_atm"}, "model.dga_data_model.stg_bpm_vhkq__staff_request_branch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.staff_request_branch"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__staff_request_branch"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__staff_request_branch", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    is_deleted,\r\n    \"position\",\r\n    staff_name,\r\n    \"type\",\r\n    request_branch_id,\r\n    staff_id,\r\n    username,\r\n    position_id,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'staff_request_branch') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__staff_request_branch.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_request_branch.sql", "name": "stg_bpm_vhkq__staff_request_branch", "alias": "stg_bpm_vhkq__staff_request_branch", "checksum": {"name": "sha256", "checksum": "cb45480b9e020a1126d75a6793743ec3aa0f736ea8e27f6aa8c8c0ae0e5a89ae"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "staff_request_branch"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_request_branch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9299808, "compiled_code": "\nWITH source AS(\n select id,\n    is_deleted,\n    \"position\",\n    staff_name,\n    \"type\",\n    request_branch_id,\n    staff_id,\n    username,\n    position_id,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.staff_request_branch\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_request_branch"}, "model.dga_data_model.stg_bpm_vhkq__staff_transfer_history": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.staff_transfer_history"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__staff_transfer_history"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__staff_transfer_history", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    from_warehouse_code,\r\n    staff_code,\r\n    staff_name,\r\n    staff_type,\r\n    cast(to_date as timestamp(3)) as to_date,\r\n    to_warehouse_code,\r\n    staff,\r\n    cast(created_at as timestamp(3)) as created_at,\r\n    cast(updated_at as timestamp(3)) as updated_at\r\n  FROM {{ source('ms_kho_quy', 'staff_transfer_history') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__staff_transfer_history.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_transfer_history.sql", "name": "stg_bpm_vhkq__staff_transfer_history", "alias": "stg_bpm_vhkq__staff_transfer_history", "checksum": {"name": "sha256", "checksum": "74b07a9069bd1f07f4378be33b9d0965895ec60cdf87c515ea48c65b84698339"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "staff_transfer_history"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "updated_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__staff_transfer_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "updated_at"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9309783, "compiled_code": "\nWITH source AS(\n select id,\n    from_warehouse_code,\n    staff_code,\n    staff_name,\n    staff_type,\n    cast(to_date as timestamp(3)) as to_date,\n    to_warehouse_code,\n    staff,\n    cast(created_at as timestamp(3)) as created_at,\n    cast(updated_at as timestamp(3)) as updated_at\n  FROM mysql_bpm_119.ms_kho_quy.staff_transfer_history\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_transfer_history"}, "model.dga_data_model.stg_bpm_vhkq__template": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.template"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__template"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__template", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    code,\r\n    content,\r\n    description,\r\n    name\r\n  FROM {{ source('ms_kho_quy', 'template') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__template.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__template.sql", "name": "stg_bpm_vhkq__template", "alias": "stg_bpm_vhkq__template", "checksum": {"name": "sha256", "checksum": "9e36fa0d165195512ff2a97d2a68cfbd440da58ad12875e3d5d08ad447e3932b"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "template"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__template.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9329073, "compiled_code": "\nWITH source AS(\n select id,\n    code,\n    content,\n    description,\n    name\n  FROM mysql_bpm_119.ms_kho_quy.template\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__template"}, "model.dga_data_model.stg_bpm_vhkq__user_unit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.user_unit"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__user_unit"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__user_unit", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select\r\n    id,\r\n    unit_code,\r\n    user_name\r\n  FROM {{ source('ms_kho_quy', 'user_unit') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__user_unit.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__user_unit.sql", "name": "stg_bpm_vhkq__user_unit", "alias": "stg_bpm_vhkq__user_unit", "checksum": {"name": "sha256", "checksum": "693968adda9f3e27563aea35de879291c424a5a18761bfc6cfaade968ab0c835"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "user_unit"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__user_unit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.935984, "compiled_code": "\nWITH source AS(\n select\n    id,\n    unit_code,\n    user_name\n  FROM mysql_bpm_119.ms_kho_quy.user_unit\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__user_unit"}, "model.dga_data_model.stg_bpm_vhkq__volume": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.volume"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "execute_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__volume"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__volume", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    declaration_username,\r\n    status,\r\n    total_check_gold,\r\n    total_expenditure_nb_nt,\r\n    total_expenditure_nb_vnd,\r\n    total_package,\r\n    total_revenue_nhnn_vnd,\r\n    total_revenue_tctd_nt,\r\n    total_revenue_tctd_vnd,\r\n    total_support_check,\r\n    unit_code,\r\n    warehouse,\r\n    cast(declaration_date as timestamp(3)) as declaration_date,\r\n    cast(execute_date as timestamp(3)) as execute_date\r\n  FROM {{ source('ms_kho_quy', 'volume') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__volume.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__volume.sql", "name": "stg_bpm_vhkq__volume", "alias": "stg_bpm_vhkq__volume", "checksum": {"name": "sha256", "checksum": "faf180d838d815d2dc9e688232cc23e5e91ff7ece3936e773346fca69b371eac"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "volume"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "execute_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__volume.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "execute_date"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9379876, "compiled_code": "\nWITH source AS(\n select id,\n    declaration_username,\n    status,\n    total_check_gold,\n    total_expenditure_nb_nt,\n    total_expenditure_nb_vnd,\n    total_package,\n    total_revenue_nhnn_vnd,\n    total_revenue_tctd_nt,\n    total_revenue_tctd_vnd,\n    total_support_check,\n    unit_code,\n    warehouse,\n    cast(declaration_date as timestamp(3)) as declaration_date,\n    cast(execute_date as timestamp(3)) as execute_date\n  FROM mysql_bpm_119.ms_kho_quy.volume\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__volume"}, "model.dga_data_model.stg_bpm_vhkq__volume_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.volume_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "check_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__volume_detail"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__volume_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    check_gold,\r\n    code_staff,\r\n    expenditure_nb_nt,\r\n    expenditure_nb_vnd,\r\n    is_deleted,\r\n    name_staff,\r\n    revenue_nhnn_vnd,\r\n    revenue_tctd_nt,\r\n    revenue_tctd_vnd,\r\n    support_check,\r\n    total_package,\r\n    staff,\r\n    volume,\r\n    cast(check_date as timestamp(3)) as check_date\r\n  FROM {{ source('ms_kho_quy', 'volume_detail') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__volume_detail.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__volume_detail.sql", "name": "stg_bpm_vhkq__volume_detail", "alias": "stg_bpm_vhkq__volume_detail", "checksum": {"name": "sha256", "checksum": "ee97dc330763e2a8e01b4126d2f35f15b0b9a51c87aaedf2b8309387ae1382c0"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "volume_detail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "check_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__volume_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "check_date"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9399917, "compiled_code": "\nWITH source AS(\n select id,\n    check_gold,\n    code_staff,\n    expenditure_nb_nt,\n    expenditure_nb_vnd,\n    is_deleted,\n    name_staff,\n    revenue_nhnn_vnd,\n    revenue_tctd_nt,\n    revenue_tctd_vnd,\n    support_check,\n    total_package,\n    staff,\n    volume,\n    cast(check_date as timestamp(3)) as check_date\n  FROM mysql_bpm_119.ms_kho_quy.volume_detail\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__volume_detail"}, "model.dga_data_model.stg_bpm_vhkq__warehouse": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.warehouse"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__warehouse"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__warehouse", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    active_status,\r\n    address,\r\n    code,\r\n    name,\r\n    phone,\r\n    short_name,\r\n    ban_phim_kich_hoat,\r\n    bao_chay_tu_dong,\r\n    binh_cau_cc,\r\n    binh_cc,\r\n    cam_bien_chuyen_dong,\r\n    cam_bien_hong_ngoai,\r\n    cam_bien_ngap,\r\n    cam_bien_rung,\r\n    city,\r\n    \"domain\",\r\n    dt_gian_dem,\r\n    dt_kho_tien,\r\n    hm_nt_usd,\r\n    hm_ton_usd,\r\n    hm_ton_vnd,\r\n    hm_vc_hdb,\r\n    ht_hut_am,\r\n    ht_thong_gio,\r\n    key_box_send_place,\r\n    locality,\r\n    number_branch,\r\n    number_camera,\r\n    number_driver,\r\n    number_guard,\r\n    number_keys_backup,\r\n    number_line,\r\n    number_staff,\r\n    number_vehicle,\r\n    nut_sos,\r\n    truc_thuoc_cn,\r\n    cast(start_date as timestamp(3)) as start_date,\r\n    cast(end_date as timestamp(3)) as end_date\r\n  FROM {{ source('ms_kho_quy', 'warehouse') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse.sql", "name": "stg_bpm_vhkq__warehouse", "alias": "stg_bpm_vhkq__warehouse", "checksum": {"name": "sha256", "checksum": "802bac68c285f5d61f6d43cdc90275a3f4ea2d7341f62bdeceea3c11e23b3eab"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "warehouse"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9409907, "compiled_code": "\nWITH source AS(\n select id,\n    active_status,\n    address,\n    code,\n    name,\n    phone,\n    short_name,\n    ban_phim_kich_hoat,\n    bao_chay_tu_dong,\n    binh_cau_cc,\n    binh_cc,\n    cam_bien_chuyen_dong,\n    cam_bien_hong_ngoai,\n    cam_bien_ngap,\n    cam_bien_rung,\n    city,\n    \"domain\",\n    dt_gian_dem,\n    dt_kho_tien,\n    hm_nt_usd,\n    hm_ton_usd,\n    hm_ton_vnd,\n    hm_vc_hdb,\n    ht_hut_am,\n    ht_thong_gio,\n    key_box_send_place,\n    locality,\n    number_branch,\n    number_camera,\n    number_driver,\n    number_guard,\n    number_keys_backup,\n    number_line,\n    number_staff,\n    number_vehicle,\n    nut_sos,\n    truc_thuoc_cn,\n    cast(start_date as timestamp(3)) as start_date,\n    cast(end_date as timestamp(3)) as end_date\n  FROM mysql_bpm_119.ms_kho_quy.warehouse\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__warehouse"}, "model.dga_data_model.stg_bpm_vhkq__warehouse_organization": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.warehouse_organization"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__warehouse_organization"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__warehouse_organization", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    fund_begin_day_usd,\r\n    fund_begin_day_vnd,\r\n    line,\r\n    organization_code,\r\n    organization_name,\r\n    warehouse_code,\r\n    distance_organization_to_warehouse,\r\n    status,\r\n    truc_thuoc_cn_pgd,\r\n    warehouse_type,\r\n    warehouse\r\n  FROM {{ source('ms_kho_quy', 'warehouse_organization') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse_organization.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse_organization.sql", "name": "stg_bpm_vhkq__warehouse_organization", "alias": "stg_bpm_vhkq__warehouse_organization", "checksum": {"name": "sha256", "checksum": "db22a5a73dc8039f37e925083eae628697a03797ada59ce018517cc10272f014"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "warehouse_organization"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse_organization.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9429815, "compiled_code": "\nWITH source AS(\n select id,\n    fund_begin_day_usd,\n    fund_begin_day_vnd,\n    line,\n    organization_code,\n    organization_name,\n    warehouse_code,\n    distance_organization_to_warehouse,\n    status,\n    truc_thuoc_cn_pgd,\n    warehouse_type,\n    warehouse\n  FROM mysql_bpm_119.ms_kho_quy.warehouse_organization\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__warehouse_organization"}, "model.dga_data_model.stg_bpm_vhkq__warehouse_user": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.ms_kho_quy.warehouse_user"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "stg_bpm_vhkq__warehouse_user"], "unique_id": "model.dga_data_model.stg_bpm_vhkq__warehouse_user", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n select id,\r\n    full_name,\r\n    \"type\",\r\n    unit_code,\r\n    unit_name,\r\n    username\r\n  FROM {{ source('ms_kho_quy', 'warehouse_user') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse_user.sql", "original_file_path": "models\\staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse_user.sql", "name": "stg_bpm_vhkq__warehouse_user", "alias": "stg_bpm_vhkq__warehouse_user", "checksum": {"name": "sha256", "checksum": "739893dae7bbdd560694fea325ae64652166ea84978d7896bea4a12eaeb11a93"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["ms_kho_quy", "warehouse_user"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\stg_bpm_vhkq__warehouse_user.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959752.9439778, "compiled_code": "\nWITH source AS(\n select id,\n    full_name,\n    \"type\",\n    unit_code,\n    unit_name,\n    username\n  FROM mysql_bpm_119.ms_kho_quy.warehouse_user\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__warehouse_user"}, "model.dga_data_model.stg_atm__cashout_sum": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fact__atm_daily"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_atm__cashout_sum"], "unique_id": "model.dga_data_model.stg_atm__cashout_sum", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nSELECT\r\n    report_date,\r\n    atm_dim_id,\r\n    atm_code,\r\n    SUM(transaction_amount) transaction_amount,\r\n    MIN(transaction_amount) min_transaction_amount,\r\n    MAX(transaction_amount) max_transaction_amount\r\nFROM\r\n    {{ ref ('fact__atm_daily')}}\r\nWHERE\r\n    1=1\r\n    AND report_date >= sysdate - 90\r\n    AND process_detail = 'Cash_out_from_customer'\r\n    AND transaction_error IS NULL\r\nGROUP BY\r\n    report_date,\r\n    atm_dim_id,\r\n    atm_code", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_atm__cashout_sum.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_atm__cashout_sum.sql", "name": "stg_atm__cashout_sum", "alias": "stg_atm__cashout_sum", "checksum": {"name": "sha256", "checksum": "c59ad2ce5a9b95bb78e0f84037e62cabebd1f70106adb7a61bad83039b82d431"}, "tags": ["vhkq_atm_daily"], "refs": [["fact__atm_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_atm__cashout_sum.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "table"}, "created_at": 1685959752.973297, "compiled_code": "\nSELECT\n    report_date,\n    atm_dim_id,\n    atm_code,\n    SUM(transaction_amount) transaction_amount,\n    MIN(transaction_amount) min_transaction_amount,\n    MAX(transaction_amount) max_transaction_amount\nFROM\n    \"oracle_dgaworkzone\".mart.fact__atm_daily\nWHERE\n    1=1\n    AND report_date >= sysdate - 90\n    AND process_detail = 'Cash_out_from_customer'\n    AND transaction_error IS NULL\nGROUP BY\n    report_date,\n    atm_dim_id,\n    atm_code", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_atm__cashout_sum"}, "model.dga_data_model.stg_atm__update_chu_ky": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fact__atm_daily"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_atm__update_chu_ky"], "unique_id": "model.dga_data_model.stg_atm__update_chu_ky", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat_tiepquy AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        {{ ref ('fact__atm_daily')}}  t\r\n    WHERE\r\n        chu_ky_thuc_te > 0\r\n), dat_chuky AS (\r\n    SELECT\r\n        report_date,\r\n        transaction_date_time,\r\n        working_time,\r\n        atm_dim_id,\r\n        transaction_id,\r\n        process_detail,\r\n        reason_operate,\r\n        atm_code,\r\n        tuyen_atm_id,\r\n        transaction_amount,\r\n        LAG(transaction_id, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )               AS transaction_id_prev,\r\n        LAG(report_date, 1, NULL)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )               AS cash_in_date_prev,\r\n        LAG(transaction_amount, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )               AS cash_in_amount_prev,\r\n        report_date - LAG(report_date, 1, NULL)\r\n                      OVER(PARTITION BY atm_code\r\n                           ORDER BY\r\n                               report_date, transaction_id\r\n        )               AS chu_ky_prev,\r\n        LEAD(transaction_id, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )               AS transaction_id_next,\r\n        LEAD(report_date, 1, NULL)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )               AS cash_in_date_next,\r\n        LEAD(transaction_amount, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )               AS cash_in_amount_next,\r\n        LEAD(report_date, 1, NULL)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        ) - report_date AS chu_ky_next,\r\n        RANK()\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date DESC\r\n        )               rnk\r\n    FROM\r\n        dat_tiepquy t\r\n)\r\nSELECT\r\n    dat_chuky.*,\r\n    CASE\r\n        WHEN rnk = 1 THEN\r\n            TO_DATE(29990101, 'yyyymmdd')\r\n        ELSE\r\n            cash_in_date_next\r\n    END cash_in_date_next_upd,\r\n    CASE\r\n        WHEN rnk = 1 THEN\r\n            1\r\n        ELSE\r\n            0\r\n    END last_cash_in\r\nFROM\r\n    dat_chuky\r\nWHERE report_date >= sysdate - 60", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_atm__update_chu_ky.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_atm__update_chu_ky.sql", "name": "stg_atm__update_chu_ky", "alias": "stg_atm__update_chu_ky", "checksum": {"name": "sha256", "checksum": "f96619ac4aa1cb2aae6f23e5c6b4e33ccaaa99138c12e288ac97d43b2f86d57c"}, "tags": ["vhkq_atm_daily"], "refs": [["fact__atm_daily"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_atm__update_chu_ky.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "table"}, "created_at": 1685959752.9713094, "compiled_code": "\nWITH dat_tiepquy AS (\n    SELECT\n        *\n    FROM\n        \"oracle_dgaworkzone\".mart.fact__atm_daily  t\n    WHERE\n        chu_ky_thuc_te > 0\n), dat_chuky AS (\n    SELECT\n        report_date,\n        transaction_date_time,\n        working_time,\n        atm_dim_id,\n        transaction_id,\n        process_detail,\n        reason_operate,\n        atm_code,\n        tuyen_atm_id,\n        transaction_amount,\n        LAG(transaction_id, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )               AS transaction_id_prev,\n        LAG(report_date, 1, NULL)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )               AS cash_in_date_prev,\n        LAG(transaction_amount, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )               AS cash_in_amount_prev,\n        report_date - LAG(report_date, 1, NULL)\n                      OVER(PARTITION BY atm_code\n                           ORDER BY\n                               report_date, transaction_id\n        )               AS chu_ky_prev,\n        LEAD(transaction_id, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )               AS transaction_id_next,\n        LEAD(report_date, 1, NULL)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )               AS cash_in_date_next,\n        LEAD(transaction_amount, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )               AS cash_in_amount_next,\n        LEAD(report_date, 1, NULL)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        ) - report_date AS chu_ky_next,\n        RANK()\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date DESC\n        )               rnk\n    FROM\n        dat_tiepquy t\n)\nSELECT\n    dat_chuky.*,\n    CASE\n        WHEN rnk = 1 THEN\n            TO_DATE(29990101, 'yyyymmdd')\n        ELSE\n            cash_in_date_next\n    END cash_in_date_next_upd,\n    CASE\n        WHEN rnk = 1 THEN\n            1\n        ELSE\n            0\n    END last_cash_in\nFROM\n    dat_chuky\nWHERE report_date >= sysdate - 60", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_atm__update_chu_ky"}, "model.dga_data_model.stg_mart_vhkq__atm": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vhkq_atm_daily_az_base.imp_bpm_vhkq__atm", "model.dga_data_model.stg_bpm_vhkq__atm", "model.dga_data_model.bpm_vhkq__warehouse", "model.dga_data_model.bpm_vhkq__warehouse_organization", "model.dga_data_model.bpm_vhkq__warehouse"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_mart_vhkq__atm"], "unique_id": "model.dga_data_model.stg_mart_vhkq__atm", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n    )\r\n}}\r\nWITH dat AS (\r\n    SELECT\r\n        t1.code                            as atm_code,\r\n        t1.series_number,\r\n        t1.number_cycle_fund,\r\n        t1.address,\r\n        t1.\"GROUP\"                         as group_atm,\r\n        t1.status,\r\n        t1.optimal_fund_limit,\r\n        t1.regulation_fund_limit,\r\n        nvl(t3.name, t4.organization_name) as donvi_quanly,\r\n        nvl(t3.code, t4.warehouse_code)    as kq_code,\r\n        t2.distance_to_hub,\r\n        t2.location_type,\r\n        nvl(t3.city, t5.city)              as tinh_thanh,\r\n        nvl(t3.locality, t5.locality)      as locality,\r\n        t2.salary_date,\r\n        t2.unit_manage                     as unit_manage_info\r\n    FROM\r\n        {{ ref ('stg_bpm_vhkq__atm') }}                                         t1\r\n        LEFT JOIN {{ source ('vhkq_atm_daily_az_base', 'imp_bpm_vhkq__atm') }}  t2 ON t1.code = t2.atm_code\r\n        LEFT JOIN {{ ref ('bpm_vhkq__warehouse') }}                             t3 ON t1.warehouse = t3.id\r\n        LEFT JOIN {{ ref ('bpm_vhkq__warehouse_organization') }}                t4 ON t1.warehouse_organization = t4.id\r\n        LEFT JOIN {{ ref ('bpm_vhkq__warehouse') }}                             t5 ON t4.warehouse = t5.id\r\n)\r\nSELECT\r\n    *\r\nFROM\r\n    dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm.sql", "name": "stg_mart_vhkq__atm", "alias": "stg_mart_vhkq__atm", "checksum": {"name": "sha256", "checksum": "e961ab1326e9454eba5d74fe1ee232a1da10503b94f9b8cdfd4deecac94785d2"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_bpm_vhkq__atm"], ["bpm_vhkq__warehouse"], ["bpm_vhkq__warehouse_organization"], ["bpm_vhkq__warehouse"]], "sources": [["vhkq_atm_daily_az_base", "imp_bpm_vhkq__atm"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "table"}, "created_at": 1685959752.9559796, "compiled_code": "\nWITH dat AS (\n    SELECT\n        t1.code                            as atm_code,\n        t1.series_number,\n        t1.number_cycle_fund,\n        t1.address,\n        t1.\"GROUP\"                         as group_atm,\n        t1.status,\n        t1.optimal_fund_limit,\n        t1.regulation_fund_limit,\n        nvl(t3.name, t4.organization_name) as donvi_quanly,\n        nvl(t3.code, t4.warehouse_code)    as kq_code,\n        t2.distance_to_hub,\n        t2.location_type,\n        nvl(t3.city, t5.city)              as tinh_thanh,\n        nvl(t3.locality, t5.locality)      as locality,\n        t2.salary_date,\n        t2.unit_manage                     as unit_manage_info\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__atm                                         t1\n        LEFT JOIN oracle_dgaworkzone.base.imp_bpm_vhkq__atm  t2 ON t1.code = t2.atm_code\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__warehouse                             t3 ON t1.warehouse = t3.id\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__warehouse_organization                t4 ON t1.warehouse_organization = t4.id\n        LEFT JOIN \"oracle_dgaworkzone\".base.bpm_vhkq__warehouse                             t5 ON t4.warehouse = t5.id\n)\nSELECT\n    *\nFROM\n    dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm"}, "model.dga_data_model.stg_mart_vhkq__atm_cash_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.bpm_vhkq__atm_module"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_mart_vhkq__atm_cash_daily"], "unique_id": "model.dga_data_model.stg_mart_vhkq__atm_cash_daily", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat_atm AS (\r\n    SELECT DISTINCT\r\n        atm_request_id,\r\n        process_type,\r\n        process_name,\r\n        process_detail,\r\n        CASE WHEN reason_operate = 'REQUEST_CHECK'\r\n            THEN 'Y\u00caU C\u1ea6U TRA SO\u00c1T'\r\n            WHEN reason_operate = 'FIX'\r\n            THEN 'S\u1eecA CH\u1eeeA ATM'\r\n            ELSE reason_operate\r\n        END reason_operate,\r\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND tq_is_success = 0\r\n                AND kq_is_success = 1\r\n            THEN 'Ki\u1ec3m qu\u1ef9'\r\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n                AND tq_is_success = 1\r\n            THEN 'Ti\u1ebfp qu\u1ef9'\r\n             WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n                AND tq_is_success = 0\r\n            THEN NULL\r\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\r\n                AND tq_is_success = 0\r\n            THEN NULL\r\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n            THEN NULL\r\n        ELSE process_detail\r\n        END                                         AS process_detail_update,\r\n        trunc(execute_date)                         AS execute_date,\r\n        execute_date                                AS transaction_date_time,\r\n        process_status_name,\r\n        atm_code,\r\n        atm_group,\r\n        ttc_hour_from,\r\n        ttc_hour_to,\r\n        number_of_min_transfrom,\r\n        ttc_num_km_from,\r\n        ttc_num_km_to,\r\n        number_of_km,\r\n         CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND tq_is_success = 0\r\n            THEN 0\r\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\r\n                AND tq_is_success = 0\r\n            THEN 0\r\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\r\n            THEN 0\r\n        ELSE total_fund\r\n        END                                          AS total_fund,\r\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n            THEN 0\r\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n            THEN 0\r\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\r\n            THEN 0\r\n        ELSE total_fund_recovery\r\n        END                                          AS total_fund_recovery,\r\n        so_tien,\r\n        so_bo_tien,\r\n        request_atm_ref,\r\n        kq_is_success,\r\n        tq_is_success,\r\n        kq_note,\r\n        tq_note,\r\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND tq_is_success = 0\r\n            THEN 1\r\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n            THEN 1\r\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\r\n                AND tq_is_success = 0\r\n            THEN 1\r\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n            THEN 1\r\n        ELSE NULL\r\n        END                                         AS transaction_error,\r\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND tq_is_success = 0\r\n                AND kq_is_success = 1\r\n            THEN 'Ki\u1ec3m qu\u1ef9 th\u00e0nh c\u00f4ng, l\u1ed7i ti\u1ebfp qu\u1ef9'\r\n\r\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n                AND tq_is_success = 1\r\n            THEN 'Ti\u1ebfp qu\u1ef9 th\u00e0nh c\u00f4ng, l\u1ed7i ki\u1ec3m qu\u1ef9'\r\n\r\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n                AND tq_is_success = 0\r\n            THEN 'L\u1ed7i ti\u1ebfp, ki\u1ec3m qu\u1ef9'\r\n\r\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\r\n                AND tq_is_success = 0\r\n            THEN 'L\u1ed7i ti\u1ebfp qu\u1ef9'\r\n\r\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\r\n                AND kq_is_success = 0\r\n            THEN 'L\u1ed7i ki\u1ec3m qu\u1ef9'\r\n        ELSE NULL\r\n        END                                         AS transaction_error_group,\r\n        CASE WHEN tq_is_success = 0\r\n            THEN tq_note\r\n            WHEN kq_is_success = 0\r\n                AND tq_is_success = 0\r\n            THEN tq_note\r\n            WHEN kq_is_success = 0\r\n            THEN kq_note\r\n        END                                         AS transaction_error_detail\r\n    FROM\r\n        {{ ref ('bpm_vhkq__atm_module')}}\r\n    WHERE\r\n            process_type = 'Ti\u1ebfp - ki\u1ec3m ATM'\r\n        AND process_status_name = 'Ho\u00e0n th\u00e0nh'\r\n)\r\n,dat_error_detail as (\r\n    SELECT atm_request_id,\r\n        transaction_error,\r\n        transaction_error_group,\r\n        transaction_error_detail transaction_error_detail_lv2,\r\n        CASE WHEN  upper(transaction_error_detail)  LIKE '%\u0110\u01af\u1edcNG TRUY\u1ec0N%'\r\n                OR upper(transaction_error_detail)  LIKE '%M\u1ea4T M\u1ea0NG%'\r\n                OR upper(transaction_error_detail)  LIKE '%K\u1ebeT N\u1ed0I%'\r\n                OR upper(transaction_error_detail)  LIKE '%L\u1ed6I M\u1ea0NG%'\r\n                OR upper(transaction_error_detail)  LIKE '%INTERNET%' THEN 'L\u1ed7i \u0111\u01b0\u1eddng truy\u1ec1n'\r\n\r\n            WHEN  upper(transaction_error_detail)  LIKE '%\u0110I\u1ec6N%' THEN 'L\u1ed7i do ngu\u1ed3n \u0111i\u1ec7n'\r\n\r\n            WHEN  upper(transaction_error_detail)  LIKE '%KHAY%'\r\n               OR upper(transaction_error_detail)  LIKE '%H\u1ed8C%'\r\n               OR upper(transaction_error_detail)  LIKE '%B\u1ed8 PH\u1eacN TR\u1ea2 TI\u1ec0N%' THEN 'L\u1ed7i khay \u0111\u1ef1ng ti\u1ec1n'\r\n\r\n            WHEN  upper(transaction_error_detail)  LIKE '%L\u1eacP K\u1ebe HO\u1ea0CH%' THEN 'L\u1eadp k\u1ebf ho\u1ea1ch sai'\r\n\r\n            WHEN  upper(transaction_error_detail)  LIKE '%L\u1ec6NH%' THEN 'L\u1eadp sai l\u1ec7nh'\r\n\r\n            WHEN  upper(transaction_error_detail)  LIKE '%ATM H\u1eceNG%'\r\n               OR upper(transaction_error_detail)  LIKE '%C\u00c2Y L\u1ed6I%'\r\n               OR upper(transaction_error_detail)  LIKE '%L\u1ed6I%CPU%'\r\n               OR upper(transaction_error_detail)  LIKE '%ATM L\u1ed6I%'\r\n               OR upper(transaction_error_detail)  LIKE '%ATM LOI%' THEN 'ATM h\u1ecfng'\r\n\r\n            ELSE 'Kh\u00e1c'\r\n        END AS transaction_error_detail_lv1\r\n    FROM\r\n        dat_atm\r\n    WHERE transaction_error = 1\r\n)\r\n, dat_atm_cash AS (\r\n    SELECT DISTINCT\r\n        t1.execute_date                                                         AS report_date,\r\n        t1.transaction_date_time,\r\n        t1.atm_request_id                                                       AS transaction_id,\r\n        t1.process_detail,\r\n        t1.reason_operate,\r\n        t1.atm_code,\r\n        t1.request_atm_ref                                                      AS tuyen_atm_id,\r\n        t1.total_fund                                                           AS transaction_amount,\r\n        t1.total_fund_recovery                                                  AS total_fund_recovery,\r\n        t1.so_bo_tien,\r\n        t1.number_of_min_transfrom,\r\n        t1.ttc_num_km_from,\r\n        t1.ttc_num_km_to,\r\n        t1.number_of_km                                                         AS number_of_km_actual,\r\n        round(\r\n            CASE\r\n                WHEN number_of_km < 210     THEN\r\n                    t1.number_of_km\r\n                WHEN t1.number_of_km >= 210 THEN\r\n                    t4.distance_to_hub\r\n            END, 2)                                                             AS number_km_update,\r\n        t1.kq_is_success,\r\n        t1.tq_is_success,\r\n        t1.kq_note,\r\n        t1.tq_note,\r\n        t1.process_detail_update,\r\n        t5.transaction_error,\r\n        t6.transaction_error_dim_id,\r\n        t5.transaction_error_detail_lv2,\r\n        t5.transaction_error_detail_lv1\r\n    FROM\r\n        dat_atm       t1\r\n        LEFT JOIN mart.dim__atm t4                      ON t1.atm_code = t4.atm_code\r\n                                                            AND t1.execute_date >= t4.eff_from_date\r\n                                                            AND t1.execute_date < t4.eff_to_date\r\n        LEFT JOIN dat_error_detail t5                   ON t1.atm_request_id = t5.atm_request_id\r\n        LEFT JOIN mart.dim__vhkq_transaction_error t6   ON t5.transaction_error_detail_lv1 = t6.error_desc_vn\r\n                                                            AND t5.transaction_error_group = t6.error_group_desc_vn\r\n)\r\n, dat_cash_in_rank AS (\r\n    SELECT\r\n        t.*,\r\n        LAG(transaction_id, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )                                       AS cash_in_transaction_id_prev,\r\n        LAG(report_date, 1, NULL)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )                                       AS cash_in_date_prev,\r\n        LAG(transaction_amount, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )                                       AS cash_in_amount_prev\r\n    FROM\r\n        dat_atm_cash t\r\n    WHERE\r\n        process_detail_update IN ( 'Ti\u1ebfp qu\u1ef9', 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9' )\r\n), dat_cash_out_rank AS (\r\n    SELECT\r\n        t.*,\r\n        LAG(transaction_id, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )                                           AS cash_out_transaction_id_prev,\r\n        LAG(report_date, 1, NULL)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )                                           AS cash_out_date_prev,\r\n        LAG(total_fund_recovery, 1, 0)\r\n        OVER(PARTITION BY atm_code\r\n             ORDER BY\r\n                 report_date, transaction_id\r\n        )                                           AS cash_out_amount_prev\r\n    FROM\r\n        dat_atm_cash t\r\n    WHERE\r\n        process_detail_update IN ( 'Ti\u1ebfp qu\u1ef9', 'Ki\u1ec3m qu\u1ef9' )\r\n)\r\nSELECT\r\n    t1.*,\r\n    nvl(t3.cash_out_amount_prev, t1.total_fund_recovery) total_fund_recovery_upd,\r\n    t2.cash_in_transaction_id_prev,\r\n    t2.cash_in_date_prev,\r\n    t2.cash_in_amount_prev\r\nFROM\r\n    dat_atm_cash      t1\r\n    LEFT JOIN dat_cash_in_rank  t2 ON t1.report_date = t2.report_date\r\n                                     AND t1.transaction_id = t2.transaction_id\r\n                                     AND t1.atm_code = t2.atm_code\r\n    LEFT JOIN dat_cash_out_rank t3 ON t1.report_date = t3.report_date\r\n                                      AND t1.transaction_id = t3.transaction_id\r\n                                      AND t1.atm_code = t3.atm_code\r\nWHERE 1=1\r\n    AND t1.report_date >= sysdate - 30\r\nORDER BY\r\n    t1.atm_code,\r\n    t1.report_date", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_daily.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_daily.sql", "name": "stg_mart_vhkq__atm_cash_daily", "alias": "stg_mart_vhkq__atm_cash_daily", "checksum": {"name": "sha256", "checksum": "7423e8337eee1d716e65a9132b0fe175b252a8ea43994283bdd7cb47af40d1b8"}, "tags": ["vhkq_atm_daily"], "refs": [["bpm_vhkq__atm_module"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "table"}, "created_at": 1685959752.9569778, "compiled_code": "\nWITH dat_atm AS (\n    SELECT DISTINCT\n        atm_request_id,\n        process_type,\n        process_name,\n        process_detail,\n        CASE WHEN reason_operate = 'REQUEST_CHECK'\n            THEN 'Y\u00caU C\u1ea6U TRA SO\u00c1T'\n            WHEN reason_operate = 'FIX'\n            THEN 'S\u1eecA CH\u1eeeA ATM'\n            ELSE reason_operate\n        END reason_operate,\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND tq_is_success = 0\n                AND kq_is_success = 1\n            THEN 'Ki\u1ec3m qu\u1ef9'\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n                AND tq_is_success = 1\n            THEN 'Ti\u1ebfp qu\u1ef9'\n             WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n                AND tq_is_success = 0\n            THEN NULL\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\n                AND tq_is_success = 0\n            THEN NULL\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n            THEN NULL\n        ELSE process_detail\n        END                                         AS process_detail_update,\n        trunc(execute_date)                         AS execute_date,\n        execute_date                                AS transaction_date_time,\n        process_status_name,\n        atm_code,\n        atm_group,\n        ttc_hour_from,\n        ttc_hour_to,\n        number_of_min_transfrom,\n        ttc_num_km_from,\n        ttc_num_km_to,\n        number_of_km,\n         CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND tq_is_success = 0\n            THEN 0\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\n                AND tq_is_success = 0\n            THEN 0\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\n            THEN 0\n        ELSE total_fund\n        END                                          AS total_fund,\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n            THEN 0\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n            THEN 0\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\n            THEN 0\n        ELSE total_fund_recovery\n        END                                          AS total_fund_recovery,\n        so_tien,\n        so_bo_tien,\n        request_atm_ref,\n        kq_is_success,\n        tq_is_success,\n        kq_note,\n        tq_note,\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND tq_is_success = 0\n            THEN 1\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n            THEN 1\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\n                AND tq_is_success = 0\n            THEN 1\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n            THEN 1\n        ELSE NULL\n        END                                         AS transaction_error,\n        CASE WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND tq_is_success = 0\n                AND kq_is_success = 1\n            THEN 'Ki\u1ec3m qu\u1ef9 th\u00e0nh c\u00f4ng, l\u1ed7i ti\u1ebfp qu\u1ef9'\n\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n                AND tq_is_success = 1\n            THEN 'Ti\u1ebfp qu\u1ef9 th\u00e0nh c\u00f4ng, l\u1ed7i ki\u1ec3m qu\u1ef9'\n\n            WHEN process_detail = 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n                AND tq_is_success = 0\n            THEN 'L\u1ed7i ti\u1ebfp, ki\u1ec3m qu\u1ef9'\n\n            WHEN process_detail = 'Ti\u1ebfp qu\u1ef9'\n                AND tq_is_success = 0\n            THEN 'L\u1ed7i ti\u1ebfp qu\u1ef9'\n\n            WHEN process_detail = 'Ki\u1ec3m qu\u1ef9'\n                AND kq_is_success = 0\n            THEN 'L\u1ed7i ki\u1ec3m qu\u1ef9'\n        ELSE NULL\n        END                                         AS transaction_error_group,\n        CASE WHEN tq_is_success = 0\n            THEN tq_note\n            WHEN kq_is_success = 0\n                AND tq_is_success = 0\n            THEN tq_note\n            WHEN kq_is_success = 0\n            THEN kq_note\n        END                                         AS transaction_error_detail\n    FROM\n        \"oracle_dgaworkzone\".int.bpm_vhkq__atm_module\n    WHERE\n            process_type = 'Ti\u1ebfp - ki\u1ec3m ATM'\n        AND process_status_name = 'Ho\u00e0n th\u00e0nh'\n)\n,dat_error_detail as (\n    SELECT atm_request_id,\n        transaction_error,\n        transaction_error_group,\n        transaction_error_detail transaction_error_detail_lv2,\n        CASE WHEN  upper(transaction_error_detail)  LIKE '%\u0110\u01af\u1edcNG TRUY\u1ec0N%'\n                OR upper(transaction_error_detail)  LIKE '%M\u1ea4T M\u1ea0NG%'\n                OR upper(transaction_error_detail)  LIKE '%K\u1ebeT N\u1ed0I%'\n                OR upper(transaction_error_detail)  LIKE '%L\u1ed6I M\u1ea0NG%'\n                OR upper(transaction_error_detail)  LIKE '%INTERNET%' THEN 'L\u1ed7i \u0111\u01b0\u1eddng truy\u1ec1n'\n\n            WHEN  upper(transaction_error_detail)  LIKE '%\u0110I\u1ec6N%' THEN 'L\u1ed7i do ngu\u1ed3n \u0111i\u1ec7n'\n\n            WHEN  upper(transaction_error_detail)  LIKE '%KHAY%'\n               OR upper(transaction_error_detail)  LIKE '%H\u1ed8C%'\n               OR upper(transaction_error_detail)  LIKE '%B\u1ed8 PH\u1eacN TR\u1ea2 TI\u1ec0N%' THEN 'L\u1ed7i khay \u0111\u1ef1ng ti\u1ec1n'\n\n            WHEN  upper(transaction_error_detail)  LIKE '%L\u1eacP K\u1ebe HO\u1ea0CH%' THEN 'L\u1eadp k\u1ebf ho\u1ea1ch sai'\n\n            WHEN  upper(transaction_error_detail)  LIKE '%L\u1ec6NH%' THEN 'L\u1eadp sai l\u1ec7nh'\n\n            WHEN  upper(transaction_error_detail)  LIKE '%ATM H\u1eceNG%'\n               OR upper(transaction_error_detail)  LIKE '%C\u00c2Y L\u1ed6I%'\n               OR upper(transaction_error_detail)  LIKE '%L\u1ed6I%CPU%'\n               OR upper(transaction_error_detail)  LIKE '%ATM L\u1ed6I%'\n               OR upper(transaction_error_detail)  LIKE '%ATM LOI%' THEN 'ATM h\u1ecfng'\n\n            ELSE 'Kh\u00e1c'\n        END AS transaction_error_detail_lv1\n    FROM\n        dat_atm\n    WHERE transaction_error = 1\n)\n, dat_atm_cash AS (\n    SELECT DISTINCT\n        t1.execute_date                                                         AS report_date,\n        t1.transaction_date_time,\n        t1.atm_request_id                                                       AS transaction_id,\n        t1.process_detail,\n        t1.reason_operate,\n        t1.atm_code,\n        t1.request_atm_ref                                                      AS tuyen_atm_id,\n        t1.total_fund                                                           AS transaction_amount,\n        t1.total_fund_recovery                                                  AS total_fund_recovery,\n        t1.so_bo_tien,\n        t1.number_of_min_transfrom,\n        t1.ttc_num_km_from,\n        t1.ttc_num_km_to,\n        t1.number_of_km                                                         AS number_of_km_actual,\n        round(\n            CASE\n                WHEN number_of_km < 210     THEN\n                    t1.number_of_km\n                WHEN t1.number_of_km >= 210 THEN\n                    t4.distance_to_hub\n            END, 2)                                                             AS number_km_update,\n        t1.kq_is_success,\n        t1.tq_is_success,\n        t1.kq_note,\n        t1.tq_note,\n        t1.process_detail_update,\n        t5.transaction_error,\n        t6.transaction_error_dim_id,\n        t5.transaction_error_detail_lv2,\n        t5.transaction_error_detail_lv1\n    FROM\n        dat_atm       t1\n        LEFT JOIN mart.dim__atm t4                      ON t1.atm_code = t4.atm_code\n                                                            AND t1.execute_date >= t4.eff_from_date\n                                                            AND t1.execute_date < t4.eff_to_date\n        LEFT JOIN dat_error_detail t5                   ON t1.atm_request_id = t5.atm_request_id\n        LEFT JOIN mart.dim__vhkq_transaction_error t6   ON t5.transaction_error_detail_lv1 = t6.error_desc_vn\n                                                            AND t5.transaction_error_group = t6.error_group_desc_vn\n)\n, dat_cash_in_rank AS (\n    SELECT\n        t.*,\n        LAG(transaction_id, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )                                       AS cash_in_transaction_id_prev,\n        LAG(report_date, 1, NULL)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )                                       AS cash_in_date_prev,\n        LAG(transaction_amount, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )                                       AS cash_in_amount_prev\n    FROM\n        dat_atm_cash t\n    WHERE\n        process_detail_update IN ( 'Ti\u1ebfp qu\u1ef9', 'Ti\u1ebfp, ki\u1ec3m qu\u1ef9' )\n), dat_cash_out_rank AS (\n    SELECT\n        t.*,\n        LAG(transaction_id, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )                                           AS cash_out_transaction_id_prev,\n        LAG(report_date, 1, NULL)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )                                           AS cash_out_date_prev,\n        LAG(total_fund_recovery, 1, 0)\n        OVER(PARTITION BY atm_code\n             ORDER BY\n                 report_date, transaction_id\n        )                                           AS cash_out_amount_prev\n    FROM\n        dat_atm_cash t\n    WHERE\n        process_detail_update IN ( 'Ti\u1ebfp qu\u1ef9', 'Ki\u1ec3m qu\u1ef9' )\n)\nSELECT\n    t1.*,\n    nvl(t3.cash_out_amount_prev, t1.total_fund_recovery) total_fund_recovery_upd,\n    t2.cash_in_transaction_id_prev,\n    t2.cash_in_date_prev,\n    t2.cash_in_amount_prev\nFROM\n    dat_atm_cash      t1\n    LEFT JOIN dat_cash_in_rank  t2 ON t1.report_date = t2.report_date\n                                     AND t1.transaction_id = t2.transaction_id\n                                     AND t1.atm_code = t2.atm_code\n    LEFT JOIN dat_cash_out_rank t3 ON t1.report_date = t3.report_date\n                                      AND t1.transaction_id = t3.transaction_id\n                                      AND t1.atm_code = t3.atm_code\nWHERE 1=1\n    AND t1.report_date >= sysdate - 30\nORDER BY\n    t1.atm_code,\n    t1.report_date", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm_cash_daily"}, "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__card_doc"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_mart_vhkq__atm_cash_out_cus"], "unique_id": "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat_source AS (\r\n    SELECT\r\n        id,\r\n        CAST(source_number AS VARCHAR(64))     AS am_id,\r\n        CAST(transaction_city AS VARCHAR(100)) AS transaction_city,\r\n        transaction_date,\r\n        transaction_amount,\r\n        recons_amount,\r\n        transaction_type,\r\n        CAST(ret_ref_number AS VARCHAR(26))    AS ret_ref_number,\r\n        CAST(is_authorization AS VARCHAR(10))  AS is_authorization,\r\n        return_code,\r\n        CAST(amnd_state AS VARCHAR(26))        AS amnd_state,\r\n        CAST(source_channel AS VARCHAR(26))    AS source_channel,\r\n        CAST(request_category AS VARCHAR(26))  AS request_category,\r\n        etl_date,\r\n        posting_date\r\n    FROM\r\n        {{ ref ('stg_landing__card_doc')}}\r\n    WHERE\r\n            1 = 1\r\n--        AND etl_date between 2022182 and 2022365\r\n        AND transaction_date > (select max(transaction_date_time) from mart.fact__atm_daily where process_detail = 'Cash_out_from_customer' )\r\n        AND is_authorization = 'Y' -- lay giao dich auth\r\n--        AND return_code = 0\r\n        AND amnd_state = 'A'\r\n        AND source_channel = 'A' -- our atm\r\n        AND transaction_type = 13\r\n--        AND posting_status = 'P'\r\n)\r\n, dat_tran_err_rev AS (\r\n    SELECT\r\n        ret_ref_number\r\n    FROM\r\n        dat_source\r\n    WHERE\r\n            request_category = 'R'\r\n        AND return_code = 0\r\n)\r\n,dat_mapping as (\r\nSELECT\r\n    dat_source.*,\r\n    CASE\r\n        WHEN dat_tran_err_rev.ret_ref_number IS NOT NULL THEN\r\n            1\r\n        WHEN dat_source.return_code <> 0                        THEN\r\n            1\r\n    END transaction_error,\r\n    CASE\r\n        WHEN dat_tran_err_rev.ret_ref_number IS NOT NULL THEN\r\n            'L\u1ed7i ATM'\r\n        WHEN dat_source.return_code <> 0                        THEN\r\n            'L\u1ed7i Authorization'\r\n    END transaction_error_group,\r\n    CASE\r\n        WHEN dat_tran_err_rev.ret_ref_number IS NOT NULL THEN\r\n            2001\r\n        WHEN dat_source.return_code <> 0                 THEN\r\n            dat_source.return_code\r\n    END  error_code\r\nFROM\r\n    dat_source\r\n    LEFT JOIN dat_tran_err_rev ON dat_source.ret_ref_number = dat_tran_err_rev.ret_ref_number\r\n)\r\nSELECT  dat_mapping.id,\r\n    dat_mapping.am_id,\r\n    dat_mapping.transaction_city,\r\n    dat_mapping.transaction_date,\r\n    dat_mapping.transaction_amount,\r\n    dat_mapping.recons_amount,\r\n    dat_mapping.transaction_type,\r\n    dat_mapping.ret_ref_number,\r\n    dat_mapping.is_authorization,\r\n    dat_mapping.amnd_state,\r\n    dat_mapping.source_channel,\r\n    dat_mapping.request_category,\r\n    dat_mapping.etl_date,\r\n    dat_mapping.posting_date,\r\n    dat_mapping.transaction_error,\r\n    dim.transaction_error_dim_id\r\nFROM  dat_mapping\r\nLEFT JOIN mart.dim__vhkq_transaction_error dim ON  dat_mapping.error_code = dim.error_code\r\nwhere dat_mapping.request_category <> 'R'\r\nand transaction_error = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_out_cus.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_out_cus.sql", "name": "stg_mart_vhkq__atm_cash_out_cus", "alias": "stg_mart_vhkq__atm_cash_out_cus", "checksum": {"name": "sha256", "checksum": "986c31d5ec0e9961ab169d5a9afc2fa2580e97ab622b392a2a8e63e08bfecd13"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_landing__card_doc"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_out_cus.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "table"}, "created_at": 1685959752.9589796, "compiled_code": "\nWITH dat_source AS (\n    SELECT\n        id,\n        CAST(source_number AS VARCHAR(64))     AS am_id,\n        CAST(transaction_city AS VARCHAR(100)) AS transaction_city,\n        transaction_date,\n        transaction_amount,\n        recons_amount,\n        transaction_type,\n        CAST(ret_ref_number AS VARCHAR(26))    AS ret_ref_number,\n        CAST(is_authorization AS VARCHAR(10))  AS is_authorization,\n        return_code,\n        CAST(amnd_state AS VARCHAR(26))        AS amnd_state,\n        CAST(source_channel AS VARCHAR(26))    AS source_channel,\n        CAST(request_category AS VARCHAR(26))  AS request_category,\n        etl_date,\n        posting_date\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__card_doc\n    WHERE\n            1 = 1\n--        AND etl_date between 2022182 and 2022365\n        AND transaction_date > (select max(transaction_date_time) from mart.fact__atm_daily where process_detail = 'Cash_out_from_customer' )\n        AND is_authorization = 'Y' -- lay giao dich auth\n--        AND return_code = 0\n        AND amnd_state = 'A'\n        AND source_channel = 'A' -- our atm\n        AND transaction_type = 13\n--        AND posting_status = 'P'\n)\n, dat_tran_err_rev AS (\n    SELECT\n        ret_ref_number\n    FROM\n        dat_source\n    WHERE\n            request_category = 'R'\n        AND return_code = 0\n)\n,dat_mapping as (\nSELECT\n    dat_source.*,\n    CASE\n        WHEN dat_tran_err_rev.ret_ref_number IS NOT NULL THEN\n            1\n        WHEN dat_source.return_code <> 0                        THEN\n            1\n    END transaction_error,\n    CASE\n        WHEN dat_tran_err_rev.ret_ref_number IS NOT NULL THEN\n            'L\u1ed7i ATM'\n        WHEN dat_source.return_code <> 0                        THEN\n            'L\u1ed7i Authorization'\n    END transaction_error_group,\n    CASE\n        WHEN dat_tran_err_rev.ret_ref_number IS NOT NULL THEN\n            2001\n        WHEN dat_source.return_code <> 0                 THEN\n            dat_source.return_code\n    END  error_code\nFROM\n    dat_source\n    LEFT JOIN dat_tran_err_rev ON dat_source.ret_ref_number = dat_tran_err_rev.ret_ref_number\n)\nSELECT  dat_mapping.id,\n    dat_mapping.am_id,\n    dat_mapping.transaction_city,\n    dat_mapping.transaction_date,\n    dat_mapping.transaction_amount,\n    dat_mapping.recons_amount,\n    dat_mapping.transaction_type,\n    dat_mapping.ret_ref_number,\n    dat_mapping.is_authorization,\n    dat_mapping.amnd_state,\n    dat_mapping.source_channel,\n    dat_mapping.request_category,\n    dat_mapping.etl_date,\n    dat_mapping.posting_date,\n    dat_mapping.transaction_error,\n    dim.transaction_error_dim_id\nFROM  dat_mapping\nLEFT JOIN mart.dim__vhkq_transaction_error dim ON  dat_mapping.error_code = dim.error_code\nwhere dat_mapping.request_category <> 'R'\nand transaction_error = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm_cash_out_cus"}, "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__card_doc"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_mart_vhkq__atm_cash_out_cus_sus"], "unique_id": "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat_source AS (\r\n    SELECT\r\n        id,\r\n        CAST(source_number AS VARCHAR(64))     AS am_id,\r\n        CAST(transaction_city AS VARCHAR(100)) AS transaction_city,\r\n        transaction_date,\r\n        transaction_amount,\r\n        recons_amount,\r\n        transaction_type,\r\n        CAST(ret_ref_number AS VARCHAR(26))    AS ret_ref_number,\r\n        CAST(is_authorization AS VARCHAR(10))  AS is_authorization,\r\n        return_code,\r\n        CAST(amnd_state AS VARCHAR(26))        AS amnd_state,\r\n        CAST(source_channel AS VARCHAR(26))    AS source_channel,\r\n        CAST(request_category AS VARCHAR(26))  AS request_category,\r\n        etl_date,\r\n        posting_date\r\n    FROM\r\n        {{ ref ('stg_landing__card_doc')}}\r\n    WHERE\r\n            1 = 1\r\n--        AND etl_date between 2022365 and 2023137\r\n        AND transaction_date > (select max(transaction_date_time) from mart.fact__atm_daily where process_detail = 'Cash_out_from_customer' )\r\n--        AND trunc(transaction_date) = '17-MAY-23'\r\n        AND is_authorization = 'N' -- lay giao dich auth\r\n        AND amnd_state = 'A'\r\n        AND source_channel = 'A' -- our atm\r\n        AND transaction_type = 13\r\n        AND posting_status = 'P'\r\n)\r\n,dat_mapping as (\r\nSELECT\r\n    dat_source.*,\r\n    CASE\r\n        WHEN dat_source.return_code <> 0                        THEN\r\n            1\r\n    END transaction_error,\r\n    CASE\r\n        WHEN dat_source.return_code <> 0                        THEN\r\n            'L\u1ed7i None Authorization'\r\n    END transaction_error_group\r\nFROM\r\n    dat_source\r\n)\r\nSELECT  dat_mapping.id,\r\n    dat_mapping.am_id,\r\n    dat_mapping.transaction_city,\r\n    dat_mapping.transaction_date,\r\n    dat_mapping.transaction_amount,\r\n    dat_mapping.recons_amount,\r\n    dat_mapping.transaction_type,\r\n    dat_mapping.ret_ref_number,\r\n    dat_mapping.is_authorization,\r\n    dat_mapping.amnd_state,\r\n    dat_mapping.source_channel,\r\n    dat_mapping.request_category,\r\n    dat_mapping.etl_date,\r\n    dat_mapping.posting_date,\r\n    dat_mapping.transaction_error,\r\n    dim.transaction_error_dim_id\r\nFROM  dat_mapping\r\nLEFT JOIN mart.dim__vhkq_transaction_error dim ON  dat_mapping.return_code = dim.error_code and transaction_error = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_out_cus_sus.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_out_cus_sus.sql", "name": "stg_mart_vhkq__atm_cash_out_cus_sus", "alias": "stg_mart_vhkq__atm_cash_out_cus_sus", "checksum": {"name": "sha256", "checksum": "fd88fc49e1905efd3f142805d6593ed36d0572998765e6c8fea817b3fd93b8f7"}, "tags": ["vhkq_atm_daily"], "refs": [["stg_landing__card_doc"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__atm_cash_out_cus_sus.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"], "materialized": "table"}, "created_at": 1685959752.968298, "compiled_code": "\nWITH dat_source AS (\n    SELECT\n        id,\n        CAST(source_number AS VARCHAR(64))     AS am_id,\n        CAST(transaction_city AS VARCHAR(100)) AS transaction_city,\n        transaction_date,\n        transaction_amount,\n        recons_amount,\n        transaction_type,\n        CAST(ret_ref_number AS VARCHAR(26))    AS ret_ref_number,\n        CAST(is_authorization AS VARCHAR(10))  AS is_authorization,\n        return_code,\n        CAST(amnd_state AS VARCHAR(26))        AS amnd_state,\n        CAST(source_channel AS VARCHAR(26))    AS source_channel,\n        CAST(request_category AS VARCHAR(26))  AS request_category,\n        etl_date,\n        posting_date\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__card_doc\n    WHERE\n            1 = 1\n--        AND etl_date between 2022365 and 2023137\n        AND transaction_date > (select max(transaction_date_time) from mart.fact__atm_daily where process_detail = 'Cash_out_from_customer' )\n--        AND trunc(transaction_date) = '17-MAY-23'\n        AND is_authorization = 'N' -- lay giao dich auth\n        AND amnd_state = 'A'\n        AND source_channel = 'A' -- our atm\n        AND transaction_type = 13\n        AND posting_status = 'P'\n)\n,dat_mapping as (\nSELECT\n    dat_source.*,\n    CASE\n        WHEN dat_source.return_code <> 0                        THEN\n            1\n    END transaction_error,\n    CASE\n        WHEN dat_source.return_code <> 0                        THEN\n            'L\u1ed7i None Authorization'\n    END transaction_error_group\nFROM\n    dat_source\n)\nSELECT  dat_mapping.id,\n    dat_mapping.am_id,\n    dat_mapping.transaction_city,\n    dat_mapping.transaction_date,\n    dat_mapping.transaction_amount,\n    dat_mapping.recons_amount,\n    dat_mapping.transaction_type,\n    dat_mapping.ret_ref_number,\n    dat_mapping.is_authorization,\n    dat_mapping.amnd_state,\n    dat_mapping.source_channel,\n    dat_mapping.request_category,\n    dat_mapping.etl_date,\n    dat_mapping.posting_date,\n    dat_mapping.transaction_error,\n    dim.transaction_error_dim_id\nFROM  dat_mapping\nLEFT JOIN mart.dim__vhkq_transaction_error dim ON  dat_mapping.return_code = dim.error_code and transaction_error = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm_cash_out_cus_sus"}, "model.dga_data_model.stg_mart_vhkq__subbranch_dim": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.bpm_vhkq__warehouse_organization"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_atm_daily"], "meta": {"owner": "giangtt11"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "stg_mart_vhkq__subbranch_dim"], "unique_id": "model.dga_data_model.stg_mart_vhkq__subbranch_dim", "raw_code": "WITH dat_source AS (\r\n    SELECT\r\n        a.*,\r\n        CASE\r\n            WHEN length(organization_code) = 5 THEN\r\n                organization_code\r\n            WHEN organization_name LIKE '%\u0110\u00f4 Th\u00e0nh%' THEN\r\n                '04205'\r\n            WHEN organization_name LIKE '%V\u0103n Qu\u00e1n%' THEN\r\n                '03208'\r\n            ELSE\r\n                concat(organization_code, '00')\r\n        END subbranch_id\r\n    FROM\r\n        {{ref ('bpm_vhkq__warehouse_organization') }} a\r\n    WHERE\r\n        1=1\r\n        AND status = 'ACTIVE'\r\n)\r\n, dat_union as (\r\n    SELECT\r\n        b.id,\r\n        b.fund_begin_day_usd,\r\n        b.fund_begin_day_vnd,\r\n        b.line,\r\n        b.organization_code,\r\n        b.subbranch_id,\r\n        b.organization_name,\r\n        b.warehouse_code,\r\n        b.distance_organization_to_warehouse,\r\n        b.status,\r\n        b.truc_thuoc_cn_pgd,\r\n        b.warehouse_type,\r\n        b.warehouse,\r\n        CASE WHEN subbranch_id in ('37101','37103')\r\n            THEN RANK()\r\n                        OVER(PARTITION BY subbranch_id\r\n                             ORDER BY\r\n                                 warehouse_code desc\r\n                        )\r\n        ELSE RANK()\r\n                    OVER(PARTITION BY subbranch_id\r\n                         ORDER BY\r\n                             warehouse_code\r\n                    )\r\n        END rnk,\r\n        'Physical' subbranch_type\r\n    FROM\r\n        dat_source b\r\n)\r\nselect\r\n    standard_hash(organization_code || '#' || rnk ) id_upd,\r\n    id,\r\n    fund_begin_day_usd,\r\n    fund_begin_day_vnd,\r\n    line,\r\n    organization_code,\r\n    subbranch_id,\r\n    organization_name,\r\n    warehouse_code,\r\n    distance_organization_to_warehouse,\r\n    status,\r\n    truc_thuoc_cn_pgd,\r\n    warehouse_type,\r\n    warehouse,\r\n    rnk,\r\n    subbranch_type\r\nfrom dat_union", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__subbranch_dim.sql", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__subbranch_dim.sql", "name": "stg_mart_vhkq__subbranch_dim", "alias": "stg_mart_vhkq__subbranch_dim", "checksum": {"name": "sha256", "checksum": "e21b5cc8f3139017c2c154c64e40f21e4d725c1d682cf5cbdd38cc1cbfbc0a92"}, "tags": ["vhkq_atm_daily"], "refs": [["bpm_vhkq__warehouse_organization"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\bpm_vhkq\\van_hanh_atm\\stg_mart_vhkq__subbranch_dim.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "giangtt11"}, "tags": ["vhkq_atm_daily"]}, "created_at": 1685959752.9599774, "compiled_code": "WITH dat_source AS (\n    SELECT\n        a.*,\n        CASE\n            WHEN length(organization_code) = 5 THEN\n                organization_code\n            WHEN organization_name LIKE '%\u0110\u00f4 Th\u00e0nh%' THEN\n                '04205'\n            WHEN organization_name LIKE '%V\u0103n Qu\u00e1n%' THEN\n                '03208'\n            ELSE\n                concat(organization_code, '00')\n        END subbranch_id\n    FROM\n        \"oracle_dgaworkzone\".base.bpm_vhkq__warehouse_organization a\n    WHERE\n        1=1\n        AND status = 'ACTIVE'\n)\n, dat_union as (\n    SELECT\n        b.id,\n        b.fund_begin_day_usd,\n        b.fund_begin_day_vnd,\n        b.line,\n        b.organization_code,\n        b.subbranch_id,\n        b.organization_name,\n        b.warehouse_code,\n        b.distance_organization_to_warehouse,\n        b.status,\n        b.truc_thuoc_cn_pgd,\n        b.warehouse_type,\n        b.warehouse,\n        CASE WHEN subbranch_id in ('37101','37103')\n            THEN RANK()\n                        OVER(PARTITION BY subbranch_id\n                             ORDER BY\n                                 warehouse_code desc\n                        )\n        ELSE RANK()\n                    OVER(PARTITION BY subbranch_id\n                         ORDER BY\n                             warehouse_code\n                    )\n        END rnk,\n        'Physical' subbranch_type\n    FROM\n        dat_source b\n)\nselect\n    standard_hash(organization_code || '#' || rnk ) id_upd,\n    id,\n    fund_begin_day_usd,\n    fund_begin_day_vnd,\n    line,\n    organization_code,\n    subbranch_id,\n    organization_name,\n    warehouse_code,\n    distance_organization_to_warehouse,\n    status,\n    truc_thuoc_cn_pgd,\n    warehouse_type,\n    warehouse,\n    rnk,\n    subbranch_type\nfrom dat_union", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart_vhkq__subbranch_dim"}, "model.dga_data_model.stg_cic__camketngoaibang": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__camketngoaibang"], "unique_id": "model.dga_data_model.stg_cic__camketngoaibang", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS(\r\n SELECT\r\n      id\r\n    , version\r\n    , cicid\r\n    , client_question_id\r\n    , gia_tri AS org_os_amount\r\n    , loai_tien AS currency_type\r\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\r\n    , ngay_sl\r\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\r\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\r\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\r\n    , nhom_no\r\n    , num\r\n    , ten_tctd\r\n    , etl_date\r\n    , 'TF' AS product_group\r\n    , 'TF' AS product_detail\r\n FROM\r\n    {{ source('cic_bulanding', 'cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__camketngoaibang.sql", "original_file_path": "models\\staging\\cic\\stg_cic__camketngoaibang.sql", "name": "stg_cic__camketngoaibang", "alias": "stg_cic__camketngoaibang", "checksum": {"name": "sha256", "checksum": "524c78f36157ac2d5cd09d4b1e2bed158cfa0331240496af6ea01dd445b3d0aa"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__camketngoaibang.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9813757, "compiled_code": "\nWITH source AS(\n SELECT\n      id\n    , version\n    , cicid\n    , client_question_id\n    , gia_tri AS org_os_amount\n    , loai_tien AS currency_type\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\n    , ngay_sl\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\n    , nhom_no\n    , num\n    , ten_tctd\n    , etl_date\n    , 'TF' AS product_group\n    , 'TF' AS product_detail\n FROM\n    oracle_bulanding.df_2.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__camketngoaibang"}, "model.dga_data_model.stg_cic__cicmaster": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicmaster @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__cicmaster"], "unique_id": "model.dga_data_model.stg_cic__cicmaster", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n        id\r\n      , version\r\n      , macic\r\n      , thang_nam\r\n      , num\r\n      , client_question_id\r\n      , etl_date\r\n  FROM\r\n    {{ source('cic_bulanding', 'cic_cicmaster @DGA_READ_BULANDING_DBL') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__cicmaster.sql", "original_file_path": "models\\staging\\cic\\stg_cic__cicmaster.sql", "name": "stg_cic__cicmaster", "alias": "stg_cic__cicmaster", "checksum": {"name": "sha256", "checksum": "932df8db8e55008de5d99a2db4c3e2681e007036e8ef072bf26aca83eabae3a7"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicmaster @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__cicmaster.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9843338, "compiled_code": "\nWITH source AS (\n    SELECT\n        id\n      , version\n      , macic\n      , thang_nam\n      , num\n      , client_question_id\n      , etl_date\n  FROM\n    oracle_bulanding.df_2.cic_cicmaster @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__cicmaster"}, "model.dga_data_model.stg_cic__customer_info": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_customer_info @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__customer_info"], "unique_id": "model.dga_data_model.stg_cic__customer_info", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH rec_numbered AS (\r\n SELECT\r\n       macic\r\n     , to_number(macif) AS cif\r\n     , ma_chi_nhanh AS branch_code\r\n     , ma_so_thue AS tax_code\r\n     , socmt AS personal_register_number\r\n     , so_dang_kykd AS corporate_register_number\r\n     , UPPER(tong_giam_doc) AS tong_giam_doc\r\n     , giay_to_khac AS other_register_number\r\n     , UPPER(CAST(ten_khach_hang AS VARCHAR (1000))) AS customer_name\r\n     , UPPER(CAST(dia_chitsc AS VARCHAR (1000))) AS address\r\n     , ghi_chu AS note\r\n     , etl_date\r\n     , row_number() OVER(PARTITION BY macic ORDER BY macif, ma_chi_nhanh, dia_chitsc, socmt ASC) AS rn\r\n  FROM\r\n    {{ source('cic_bulanding', 'cic_customer_info @DGA_READ_BULANDING_DBL') }}\r\n), dup_removed AS (\r\n    SELECT b.*\r\n    FROM rec_numbered b\r\n    WHERE rn = 1\r\n)\r\nSELECT * FROM dup_removed", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__customer_info.sql", "original_file_path": "models\\staging\\cic\\stg_cic__customer_info.sql", "name": "stg_cic__customer_info", "alias": "stg_cic__customer_info", "checksum": {"name": "sha256", "checksum": "cdc7a0882bf7f3e54ada1f9c3dba6636eebd6464e8006ccf2019d9a85f974035"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_customer_info @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__customer_info.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9882963, "compiled_code": "\nWITH rec_numbered AS (\n SELECT\n       macic\n     , to_number(macif) AS cif\n     , ma_chi_nhanh AS branch_code\n     , ma_so_thue AS tax_code\n     , socmt AS personal_register_number\n     , so_dang_kykd AS corporate_register_number\n     , UPPER(tong_giam_doc) AS tong_giam_doc\n     , giay_to_khac AS other_register_number\n     , UPPER(CAST(ten_khach_hang AS VARCHAR (1000))) AS customer_name\n     , UPPER(CAST(dia_chitsc AS VARCHAR (1000))) AS address\n     , ghi_chu AS note\n     , etl_date\n     , row_number() OVER(PARTITION BY macic ORDER BY macif, ma_chi_nhanh, dia_chitsc, socmt ASC) AS rn\n  FROM\n    oracle_bulanding.df_2.cic_customer_info @DGA_READ_BULANDING_DBL\n), dup_removed AS (\n    SELECT b.*\n    FROM rec_numbered b\n    WHERE rn = 1\n)\nSELECT * FROM dup_removed", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__customer_info"}, "model.dga_data_model.stg_cic__daututraiphieu": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__daututraiphieu"], "unique_id": "model.dga_data_model.stg_cic__daututraiphieu", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n      id\r\n    , version\r\n    , cicid\r\n    , client_question_id\r\n    , ngay_den_han\r\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\r\n    , ngay_phat_hanh\r\n    , ngay_sl\r\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\r\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\r\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\r\n    , nhom_no\r\n    , num\r\n    , ten_tctd\r\n    , tong_gia_tri AS org_os_amount\r\n    , etl_date\r\n    , 'VND' AS currency_type\r\n    , 'BOND' AS product_group\r\n    , 'BOND' AS product_detail\r\n FROM\r\n    {{ source('cic_bulanding', 'cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__daututraiphieu.sql", "original_file_path": "models\\staging\\cic\\stg_cic__daututraiphieu.sql", "name": "stg_cic__daututraiphieu", "alias": "stg_cic__daututraiphieu", "checksum": {"name": "sha256", "checksum": "0524dfe4813d95f70939227241bc5a0c3aed5f2ad7680edba705d6a5e876ab78"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__daututraiphieu.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9893763, "compiled_code": "\nWITH source AS (\n SELECT\n      id\n    , version\n    , cicid\n    , client_question_id\n    , ngay_den_han\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\n    , ngay_phat_hanh\n    , ngay_sl\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\n    , nhom_no\n    , num\n    , ten_tctd\n    , tong_gia_tri AS org_os_amount\n    , etl_date\n    , 'VND' AS currency_type\n    , 'BOND' AS product_group\n    , 'BOND' AS product_detail\n FROM\n    oracle_bulanding.df_2.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__daututraiphieu"}, "model.dga_data_model.stg_cic__duno12thang": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__duno12thang"], "unique_id": "model.dga_data_model.stg_cic__duno12thang", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH rec_numbered AS (\r\n    SELECT\r\n          id\r\n        , version\r\n        , cicid\r\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) as request_date\r\n        , ngay_sl\r\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) as respond_date\r\n        , t1vnd\r\n        , t2vnd\r\n        , t3vnd\r\n        , t4vnd\r\n        , t5vnd\r\n        , t6vnd\r\n        , t7vnd\r\n        , t8vnd\r\n        , t9vnd\r\n        , t10vnd\r\n        , t11vnd\r\n        , t12vnd\r\n        , UPPER(regexp_substr(ten_tctd, '[^-]+',1,1,'i')) AS bank\r\n        , CASE WHEN instr(ten_tctd, '-') > 0\r\n            THEN UPPER(regexp_substr(ten_tctd, '[^-]+',1,2,'i'))\r\n            ELSE ''\r\n          END AS branch_name\r\n        , client_question_id\r\n        , num\r\n        , etl_date\r\n        , row_number() OVER(PARTITION BY cicid, ten_tctd, ngay_tra_loi ORDER BY cicid DESC) AS rn\r\n    FROM\r\n        {{ source('cic_bulanding', 'cic_cicth_duno12thang @DGA_READ_BULANDING_DBL') }} A\r\n    WHERE client_question_id IS NOT NULL\r\n), dup_removed AS (\r\n    SELECT b.*\r\n    FROM rec_numbered b\r\n    WHERE rn = 1\r\n)\r\nSELECT *\r\nFROM dup_removed", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__duno12thang.sql", "original_file_path": "models\\staging\\cic\\stg_cic__duno12thang.sql", "name": "stg_cic__duno12thang", "alias": "stg_cic__duno12thang", "checksum": {"name": "sha256", "checksum": "62828511b39df6ee8c78adce0fe30b671bb2e5f44d44e10cfabfdfdbc34c79ec"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_duno12thang @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__duno12thang.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9913726, "compiled_code": "\nWITH rec_numbered AS (\n    SELECT\n          id\n        , version\n        , cicid\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) as request_date\n        , ngay_sl\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) as respond_date\n        , t1vnd\n        , t2vnd\n        , t3vnd\n        , t4vnd\n        , t5vnd\n        , t6vnd\n        , t7vnd\n        , t8vnd\n        , t9vnd\n        , t10vnd\n        , t11vnd\n        , t12vnd\n        , UPPER(regexp_substr(ten_tctd, '[^-]+',1,1,'i')) AS bank\n        , CASE WHEN instr(ten_tctd, '-') > 0\n            THEN UPPER(regexp_substr(ten_tctd, '[^-]+',1,2,'i'))\n            ELSE ''\n          END AS branch_name\n        , client_question_id\n        , num\n        , etl_date\n        , row_number() OVER(PARTITION BY cicid, ten_tctd, ngay_tra_loi ORDER BY cicid DESC) AS rn\n    FROM\n        oracle_bulanding.df_2.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL A\n    WHERE client_question_id IS NOT NULL\n), dup_removed AS (\n    SELECT b.*\n    FROM rec_numbered b\n    WHERE rn = 1\n)\nSELECT *\nFROM dup_removed", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__duno12thang"}, "model.dga_data_model.stg_cic__dunothetd": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__dunothetd"], "unique_id": "model.dga_data_model.stg_cic__dunothetd", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n      id\r\n    , version\r\n    , cicid\r\n    , han_muc_ttd\r\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\r\n    , ngay_sl\r\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\r\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\r\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\r\n    , so_ngay_ctt\r\n    , so_tien_ctt\r\n    , so_tien_ptt\r\n    , ten_tctd_pht AS ten_tctd\r\n    , client_question_id\r\n    , num\r\n    , etl_date\r\n    , 'VND' AS currency_type\r\n    , 'CC' AS product_group\r\n    , 'CC' AS product_detail\r\n FROM\r\n    {{ source('cic_bulanding', 'cic_cicth_dunothetd @DGA_READ_BULANDING_DBL') }}\r\n\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__dunothetd.sql", "original_file_path": "models\\staging\\cic\\stg_cic__dunothetd.sql", "name": "stg_cic__dunothetd", "alias": "stg_cic__dunothetd", "checksum": {"name": "sha256", "checksum": "7145c3bba734e3931d138eb5ae00b96e2dae827b3028c613e4bea3f1abd12ce3"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_dunothetd @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__dunothetd.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9933841, "compiled_code": "\nWITH source AS (\n SELECT\n      id\n    , version\n    , cicid\n    , han_muc_ttd\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\n    , ngay_sl\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\n    , so_ngay_ctt\n    , so_tien_ctt\n    , so_tien_ptt\n    , ten_tctd_pht AS ten_tctd\n    , client_question_id\n    , num\n    , etl_date\n    , 'VND' AS currency_type\n    , 'CC' AS product_group\n    , 'CC' AS product_detail\n FROM\n    oracle_bulanding.df_2.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL\n\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__dunothetd"}, "model.dga_data_model.stg_cic__dunothetd12thang": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__dunothetd12thang"], "unique_id": "model.dga_data_model.stg_cic__dunothetd12thang", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH rec_numbered AS (\r\n    SELECT\r\n          id\r\n        , version\r\n        , cicid\r\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) as request_date\r\n        , ngay_sl\r\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) as respond_date\r\n        , t1vnd\r\n        , t2vnd\r\n        , t3vnd\r\n        , t4vnd\r\n        , t5vnd\r\n        , t6vnd\r\n        , t7vnd\r\n        , t8vnd\r\n        , t9vnd\r\n        , t10vnd\r\n        , t11vnd\r\n        , t12vnd\r\n        , UPPER(regexp_substr(ten_tctd, '[^-]+',1,1,'i')) AS bank\r\n        , CASE WHEN instr(ten_tctd, '-') > 0\r\n            THEN UPPER(regexp_substr(ten_tctd, '[^-]+',1,2,'i'))\r\n            ELSE ''\r\n          END AS branch_name\r\n        , client_question_id\r\n        , num\r\n        , etl_date\r\n        , row_number() OVER(PARTITION BY cicid, ten_tctd, ngay_tra_loi ORDER BY cicid DESC) AS rn\r\n    FROM\r\n        {{ source('cic_bulanding', 'cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL') }} A\r\n    WHERE client_question_id IS NOT NULL\r\n), dup_removed AS (\r\n    SELECT b.*\r\n    FROM rec_numbered b\r\n    WHERE rn = 1\r\n)\r\nSELECT *\r\nFROM dup_removed", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__dunothetd12thang.sql", "original_file_path": "models\\staging\\cic\\stg_cic__dunothetd12thang.sql", "name": "stg_cic__dunothetd12thang", "alias": "stg_cic__dunothetd12thang", "checksum": {"name": "sha256", "checksum": "04db438e20eaa600d13893c96e38b2dea5425a9c025f40c07088f6fdc5154e50"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__dunothetd12thang.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9943726, "compiled_code": "\nWITH rec_numbered AS (\n    SELECT\n          id\n        , version\n        , cicid\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) as request_date\n        , ngay_sl\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) as respond_date\n        , t1vnd\n        , t2vnd\n        , t3vnd\n        , t4vnd\n        , t5vnd\n        , t6vnd\n        , t7vnd\n        , t8vnd\n        , t9vnd\n        , t10vnd\n        , t11vnd\n        , t12vnd\n        , UPPER(regexp_substr(ten_tctd, '[^-]+',1,1,'i')) AS bank\n        , CASE WHEN instr(ten_tctd, '-') > 0\n            THEN UPPER(regexp_substr(ten_tctd, '[^-]+',1,2,'i'))\n            ELSE ''\n          END AS branch_name\n        , client_question_id\n        , num\n        , etl_date\n        , row_number() OVER(PARTITION BY cicid, ten_tctd, ngay_tra_loi ORDER BY cicid DESC) AS rn\n    FROM\n        oracle_bulanding.df_2.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL A\n    WHERE client_question_id IS NOT NULL\n), dup_removed AS (\n    SELECT b.*\n    FROM rec_numbered b\n    WHERE rn = 1\n)\nSELECT *\nFROM dup_removed", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__dunothetd12thang"}, "model.dga_data_model.stg_cic__novamc": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_novamc @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__novamc"], "unique_id": "model.dga_data_model.stg_cic__novamc", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n      id\r\n    , version\r\n    , cicid\r\n    , du_no_da_ban_vnd AS org_os_amount\r\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\r\n    , ngay_sl\r\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\r\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\r\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\r\n    , ten_tctd\r\n    , client_question_id\r\n    , num\r\n    , etl_date\r\n    , 'All' AS bucket_code\r\n    , 'VND' AS currency_type\r\n    , 'VAMC' AS product_group\r\n    , 'VAMC' AS product_detail\r\n FROM\r\n    {{ source('cic_bulanding', 'cic_cicth_novamc @DGA_READ_BULANDING_DBL') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__novamc.sql", "original_file_path": "models\\staging\\cic\\stg_cic__novamc.sql", "name": "stg_cic__novamc", "alias": "stg_cic__novamc", "checksum": {"name": "sha256", "checksum": "412127cc26014268be62c36ff19c25fea642f12f2b501a1ebcef34a0b2e167ad"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_novamc @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__novamc.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9963734, "compiled_code": "\nWITH source AS (\n SELECT\n      id\n    , version\n    , cicid\n    , du_no_da_ban_vnd AS org_os_amount\n    , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\n    , ngay_sl\n    , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\n    , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\n    , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\n    , ten_tctd\n    , client_question_id\n    , num\n    , etl_date\n    , 'All' AS bucket_code\n    , 'VND' AS currency_type\n    , 'VAMC' AS product_group\n    , 'VAMC' AS product_detail\n FROM\n    oracle_bulanding.df_2.cic_cicth_novamc @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__novamc"}, "model.dga_data_model.stg_cic__thongtinchung": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__thongtinchung"], "unique_id": "model.dga_data_model.stg_cic__thongtinchung", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH rec_numbered AS (\r\n    SELECT\r\n          id\r\n        , version\r\n        , cicid AS cic_id\r\n        , ma_cn\r\n        , ma_tctd\r\n        , ma_ycht\r\n        , sanpham\r\n        , tgd_ddpl\r\n        , thoigian\r\n        , user_id\r\n        , trusochinh_diachi\r\n        , client_question_id\r\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\r\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\r\n        , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\r\n        , num\r\n        , etl_date\r\n        , row_number()\r\n            OVER(PARTITION BY client_question_id, ma_tctd, ngay_hoi_tin\r\n                ORDER BY ngay_tra_loi DESC) AS rn\r\n    FROM\r\n        {{ source('cic_bulanding', 'cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL') }}\r\n), dup_removed AS (\r\n    SELECT b.*\r\n    FROM rec_numbered b\r\n    WHERE rn = 1\r\n)\r\nSELECT *\r\nFROM dup_removed", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__thongtinchung.sql", "original_file_path": "models\\staging\\cic\\stg_cic__thongtinchung.sql", "name": "stg_cic__thongtinchung", "alias": "stg_cic__thongtinchung", "checksum": {"name": "sha256", "checksum": "f32e838d280f2774edece07adb159fc3c0dbfcf611d798810a20284137097c65"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__thongtinchung.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.997373, "compiled_code": "\nWITH rec_numbered AS (\n    SELECT\n          id\n        , version\n        , cicid AS cic_id\n        , ma_cn\n        , ma_tctd\n        , ma_ycht\n        , sanpham\n        , tgd_ddpl\n        , thoigian\n        , user_id\n        , trusochinh_diachi\n        , client_question_id\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\n        , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\n        , num\n        , etl_date\n        , row_number()\n            OVER(PARTITION BY client_question_id, ma_tctd, ngay_hoi_tin\n                ORDER BY ngay_tra_loi DESC) AS rn\n    FROM\n        oracle_bulanding.df_2.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL\n), dup_removed AS (\n    SELECT b.*\n    FROM rec_numbered b\n    WHERE rn = 1\n)\nSELECT *\nFROM dup_removed", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__thongtinchung"}, "model.dga_data_model.stg_cic__ttduno": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.cic_bulanding.cic_cicth_ttduno @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["cic_daily"], "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "cic", "stg_cic__ttduno"], "unique_id": "model.dga_data_model.stg_cic__ttduno", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n    SELECT\r\n          id\r\n        , version\r\n        , cicid\r\n        , co_tsbd\r\n        , dnbs_nhpt_usd\r\n        , dnbs_nhpt_vnd\r\n        , dnbs_nxk_usd\r\n        , dnbs_nxk_vnd\r\n        , dndh_nccy_usd\r\n        , dndh_nccy_vnd\r\n        , dndh_ncknmv_usd\r\n        , dndh_ncknmv_vnd\r\n        , dndh_nduoitc_usd\r\n        , dndh_nduoitc_vnd\r\n        , dndh_ndutc_usd\r\n        , dndh_ndutc_vnd\r\n        , dndh_nnn_usd\r\n        , dndh_nnn_vnd\r\n        , dnk_nccy_usd\r\n        , dnk_nccy_vnd\r\n        , dnk_ncknmv_usd\r\n        , dnk_ncknmv_vnd\r\n        , dnk_nduoitc_usd\r\n        , dnk_nduoitc_vnd\r\n        , dnk_ndutc_usd\r\n        , dnk_ndutc_vnd\r\n        , dnk_nnn_usd\r\n        , dnk_nnn_vnd\r\n        , dnnh_nccy_usd\r\n        , dnnh_nccy_vnd\r\n        , dnnh_ncknmv_usd\r\n        , dnnh_ncknmv_vnd\r\n        , dnnh_nduoitc_usd\r\n        , dnnh_nduoitc_vnd\r\n        , dnnh_ndutc_usd\r\n        , dnnh_ndutc_vnd\r\n        , dnnh_nnn_usd\r\n        , dnnh_nnn_vnd\r\n        , dnth_nccy_usd\r\n        , dnth_nccy_vnd\r\n        , dnth_ncknmv_usd\r\n        , dnth_ncknmv_vnd\r\n        , dnth_nduoitc_usd\r\n        , dnth_nduoitc_vnd\r\n        , dnth_ndutc_usd\r\n        , dnth_ndutc_vnd\r\n        , dnth_nnn_usd\r\n        , dnth_nnn_vnd\r\n        , ma_tctd\r\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\r\n        , ngay_sl\r\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\r\n        , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\r\n        , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\r\n        , ten_tctd\r\n        , client_question_id\r\n        , num\r\n        , etl_date\r\n    FROM\r\n        {{ source('cic_bulanding', 'cic_cicth_ttduno @DGA_READ_BULANDING_DBL') }}\r\n), unpivot AS (\r\n    SELECT *\r\n    FROM source\r\n    UNPIVOT\r\n    (\r\n        org_os_amount\r\n        FOR source_column IN (\r\n            dnbs_nxk_usd,\r\n            dnbs_nxk_vnd,\r\n            dndh_nccy_usd,\r\n            dndh_nccy_vnd,\r\n            dndh_ncknmv_usd,\r\n            dndh_ncknmv_vnd,\r\n            dndh_nduoitc_usd,\r\n            dndh_nduoitc_vnd,\r\n            dndh_ndutc_usd,\r\n            dndh_ndutc_vnd,\r\n            dndh_nnn_usd,\r\n            dndh_nnn_vnd,\r\n            dnk_nccy_usd,\r\n            dnk_nccy_vnd,\r\n            dnk_ncknmv_usd,\r\n            dnk_ncknmv_vnd,\r\n            dnk_nduoitc_usd,\r\n            dnk_nduoitc_vnd,\r\n            dnk_ndutc_usd,\r\n            dnk_ndutc_vnd,\r\n            dnk_nnn_usd,\r\n            dnk_nnn_vnd,\r\n            dnnh_nccy_usd,\r\n            dnnh_nccy_vnd,\r\n            dnnh_ncknmv_usd,\r\n            dnnh_ncknmv_vnd,\r\n            dnnh_nduoitc_usd,\r\n            dnnh_nduoitc_vnd,\r\n            dnnh_ndutc_usd,\r\n            dnnh_ndutc_vnd,\r\n            dnnh_nnn_usd,\r\n            dnnh_nnn_vnd,\r\n            dnth_nccy_usd,\r\n            dnth_nccy_vnd,\r\n            dnth_ncknmv_usd,\r\n            dnth_ncknmv_vnd,\r\n            dnth_nduoitc_usd,\r\n            dnth_nduoitc_vnd,\r\n            dnth_ndutc_usd,\r\n            dnth_ndutc_vnd,\r\n            dnth_nnn_usd,\r\n            dnth_nnn_vnd\r\n        )\r\n    )\r\n)\r\nSELECT * FROM unpivot\r\nWHERE org_os_amount <> 0", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\cic\\stg_cic__ttduno.sql", "original_file_path": "models\\staging\\cic\\stg_cic__ttduno.sql", "name": "stg_cic__ttduno", "alias": "stg_cic__ttduno", "checksum": {"name": "sha256", "checksum": "bfb9e8bdc1c094088efc5c35868acc8beda210270f76530a27f85d5d46d456c1"}, "tags": ["cic_daily"], "refs": [], "sources": [["cic_bulanding", "cic_cicth_ttduno @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\cic\\stg_cic.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic__ttduno.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "cic_daily", "materialized": "view"}, "created_at": 1685959752.9992962, "compiled_code": "\nWITH source AS (\n    SELECT\n          id\n        , version\n        , cicid\n        , co_tsbd\n        , dnbs_nhpt_usd\n        , dnbs_nhpt_vnd\n        , dnbs_nxk_usd\n        , dnbs_nxk_vnd\n        , dndh_nccy_usd\n        , dndh_nccy_vnd\n        , dndh_ncknmv_usd\n        , dndh_ncknmv_vnd\n        , dndh_nduoitc_usd\n        , dndh_nduoitc_vnd\n        , dndh_ndutc_usd\n        , dndh_ndutc_vnd\n        , dndh_nnn_usd\n        , dndh_nnn_vnd\n        , dnk_nccy_usd\n        , dnk_nccy_vnd\n        , dnk_ncknmv_usd\n        , dnk_ncknmv_vnd\n        , dnk_nduoitc_usd\n        , dnk_nduoitc_vnd\n        , dnk_ndutc_usd\n        , dnk_ndutc_vnd\n        , dnk_nnn_usd\n        , dnk_nnn_vnd\n        , dnnh_nccy_usd\n        , dnnh_nccy_vnd\n        , dnnh_ncknmv_usd\n        , dnnh_ncknmv_vnd\n        , dnnh_nduoitc_usd\n        , dnnh_nduoitc_vnd\n        , dnnh_ndutc_usd\n        , dnnh_ndutc_vnd\n        , dnnh_nnn_usd\n        , dnnh_nnn_vnd\n        , dnth_nccy_usd\n        , dnth_nccy_vnd\n        , dnth_ncknmv_usd\n        , dnth_ncknmv_vnd\n        , dnth_nduoitc_usd\n        , dnth_nduoitc_vnd\n        , dnth_ndutc_usd\n        , dnth_ndutc_vnd\n        , dnth_nnn_usd\n        , dnth_nnn_vnd\n        , ma_tctd\n        , to_number(to_char(ngay_hoi_tin,'yyyymmdd')) AS request_date\n        , ngay_sl\n        , to_number(to_char(ngay_tra_loi,'yyyymmdd')) AS respond_date\n        , to_number(to_char(ngay_tra_loi,'yyyyddd')) AS respond_date_j\n        , to_number(to_char(ngay_tra_loi,'yyyymm')) AS respond_month\n        , ten_tctd\n        , client_question_id\n        , num\n        , etl_date\n    FROM\n        oracle_bulanding.df_2.cic_cicth_ttduno @DGA_READ_BULANDING_DBL\n), unpivot AS (\n    SELECT *\n    FROM source\n    UNPIVOT\n    (\n        org_os_amount\n        FOR source_column IN (\n            dnbs_nxk_usd,\n            dnbs_nxk_vnd,\n            dndh_nccy_usd,\n            dndh_nccy_vnd,\n            dndh_ncknmv_usd,\n            dndh_ncknmv_vnd,\n            dndh_nduoitc_usd,\n            dndh_nduoitc_vnd,\n            dndh_ndutc_usd,\n            dndh_ndutc_vnd,\n            dndh_nnn_usd,\n            dndh_nnn_vnd,\n            dnk_nccy_usd,\n            dnk_nccy_vnd,\n            dnk_ncknmv_usd,\n            dnk_ncknmv_vnd,\n            dnk_nduoitc_usd,\n            dnk_nduoitc_vnd,\n            dnk_ndutc_usd,\n            dnk_ndutc_vnd,\n            dnk_nnn_usd,\n            dnk_nnn_vnd,\n            dnnh_nccy_usd,\n            dnnh_nccy_vnd,\n            dnnh_ncknmv_usd,\n            dnnh_ncknmv_vnd,\n            dnnh_nduoitc_usd,\n            dnnh_nduoitc_vnd,\n            dnnh_ndutc_usd,\n            dnnh_ndutc_vnd,\n            dnnh_nnn_usd,\n            dnnh_nnn_vnd,\n            dnth_nccy_usd,\n            dnth_nccy_vnd,\n            dnth_ncknmv_usd,\n            dnth_ncknmv_vnd,\n            dnth_nduoitc_usd,\n            dnth_nduoitc_vnd,\n            dnth_ndutc_usd,\n            dnth_ndutc_vnd,\n            dnth_nnn_usd,\n            dnth_nnn_vnd\n        )\n    )\n)\nSELECT * FROM unpivot\nWHERE org_os_amount <> 0", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_cic__ttduno"}, "model.dga_data_model.stg__card_acnt_contract_plus": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index"], "nodes": ["model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_appl_product", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.int_way4__client", "model.dga_data_model.stg_landing__card_contr_status", "model.dga_data_model.stg_landing__card_acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily", "pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index( this, \"id, acnt_contract__oid\") }}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "daily", "stg__card_acnt_contract_plus"], "unique_id": "model.dga_data_model.stg__card_acnt_contract_plus", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    post_hook= '{{ create_index( this, \"id, acnt_contract__oid\") }}' ,\r\n  )\r\n}}\r\nWITH contract AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.id\r\n    , a.acnt_contract__id\r\n    , a.acnt_contract__oid\r\n    , a.liab_contract\r\n    , a.ccat\r\n    , a.branch\r\n    , a.contract_number\r\n    , a.contract_name\r\n    , a.channel\r\n    , C.channel_desc\r\n    , a.product_code AS product_code_internal\r\n    , b.product_code\r\n    , b.name AS product_name\r\n    , b.product_group\r\n    , a.client_id AS customer_id_internal\r\n    , d.customer_number\r\n    , decode(a.auth_limit_amount, 0, f.auth_limit_amount, a.auth_limit_amount) AS auth_limit_amount\r\n    , a.date_open\r\n    , a.date_expire\r\n    , a.last_billing_date\r\n    , a.next_billing_date\r\n    , a.contract_status\r\n    , e.name AS contract_status_name\r\n    , a.tr_first_nam\r\n    , a.tr_last_nam\r\n    , a.cycle_length\r\n    , a.interval_type\r\n    , a.is_ready\r\n    , a.billing_contract\r\n    , a.amnd_date\r\n    , a.rbs_number\r\n    , a.bpm_loan_id\r\n    , a.card_sales_channel\r\n    , a.add_info_01\r\n    , a.add_info_02\r\n    , a.add_info_03\r\n    , a.add_info_04\r\n    , a.los_id\r\n    , a.card_expire\r\n    , a.con_cat\r\n    , CASE\r\n        WHEN b.product_group='ISSDEB' THEN CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\r\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\r\n        WHEN b.product_group='ISSCRD' THEN CASE WHEN SUBSTR(a.contract_number,1,3)='999' THEN 'OTHER' ELSE 'CREDIT_CARD' END\r\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\r\n        WHEN b.product_group='ACQRET' THEN 'DEVICE'\r\n        ELSE 'OTHER'\r\n      END AS type_of_card\r\n    , CASE\r\n        WHEN b.product_group='ISSDEB' THEN\r\n          CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\r\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\r\n        WHEN b.product_group='ISSCRD' THEN\r\n          CASE\r\n            WHEN REGEXP_LIKE(a.contract_number,'L') THEN 'LIAB'\r\n            WHEN REGEXP_LIKE(a.contract_number,'-[WOBU]-') THEN 'LENDINGS'\r\n            ELSE 'CREDIT_CARD'\r\n          END\r\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\r\n        WHEN b.product_group='ACQRET' THEN 'DEVICE' ELSE 'OTHER'\r\n      END AS type_of_contract\r\n    , a.f_i\r\n    , a.amnd_state\r\n  FROM\r\n    {{ ref('stg_landing__card_acnt_contract')}} a\r\n  LEFT JOIN {{ ref('stg_landing__card_appl_product')}} b\r\n    ON a.product_code = b.internal_code\r\n      AND a.ccat = b.ccat\r\n      AND a.con_cat = b.con_cat\r\n      AND b.amnd_state = 'A'\r\n  LEFT JOIN {{ ref('stg_landing__df_card_channel')}} C ON a.channel = C.channel_code\r\n  LEFT JOIN {{ ref('int_way4__client')}} d ON a.client_id = d.id\r\n  LEFT JOIN {{ ref('stg_landing__card_contr_status')}} e\r\n    ON a.contract_status = e.id\r\n      AND a.con_cat = e.con_cat\r\n      AND e.amnd_state = 'A'\r\n  LEFT JOIN {{ ref ('stg_landing__card_acnt_contract')}} f\r\n    ON a.acnt_contract__oid = f.id\r\n      AND a.ccat = f.ccat\r\n      AND a.con_cat = f.con_cat\r\n      AND f.amnd_state = 'A'\r\n  WHERE\r\n    a.amnd_state = 'A'\r\n)\r\nSELECT * FROM contract", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\daily\\stg__card_acnt_contract_plus.sql", "original_file_path": "models\\staging\\daily\\stg__card_acnt_contract_plus.sql", "name": "stg__card_acnt_contract_plus", "alias": "stg__card_acnt_contract_plus", "checksum": {"name": "sha256", "checksum": "04618af40c7122c9707e2d2142872d24f386b8b158d8ac3ec77062f7c6e93e5d"}, "tags": ["pkg_daily"], "refs": [["stg_landing__card_acnt_contract"], ["stg_landing__card_appl_product"], ["stg_landing__df_card_channel"], ["int_way4__client"], ["stg_landing__card_contr_status"], ["stg_landing__card_acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\daily\\staging.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\daily\\stg__card_acnt_contract_plus.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["pkg_daily"], "materialized": "table", "post-hook": ["{{ create_index( this, \"id, acnt_contract__oid\") }}"]}, "created_at": 1685959753.2880063, "compiled_code": "\nWITH contract AS (\n  SELECT\n      a.etl_date\n    , a.id\n    , a.acnt_contract__id\n    , a.acnt_contract__oid\n    , a.liab_contract\n    , a.ccat\n    , a.branch\n    , a.contract_number\n    , a.contract_name\n    , a.channel\n    , C.channel_desc\n    , a.product_code AS product_code_internal\n    , b.product_code\n    , b.name AS product_name\n    , b.product_group\n    , a.client_id AS customer_id_internal\n    , d.customer_number\n    , decode(a.auth_limit_amount, 0, f.auth_limit_amount, a.auth_limit_amount) AS auth_limit_amount\n    , a.date_open\n    , a.date_expire\n    , a.last_billing_date\n    , a.next_billing_date\n    , a.contract_status\n    , e.name AS contract_status_name\n    , a.tr_first_nam\n    , a.tr_last_nam\n    , a.cycle_length\n    , a.interval_type\n    , a.is_ready\n    , a.billing_contract\n    , a.amnd_date\n    , a.rbs_number\n    , a.bpm_loan_id\n    , a.card_sales_channel\n    , a.add_info_01\n    , a.add_info_02\n    , a.add_info_03\n    , a.add_info_04\n    , a.los_id\n    , a.card_expire\n    , a.con_cat\n    , CASE\n        WHEN b.product_group='ISSDEB' THEN CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\n        WHEN b.product_group='ISSCRD' THEN CASE WHEN SUBSTR(a.contract_number,1,3)='999' THEN 'OTHER' ELSE 'CREDIT_CARD' END\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\n        WHEN b.product_group='ACQRET' THEN 'DEVICE'\n        ELSE 'OTHER'\n      END AS type_of_card\n    , CASE\n        WHEN b.product_group='ISSDEB' THEN\n          CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\n        WHEN b.product_group='ISSCRD' THEN\n          CASE\n            WHEN REGEXP_LIKE(a.contract_number,'L') THEN 'LIAB'\n            WHEN REGEXP_LIKE(a.contract_number,'-[WOBU]-') THEN 'LENDINGS'\n            ELSE 'CREDIT_CARD'\n          END\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\n        WHEN b.product_group='ACQRET' THEN 'DEVICE' ELSE 'OTHER'\n      END AS type_of_contract\n    , a.f_i\n    , a.amnd_state\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_appl_product b\n    ON a.product_code = b.internal_code\n      AND a.ccat = b.ccat\n      AND a.con_cat = b.con_cat\n      AND b.amnd_state = 'A'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_card_channel C ON a.channel = C.channel_code\n  LEFT JOIN \"oracle_dgaworkzone\".int.int_way4__client d ON a.client_id = d.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_contr_status e\n    ON a.contract_status = e.id\n      AND a.con_cat = e.con_cat\n      AND e.amnd_state = 'A'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract f\n    ON a.acnt_contract__oid = f.id\n      AND a.ccat = f.ccat\n      AND a.con_cat = f.con_cat\n      AND f.amnd_state = 'A'\n  WHERE\n    a.amnd_state = 'A'\n)\nSELECT * FROM contract", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__card_acnt_contract_plus"}, "model.dga_data_model.stg__customer_connection_pivot": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__customer_connection"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily", "pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "daily", "stg__customer_connection_pivot"], "unique_id": "model.dga_data_model.stg__customer_connection_pivot", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH con_rk AS (\r\n  SELECT \r\n      con.customer_number\r\n    , con.customer_address_type\r\n    , con.customer_email AS customer_address\r\n    , ROW_NUMBER()\r\n        OVER(PARTITION BY con.customer_number, con.customer_address_type\r\n              ORDER BY con.seq_number DESC, con.cfadlm DESC, con.cfatim DESC) AS rn\r\n  FROM  \r\n    {{ ref('stg_landing__customer_connection') }} con\r\n  WHERE\r\n    con.customer_address_type IN ( 'OP', 'HP', 'MP', 'EM' )-- HP: HOME PHONE -- OP: OFFICE PHONE -- MP: MOBILE PHONE -- EM: EMAIL\r\n)\r\n, con_pivot AS (\r\n  SELECT\r\n    *\r\n  FROM\r\n      con_rk\r\n  PIVOT (\r\n    MIN ( customer_address ) AS address\r\n  FOR customer_address_type\r\n    IN ( 'OP' AS office_phone, 'HP' AS home_phone, 'MP' AS mobile_phone, 'EM' AS email )\r\n      )\r\n  WHERE rn = 1\r\n)\r\nSELECT\r\n  * \r\nFROM\r\n  con_pivot", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\daily\\stg__customer_connection_pivot.sql", "original_file_path": "models\\staging\\daily\\stg__customer_connection_pivot.sql", "name": "stg__customer_connection_pivot", "alias": "stg__customer_connection_pivot", "checksum": {"name": "sha256", "checksum": "9f3195c42bd868b39e9bb64727e1750cd769d32e31591b4a045b2f4898248d18"}, "tags": ["pkg_daily"], "refs": [["stg_landing__customer_connection"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\daily\\staging.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\daily\\stg__customer_connection_pivot.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["pkg_daily"], "materialized": "table"}, "created_at": 1685959753.290103, "compiled_code": "\nWITH con_rk AS (\n  SELECT \n      con.customer_number\n    , con.customer_address_type\n    , con.customer_email AS customer_address\n    , ROW_NUMBER()\n        OVER(PARTITION BY con.customer_number, con.customer_address_type\n              ORDER BY con.seq_number DESC, con.cfadlm DESC, con.cfatim DESC) AS rn\n  FROM  \n    \"oracle_dgaworkzone\".staging.stg_landing__customer_connection con\n  WHERE\n    con.customer_address_type IN ( 'OP', 'HP', 'MP', 'EM' )-- HP: HOME PHONE -- OP: OFFICE PHONE -- MP: MOBILE PHONE -- EM: EMAIL\n)\n, con_pivot AS (\n  SELECT\n    *\n  FROM\n      con_rk\n  PIVOT (\n    MIN ( customer_address ) AS address\n  FOR customer_address_type\n    IN ( 'OP' AS office_phone, 'HP' AS home_phone, 'MP' AS mobile_phone, 'EM' AS email )\n      )\n  WHERE rn = 1\n)\nSELECT\n  * \nFROM\n  con_pivot", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__customer_connection_pivot"}, "model.dga_data_model.stg__customer_subbranch_no": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.int__casa_account", "model.dga_data_model.int__fd_account", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily", "pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "customer_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "MERGE INTO {{ ref('int__customer') }} a USING (SELECT * FROM {{ this }}) b ON (a.customer_number = b.customer_number)\n                    WHEN MATCHED THEN UPDATE SET a.subbranch_no = b.subbranch_no", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "daily", "stg__customer_subbranch_no"], "unique_id": "model.dga_data_model.stg__customer_subbranch_no", "raw_code": "{{\r\n    config(\r\n        materialized='table',\r\n        unique_key='customer_number',\r\n        post_hook=[\"MERGE INTO {{ ref('int__customer') }} a USING (SELECT * FROM {{ this }}) b ON (a.customer_number = b.customer_number)\r\n                    WHEN MATCHED THEN UPDATE SET a.subbranch_no = b.subbranch_no\",\r\n              ]\r\n\r\n    )\r\n}}\r\nWITH dat_casa AS (\r\n  SELECT\r\n      customer_number\r\n    , subbranch_no\r\n    , ROW_NUMBER() OVER(PARTITION BY customer_number ORDER BY open_date, open_time) AS rn\r\n  FROM\r\n    {{ ref('int__casa_account')}}\r\n)\r\n, dat_fd AS (\r\n  SELECT\r\n      customer_number\r\n    , subbranch_no\r\n    , ROW_NUMBER() OVER(PARTITION BY customer_number ORDER BY open_date) AS rn\r\n  FROM\r\n    {{ ref('int__fd_account')}}\r\n)\r\n, dat_customer_w_subbranch AS (\r\n  SELECT\r\n      a.customer_number\r\n    , COALESCE(b.subbranch_no, c.subbranch_no) AS subbranch_no\r\n  FROM\r\n    {{ ref('int__customer') }} a\r\n  LEFT JOIN dat_casa b ON a.customer_number = b.customer_number AND b.rn = 1\r\n  LEFT JOIN dat_fd c ON a.customer_number = c.customer_number AND c.rn = 1\r\n)\r\n  SELECT\r\n      customer_number\r\n    , subbranch_no\r\n  FROM\r\n    dat_customer_w_subbranch", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\daily\\stg__customer_subbranch_no.sql", "original_file_path": "models\\staging\\daily\\stg__customer_subbranch_no.sql", "name": "stg__customer_subbranch_no", "alias": "stg__customer_subbranch_no", "checksum": {"name": "sha256", "checksum": "5f5076284921049b084e4fba7e61adf7a85226a91be4c714dc7d1812910dfc49"}, "tags": ["pkg_daily"], "refs": [["int__casa_account"], ["int__fd_account"], ["int__customer"], ["int__customer"], ["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\daily\\staging.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\daily\\stg__customer_subbranch_no.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["pkg_daily"], "materialized": "table", "unique_key": "customer_number", "post-hook": ["MERGE INTO {{ ref('int__customer') }} a USING (SELECT * FROM {{ this }}) b ON (a.customer_number = b.customer_number)\n                    WHEN MATCHED THEN UPDATE SET a.subbranch_no = b.subbranch_no"]}, "created_at": 1685959753.2930865, "compiled_code": "\nWITH dat_casa AS (\n  SELECT\n      customer_number\n    , subbranch_no\n    , ROW_NUMBER() OVER(PARTITION BY customer_number ORDER BY open_date, open_time) AS rn\n  FROM\n    \"oracle_dgaworkzone\".int.int__casa_account\n)\n, dat_fd AS (\n  SELECT\n      customer_number\n    , subbranch_no\n    , ROW_NUMBER() OVER(PARTITION BY customer_number ORDER BY open_date) AS rn\n  FROM\n    \"oracle_dgaworkzone\".int.int__fd_account\n)\n, dat_customer_w_subbranch AS (\n  SELECT\n      a.customer_number\n    , COALESCE(b.subbranch_no, c.subbranch_no) AS subbranch_no\n  FROM\n    \"oracle_dgaworkzone\".int.int__customer a\n  LEFT JOIN dat_casa b ON a.customer_number = b.customer_number AND b.rn = 1\n  LEFT JOIN dat_fd c ON a.customer_number = c.customer_number AND c.rn = 1\n)\n  SELECT\n      customer_number\n    , subbranch_no\n  FROM\n    dat_customer_w_subbranch", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__customer_subbranch_no"}, "model.dga_data_model.stg_dwh__crtb_odtier": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.crtb_odtier @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__crtb_odtier"], "unique_id": "model.dga_data_model.stg_dwh__crtb_odtier", "raw_code": "{{ config( materialized='view') }}\r\nSELECT\r\n    account_no_sk\r\n  , account_type\r\n  , seq_number\r\n  , tier_type\r\n  , rate\r\n  , rate_number\r\n  , rate_variance\r\n  , rate_variance_code\r\n  , rate_floor\r\n  , rate_ceiling\r\n  , excess_limit_type\r\n  , draw_limit_amount\r\n  , author_limit_amount\r\n  , balance\r\n  , agreement_date\r\n  , expiration_date\r\n  , product_group\r\n  , etl_date\r\n  , customer_no\r\n  , due_date\r\n  , indicator_over_limit\r\n  , account_no\r\n  , max_expiry_date\r\n  , dd_lcy_ledger_bal\r\nFROM\r\n  {{ source('daily_dwh', 'crtb_odtier @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__crtb_odtier.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__crtb_odtier.sql", "name": "stg_dwh__crtb_odtier", "alias": "stg_dwh__crtb_odtier", "checksum": {"name": "sha256", "checksum": "5c75a1083ad52467cde149c4be34a3a9ab09379ad03eb396da2019327419f394"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "crtb_odtier @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__crtb_odtier.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959751.4692712, "compiled_code": "\nSELECT\n    account_no_sk\n  , account_type\n  , seq_number\n  , tier_type\n  , rate\n  , rate_number\n  , rate_variance\n  , rate_variance_code\n  , rate_floor\n  , rate_ceiling\n  , excess_limit_type\n  , draw_limit_amount\n  , author_limit_amount\n  , balance\n  , agreement_date\n  , expiration_date\n  , product_group\n  , etl_date\n  , customer_no\n  , due_date\n  , indicator_over_limit\n  , account_no\n  , max_expiry_date\n  , dd_lcy_ledger_bal\nFROM\n  oracle_dwh.dwh.crtb_odtier @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__crtb_odtier"}, "model.dga_data_model.stg_dwh__csdm_branch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.csdm_branch @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__csdm_branch"], "unique_id": "model.dga_data_model.stg_dwh__csdm_branch", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    branch_code_sk\r\n  , branch_code\r\n  , branch_name\r\n  , branch_description\r\n  , parent_branch_code\r\n  , parent_branch_name\r\n  , branch_sbv_code\r\n  , branch_level\r\n  , group_code\r\n  , group_name\r\n  , cpc_code\r\n  , cpc_name\r\n  , area_code\r\n  , area_name\r\n  , auth_stat\r\n  , rec_current_ind\r\n  , rec_effective_date\r\n  , maker_id\r\n  , maker_stamp_dt\r\n  , checker_id\r\n  , checker_stamp_dt\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'csdm_branch @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__csdm_branch.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__csdm_branch.sql", "name": "stg_dwh__csdm_branch", "alias": "stg_dwh__csdm_branch", "checksum": {"name": "sha256", "checksum": "640573b88fc67e796d6753de56de9e90ffc23b46f7f53fb51c5d40de8468e1d0"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "csdm_branch @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__csdm_branch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.29401, "compiled_code": "\nSELECT \n    branch_code_sk\n  , branch_code\n  , branch_name\n  , branch_description\n  , parent_branch_code\n  , parent_branch_name\n  , branch_sbv_code\n  , branch_level\n  , group_code\n  , group_name\n  , cpc_code\n  , cpc_name\n  , area_code\n  , area_name\n  , auth_stat\n  , rec_current_ind\n  , rec_effective_date\n  , maker_id\n  , maker_stamp_dt\n  , checker_id\n  , checker_stamp_dt\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.csdm_branch @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__csdm_branch"}, "model.dga_data_model.stg_dwh__csdm_transaction_code": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__csdm_transaction_code"], "unique_id": "model.dga_data_model.stg_dwh__csdm_transaction_code", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  tran_sk\r\n  , module\r\n  , trn_code\r\n  , trn_type\r\n  , dorc_ind\r\n  , affect_code\r\n  , description\r\n  , event_code\r\n  , event_name\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'csdm_transaction_code @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__csdm_transaction_code.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__csdm_transaction_code.sql", "name": "stg_dwh__csdm_transaction_code", "alias": "stg_dwh__csdm_transaction_code", "checksum": {"name": "sha256", "checksum": "b1c829c3a011820c6b0aca424dda491324b039a89d7f01b819a60b7e8a32ae55"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "csdm_transaction_code @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__csdm_transaction_code.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.29401, "compiled_code": "\nSELECT \n  tran_sk\n  , module\n  , trn_code\n  , trn_type\n  , dorc_ind\n  , affect_code\n  , description\n  , event_code\n  , event_name\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__csdm_transaction_code"}, "model.dga_data_model.stg_dwh__cydm_rate_history": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__cydm_rate_history"], "unique_id": "model.dga_data_model.stg_dwh__cydm_rate_history", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    branch_code\r\n  , ccy1\r\n  , ccy2\r\n  , buy_rate\r\n  , sell_rate\r\n  , mid_rate\r\n  , avg_rate\r\n  , buy_spread\r\n  , sale_spread\r\n  , rate_type\r\n  , start_date\r\n  , end_date\r\n  , datekey\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'cydm_rate_history @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__cydm_rate_history.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__cydm_rate_history.sql", "name": "stg_dwh__cydm_rate_history", "alias": "stg_dwh__cydm_rate_history", "checksum": {"name": "sha256", "checksum": "7205a3d56a45793467439897e98aab518127111b404206762ad2bb436f1e0e9b"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "cydm_rate_history @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__cydm_rate_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.29401, "compiled_code": "\nSELECT \n    branch_code\n  , ccy1\n  , ccy2\n  , buy_rate\n  , sell_rate\n  , mid_rate\n  , avg_rate\n  , buy_spread\n  , sale_spread\n  , rate_type\n  , start_date\n  , end_date\n  , datekey\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__cydm_rate_history"}, "model.dga_data_model.stg_dwh__dddm_product": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.dddm_product @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__dddm_product"], "unique_id": "model.dga_data_model.stg_dwh__dddm_product", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  product_sk\r\n  , product_code\r\n  , product_name\r\n  , product_slogan\r\n  , category\r\n  , currency\r\n  , avail_bal_type\r\n  , unused_limit_include\r\n  , min_bal_type\r\n  , min_reqd_bal\r\n  , unclaim_no_days\r\n  , closed_no_days\r\n  , int_bearing\r\n  , accr_bal\r\n  , reserved\r\n  , max_accr_bal\r\n  , min_accr_bal\r\n  , accr_method\r\n  , year_basis\r\n  , tier\r\n  , cumulative\r\n  , interest_code\r\n  , rate_variance\r\n  , efft_rate\r\n  , accr_freq\r\n  , accr_freq_code\r\n  , overdraft\r\n  , od_rate_code\r\n  , od_rate\r\n  , od_bal_type\r\n  , od_min_bal\r\n  , od_year_basis\r\n  , od_accr_method\r\n  , min_od_int\r\n  , dorm_no_days\r\n  , stmt_dorm\r\n  , dorm_charge\r\n  , dorm_bal_type\r\n  , dormal_bal\r\n  , charge_freq\r\n  , charge_freq_code\r\n  , min_charge\r\n  , charge_bearing\r\n  , neg_bal_charge\r\n  , zero_bal_charge\r\n  , sweep_facility\r\n  , stmt_facility\r\n  , stmt_freq_code\r\n  , stmt_freq\r\n  , checkbook_facility\r\n  , dr_no_limit\r\n  , gl_group\r\n  , rec_current_ind\r\n  , rec_effecttive_date\r\n  , grp\r\n  , product_bk\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'dddm_product @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__dddm_product.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__dddm_product.sql", "name": "stg_dwh__dddm_product", "alias": "stg_dwh__dddm_product", "checksum": {"name": "sha256", "checksum": "96f5d46fae30186f2a5fde484143f949da86f829c083408b8132816ff80509f7"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "dddm_product @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__dddm_product.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.2950103, "compiled_code": "\nSELECT \n  product_sk\n  , product_code\n  , product_name\n  , product_slogan\n  , category\n  , currency\n  , avail_bal_type\n  , unused_limit_include\n  , min_bal_type\n  , min_reqd_bal\n  , unclaim_no_days\n  , closed_no_days\n  , int_bearing\n  , accr_bal\n  , reserved\n  , max_accr_bal\n  , min_accr_bal\n  , accr_method\n  , year_basis\n  , tier\n  , cumulative\n  , interest_code\n  , rate_variance\n  , efft_rate\n  , accr_freq\n  , accr_freq_code\n  , overdraft\n  , od_rate_code\n  , od_rate\n  , od_bal_type\n  , od_min_bal\n  , od_year_basis\n  , od_accr_method\n  , min_od_int\n  , dorm_no_days\n  , stmt_dorm\n  , dorm_charge\n  , dorm_bal_type\n  , dormal_bal\n  , charge_freq\n  , charge_freq_code\n  , min_charge\n  , charge_bearing\n  , neg_bal_charge\n  , zero_bal_charge\n  , sweep_facility\n  , stmt_facility\n  , stmt_freq_code\n  , stmt_freq\n  , checkbook_facility\n  , dr_no_limit\n  , gl_group\n  , rec_current_ind\n  , rec_effecttive_date\n  , grp\n  , product_bk\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.dddm_product @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__dddm_product"}, "model.dga_data_model.stg_dwh__ddft_master": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.ddft_master @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__ddft_master"], "unique_id": "model.dga_data_model.stg_dwh__ddft_master", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    etl_date\r\n  , branch_sk\r\n  , account_no_sk\r\n  , account_type\r\n  , currency\r\n  , product_sk\r\n  , customer_sk\r\n  , status\r\n  , status_since\r\n  , open_date\r\n  , last_active_dt\r\n  , last_contact_dt\r\n  , rate_code\r\n  , rate\r\n  , accr_dr\r\n  , today_accr_dr\r\n  , today_dr_int_liq\r\n  , ytd_dr_int_liq\r\n  , ytd_cr_int_liq\r\n  , od_rate_code\r\n  , od_rate\r\n  , efft_rate\r\n  , acy_blocked_amt\r\n  , lcy_blocked_amt\r\n  , acy_ledger_bal\r\n  , lcy_ledger_bal\r\n  , acy_collected_bal\r\n  , lcy_collected_bal\r\n  , ac_stat_dormant\r\n  , dorm_since\r\n  , gl_code_sk\r\n  , icycle_high_int\r\n  , q1_avg_lbal\r\n  , q2_avg_lbal\r\n  , q3_avg_lbal\r\n  , q4_avg_lbal\r\n  , q1_avg_cbal\r\n  , q2_avg_cbal\r\n  , q3_avg_cbal\r\n  , q4_avg_cbal\r\n  , qtr_agr_days\r\n  , qtr_agr_lbal\r\n  , qtr_agr_cbal\r\n  , mtd_agr_days\r\n  , mtd_agr_bal\r\n  , icycle_agr_days\r\n  , icycle_agr_lbal\r\n  , icycle_agr_cbal\r\n  , icycle_min_bal\r\n  , icycle_max_bal\r\n  , mtd_min_bal\r\n  , mtd_max_bal\r\n  , ac_today_no_dr\r\n  , acy_today_tover_dr\r\n  , lcy_today_tover_dr\r\n  , ac_today_no_cr\r\n  , acy_today_tover_cr\r\n  , lcy_today_tover_cr\r\n  , sc_no_dr\r\n  , sc_tover_dr\r\n  , sc_no_cr\r\n  , sc_tover_cr\r\n  , maker_sk\r\n  , maker_dt_stamp\r\n  , checker_sk\r\n  , number_debit_mtd\r\n  , amount_debit_mtd\r\n  , number_credit_mtd\r\n  , amount_credit_mtd\r\n  , yesterday_balance\r\n  , int_paid_td\r\n  , number_debit_ytd\r\n  , amount_debit_ytd\r\n  , number_credit_ytd\r\n  , amount_credit_ytd\r\n  , book_no\r\n  , last_trn_date\r\n  , aggregate_balance\r\n  , od_accr_int\r\n  , od_exss_int\r\n  , od_accr_int_day\r\n  , od_exss_int_day\r\nFROM\r\n  {{ source('daily_dwh', 'ddft_master @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__ddft_master.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__ddft_master.sql", "name": "stg_dwh__ddft_master", "alias": "stg_dwh__ddft_master", "checksum": {"name": "sha256", "checksum": "e9592e877a11ede5c903b0da4675e116316743a25b5cbe6e3b9d479315a3b2b6"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "ddft_master @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__ddft_master.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.2950103, "compiled_code": "\nSELECT\n    etl_date\n  , branch_sk\n  , account_no_sk\n  , account_type\n  , currency\n  , product_sk\n  , customer_sk\n  , status\n  , status_since\n  , open_date\n  , last_active_dt\n  , last_contact_dt\n  , rate_code\n  , rate\n  , accr_dr\n  , today_accr_dr\n  , today_dr_int_liq\n  , ytd_dr_int_liq\n  , ytd_cr_int_liq\n  , od_rate_code\n  , od_rate\n  , efft_rate\n  , acy_blocked_amt\n  , lcy_blocked_amt\n  , acy_ledger_bal\n  , lcy_ledger_bal\n  , acy_collected_bal\n  , lcy_collected_bal\n  , ac_stat_dormant\n  , dorm_since\n  , gl_code_sk\n  , icycle_high_int\n  , q1_avg_lbal\n  , q2_avg_lbal\n  , q3_avg_lbal\n  , q4_avg_lbal\n  , q1_avg_cbal\n  , q2_avg_cbal\n  , q3_avg_cbal\n  , q4_avg_cbal\n  , qtr_agr_days\n  , qtr_agr_lbal\n  , qtr_agr_cbal\n  , mtd_agr_days\n  , mtd_agr_bal\n  , icycle_agr_days\n  , icycle_agr_lbal\n  , icycle_agr_cbal\n  , icycle_min_bal\n  , icycle_max_bal\n  , mtd_min_bal\n  , mtd_max_bal\n  , ac_today_no_dr\n  , acy_today_tover_dr\n  , lcy_today_tover_dr\n  , ac_today_no_cr\n  , acy_today_tover_cr\n  , lcy_today_tover_cr\n  , sc_no_dr\n  , sc_tover_dr\n  , sc_no_cr\n  , sc_tover_cr\n  , maker_sk\n  , maker_dt_stamp\n  , checker_sk\n  , number_debit_mtd\n  , amount_debit_mtd\n  , number_credit_mtd\n  , amount_credit_mtd\n  , yesterday_balance\n  , int_paid_td\n  , number_debit_ytd\n  , amount_debit_ytd\n  , number_credit_ytd\n  , amount_credit_ytd\n  , book_no\n  , last_trn_date\n  , aggregate_balance\n  , od_accr_int\n  , od_exss_int\n  , od_accr_int_day\n  , od_exss_int_day\nFROM\n  oracle_dwh.dwh.ddft_master @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__ddft_master"}, "model.dga_data_model.stg_dwh__demanddeposit_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.ddft_transaction @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__demanddeposit_transaction001"], "unique_id": "model.dga_data_model.stg_dwh__demanddeposit_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    standard_hash(a.trn_date|| '#'|| a.trn_time|| '#'|| a.src_ref_no|| '#'|| a.seq_number|| '#'|| a.lcy_amount, 'SHA512') AS txn_id\r\n  , trn_ref_no\r\n  , src_ref_no\r\n  , sub_ref_no\r\n  , affect_code\r\n  , trn_sk\r\n  , trn_time\r\n  , trn_date\r\n  , value_date\r\n  , currency\r\n  , dorc_ind\r\n  , acy_amount\r\n  , exchange_rate\r\n  , lcy_amount\r\n  , product_sk\r\n  , status\r\n  , channel\r\n  , channel_trn\r\n  , ac_branch_sk\r\n  , trn_branch_sk\r\n  , account_no_sk\r\n  , customer_sk\r\n  , gl_code_sk\r\n  , maker_sk\r\n  , checker_sk\r\n  , related_person\r\n  , related_account\r\n  , trf_sys\r\n  , trf_bank_sk\r\n  , remark\r\n  , seq_number\r\n  , posting_order\r\n  , before_balance\r\n  , current_balance\r\n  , user_id\r\n  , eqv_tramt\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'ddft_transaction @DGA_READ_DWHPRO_DBL' )}} a", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__demanddeposit_transaction001.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__demanddeposit_transaction001.sql", "name": "stg_dwh__demanddeposit_transaction001", "alias": "stg_dwh__demanddeposit_transaction001", "checksum": {"name": "sha256", "checksum": "dfa4cfe853f704915d77b830c82715a482fcaa9adf1ed4e59a3c306e289ce475"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "ddft_transaction @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__demanddeposit_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.2950103, "compiled_code": "\nSELECT \n    standard_hash(a.trn_date|| '#'|| a.trn_time|| '#'|| a.src_ref_no|| '#'|| a.seq_number|| '#'|| a.lcy_amount, 'SHA512') AS txn_id\n  , trn_ref_no\n  , src_ref_no\n  , sub_ref_no\n  , affect_code\n  , trn_sk\n  , trn_time\n  , trn_date\n  , value_date\n  , currency\n  , dorc_ind\n  , acy_amount\n  , exchange_rate\n  , lcy_amount\n  , product_sk\n  , status\n  , channel\n  , channel_trn\n  , ac_branch_sk\n  , trn_branch_sk\n  , account_no_sk\n  , customer_sk\n  , gl_code_sk\n  , maker_sk\n  , checker_sk\n  , related_person\n  , related_account\n  , trf_sys\n  , trf_bank_sk\n  , remark\n  , seq_number\n  , posting_order\n  , before_balance\n  , current_balance\n  , user_id\n  , eqv_tramt\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.ddft_transaction @DGA_READ_DWHPRO_DBL a", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__demanddeposit_transaction001"}, "model.dga_data_model.stg_dwh__fddm_product": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.fddm_product @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__fddm_product"], "unique_id": "model.dga_data_model.stg_dwh__fddm_product", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    product_sk\r\n  , product_code\r\n  , product_name\r\n  , product_slogan\r\n  , start_date\r\n  , end_date\r\n  , currency\r\n  , term\r\n  , term_code\r\n  , min_term\r\n  , accr_bal\r\n  , reserve_percentage\r\n  , max_accr_bal\r\n  , min_accr_bal\r\n  , accr_method\r\n  , year_basis\r\n  , tier\r\n  , cumulative\r\n  , interest_code\r\n  , rate_variance\r\n  , int_liq_freq\r\n  , int_liq_req_code\r\n  , int_liq_type\r\n  , partial_withdr\r\n  , renew_allow\r\n  , stmt_facility\r\n  , min_bal_type\r\n  , min_reqd_bal\r\n  , gl_group\r\n  , rec_current_ind\r\n  , rec_effecttive_date\r\n  , product_bk\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'fddm_product @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__fddm_product.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__fddm_product.sql", "name": "stg_dwh__fddm_product", "alias": "stg_dwh__fddm_product", "checksum": {"name": "sha256", "checksum": "2a1b5145c865e65a47b619adad533aa7df0d2a0a413f7ef7bf18dbc054658d8c"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "fddm_product @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__fddm_product.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.2960105, "compiled_code": "\nSELECT \n    product_sk\n  , product_code\n  , product_name\n  , product_slogan\n  , start_date\n  , end_date\n  , currency\n  , term\n  , term_code\n  , min_term\n  , accr_bal\n  , reserve_percentage\n  , max_accr_bal\n  , min_accr_bal\n  , accr_method\n  , year_basis\n  , tier\n  , cumulative\n  , interest_code\n  , rate_variance\n  , int_liq_freq\n  , int_liq_req_code\n  , int_liq_type\n  , partial_withdr\n  , renew_allow\n  , stmt_facility\n  , min_bal_type\n  , min_reqd_bal\n  , gl_group\n  , rec_current_ind\n  , rec_effecttive_date\n  , product_bk\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.fddm_product @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__fddm_product"}, "model.dga_data_model.stg_dwh__lnft_master": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.lnft_master @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__lnft_master"], "unique_id": "model.dga_data_model.stg_dwh__lnft_master", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  etl_date\r\n  , branch_code_sk\r\n  , account_no_sk\r\n  , customer_sk\r\n  , contract_sk\r\n  , aano_sk\r\n  , currency\r\n  , product_sk\r\n  , acy_original_amt\r\n  , lcy_original_amt\r\n  , drawdown_limit\r\n  , released_amt\r\n  , acy_outstanding_bal\r\n  , lcy_outstanding_bal\r\n  , status\r\n  , status_since\r\n  , classified_type\r\n  , overdue_status_sk\r\n  , group_overdue_status_sk\r\n  , final_maturity_dt\r\n  , interest\r\n  , based_rate\r\n  , next_review_dt\r\n  , rate_review_dt\r\n  , prime_review_dt\r\n  , last_pliq_amt\r\n  , last_pliq_dt\r\n  , next_pliq_dt\r\n  , last_iliq_dt\r\n  , next_iliq_dt\r\n  , payment_amt\r\n  , final_payment_amt\r\n  , ltd_int_paid\r\n  , ltd_prn_paid\r\n  , last_accr_amt\r\n  , acy_std_accr_amt\r\n  , lcy_std_accr_amt\r\n  , acy_std_accr_penalty_amt\r\n  , lcy_std_accr_penalty_amt\r\n  , acy_ltd_accr_amt\r\n  , lcy_ltd_accr_amt\r\n  , prin_overdue_days\r\n  , acy_prin_overdue_amt\r\n  , int_overdue_days\r\n  , acy_int_overdue_amt\r\n  , acy_total_overdue_amt\r\n  , lcy_total_overdue_amt\r\n  , acy_late_charge\r\n  , dealer_id\r\n  , purpose_sk\r\n  , industry_sk\r\n  , tenor_code_sk\r\n  , maker_sk\r\n  , maker_dt_stamp\r\n  , checker_sk\r\n  , checker_dt_stamp\r\n  , officer_sk\r\n  , ftp_rate\r\n  , actual_overdue_status_sk\r\n  , bil_prin_amt\r\n  , bil_int_amt\r\n  , bil_lc_amt\r\n  , lcy_prin_overdue_amt\r\n  , lcy_int_overdue_amt\r\n  , lcy_late_charge\r\n  , part_industry_sk\r\n  , year_base\r\nFROM\r\n  {{ source('daily_dwh', 'lnft_master @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__lnft_master.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__lnft_master.sql", "name": "stg_dwh__lnft_master", "alias": "stg_dwh__lnft_master", "checksum": {"name": "sha256", "checksum": "ddd545cd1d33de128dc70bb658969b7ab34ab0638d2a8992efe1cec11d1b381d"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "lnft_master @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__lnft_master.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.2960105, "compiled_code": "\nSELECT\n  etl_date\n  , branch_code_sk\n  , account_no_sk\n  , customer_sk\n  , contract_sk\n  , aano_sk\n  , currency\n  , product_sk\n  , acy_original_amt\n  , lcy_original_amt\n  , drawdown_limit\n  , released_amt\n  , acy_outstanding_bal\n  , lcy_outstanding_bal\n  , status\n  , status_since\n  , classified_type\n  , overdue_status_sk\n  , group_overdue_status_sk\n  , final_maturity_dt\n  , interest\n  , based_rate\n  , next_review_dt\n  , rate_review_dt\n  , prime_review_dt\n  , last_pliq_amt\n  , last_pliq_dt\n  , next_pliq_dt\n  , last_iliq_dt\n  , next_iliq_dt\n  , payment_amt\n  , final_payment_amt\n  , ltd_int_paid\n  , ltd_prn_paid\n  , last_accr_amt\n  , acy_std_accr_amt\n  , lcy_std_accr_amt\n  , acy_std_accr_penalty_amt\n  , lcy_std_accr_penalty_amt\n  , acy_ltd_accr_amt\n  , lcy_ltd_accr_amt\n  , prin_overdue_days\n  , acy_prin_overdue_amt\n  , int_overdue_days\n  , acy_int_overdue_amt\n  , acy_total_overdue_amt\n  , lcy_total_overdue_amt\n  , acy_late_charge\n  , dealer_id\n  , purpose_sk\n  , industry_sk\n  , tenor_code_sk\n  , maker_sk\n  , maker_dt_stamp\n  , checker_sk\n  , checker_dt_stamp\n  , officer_sk\n  , ftp_rate\n  , actual_overdue_status_sk\n  , bil_prin_amt\n  , bil_int_amt\n  , bil_lc_amt\n  , lcy_prin_overdue_amt\n  , lcy_int_overdue_amt\n  , lcy_late_charge\n  , part_industry_sk\n  , year_base\nFROM\n  oracle_dwh.dwh.lnft_master @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__lnft_master"}, "model.dga_data_model.stg_dwh__loan_master001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.lndm_account @DGA_READ_DWHPRO_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "dwh", "stg_dwh__loan_master001"], "unique_id": "model.dga_data_model.stg_dwh__loan_master001", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    account_no_sk\r\n  , account_no\r\n  , account_name\r\n  , participation_type\r\n  , org_start_dt\r\n  , book_dt\r\n  , value_dt\r\n  , maturity_dt\r\n  , first_release_dt\r\n  , last_release_dt\r\n  , full_release_dt\r\n  , first_pliq_dt\r\n  , first_iliq_dt\r\n  , tenor\r\n  , tenor_code\r\n  , drawdown_schd\r\n  , revolving\r\n  , spread\r\n  , spread_code\r\n  , based_rate\r\n  , accr_base\r\n  , accr_freq\r\n  , principal_liq_freq\r\n  , principal_liq_freq_code\r\n  , pliq_day\r\n  , interest_liq_freq\r\n  , interest_liq_freq_code\r\n  , iliq_day\r\n  , late_charge_type\r\n  , late_charge_rate\r\n  , dealer_id\r\n  , chg_off_account_no\r\n  , bnm_exempt_yn\r\n  , alternate_schedule_yn\r\n  , prime_review_days\r\n  , prime_review_term\r\n  , prime_review_code\r\n  , rate_review_term\r\n  , rate_review_code\r\n  , rate_review_days\r\n  , rec_current_ind\r\n  , rec_effective_date\r\n  , purpose_name\r\n  , officer_id\r\n  , group_code\r\n  , branch_code_sk\r\n  , product_sk\r\n  , subbranch_no\r\n  , user1\r\n  , user1name\r\n  , user2\r\n  , user2name\r\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\r\nFROM \r\n  {{ source('daily_dwh', 'lndm_account @DGA_READ_DWHPRO_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\dwh\\stg_dwh__loan_master001.sql", "original_file_path": "models\\staging\\dwh\\stg_dwh__loan_master001.sql", "name": "stg_dwh__loan_master001", "alias": "stg_dwh__loan_master001", "checksum": {"name": "sha256", "checksum": "0722302a7747a454686a43fe900a12b6ffe4689c4cdbda333bec3a637c810327"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_dwh", "lndm_account @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\dwh\\dwh.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\dwh\\stg_dwh__loan_master001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.2960105, "compiled_code": "\nSELECT \n    account_no_sk\n  , account_no\n  , account_name\n  , participation_type\n  , org_start_dt\n  , book_dt\n  , value_dt\n  , maturity_dt\n  , first_release_dt\n  , last_release_dt\n  , full_release_dt\n  , first_pliq_dt\n  , first_iliq_dt\n  , tenor\n  , tenor_code\n  , drawdown_schd\n  , revolving\n  , spread\n  , spread_code\n  , based_rate\n  , accr_base\n  , accr_freq\n  , principal_liq_freq\n  , principal_liq_freq_code\n  , pliq_day\n  , interest_liq_freq\n  , interest_liq_freq_code\n  , iliq_day\n  , late_charge_type\n  , late_charge_rate\n  , dealer_id\n  , chg_off_account_no\n  , bnm_exempt_yn\n  , alternate_schedule_yn\n  , prime_review_days\n  , prime_review_term\n  , prime_review_code\n  , rate_review_term\n  , rate_review_code\n  , rate_review_days\n  , rec_current_ind\n  , rec_effective_date\n  , purpose_name\n  , officer_id\n  , group_code\n  , branch_code_sk\n  , product_sk\n  , subbranch_no\n  , user1\n  , user1name\n  , user2\n  , user2name\n  , to_number(to_char(sysdate-1, 'YYYYDDD')) AS etl_date\nFROM \n  oracle_dwh.dwh.lndm_account @DGA_READ_DWHPRO_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_dwh__loan_master001"}, "model.dga_data_model.stg_int__gl_txn": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__gl_hist", "model.dga_data_model.stg_landing__gl_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn"], "unique_id": "model.dga_data_model.stg_int__gl_txn", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nwith dat1 as (\r\n    SELECT\r\n        a.transaction_branch,\r\n        a.transaction_sequence_no,\r\n        a.transaction_account,\r\n        a.transaction_dr_cr_code,\r\n        a.transaction_amount,\r\n        a.transaction_julian_date,\r\n        a.currency_type,\r\n        a.transaction_description,\r\n        a.transaction_source,\r\n        a.source_branch,\r\n        a.transaction_ticket,\r\n        a.user_name,\r\n        a.teller_auxillary_trxn_code,\r\n        a.additional_infomation,\r\n        a.transaction_reference_number,\r\n        a.supervisor_id,\r\n        a.transaction_code,\r\n        a.transaction_system_code,\r\n        TO_DATE(a.transaction_julian_date, 'YYYYDDD')   AS txn_date,\r\n        TO_DATE(a.transaction_julian_date\r\n                || ' '\r\n                || a.time_in_hhmmss_format, 'yyyyDDD HH24MISS') AS txn_datetime,\r\n        CASE\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               '^[X|D|C|M]' ) THEN\r\n                substr(user_name, 3, 3)\r\n                || decode(substr(user_name, 1, 1),\r\n                          'X',\r\n                          ''\r\n                          ||(substr(user_name, 6, 1) + 9),\r\n                          '0'\r\n                          || substr(user_name, 6, 1))\r\n        END                                             AS subbranch_id,\r\n        CASE\r\n            WHEN user_name LIKE '%CH031001%' THEN\r\n                'LUAN CHUYEN NOI BO'\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               'XD' )\r\n                 AND NOT REGEXP_LIKE ( user_name,\r\n                                       'XD0317|XD0404|XD0409' )\r\n                 AND teller_auxillary_trxn_code IN ( '0851', '0856' ) THEN\r\n                'LUAN CHUYEN NOI BO'\r\n            WHEN /*not REGEXP_LIKE(USER_NAME,'XD|XH|CH') and */ teller_auxillary_trxn_code IN ( '0851', '0856' ) THEN\r\n                'LUAN CHUYEN NOI BO'\r\n            WHEN NOT REGEXP_LIKE ( user_name,\r\n                                   'XD|XH|CH' )\r\n                     AND teller_auxillary_trxn_code = '0400'\r\n                     AND REGEXP_LIKE ( additional_infomation,\r\n                                       'CUOI NGAY|CHUYEN QUY|VE QUY|VE TIEN|XQ' ) THEN\r\n                'LUAN CHUYEN NOI BO'\r\n            WHEN NOT REGEXP_LIKE ( user_name,\r\n                                   'XD|XH|CH' )\r\n                     AND teller_auxillary_trxn_code = '0200'\r\n                     AND REGEXP_LIKE ( additional_infomation,\r\n                                       'DAU NGAY|TRONG NGAY|NHAP QUY|NHAN QUY|NHAP TIEN|NHAN TIEN|NQ' ) THEN\r\n                'LUAN CHUYEN NOI BO'\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               'XD0317|XD0404|XD0409' )\r\n                 AND currency_type != 'VND'\r\n                 AND REGEXP_LIKE ( additional_infomation,\r\n                                   'XKNT|NKNT|XUAT KHAU|NHAP KHAU|XUAT  KHAU|NHAP  KHAU|XNK' ) THEN\r\n                'XNK NGOAI TE'\r\n        END                                             AS txn_type,\r\n        CAST(NULL AS VARCHAR(150))                      AS txn_type_sub,\r\n        CASE\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               'XH|CH' ) THEN\r\n                'TTKQ'\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               'XD0317|XD0404|XD0409' ) THEN\r\n                'TTKQ'\r\n        END                                             AS user_name_gr,\r\n        CAST(NULL AS VARCHAR(150))                      AS txn_ref,\r\n        CAST(NULL AS VARCHAR(150))                      AS account_ref,\r\n        CAST(NULL AS NUMBER)                            AS cif,\r\n        CAST(NULL AS NUMBER)                            AS transaction_account_against,\r\n        etl_date\r\n    FROM\r\n        {{ ref('stg_landing__gl_hist' ) }} a\r\n    WHERE\r\n            1 = 1\r\n        AND transaction_account = 110101001\r\n        AND teller_auxillary_trxn_code IN ( '0200', '0400', '0851', '0856' )\r\n    ORDER BY\r\n        transaction_sequence_no\r\n),\r\ndat2 as (\r\n    SELECT\r\n        a.transaction_branch,\r\n        a.transaction_sequence_no,\r\n        a.transaction_account,\r\n        a.transaction_dr_cr_code,\r\n        a.transaction_amount,\r\n        a.transaction_julian_date,\r\n        a.currency_type,\r\n        a.transaction_description,\r\n        a.transaction_source,\r\n        a.source_branch,\r\n        a.transaction_ticket,\r\n        a.user_name,\r\n        a.teller_auxillary_trxn_code,\r\n        a.additional_infomation,\r\n        a.transaction_reference_number,\r\n        a.supervisor_id,\r\n        a.transaction_code,\r\n        a.transaction_system_code,\r\n        TO_DATE(a.transaction_julian_date, 'YYYYDDD')   AS txn_date,\r\n        TO_DATE(a.transaction_julian_date\r\n                || ' '\r\n                || a.time_in_hhmmss_format, 'yyyyDDD HH24MISS') AS txn_datetime,\r\n        CASE\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               '^[X|D|C]' ) THEN\r\n                substr(user_name, 3, 3)\r\n                || decode(substr(user_name, 1, 1),\r\n                          'X',\r\n                          ''\r\n                          ||(substr(user_name, 6, 1) + 9),\r\n                          '0'\r\n                          || substr(user_name, 6, 1))\r\n        END                                             AS subbranch_id,\r\n        'TIEN MAT TAI QUAY'                             AS txn_type,\r\n        CAST(NULL AS VARCHAR(150))                      AS txn_type_sub,\r\n        CASE\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               'XH|CH' ) THEN\r\n                'TTKQ'\r\n            WHEN REGEXP_LIKE ( user_name,\r\n                               'XD0317|XD0404|XD0409' ) THEN\r\n                'TTKQ'\r\n        END                                             AS user_name_gr,\r\n        CAST(NULL AS VARCHAR(150))                      AS txn_ref,\r\n        CAST(NULL AS VARCHAR(150))                      AS account_ref,\r\n        CAST(NULL AS NUMBER)                            AS cif,\r\n        CAST(NULL AS NUMBER)                            AS transaction_account_against,\r\n        etl_date\r\n    FROM\r\n        {{ ref('stg_landing__gl_hist' ) }}  a\r\n    WHERE\r\n            1 = 1\r\n        AND transaction_account = 110101001\r\n        AND teller_auxillary_trxn_code NOT IN ( '0200', '0400', '0851', '0856' )\r\n)\r\n, dat_union as (\r\n    select *\r\n    from dat1\r\n    union\r\n    select *\r\n    from dat2\r\n    )\r\nSELECT\r\n    transaction_branch,\r\n    transaction_sequence_no,\r\n    transaction_account,\r\n    transaction_dr_cr_code,\r\n    transaction_amount,\r\n    transaction_julian_date,\r\n    currency_type,\r\n    transaction_description,\r\n    transaction_source,\r\n    source_branch,\r\n    transaction_ticket,\r\n    user_name,\r\n    teller_auxillary_trxn_code,\r\n    additional_infomation,\r\n    transaction_reference_number,\r\n    supervisor_id,\r\n    transaction_code,\r\n    transaction_system_code,\r\n    txn_date,\r\n    txn_datetime,\r\n    subbranch_id,\r\n    txn_type,\r\n    txn_type_sub,\r\n    user_name_gr,\r\n    txn_ref,\r\n    account_ref,\r\n    cif,\r\n    transaction_account_against,\r\n    transaction_julian_date etl_date,\r\n    int.gl_txn_seq.nextval gl_txn_id\r\nFROM\r\n    dat_union t", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.sql", "name": "stg_int__gl_txn", "alias": "stg_int__gl_txn", "checksum": {"name": "sha256", "checksum": "6f628ebb39986248f3e77c3be57d5c80541ab161b7a73f5e46605b522d836cb4"}, "tags": ["gl_txn_daily"], "refs": [["stg_landing__gl_hist"], ["stg_landing__gl_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.0373406, "compiled_code": "\nwith dat1 as (\n    SELECT\n        a.transaction_branch,\n        a.transaction_sequence_no,\n        a.transaction_account,\n        a.transaction_dr_cr_code,\n        a.transaction_amount,\n        a.transaction_julian_date,\n        a.currency_type,\n        a.transaction_description,\n        a.transaction_source,\n        a.source_branch,\n        a.transaction_ticket,\n        a.user_name,\n        a.teller_auxillary_trxn_code,\n        a.additional_infomation,\n        a.transaction_reference_number,\n        a.supervisor_id,\n        a.transaction_code,\n        a.transaction_system_code,\n        TO_DATE(a.transaction_julian_date, 'YYYYDDD')   AS txn_date,\n        TO_DATE(a.transaction_julian_date\n                || ' '\n                || a.time_in_hhmmss_format, 'yyyyDDD HH24MISS') AS txn_datetime,\n        CASE\n            WHEN REGEXP_LIKE ( user_name,\n                               '^[X|D|C|M]' ) THEN\n                substr(user_name, 3, 3)\n                || decode(substr(user_name, 1, 1),\n                          'X',\n                          ''\n                          ||(substr(user_name, 6, 1) + 9),\n                          '0'\n                          || substr(user_name, 6, 1))\n        END                                             AS subbranch_id,\n        CASE\n            WHEN user_name LIKE '%CH031001%' THEN\n                'LUAN CHUYEN NOI BO'\n            WHEN REGEXP_LIKE ( user_name,\n                               'XD' )\n                 AND NOT REGEXP_LIKE ( user_name,\n                                       'XD0317|XD0404|XD0409' )\n                 AND teller_auxillary_trxn_code IN ( '0851', '0856' ) THEN\n                'LUAN CHUYEN NOI BO'\n            WHEN /*not REGEXP_LIKE(USER_NAME,'XD|XH|CH') and */ teller_auxillary_trxn_code IN ( '0851', '0856' ) THEN\n                'LUAN CHUYEN NOI BO'\n            WHEN NOT REGEXP_LIKE ( user_name,\n                                   'XD|XH|CH' )\n                     AND teller_auxillary_trxn_code = '0400'\n                     AND REGEXP_LIKE ( additional_infomation,\n                                       'CUOI NGAY|CHUYEN QUY|VE QUY|VE TIEN|XQ' ) THEN\n                'LUAN CHUYEN NOI BO'\n            WHEN NOT REGEXP_LIKE ( user_name,\n                                   'XD|XH|CH' )\n                     AND teller_auxillary_trxn_code = '0200'\n                     AND REGEXP_LIKE ( additional_infomation,\n                                       'DAU NGAY|TRONG NGAY|NHAP QUY|NHAN QUY|NHAP TIEN|NHAN TIEN|NQ' ) THEN\n                'LUAN CHUYEN NOI BO'\n            WHEN REGEXP_LIKE ( user_name,\n                               'XD0317|XD0404|XD0409' )\n                 AND currency_type != 'VND'\n                 AND REGEXP_LIKE ( additional_infomation,\n                                   'XKNT|NKNT|XUAT KHAU|NHAP KHAU|XUAT  KHAU|NHAP  KHAU|XNK' ) THEN\n                'XNK NGOAI TE'\n        END                                             AS txn_type,\n        CAST(NULL AS VARCHAR(150))                      AS txn_type_sub,\n        CASE\n            WHEN REGEXP_LIKE ( user_name,\n                               'XH|CH' ) THEN\n                'TTKQ'\n            WHEN REGEXP_LIKE ( user_name,\n                               'XD0317|XD0404|XD0409' ) THEN\n                'TTKQ'\n        END                                             AS user_name_gr,\n        CAST(NULL AS VARCHAR(150))                      AS txn_ref,\n        CAST(NULL AS VARCHAR(150))                      AS account_ref,\n        CAST(NULL AS NUMBER)                            AS cif,\n        CAST(NULL AS NUMBER)                            AS transaction_account_against,\n        etl_date\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__gl_hist a\n    WHERE\n            1 = 1\n        AND transaction_account = 110101001\n        AND teller_auxillary_trxn_code IN ( '0200', '0400', '0851', '0856' )\n    ORDER BY\n        transaction_sequence_no\n),\ndat2 as (\n    SELECT\n        a.transaction_branch,\n        a.transaction_sequence_no,\n        a.transaction_account,\n        a.transaction_dr_cr_code,\n        a.transaction_amount,\n        a.transaction_julian_date,\n        a.currency_type,\n        a.transaction_description,\n        a.transaction_source,\n        a.source_branch,\n        a.transaction_ticket,\n        a.user_name,\n        a.teller_auxillary_trxn_code,\n        a.additional_infomation,\n        a.transaction_reference_number,\n        a.supervisor_id,\n        a.transaction_code,\n        a.transaction_system_code,\n        TO_DATE(a.transaction_julian_date, 'YYYYDDD')   AS txn_date,\n        TO_DATE(a.transaction_julian_date\n                || ' '\n                || a.time_in_hhmmss_format, 'yyyyDDD HH24MISS') AS txn_datetime,\n        CASE\n            WHEN REGEXP_LIKE ( user_name,\n                               '^[X|D|C]' ) THEN\n                substr(user_name, 3, 3)\n                || decode(substr(user_name, 1, 1),\n                          'X',\n                          ''\n                          ||(substr(user_name, 6, 1) + 9),\n                          '0'\n                          || substr(user_name, 6, 1))\n        END                                             AS subbranch_id,\n        'TIEN MAT TAI QUAY'                             AS txn_type,\n        CAST(NULL AS VARCHAR(150))                      AS txn_type_sub,\n        CASE\n            WHEN REGEXP_LIKE ( user_name,\n                               'XH|CH' ) THEN\n                'TTKQ'\n            WHEN REGEXP_LIKE ( user_name,\n                               'XD0317|XD0404|XD0409' ) THEN\n                'TTKQ'\n        END                                             AS user_name_gr,\n        CAST(NULL AS VARCHAR(150))                      AS txn_ref,\n        CAST(NULL AS VARCHAR(150))                      AS account_ref,\n        CAST(NULL AS NUMBER)                            AS cif,\n        CAST(NULL AS NUMBER)                            AS transaction_account_against,\n        etl_date\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__gl_hist  a\n    WHERE\n            1 = 1\n        AND transaction_account = 110101001\n        AND teller_auxillary_trxn_code NOT IN ( '0200', '0400', '0851', '0856' )\n)\n, dat_union as (\n    select *\n    from dat1\n    union\n    select *\n    from dat2\n    )\nSELECT\n    transaction_branch,\n    transaction_sequence_no,\n    transaction_account,\n    transaction_dr_cr_code,\n    transaction_amount,\n    transaction_julian_date,\n    currency_type,\n    transaction_description,\n    transaction_source,\n    source_branch,\n    transaction_ticket,\n    user_name,\n    teller_auxillary_trxn_code,\n    additional_infomation,\n    transaction_reference_number,\n    supervisor_id,\n    transaction_code,\n    transaction_system_code,\n    txn_date,\n    txn_datetime,\n    subbranch_id,\n    txn_type,\n    txn_type_sub,\n    user_name_gr,\n    txn_ref,\n    account_ref,\n    cif,\n    transaction_account_against,\n    transaction_julian_date etl_date,\n    int.gl_txn_seq.nextval gl_txn_id\nFROM\n    dat_union t", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn"}, "model.dga_data_model.stg_int__gl_txn_check_date": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.gl_daily_bul.demanddeposit_transaction001", "source.dga_data_model.gl_daily_bul.loan_transaction001", "source.dga_data_model.gl_daily_bul.fixeddeposit_transaction001", "model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.int__gl_txn"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn_check_date"], "unique_id": "model.dga_data_model.stg_int__gl_txn_check_date", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nwith date_gl_hist as (\r\n    select max(etl_date) etl_date_gl_hist\r\n    from {{ ref ( 'stg_int__gl_txn' ) }}\r\n),\r\ndate_int_gl_txn as (\r\n    select max(etl_date) elt_date_txn\r\n    from {{ ref ('int__gl_txn') }}\r\n)\r\n,date_loan_txn as (\r\n    select max(etl_date) etl_date_loan\r\n    from {{ source ('gl_daily_bul', 'loan_transaction001') }} a\r\n)\r\n,date_fd_txn as (\r\n    select max(etl_date) etl_date_fd\r\n    from {{ source ('gl_daily_bul', 'fixeddeposit_transaction001') }} a\r\n)\r\n,date_dd_txn as (\r\n    select max(etl_date) etl_date_dd\r\n    from {{ source ('gl_daily_bul', 'demanddeposit_transaction001') }} a\r\n)\r\nselect etl_date_gl_hist etl_date\r\nfrom date_gl_hist\r\njoin date_int_gl_txn on date_gl_hist.etl_date_gl_hist = date_int_gl_txn.elt_date_txn\r\njoin date_loan_txn on date_gl_hist.etl_date_gl_hist = date_loan_txn.etl_date_loan\r\njoin date_fd_txn on date_gl_hist.etl_date_gl_hist = date_fd_txn.etl_date_fd\r\njoin date_dd_txn on date_gl_hist.etl_date_gl_hist = date_dd_txn.etl_date_dd", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn_check_date.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn_check_date.sql", "name": "stg_int__gl_txn_check_date", "alias": "stg_int__gl_txn_check_date", "checksum": {"name": "sha256", "checksum": "bf9040ed8715be87a5c90952ac3a1aec0f3128be6a3e92eeb8ad0c2c1173b22c"}, "tags": ["gl_txn_daily_update"], "refs": [["stg_int__gl_txn"], ["int__gl_txn"]], "sources": [["gl_daily_bul", "demanddeposit_transaction001"], ["gl_daily_bul", "loan_transaction001"], ["gl_daily_bul", "fixeddeposit_transaction001"]], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn_check_date.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.026368, "compiled_code": "\nwith date_gl_hist as (\n    select max(etl_date) etl_date_gl_hist\n    from \"oracle_dgaworkzone\".staging.stg_int__gl_txn\n),\ndate_int_gl_txn as (\n    select max(etl_date) elt_date_txn\n    from \"oracle_dgaworkzone\".int.int__gl_txn\n)\n,date_loan_txn as (\n    select max(etl_date) etl_date_loan\n    from oracle_bulanding.df_2.loan_transaction001 a\n)\n,date_fd_txn as (\n    select max(etl_date) etl_date_fd\n    from oracle_bulanding.df_2.fixeddeposit_transaction001 a\n)\n,date_dd_txn as (\n    select max(etl_date) etl_date_dd\n    from oracle_bulanding.df_2.demanddeposit_transaction001 a\n)\nselect etl_date_gl_hist etl_date\nfrom date_gl_hist\njoin date_int_gl_txn on date_gl_hist.etl_date_gl_hist = date_int_gl_txn.elt_date_txn\njoin date_loan_txn on date_gl_hist.etl_date_gl_hist = date_loan_txn.etl_date_loan\njoin date_fd_txn on date_gl_hist.etl_date_gl_hist = date_fd_txn.etl_date_fd\njoin date_dd_txn on date_gl_hist.etl_date_gl_hist = date_dd_txn.etl_date_dd", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn_check_date"}, "model.dga_data_model.stg_int__gl_txn_demanddeposit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__demanddeposit_transaction001", "model.dga_data_model.stg_int__gl_txn"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn_demanddeposit"], "unique_id": "model.dga_data_model.stg_int__gl_txn_demanddeposit", "raw_code": "WITH cte_deposit_trans AS (\r\n    SELECT\r\n        a.*,\r\n        b.account_no,\r\n        br.branch_code,\r\n        cst.customer_no AS cif\r\n    FROM\r\n        {{ ref ('stg_landing__demanddeposit_transaction001') }} a\r\n        JOIN df_2.demanddeposit_master002@dga_read_bulanding_dbl b ON a.account_no_sk = b.account_no_sk\r\n        LEFT JOIN df_2.dwh_csdm_branch@dga_read_bulanding_dbl         br ON a.trn_branch_sk = br.branch_code_sk\r\n        LEFT JOIN df_2.customer_master002@dga_read_bulanding_dbl      cst ON a.customer_sk = cst.customer_sk\r\n    WHERE\r\n        1=1\r\n        AND channel = 'Z'\r\n)\r\n, dat_rnk AS (\r\n    SELECT\r\n        a.*,\r\n        ROW_NUMBER()\r\n        OVER(PARTITION BY trn_date,\r\n                          seq_number,\r\n                          channel_trn,\r\n                          src_ref_no,\r\n                          dorc_ind\r\n             ORDER BY\r\n                 abs(lcy_amount) DESC\r\n        ) AS rn\r\n    FROM\r\n        cte_deposit_trans a\r\n    )\r\nSELECT\r\n    t1.etl_date,\r\n    t1.gl_txn_id,\r\n    t3.trn_ref_no    AS txn_ref,\r\n    t3.account_no    AS account_ref,\r\n    t3.cif           AS CIF,\r\n    'DD'                        txn_type_sub,\r\n    TO_DATE(t3.trn_date\r\n            || ' '\r\n            || lpad(t3.trn_time, 6, '0'),\r\n            'yyyyDDD HH24MISS') txn_datetime\r\nFROM\r\n    {{ ref('stg_int__gl_txn' ) }} t1\r\nJOIN dat_rnk t3                    on  t1.transaction_julian_date = t3.trn_date\r\n                                   and t1.transaction_sequence_no = t3.seq_number\r\n                                   and t1.teller_auxillary_trxn_code = t3.channel_trn\r\n                                   and t1.transaction_ticket = t3.src_ref_no\r\n                                   and t1.transaction_dr_cr_code <> t3.dorc_ind\r\n                                   and t3.rn = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn_demanddeposit.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn_demanddeposit.sql", "name": "stg_int__gl_txn_demanddeposit", "alias": "stg_int__gl_txn_demanddeposit", "checksum": {"name": "sha256", "checksum": "a7491f7be56436b72ddef76da8fef7adc89a20689e6f24f22dd50d7714147098"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__demanddeposit_transaction001"], ["stg_int__gl_txn"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn_demanddeposit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}}, "created_at": 1685959753.0383713, "compiled_code": "WITH cte_deposit_trans AS (\n    SELECT\n        a.*,\n        b.account_no,\n        br.branch_code,\n        cst.customer_no AS cif\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_transaction001 a\n        JOIN df_2.demanddeposit_master002@dga_read_bulanding_dbl b ON a.account_no_sk = b.account_no_sk\n        LEFT JOIN df_2.dwh_csdm_branch@dga_read_bulanding_dbl         br ON a.trn_branch_sk = br.branch_code_sk\n        LEFT JOIN df_2.customer_master002@dga_read_bulanding_dbl      cst ON a.customer_sk = cst.customer_sk\n    WHERE\n        1=1\n        AND channel = 'Z'\n)\n, dat_rnk AS (\n    SELECT\n        a.*,\n        ROW_NUMBER()\n        OVER(PARTITION BY trn_date,\n                          seq_number,\n                          channel_trn,\n                          src_ref_no,\n                          dorc_ind\n             ORDER BY\n                 abs(lcy_amount) DESC\n        ) AS rn\n    FROM\n        cte_deposit_trans a\n    )\nSELECT\n    t1.etl_date,\n    t1.gl_txn_id,\n    t3.trn_ref_no    AS txn_ref,\n    t3.account_no    AS account_ref,\n    t3.cif           AS CIF,\n    'DD'                        txn_type_sub,\n    TO_DATE(t3.trn_date\n            || ' '\n            || lpad(t3.trn_time, 6, '0'),\n            'yyyyDDD HH24MISS') txn_datetime\nFROM\n    \"oracle_dgaworkzone\".staging.stg_int__gl_txn t1\nJOIN dat_rnk t3                    on  t1.transaction_julian_date = t3.trn_date\n                                   and t1.transaction_sequence_no = t3.seq_number\n                                   and t1.teller_auxillary_trxn_code = t3.channel_trn\n                                   and t1.transaction_ticket = t3.src_ref_no\n                                   and t1.transaction_dr_cr_code <> t3.dorc_ind\n                                   and t3.rn = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn_demanddeposit"}, "model.dga_data_model.stg_int__gl_txn_fixeddeposit": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__fixeddeposit_transaction001", "model.dga_data_model.stg_int__gl_txn"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn_fixeddeposit"], "unique_id": "model.dga_data_model.stg_int__gl_txn_fixeddeposit", "raw_code": "WITH cte_fd_trans AS (\r\n    SELECT\r\n        a.*,\r\n        b.account_no,\r\n        br.branch_code,\r\n        cst.customer_no AS cif\r\n    FROM\r\n             {{ref ('stg_landing__fixeddeposit_transaction001')}} a\r\n        JOIN df_2.fixeddeposit_master002@dga_read_bulanding_dbl b ON a.account_no_sk = b.account_sk\r\n        LEFT JOIN df_2.dwh_csdm_branch@dga_read_bulanding_dbl        br ON a.trn_branch_sk = br.branch_code_sk\r\n        LEFT JOIN df_2.customer_master002@dga_read_bulanding_dbl     cst ON a.customer_sk = cst.customer_sk\r\n    WHERE\r\n        1=1\r\n    )\r\nSELECT DISTINCT\r\n    t1.etl_date,\r\n    t1.gl_txn_id,\r\n    t4.trn_ref_no    AS txn_ref,\r\n    t4.account_no    AS account_ref,\r\n    t4.cif           AS CIF,\r\n    'FD'             AS txn_type_sub,\r\n    TO_DATE(t4.trn_date\r\n            || ' '\r\n            || lpad(t4.trn_time, 6, '0'),\r\n            'yyyyDDD HH24MISS') AS txn_datetime\r\nFROM\r\n\r\n    {{ ref('stg_int__gl_txn' ) }} t1\r\nJOIN cte_fd_trans t4 on t1.transaction_julian_date = t4.trn_date\r\n                                                 and t1.transaction_sequence_no = t4.seq_number\r\n                                                 and t1.teller_auxillary_trxn_code = t4.channel_trn\r\n                                                 and t1.transaction_ticket = t4.src_ref_no\r\n                                                 and t1.transaction_dr_cr_code <> t4.dorc_ind", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn_fixeddeposit.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn_fixeddeposit.sql", "name": "stg_int__gl_txn_fixeddeposit", "alias": "stg_int__gl_txn_fixeddeposit", "checksum": {"name": "sha256", "checksum": "bf2adbbc026e0318da95843b4c56c21311fcf358d329fbda3419543170eeac13"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__fixeddeposit_transaction001"], ["stg_int__gl_txn"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn_fixeddeposit.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}}, "created_at": 1685959753.040367, "compiled_code": "WITH cte_fd_trans AS (\n    SELECT\n        a.*,\n        b.account_no,\n        br.branch_code,\n        cst.customer_no AS cif\n    FROM\n             \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_transaction001 a\n        JOIN df_2.fixeddeposit_master002@dga_read_bulanding_dbl b ON a.account_no_sk = b.account_sk\n        LEFT JOIN df_2.dwh_csdm_branch@dga_read_bulanding_dbl        br ON a.trn_branch_sk = br.branch_code_sk\n        LEFT JOIN df_2.customer_master002@dga_read_bulanding_dbl     cst ON a.customer_sk = cst.customer_sk\n    WHERE\n        1=1\n    )\nSELECT DISTINCT\n    t1.etl_date,\n    t1.gl_txn_id,\n    t4.trn_ref_no    AS txn_ref,\n    t4.account_no    AS account_ref,\n    t4.cif           AS CIF,\n    'FD'             AS txn_type_sub,\n    TO_DATE(t4.trn_date\n            || ' '\n            || lpad(t4.trn_time, 6, '0'),\n            'yyyyDDD HH24MISS') AS txn_datetime\nFROM\n\n    \"oracle_dgaworkzone\".staging.stg_int__gl_txn t1\nJOIN cte_fd_trans t4 on t1.transaction_julian_date = t4.trn_date\n                                                 and t1.transaction_sequence_no = t4.seq_number\n                                                 and t1.teller_auxillary_trxn_code = t4.channel_trn\n                                                 and t1.transaction_ticket = t4.src_ref_no\n                                                 and t1.transaction_dr_cr_code <> t4.dorc_ind", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn_fixeddeposit"}, "model.dga_data_model.stg_int__gl_txn_loan": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__loan_transaction001", "model.dga_data_model.stg_int__gl_txn"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn_loan"], "unique_id": "model.dga_data_model.stg_int__gl_txn_loan", "raw_code": "WITH cte_loan_trans AS (\r\n    SELECT\r\n        a.*,\r\n        b.account_no,\r\n        br.branch_code,\r\n        cst.customer_no AS cif\r\n    FROM\r\n         {{ ref('stg_landing__loan_transaction001' ) }} a\r\n        JOIN df_2.loan_master001@dga_read_bulanding_dbl     b ON a.account_no_sk = b.account_no_sk\r\n        LEFT JOIN df_2.dwh_csdm_branch@dga_read_bulanding_dbl    br ON a.trn_branch_sk = br.branch_code_sk\r\n        LEFT JOIN df_2.customer_master002@dga_read_bulanding_dbl cst ON a.customer_sk = cst.customer_sk\r\n    WHERE\r\n            1 = 1\r\n        AND channel = 'Z'\r\n)\r\n-- group giao dich lai, do giao dich tra no chia theo goc, lai, phi\r\n, cte_loan_trans_1 AS (\r\n    SELECT\r\n        tran_date,\r\n        seq_number,\r\n        channel_trn,\r\n        branch_code,\r\n        account_no,\r\n        trn_time,\r\n        cif,\r\n        trn_ref_no,\r\n        dorc_ind,\r\n        substr(src_ref_no, 8, 8) AS user_name,\r\n        SUM(acy_amount)          AS acy_amount,\r\n        SUM(lcy_amount)          AS lcy_amount\r\n    FROM\r\n        cte_loan_trans\r\n    GROUP BY\r\n        tran_date,\r\n        seq_number,\r\n        channel_trn,\r\n        branch_code,\r\n        account_no,\r\n        trn_time,\r\n        cif,\r\n        trn_ref_no,\r\n        dorc_ind,\r\n        substr(src_ref_no, 8, 8)\r\n)\r\n,dat_rnk as (\r\n    SELECT\r\n        a.*,\r\n        ROW_NUMBER()\r\n        OVER(PARTITION BY tran_date, seq_number, channel_trn, dorc_ind, branch_code,\r\n                          user_name\r\n             ORDER BY\r\n                 lcy_amount DESC\r\n        ) AS rn\r\n    FROM\r\n        cte_loan_trans_1 a\r\n    )\r\n, dat_final as (\r\n    SELECT tran_date,\r\n        seq_number,\r\n        channel_trn,\r\n        user_name,\r\n        branch_code,\r\n        trn_ref_no,\r\n        account_no,\r\n        cif,\r\n        'LN' txn_type_sub,\r\n        TO_DATE(tran_date || ' ' || lpad(trn_time, 6, '0'),'yyyyDDD HH24MISS') txn_datetime\r\n    FROM dat_rnk\r\n    WHERE rn = 1\r\n)\r\nselect\r\n    t1.etl_date,\r\n    t1.gl_txn_id,\r\n    t2.trn_ref_no    AS txn_ref,\r\n    t2.account_no    AS account_ref,\r\n    t2.cif           AS CIF,\r\n    t2.txn_type_sub,\r\n    t2.txn_datetime\r\nfrom {{ ref('stg_int__gl_txn' ) }} t1\r\njoin dat_final  t2                              on t1.transaction_julian_date = t2.tran_date\r\n                                                and t1.transaction_sequence_no = t2.seq_number\r\n                                                and t1.teller_auxillary_trxn_code = t2.channel_trn\r\n                                                and t1.user_name = t2.user_name\r\n                                                and t1.transaction_branch = t2.branch_code", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn_loan.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn_loan.sql", "name": "stg_int__gl_txn_loan", "alias": "stg_int__gl_txn_loan", "checksum": {"name": "sha256", "checksum": "427f2f42ef9c6c51b6a37885624b9949a3c1144aa04bbe4b51299ea11823c9e2"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__loan_transaction001"], ["stg_int__gl_txn"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn_loan.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}}, "created_at": 1685959753.0432973, "compiled_code": "WITH cte_loan_trans AS (\n    SELECT\n        a.*,\n        b.account_no,\n        br.branch_code,\n        cst.customer_no AS cif\n    FROM\n         \"oracle_dgaworkzone\".staging.stg_landing__loan_transaction001 a\n        JOIN df_2.loan_master001@dga_read_bulanding_dbl     b ON a.account_no_sk = b.account_no_sk\n        LEFT JOIN df_2.dwh_csdm_branch@dga_read_bulanding_dbl    br ON a.trn_branch_sk = br.branch_code_sk\n        LEFT JOIN df_2.customer_master002@dga_read_bulanding_dbl cst ON a.customer_sk = cst.customer_sk\n    WHERE\n            1 = 1\n        AND channel = 'Z'\n)\n-- group giao dich lai, do giao dich tra no chia theo goc, lai, phi\n, cte_loan_trans_1 AS (\n    SELECT\n        tran_date,\n        seq_number,\n        channel_trn,\n        branch_code,\n        account_no,\n        trn_time,\n        cif,\n        trn_ref_no,\n        dorc_ind,\n        substr(src_ref_no, 8, 8) AS user_name,\n        SUM(acy_amount)          AS acy_amount,\n        SUM(lcy_amount)          AS lcy_amount\n    FROM\n        cte_loan_trans\n    GROUP BY\n        tran_date,\n        seq_number,\n        channel_trn,\n        branch_code,\n        account_no,\n        trn_time,\n        cif,\n        trn_ref_no,\n        dorc_ind,\n        substr(src_ref_no, 8, 8)\n)\n,dat_rnk as (\n    SELECT\n        a.*,\n        ROW_NUMBER()\n        OVER(PARTITION BY tran_date, seq_number, channel_trn, dorc_ind, branch_code,\n                          user_name\n             ORDER BY\n                 lcy_amount DESC\n        ) AS rn\n    FROM\n        cte_loan_trans_1 a\n    )\n, dat_final as (\n    SELECT tran_date,\n        seq_number,\n        channel_trn,\n        user_name,\n        branch_code,\n        trn_ref_no,\n        account_no,\n        cif,\n        'LN' txn_type_sub,\n        TO_DATE(tran_date || ' ' || lpad(trn_time, 6, '0'),'yyyyDDD HH24MISS') txn_datetime\n    FROM dat_rnk\n    WHERE rn = 1\n)\nselect\n    t1.etl_date,\n    t1.gl_txn_id,\n    t2.trn_ref_no    AS txn_ref,\n    t2.account_no    AS account_ref,\n    t2.cif           AS CIF,\n    t2.txn_type_sub,\n    t2.txn_datetime\nfrom \"oracle_dgaworkzone\".staging.stg_int__gl_txn t1\njoin dat_final  t2                              on t1.transaction_julian_date = t2.tran_date\n                                                and t1.transaction_sequence_no = t2.seq_number\n                                                and t1.teller_auxillary_trxn_code = t2.channel_trn\n                                                and t1.user_name = t2.user_name\n                                                and t1.transaction_branch = t2.branch_code", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn_loan"}, "model.dga_data_model.stg_int__gl_txn_nhnn_tctd": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__gl_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "transaction_julian_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn_nhnn_tctd"], "unique_id": "model.dga_data_model.stg_int__gl_txn_nhnn_tctd", "raw_code": "WITH cte_noibo AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        {{ref ('stg_landing__gl_hist')}}  a\r\n    WHERE\r\n            1 = 1\r\n        AND teller_auxillary_trxn_code IN ( '0200', '0400', '0851', '0856' )\r\n), cte_noibo_1 AS (\r\n    SELECT\r\n        a.*,\r\n        CAST(NULL AS VARCHAR(50)) AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n        transaction_account = 110101001\r\n    UNION ALL\r\n    SELECT\r\n        a.*,\r\n        'NOP RUT NHNN' AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n            transaction_account >= 120101001\r\n        AND transaction_account <= 120101053\r\n    UNION ALL\r\n    SELECT\r\n        a.*,\r\n        CASE\r\n            WHEN REGEXP_LIKE ( additional_infomation,\r\n                               'NHNN|NH NN' ) THEN\r\n                'NOP RUT NHNN'\r\n            WHEN REGEXP_LIKE ( additional_infomation,\r\n                               'REM       DV:|REM       GB -|DOI VON|DOI TIEN|DVQTT|VCB|VC BANK|NGOAI THUONG|NGAI THUONG|FI-DV|DV-FI|DOI NGUON|HDDV|0681000012578'\r\n                               )\r\n                 AND NOT REGEXP_LIKE ( additional_infomation,\r\n                                       'DOI TIEN MOI' ) THEN\r\n                'TRAO DOI VON TCTD'\r\n        END AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n        transaction_account = 280701005\r\n    UNION ALL\r\n    SELECT\r\n        a.*,\r\n        'TRAO DOI VON TCTD' AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n        transaction_account = 120201011\r\n    )\r\nSELECT\r\n    a.transaction_julian_date,\r\n    a.transaction_ticket,\r\n    b.txn_type            AS txn_type,\r\n    b.transaction_account AS transaction_account_against\r\nFROM\r\n         cte_noibo_1 a\r\n    JOIN cte_noibo_1 b ON a.transaction_julian_date = b.transaction_julian_date\r\n                          AND a.transaction_branch = b.transaction_branch\r\n                          AND a.transaction_sequence_no = b.transaction_sequence_no\r\n                          AND a.user_name = b.user_name\r\n                          AND a.transaction_dr_cr_code <> b.transaction_dr_cr_code\r\n                          AND a.currency_type = b.currency_type\r\n                          AND b.transaction_account <> 110101001", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn_nhnn_tctd.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn_nhnn_tctd.sql", "name": "stg_int__gl_txn_nhnn_tctd", "alias": "stg_int__gl_txn_nhnn_tctd", "checksum": {"name": "sha256", "checksum": "1ba8c87c9407f09fcccc34695d4faad6d5c73c516e862e543fa8f7ae04a2f0eb"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__gl_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "transaction_julian_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn_nhnn_tctd.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "transaction_julian_date"}}, "created_at": 1685959753.0443306, "compiled_code": "WITH cte_noibo AS (\n    SELECT\n        *\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__gl_hist  a\n    WHERE\n            1 = 1\n        AND teller_auxillary_trxn_code IN ( '0200', '0400', '0851', '0856' )\n), cte_noibo_1 AS (\n    SELECT\n        a.*,\n        CAST(NULL AS VARCHAR(50)) AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n        transaction_account = 110101001\n    UNION ALL\n    SELECT\n        a.*,\n        'NOP RUT NHNN' AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n            transaction_account >= 120101001\n        AND transaction_account <= 120101053\n    UNION ALL\n    SELECT\n        a.*,\n        CASE\n            WHEN REGEXP_LIKE ( additional_infomation,\n                               'NHNN|NH NN' ) THEN\n                'NOP RUT NHNN'\n            WHEN REGEXP_LIKE ( additional_infomation,\n                               'REM       DV:|REM       GB -|DOI VON|DOI TIEN|DVQTT|VCB|VC BANK|NGOAI THUONG|NGAI THUONG|FI-DV|DV-FI|DOI NGUON|HDDV|0681000012578'\n                               )\n                 AND NOT REGEXP_LIKE ( additional_infomation,\n                                       'DOI TIEN MOI' ) THEN\n                'TRAO DOI VON TCTD'\n        END AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n        transaction_account = 280701005\n    UNION ALL\n    SELECT\n        a.*,\n        'TRAO DOI VON TCTD' AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n        transaction_account = 120201011\n    )\nSELECT\n    a.transaction_julian_date,\n    a.transaction_ticket,\n    b.txn_type            AS txn_type,\n    b.transaction_account AS transaction_account_against\nFROM\n         cte_noibo_1 a\n    JOIN cte_noibo_1 b ON a.transaction_julian_date = b.transaction_julian_date\n                          AND a.transaction_branch = b.transaction_branch\n                          AND a.transaction_sequence_no = b.transaction_sequence_no\n                          AND a.user_name = b.user_name\n                          AND a.transaction_dr_cr_code <> b.transaction_dr_cr_code\n                          AND a.currency_type = b.currency_type\n                          AND b.transaction_account <> 110101001", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn_nhnn_tctd"}, "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__gl_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "transaction_julian_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_int__gl_txn_update_gl_doi_ung"], "unique_id": "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung", "raw_code": "WITH cte_noibo AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        {{ref ('stg_landing__gl_hist')}} a\r\n    WHERE\r\n            1 = 1\r\n        AND teller_auxillary_trxn_code IN ( '0200', '0400', '0851', '0856' )\r\n)\r\n, cte_noibo_1 AS (\r\n    SELECT\r\n        a.*,\r\n        CAST(NULL AS VARCHAR(50)) AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n        transaction_account = 110101001\r\n    UNION ALL\r\n    SELECT\r\n        a.*,\r\n        'NOP RUT NHNN' AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n            transaction_account >= 120101001\r\n        AND transaction_account <= 120101053\r\n    UNION ALL\r\n    SELECT\r\n        a.*,\r\n        '' AS txn_type\r\n    FROM\r\n        cte_noibo a\r\n    WHERE\r\n        transaction_account IN ( 280701005, 120201011 )\r\n    )\r\nSELECT\r\n    a.transaction_julian_date,\r\n    a.transaction_ticket,\r\n    b.txn_type            AS txn_type,\r\n    b.transaction_account AS transaction_account_against\r\nFROM\r\n         cte_noibo_1 a\r\n    JOIN cte_noibo_1 b ON a.transaction_julian_date = b.transaction_julian_date\r\n                          AND a.transaction_branch = b.transaction_branch\r\n                          AND a.transaction_sequence_no = b.transaction_sequence_no\r\n                          AND a.user_name = b.user_name\r\n                          AND a.transaction_dr_cr_code <> b.transaction_dr_cr_code\r\n                          AND a.currency_type = b.currency_type\r\n                          AND b.transaction_account <> 110101001", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_int__gl_txn_update_gl_doi_ung.sql", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn_update_gl_doi_ung.sql", "name": "stg_int__gl_txn_update_gl_doi_ung", "alias": "stg_int__gl_txn_update_gl_doi_ung", "checksum": {"name": "sha256", "checksum": "82f2b294e951689f8e944c22320e40d324312141bc595ebae39ae797dcf9d037"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__gl_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "transaction_julian_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_int__gl_txn_update_gl_doi_ung.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "transaction_julian_date"}}, "created_at": 1685959753.0463703, "compiled_code": "WITH cte_noibo AS (\n    SELECT\n        *\n    FROM\n        \"oracle_dgaworkzone\".staging.stg_landing__gl_hist a\n    WHERE\n            1 = 1\n        AND teller_auxillary_trxn_code IN ( '0200', '0400', '0851', '0856' )\n)\n, cte_noibo_1 AS (\n    SELECT\n        a.*,\n        CAST(NULL AS VARCHAR(50)) AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n        transaction_account = 110101001\n    UNION ALL\n    SELECT\n        a.*,\n        'NOP RUT NHNN' AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n            transaction_account >= 120101001\n        AND transaction_account <= 120101053\n    UNION ALL\n    SELECT\n        a.*,\n        '' AS txn_type\n    FROM\n        cte_noibo a\n    WHERE\n        transaction_account IN ( 280701005, 120201011 )\n    )\nSELECT\n    a.transaction_julian_date,\n    a.transaction_ticket,\n    b.txn_type            AS txn_type,\n    b.transaction_account AS transaction_account_against\nFROM\n         cte_noibo_1 a\n    JOIN cte_noibo_1 b ON a.transaction_julian_date = b.transaction_julian_date\n                          AND a.transaction_branch = b.transaction_branch\n                          AND a.transaction_sequence_no = b.transaction_sequence_no\n                          AND a.user_name = b.user_name\n                          AND a.transaction_dr_cr_code <> b.transaction_dr_cr_code\n                          AND a.currency_type = b.currency_type\n                          AND b.transaction_account <> 110101001", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_int__gl_txn_update_gl_doi_ung"}, "model.dga_data_model.stg_landing__demanddeposit_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__gl_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_landing__demanddeposit_transaction001"], "unique_id": "model.dga_data_model.stg_landing__demanddeposit_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n SELECT\r\n    *\r\n  FROM\r\n    df_2.demanddeposit_transaction001@DGA_READ_BULANDING_DBL a\r\n  WHERE\r\n    etl_date in (( select distinct etl_date from {{ ref('stg_landing__gl_hist') }} ))", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_landing__demanddeposit_transaction001.sql", "original_file_path": "models\\staging\\gl_txn\\stg_landing__demanddeposit_transaction001.sql", "name": "stg_landing__demanddeposit_transaction001", "alias": "stg_landing__demanddeposit_transaction001", "checksum": {"name": "sha256", "checksum": "956e539b3b06ce20ed0da8dc95d055d76a84e25cd536be8942a4a0925bcfcf97"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__gl_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_landing__demanddeposit_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.0322993, "compiled_code": "\n SELECT\n    *\n  FROM\n    df_2.demanddeposit_transaction001@DGA_READ_BULANDING_DBL a\n  WHERE\n    etl_date in (( select distinct etl_date from \"oracle_dgaworkzone\".staging.stg_landing__gl_hist ))", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_transaction001"}, "model.dga_data_model.stg_landing__fixeddeposit_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__gl_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_landing__fixeddeposit_transaction001"], "unique_id": "model.dga_data_model.stg_landing__fixeddeposit_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n SELECT\r\n    *\r\n  FROM\r\n    df_2.fixeddeposit_transaction001@DGA_READ_BULANDING_DBL a\r\n  WHERE\r\n    etl_date in (( select distinct etl_date from {{ ref('stg_landing__gl_hist' ) }}))", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_landing__fixeddeposit_transaction001.sql", "original_file_path": "models\\staging\\gl_txn\\stg_landing__fixeddeposit_transaction001.sql", "name": "stg_landing__fixeddeposit_transaction001", "alias": "stg_landing__fixeddeposit_transaction001", "checksum": {"name": "sha256", "checksum": "2e9d2693cef3165703e1e5644b7826a6b4726bdfb78b16011101add0a0f07d07"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__gl_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_landing__fixeddeposit_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.0352955, "compiled_code": "\n SELECT\n    *\n  FROM\n    df_2.fixeddeposit_transaction001@DGA_READ_BULANDING_DBL a\n  WHERE\n    etl_date in (( select distinct etl_date from \"oracle_dgaworkzone\".staging.stg_landing__gl_hist))", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_transaction001"}, "model.dga_data_model.stg_landing__gl_account_master": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.gl_daily_bul.gl_account_master"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_landing__gl_account_master"], "unique_id": "model.dga_data_model.stg_landing__gl_account_master", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n SELECT\r\n    *\r\n  FROM\r\n    {{ source ('gl_daily_bul', 'gl_account_master') }} a\r\n  WHERE\r\n    etl_date >= cast(date_format(current_date - interval '1' day, '%Y%j') as int)\r\n--    etl_date = 2023104", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_landing__gl_account_master.sql", "original_file_path": "models\\staging\\gl_txn\\stg_landing__gl_account_master.sql", "name": "stg_landing__gl_account_master", "alias": "stg_landing__gl_account_master", "checksum": {"name": "sha256", "checksum": "af5089133378f31f453618803fb5f8b980ebf6f3ab90f136711ca44bf00a1125"}, "tags": ["gl_txn_daily"], "refs": [], "sources": [["gl_daily_bul", "gl_account_master"]], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_landing__gl_account_master.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.0482967, "compiled_code": "\n SELECT\n    *\n  FROM\n    oracle_bulanding.df_2.gl_account_master a\n  WHERE\n    etl_date >= cast(date_format(current_date - interval '1' day, '%Y%j') as int)\n--    etl_date = 2023104", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__gl_account_master"}, "model.dga_data_model.stg_landing__gl_hist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.gl_daily_bul.si_his_glhist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_landing__gl_hist"], "unique_id": "model.dga_data_model.stg_landing__gl_hist", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n SELECT\r\n    *\r\n  FROM\r\n    {{ source ('gl_daily_bul', 'si_his_glhist') }} a\r\n  WHERE\r\n    etl_date >= cast(date_format(current_date - interval '1' day, '%Y%j') as int)\r\n--    etl_date = 2023104", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_landing__gl_hist.sql", "original_file_path": "models\\staging\\gl_txn\\stg_landing__gl_hist.sql", "name": "stg_landing__gl_hist", "alias": "stg_landing__gl_hist", "checksum": {"name": "sha256", "checksum": "4706910852c3f6fd6870a9f93315a491af9160533016e4d1773e59a30ebeec5b"}, "tags": ["gl_txn_daily"], "refs": [], "sources": [["gl_daily_bul", "si_his_glhist"]], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_landing__gl_hist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.028367, "compiled_code": "\n SELECT\n    *\n  FROM\n    oracle_bulanding.df_2.si_his_glhist a\n  WHERE\n    etl_date >= cast(date_format(current_date - interval '1' day, '%Y%j') as int)\n--    etl_date = 2023104", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__gl_hist"}, "model.dga_data_model.stg_landing__loan_transaction001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_landing__gl_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "gl_txn", "stg_landing__loan_transaction001"], "unique_id": "model.dga_data_model.stg_landing__loan_transaction001", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\n SELECT\r\n    *\r\n  FROM\r\n    df_2.LOAN_TRANSACTION001@DGA_READ_BULANDING_DBL a\r\n  WHERE\r\n    etl_date in (( select distinct etl_date from {{ ref('stg_landing__gl_hist') }} ))", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\gl_txn\\stg_landing__loan_transaction001.sql", "original_file_path": "models\\staging\\gl_txn\\stg_landing__loan_transaction001.sql", "name": "stg_landing__loan_transaction001", "alias": "stg_landing__loan_transaction001", "checksum": {"name": "sha256", "checksum": "c2369cf51393692b0b96eebeb1a58ce1bc13388ec880bec67a4c4f4ecae5fdf3"}, "tags": ["gl_txn_daily", "gl_txn_daily_update"], "refs": [["stg_landing__gl_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\gl_txn\\stg_int__gl_txn.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\gl_txn\\stg_landing__loan_transaction001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["gl_txn_daily", "gl_txn_daily_update"], "meta": {"date_column": "etl_date"}, "materialized": "table"}, "created_at": 1685959753.0303786, "compiled_code": "\n SELECT\n    *\n  FROM\n    df_2.LOAN_TRANSACTION001@DGA_READ_BULANDING_DBL a\n  WHERE\n    etl_date in (( select distinct etl_date from \"oracle_dgaworkzone\".staging.stg_landing__gl_hist ))", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__loan_transaction001"}, "model.dga_data_model.stg_landing__bc_user_info": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.bc_user_info @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__bc_user_info"], "unique_id": "model.dga_data_model.stg_landing__bc_user_info", "raw_code": "{{\r\n  config(\r\n    materialized='view',\r\n  )\r\n}}\r\nSELECT\r\n    user_id\r\n  , user_name\r\n  , nick\r\n  , gender\r\n  , group_id\r\n  , login_pwd\r\n  , trade_pwd\r\n  , security_type\r\n  , sign_org\r\n  , cert_type\r\n  , cert_name\r\n  , cert_code\r\n  , cert_issued_date\r\n  , cert_issued_place\r\n  , telephone\r\n  , mobile\r\n  , fax\r\n  , address\r\n  , postal_code\r\n  , email\r\n  , open_acct_stmt\r\n  , acct_stmt_frq\r\n  , acct_stmt_method\r\n  , open_mobile\r\n  , service_type\r\n  , receive_sms_adv\r\n  , remark\r\n  , create_by\r\n  , create_by_mng\r\n  , create_time\r\n  , update_by\r\n  , update_by_mng\r\n  , update_time\r\n  , status\r\n  , freezed_start_time\r\n  , freezed_end_time\r\n  , login_count\r\n  , is_online\r\n  , is_pwd_changed\r\n  , CAST(customer_number AS number) AS customer_number\r\n  , cif_acct_name\r\n  , open_ibs\r\n  , open_mbs\r\n  , open_sms\r\n  , group_id_mbs\r\n  , group_id_sms\r\n  , mobile_mbs\r\n  , mobile_sms\r\n  , region_code\r\n  , brand_code\r\n  , login_flag\r\n  , token_no\r\n  , token_exp\r\n  , transaction\r\n  , img_profile\r\n  , is_first_exp\r\n  , noti_pwd\r\n  , lasttime_pwd_changed\r\n  , security_type_mb\r\n  , open_sms_bdsd\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding','bc_user_info @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__bc_user_info.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__bc_user_info.sql", "name": "stg_landing__bc_user_info", "alias": "stg_landing__bc_user_info", "checksum": {"name": "sha256", "checksum": "6eb2f3a4ad574ae5754b922fdb4967b755afc3e282aff346b863e1a7cd934bb6"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "bc_user_info @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__bc_user_info.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.061371, "compiled_code": "\nSELECT\n    user_id\n  , user_name\n  , nick\n  , gender\n  , group_id\n  , login_pwd\n  , trade_pwd\n  , security_type\n  , sign_org\n  , cert_type\n  , cert_name\n  , cert_code\n  , cert_issued_date\n  , cert_issued_place\n  , telephone\n  , mobile\n  , fax\n  , address\n  , postal_code\n  , email\n  , open_acct_stmt\n  , acct_stmt_frq\n  , acct_stmt_method\n  , open_mobile\n  , service_type\n  , receive_sms_adv\n  , remark\n  , create_by\n  , create_by_mng\n  , create_time\n  , update_by\n  , update_by_mng\n  , update_time\n  , status\n  , freezed_start_time\n  , freezed_end_time\n  , login_count\n  , is_online\n  , is_pwd_changed\n  , CAST(customer_number AS number) AS customer_number\n  , cif_acct_name\n  , open_ibs\n  , open_mbs\n  , open_sms\n  , group_id_mbs\n  , group_id_sms\n  , mobile_mbs\n  , mobile_sms\n  , region_code\n  , brand_code\n  , login_flag\n  , token_no\n  , token_exp\n  , transaction\n  , img_profile\n  , is_first_exp\n  , noti_pwd\n  , lasttime_pwd_changed\n  , security_type_mb\n  , open_sms_bdsd\n  , etl_date\nFROM\n  oracle_bulanding.df_2.bc_user_info @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__bc_user_info"}, "model.dga_data_model.stg_landing__card_acnt_contract": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_acnt_contract @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_acnt_contract"], "unique_id": "model.dga_data_model.stg_landing__card_acnt_contract", "raw_code": "{{\r\n  config(\r\n    materialized='view',\r\n  )\r\n}}\r\nSELECT \r\n  amnd_date\r\n  , amnd_state\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , pcat\r\n  , con_cat\r\n  , terminal_category\r\n  , ccat\r\n  , f_i\r\n  , branch\r\n  , service_group\r\n  , contract_number\r\n  , contract_name\r\n  , comment_text\r\n  , base_relation\r\n  , relation_tag\r\n  , acnt_contract__id\r\n  , contr_type\r\n  , contr_subtype__id\r\n  , serv_pack__id\r\n  , old_pack\r\n  , channel\r\n  , acc_scheme__id\r\n  , old_scheme\r\n  , product_code\r\n  , product_prev\r\n  , parent_product\r\n  , main_product\r\n  , customer_id AS client_id\r\n  , client_type\r\n  , acnt_contract__oid\r\n  , liab_category\r\n  , liab_contract\r\n  , liab_contract_prev\r\n  , behavior_group\r\n  , behavior_type\r\n  , behavior_type_prev\r\n  , check_available\r\n  , check_usage\r\n  , curr\r\n  , old_curr\r\n  , auth_limit_amount\r\n  , base_auth_limit\r\n  , liab_balance\r\n  , liab_blocked\r\n  , own_balance\r\n  , own_blocked\r\n  , sub_balance\r\n  , sub_blocked\r\n  , total_blocked_amount\r\n  , total_balance\r\n  , shared_balance\r\n  , shared_blocked\r\n  , amount_available\r\n  , date_open\r\n  , date_expire\r\n  , last_billing_date\r\n  , next_billing_date\r\n  , last_scan\r\n  , card_expire\r\n  , production_status\r\n  , rbs_member_id\r\n  , rbs_number\r\n  , is_number(rbs_number) AS casa_account_number\r\n  , report_type\r\n  , max_pin_attempts\r\n  , failed_pin_attemps\r\n  , chip_scheme\r\n  , risk_scheme\r\n  , risk_factor\r\n  , risk_factor_prev\r\n  , contract_status\r\n  , merchant_id\r\n  , tr_title\r\n  , tr_company\r\n  , tr_country\r\n  , tr_first_nam\r\n  , tr_last_nam\r\n  , tr_sic\r\n  , add_info_01\r\n  , add_info_02\r\n  , add_info_03\r\n  , add_info_04\r\n  , regexp_substr(add_info_01, 'USLPA([^USLPA]*)$', 1, 1, NULL, 1) AS bpm_loan_id\r\n  , regexp_substr(add_info_01, '\\[(.*?)\\]', 1, 1, NULL, 1) AS los_id\r\n  , contract_level\r\n  , ext_data\r\n  , report_address\r\n  , share_balance\r\n  , is_multycurrency\r\n  , enables_item\r\n  , cycle_length\r\n  , interval_type\r\n  , status_category\r\n  , limit_is_active\r\n  , settlement_type\r\n  , is_ready\r\n  , billing_contract\r\n  , credit_limit\r\n  , etl_date\r\n  , CASE\r\n      WHEN add_info_04 IN ( 'cardhub', 'DFCJ2' ) THEN upper(to_char(add_info_04))\r\n      WHEN add_info_04 LIKE '%LOS%DF%' THEN 'DFLOS'\r\n    END AS card_sales_channel\r\nFROM \r\n  {{ source('daily_bulanding', 'card_acnt_contract @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_acnt_contract.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_acnt_contract.sql", "name": "stg_landing__card_acnt_contract", "alias": "stg_landing__card_acnt_contract", "checksum": {"name": "sha256", "checksum": "383146ba0582a596a538c7d997f1f3d2a54a4ec1a4ee6da81171a4e53a3631e9"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_acnt_contract @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_acnt_contract.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.069296, "compiled_code": "\nSELECT \n  amnd_date\n  , amnd_state\n  , amnd_officer\n  , amnd_prev\n  , id\n  , pcat\n  , con_cat\n  , terminal_category\n  , ccat\n  , f_i\n  , branch\n  , service_group\n  , contract_number\n  , contract_name\n  , comment_text\n  , base_relation\n  , relation_tag\n  , acnt_contract__id\n  , contr_type\n  , contr_subtype__id\n  , serv_pack__id\n  , old_pack\n  , channel\n  , acc_scheme__id\n  , old_scheme\n  , product_code\n  , product_prev\n  , parent_product\n  , main_product\n  , customer_id AS client_id\n  , client_type\n  , acnt_contract__oid\n  , liab_category\n  , liab_contract\n  , liab_contract_prev\n  , behavior_group\n  , behavior_type\n  , behavior_type_prev\n  , check_available\n  , check_usage\n  , curr\n  , old_curr\n  , auth_limit_amount\n  , base_auth_limit\n  , liab_balance\n  , liab_blocked\n  , own_balance\n  , own_blocked\n  , sub_balance\n  , sub_blocked\n  , total_blocked_amount\n  , total_balance\n  , shared_balance\n  , shared_blocked\n  , amount_available\n  , date_open\n  , date_expire\n  , last_billing_date\n  , next_billing_date\n  , last_scan\n  , card_expire\n  , production_status\n  , rbs_member_id\n  , rbs_number\n  , is_number(rbs_number) AS casa_account_number\n  , report_type\n  , max_pin_attempts\n  , failed_pin_attemps\n  , chip_scheme\n  , risk_scheme\n  , risk_factor\n  , risk_factor_prev\n  , contract_status\n  , merchant_id\n  , tr_title\n  , tr_company\n  , tr_country\n  , tr_first_nam\n  , tr_last_nam\n  , tr_sic\n  , add_info_01\n  , add_info_02\n  , add_info_03\n  , add_info_04\n  , regexp_substr(add_info_01, 'USLPA([^USLPA]*)$', 1, 1, NULL, 1) AS bpm_loan_id\n  , regexp_substr(add_info_01, '\\[(.*?)\\]', 1, 1, NULL, 1) AS los_id\n  , contract_level\n  , ext_data\n  , report_address\n  , share_balance\n  , is_multycurrency\n  , enables_item\n  , cycle_length\n  , interval_type\n  , status_category\n  , limit_is_active\n  , settlement_type\n  , is_ready\n  , billing_contract\n  , credit_limit\n  , etl_date\n  , CASE\n      WHEN add_info_04 IN ( 'cardhub', 'DFCJ2' ) THEN upper(to_char(add_info_04))\n      WHEN add_info_04 LIKE '%LOS%DF%' THEN 'DFLOS'\n    END AS card_sales_channel\nFROM \n  oracle_bulanding.df_2.card_acnt_contract @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract"}, "model.dga_data_model.stg_landing__card_add_data": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_add_data @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_add_data"], "unique_id": "model.dga_data_model.stg_landing__card_add_data", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    amend_date\r\n  , amend_officer\r\n  , amnd_prev\r\n  , amnd_state\r\n  , add_data_col__id\r\n  , for_id\r\n  , add_data_tab\r\n  , id\r\n  , current_value\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'card_add_data @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_add_data.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_add_data.sql", "name": "stg_landing__card_add_data", "alias": "stg_landing__card_add_data", "checksum": {"name": "sha256", "checksum": "ced6d10bf0be0057108e368f050fdad739c92c49d113893098446a26c545bb68"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_add_data @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_add_data.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0713344, "compiled_code": "\nSELECT\n    amend_date\n  , amend_officer\n  , amnd_prev\n  , amnd_state\n  , add_data_col__id\n  , for_id\n  , add_data_tab\n  , id\n  , current_value\n  , etl_date\nFROM\n  oracle_bulanding.df_2.card_add_data @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_add_data"}, "model.dga_data_model.stg_landing__card_appl_product": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_appl_product @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_appl_product"], "unique_id": "model.dga_data_model.stg_landing__card_appl_product", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , name\r\n  , product_code\r\n  , code_2\r\n  , code_3\r\n  , internal_code\r\n  , f_i\r\n  , ccat\r\n  , pcat\r\n  , con_cat\r\n  , contr_type\r\n  , contr_subtype\r\n  , base_relation\r\n  , check_available\r\n  , check_usage\r\n  , liab_category\r\n  , acc_scheme\r\n  , max_credit_limit\r\n  , min_credit_limit\r\n  , default_credit_limit\r\n  , report_type\r\n  , serv_pack_type\r\n  , service_pack\r\n  , scoring_model\r\n  , tariff_domain\r\n  , tariff_domain_template\r\n  , copy_from_product\r\n  , custom_data\r\n  , is_active\r\n  , n_contracts\r\n  , appl_product__oid\r\n  , parent_code\r\n  , reporting_product\r\n  , main_product\r\n  , appl_pr_group__id\r\n  , product_group\r\n  , product_status\r\n  , is_ready\r\n  , date_from\r\n  , date_to\r\n  , client_type\r\n  , contract_role\r\n  , icon\r\n  , product_template\r\n  , base_product\r\n  , date_scheme\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'card_appl_product @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_appl_product.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_appl_product.sql", "name": "stg_landing__card_appl_product", "alias": "stg_landing__card_appl_product", "checksum": {"name": "sha256", "checksum": "035f8d3ead22eb67e964814f22e8664202d7cff29d787af0b9423c57c8839e79"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_appl_product @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_appl_product.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0743754, "compiled_code": "\nSELECT \n    amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , name\n  , product_code\n  , code_2\n  , code_3\n  , internal_code\n  , f_i\n  , ccat\n  , pcat\n  , con_cat\n  , contr_type\n  , contr_subtype\n  , base_relation\n  , check_available\n  , check_usage\n  , liab_category\n  , acc_scheme\n  , max_credit_limit\n  , min_credit_limit\n  , default_credit_limit\n  , report_type\n  , serv_pack_type\n  , service_pack\n  , scoring_model\n  , tariff_domain\n  , tariff_domain_template\n  , copy_from_product\n  , custom_data\n  , is_active\n  , n_contracts\n  , appl_product__oid\n  , parent_code\n  , reporting_product\n  , main_product\n  , appl_pr_group__id\n  , product_group\n  , product_status\n  , is_ready\n  , date_from\n  , date_to\n  , client_type\n  , contract_role\n  , icon\n  , product_template\n  , base_product\n  , date_scheme\n  , etl_date\nFROM \n  oracle_bulanding.df_2.card_appl_product @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_appl_product"}, "model.dga_data_model.stg_landing__card_client": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_client @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_client"], "unique_id": "model.dga_data_model.stg_landing__card_client", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , f_i\r\n  , branch_code\r\n  , ccat\r\n  , pcat\r\n  , clt\r\n  , service_group\r\n  , customer_shortname\r\n  , title\r\n  , first_nam\r\n  , last_nam\r\n  , birth_nam\r\n  , security_check_quiz\r\n  , birth_date\r\n  , birth_place\r\n  , father_s_nam\r\n  , company_represent_name\r\n  , trade_nam\r\n  , enable_affiliation\r\n  , affiliated_with\r\n  , reg_number_type\r\n  , customer_register_number AS customer_register_number_original\r\n  , regexp_replace(customer_register_number, '[^0-9A-Za-z]', '') AS customer_register_number\r\n  , register_location\r\n  , affiliation_type\r\n  , customer_code AS customer_code_original\r\n  , is_number(regexp_replace(customer_code, '[^0-9A-Za-z]', '')) AS customer_code\r\n  , itn\r\n  , tax_position\r\n  , country\r\n  , state\r\n  , city\r\n  , address_zip\r\n  , address_line_1\r\n  , address_line_2\r\n  , address_line_3\r\n  , address_line_4\r\n  , phone\r\n  , phone_home\r\n  , phone_mobile\r\n  , fax\r\n  , fax_home\r\n  , e_mail\r\n  , delivery_type\r\n  , date_expire\r\n  , date_open\r\n  , gender\r\n  , language\r\n  , marital_status\r\n  , profession\r\n  , tr_title\r\n  , tr_first_nam\r\n  , tr_last_nam\r\n  , tr_company_nam\r\n  , add_date_01\r\n  , add_date_02\r\n  , add_info_01\r\n  , add_info_02\r\n  , add_info_03\r\n  , add_info_04\r\n  , is_ready\r\n  , citizenship\r\n  , url\r\n  , company_department\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'card_client @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_client.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_client.sql", "name": "stg_landing__card_client", "alias": "stg_landing__card_client", "checksum": {"name": "sha256", "checksum": "211152c40dc73c2dd73d8f1f1bce63b13a8d469a9352051ccffa28f4b7b3a280"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_client @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_client.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0773652, "compiled_code": "\nSELECT \n    amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , f_i\n  , branch_code\n  , ccat\n  , pcat\n  , clt\n  , service_group\n  , customer_shortname\n  , title\n  , first_nam\n  , last_nam\n  , birth_nam\n  , security_check_quiz\n  , birth_date\n  , birth_place\n  , father_s_nam\n  , company_represent_name\n  , trade_nam\n  , enable_affiliation\n  , affiliated_with\n  , reg_number_type\n  , customer_register_number AS customer_register_number_original\n  , regexp_replace(customer_register_number, '[^0-9A-Za-z]', '') AS customer_register_number\n  , register_location\n  , affiliation_type\n  , customer_code AS customer_code_original\n  , is_number(regexp_replace(customer_code, '[^0-9A-Za-z]', '')) AS customer_code\n  , itn\n  , tax_position\n  , country\n  , state\n  , city\n  , address_zip\n  , address_line_1\n  , address_line_2\n  , address_line_3\n  , address_line_4\n  , phone\n  , phone_home\n  , phone_mobile\n  , fax\n  , fax_home\n  , e_mail\n  , delivery_type\n  , date_expire\n  , date_open\n  , gender\n  , language\n  , marital_status\n  , profession\n  , tr_title\n  , tr_first_nam\n  , tr_last_nam\n  , tr_company_nam\n  , add_date_01\n  , add_date_02\n  , add_info_01\n  , add_info_02\n  , add_info_03\n  , add_info_04\n  , is_ready\n  , citizenship\n  , url\n  , company_department\n  , etl_date\nFROM \n  oracle_bulanding.df_2.card_client @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_client"}, "model.dga_data_model.stg_landing__card_contr_status": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_contr_status @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_contr_status"], "unique_id": "model.dga_data_model.stg_landing__card_contr_status", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , con_cat\r\n  , name\r\n  , code\r\n  , external_code\r\n  , is_valid\r\n  , action_type\r\n  , restriction_code\r\n  , priority_code\r\n  , fraud_type\r\n  , auth_rc\r\n  , code_parms\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'card_contr_status @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_contr_status.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_contr_status.sql", "name": "stg_landing__card_contr_status", "alias": "stg_landing__card_contr_status", "checksum": {"name": "sha256", "checksum": "55124869ef4e6bd91437c73b2f70b63509e9c53455f24f032e3c65119c1f3b58"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_contr_status @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_contr_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0793798, "compiled_code": "\nSELECT \n  amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , con_cat\n  , name\n  , code\n  , external_code\n  , is_valid\n  , action_type\n  , restriction_code\n  , priority_code\n  , fraud_type\n  , auth_rc\n  , code_parms\n  , etl_date\nFROM \n  oracle_bulanding.df_2.card_contr_status @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_contr_status"}, "model.dga_data_model.stg_landing__card_currency": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_currency @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_currency"], "unique_id": "model.dga_data_model.stg_landing__card_currency", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , name\r\n  , code\r\n  , full_name\r\n  , exponent\r\n  , fx_range\r\n  , use_in_bank\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'card_currency @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_currency.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_currency.sql", "name": "stg_landing__card_currency", "alias": "stg_landing__card_currency", "checksum": {"name": "sha256", "checksum": "3c4eff3fda2f6753d862079dd849699cf82aac428f486977d650b7e7eeedbc3b"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_currency @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_currency.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1153548, "compiled_code": "\nSELECT\n  amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , name\n  , code\n  , full_name\n  , exponent\n  , fx_range\n  , use_in_bank\n  , etl_date\nFROM\n  oracle_bulanding.df_2.card_currency @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_currency"}, "model.dga_data_model.stg_landing__card_doc": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_doc @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_doc"], "unique_id": "model.dga_data_model.stg_landing__card_doc", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  acq_ref_number\r\n  , action\r\n  , amnd_date\r\n  , amendment_officer\r\n  , amnd_state\r\n  , auth_code\r\n  , card_expire\r\n  , card_seqv_number\r\n  , fx_settl_date\r\n  , is_authorization\r\n  , iss_ref_number\r\n  , merchant_id\r\n  , message_category\r\n  , number_of_sub_s\r\n  , nw_ref_date\r\n  , doc__orig__id\r\n  , outward_status\r\n  , posting_date\r\n  , posting_status\r\n  , doc__prev__id\r\n  , amnd_prev\r\n  , ps_ref_number\r\n  , reason_code\r\n  , reason_details\r\n  , rec_member_id\r\n  , recons_amount\r\n  , recons_curr\r\n  , id\r\n  , request_category\r\n  , requirement\r\n  , ret_ref_number\r\n  , return_code\r\n  , sec_trans_cond_att\r\n  , sec_trans_date\r\n  , sending_bin\r\n  , send_member_id\r\n  , service_class\r\n  , settlement_amount\r\n  , settlement_currency\r\n  , sic_code\r\n  , source_acc_type\r\n  , s_cat\r\n  , source_channel\r\n  , source_code\r\n  , source_contract\r\n  , source_fee_amount\r\n  , source_fee_code\r\n  , source_fee_curr\r\n  , source_member_id\r\n  , source_number\r\n  , source_reg_num\r\n  , source_spc\r\n  , doc__summ__id\r\n  , target_acc_type\r\n  , target_bin_id\r\n  , t_cat\r\n  , target_channel\r\n  , target_code\r\n  , target_contract\r\n  , target_fee_amount\r\n  , target_fee_code\r\n  , target_fee_curr\r\n  , target_member_id\r\n  , target_number\r\n  , target_spc\r\n  , transaction_amount\r\n  , transaction_city\r\n  , trans_cond_attr\r\n  , trans_condition\r\n  , transaction_country\r\n  , transaction_currency\r\n  , transaction_date\r\n  , transaction_location\r\n  , trans_state\r\n  , partition_key\r\n  , transaction_type\r\n  , synch_tag\r\n  , add_info\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'card_doc @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_doc.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_doc.sql", "name": "stg_landing__card_doc", "alias": "stg_landing__card_doc", "checksum": {"name": "sha256", "checksum": "8204f3e3441bc31574c497e2751be45375383de9e9bc55fdac7fab8b9e885b1e"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_doc @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_doc.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1153548, "compiled_code": "\nSELECT\n  acq_ref_number\n  , action\n  , amnd_date\n  , amendment_officer\n  , amnd_state\n  , auth_code\n  , card_expire\n  , card_seqv_number\n  , fx_settl_date\n  , is_authorization\n  , iss_ref_number\n  , merchant_id\n  , message_category\n  , number_of_sub_s\n  , nw_ref_date\n  , doc__orig__id\n  , outward_status\n  , posting_date\n  , posting_status\n  , doc__prev__id\n  , amnd_prev\n  , ps_ref_number\n  , reason_code\n  , reason_details\n  , rec_member_id\n  , recons_amount\n  , recons_curr\n  , id\n  , request_category\n  , requirement\n  , ret_ref_number\n  , return_code\n  , sec_trans_cond_att\n  , sec_trans_date\n  , sending_bin\n  , send_member_id\n  , service_class\n  , settlement_amount\n  , settlement_currency\n  , sic_code\n  , source_acc_type\n  , s_cat\n  , source_channel\n  , source_code\n  , source_contract\n  , source_fee_amount\n  , source_fee_code\n  , source_fee_curr\n  , source_member_id\n  , source_number\n  , source_reg_num\n  , source_spc\n  , doc__summ__id\n  , target_acc_type\n  , target_bin_id\n  , t_cat\n  , target_channel\n  , target_code\n  , target_contract\n  , target_fee_amount\n  , target_fee_code\n  , target_fee_curr\n  , target_member_id\n  , target_number\n  , target_spc\n  , transaction_amount\n  , transaction_city\n  , trans_cond_attr\n  , trans_condition\n  , transaction_country\n  , transaction_currency\n  , transaction_date\n  , transaction_location\n  , trans_state\n  , partition_key\n  , transaction_type\n  , synch_tag\n  , add_info\n  , etl_date\nFROM\n  oracle_bulanding.df_2.card_doc @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_doc"}, "model.dga_data_model.stg_landing__card_f_i": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_f_i @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_f_i"], "unique_id": "model.dga_data_model.stg_landing__card_f_i", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , name\r\n  , bank_code\r\n  , branch_code\r\n  , calendar_type\r\n  , cb_code\r\n  , country\r\n  , cr_lim_posting\r\n  , days_in_year\r\n  , deposit_contract\r\n  , expence_percent\r\n  , ext_local_date\r\n  , fx_in_ho\r\n  , interest_in_cycle\r\n  , last_scan\r\n  , liab_contract\r\n  , local_currency\r\n  , local_date\r\n  , min_deposit\r\n  , mirror_scheme\r\n  , numeration_scheme\r\n  , parent_fi\r\n  , prnt_routing\r\n  , post_due\r\n  , posting_in\r\n  , special_parms\r\n  , sundry_contract\r\n  , tariff_domain\r\n  , time_zone\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'card_f_i @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_f_i.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_f_i.sql", "name": "stg_landing__card_f_i", "alias": "stg_landing__card_f_i", "checksum": {"name": "sha256", "checksum": "d8d70d3421f688e3ac5eccff449b9889ab81a226f2b01181f417a72fc885a348"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_f_i @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_f_i.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0813668, "compiled_code": "\nSELECT \n    amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , name\n  , bank_code\n  , branch_code\n  , calendar_type\n  , cb_code\n  , country\n  , cr_lim_posting\n  , days_in_year\n  , deposit_contract\n  , expence_percent\n  , ext_local_date\n  , fx_in_ho\n  , interest_in_cycle\n  , last_scan\n  , liab_contract\n  , local_currency\n  , local_date\n  , min_deposit\n  , mirror_scheme\n  , numeration_scheme\n  , parent_fi\n  , prnt_routing\n  , post_due\n  , posting_in\n  , special_parms\n  , sundry_contract\n  , tariff_domain\n  , time_zone\n  , etl_date\nFROM \n  oracle_bulanding.df_2.card_f_i @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_f_i"}, "model.dga_data_model.stg_landing__card_m_transaction": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.card_m_transaction @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__card_m_transaction"], "unique_id": "model.dga_data_model.stg_landing__card_m_transaction", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  id\r\n  , posting_date\r\n  , local_date\r\n  , due_date\r\n  , posting_db_date\r\n  , portion\r\n  , posting_status\r\n  , f_i\r\n  , entry_type\r\n  , request_cat\r\n  , service_class\r\n  , trans_subtype\r\n  , direction\r\n  , trans_code\r\n  , trans_curr\r\n  , trans_amount\r\n  , fx_seqv_n\r\n  , local_amount\r\n  , source_account\r\n  , s_amount\r\n  , s_fee_amount\r\n  , source_code\r\n  , source_service\r\n  , target_account\r\n  , t_amount\r\n  , fee_amount\r\n  , target_code\r\n  , target_service\r\n  , mtr_details\r\n  , m_transaction__oid\r\n  , doc__oid\r\n  , contract\r\n  , partition_key\r\n  , hash__id\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'card_m_transaction @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__card_m_transaction.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__card_m_transaction.sql", "name": "stg_landing__card_m_transaction", "alias": "stg_landing__card_m_transaction", "checksum": {"name": "sha256", "checksum": "3552be681f138232dae51b10d794d25f1dad633c60c7e2f2daf08a9842395e1a"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "card_m_transaction @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__card_m_transaction.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1163378, "compiled_code": "\nSELECT\n  id\n  , posting_date\n  , local_date\n  , due_date\n  , posting_db_date\n  , portion\n  , posting_status\n  , f_i\n  , entry_type\n  , request_cat\n  , service_class\n  , trans_subtype\n  , direction\n  , trans_code\n  , trans_curr\n  , trans_amount\n  , fx_seqv_n\n  , local_amount\n  , source_account\n  , s_amount\n  , s_fee_amount\n  , source_code\n  , source_service\n  , target_account\n  , t_amount\n  , fee_amount\n  , target_code\n  , target_service\n  , mtr_details\n  , m_transaction__oid\n  , doc__oid\n  , contract\n  , partition_key\n  , hash__id\n  , etl_date\nFROM\n  oracle_bulanding.df_2.card_m_transaction @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__card_m_transaction"}, "model.dga_data_model.stg_landing__customer_address": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index"], "nodes": ["source.dga_data_model.daily_bulanding.customer_address @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index( this, \"customer_number\") }}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__customer_address"], "unique_id": "model.dga_data_model.stg_landing__customer_address", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    post_hook= '{{ create_index( this, \"customer_number\") }}'\r\n  )\r\n}}\r\nWITH cus_add AS (\r\n  SELECT\r\n      a.cfadid\r\n    , a.customer_number\r\n    , a.cfadsq AS seq_number\r\n    , a.cfadfm\r\n    , a.cfadtp AS address_type\r\n    , a.customer_address_2\r\n    , a.customer_address_3\r\n    , a.customer_address_4\r\n    , a.customer_address_5\r\n    , a.customer_address_6\r\n    , a.customer_address_7\r\n    , a.cfforn\r\n    , a.cfbada\r\n    , a.cfabnm\r\n    , a.cfasty\r\n    , a.cfaunm\r\n    , a.cfabox\r\n    , a.cfabdn\r\n    , a.cfastn\r\n    , a.cfcity\r\n    , a.cfstat\r\n    , a.cfzip\r\n    , a.cfcoun\r\n    , a.cfalv7\r\n    , a.cfalv6\r\n    , a.cfadlm\r\n    , a.cfadl6\r\n    , a.cfatim\r\n    , a.cfarmk\r\n    , a.cfalid\r\n    , a.etl_date\r\n    , fnc_remove_null_text(a.customer_address_2) AS customer_address_line_1\r\n    , fnc_remove_null_text(a.customer_address_3) AS customer_address_line_2\r\n    , fnc_remove_null_text(a.customer_address_4) AS customer_address_line_3\r\n    , fnc_remove_null_text(a.customer_address_5) AS customer_address_line_4\r\n    , TRIM(fnc_remove_null_text(a.customer_address_7)) AS permanent_address_city_name\r\n    , fnc_remove_null_text(a.cfstat) AS permanent_address_city_code\r\n    , fnc_remove_null_text(a.cfcoun) AS permanent_address_country\r\n    , ROW_NUMBER()\r\n        OVER(PARTITION BY a.customer_number\r\n              ORDER BY\r\n                  a.cfadsq DESC\r\n        ) AS rn\r\n  FROM\r\n    {{ source('daily_bulanding', 'customer_address @DGA_READ_BULANDING_DBL') }}  a\r\n  WHERE\r\n    a.cfadtp IS NULL -- 90% is null\r\n    OR a.cfadtp IN ( '2', '5', '7' ) -- ADDRESS_TYPE_DESC IN DF_CUSTOMER_ADDRESS_TYPE TABLE\r\n)\r\nSELECT \r\n  *\r\nFROM \r\n  cus_add\r\nWHERE \r\n  rn = 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__customer_address.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__customer_address.sql", "name": "stg_landing__customer_address", "alias": "stg_landing__customer_address", "checksum": {"name": "sha256", "checksum": "0ee5e3f71dd03b6a5adf92f80abe201dad87f172f082215061d52590877284cb"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "customer_address @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__customer_address.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "table", "post-hook": ["{{ create_index( this, \"customer_number\") }}"]}, "created_at": 1685959753.0862958, "compiled_code": "\nWITH cus_add AS (\n  SELECT\n      a.cfadid\n    , a.customer_number\n    , a.cfadsq AS seq_number\n    , a.cfadfm\n    , a.cfadtp AS address_type\n    , a.customer_address_2\n    , a.customer_address_3\n    , a.customer_address_4\n    , a.customer_address_5\n    , a.customer_address_6\n    , a.customer_address_7\n    , a.cfforn\n    , a.cfbada\n    , a.cfabnm\n    , a.cfasty\n    , a.cfaunm\n    , a.cfabox\n    , a.cfabdn\n    , a.cfastn\n    , a.cfcity\n    , a.cfstat\n    , a.cfzip\n    , a.cfcoun\n    , a.cfalv7\n    , a.cfalv6\n    , a.cfadlm\n    , a.cfadl6\n    , a.cfatim\n    , a.cfarmk\n    , a.cfalid\n    , a.etl_date\n    , fnc_remove_null_text(a.customer_address_2) AS customer_address_line_1\n    , fnc_remove_null_text(a.customer_address_3) AS customer_address_line_2\n    , fnc_remove_null_text(a.customer_address_4) AS customer_address_line_3\n    , fnc_remove_null_text(a.customer_address_5) AS customer_address_line_4\n    , TRIM(fnc_remove_null_text(a.customer_address_7)) AS permanent_address_city_name\n    , fnc_remove_null_text(a.cfstat) AS permanent_address_city_code\n    , fnc_remove_null_text(a.cfcoun) AS permanent_address_country\n    , ROW_NUMBER()\n        OVER(PARTITION BY a.customer_number\n              ORDER BY\n                  a.cfadsq DESC\n        ) AS rn\n  FROM\n    oracle_bulanding.df_2.customer_address @DGA_READ_BULANDING_DBL  a\n  WHERE\n    a.cfadtp IS NULL -- 90% is null\n    OR a.cfadtp IN ( '2', '5', '7' ) -- ADDRESS_TYPE_DESC IN DF_CUSTOMER_ADDRESS_TYPE TABLE\n)\nSELECT \n  *\nFROM \n  cus_add\nWHERE \n  rn = 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__customer_address"}, "model.dga_data_model.stg_landing__customer_connection": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.customer_connection @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__customer_connection"], "unique_id": "model.dga_data_model.stg_landing__customer_connection", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    customer_number\r\n  , customer_type\r\n  , cfzseq AS seq_number\r\n  , customer_address_type\r\n  , fnc_remove_null_text(customer_email) AS customer_email\r\n  , cfeafm\r\n  , cfean1\r\n  , cfedep\r\n  , cfejob\r\n  , cfadlm\r\n  , cfadl6\r\n  , cfatim\r\n  , cfcifn\r\n  , is_date_yyyyddd(etl_date) AS etl_date\r\n  , is_date_yyyyddd(cfadlm) AS created_date\r\nFROM \r\n  {{ source('daily_bulanding', 'customer_connection @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__customer_connection.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__customer_connection.sql", "name": "stg_landing__customer_connection", "alias": "stg_landing__customer_connection", "checksum": {"name": "sha256", "checksum": "ce8b40b82ed89ade10f91f21078e4da63ad4a789c50f1c0d013c45bc181b9f78"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "customer_connection @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__customer_connection.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0882971, "compiled_code": "\nSELECT\n    customer_number\n  , customer_type\n  , cfzseq AS seq_number\n  , customer_address_type\n  , fnc_remove_null_text(customer_email) AS customer_email\n  , cfeafm\n  , cfean1\n  , cfedep\n  , cfejob\n  , cfadlm\n  , cfadl6\n  , cfatim\n  , cfcifn\n  , is_date_yyyyddd(etl_date) AS etl_date\n  , is_date_yyyyddd(cfadlm) AS created_date\nFROM \n  oracle_bulanding.df_2.customer_connection @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__customer_connection"}, "model.dga_data_model.stg_landing__customer_job_infomation": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.customer_job_infomation @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__customer_job_infomation"], "unique_id": "model.dga_data_model.stg_landing__customer_job_infomation", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  cfbust\r\n  , cfsina AS industry_name\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'customer_job_infomation @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__customer_job_infomation.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__customer_job_infomation.sql", "name": "stg_landing__customer_job_infomation", "alias": "stg_landing__customer_job_infomation", "checksum": {"name": "sha256", "checksum": "c2911ec613a9990b233367513ae60052be9e628a06ef18217d7254a9a3c76b01"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "customer_job_infomation @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__customer_job_infomation.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0902967, "compiled_code": "\nSELECT \n  cfbust\n  , cfsina AS industry_name\n  , etl_date\nFROM \n  oracle_bulanding.df_2.customer_job_infomation @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__customer_job_infomation"}, "model.dga_data_model.stg_landing__customer_marital_status": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.customer_marital_status @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__customer_marital_status"], "unique_id": "model.dga_data_model.stg_landing__customer_marital_status", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    cfmstc\r\n  , cfmstd AS marital_status_name\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'customer_marital_status @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__customer_marital_status.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__customer_marital_status.sql", "name": "stg_landing__customer_marital_status", "alias": "stg_landing__customer_marital_status", "checksum": {"name": "sha256", "checksum": "026cec9bb22be6600f29ebba77f29466f71937054fea519149fd28aa3f1d1e77"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "customer_marital_status @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__customer_marital_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0922973, "compiled_code": "\nSELECT \n    cfmstc\n  , cfmstd AS marital_status_name\n  , etl_date\nFROM \n  oracle_bulanding.df_2.customer_marital_status @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__customer_marital_status"}, "model.dga_data_model.stg_landing__customer_master001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.customer_master001 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__customer_master001"], "unique_id": "model.dga_data_model.stg_landing__customer_master001", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nWITH df_cus AS (\r\n  SELECT\r\n      identifier\r\n    , retention\r\n    , bank_number\r\n    , branch_number\r\n    , cost_center\r\n    , customer_status\r\n    , customer_code AS customer_number\r\n    , customer_type\r\n    , salutation\r\n    , customer_shortname\r\n    , formatted_short_name\r\n    , customer_fullname_locale\r\n    , customer_fullname_english\r\n    , mother_maiden_name\r\n    , inquiry_code\r\n    , relationship_manager\r\n    , insider_code\r\n    , customer_vip_code\r\n    , hold_mail_code\r\n    , promotional_mail_code\r\n    , profit_analysis\r\n    , banking_division_infor1\r\n    , banking_division_infor2\r\n    , banking_division_infor3\r\n    , banking_division_infor4\r\n    , banking_division_infor5\r\n    , banking_division_infor6\r\n    , banking_division_infor7\r\n    , banking_division_infor8\r\n    , customer_segmentation1\r\n    , customer_segmentation2\r\n    , customer_segmentation3\r\n    , customer_segmentation4\r\n    , customer_segmentation5\r\n    , customer_segmentation6\r\n    , customer_segmentation7\r\n    , customer_segmentation8\r\n    , address_sequence\r\n    , resident_code\r\n    , service_recovery_flag\r\n    , country_of_citizenship\r\n    , residence_bus_oper_cntry_code\r\n    , racecountry_of_heritage\r\n    , religion_code\r\n    , language_identifier\r\n    , name_format\r\n    , customer_title_before_start\r\n    , customer_title_before_length\r\n    , customer_first_name_start\r\n    , customer_first_name_length\r\n    , customer_middle_name_start\r\n    , customer_middle_name_length\r\n    , customer_surname_start\r\n    , customer_surname_length\r\n    , customer_name_suffix\r\n    , customer_name_suffix_length\r\n    , customer_title_after_start\r\n    , customer_title_after_length\r\n    , customer_name_control\r\n    , original_customer_date AS original_contact_date\r\n    , original_date\r\n    , date_of_last_maintenance\r\n    , date_of_last_maintenance2\r\n    , customer_review_date_\r\n    , customer_review_date_ddmmyy\r\n    , customer_register_number\r\n    , id_type_code\r\n    , date_of_birth_ AS original_date_of_birth\r\n    , customer_birthday\r\n    , marital_status_code\r\n    , marital_status_date_\r\n    , marital_status_date_ddmmyy\r\n    , deceased_customer_flag\r\n    , deceaseddissolved_date_\r\n    , deceaseddissolved_date_ddmmyy\r\n    , gender\r\n    , class\r\n    , individual\r\n    , smsa_code\r\n    , business_type\r\n    , sub_class\r\n    , customer_rating\r\n    , customer_group_code\r\n    , customer_combined_cycle\r\n    , fed_wh_code\r\n    , state_wh_code\r\n    , federal_withholding_date_\r\n    , federal_withholding_date\r\n    , user_id\r\n    , workstation_id\r\n    , time\r\n    , customer_sts AS customer_sts_code\r\n    , customer_status_date_ddmmyy\r\n    , customer_status_date_\r\n    , tax_code_id\r\n    , reporting_branch\r\n    , department_code\r\n    , etl_date                                                                     \r\n    , regexp_replace(customer_register_number,  '[^0-9]+',  '') AS customer_register_number_cleansed\r\n    , regexp_replace(tax_code_id,  '[^0-9]+',  '') AS tax_code_cleansed\r\n    , is_valid_tax_code(regexp_replace(customer_register_number,  '[^0-9]+',  '')) AS is_valid_customer_register_number_cleansed\r\n    , is_valid_tax_code(regexp_replace(tax_code_id,  '[^0-9]+',  '')) AS is_valid_tax_code_cleansed\r\n    , fnc_remove_null_text(place_of_birth)    AS place_of_birth\r\n  FROM\r\n    {{ source('daily_bulanding', 'customer_master001 @DGA_READ_BULANDING_DBL') }}\r\n)\r\n, df_cus_decode AS (\r\nSELECT \r\n  dc.*\r\n  , decode(\r\n      dc.is_valid_tax_code_cleansed\r\n      , 1\r\n      , dc.tax_code_cleansed\r\n      , decode(dc.is_valid_customer_register_number_cleansed\r\n      , 1\r\n      , dc.customer_register_number_cleansed\r\n      , NULL)\r\n    ) AS valid_format_tax_code \r\nFROM \r\n  df_cus dc  \r\n)\r\n, df_cus_tax AS (\r\n  SELECT \r\n    dct.*\r\n    , CASE\r\n        WHEN length(dct.valid_format_tax_code) = 13 \r\n          THEN substr(dct.valid_format_tax_code, 1, 10) || '-'|| substr(dct.valid_format_tax_code, 11)\r\n        ELSE dct.valid_format_tax_code\r\n      END AS tax_code_final\r\n    , is_date_yyyyddd(dct.original_date_of_birth) AS date_of_birth\r\n    , is_date_yyyyddd(dct.original_contact_date)  AS contact_date\r\n    , fnc_remove_null_text(dct.place_of_birth)    AS place_of_birth_cleaned\r\n    , is_date_yyyyddd(dct.marital_status_date_)   AS marital_status_date\r\n    , is_date_yyyyddd(dct.customer_status_date_)  AS customer_status_date\r\n    , CASE\r\n        WHEN dct.individual = 'Y' THEN 'RB'\r\n        WHEN dct.individual = 'N' THEN 'EB'\r\n        ELSE 'OTHER'\r\n      END AS division\r\n  FROM \r\n    df_cus_decode dct\r\n)\r\nSELECT \r\n  dct.* \r\nFROM \r\n  df_cus_tax dct", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__customer_master001.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__customer_master001.sql", "name": "stg_landing__customer_master001", "alias": "stg_landing__customer_master001", "checksum": {"name": "sha256", "checksum": "c1e6bcef529cbadae64b5de3e73889a0dfc4eff4db29fe844a6cedc8f42dd29c"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "customer_master001 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__customer_master001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.095297, "compiled_code": "\nWITH df_cus AS (\n  SELECT\n      identifier\n    , retention\n    , bank_number\n    , branch_number\n    , cost_center\n    , customer_status\n    , customer_code AS customer_number\n    , customer_type\n    , salutation\n    , customer_shortname\n    , formatted_short_name\n    , customer_fullname_locale\n    , customer_fullname_english\n    , mother_maiden_name\n    , inquiry_code\n    , relationship_manager\n    , insider_code\n    , customer_vip_code\n    , hold_mail_code\n    , promotional_mail_code\n    , profit_analysis\n    , banking_division_infor1\n    , banking_division_infor2\n    , banking_division_infor3\n    , banking_division_infor4\n    , banking_division_infor5\n    , banking_division_infor6\n    , banking_division_infor7\n    , banking_division_infor8\n    , customer_segmentation1\n    , customer_segmentation2\n    , customer_segmentation3\n    , customer_segmentation4\n    , customer_segmentation5\n    , customer_segmentation6\n    , customer_segmentation7\n    , customer_segmentation8\n    , address_sequence\n    , resident_code\n    , service_recovery_flag\n    , country_of_citizenship\n    , residence_bus_oper_cntry_code\n    , racecountry_of_heritage\n    , religion_code\n    , language_identifier\n    , name_format\n    , customer_title_before_start\n    , customer_title_before_length\n    , customer_first_name_start\n    , customer_first_name_length\n    , customer_middle_name_start\n    , customer_middle_name_length\n    , customer_surname_start\n    , customer_surname_length\n    , customer_name_suffix\n    , customer_name_suffix_length\n    , customer_title_after_start\n    , customer_title_after_length\n    , customer_name_control\n    , original_customer_date AS original_contact_date\n    , original_date\n    , date_of_last_maintenance\n    , date_of_last_maintenance2\n    , customer_review_date_\n    , customer_review_date_ddmmyy\n    , customer_register_number\n    , id_type_code\n    , date_of_birth_ AS original_date_of_birth\n    , customer_birthday\n    , marital_status_code\n    , marital_status_date_\n    , marital_status_date_ddmmyy\n    , deceased_customer_flag\n    , deceaseddissolved_date_\n    , deceaseddissolved_date_ddmmyy\n    , gender\n    , class\n    , individual\n    , smsa_code\n    , business_type\n    , sub_class\n    , customer_rating\n    , customer_group_code\n    , customer_combined_cycle\n    , fed_wh_code\n    , state_wh_code\n    , federal_withholding_date_\n    , federal_withholding_date\n    , user_id\n    , workstation_id\n    , time\n    , customer_sts AS customer_sts_code\n    , customer_status_date_ddmmyy\n    , customer_status_date_\n    , tax_code_id\n    , reporting_branch\n    , department_code\n    , etl_date                                                                     \n    , regexp_replace(customer_register_number,  '[^0-9]+',  '') AS customer_register_number_cleansed\n    , regexp_replace(tax_code_id,  '[^0-9]+',  '') AS tax_code_cleansed\n    , is_valid_tax_code(regexp_replace(customer_register_number,  '[^0-9]+',  '')) AS is_valid_customer_register_number_cleansed\n    , is_valid_tax_code(regexp_replace(tax_code_id,  '[^0-9]+',  '')) AS is_valid_tax_code_cleansed\n    , fnc_remove_null_text(place_of_birth)    AS place_of_birth\n  FROM\n    oracle_bulanding.df_2.customer_master001 @DGA_READ_BULANDING_DBL\n)\n, df_cus_decode AS (\nSELECT \n  dc.*\n  , decode(\n      dc.is_valid_tax_code_cleansed\n      , 1\n      , dc.tax_code_cleansed\n      , decode(dc.is_valid_customer_register_number_cleansed\n      , 1\n      , dc.customer_register_number_cleansed\n      , NULL)\n    ) AS valid_format_tax_code \nFROM \n  df_cus dc  \n)\n, df_cus_tax AS (\n  SELECT \n    dct.*\n    , CASE\n        WHEN length(dct.valid_format_tax_code) = 13 \n          THEN substr(dct.valid_format_tax_code, 1, 10) || '-'|| substr(dct.valid_format_tax_code, 11)\n        ELSE dct.valid_format_tax_code\n      END AS tax_code_final\n    , is_date_yyyyddd(dct.original_date_of_birth) AS date_of_birth\n    , is_date_yyyyddd(dct.original_contact_date)  AS contact_date\n    , fnc_remove_null_text(dct.place_of_birth)    AS place_of_birth_cleaned\n    , is_date_yyyyddd(dct.marital_status_date_)   AS marital_status_date\n    , is_date_yyyyddd(dct.customer_status_date_)  AS customer_status_date\n    , CASE\n        WHEN dct.individual = 'Y' THEN 'RB'\n        WHEN dct.individual = 'N' THEN 'EB'\n        ELSE 'OTHER'\n      END AS division\n  FROM \n    df_cus_decode dct\n)\nSELECT \n  dct.* \nFROM \n  df_cus_tax dct", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__customer_master001"}, "model.dga_data_model.stg_landing__customer_master002": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.customer_master002 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__customer_master002"], "unique_id": "model.dga_data_model.stg_landing__customer_master002", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    customer_sk\r\n  , customer_no AS customer_number\r\n  , country_code\r\n  , customer_type AS biz_line\r\n  , customer_name\r\n  , sector_code_sk\r\n  , identifier_type\r\n  , identifier_no\r\n  , id_issue_place\r\n  , id_issue_date AS original_id_issue_date\r\n  , is_date_yyyyddd(id_issue_date) AS id_issue_date\r\n  , id_expired_date\r\n  , gender\r\n  , birth_place\r\n  , birth_date\r\n  , marital_status\r\n  , marital_date\r\n  , residence\r\n  , address\r\n  , tax_code\r\n  , rating_level\r\n  , officer_id\r\n  , rec_current_ind\r\n  , rec_effective_date\r\n  , customer_name_2\r\n  , original_date\r\n  , vip_code\r\n  , customer_rating_code\r\n  , subbranch_no\r\n  , maker_id\r\n  , branch_code\r\n  , issue_remark AS id_issue_remark\r\n  , individual\r\n  , customer_status\r\n  , customer_status_desc\r\n  , cfinsc\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'customer_master002 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__customer_master002.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__customer_master002.sql", "name": "stg_landing__customer_master002", "alias": "stg_landing__customer_master002", "checksum": {"name": "sha256", "checksum": "26ab4773ebd0d7abf37a73f5567c1e78d7520d9bb901fa394c3a405a28325d4c"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "customer_master002 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__customer_master002.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.097297, "compiled_code": "\nSELECT \n    customer_sk\n  , customer_no AS customer_number\n  , country_code\n  , customer_type AS biz_line\n  , customer_name\n  , sector_code_sk\n  , identifier_type\n  , identifier_no\n  , id_issue_place\n  , id_issue_date AS original_id_issue_date\n  , is_date_yyyyddd(id_issue_date) AS id_issue_date\n  , id_expired_date\n  , gender\n  , birth_place\n  , birth_date\n  , marital_status\n  , marital_date\n  , residence\n  , address\n  , tax_code\n  , rating_level\n  , officer_id\n  , rec_current_ind\n  , rec_effective_date\n  , customer_name_2\n  , original_date\n  , vip_code\n  , customer_rating_code\n  , subbranch_no\n  , maker_id\n  , branch_code\n  , issue_remark AS id_issue_remark\n  , individual\n  , customer_status\n  , customer_status_desc\n  , cfinsc\n  , etl_date\nFROM \n  oracle_bulanding.df_2.customer_master002 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__customer_master002"}, "model.dga_data_model.stg_landing__demanddeposit_master001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.demanddeposit_master001 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__demanddeposit_master001"], "unique_id": "model.dga_data_model.stg_landing__demanddeposit_master001", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  record_id\r\n  , bank_number\r\n  , branch_code\r\n  , reporting_branch\r\n  , account_number\r\n  , account_type\r\n  , currency_type\r\n  , product_code\r\n  , short_name\r\n  , formatted_short_name\r\n  , account_name\r\n  , customer_number\r\n  , officer\r\n  , status\r\n  , account_group_number\r\n  , related_account_group_number\r\n  , close_status\r\n  , class\r\n  , currency_decimals\r\n  , gl_group_code\r\n  , cost_center\r\n  , product_code2\r\n  , stop_code\r\n  , hold_code\r\n  , alert_code\r\n  , special_instruction_code\r\n  , print_interest_check\r\n  , date_opened\r\n  , fnc_convert_date_to_date_id(is_date_yyyyddd(date_opened)) AS open_date\r\n  , date_of_status\r\n  , fnc_convert_date_to_date_id(is_date_yyyyddd(date_of_status)) AS status_date\r\n  , date_entered\r\n  , date_last_overdrawn\r\n  , prior_last_active_date\r\n  , date_last_active\r\n  , date_last_contact\r\n  , date_last_interest_paid\r\n  , date_last_statement\r\n  , date_last_maintenance\r\n  , date_last_deposit\r\n  , date_sc_waive_expires\r\n  -- , open_date\r\n  , date_of_status2\r\n  , date_entered2\r\n  , date_last_overdrawn2\r\n  , prior_last_active_date2\r\n  , date_last_active2\r\n  , date_last_contact2\r\n  , date_last_interest_paid2\r\n  , date_last_statement2\r\n  , date_last_maintenance2\r\n  , date_last_deposit2\r\n  , date_sc_waive_expires2\r\n  , amt_of_last_deposit\r\n  , blocked_amount\r\n  , total_oc_amount\r\n  , total_ocp_amount\r\n  , total_odoc_amount\r\n  , total_mc_amount\r\n  , total_ibt_amount\r\n  , total_llc_amount\r\n  , total_extra_amount\r\n  , total_suspense_amount\r\n  , float_drawing_amount\r\n  , balance\r\n  , yesterday_ledger_balance\r\n  , excess_overdrawn_balance\r\n  , yesterday_excess_overdrawn_bal\r\n  , charged_off_balance\r\n  , previous_statement_balance\r\n  , prev_year_end_ledger_balance\r\n  , minimum_balance\r\n  , maximum_balance\r\n  , collected_balance\r\n  , accrued_od_interest\r\n  , yesterday_accrued_od_interest\r\n  , exs_accrued_today\r\n  , od_accrued_today\r\n  , aggregate_days\r\n  , aggregate_ledger_balance\r\n  , aggregate_collected_balance\r\n  , aggregate_days_ledger_negative\r\n  , agg_negative_ledger_bal\r\n  , agg_days_collected_negative\r\n  , agg_negative_collected_bal\r\n  , min_bal___int_cycle\r\n  , max_bal___int_cycle\r\n  , minimum_balance___m_t_d\r\n  , maximum_balance___m_t_d\r\n  , agg_days___int_cycle\r\n  , agg_ledger_bal___int_cycle\r\n  , agg_collected_bal___int_cycle\r\n  , accrued_interest\r\n  , alternate_accrued_interest\r\n  , int_accrued_today\r\n  , ytd_interest_paid\r\n  , ytd_interest_charged\r\n  , previous_ytd_interest_paid\r\n  , amt_of_last_int_pd\r\n  , int_paid_today\r\n  , od_intcapitalised_today\r\n  , od_intcapitalised_today2\r\n  , statement_cycle\r\n  , statement_code\r\n  , interest_cycle\r\n  , service_charge_cycle\r\n  , service_charge_mode\r\n  , user_code\r\n  , user_code_2\r\n  , user_code_3\r\n  , user_code_4\r\n  , user_code_5\r\n  , user_code_6\r\n  , user_code_7\r\n  , user_code_8\r\n  , number_of_debits\r\n  , amount_of_debits\r\n  , number_of_credits\r\n  , amount_of_credits\r\n  , number_sc_debits\r\n  , amount_sc_debits\r\n  , number_sc_credits\r\n  , amount_sc_credits\r\n  , number_of_debits2\r\n  , amount_of_debits2\r\n  , number_of_credits2\r\n  , amount_of_credits2\r\n  , number_sc_debits2\r\n  , amount_sc_debits2\r\n  , number_sc_credits2\r\n  , amount_sc_credits2\r\n  , no_of_on_us__atm_credits\r\n  , amt_of_o_nus_atm_credits\r\n  , no_of_on_us__atm_debits\r\n  , amt_of_on_us_atm_debits\r\n  , no_of_frgn__atm_credits\r\n  , amt_of_frgn_atm_credits\r\n  , no_of_frgn__atm_debits\r\n  , amt_of_frgn_atm_debits\r\n  , number_of_deposit_days\r\n  , amount_of_nsf_items\r\n  , overdraft_limit_code\r\n  , signature_verification\r\n  , overdraft_protection\r\n  , valid_for_check_book\r\n  , atm_card\r\n  , include_on_combined_statement\r\n  , hold_mail_code\r\n  , automatic_nsf_charge\r\n  , high_volume_account\r\n  , bad_check_incident\r\n  , times_od_this_cycle\r\n  , times_od_this_qtr\r\n  , times_od_2nd_qtr\r\n  , times_od_3rd_qtr\r\n  , times_od_4th_qtr\r\n  , times_od_last_year\r\n  , times_od_life_to_date\r\n  , related_account_no\r\n  , related_account_type\r\n  , no_cks_deposit_on_us\r\n  , no_cks_deposit_foreign\r\n  , list_post_code\r\n  , interest_rate_no\r\n  , interest_rate\r\n  , credit_rate_flag\r\n  , rate_variance\r\n  , rate_variance_code\r\n  , rate_floor\r\n  , rate_ceiling\r\n  , rate_review_date\r\n  , rate_review_date2\r\n  , rate_review_term\r\n  , rate_review_term_code\r\n  , excess_intrate_no\r\n  , excess_interest_rate\r\n  , excess_rate_flag\r\n  , excess_rate_variance\r\n  , excess_rate_variance_code\r\n  , excess_rate_floor\r\n  , excess_rate_ceiling\r\n  , excess_rate_review_date\r\n  , excess_rate_review_date2\r\n  , excess_rate_review_term\r\n  , exces_rate_review_term_code\r\n  , auto_maintain_npl_status\r\n  , nonperforming_status\r\n  , first_reached_excess_date\r\n  , first_reached_excess_date2\r\n  , no_debits_up_to_3\r\n  , no_debits_up_to_6\r\n  , no_debits_up_to_3_exceed\r\n  , no_debits_up_to_6_exceed\r\n  , cash_deposit_this_cycle\r\n  , cash_paid_this_cycle\r\n  , aggregate_days_this_qtr\r\n  , agg_ledger_bal_this_qtr\r\n  , agg_collected_bal_this_qtr\r\n  , avg_ledger_bal_prior_qtr_1\r\n  , avg_ledger_bal_prior_qtr_2\r\n  , avg_ledger_bal_prior_qtr_3\r\n  , avg_ledger_bal_prior_qtr_4\r\n  , avg_collected_bal_prior_qtr_1\r\n  , avg_collected_bal_prior_qtr_2\r\n  , avg_collected_bal_prior_qtr_3\r\n  , avg_collected_bal_prior_qtr_4\r\n  , special_information_code_1\r\n  , special_information_code_2\r\n  , special_information_code_3\r\n  , special_information_code_4\r\n  , special_message\r\n  , club_plan\r\n  , no_nsf_this_cycle\r\n  , no_nsf_this_qtr\r\n  , no_nsf_2nd_qtr\r\n  , no_nsf_3rd_qtr\r\n  , no_nsf_4th_qtr\r\n  , no_nsf_last_year\r\n  , no_nsf_life_to_date\r\n  , total_accrual_float\r\n  , total_availibility_float\r\n  , total_cash_float\r\n  , no_of_enclosures\r\n  , eft_flag\r\n  , minimum_charge\r\n  , no_large_bal_fluctuation_mtd\r\n  , no_large_bal_fluctuation_ytd\r\n  , times_on_kite_suspect_report\r\n  , federal_wh_code\r\n  , state_wh_code\r\n  , state\r\n  , date_wh_code_changed\r\n  , date_wh_code_changed2\r\n  , alternate_account_no\r\n  , alternate_account_type\r\n  , fed_wh_alternate_rate\r\n  , state_wh_alternate_rate\r\n  , fed_wh_today\r\n  , federal_wh_mtd\r\n  , federal_wh_qtd\r\n  , federal_wh_ytd\r\n  , state_wh_today\r\n  , state_wh_mtd\r\n  , state_wh_qtd\r\n  , state_wh_ytd\r\n  , federal_wh_last_year\r\n  , state_wh_last_year\r\n  , highest_interest_rate_earned\r\n  , nsf_items_exist\r\n  , aft_code\r\n  , statementpassbook_code\r\n  , teller_special_status\r\n  , print_check_statement_order_no\r\n  , mtd_service_charge\r\n  , mtd_interest_paid\r\n  , mtd_od_interest_charged\r\n  , mtd_fees_paid\r\n  , mtd_aggregate_balance\r\n  , mtd_aggregate_days\r\n  , mtd_beginning_accrual\r\n  , mtd_returned_debit_count\r\n  , mtd_returned_debit_amount\r\n  , mtd_returned_credit_count\r\n  , mtd_returned_credit_amount\r\n  , classcar_code\r\n  , selection_number\r\n  , overdraft_limit\r\n  , od_drawing_limit\r\n  , yesterday_od_drawing_limit\r\n  , npl_suspension_limit\r\n  , accrued_on_credit_life\r\n  , yesterday_accr_on_credit_life\r\n  , excess_od_interest\r\n  , seconday_accrued_int\r\n  , sec_accrued_commitment_fee\r\n  , sec_accrued_credit_life\r\n  , accrued_commitment_fee\r\n  , yesterday_accr_commitment_fee\r\n  , od_review_date\r\n  , od_review_date2\r\n  , payment_amount\r\n  , application_number\r\n  , specific_provision_for_debts\r\n  , workstation_id\r\n  , user_id\r\n  , time_account_added AS open_time\r\n  , job_number\r\n  , product_type_change\r\n  , product_change_effdate_ddmmyy\r\n  , product_change_effective_date_\r\n  , online_sweep_flag\r\n  , no_of_withdrawal_for_the_month\r\n  , dormant_status\r\n  , date_of_dormant_status\r\n  , date_of_dormant_status_\r\n  , borrower_code\r\n  , guarantee_number\r\n  , guarantee_amount\r\n  , cgc_date\r\n  , cgc_date_\r\n  , date_claim_submitted_to_cgc\r\n  , date_claim_submitted_to_cgc_\r\n  , date_cgc_notified_of_npl\r\n  , date_cgc_notified_of_npl_\r\n  , date_fee_paid_to_cgc\r\n  , date_fee_paid_to_cgc_\r\n  , sales_officer\r\n  , client_type\r\n  , school_campaign\r\n  , auto_od_limit\r\n  , staff_ac\r\n  , senior_savers\r\n  , reserve_4\r\n  , reserve_5\r\n  , reserve_6\r\n  , reserve_7\r\n  , reserve_8\r\n  , insured_party_customer_number\r\n  , reserve_bucket_2\r\n  , reserve_bucket_3\r\n  , reserve_bucket_4\r\n  , daily_iis_accrual\r\n  , reserve_balance_2\r\n  , reserve_balance_3\r\n  , reserve_balance_4\r\n  , odp_type\r\n  , product_group\r\n  , mode_of_operation\r\n  , sptf_flag\r\n  , date_prev_interest_paid\r\n  , date_prev_interest_paid2\r\n  , product_category\r\n  , department_code\r\n  , tax_code_id\r\n  , account_in_base_currency\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'demanddeposit_master001 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__demanddeposit_master001.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__demanddeposit_master001.sql", "name": "stg_landing__demanddeposit_master001", "alias": "stg_landing__demanddeposit_master001", "checksum": {"name": "sha256", "checksum": "c95b2c6c25fbcee0949ec7359936d862ac65dad360e5f931de3da8e3aedbdfc2"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "demanddeposit_master001 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__demanddeposit_master001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0992966, "compiled_code": "\nSELECT \n  record_id\n  , bank_number\n  , branch_code\n  , reporting_branch\n  , account_number\n  , account_type\n  , currency_type\n  , product_code\n  , short_name\n  , formatted_short_name\n  , account_name\n  , customer_number\n  , officer\n  , status\n  , account_group_number\n  , related_account_group_number\n  , close_status\n  , class\n  , currency_decimals\n  , gl_group_code\n  , cost_center\n  , product_code2\n  , stop_code\n  , hold_code\n  , alert_code\n  , special_instruction_code\n  , print_interest_check\n  , date_opened\n  , fnc_convert_date_to_date_id(is_date_yyyyddd(date_opened)) AS open_date\n  , date_of_status\n  , fnc_convert_date_to_date_id(is_date_yyyyddd(date_of_status)) AS status_date\n  , date_entered\n  , date_last_overdrawn\n  , prior_last_active_date\n  , date_last_active\n  , date_last_contact\n  , date_last_interest_paid\n  , date_last_statement\n  , date_last_maintenance\n  , date_last_deposit\n  , date_sc_waive_expires\n  -- , open_date\n  , date_of_status2\n  , date_entered2\n  , date_last_overdrawn2\n  , prior_last_active_date2\n  , date_last_active2\n  , date_last_contact2\n  , date_last_interest_paid2\n  , date_last_statement2\n  , date_last_maintenance2\n  , date_last_deposit2\n  , date_sc_waive_expires2\n  , amt_of_last_deposit\n  , blocked_amount\n  , total_oc_amount\n  , total_ocp_amount\n  , total_odoc_amount\n  , total_mc_amount\n  , total_ibt_amount\n  , total_llc_amount\n  , total_extra_amount\n  , total_suspense_amount\n  , float_drawing_amount\n  , balance\n  , yesterday_ledger_balance\n  , excess_overdrawn_balance\n  , yesterday_excess_overdrawn_bal\n  , charged_off_balance\n  , previous_statement_balance\n  , prev_year_end_ledger_balance\n  , minimum_balance\n  , maximum_balance\n  , collected_balance\n  , accrued_od_interest\n  , yesterday_accrued_od_interest\n  , exs_accrued_today\n  , od_accrued_today\n  , aggregate_days\n  , aggregate_ledger_balance\n  , aggregate_collected_balance\n  , aggregate_days_ledger_negative\n  , agg_negative_ledger_bal\n  , agg_days_collected_negative\n  , agg_negative_collected_bal\n  , min_bal___int_cycle\n  , max_bal___int_cycle\n  , minimum_balance___m_t_d\n  , maximum_balance___m_t_d\n  , agg_days___int_cycle\n  , agg_ledger_bal___int_cycle\n  , agg_collected_bal___int_cycle\n  , accrued_interest\n  , alternate_accrued_interest\n  , int_accrued_today\n  , ytd_interest_paid\n  , ytd_interest_charged\n  , previous_ytd_interest_paid\n  , amt_of_last_int_pd\n  , int_paid_today\n  , od_intcapitalised_today\n  , od_intcapitalised_today2\n  , statement_cycle\n  , statement_code\n  , interest_cycle\n  , service_charge_cycle\n  , service_charge_mode\n  , user_code\n  , user_code_2\n  , user_code_3\n  , user_code_4\n  , user_code_5\n  , user_code_6\n  , user_code_7\n  , user_code_8\n  , number_of_debits\n  , amount_of_debits\n  , number_of_credits\n  , amount_of_credits\n  , number_sc_debits\n  , amount_sc_debits\n  , number_sc_credits\n  , amount_sc_credits\n  , number_of_debits2\n  , amount_of_debits2\n  , number_of_credits2\n  , amount_of_credits2\n  , number_sc_debits2\n  , amount_sc_debits2\n  , number_sc_credits2\n  , amount_sc_credits2\n  , no_of_on_us__atm_credits\n  , amt_of_o_nus_atm_credits\n  , no_of_on_us__atm_debits\n  , amt_of_on_us_atm_debits\n  , no_of_frgn__atm_credits\n  , amt_of_frgn_atm_credits\n  , no_of_frgn__atm_debits\n  , amt_of_frgn_atm_debits\n  , number_of_deposit_days\n  , amount_of_nsf_items\n  , overdraft_limit_code\n  , signature_verification\n  , overdraft_protection\n  , valid_for_check_book\n  , atm_card\n  , include_on_combined_statement\n  , hold_mail_code\n  , automatic_nsf_charge\n  , high_volume_account\n  , bad_check_incident\n  , times_od_this_cycle\n  , times_od_this_qtr\n  , times_od_2nd_qtr\n  , times_od_3rd_qtr\n  , times_od_4th_qtr\n  , times_od_last_year\n  , times_od_life_to_date\n  , related_account_no\n  , related_account_type\n  , no_cks_deposit_on_us\n  , no_cks_deposit_foreign\n  , list_post_code\n  , interest_rate_no\n  , interest_rate\n  , credit_rate_flag\n  , rate_variance\n  , rate_variance_code\n  , rate_floor\n  , rate_ceiling\n  , rate_review_date\n  , rate_review_date2\n  , rate_review_term\n  , rate_review_term_code\n  , excess_intrate_no\n  , excess_interest_rate\n  , excess_rate_flag\n  , excess_rate_variance\n  , excess_rate_variance_code\n  , excess_rate_floor\n  , excess_rate_ceiling\n  , excess_rate_review_date\n  , excess_rate_review_date2\n  , excess_rate_review_term\n  , exces_rate_review_term_code\n  , auto_maintain_npl_status\n  , nonperforming_status\n  , first_reached_excess_date\n  , first_reached_excess_date2\n  , no_debits_up_to_3\n  , no_debits_up_to_6\n  , no_debits_up_to_3_exceed\n  , no_debits_up_to_6_exceed\n  , cash_deposit_this_cycle\n  , cash_paid_this_cycle\n  , aggregate_days_this_qtr\n  , agg_ledger_bal_this_qtr\n  , agg_collected_bal_this_qtr\n  , avg_ledger_bal_prior_qtr_1\n  , avg_ledger_bal_prior_qtr_2\n  , avg_ledger_bal_prior_qtr_3\n  , avg_ledger_bal_prior_qtr_4\n  , avg_collected_bal_prior_qtr_1\n  , avg_collected_bal_prior_qtr_2\n  , avg_collected_bal_prior_qtr_3\n  , avg_collected_bal_prior_qtr_4\n  , special_information_code_1\n  , special_information_code_2\n  , special_information_code_3\n  , special_information_code_4\n  , special_message\n  , club_plan\n  , no_nsf_this_cycle\n  , no_nsf_this_qtr\n  , no_nsf_2nd_qtr\n  , no_nsf_3rd_qtr\n  , no_nsf_4th_qtr\n  , no_nsf_last_year\n  , no_nsf_life_to_date\n  , total_accrual_float\n  , total_availibility_float\n  , total_cash_float\n  , no_of_enclosures\n  , eft_flag\n  , minimum_charge\n  , no_large_bal_fluctuation_mtd\n  , no_large_bal_fluctuation_ytd\n  , times_on_kite_suspect_report\n  , federal_wh_code\n  , state_wh_code\n  , state\n  , date_wh_code_changed\n  , date_wh_code_changed2\n  , alternate_account_no\n  , alternate_account_type\n  , fed_wh_alternate_rate\n  , state_wh_alternate_rate\n  , fed_wh_today\n  , federal_wh_mtd\n  , federal_wh_qtd\n  , federal_wh_ytd\n  , state_wh_today\n  , state_wh_mtd\n  , state_wh_qtd\n  , state_wh_ytd\n  , federal_wh_last_year\n  , state_wh_last_year\n  , highest_interest_rate_earned\n  , nsf_items_exist\n  , aft_code\n  , statementpassbook_code\n  , teller_special_status\n  , print_check_statement_order_no\n  , mtd_service_charge\n  , mtd_interest_paid\n  , mtd_od_interest_charged\n  , mtd_fees_paid\n  , mtd_aggregate_balance\n  , mtd_aggregate_days\n  , mtd_beginning_accrual\n  , mtd_returned_debit_count\n  , mtd_returned_debit_amount\n  , mtd_returned_credit_count\n  , mtd_returned_credit_amount\n  , classcar_code\n  , selection_number\n  , overdraft_limit\n  , od_drawing_limit\n  , yesterday_od_drawing_limit\n  , npl_suspension_limit\n  , accrued_on_credit_life\n  , yesterday_accr_on_credit_life\n  , excess_od_interest\n  , seconday_accrued_int\n  , sec_accrued_commitment_fee\n  , sec_accrued_credit_life\n  , accrued_commitment_fee\n  , yesterday_accr_commitment_fee\n  , od_review_date\n  , od_review_date2\n  , payment_amount\n  , application_number\n  , specific_provision_for_debts\n  , workstation_id\n  , user_id\n  , time_account_added AS open_time\n  , job_number\n  , product_type_change\n  , product_change_effdate_ddmmyy\n  , product_change_effective_date_\n  , online_sweep_flag\n  , no_of_withdrawal_for_the_month\n  , dormant_status\n  , date_of_dormant_status\n  , date_of_dormant_status_\n  , borrower_code\n  , guarantee_number\n  , guarantee_amount\n  , cgc_date\n  , cgc_date_\n  , date_claim_submitted_to_cgc\n  , date_claim_submitted_to_cgc_\n  , date_cgc_notified_of_npl\n  , date_cgc_notified_of_npl_\n  , date_fee_paid_to_cgc\n  , date_fee_paid_to_cgc_\n  , sales_officer\n  , client_type\n  , school_campaign\n  , auto_od_limit\n  , staff_ac\n  , senior_savers\n  , reserve_4\n  , reserve_5\n  , reserve_6\n  , reserve_7\n  , reserve_8\n  , insured_party_customer_number\n  , reserve_bucket_2\n  , reserve_bucket_3\n  , reserve_bucket_4\n  , daily_iis_accrual\n  , reserve_balance_2\n  , reserve_balance_3\n  , reserve_balance_4\n  , odp_type\n  , product_group\n  , mode_of_operation\n  , sptf_flag\n  , date_prev_interest_paid\n  , date_prev_interest_paid2\n  , product_category\n  , department_code\n  , tax_code_id\n  , account_in_base_currency\n  , etl_date\nFROM \n  oracle_bulanding.df_2.demanddeposit_master001 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master001"}, "model.dga_data_model.stg_landing__demanddeposit_master002": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.demanddeposit_master002 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__demanddeposit_master002"], "unique_id": "model.dga_data_model.stg_landing__demanddeposit_master002", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    account_no_sk\r\n  , account_no\r\n  , currency\r\n  , class\r\n  , account_name\r\n  , open_date\r\n  , int_liq_freq_code\r\n  , int_liq_freq\r\n  , special_rate\r\n  , rate_flr\r\n  , rate_cel\r\n  , rate_var\r\n  , rate_var_code\r\n  , rate_review_dt\r\n  , rate_review_term\r\n  , rate_review_code\r\n  , od_auth_limit\r\n  , od_draw_limit\r\n  , od_limit_code\r\n  , overdraft_facility\r\n  , overdraft_type\r\n  , od_rate_code\r\n  , od_rate\r\n  , efft_rate\r\n  , od_rate_flr\r\n  , od_rate_cel\r\n  , od_rate_var\r\n  , od_var_code\r\n  , od_review_dt\r\n  , od_review_term\r\n  , od_review_code\r\n  , od_application_no\r\n  , stmt_facility\r\n  , aft_facility\r\n  , cheque_faclility\r\n  , min_bal\r\n  , max_bal\r\n  , charge_freq\r\n  , charge_type\r\n  , sc_waive_exp_dt\r\n  , min_charge\r\n  , rec_current_ind\r\n  , rec_effective_date\r\n  , pooling_rel\r\n  , account_type\r\n  , subbranch_no\r\n  , branch_code_sk\r\n  , ddsic1\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'demanddeposit_master002 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__demanddeposit_master002.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__demanddeposit_master002.sql", "name": "stg_landing__demanddeposit_master002", "alias": "stg_landing__demanddeposit_master002", "checksum": {"name": "sha256", "checksum": "f65e3a0a9c4eeef60724318c00cac0a65f4a9f56951228ffc5d72312340b8e92"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "demanddeposit_master002 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__demanddeposit_master002.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1022968, "compiled_code": "\nSELECT \n    account_no_sk\n  , account_no\n  , currency\n  , class\n  , account_name\n  , open_date\n  , int_liq_freq_code\n  , int_liq_freq\n  , special_rate\n  , rate_flr\n  , rate_cel\n  , rate_var\n  , rate_var_code\n  , rate_review_dt\n  , rate_review_term\n  , rate_review_code\n  , od_auth_limit\n  , od_draw_limit\n  , od_limit_code\n  , overdraft_facility\n  , overdraft_type\n  , od_rate_code\n  , od_rate\n  , efft_rate\n  , od_rate_flr\n  , od_rate_cel\n  , od_rate_var\n  , od_var_code\n  , od_review_dt\n  , od_review_term\n  , od_review_code\n  , od_application_no\n  , stmt_facility\n  , aft_facility\n  , cheque_faclility\n  , min_bal\n  , max_bal\n  , charge_freq\n  , charge_type\n  , sc_waive_exp_dt\n  , min_charge\n  , rec_current_ind\n  , rec_effective_date\n  , pooling_rel\n  , account_type\n  , subbranch_no\n  , branch_code_sk\n  , ddsic1\n  , etl_date\nFROM \n  oracle_bulanding.df_2.demanddeposit_master002 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002"}, "model.dga_data_model.stg_landing__df_card_channel": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.df_card_channel @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__df_card_channel"], "unique_id": "model.dga_data_model.stg_landing__df_card_channel", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  channel_code\r\n  , channel_desc\r\nFROM \r\n  {{ source('daily_bulanding', 'df_card_channel @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__df_card_channel.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__df_card_channel.sql", "name": "stg_landing__df_card_channel", "alias": "stg_landing__df_card_channel", "checksum": {"name": "sha256", "checksum": "351aaf688de75ad9d5be08fdcdf33e0c07272a35289c1af14089b9db412e3ab7"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "df_card_channel @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__df_card_channel.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1033778, "compiled_code": "\nSELECT \n  channel_code\n  , channel_desc\nFROM \n  oracle_bulanding.df_2.df_card_channel @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__df_card_channel"}, "model.dga_data_model.stg_landing__df_card_sic": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.df_card_sic @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__df_card_sic"], "unique_id": "model.dga_data_model.stg_landing__df_card_sic", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n      sic_code\r\n  , sic_desc\r\n  , eng_sic_name_group\r\n  , sic_group\r\nFROM\r\n  {{ source('daily_bulanding', 'df_card_sic @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__df_card_sic.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__df_card_sic.sql", "name": "stg_landing__df_card_sic", "alias": "stg_landing__df_card_sic", "checksum": {"name": "sha256", "checksum": "8ff2578d4174ef08cab39ed42893c63371f0b51d39692f57223cea4a00ea05f3"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "df_card_sic @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__df_card_sic.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959751.5662613, "compiled_code": "\nSELECT\n      sic_code\n  , sic_desc\n  , eng_sic_name_group\n  , sic_group\nFROM\n  oracle_bulanding.df_2.df_card_sic @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__df_card_sic"}, "model.dga_data_model.stg_landing__df_casa_channel_trn_type": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__df_casa_channel_trn_type"], "unique_id": "model.dga_data_model.stg_landing__df_casa_channel_trn_type", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  tltxcd\r\n  , tltxds\r\nFROM \r\n  {{ source('daily_bulanding', 'df_casa_channel_trn_type @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__df_casa_channel_trn_type.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__df_casa_channel_trn_type.sql", "name": "stg_landing__df_casa_channel_trn_type", "alias": "stg_landing__df_casa_channel_trn_type", "checksum": {"name": "sha256", "checksum": "4e8b3d9231250c86a300ea28a8e79c39a8c3cfd2a13e96e6d84e2c36b62c6cf3"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "df_casa_channel_trn_type @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__df_casa_channel_trn_type.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1163378, "compiled_code": "\nSELECT \n  tltxcd\n  , tltxds\nFROM \n  oracle_bulanding.df_2.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__df_casa_channel_trn_type"}, "model.dga_data_model.stg_landing__df_customer_sts_type": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.df_customer_sts_type @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__df_customer_sts_type"], "unique_id": "model.dga_data_model.stg_landing__df_customer_sts_type", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n  status\r\n  , status_name\r\nFROM \r\n  {{ source('daily_bulanding', 'df_customer_sts_type @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__df_customer_sts_type.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__df_customer_sts_type.sql", "name": "stg_landing__df_customer_sts_type", "alias": "stg_landing__df_customer_sts_type", "checksum": {"name": "sha256", "checksum": "3dbb7fa2655dc0bbfccafa832eef148ba43ede8543f4baa74d79e7fd85f80684"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "df_customer_sts_type @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__df_customer_sts_type.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1042972, "compiled_code": "\nSELECT \n  status\n  , status_name\nFROM \n  oracle_bulanding.df_2.df_customer_sts_type @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__df_customer_sts_type"}, "model.dga_data_model.stg_landing__fixeddeposit_master001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.fixeddeposit_master001 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__fixeddeposit_master001"], "unique_id": "model.dga_data_model.stg_landing__fixeddeposit_master001", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    bank_number\r\n  , account_number\r\n  , account_type\r\n  , account_name\r\n  , short_name\r\n  , formatted_short_name\r\n  , customer_number\r\n  , product_type\r\n  , branch_code\r\n  , reporting_branch\r\n  , gl_group_code\r\n  , cost_center\r\n  , product_code\r\n  , officer\r\n  , status\r\n  , prior_status\r\n  , class\r\n  , account_group__number\r\n  , related_account_group_number\r\n  , original_amount\r\n  , balance\r\n  , blocked_amount\r\n  , hold_description\r\n  , statementpassbook_code\r\n  , amount_last_interest_paid\r\n  , original_discount\r\n  , accrued_interest\r\n  , anticipated_interest\r\n  , withdrawable_interest\r\n  , withdrawable_wh_tax\r\n  , advance_accrue_int\r\n  , renewal_counter\r\n  , statement_cycle_code\r\n  , wdrl_restr_indicator\r\n  , daily_accrual\r\n  , year_to_date_interest\r\n  , previous_year_interest\r\n  , previous_year_penalty\r\n  , previous_year_fed_wh\r\n  , previous_year_state_wh\r\n  , term_to_date_interest\r\n  , term_to_date_penalty\r\n  , term_to_date_fed_wh\r\n  , term_to_date_state_wh\r\n  , life_to_date_interest\r\n  , ytd_interest_penalty\r\n  , previous_payment_bal\r\n  , balance_at_last_renewal\r\n  , ytd_contribution\r\n  , penalty_for_early_redeem\r\n  , accrual_at_beg_of_year\r\n  , accrual_at_beg_of_month\r\n  , balance_yesterday\r\n  , accrued_yesterday\r\n  , accrued_today\r\n  , interest_debits_today\r\n  , interest_credits_today\r\n  , interest_dropped_today\r\n  , backdated_interest_today\r\n  , interest_paid_today\r\n  , balance_last_statement\r\n  , collected_balance\r\n  , deposits_this_term\r\n  , withdrawals_this_term\r\n  , balsubject_to_penalty\r\n  , aggregate_balance\r\n  , mtd_accrued\r\n  , aggregate_days\r\n  , issue_date\r\n  , effective_date\r\n  , last_payment_date\r\n  , next_payment_date\r\n  , maturity_date\r\n  , redemption_date\r\n  , last_maintenance_date\r\n  , rate_review_date\r\n  , date_last_statement\r\n  , date_last_status_change\r\n  , date_entered\r\n  , day_of_month_for_payment\r\n  , date_issued\r\n  , last_renewal_date\r\n  , last_payment_date2\r\n  , next_payment_date2\r\n  , maturity_date2\r\n  , redemption_date2\r\n  , last_maintenance_date2\r\n  , rate_review_date2\r\n  , date_last_statement2\r\n  , date_last_status_change2\r\n  , date_entered2\r\n  , principal_term\r\n  , principal_term_code\r\n  , interest_term\r\n  , interest_term_code\r\n  , autorenewal_code\r\n  , interest_disposition\r\n  , accrual_method\r\n  , year_base\r\n  , even_payment_code\r\n  , even_payment_changed\r\n  , deposit_account_number\r\n  , deposit_account_type\r\n  , customer_number_for_checks\r\n  , interest_rate\r\n  , rate_variance\r\n  , rate_variance_code\r\n  , rate_floor\r\n  , rate_ceiling\r\n  , rate_review_term\r\n  , rate_review_term_code\r\n  , variable_rate_number\r\n  , rate_schedule_code\r\n  , balance_rate_2\r\n  , interest_rate_no_2\r\n  , interest_rate_2\r\n  , balance_rate_3\r\n  , interest_rate_no_3\r\n  , interest_rate_3\r\n  , balance_rate_4\r\n  , interest_rate_no_4\r\n  , interest_rate_4\r\n  , balance_rate_5\r\n  , interest_rate_no_5\r\n  , interest_rate_5\r\n  , balance_rate_6\r\n  , interest_rate_no_6\r\n  , interest_rate_6\r\n  , balance_rate_7\r\n  , interest_rate_no_7\r\n  , interest_rate_7\r\n  , balance_rate_8\r\n  , interest_rate_no_8\r\n  , interest_rate_8\r\n  , balance_rate_9\r\n  , interest_rate_no_9\r\n  , interest_rate_9\r\n  , balance_rate_10\r\n  , interest_rate_no_10\r\n  , interest_rate_10\r\n  , balance_rate_11\r\n  , interest_rate_no_11\r\n  , interest_rate_11\r\n  , balance_rate_12\r\n  , interest_rate_no_12\r\n  , interest_rate_12\r\n  , split_accrual_method\r\n  , total_accrual_float\r\n  , total_availibility_float\r\n  , total_cash_float\r\n  , total_oc_amount\r\n  , total_ocp_amount\r\n  , total_odoc_amount\r\n  , total_mc_amount\r\n  , total_ibt_amount\r\n  , total_llc_amount\r\n  , total_xtr_amount\r\n  , total_suspense_amount\r\n  , withholding_code\r\n  , alternate_wh_acct_no\r\n  , alternate_wh_acct_type\r\n  , wh_alternate_rate\r\n  , wh_today\r\n  , withholding_m_t_d\r\n  , withholding_q_t_d\r\n  , withholding_y_t_d\r\n  , withholding_l_t_d\r\n  , state_code\r\n  , state_withholding_code\r\n  , state_wh_alt_rate\r\n  , state_withholding_today\r\n  , state_withholding_m_t_d\r\n  , state_withholding_q_t_d\r\n  , state_withholding_y_t_d\r\n  , state_withholding_l_t_d\r\n  , highest_interest_rate_earned\r\n  , special_information_code_1\r\n  , special_information_code_2\r\n  , special_information_code_3\r\n  , special_informatiom_code_4\r\n  , user_code\r\n  , user_code_2\r\n  , user_code_3\r\n  , user_code_4\r\n  , user_code_5\r\n  , user_code_6\r\n  , user_code_7\r\n  , user_code_8\r\n  , special_message_code\r\n  , include_on_combined_statement\r\n  , hold_mail_code\r\n  , print_reminders\r\n  , entry_in_cdchck_file\r\n  , entry_in_cddchk_file\r\n  , cd_category_code\r\n  , repurchase_block_number\r\n  , penalty_type\r\n  , oid_change_flag\r\n  , maturity_date_required\r\n  , statement_code\r\n  , alm_type\r\n  , original_source_of_funds\r\n  , paperless_code\r\n  , pay_accrued_last_payment\r\n  , allow_int_date_past_maturity\r\n  , currency_type\r\n  , currency_seq\r\n  , currency_decimals\r\n  , accrue_on_actual_days\r\n  , receipt_serial_number\r\n  , teller_special_status\r\n  , exclude_hold\r\n  , maturity_disposition\r\n  , maturity_trf_account_no\r\n  , maturity_trf_accounttype\r\n  , variable_rate_code\r\n  , instruction_for_checks\r\n  , interim_rate\r\n  , final_rate\r\n  , yesterday_accrual_balance\r\n  , refund_overpaid_wh\r\n  , forfeit_accrued_aftmat\r\n  , pay_to_multiple_parties\r\n  , user_id\r\n  , workstation_id\r\n  , time_change_made\r\n  , job_number\r\n  , fixed_rate_renewal_code\r\n  , product_type_change\r\n  , product_change_effdate_ddmmyy\r\n  , product_change_effective_date_\r\n  , insured_party_customer_number\r\n  , renewal_with_margin\r\n  , client_type\r\n  , auto_update_od_limit\r\n  , allow_receipt_reprint\r\n  , top_up_product_code\r\n  , top_up_freq_term_code\r\n  , reserve_5\r\n  , reserve_6\r\n  , reserve_7\r\n  , reserve_8\r\n  , top_up_freq_term\r\n  , reserve_bucket_2\r\n  , reserve_bucket_3\r\n  , reserve_bucket_4\r\n  , mode_of_operation\r\n  , sptf_flag\r\n  , charged_off_balance\r\n  , dormant_status\r\n  , date_of_dormant_status\r\n  , date_of_dormant_status_\r\n  , date_last_updated\r\n  , date_last_updated2\r\n  , accrue_as_at_last_month_end\r\n  , previous_1_month_accrual\r\n  , last_month\r\n  , prepaid_interest\r\n  , reserved_amt_01\r\n  , reserved_amt_02\r\n  , reserved_amt_03\r\n  , reserved_int_01\r\n  , reserved_int_02\r\n  , reserved_int_03\r\n  , rsv_date_ddmmyy\r\n  , rsv_date_\r\n  , top_up_date_ddmmyy\r\n  , top_up_date_\r\n  , receipt_serial_number2\r\n  , department_code\r\n  , tax_code_id\r\n  , renewal_balance\r\n  , instalment_paid_count\r\n  , advance_instalment_count\r\n  , renewal_penalty_type\r\n  , penalty_rate\r\n  , reserved_rate_1\r\n  , reserved_rate_2\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'fixeddeposit_master001 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__fixeddeposit_master001.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__fixeddeposit_master001.sql", "name": "stg_landing__fixeddeposit_master001", "alias": "stg_landing__fixeddeposit_master001", "checksum": {"name": "sha256", "checksum": "48884782a3a3cdbe3345dc2d902b535ee7e5dca60aa50538e8598b53c527bc6d"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "fixeddeposit_master001 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__fixeddeposit_master001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0672965, "compiled_code": "\nSELECT\n    bank_number\n  , account_number\n  , account_type\n  , account_name\n  , short_name\n  , formatted_short_name\n  , customer_number\n  , product_type\n  , branch_code\n  , reporting_branch\n  , gl_group_code\n  , cost_center\n  , product_code\n  , officer\n  , status\n  , prior_status\n  , class\n  , account_group__number\n  , related_account_group_number\n  , original_amount\n  , balance\n  , blocked_amount\n  , hold_description\n  , statementpassbook_code\n  , amount_last_interest_paid\n  , original_discount\n  , accrued_interest\n  , anticipated_interest\n  , withdrawable_interest\n  , withdrawable_wh_tax\n  , advance_accrue_int\n  , renewal_counter\n  , statement_cycle_code\n  , wdrl_restr_indicator\n  , daily_accrual\n  , year_to_date_interest\n  , previous_year_interest\n  , previous_year_penalty\n  , previous_year_fed_wh\n  , previous_year_state_wh\n  , term_to_date_interest\n  , term_to_date_penalty\n  , term_to_date_fed_wh\n  , term_to_date_state_wh\n  , life_to_date_interest\n  , ytd_interest_penalty\n  , previous_payment_bal\n  , balance_at_last_renewal\n  , ytd_contribution\n  , penalty_for_early_redeem\n  , accrual_at_beg_of_year\n  , accrual_at_beg_of_month\n  , balance_yesterday\n  , accrued_yesterday\n  , accrued_today\n  , interest_debits_today\n  , interest_credits_today\n  , interest_dropped_today\n  , backdated_interest_today\n  , interest_paid_today\n  , balance_last_statement\n  , collected_balance\n  , deposits_this_term\n  , withdrawals_this_term\n  , balsubject_to_penalty\n  , aggregate_balance\n  , mtd_accrued\n  , aggregate_days\n  , issue_date\n  , effective_date\n  , last_payment_date\n  , next_payment_date\n  , maturity_date\n  , redemption_date\n  , last_maintenance_date\n  , rate_review_date\n  , date_last_statement\n  , date_last_status_change\n  , date_entered\n  , day_of_month_for_payment\n  , date_issued\n  , last_renewal_date\n  , last_payment_date2\n  , next_payment_date2\n  , maturity_date2\n  , redemption_date2\n  , last_maintenance_date2\n  , rate_review_date2\n  , date_last_statement2\n  , date_last_status_change2\n  , date_entered2\n  , principal_term\n  , principal_term_code\n  , interest_term\n  , interest_term_code\n  , autorenewal_code\n  , interest_disposition\n  , accrual_method\n  , year_base\n  , even_payment_code\n  , even_payment_changed\n  , deposit_account_number\n  , deposit_account_type\n  , customer_number_for_checks\n  , interest_rate\n  , rate_variance\n  , rate_variance_code\n  , rate_floor\n  , rate_ceiling\n  , rate_review_term\n  , rate_review_term_code\n  , variable_rate_number\n  , rate_schedule_code\n  , balance_rate_2\n  , interest_rate_no_2\n  , interest_rate_2\n  , balance_rate_3\n  , interest_rate_no_3\n  , interest_rate_3\n  , balance_rate_4\n  , interest_rate_no_4\n  , interest_rate_4\n  , balance_rate_5\n  , interest_rate_no_5\n  , interest_rate_5\n  , balance_rate_6\n  , interest_rate_no_6\n  , interest_rate_6\n  , balance_rate_7\n  , interest_rate_no_7\n  , interest_rate_7\n  , balance_rate_8\n  , interest_rate_no_8\n  , interest_rate_8\n  , balance_rate_9\n  , interest_rate_no_9\n  , interest_rate_9\n  , balance_rate_10\n  , interest_rate_no_10\n  , interest_rate_10\n  , balance_rate_11\n  , interest_rate_no_11\n  , interest_rate_11\n  , balance_rate_12\n  , interest_rate_no_12\n  , interest_rate_12\n  , split_accrual_method\n  , total_accrual_float\n  , total_availibility_float\n  , total_cash_float\n  , total_oc_amount\n  , total_ocp_amount\n  , total_odoc_amount\n  , total_mc_amount\n  , total_ibt_amount\n  , total_llc_amount\n  , total_xtr_amount\n  , total_suspense_amount\n  , withholding_code\n  , alternate_wh_acct_no\n  , alternate_wh_acct_type\n  , wh_alternate_rate\n  , wh_today\n  , withholding_m_t_d\n  , withholding_q_t_d\n  , withholding_y_t_d\n  , withholding_l_t_d\n  , state_code\n  , state_withholding_code\n  , state_wh_alt_rate\n  , state_withholding_today\n  , state_withholding_m_t_d\n  , state_withholding_q_t_d\n  , state_withholding_y_t_d\n  , state_withholding_l_t_d\n  , highest_interest_rate_earned\n  , special_information_code_1\n  , special_information_code_2\n  , special_information_code_3\n  , special_informatiom_code_4\n  , user_code\n  , user_code_2\n  , user_code_3\n  , user_code_4\n  , user_code_5\n  , user_code_6\n  , user_code_7\n  , user_code_8\n  , special_message_code\n  , include_on_combined_statement\n  , hold_mail_code\n  , print_reminders\n  , entry_in_cdchck_file\n  , entry_in_cddchk_file\n  , cd_category_code\n  , repurchase_block_number\n  , penalty_type\n  , oid_change_flag\n  , maturity_date_required\n  , statement_code\n  , alm_type\n  , original_source_of_funds\n  , paperless_code\n  , pay_accrued_last_payment\n  , allow_int_date_past_maturity\n  , currency_type\n  , currency_seq\n  , currency_decimals\n  , accrue_on_actual_days\n  , receipt_serial_number\n  , teller_special_status\n  , exclude_hold\n  , maturity_disposition\n  , maturity_trf_account_no\n  , maturity_trf_accounttype\n  , variable_rate_code\n  , instruction_for_checks\n  , interim_rate\n  , final_rate\n  , yesterday_accrual_balance\n  , refund_overpaid_wh\n  , forfeit_accrued_aftmat\n  , pay_to_multiple_parties\n  , user_id\n  , workstation_id\n  , time_change_made\n  , job_number\n  , fixed_rate_renewal_code\n  , product_type_change\n  , product_change_effdate_ddmmyy\n  , product_change_effective_date_\n  , insured_party_customer_number\n  , renewal_with_margin\n  , client_type\n  , auto_update_od_limit\n  , allow_receipt_reprint\n  , top_up_product_code\n  , top_up_freq_term_code\n  , reserve_5\n  , reserve_6\n  , reserve_7\n  , reserve_8\n  , top_up_freq_term\n  , reserve_bucket_2\n  , reserve_bucket_3\n  , reserve_bucket_4\n  , mode_of_operation\n  , sptf_flag\n  , charged_off_balance\n  , dormant_status\n  , date_of_dormant_status\n  , date_of_dormant_status_\n  , date_last_updated\n  , date_last_updated2\n  , accrue_as_at_last_month_end\n  , previous_1_month_accrual\n  , last_month\n  , prepaid_interest\n  , reserved_amt_01\n  , reserved_amt_02\n  , reserved_amt_03\n  , reserved_int_01\n  , reserved_int_02\n  , reserved_int_03\n  , rsv_date_ddmmyy\n  , rsv_date_\n  , top_up_date_ddmmyy\n  , top_up_date_\n  , receipt_serial_number2\n  , department_code\n  , tax_code_id\n  , renewal_balance\n  , instalment_paid_count\n  , advance_instalment_count\n  , renewal_penalty_type\n  , penalty_rate\n  , reserved_rate_1\n  , reserved_rate_2\n  , etl_date\nFROM\n  oracle_bulanding.df_2.fixeddeposit_master001 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master001"}, "model.dga_data_model.stg_landing__fixeddeposit_master002": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.fixeddeposit_master002 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__fixeddeposit_master002"], "unique_id": "model.dga_data_model.stg_landing__fixeddeposit_master002", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    account_sk\r\n  , account_no\r\n  , account_name\r\n  , currency\r\n  , class\r\n  , open_date\r\n  , term\r\n  , maturity_req\r\n  , redemption_date\r\n  , renew_code\r\n  , int_liq_freq\r\n  , rate_code\r\n  , rate_schd\r\n  , rate_flr\r\n  , rate_cel\r\n  , rate_var\r\n  , rate_review_term\r\n  , tier\r\n  , cumulative\r\n  , int_liq_type\r\n  , int_liq_account\r\n  , int_liq_account_type\r\n  , stmt_facility\r\n  , org_amount\r\n  , rec_current_ind\r\n  , rec_effective_date\r\n  , branch_code_sk\r\n  , subbranch_no\r\n  , subbranch_sk\r\n  , serial_no\r\n  , account_group_no\r\n  , user_id\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'fixeddeposit_master002 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__fixeddeposit_master002.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__fixeddeposit_master002.sql", "name": "stg_landing__fixeddeposit_master002", "alias": "stg_landing__fixeddeposit_master002", "checksum": {"name": "sha256", "checksum": "96d0f2062ce14c1f3df52a721dd82098b2fe441143cd783b7b764a7e05576f88"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "fixeddeposit_master002 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__fixeddeposit_master002.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.065362, "compiled_code": "\nSELECT \n    account_sk\n  , account_no\n  , account_name\n  , currency\n  , class\n  , open_date\n  , term\n  , maturity_req\n  , redemption_date\n  , renew_code\n  , int_liq_freq\n  , rate_code\n  , rate_schd\n  , rate_flr\n  , rate_cel\n  , rate_var\n  , rate_review_term\n  , tier\n  , cumulative\n  , int_liq_type\n  , int_liq_account\n  , int_liq_account_type\n  , stmt_facility\n  , org_amount\n  , rec_current_ind\n  , rec_effective_date\n  , branch_code_sk\n  , subbranch_no\n  , subbranch_sk\n  , serial_no\n  , account_group_no\n  , user_id\n  , etl_date\nFROM \n  oracle_bulanding.df_2.fixeddeposit_master002 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master002"}, "model.dga_data_model.stg_landing__fixeddeposit_master003": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.fixeddeposit_master003 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__fixeddeposit_master003"], "unique_id": "model.dga_data_model.stg_landing__fixeddeposit_master003", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  etl_date\r\n  , branch_sk\r\n  , account_sk\r\n  , account_no\r\n  , currency\r\n  , product_sk\r\n  , customer_sk\r\n  , customer_no\r\n  , status\r\n  , status_since\r\n  , open_date\r\n  , term\r\n  , maturity_date\r\n  , last_renew_bal\r\n  , last_renew_date\r\n  , renew_count\r\n  , last_update_dt\r\n  , rate\r\n  , rate_review_dt\r\n  , accr_amount\r\n  , today_accr_dr\r\n  , expected_accr_int\r\n  , last_liq_date\r\n  , next_liq_date\r\n  , withdrawable_int\r\n  , org_discount_amt\r\n  , org_amount\r\n  , acy_blocked_amt\r\n  , acy_ledger_bal\r\n  , lcy_ledger_bal\r\n  , ac_stat_dormant\r\n  , dorm_since\r\n  , acy_aggr_bal\r\n  , aggr_days\r\n  , gl_code_sk\r\n  , maker_sk\r\n  , maker_dt_stamp\r\n  , officer_sk\r\n  , auto_renew\r\n  , renew_bal\r\n  , today_backdate_int\r\n  , mtd_accr_int\r\n  , last_int_amt_paid\r\n  , penanty_amount\r\n  , today_tover_int_dr\r\n  , today_tover_int_cr\r\n  , today_int_drop\r\n  , today_int_paid\r\n  , ctd_int_deposit\r\n  , ctd_int_withdraw\r\n  , ytd_interest_paid\r\n  , ctd_interest_paid\r\n  , highist_interest_earn\r\n  , yesterday_balance\r\nFROM \r\n  {{ source('daily_bulanding', 'fixeddeposit_master003 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__fixeddeposit_master003.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__fixeddeposit_master003.sql", "name": "stg_landing__fixeddeposit_master003", "alias": "stg_landing__fixeddeposit_master003", "checksum": {"name": "sha256", "checksum": "378293a8df18bc7afc48a7880a2b46069ac67457da12c16c014d609af0d630d1"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "fixeddeposit_master003 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__fixeddeposit_master003.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.0633726, "compiled_code": "\nSELECT\n  etl_date\n  , branch_sk\n  , account_sk\n  , account_no\n  , currency\n  , product_sk\n  , customer_sk\n  , customer_no\n  , status\n  , status_since\n  , open_date\n  , term\n  , maturity_date\n  , last_renew_bal\n  , last_renew_date\n  , renew_count\n  , last_update_dt\n  , rate\n  , rate_review_dt\n  , accr_amount\n  , today_accr_dr\n  , expected_accr_int\n  , last_liq_date\n  , next_liq_date\n  , withdrawable_int\n  , org_discount_amt\n  , org_amount\n  , acy_blocked_amt\n  , acy_ledger_bal\n  , lcy_ledger_bal\n  , ac_stat_dormant\n  , dorm_since\n  , acy_aggr_bal\n  , aggr_days\n  , gl_code_sk\n  , maker_sk\n  , maker_dt_stamp\n  , officer_sk\n  , auto_renew\n  , renew_bal\n  , today_backdate_int\n  , mtd_accr_int\n  , last_int_amt_paid\n  , penanty_amount\n  , today_tover_int_dr\n  , today_tover_int_cr\n  , today_int_drop\n  , today_int_paid\n  , ctd_int_deposit\n  , ctd_int_withdraw\n  , ytd_interest_paid\n  , ctd_interest_paid\n  , highist_interest_earn\n  , yesterday_balance\nFROM \n  oracle_bulanding.df_2.fixeddeposit_master003 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003"}, "model.dga_data_model.stg_landing__jupiter_account_register_hist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.jupiter_account_register_hist @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "create_time"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__jupiter_account_register_hist"], "unique_id": "model.dga_data_model.stg_landing__jupiter_account_register_hist", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    id\r\n  , id_cif\r\n  , is_number(account_number) AS account_number\r\n  , account_type\r\n  , account_code\r\n  , account_prod\r\n  , account_currency\r\n  , account_type_action\r\n  , create_by\r\n  , update_by\r\n  , create_time\r\n  , update_time\r\n  , status\r\n  , err_code\r\n  , err_des\r\n  , status_process\r\n  , create_day\r\n  , account_branch\r\n  , cif_number\r\n  , mpayroll\r\n  , sa_code\r\n  , account_real_number\r\n  , real_brn_code\r\nFROM\r\n  {{ source('daily_bulanding', 'jupiter_account_register_hist @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__jupiter_account_register_hist.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__jupiter_account_register_hist.sql", "name": "stg_landing__jupiter_account_register_hist", "alias": "stg_landing__jupiter_account_register_hist", "checksum": {"name": "sha256", "checksum": "de3d9003519b8b55d38c623fe83877f3a368e38bd2637bce45c89b6f0e1f07bf"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "jupiter_account_register_hist @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "create_time"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__jupiter_account_register_hist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "create_time"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1053727, "compiled_code": "\nSELECT\n    id\n  , id_cif\n  , is_number(account_number) AS account_number\n  , account_type\n  , account_code\n  , account_prod\n  , account_currency\n  , account_type_action\n  , create_by\n  , update_by\n  , create_time\n  , update_time\n  , status\n  , err_code\n  , err_des\n  , status_process\n  , create_day\n  , account_branch\n  , cif_number\n  , mpayroll\n  , sa_code\n  , account_real_number\n  , real_brn_code\nFROM\n  oracle_bulanding.df_2.jupiter_account_register_hist @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__jupiter_account_register_hist"}, "model.dga_data_model.stg_landing__jupiter_cif_register_history": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.jupiter_cif_register_history @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__jupiter_cif_register_history"], "unique_id": "model.dga_data_model.stg_landing__jupiter_cif_register_history", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    id\r\n  , cif_number AS customer_number\r\n  , first_customer_name\r\n  , gender\r\n  , birthdate\r\n  , id_type\r\n  , nationality\r\n  , address\r\n  , email\r\n  , fax\r\n  , phonehome\r\n  , mobilephone\r\n  , phonework\r\n  , status\r\n  , birthplace\r\n  , id_date\r\n  , id_place\r\n  , race\r\n  , marital\r\n  , occupation\r\n  , position\r\n  , work_address\r\n  , resident_status\r\n  , id_number\r\n  , address_contact\r\n  , branchtag\r\n  , password\r\n  , province\r\n  , religion\r\n  , id_expire_date\r\n  , batch_id\r\n  , contract_code\r\n  , contract_expired_date\r\n  , contract_signed_date\r\n  , fatca\r\n  , create_time\r\n  , update_time\r\n  , create_by\r\n  , update_by\r\n  , err_code\r\n  , err_des\r\n  , status_process\r\n  , last_customer_name\r\n  , cif_number_company\r\n  , id_acc_inventory\r\n  , id_meed\r\n  , address_econtact\r\n  , address_econtact2\r\n  , address_econtact3\r\n  , address_econtact4\r\n  , address_econtact5\r\n  , application\r\n  , approve_by\r\n  , approve_time\r\n  , business_code\r\n  , business_code1\r\n  , business_code2\r\n  , business_type\r\n  , business_type1\r\n  , business_type2\r\n  , card_no\r\n  , cif_type\r\n  , company_ename\r\n  , company_foundation_date\r\n  , company_name\r\n  , company_sdkkd\r\n  , company_sdkkd_type\r\n  , date_busi_paper\r\n  , full_name\r\n  , gender_legalcontprsn\r\n  , last_customer_ename\r\n  , register_place\r\n  , rejection_reason\r\n  , tax\r\n  , faca_1\r\n  , faca_2\r\n  , faca_3\r\n  , faca_4\r\n  , faca_5\r\n  , faca_6\r\n  , faca_7\r\n  , faca_8\r\n  , faca_9\r\n  , status_fatca\r\n  , date_open\r\n  , secret_phrase\r\n  , status_desc\r\n  , version\r\n  , work_company_name\r\n  , work_income\r\n  , work_note\r\n  , work_origin\r\n  , risk_class\r\n  , check_vip\r\n  , reason\r\n  , id_north_star\r\n  , employment_status\r\n  , income_bracket_code\r\n  , id_ib_sms\r\n  , callcenter_date\r\n  , callcenter_by\r\n  , user_name\r\n  , check_ekyc\r\n  , sale_code\r\n  , id_image\r\n  , customer_care\r\n  , job_designation_code\r\n  , etl_date\r\n  , is_number(regexp_substr(sale_code, '[^|]+', 1, 1)) AS valid_sale_code\r\nFROM \r\n  {{ source('daily_bulanding', 'jupiter_cif_register_history @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__jupiter_cif_register_history.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__jupiter_cif_register_history.sql", "name": "stg_landing__jupiter_cif_register_history", "alias": "stg_landing__jupiter_cif_register_history", "checksum": {"name": "sha256", "checksum": "22abddcd292d87e527e539f589ab3b382fd0731719c6a417b2ccfe858600d71f"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "jupiter_cif_register_history @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__jupiter_cif_register_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1083724, "compiled_code": "\nSELECT \n    id\n  , cif_number AS customer_number\n  , first_customer_name\n  , gender\n  , birthdate\n  , id_type\n  , nationality\n  , address\n  , email\n  , fax\n  , phonehome\n  , mobilephone\n  , phonework\n  , status\n  , birthplace\n  , id_date\n  , id_place\n  , race\n  , marital\n  , occupation\n  , position\n  , work_address\n  , resident_status\n  , id_number\n  , address_contact\n  , branchtag\n  , password\n  , province\n  , religion\n  , id_expire_date\n  , batch_id\n  , contract_code\n  , contract_expired_date\n  , contract_signed_date\n  , fatca\n  , create_time\n  , update_time\n  , create_by\n  , update_by\n  , err_code\n  , err_des\n  , status_process\n  , last_customer_name\n  , cif_number_company\n  , id_acc_inventory\n  , id_meed\n  , address_econtact\n  , address_econtact2\n  , address_econtact3\n  , address_econtact4\n  , address_econtact5\n  , application\n  , approve_by\n  , approve_time\n  , business_code\n  , business_code1\n  , business_code2\n  , business_type\n  , business_type1\n  , business_type2\n  , card_no\n  , cif_type\n  , company_ename\n  , company_foundation_date\n  , company_name\n  , company_sdkkd\n  , company_sdkkd_type\n  , date_busi_paper\n  , full_name\n  , gender_legalcontprsn\n  , last_customer_ename\n  , register_place\n  , rejection_reason\n  , tax\n  , faca_1\n  , faca_2\n  , faca_3\n  , faca_4\n  , faca_5\n  , faca_6\n  , faca_7\n  , faca_8\n  , faca_9\n  , status_fatca\n  , date_open\n  , secret_phrase\n  , status_desc\n  , version\n  , work_company_name\n  , work_income\n  , work_note\n  , work_origin\n  , risk_class\n  , check_vip\n  , reason\n  , id_north_star\n  , employment_status\n  , income_bracket_code\n  , id_ib_sms\n  , callcenter_date\n  , callcenter_by\n  , user_name\n  , check_ekyc\n  , sale_code\n  , id_image\n  , customer_care\n  , job_designation_code\n  , etl_date\n  , is_number(regexp_substr(sale_code, '[^|]+', 1, 1)) AS valid_sale_code\nFROM \n  oracle_bulanding.df_2.jupiter_cif_register_history @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__jupiter_cif_register_history"}, "model.dga_data_model.stg_landing__jupiter_customer_temp": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.jupiter_customer_temp @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "create_time"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__jupiter_customer_temp"], "unique_id": "model.dga_data_model.stg_landing__jupiter_customer_temp", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    id\r\n  , cif_id\r\n  , account_id\r\n  , card_id\r\n  , new_email\r\n  , new_mobiphone\r\n  , status\r\n  , ib_service_id\r\n  , sms_service_id\r\n  , maker\r\n  , checker\r\n  , sub_branch\r\n  , create_time\r\n  , update_time\r\n  , cif_number\r\n  , id_number\r\n  , service_id\r\n  , status_process\r\n  , bankplus_service_id\r\n  , cif_number_company\r\n  , update_em_id\r\n  , update_mp_id\r\n  , update_relatecif_id\r\n  , update_special_id\r\n  , batch_id\r\n  , combo_id\r\n  , reason\r\n  , type_ch\r\n  , verified_user\r\n  , verified_office\r\n  , verified_time\r\n  , product_acc_cr\r\n  , ib_group_serv_cr\r\n  , mb_group_serv_cr\r\n  , id_accountbt\r\n  , activator_user\r\n  , activate_time\r\nFROM\r\n  {{ source('daily_bulanding', 'jupiter_customer_temp @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__jupiter_customer_temp.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__jupiter_customer_temp.sql", "name": "stg_landing__jupiter_customer_temp", "alias": "stg_landing__jupiter_customer_temp", "checksum": {"name": "sha256", "checksum": "9cd8c58f703b578e33623c13a7bd5eb99395b5ea5312e25faf1afecdd119e7dd"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "jupiter_customer_temp @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3", "date_column": "create_time"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__jupiter_customer_temp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "create_time"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.107383, "compiled_code": "\nSELECT\n    id\n  , cif_id\n  , account_id\n  , card_id\n  , new_email\n  , new_mobiphone\n  , status\n  , ib_service_id\n  , sms_service_id\n  , maker\n  , checker\n  , sub_branch\n  , create_time\n  , update_time\n  , cif_number\n  , id_number\n  , service_id\n  , status_process\n  , bankplus_service_id\n  , cif_number_company\n  , update_em_id\n  , update_mp_id\n  , update_relatecif_id\n  , update_special_id\n  , batch_id\n  , combo_id\n  , reason\n  , type_ch\n  , verified_user\n  , verified_office\n  , verified_time\n  , product_acc_cr\n  , ib_group_serv_cr\n  , mb_group_serv_cr\n  , id_accountbt\n  , activator_user\n  , activate_time\nFROM\n  oracle_bulanding.df_2.jupiter_customer_temp @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__jupiter_customer_temp"}, "model.dga_data_model.stg_landing__loan_application_facility": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.loan_application_facility @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__loan_application_facility"], "unique_id": "model.dga_data_model.stg_landing__loan_application_facility", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    application_number AS af_application_no\r\n  , facility_name AS af_facility_code\r\n  , sequence_number AS af_facility_seq\r\n  , bank_number\r\n  , branch_number AS af_branch_code\r\n  , currency_type AS af_currency\r\n  , cp_no AS af_acf_no\r\n  , facility_cif_no AS af_application_cif\r\n  , main_facility\r\n  , main_facility_aa_no\r\n  , main_facility_code AS af_facility_mother_code\r\n  , main_facility_seq_no AS af_facility_mother_seq\r\n  , stanby_line\r\n  , level_ AS af_facility_level\r\n  , revol_non_revol AS af_facility_revolving\r\n  , rev_bal_or_orgamt\r\n  , product_type\r\n  , amount_applied AS af_apply_limit\r\n  , amount_approved AS af_approved_limit\r\n  , facility_limit AS af_facility_limit\r\n  , earmark_amount\r\n  , date_entered_6\r\n  , date_entered_7\r\n  , application_date_6\r\n  , application_date_7\r\n  , dt_sent_to_6\r\n  , dt_sent_to_7\r\n  , dt_recv_fr_6\r\n  , dt_recv_fr_7\r\n  , date_of_offer_6\r\n  , date_of_offer_7 AS af_date_of_offer\r\n  , date_offer_accepted_6\r\n  , date_offer_accepted_7 AS af_date_offer_accepted\r\n  , date_approved_6\r\n  , date_approved_7 AS af_date_approved\r\n  , approved_by\r\n  , canc_rej_code\r\n  , canc_rej_date_cn_6\r\n  , canc_rej_date_cn_7\r\n  , last_excess_date_7\r\n  , last_excess_date_6\r\n  , last_excess_amount\r\n  , yesterday_collateral_value\r\n  , payment_amount\r\n  , final_payment_amount\r\n  , term AS af_facility_term\r\n  , term_code AS af_facility_term_code\r\n  , purpose AS af_purpose_code\r\n  , ccb_purpose_code\r\n  , car_code_flag\r\n  , car_code\r\n  , classification_amt_1st\r\n  , classification_code_2nd\r\n  , prev_2nd_classification_code\r\n  , classification_amt_2nd\r\n  , transfer_to_npamu\r\n  , date_tran_to_npamu_6\r\n  , date_tran_npamu_7\r\n  , decision_center AS af_decision_center\r\n  , previous_car_code\r\n  , reason_for_classfication\r\n  , date_classified_6\r\n  , date_classified_7\r\n  , previous_date_clas_6\r\n  , previous_date_clas_7\r\n  , fee\r\n  , bank_subs_legal_fees\r\n  , last_revaluation_date_6\r\n  , last_revaluation_date_7\r\n  , last_revaluation_time\r\n  , collateral_value\r\n  , officer\r\n  , department_code\r\n  , secured_unsecured AS af_secure_unsecured_partial\r\n  , document_status\r\n  , facility_status AS af_acf_status\r\n  , interest_base\r\n  , mode_of_interest\r\n  , year_base\r\n  , interest_rate AS af_facility_rate\r\n  , prime_raten\r\n  , prime_variance\r\n  , prime_variance_code\r\n  , prime_rate_floor\r\n  , prime_rate_ceiling\r\n  , prime_review_date_6\r\n  , prime_review_date_7\r\n  , prime_review_term\r\n  , prime_review_term_code\r\n  , collateral_type\r\n  , od_excess_rate_var\r\n  , od_excess_rate_var_code\r\n  , inc_dec_amount\r\n  , status\r\n  , date_applied_6\r\n  , date_applied_7\r\n  , date_approved_ar_6\r\n  , date_approved_ar_7\r\n  , canc_rej_date_icn_6\r\n  , canc_rej_date_icn_7\r\n  , share_variance\r\n  , share_variance_code\r\n  , flat_rate_shares\r\n  , par_value_shares\r\n  , dealer_number\r\n  , late_charge_type\r\n  , comission_fees\r\n  , handling_fees\r\n  , subsidy_amount\r\n  , others_fee\r\n  , comission_rate\r\n  , comission_basis\r\n  , maximum_comission\r\n  , minimum_comission\r\n  , standby_line_fac_code\r\n  , standby_line_fac_cod_seq\r\n  , facility_expiry_date_6\r\n  , facility_expiry_date_7\r\n  , fac_commitment_rate\r\n  , fac_commitment_rate_no\r\n  , fac_com_fee_accr_int\r\n  , original_amount\r\n  , exempt_type\r\n  , amount_utilised\r\n  , computerised\r\n  , spec_provision\r\n  , int_in_suspense\r\n  , os_balance\r\n  , payment_code\r\n  , payment_frequency\r\n  , payment_freq_code\r\n  , int_payment_frequency\r\n  , int_payment_freq_code\r\n  , grace_period\r\n  , grace_code\r\n  , floor_pledged_limit\r\n  , actual_pledged_limit\r\n  , pledged_percentage\r\n  , advance_ratio\r\n  , approved_by_i\r\n  , inc_dec_expiry_date_6\r\n  , inc_dec_expiry_date_7\r\n  , alt_schedule\r\n  , min_int_days\r\n  , effective_interest_rate\r\n  , advance_margin\r\n  , avail_period_in_mths\r\n  , avail_period_in_days\r\n  , retention_sum\r\n  , retention_period\r\n  , retention_period_code\r\n  , promotion_code\r\n  , source_code\r\n  , delivery_channel\r\n  , workflow_status\r\n  , lawyer_code\r\n  , disbursement_manner\r\n  , source_of_fund\r\n  , used_of_fund\r\n  , cal_1st_instl_date\r\n  , iso_referral_no\r\n  , rating_code\r\n  , next_review_date_6\r\n  , next_review_date_7\r\n  , review_term\r\n  , review_term_code\r\n  , allow_incentive\r\n  , payment_freq_cust\r\n  , payment_freq_code_cust\r\n  , payment_freq_inst\r\n  , payment_freq_code_inst\r\n  , rate_applied_cust\r\n  , rate_applied_inst\r\n  , date_approved_cgc_6\r\n  , date_approved_cgc_7\r\n  , alternate_rate\r\n  , developer_code\r\n  , credit_line_indicator\r\n  , created_user\r\n  , created_date_7\r\n  , created_date_6\r\n  , created_time\r\n  , user_id\r\n  , workstation_id\r\n  , last_maint_date_6\r\n  , last_maint_date_7\r\n  , last_maint_time\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'loan_application_facility @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__loan_application_facility.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__loan_application_facility.sql", "name": "stg_landing__loan_application_facility", "alias": "stg_landing__loan_application_facility", "checksum": {"name": "sha256", "checksum": "3b6acc9dc96ebaba042071ea6febb4aa900f0bf0b4abe1cb2ff508744d62ad23"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "loan_application_facility @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__loan_application_facility.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.110374, "compiled_code": "\nSELECT\n    application_number AS af_application_no\n  , facility_name AS af_facility_code\n  , sequence_number AS af_facility_seq\n  , bank_number\n  , branch_number AS af_branch_code\n  , currency_type AS af_currency\n  , cp_no AS af_acf_no\n  , facility_cif_no AS af_application_cif\n  , main_facility\n  , main_facility_aa_no\n  , main_facility_code AS af_facility_mother_code\n  , main_facility_seq_no AS af_facility_mother_seq\n  , stanby_line\n  , level_ AS af_facility_level\n  , revol_non_revol AS af_facility_revolving\n  , rev_bal_or_orgamt\n  , product_type\n  , amount_applied AS af_apply_limit\n  , amount_approved AS af_approved_limit\n  , facility_limit AS af_facility_limit\n  , earmark_amount\n  , date_entered_6\n  , date_entered_7\n  , application_date_6\n  , application_date_7\n  , dt_sent_to_6\n  , dt_sent_to_7\n  , dt_recv_fr_6\n  , dt_recv_fr_7\n  , date_of_offer_6\n  , date_of_offer_7 AS af_date_of_offer\n  , date_offer_accepted_6\n  , date_offer_accepted_7 AS af_date_offer_accepted\n  , date_approved_6\n  , date_approved_7 AS af_date_approved\n  , approved_by\n  , canc_rej_code\n  , canc_rej_date_cn_6\n  , canc_rej_date_cn_7\n  , last_excess_date_7\n  , last_excess_date_6\n  , last_excess_amount\n  , yesterday_collateral_value\n  , payment_amount\n  , final_payment_amount\n  , term AS af_facility_term\n  , term_code AS af_facility_term_code\n  , purpose AS af_purpose_code\n  , ccb_purpose_code\n  , car_code_flag\n  , car_code\n  , classification_amt_1st\n  , classification_code_2nd\n  , prev_2nd_classification_code\n  , classification_amt_2nd\n  , transfer_to_npamu\n  , date_tran_to_npamu_6\n  , date_tran_npamu_7\n  , decision_center AS af_decision_center\n  , previous_car_code\n  , reason_for_classfication\n  , date_classified_6\n  , date_classified_7\n  , previous_date_clas_6\n  , previous_date_clas_7\n  , fee\n  , bank_subs_legal_fees\n  , last_revaluation_date_6\n  , last_revaluation_date_7\n  , last_revaluation_time\n  , collateral_value\n  , officer\n  , department_code\n  , secured_unsecured AS af_secure_unsecured_partial\n  , document_status\n  , facility_status AS af_acf_status\n  , interest_base\n  , mode_of_interest\n  , year_base\n  , interest_rate AS af_facility_rate\n  , prime_raten\n  , prime_variance\n  , prime_variance_code\n  , prime_rate_floor\n  , prime_rate_ceiling\n  , prime_review_date_6\n  , prime_review_date_7\n  , prime_review_term\n  , prime_review_term_code\n  , collateral_type\n  , od_excess_rate_var\n  , od_excess_rate_var_code\n  , inc_dec_amount\n  , status\n  , date_applied_6\n  , date_applied_7\n  , date_approved_ar_6\n  , date_approved_ar_7\n  , canc_rej_date_icn_6\n  , canc_rej_date_icn_7\n  , share_variance\n  , share_variance_code\n  , flat_rate_shares\n  , par_value_shares\n  , dealer_number\n  , late_charge_type\n  , comission_fees\n  , handling_fees\n  , subsidy_amount\n  , others_fee\n  , comission_rate\n  , comission_basis\n  , maximum_comission\n  , minimum_comission\n  , standby_line_fac_code\n  , standby_line_fac_cod_seq\n  , facility_expiry_date_6\n  , facility_expiry_date_7\n  , fac_commitment_rate\n  , fac_commitment_rate_no\n  , fac_com_fee_accr_int\n  , original_amount\n  , exempt_type\n  , amount_utilised\n  , computerised\n  , spec_provision\n  , int_in_suspense\n  , os_balance\n  , payment_code\n  , payment_frequency\n  , payment_freq_code\n  , int_payment_frequency\n  , int_payment_freq_code\n  , grace_period\n  , grace_code\n  , floor_pledged_limit\n  , actual_pledged_limit\n  , pledged_percentage\n  , advance_ratio\n  , approved_by_i\n  , inc_dec_expiry_date_6\n  , inc_dec_expiry_date_7\n  , alt_schedule\n  , min_int_days\n  , effective_interest_rate\n  , advance_margin\n  , avail_period_in_mths\n  , avail_period_in_days\n  , retention_sum\n  , retention_period\n  , retention_period_code\n  , promotion_code\n  , source_code\n  , delivery_channel\n  , workflow_status\n  , lawyer_code\n  , disbursement_manner\n  , source_of_fund\n  , used_of_fund\n  , cal_1st_instl_date\n  , iso_referral_no\n  , rating_code\n  , next_review_date_6\n  , next_review_date_7\n  , review_term\n  , review_term_code\n  , allow_incentive\n  , payment_freq_cust\n  , payment_freq_code_cust\n  , payment_freq_inst\n  , payment_freq_code_inst\n  , rate_applied_cust\n  , rate_applied_inst\n  , date_approved_cgc_6\n  , date_approved_cgc_7\n  , alternate_rate\n  , developer_code\n  , credit_line_indicator\n  , created_user\n  , created_date_7\n  , created_date_6\n  , created_time\n  , user_id\n  , workstation_id\n  , last_maint_date_6\n  , last_maint_date_7\n  , last_maint_time\n  , etl_date\nFROM \n  oracle_bulanding.df_2.loan_application_facility @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__loan_application_facility"}, "model.dga_data_model.stg_landing__loan_master001_2020001_2021212": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__loan_master001_2020001_2021212"], "unique_id": "model.dga_data_model.stg_landing__loan_master001_2020001_2021212", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n    etl_date\r\n  , branch_code_sk\r\n  , account_no_sk\r\n  , customer_sk\r\n  , contract_sk\r\n  , aano_sk\r\n  , currency\r\n  , product_sk\r\n  , acy_original_amt\r\n  , lcy_original_amt\r\n  , drawdown_limit\r\n  , released_amt\r\n  , acy_outstanding_bal\r\n  , lcy_outstanding_bal\r\n  , status\r\n  , status_since\r\n  , classified_type\r\n  , overdue_status_sk\r\n  , group_overdue_status_sk\r\n  , final_maturity_dt\r\n  , interest\r\n  , based_rate\r\n  , next_review_dt\r\n  , rate_review_dt\r\n  , prime_review_dt\r\n  , last_pliq_amt\r\n  , last_pliq_dt\r\n  , next_pliq_dt\r\n  , last_iliq_dt\r\n  , next_iliq_dt\r\n  , payment_amt\r\n  , final_payment_amt\r\n  , ltd_int_paid\r\n  , ltd_prn_paid\r\n  , last_accr_amt\r\n  , acy_std_accr_amt\r\n  , lcy_std_accr_amt\r\n  , acy_std_accr_penalty_amt\r\n  , lcy_std_accr_penalty_amt\r\n  , acy_ltd_accr_amt\r\n  , lcy_ltd_accr_amt\r\n  , prin_overdue_days\r\n  , acy_prin_overdue_amt\r\n  , int_overdue_days\r\n  , acy_int_overdue_amt\r\n  , acy_total_overdue_amt\r\n  , lcy_total_overdue_amt\r\n  , acy_late_charge\r\n  , dealer_id\r\n  , purpose_sk\r\n  , industry_sk\r\n  , tenor_code_sk\r\n  , maker_sk\r\n  , maker_dt_stamp\r\n  , checker_sk\r\n  , checker_dt_stamp\r\n  , officer_sk\r\n  , ftp_rate\r\n  , actual_overdue_status_sk\r\n  , bil_prin_amt\r\n  , bil_int_amt\r\n  , bil_lc_amt\r\n  , lcy_prin_overdue_amt\r\n  , lcy_int_overdue_amt\r\n  , lcy_late_charge\r\n  , part_industry_sk\r\n  , year_base\r\nFROM\r\n  {{ source('daily_bulanding', 'loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__loan_master001_2020001_2021212.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__loan_master001_2020001_2021212.sql", "name": "stg_landing__loan_master001_2020001_2021212", "alias": "stg_landing__loan_master001_2020001_2021212", "checksum": {"name": "sha256", "checksum": "f51b4b3f10fc2af86fa5d1f9dad25b7692f0b6bffb39042cba51becc3d31fed1"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__loan_master001_2020001_2021212.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1163378, "compiled_code": "\nSELECT\n    etl_date\n  , branch_code_sk\n  , account_no_sk\n  , customer_sk\n  , contract_sk\n  , aano_sk\n  , currency\n  , product_sk\n  , acy_original_amt\n  , lcy_original_amt\n  , drawdown_limit\n  , released_amt\n  , acy_outstanding_bal\n  , lcy_outstanding_bal\n  , status\n  , status_since\n  , classified_type\n  , overdue_status_sk\n  , group_overdue_status_sk\n  , final_maturity_dt\n  , interest\n  , based_rate\n  , next_review_dt\n  , rate_review_dt\n  , prime_review_dt\n  , last_pliq_amt\n  , last_pliq_dt\n  , next_pliq_dt\n  , last_iliq_dt\n  , next_iliq_dt\n  , payment_amt\n  , final_payment_amt\n  , ltd_int_paid\n  , ltd_prn_paid\n  , last_accr_amt\n  , acy_std_accr_amt\n  , lcy_std_accr_amt\n  , acy_std_accr_penalty_amt\n  , lcy_std_accr_penalty_amt\n  , acy_ltd_accr_amt\n  , lcy_ltd_accr_amt\n  , prin_overdue_days\n  , acy_prin_overdue_amt\n  , int_overdue_days\n  , acy_int_overdue_amt\n  , acy_total_overdue_amt\n  , lcy_total_overdue_amt\n  , acy_late_charge\n  , dealer_id\n  , purpose_sk\n  , industry_sk\n  , tenor_code_sk\n  , maker_sk\n  , maker_dt_stamp\n  , checker_sk\n  , checker_dt_stamp\n  , officer_sk\n  , ftp_rate\n  , actual_overdue_status_sk\n  , bil_prin_amt\n  , bil_int_amt\n  , bil_lc_amt\n  , lcy_prin_overdue_amt\n  , lcy_int_overdue_amt\n  , lcy_late_charge\n  , part_industry_sk\n  , year_base\nFROM\n  oracle_bulanding.df_2.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__loan_master001_2020001_2021212"}, "model.dga_data_model.stg_landing__loan_master002": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.loan_master002 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__loan_master002"], "unique_id": "model.dga_data_model.stg_landing__loan_master002", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    record_identifier\r\n  , bank_number\r\n  , branch_number\r\n  , reporting_branch\r\n  , account_number\r\n  , account_type\r\n  , account_group_number\r\n  , aa_no\r\n  , facility_code\r\n  , seq_no\r\n  , customer_number\r\n  , account_name\r\n  , short_name\r\n  , formatted_short_name\r\n  , account_name_1\r\n  , account_name_2\r\n  , care_of\r\n  , effective_rate_indicator\r\n  , class_code\r\n  , officer\r\n  , account_keeper\r\n  , status\r\n  , application_type\r\n  , loan_type\r\n  , short_description\r\n  , currency_type\r\n  , currency_decimals\r\n  , group_code\r\n  , loan_group\r\n  , cost_center\r\n  , product_code\r\n  , gl_book\r\n  , ioc\r\n  , multi_ccy_loan_code\r\n  , splitmerge_status\r\n  , sptf_loan_type\r\n  , interest_base\r\n  , interest_freq\r\n  , year_base\r\n  , payment_code\r\n  , principal_original_amount\r\n  , drawing_limit\r\n  , amount_release\r\n  , earmark_amount\r\n  , memo_post_amount\r\n  , prev_rest_balance\r\n  , account_balance\r\n  , interest_payable\r\n  , minimum_charge\r\n  , min_int_days\r\n  , earn_additional_day_int\r\n  , current_month_payoff\r\n  , next_month_payoff\r\n  , last_excess_amount\r\n  , principal_balance\r\n  , other_charges\r\n  , misc_cost\r\n  , assessed_late_charges\r\n  , paid_late_charges\r\n  , bank_discount\r\n  , bank_discount_2\r\n  , dealer_discount\r\n  , credit_life_premium\r\n  , a_h_ins_premium\r\n  , misc_ins_premium\r\n  , interest_rebate\r\n  , interest_rebate_n2\r\n  , dealer_rebate\r\n  , cr_life_ins_rebate\r\n  , ah_ins_rebate\r\n  , misc_ins_rebate\r\n  , accrued_interest\r\n  , secondary_accrued_int\r\n  , m_t_d_dealer_accrued_int\r\n  , commitment_fee_accr_int\r\n  , accrued_penalty_interest\r\n  , advance_accrue_interest\r\n  , advance_accrue_lcharges\r\n  , advance_accrue_com_fees\r\n  , advance_earned_interest\r\n  , advance_dealer_acc_int\r\n  , adv_sus_accrue_interest\r\n  , adv_sus_earned_interest\r\n  , adv_sus_acc_lc_interest\r\n  , daily_accrual\r\n  , daily_accr_late_chg\r\n  , daily_accr_comm_fee\r\n  , daily_dealer_accr\r\n  , today_accrued_int\r\n  , today_accrued_lc\r\n  , today_acc_com_fee\r\n  , today_dealer_accrue\r\n  , new_payment_amount\r\n  , new_pymt_effective_date\r\n  , new_pymt_effective_date2\r\n  , original_payment_amount\r\n  , original_payment_code\r\n  , original_payment_freq\r\n  , payment_amount\r\n  , final_payment\r\n  , last_pymt_amount\r\n  , partial_pymt_amt\r\n  , advance_payment\r\n  , capital_repayment\r\n  , residue_value\r\n  , minumum_balance\r\n  , maximum_balance\r\n  , developer_limit\r\n  , dev_avail_bal\r\n  , billed_prin_amt\r\n  , billed_int_amt\r\n  , billed_escrow_amt\r\n  , billed_late_chgs\r\n  , billed_other_chgs\r\n  , billed_misc_cost\r\n  , billed_prin_amt_od\r\n  , billed_int_amt_od\r\n  , billed_escrow_amt_od\r\n  , billed_late_chgs_od\r\n  , billed_other_chgs_od\r\n  , billed_misc_cost_od\r\n  , work_field_bill_prin\r\n  , work_field_bill_int\r\n  , no_of_days_for_billing\r\n  , rebilling\r\n  , rebilling_grace_day\r\n  , yesterday_os_bal\r\n  , yesterday_balance\r\n  , yesterdays_other_chgs\r\n  , yesterdays_misc_cost\r\n  , yesterdays_assessed_lc\r\n  , yesterdays_paid_lc\r\n  , yesterdays_accrued_int\r\n  , yesterdays_accrued_lc\r\n  , yesterdays_acc_com_fee\r\n  , yesterdays_dealer_accrue\r\n  , yesterdays_int_rebate\r\n  , yesterdays_int_rebate_2\r\n  , yesterday_dealer_rebate\r\n  , yesterdays_cl_rebate\r\n  , yesterdays_ah_rebate\r\n  , yesterdays_misc_ins_reb\r\n  , yesterdays_accrual_bal\r\n  , yesterdays_accrual_rate\r\n  , yesterdays_accr_yr_base\r\n  , yesterdays_cf_accr_bal\r\n  , yesterdays_cf_accr_rate\r\n  , yesterdays_cf_year_base\r\n  , yesterdays_lc_accr_bal\r\n  , yesterdays_lc_accr_rate\r\n  , yest_lc_accr_bal_int\r\n  , yest_lc_accr_rate_int\r\n  , yesterdays_lc_year_base\r\n  , yesterdays_dlr_accr_bal\r\n  , yesterdays_dlr_accr_rate\r\n  , yesterdays_dlr_year_base\r\n  , previous_mth_os\r\n  , last_mth_end_current_bal\r\n  , last_mth_end_other_chgs\r\n  , last_mth_end_misc_cost\r\n  , last_mth_end_assessed_lc\r\n  , last_mth_end_paid_lc\r\n  , last_mth_end_interest\r\n  , last_mtd_acc_penalty_int\r\n  , last_mtd_comm_acc_int\r\n  , last_mtd_dealer_acc\r\n  , last_mth_end_int_rebate\r\n  , last_mth_end_int_reb_2\r\n  , last_mth_end_dealer_reb\r\n  , last_mth_end_cl_rebate\r\n  , last_mth_end_ah_rebate\r\n  , last_mth_end_mis_ins_reb\r\n  , yearly_opening_bal\r\n  , prev_yr_int_in_susp_wb\r\n  , prevyr_int_in_susp_wo\r\n  , prevyr_write_back_prov\r\n  , prevyr_write_off_prov\r\n  , opening_int_in_susp\r\n  , last_year_int_in_susp\r\n  , previous_mth_int_in_sus\r\n  , last_year_provision\r\n  , last_month_provision\r\n  , last_year_write_back\r\n  , last_year_write_off\r\n  , prev_year_dealer_rebate\r\n  , int_paid_last_year\r\n  , lc_paid_last_year\r\n  , irs_interest_last_year\r\n  , times_extended_last_yr\r\n  , org_fees_last_year\r\n  , accrued_int_at_year_end\r\n  , int_rebate_at_year_end\r\n  , mtd_int_paid\r\n  , mtd_principal_paid\r\n  , mtd_lc_paid\r\n  , mtd_misc_chg_paid\r\n  , mtd_other_chg_paid\r\n  , mtd_payms_received\r\n  , mtd_redemption\r\n  , mtd_amount_release\r\n  , mtd_accr_int_debit\r\n  , mtd_late_chg_debit\r\n  , mtd_misc_chg_debit\r\n  , mtd_other_chg_debit\r\n  , ytd_interest_paid\r\n  , ytd__principal_paid\r\n  , ytd_late_chgs_paid\r\n  , ytd_misc_chg_paid\r\n  , ytd_other_chg_paid\r\n  , ytd_payms_received\r\n  , ytd_redemption\r\n  , ytd_amount_release\r\n  , ytd_accr_int_debit\r\n  , ytd_late_chg_debit\r\n  , ytd_misc_chg_debit\r\n  , ytd_other_chg_debit\r\n  , ytd_extension_fees\r\n  , ytd_times_extended\r\n  , ytd_right_to_cures\r\n  , ltd_interest_paid\r\n  , ltd_principal_paid\r\n  , ltd_lc_paid\r\n  , ltd_misc_chg_paid\r\n  , ltd_other_chg_paid\r\n  , ltd_payms_received\r\n  , ltd_redemption\r\n  , ltd_accr_int_debit\r\n  , ltd_late_chg_debit\r\n  , ltd_misc_chg_debit\r\n  , ltd_other_chg_debit\r\n  , ltd_capital__repayment\r\n  , ltd_extension_fees\r\n  , ltd_times_renewed\r\n  , ltd_irs_interest\r\n  , ltd_org_fees\r\n  , ltd_times_extended\r\n  , ltd_right_to_cures\r\n  , ltd_months_extended\r\n  , date_last_statement\r\n  , date_last_statement2\r\n  , balance_last_stmt\r\n  , statement_cycle\r\n  , statement_code\r\n  , total_accrual_float\r\n  , tot_availibility_float\r\n  , total_cash_float\r\n  , total_oc_amount\r\n  , total_ocp_amount\r\n  , total_odoc_amount\r\n  , total_mc_amount\r\n  , total_ibt_amount\r\n  , total_llc_amount\r\n  , total_xtr_amount\r\n  , date_entered\r\n  , date_entered2\r\n  , original_loan_date\r\n  , original_loan_date2\r\n  , availability_expiry_date\r\n  , availability_expiry_date2\r\n  , disburse_date\r\n  , first_release_date\r\n  , last_release_date\r\n  , last_release_date2\r\n  , full_rel_date\r\n  , full_rel_date2\r\n  , original_maturity_date\r\n  , original_maturity_date2\r\n  , principal_maturity_date\r\n  , maturity_date\r\n  , final_maturity_date\r\n  , final_maturity_date2\r\n  , int_maturity_date\r\n  , int_maturity_date2\r\n  , next_review_date\r\n  , next_review_date2\r\n  , prime_review_date\r\n  , prime_review_date2\r\n  , prime_review_day\r\n  , rate_user_manual_review_date\r\n  , rate_user_manual_review_date2\r\n  , rate_user_manual_review_day\r\n  , next_sched_pymt_date\r\n  , next_sched_pymt_date2\r\n  , first_pymt_date\r\n  , first_pymt_date2\r\n  , last_pymt_date\r\n  , last_pymt_date2\r\n  , next_pymt_due_date\r\n  , next_pymt_due_date2\r\n  , pymt_day_of_month\r\n  , next_interest_repayment_date\r\n  , next_int_pymt_due_date\r\n  , nxt_sch_int_pymet_due_dt\r\n  , nxt_sch_int_pymet_due_dt2\r\n  , int_pymt_day_of_month\r\n  , pymt_good_thru_date\r\n  , pymt_good_thru_date2\r\n  , int_paid_to_date\r\n  , int_paid_to_date2\r\n  , prevint_paid_to_date\r\n  , prevint_paid_to_date2\r\n  , date_of_refund\r\n  , date_of_refund2\r\n  , last_rebate_date\r\n  , last_rebate_date2\r\n  , next_rebate_date\r\n  , next_rebate_date2\r\n  , status_date\r\n  , status_date2\r\n  , payoff_date\r\n  , payoff_date2\r\n  , interest_start_date\r\n  , interest_start_date2\r\n  , accrue_int_eff_date\r\n  , accrue_int_eff_date2\r\n  , first_excess_date_6\r\n  , first_excess_date_7\r\n  , nonaccrual_date\r\n  , nonaccrual_date2\r\n  , chg_off_date\r\n  , chg_off_date2\r\n  , date_on_watch_list\r\n  , date_on_watch_list2\r\n  , reschedule_date\r\n  , reschedule_date2\r\n  , variation_date\r\n  , variation_date2\r\n  , last_right_to_cure_date\r\n  , last_right_to_cure_date2\r\n  , date_extended\r\n  , date_renewedextended\r\n  , examiner_class_date\r\n  , examiner_class_date2\r\n  , date_last_cheq_return\r\n  , date_last_cheq_return2\r\n  , coupon_book_reorder_date\r\n  , coupon_book_reorder_date2\r\n  , cl_ins_exp_date\r\n  , cl_ins_exp_date2\r\n  , ah_ins_exp_date\r\n  , ah_ins_exp_date2\r\n  , collat_ins_expiration\r\n  , collat_ins_expiration2\r\n  , availability_start_date\r\n  , availability_start_date2\r\n  , letter_of_offer_date_6\r\n  , letter_of_offer_date_7\r\n  , date_of_next_rest\r\n  , date_of_next_rest2\r\n  , date_claim_sub_to_cgc\r\n  , date_claim_sub_to_cgc2\r\n  , date_cgc_notified_of_npl\r\n  , date_cgc_notified_of_npl2\r\n  , date_fee_paid_to_cgc\r\n  , date_fee_paid_to_cgc2\r\n  , cgc_expiry_date\r\n  , cgc_expiry_date2\r\n  , interest_rate\r\n  , dealer_rate\r\n  , maturity_rate\r\n  , prime_rate_number\r\n  , prime_variance\r\n  , prime_variance_code\r\n  , prime_rate_floor\r\n  , prime_rate_ceiling\r\n  , rate_var_floor\r\n  , rate_var_ceiling\r\n  , prime_review_term\r\n  , prime_review_term_code\r\n  , rate_user_manual_review_term\r\n  , term_code_manual_rate_review\r\n  , effective_rate\r\n  , two_tier_rate\r\n  , late_charge_type\r\n  , late_charge_rate\r\n  , late_chg_grace_period\r\n  , lc_grace_int_servicing\r\n  , lc_accr_year_base\r\n  , accrue_memo_late_charges\r\n  , memo_late_charges\r\n  , accrue_on__lc_rate_flag\r\n  , late_chg_on_int_type\r\n  , late_chg_on_int_rate\r\n  , lc_on_int_grace_period\r\n  , lc_on_int_grace_int_srvc\r\n  , amt_to_be_released\r\n  , commitment_rate\r\n  , commitment_rate_no\r\n  , com_fee_accr_year_base\r\n  , min_usage_limit\r\n  , min_usage_lmt_pct_of_ln_am\r\n  , undrawn_limit\r\n  , pct_of_total_undrawn\r\n  , undrawn_lmt_excess_rate\r\n  , undrawn_pct_if_above_lmt\r\n  , principal_term\r\n  , principal_term_code\r\n  , permanent_no_maturity\r\n  , max_roll_term\r\n  , max_roll_term_code\r\n  , payment_frequency\r\n  , payment_freq_code\r\n  , interest_term\r\n  , interest_term_code\r\n  , retention_period\r\n  , retention_period_code\r\n  , no_of_instls_paid\r\n  , no_of_advance_instl_due\r\n  , current_payment_no\r\n  , no_of__instalment_paid\r\n  , revolving\r\n  , rollover_method\r\n  , alternate_pymt_sched\r\n  , drawndown_schd\r\n  , tiered_loan\r\n  , alternate_rate\r\n  , standing_inst_code\r\n  , tuition_fees\r\n  , cpf_flag\r\n  , giro\r\n  , subsidized_by_3rd_party\r\n  , specprov_flag\r\n  , cal_rate_base_on_dep_acc\r\n  , rate_tied_to_avg_of_bks\r\n  , prin_repaym_schd\r\n  , prin_inverse_order\r\n  , auto_pay_int_by_unutil_prin\r\n  , loan_limit_schd\r\n  , tranche_working_schd\r\n  , s__p_schd\r\n  , secondary_loan\r\n  , sec_loan_valid_period\r\n  , promotion_flag\r\n  , introducer_code\r\n  , bnm_exempt\r\n  , group_staff\r\n  , allwed_incentive\r\n  , overdue_indicator\r\n  , prev_overdue_indicator\r\n  , date_set_overdue_ind\r\n  , date_set_overdue_ind2\r\n  , waive_late_charge\r\n  , waive_commitment_fee\r\n  , waive_hold_mail_charges\r\n  , reminder_code\r\n  , re_lease\r\n  , territory_code\r\n  , collteral_type\r\n  , switch_pmtcod_x_amt_rel\r\n  , release_document_comp\r\n  , cal_instl_nearest_d\r\n  , user_code_1\r\n  , user_code_2\r\n  , sic_code_1\r\n  , sic_code_2\r\n  , sic_code_3\r\n  , sic_code_4\r\n  , set_fpdt_upon_first_rel\r\n  , cal_first_instl_date\r\n  , auto_update_pymt_cpde\r\n  , default_pymt_cpde\r\n  , nmth_grace_on_bkdisc_cal\r\n  , disburse_onbef_day\r\n  , day_for_auto_first_pymt\r\n  , auto_set_nipdt\r\n  , disburse_onbef_day2\r\n  , day_for_auto_nipdt\r\n  , auto_extend_maturity_dat\r\n  , maturity_calc_method\r\n  , auto_set_maturity_date\r\n  , dealer_cal_mathod\r\n  , dealer_com_payment\r\n  , insider_code\r\n  , participation_code\r\n  , credit_line_code\r\n  , department_code\r\n  , purpose_code\r\n  , call_report_code\r\n  , dealer_participation_n\r\n  , dealer_group\r\n  , refinance_from\r\n  , refinance_to\r\n  , hold_mail_code\r\n  , waive_hold_mail\r\n  , include_on_stmt_code\r\n  , print_billing_notice\r\n  , prnt_confirmation_letter\r\n  , past_due_notice_code\r\n  , past_due_history_flag\r\n  , send_past_due_notice\r\n  , on_past_due_report\r\n  , classification_type\r\n  , investment_ac\r\n  , credit_rating_code\r\n  , special_message_flag\r\n  , teller_special_status\r\n  , escrowmortgage_info\r\n  , close_on_zero_bal_code\r\n  , cl_insurance_company_n\r\n  , ah_insurance_company_n\r\n  , misc_insurance_company_n\r\n  , print_coupon_book_flag\r\n  , coupon_book_term\r\n  , arm_info_code\r\n  , alm_type\r\n  , participation_percent\r\n  , partchg_off_acct_num\r\n  , cr_line_acct_num\r\n  , deal_no\r\n  , notice_pre_days\r\n  , include_escrow_in_payoff\r\n  , requires_1098\r\n  , stmt_or_passbook_code\r\n  , watch_list_code\r\n  , interest_free_amount\r\n  , int_free_pmt_portion\r\n  , amortized_pymt_suspense\r\n  , one_mo_int_on_amort_loan\r\n  , interest_trnxpaid_today\r\n  , reamortize_alt_sch_exp\r\n  , reamortize_payment_amt\r\n  , reamortise_when_cp\r\n  , reamortise_pymt_grace\r\n  , reamortise_upon_disburse\r\n  , reamortize_rate_chg_opt\r\n  , reamortize_caprep_opt\r\n  , reamortize_disburse_opt\r\n  , board_applies_yn\r\n  , rate_duration\r\n  , update_mat_dt__rate_chg\r\n  , update_mat_date___cp\r\n  , update_mat_date___disb\r\n  , purchase_contract_no\r\n  , purchase_value\r\n  , purchase_contract_rate\r\n  , date_redeem___cagamas\r\n  , date_redeem___cagamas2\r\n  , date_of_purchase\r\n  , date_of_purchase2\r\n  , mthly_instl_cagamas\r\n  , cagamas_qualify\r\n  , npl_flag\r\n  , npl_status\r\n  , yesterday_npl_status\r\n  , npl_status_b4_variation\r\n  , npl_date\r\n  , npl_date2\r\n  , variation_npl_status\r\n  , amount_in_default_before\r\n  , months_in_default_before\r\n  , total_int_unpaid\r\n  , total_int_in_susp\r\n  , total_lc_in_susp\r\n  , taxable_int_in_susp\r\n  , non_taxable_int_in_susp\r\n  , interest_before_suspense\r\n  , late_charges_b4_suspense\r\n  , prev_npl_status_date\r\n  , prev_npl_status_date2\r\n  , int_payment_after_npl\r\n  , payment_after_pl\r\n  , int_rebate_on_pl_date\r\n  , int_before_non_taxable\r\n  , npl_allocate_int_first\r\n  , start_mth_cont_12_mths\r\n  , judgement__sum\r\n  , judgement_date\r\n  , judgement_date2\r\n  , judgement_sum_accr_int\r\n  , jdsum_accrual_indicator\r\n  , classified_acctcode\r\n  , reason_of_classification\r\n  , previous_car_code\r\n  , date_classified\r\n  , date_classified2\r\n  , previous_date_clas\r\n  , previous_date_clas2\r\n  , yesterday_account_status\r\n  , yesterday_bank_no\r\n  , yesterday_branch_no\r\n  , yesterday_group_code\r\n  , yesterday_cost_centre\r\n  , yesterday_prod_code\r\n  , yesterday_gl_book\r\n  , yesterday_ioc\r\n  , last_transfer_date6_bank\r\n  , last_transfer_date7_bank\r\n  , last_transfer_date6_brn\r\n  , last_transfer_date7_brn\r\n  , lst_trnsfr_date6_gl_grp\r\n  , lst_trnsfr_date7_gl_grp\r\n  , lst_trnsfr_date6_costctr\r\n  , lst_trnsfr_date7_costctr\r\n  , lst_trnsfr_date6_prodcod\r\n  , lst_trnsfr_date7_prodcod\r\n  , lst_trnsfr_date6_glbook\r\n  , lst_trnsfr_date7_glbook\r\n  , last_transfer_date6_ioc\r\n  , last_transfer_date7_ioc\r\n  , subj_int_in_lieu_of_notc\r\n  , part_prepaym_notc_term\r\n  , part_prepaym_notc_tm_cd\r\n  , cmmn_of_prepymt_per_ind\r\n  , cmmn_of_prepymt_date_6\r\n  , cmmn_of_prepymt_date_7\r\n  , early_sett_notc_term\r\n  , early_sett_notc_tm_cd\r\n  , cmmn_of_early_settle_ind\r\n  , cmmn_of_esett_date_6\r\n  , cmmn_of_esett_date_7\r\n  , subj_to_prepaym_fee\r\n  , cpre_pym_pof_win_x_mth\r\n  , calc_if_ful_poff_within\r\n  , prepaym_fee_flat_amt\r\n  , p_fee_pct_of_amt_prepaid\r\n  , p_fee_pct_of_loan_amount\r\n  , p_fee_pct_unexpr_period\r\n  , prepaym_fee_flat_amt2\r\n  , p_fee_pct_of_amt_prepaid2\r\n  , p_fee_pct_of_loan_amount2\r\n  , p_fee_pct_unexpr_period2\r\n  , pct_on_interest_rebate\r\n  , penalty_on_int_rebate\r\n  , tiered_prepayment\r\n  , subj_to_repl_cost\r\n  , repl_cost_flat_amt\r\n  , repcst_pct_of_amt_prepaid\r\n  , repcst_pct_of_loan_amount\r\n  , repl_cost_flat_amt2\r\n  , repcst_pct_of_amt_settled\r\n  , repcst_pct_of_loan_amount2\r\n  , repcst_pct_mmc_interface\r\n  , subj_to_cancel_fee\r\n  , cancel_fee_expr_drw_schd\r\n  , cancel_fee_early_sett\r\n  , esett_cfee_pct_unexpr_dura\r\n  , avail_cfee_pct_of_undrawn\r\n  , avail_cfee_pct_unexpr_dura\r\n  , grace_day_int_lieu_ntc\r\n  , term_from_lo_date\r\n  , term_code_from_lo_date\r\n  , renewedextended_this_mo\r\n  , times_varied_l_t_d\r\n  , times_varied_y_t_d\r\n  , times_reschd_y_t_d\r\n  , times_varied_last_yr\r\n  , times_reschd_last_yr\r\n  , profit_period_late_chgs\r\n  , point_to_point_lc_earn\r\n  , profit_period_ext_fees\r\n  , profit_period_agg_bal\r\n  , profit_period_int_earned\r\n  , point_to_point_int_earn\r\n  , profit_period_agg_days\r\n  , times_past_due_10_29\r\n  , times_past_due_30_59\r\n  , times_past_due_60_89\r\n  , times_past_due_90_o\r\n  , last_year_past_due_10_29\r\n  , last_year_past_due_30_59\r\n  , last_year_past_due_60_89\r\n  , last_year_past_due_90_o\r\n  , l_t_d_past_due_10_29\r\n  , l_t_d_past_due_30_59\r\n  , l_t_d_past_due_60_89\r\n  , l_t_d_past_due_90_o\r\n  , advance_margin\r\n  , retension__sum\r\n  , total_amount_to_be_refund\r\n  , allowable_refund_amount\r\n  , actual_amount_refunded\r\n  , percentage_pledged\r\n  , margin_rate_downupwards\r\n  , invoicechequepn_number\r\n  , type_of_exchange\r\n  , withholding_code\r\n  , collateral_code\r\n  , demandstudent_loan_code\r\n  , standard_industry_code\r\n  , demand_loan_code\r\n  , title_still_needed_code\r\n  , census_tract_1\r\n  , state_code\r\n  , county_code\r\n  , investor_number\r\n  , prepayment_penalty_code\r\n  , loan_scheme_code\r\n  , small_scale_code\r\n  , borrower_code\r\n  , guarantee_no\r\n  , guarantee_cover\r\n  , pgs_effective_date\r\n  , pgs_effective_date2\r\n  , cash_bonus\r\n  , appraised_value\r\n  , current_rest_amount\r\n  , origination_fees_ytd\r\n  , reduced_balance\r\n  , balloon_payment\r\n  , invalid_override\r\n  , batch_number\r\n  , amount_of_proceeds\r\n  , amount_advanced\r\n  , created_user\r\n  , created_date\r\n  , created_date2\r\n  , created_time\r\n  , history_posting_order\r\n  , user_id\r\n  , workstation_id\r\n  , last_maint_date\r\n  , last_maint_date2\r\n  , last_maint_time\r\n  , etl_date\r\nFROM \r\n  {{ source('daily_bulanding', 'loan_master002 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__loan_master002.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__loan_master002.sql", "name": "stg_landing__loan_master002", "alias": "stg_landing__loan_master002", "checksum": {"name": "sha256", "checksum": "6ffdd51b2553da2309cbc1c72db8cf9d7939ca675ef29c6897441da86b9b3b0a"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "loan_master002 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__loan_master002.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1123774, "compiled_code": "\nSELECT \n    record_identifier\n  , bank_number\n  , branch_number\n  , reporting_branch\n  , account_number\n  , account_type\n  , account_group_number\n  , aa_no\n  , facility_code\n  , seq_no\n  , customer_number\n  , account_name\n  , short_name\n  , formatted_short_name\n  , account_name_1\n  , account_name_2\n  , care_of\n  , effective_rate_indicator\n  , class_code\n  , officer\n  , account_keeper\n  , status\n  , application_type\n  , loan_type\n  , short_description\n  , currency_type\n  , currency_decimals\n  , group_code\n  , loan_group\n  , cost_center\n  , product_code\n  , gl_book\n  , ioc\n  , multi_ccy_loan_code\n  , splitmerge_status\n  , sptf_loan_type\n  , interest_base\n  , interest_freq\n  , year_base\n  , payment_code\n  , principal_original_amount\n  , drawing_limit\n  , amount_release\n  , earmark_amount\n  , memo_post_amount\n  , prev_rest_balance\n  , account_balance\n  , interest_payable\n  , minimum_charge\n  , min_int_days\n  , earn_additional_day_int\n  , current_month_payoff\n  , next_month_payoff\n  , last_excess_amount\n  , principal_balance\n  , other_charges\n  , misc_cost\n  , assessed_late_charges\n  , paid_late_charges\n  , bank_discount\n  , bank_discount_2\n  , dealer_discount\n  , credit_life_premium\n  , a_h_ins_premium\n  , misc_ins_premium\n  , interest_rebate\n  , interest_rebate_n2\n  , dealer_rebate\n  , cr_life_ins_rebate\n  , ah_ins_rebate\n  , misc_ins_rebate\n  , accrued_interest\n  , secondary_accrued_int\n  , m_t_d_dealer_accrued_int\n  , commitment_fee_accr_int\n  , accrued_penalty_interest\n  , advance_accrue_interest\n  , advance_accrue_lcharges\n  , advance_accrue_com_fees\n  , advance_earned_interest\n  , advance_dealer_acc_int\n  , adv_sus_accrue_interest\n  , adv_sus_earned_interest\n  , adv_sus_acc_lc_interest\n  , daily_accrual\n  , daily_accr_late_chg\n  , daily_accr_comm_fee\n  , daily_dealer_accr\n  , today_accrued_int\n  , today_accrued_lc\n  , today_acc_com_fee\n  , today_dealer_accrue\n  , new_payment_amount\n  , new_pymt_effective_date\n  , new_pymt_effective_date2\n  , original_payment_amount\n  , original_payment_code\n  , original_payment_freq\n  , payment_amount\n  , final_payment\n  , last_pymt_amount\n  , partial_pymt_amt\n  , advance_payment\n  , capital_repayment\n  , residue_value\n  , minumum_balance\n  , maximum_balance\n  , developer_limit\n  , dev_avail_bal\n  , billed_prin_amt\n  , billed_int_amt\n  , billed_escrow_amt\n  , billed_late_chgs\n  , billed_other_chgs\n  , billed_misc_cost\n  , billed_prin_amt_od\n  , billed_int_amt_od\n  , billed_escrow_amt_od\n  , billed_late_chgs_od\n  , billed_other_chgs_od\n  , billed_misc_cost_od\n  , work_field_bill_prin\n  , work_field_bill_int\n  , no_of_days_for_billing\n  , rebilling\n  , rebilling_grace_day\n  , yesterday_os_bal\n  , yesterday_balance\n  , yesterdays_other_chgs\n  , yesterdays_misc_cost\n  , yesterdays_assessed_lc\n  , yesterdays_paid_lc\n  , yesterdays_accrued_int\n  , yesterdays_accrued_lc\n  , yesterdays_acc_com_fee\n  , yesterdays_dealer_accrue\n  , yesterdays_int_rebate\n  , yesterdays_int_rebate_2\n  , yesterday_dealer_rebate\n  , yesterdays_cl_rebate\n  , yesterdays_ah_rebate\n  , yesterdays_misc_ins_reb\n  , yesterdays_accrual_bal\n  , yesterdays_accrual_rate\n  , yesterdays_accr_yr_base\n  , yesterdays_cf_accr_bal\n  , yesterdays_cf_accr_rate\n  , yesterdays_cf_year_base\n  , yesterdays_lc_accr_bal\n  , yesterdays_lc_accr_rate\n  , yest_lc_accr_bal_int\n  , yest_lc_accr_rate_int\n  , yesterdays_lc_year_base\n  , yesterdays_dlr_accr_bal\n  , yesterdays_dlr_accr_rate\n  , yesterdays_dlr_year_base\n  , previous_mth_os\n  , last_mth_end_current_bal\n  , last_mth_end_other_chgs\n  , last_mth_end_misc_cost\n  , last_mth_end_assessed_lc\n  , last_mth_end_paid_lc\n  , last_mth_end_interest\n  , last_mtd_acc_penalty_int\n  , last_mtd_comm_acc_int\n  , last_mtd_dealer_acc\n  , last_mth_end_int_rebate\n  , last_mth_end_int_reb_2\n  , last_mth_end_dealer_reb\n  , last_mth_end_cl_rebate\n  , last_mth_end_ah_rebate\n  , last_mth_end_mis_ins_reb\n  , yearly_opening_bal\n  , prev_yr_int_in_susp_wb\n  , prevyr_int_in_susp_wo\n  , prevyr_write_back_prov\n  , prevyr_write_off_prov\n  , opening_int_in_susp\n  , last_year_int_in_susp\n  , previous_mth_int_in_sus\n  , last_year_provision\n  , last_month_provision\n  , last_year_write_back\n  , last_year_write_off\n  , prev_year_dealer_rebate\n  , int_paid_last_year\n  , lc_paid_last_year\n  , irs_interest_last_year\n  , times_extended_last_yr\n  , org_fees_last_year\n  , accrued_int_at_year_end\n  , int_rebate_at_year_end\n  , mtd_int_paid\n  , mtd_principal_paid\n  , mtd_lc_paid\n  , mtd_misc_chg_paid\n  , mtd_other_chg_paid\n  , mtd_payms_received\n  , mtd_redemption\n  , mtd_amount_release\n  , mtd_accr_int_debit\n  , mtd_late_chg_debit\n  , mtd_misc_chg_debit\n  , mtd_other_chg_debit\n  , ytd_interest_paid\n  , ytd__principal_paid\n  , ytd_late_chgs_paid\n  , ytd_misc_chg_paid\n  , ytd_other_chg_paid\n  , ytd_payms_received\n  , ytd_redemption\n  , ytd_amount_release\n  , ytd_accr_int_debit\n  , ytd_late_chg_debit\n  , ytd_misc_chg_debit\n  , ytd_other_chg_debit\n  , ytd_extension_fees\n  , ytd_times_extended\n  , ytd_right_to_cures\n  , ltd_interest_paid\n  , ltd_principal_paid\n  , ltd_lc_paid\n  , ltd_misc_chg_paid\n  , ltd_other_chg_paid\n  , ltd_payms_received\n  , ltd_redemption\n  , ltd_accr_int_debit\n  , ltd_late_chg_debit\n  , ltd_misc_chg_debit\n  , ltd_other_chg_debit\n  , ltd_capital__repayment\n  , ltd_extension_fees\n  , ltd_times_renewed\n  , ltd_irs_interest\n  , ltd_org_fees\n  , ltd_times_extended\n  , ltd_right_to_cures\n  , ltd_months_extended\n  , date_last_statement\n  , date_last_statement2\n  , balance_last_stmt\n  , statement_cycle\n  , statement_code\n  , total_accrual_float\n  , tot_availibility_float\n  , total_cash_float\n  , total_oc_amount\n  , total_ocp_amount\n  , total_odoc_amount\n  , total_mc_amount\n  , total_ibt_amount\n  , total_llc_amount\n  , total_xtr_amount\n  , date_entered\n  , date_entered2\n  , original_loan_date\n  , original_loan_date2\n  , availability_expiry_date\n  , availability_expiry_date2\n  , disburse_date\n  , first_release_date\n  , last_release_date\n  , last_release_date2\n  , full_rel_date\n  , full_rel_date2\n  , original_maturity_date\n  , original_maturity_date2\n  , principal_maturity_date\n  , maturity_date\n  , final_maturity_date\n  , final_maturity_date2\n  , int_maturity_date\n  , int_maturity_date2\n  , next_review_date\n  , next_review_date2\n  , prime_review_date\n  , prime_review_date2\n  , prime_review_day\n  , rate_user_manual_review_date\n  , rate_user_manual_review_date2\n  , rate_user_manual_review_day\n  , next_sched_pymt_date\n  , next_sched_pymt_date2\n  , first_pymt_date\n  , first_pymt_date2\n  , last_pymt_date\n  , last_pymt_date2\n  , next_pymt_due_date\n  , next_pymt_due_date2\n  , pymt_day_of_month\n  , next_interest_repayment_date\n  , next_int_pymt_due_date\n  , nxt_sch_int_pymet_due_dt\n  , nxt_sch_int_pymet_due_dt2\n  , int_pymt_day_of_month\n  , pymt_good_thru_date\n  , pymt_good_thru_date2\n  , int_paid_to_date\n  , int_paid_to_date2\n  , prevint_paid_to_date\n  , prevint_paid_to_date2\n  , date_of_refund\n  , date_of_refund2\n  , last_rebate_date\n  , last_rebate_date2\n  , next_rebate_date\n  , next_rebate_date2\n  , status_date\n  , status_date2\n  , payoff_date\n  , payoff_date2\n  , interest_start_date\n  , interest_start_date2\n  , accrue_int_eff_date\n  , accrue_int_eff_date2\n  , first_excess_date_6\n  , first_excess_date_7\n  , nonaccrual_date\n  , nonaccrual_date2\n  , chg_off_date\n  , chg_off_date2\n  , date_on_watch_list\n  , date_on_watch_list2\n  , reschedule_date\n  , reschedule_date2\n  , variation_date\n  , variation_date2\n  , last_right_to_cure_date\n  , last_right_to_cure_date2\n  , date_extended\n  , date_renewedextended\n  , examiner_class_date\n  , examiner_class_date2\n  , date_last_cheq_return\n  , date_last_cheq_return2\n  , coupon_book_reorder_date\n  , coupon_book_reorder_date2\n  , cl_ins_exp_date\n  , cl_ins_exp_date2\n  , ah_ins_exp_date\n  , ah_ins_exp_date2\n  , collat_ins_expiration\n  , collat_ins_expiration2\n  , availability_start_date\n  , availability_start_date2\n  , letter_of_offer_date_6\n  , letter_of_offer_date_7\n  , date_of_next_rest\n  , date_of_next_rest2\n  , date_claim_sub_to_cgc\n  , date_claim_sub_to_cgc2\n  , date_cgc_notified_of_npl\n  , date_cgc_notified_of_npl2\n  , date_fee_paid_to_cgc\n  , date_fee_paid_to_cgc2\n  , cgc_expiry_date\n  , cgc_expiry_date2\n  , interest_rate\n  , dealer_rate\n  , maturity_rate\n  , prime_rate_number\n  , prime_variance\n  , prime_variance_code\n  , prime_rate_floor\n  , prime_rate_ceiling\n  , rate_var_floor\n  , rate_var_ceiling\n  , prime_review_term\n  , prime_review_term_code\n  , rate_user_manual_review_term\n  , term_code_manual_rate_review\n  , effective_rate\n  , two_tier_rate\n  , late_charge_type\n  , late_charge_rate\n  , late_chg_grace_period\n  , lc_grace_int_servicing\n  , lc_accr_year_base\n  , accrue_memo_late_charges\n  , memo_late_charges\n  , accrue_on__lc_rate_flag\n  , late_chg_on_int_type\n  , late_chg_on_int_rate\n  , lc_on_int_grace_period\n  , lc_on_int_grace_int_srvc\n  , amt_to_be_released\n  , commitment_rate\n  , commitment_rate_no\n  , com_fee_accr_year_base\n  , min_usage_limit\n  , min_usage_lmt_pct_of_ln_am\n  , undrawn_limit\n  , pct_of_total_undrawn\n  , undrawn_lmt_excess_rate\n  , undrawn_pct_if_above_lmt\n  , principal_term\n  , principal_term_code\n  , permanent_no_maturity\n  , max_roll_term\n  , max_roll_term_code\n  , payment_frequency\n  , payment_freq_code\n  , interest_term\n  , interest_term_code\n  , retention_period\n  , retention_period_code\n  , no_of_instls_paid\n  , no_of_advance_instl_due\n  , current_payment_no\n  , no_of__instalment_paid\n  , revolving\n  , rollover_method\n  , alternate_pymt_sched\n  , drawndown_schd\n  , tiered_loan\n  , alternate_rate\n  , standing_inst_code\n  , tuition_fees\n  , cpf_flag\n  , giro\n  , subsidized_by_3rd_party\n  , specprov_flag\n  , cal_rate_base_on_dep_acc\n  , rate_tied_to_avg_of_bks\n  , prin_repaym_schd\n  , prin_inverse_order\n  , auto_pay_int_by_unutil_prin\n  , loan_limit_schd\n  , tranche_working_schd\n  , s__p_schd\n  , secondary_loan\n  , sec_loan_valid_period\n  , promotion_flag\n  , introducer_code\n  , bnm_exempt\n  , group_staff\n  , allwed_incentive\n  , overdue_indicator\n  , prev_overdue_indicator\n  , date_set_overdue_ind\n  , date_set_overdue_ind2\n  , waive_late_charge\n  , waive_commitment_fee\n  , waive_hold_mail_charges\n  , reminder_code\n  , re_lease\n  , territory_code\n  , collteral_type\n  , switch_pmtcod_x_amt_rel\n  , release_document_comp\n  , cal_instl_nearest_d\n  , user_code_1\n  , user_code_2\n  , sic_code_1\n  , sic_code_2\n  , sic_code_3\n  , sic_code_4\n  , set_fpdt_upon_first_rel\n  , cal_first_instl_date\n  , auto_update_pymt_cpde\n  , default_pymt_cpde\n  , nmth_grace_on_bkdisc_cal\n  , disburse_onbef_day\n  , day_for_auto_first_pymt\n  , auto_set_nipdt\n  , disburse_onbef_day2\n  , day_for_auto_nipdt\n  , auto_extend_maturity_dat\n  , maturity_calc_method\n  , auto_set_maturity_date\n  , dealer_cal_mathod\n  , dealer_com_payment\n  , insider_code\n  , participation_code\n  , credit_line_code\n  , department_code\n  , purpose_code\n  , call_report_code\n  , dealer_participation_n\n  , dealer_group\n  , refinance_from\n  , refinance_to\n  , hold_mail_code\n  , waive_hold_mail\n  , include_on_stmt_code\n  , print_billing_notice\n  , prnt_confirmation_letter\n  , past_due_notice_code\n  , past_due_history_flag\n  , send_past_due_notice\n  , on_past_due_report\n  , classification_type\n  , investment_ac\n  , credit_rating_code\n  , special_message_flag\n  , teller_special_status\n  , escrowmortgage_info\n  , close_on_zero_bal_code\n  , cl_insurance_company_n\n  , ah_insurance_company_n\n  , misc_insurance_company_n\n  , print_coupon_book_flag\n  , coupon_book_term\n  , arm_info_code\n  , alm_type\n  , participation_percent\n  , partchg_off_acct_num\n  , cr_line_acct_num\n  , deal_no\n  , notice_pre_days\n  , include_escrow_in_payoff\n  , requires_1098\n  , stmt_or_passbook_code\n  , watch_list_code\n  , interest_free_amount\n  , int_free_pmt_portion\n  , amortized_pymt_suspense\n  , one_mo_int_on_amort_loan\n  , interest_trnxpaid_today\n  , reamortize_alt_sch_exp\n  , reamortize_payment_amt\n  , reamortise_when_cp\n  , reamortise_pymt_grace\n  , reamortise_upon_disburse\n  , reamortize_rate_chg_opt\n  , reamortize_caprep_opt\n  , reamortize_disburse_opt\n  , board_applies_yn\n  , rate_duration\n  , update_mat_dt__rate_chg\n  , update_mat_date___cp\n  , update_mat_date___disb\n  , purchase_contract_no\n  , purchase_value\n  , purchase_contract_rate\n  , date_redeem___cagamas\n  , date_redeem___cagamas2\n  , date_of_purchase\n  , date_of_purchase2\n  , mthly_instl_cagamas\n  , cagamas_qualify\n  , npl_flag\n  , npl_status\n  , yesterday_npl_status\n  , npl_status_b4_variation\n  , npl_date\n  , npl_date2\n  , variation_npl_status\n  , amount_in_default_before\n  , months_in_default_before\n  , total_int_unpaid\n  , total_int_in_susp\n  , total_lc_in_susp\n  , taxable_int_in_susp\n  , non_taxable_int_in_susp\n  , interest_before_suspense\n  , late_charges_b4_suspense\n  , prev_npl_status_date\n  , prev_npl_status_date2\n  , int_payment_after_npl\n  , payment_after_pl\n  , int_rebate_on_pl_date\n  , int_before_non_taxable\n  , npl_allocate_int_first\n  , start_mth_cont_12_mths\n  , judgement__sum\n  , judgement_date\n  , judgement_date2\n  , judgement_sum_accr_int\n  , jdsum_accrual_indicator\n  , classified_acctcode\n  , reason_of_classification\n  , previous_car_code\n  , date_classified\n  , date_classified2\n  , previous_date_clas\n  , previous_date_clas2\n  , yesterday_account_status\n  , yesterday_bank_no\n  , yesterday_branch_no\n  , yesterday_group_code\n  , yesterday_cost_centre\n  , yesterday_prod_code\n  , yesterday_gl_book\n  , yesterday_ioc\n  , last_transfer_date6_bank\n  , last_transfer_date7_bank\n  , last_transfer_date6_brn\n  , last_transfer_date7_brn\n  , lst_trnsfr_date6_gl_grp\n  , lst_trnsfr_date7_gl_grp\n  , lst_trnsfr_date6_costctr\n  , lst_trnsfr_date7_costctr\n  , lst_trnsfr_date6_prodcod\n  , lst_trnsfr_date7_prodcod\n  , lst_trnsfr_date6_glbook\n  , lst_trnsfr_date7_glbook\n  , last_transfer_date6_ioc\n  , last_transfer_date7_ioc\n  , subj_int_in_lieu_of_notc\n  , part_prepaym_notc_term\n  , part_prepaym_notc_tm_cd\n  , cmmn_of_prepymt_per_ind\n  , cmmn_of_prepymt_date_6\n  , cmmn_of_prepymt_date_7\n  , early_sett_notc_term\n  , early_sett_notc_tm_cd\n  , cmmn_of_early_settle_ind\n  , cmmn_of_esett_date_6\n  , cmmn_of_esett_date_7\n  , subj_to_prepaym_fee\n  , cpre_pym_pof_win_x_mth\n  , calc_if_ful_poff_within\n  , prepaym_fee_flat_amt\n  , p_fee_pct_of_amt_prepaid\n  , p_fee_pct_of_loan_amount\n  , p_fee_pct_unexpr_period\n  , prepaym_fee_flat_amt2\n  , p_fee_pct_of_amt_prepaid2\n  , p_fee_pct_of_loan_amount2\n  , p_fee_pct_unexpr_period2\n  , pct_on_interest_rebate\n  , penalty_on_int_rebate\n  , tiered_prepayment\n  , subj_to_repl_cost\n  , repl_cost_flat_amt\n  , repcst_pct_of_amt_prepaid\n  , repcst_pct_of_loan_amount\n  , repl_cost_flat_amt2\n  , repcst_pct_of_amt_settled\n  , repcst_pct_of_loan_amount2\n  , repcst_pct_mmc_interface\n  , subj_to_cancel_fee\n  , cancel_fee_expr_drw_schd\n  , cancel_fee_early_sett\n  , esett_cfee_pct_unexpr_dura\n  , avail_cfee_pct_of_undrawn\n  , avail_cfee_pct_unexpr_dura\n  , grace_day_int_lieu_ntc\n  , term_from_lo_date\n  , term_code_from_lo_date\n  , renewedextended_this_mo\n  , times_varied_l_t_d\n  , times_varied_y_t_d\n  , times_reschd_y_t_d\n  , times_varied_last_yr\n  , times_reschd_last_yr\n  , profit_period_late_chgs\n  , point_to_point_lc_earn\n  , profit_period_ext_fees\n  , profit_period_agg_bal\n  , profit_period_int_earned\n  , point_to_point_int_earn\n  , profit_period_agg_days\n  , times_past_due_10_29\n  , times_past_due_30_59\n  , times_past_due_60_89\n  , times_past_due_90_o\n  , last_year_past_due_10_29\n  , last_year_past_due_30_59\n  , last_year_past_due_60_89\n  , last_year_past_due_90_o\n  , l_t_d_past_due_10_29\n  , l_t_d_past_due_30_59\n  , l_t_d_past_due_60_89\n  , l_t_d_past_due_90_o\n  , advance_margin\n  , retension__sum\n  , total_amount_to_be_refund\n  , allowable_refund_amount\n  , actual_amount_refunded\n  , percentage_pledged\n  , margin_rate_downupwards\n  , invoicechequepn_number\n  , type_of_exchange\n  , withholding_code\n  , collateral_code\n  , demandstudent_loan_code\n  , standard_industry_code\n  , demand_loan_code\n  , title_still_needed_code\n  , census_tract_1\n  , state_code\n  , county_code\n  , investor_number\n  , prepayment_penalty_code\n  , loan_scheme_code\n  , small_scale_code\n  , borrower_code\n  , guarantee_no\n  , guarantee_cover\n  , pgs_effective_date\n  , pgs_effective_date2\n  , cash_bonus\n  , appraised_value\n  , current_rest_amount\n  , origination_fees_ytd\n  , reduced_balance\n  , balloon_payment\n  , invalid_override\n  , batch_number\n  , amount_of_proceeds\n  , amount_advanced\n  , created_user\n  , created_date\n  , created_date2\n  , created_time\n  , history_posting_order\n  , user_id\n  , workstation_id\n  , last_maint_date\n  , last_maint_date2\n  , last_maint_time\n  , etl_date\nFROM \n  oracle_bulanding.df_2.loan_master002 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__loan_master002"}, "model.dga_data_model.stg_landing__overdraft_tier001": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.overdraft_tier001 @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__overdraft_tier001"], "unique_id": "model.dga_data_model.stg_landing__overdraft_tier001", "raw_code": "{{\r\n  config(\r\n    materialized='view',\r\n  )\r\n}}\r\nSELECT\r\n    account_number\r\n  , cnt\r\n  , record_id\r\n  , account_type\r\n  , sequence_number\r\n  , tier_type\r\n  , retail_product\r\n  , tier_type_sequence\r\n  , auto_rate_review\r\n  , application_number\r\n  , rate\r\n  , rate_number\r\n  , rate_variance\r\n  , variance_code\r\n  , rate_floor\r\n  , rate_ceiling\r\n  , rate_review_term\r\n  , rate_review_term_code\r\n  , credit_life_rate_n\r\n  , commitment_fee_rate_no\r\n  , commitment_fee_type\r\n  , excess_limit_type\r\n  , draw_limit\r\n  , authorized_limit\r\n  , accrual_balance\r\n  , reduction_code\r\n  , collateral_code\r\n  , agreement_date_7\r\n  , review_date_7\r\n  , expiration_date_7\r\n  , rate_review_date_yyyyddd\r\n  , reduction_date_yyyyddd\r\n  , date_last_maint_yyyyddd\r\n  , date_entered_yyyyddd\r\n  , agreement_date_6\r\n  , review_date_6\r\n  , expiration_date_6\r\n  , rate_review_date\r\n  , reduction_date\r\n  , date_last_maintenance\r\n  , date_entered\r\n  , purpose_code\r\n  , combined_line\r\n  , product_group\r\n  , reduction_amount\r\n  , reduction_percent\r\n  , reduction_frequency\r\n  , reduction_frequency_code\r\n  , reduction_od_limit_type\r\n  , od_reserve_1\r\n  , od_reserve_2\r\n  , od_reserve_3\r\n  , od_reserve_4\r\n  , department_code\r\n  , pending_authorized_limit\r\n  , pending_draw_limit\r\n  , pending_approval_status\r\n  , cifno\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'overdraft_tier001 @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__overdraft_tier001.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__overdraft_tier001.sql", "name": "stg_landing__overdraft_tier001", "alias": "stg_landing__overdraft_tier001", "checksum": {"name": "sha256", "checksum": "97f4efbabf77be7cddc4b9a1dd73c310a3c1edc2c39cf10eeee3c75e80a6b1cd"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "overdraft_tier001 @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3", "date_column": "etl_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__overdraft_tier001.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "etl_date"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.114367, "compiled_code": "\nSELECT\n    account_number\n  , cnt\n  , record_id\n  , account_type\n  , sequence_number\n  , tier_type\n  , retail_product\n  , tier_type_sequence\n  , auto_rate_review\n  , application_number\n  , rate\n  , rate_number\n  , rate_variance\n  , variance_code\n  , rate_floor\n  , rate_ceiling\n  , rate_review_term\n  , rate_review_term_code\n  , credit_life_rate_n\n  , commitment_fee_rate_no\n  , commitment_fee_type\n  , excess_limit_type\n  , draw_limit\n  , authorized_limit\n  , accrual_balance\n  , reduction_code\n  , collateral_code\n  , agreement_date_7\n  , review_date_7\n  , expiration_date_7\n  , rate_review_date_yyyyddd\n  , reduction_date_yyyyddd\n  , date_last_maint_yyyyddd\n  , date_entered_yyyyddd\n  , agreement_date_6\n  , review_date_6\n  , expiration_date_6\n  , rate_review_date\n  , reduction_date\n  , date_last_maintenance\n  , date_entered\n  , purpose_code\n  , combined_line\n  , product_group\n  , reduction_amount\n  , reduction_percent\n  , reduction_frequency\n  , reduction_frequency_code\n  , reduction_od_limit_type\n  , od_reserve_1\n  , od_reserve_2\n  , od_reserve_3\n  , od_reserve_4\n  , department_code\n  , pending_authorized_limit\n  , pending_draw_limit\n  , pending_approval_status\n  , cifno\n  , etl_date\nFROM\n  oracle_bulanding.df_2.overdraft_tier001 @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__overdraft_tier001"}, "model.dga_data_model.stg_landing__vw_df_customer_active_latest": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__vw_df_customer_active_latest"], "unique_id": "model.dga_data_model.stg_landing__vw_df_customer_active_latest", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT \r\n    to_number(cifno) AS customer_number\r\n  , cus_open_date\r\n  , id_number\r\n  , cfindi\r\n  , casa\r\n  , fd\r\n  , loan_sl\r\n  , loan_usl\r\n  , loan_oth\r\n  , od\r\n  , pb\r\n  , mcc\r\n  , debit\r\n  , banca_pbo_cas\r\n  , banca_oth\r\n  , spdt\r\n  , ib\r\n  , mb\r\n  , ib_mb\r\n  , sms\r\n  , total\r\n  , segment_lv2 AS segment_lv2_rb\r\n  , segment_lv1 AS segment_lv1_rb\r\n  , fcb\r\n  , inputter\r\n  , old_fcb\r\n  , year_month\r\nFROM \r\n  {{ source('daily_bulanding', 'vw_df_customer_active_latest @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__vw_df_customer_active_latest.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__vw_df_customer_active_latest.sql", "name": "stg_landing__vw_df_customer_active_latest", "alias": "stg_landing__vw_df_customer_active_latest", "checksum": {"name": "sha256", "checksum": "c3997cb6402228fd6276b01633902eeb68aab74f664e5f7f8858e59f99ba1e64"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "vw_df_customer_active_latest @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__vw_df_customer_active_latest.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.114367, "compiled_code": "\nSELECT \n    to_number(cifno) AS customer_number\n  , cus_open_date\n  , id_number\n  , cfindi\n  , casa\n  , fd\n  , loan_sl\n  , loan_usl\n  , loan_oth\n  , od\n  , pb\n  , mcc\n  , debit\n  , banca_pbo_cas\n  , banca_oth\n  , spdt\n  , ib\n  , mb\n  , ib_mb\n  , sms\n  , total\n  , segment_lv2 AS segment_lv2_rb\n  , segment_lv1 AS segment_lv1_rb\n  , fcb\n  , inputter\n  , old_fcb\n  , year_month\nFROM \n  oracle_bulanding.df_2.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vw_df_customer_active_latest"}, "model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__vw_df_demanddeposit_transaction001_union_all"], "unique_id": "model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all", "raw_code": "{{\r\n  config(\r\n    materialized='view',\r\n  )\r\n}}\r\nSELECT\r\n  trn_ref_no\r\n  , src_ref_no\r\n  , sub_ref_no\r\n  , affect_code\r\n  , trn_sk\r\n  , trn_time\r\n  , trn_date\r\n  , value_date\r\n  , currency\r\n  , dorc_ind\r\n  , acy_amount\r\n  , exchange_rate\r\n  , lcy_amount\r\n  , product_sk\r\n  , status\r\n  , channel\r\n  , channel_trn\r\n  , ac_branch_sk\r\n  , trn_branch_sk\r\n  , account_no_sk\r\n  , customer_sk\r\n  , gl_code_sk\r\n  , maker_sk\r\n  , checker_sk\r\n  , related_person\r\n  , related_account\r\n  , trf_sys\r\n  , trf_bank_sk\r\n  , remark\r\n  , seq_number\r\n  , posting_order\r\n  , before_balance\r\n  , current_balance\r\n  , user_id\r\n  , eqv_tramt\r\nFROM\r\n  {{ source('daily_bulanding', 'vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__vw_df_demanddeposit_transaction001_union_all.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__vw_df_demanddeposit_transaction001_union_all.sql", "name": "stg_landing__vw_df_demanddeposit_transaction001_union_all", "alias": "stg_landing__vw_df_demanddeposit_transaction001_union_all", "checksum": {"name": "sha256", "checksum": "5a93809e4474dfd1f864099d46ce29dc521ec044a9d5d626d1742d5ecda54609"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__vw_df_demanddeposit_transaction001_union_all.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959751.5973325, "compiled_code": "\nSELECT\n  trn_ref_no\n  , src_ref_no\n  , sub_ref_no\n  , affect_code\n  , trn_sk\n  , trn_time\n  , trn_date\n  , value_date\n  , currency\n  , dorc_ind\n  , acy_amount\n  , exchange_rate\n  , lcy_amount\n  , product_sk\n  , status\n  , channel\n  , channel_trn\n  , ac_branch_sk\n  , trn_branch_sk\n  , account_no_sk\n  , customer_sk\n  , gl_code_sk\n  , maker_sk\n  , checker_sk\n  , related_person\n  , related_account\n  , trf_sys\n  , trf_bank_sk\n  , remark\n  , seq_number\n  , posting_order\n  , before_balance\n  , current_balance\n  , user_id\n  , eqv_tramt\nFROM\n  oracle_bulanding.df_2.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vw_df_demanddeposit_transaction001_union_all"}, "model.dga_data_model.stg_landing__vw_df_overdraft_tier002_union_all": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__vw_df_overdraft_tier002_union_all"], "unique_id": "model.dga_data_model.stg_landing__vw_df_overdraft_tier002_union_all", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  account_no_sk\r\n  , account_type\r\n  , seq_number\r\n  , tier_type\r\n  , rate\r\n  , rate_number\r\n  , rate_variance\r\n  , rate_variance_code\r\n  , rate_floor\r\n  , rate_ceiling\r\n  , excess_limit_type\r\n  , draw_limit_amount\r\n  , author_limit_amount\r\n  , balance\r\n  , agreement_date\r\n  , expiration_date\r\n  , product_group\r\n  , etl_date\r\n  , customer_no\r\n  , due_date\r\n  , indicator_over_limit\r\n  , account_no\r\n  , max_expiry_date\r\n  , dd_lcy_ledger_bal\r\nFROM\r\n  {{ source('daily_bulanding', 'vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__vw_df_overdraft_tier002_union_all.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__vw_df_overdraft_tier002_union_all.sql", "name": "stg_landing__vw_df_overdraft_tier002_union_all", "alias": "stg_landing__vw_df_overdraft_tier002_union_all", "checksum": {"name": "sha256", "checksum": "2e0b26a7d529f7887054777637ad20f4992f799dad0460b91abe58237224f7d3"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__vw_df_overdraft_tier002_union_all.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1172965, "compiled_code": "\nSELECT\n  account_no_sk\n  , account_type\n  , seq_number\n  , tier_type\n  , rate\n  , rate_number\n  , rate_variance\n  , rate_variance_code\n  , rate_floor\n  , rate_ceiling\n  , excess_limit_type\n  , draw_limit_amount\n  , author_limit_amount\n  , balance\n  , agreement_date\n  , expiration_date\n  , product_group\n  , etl_date\n  , customer_no\n  , due_date\n  , indicator_over_limit\n  , account_no\n  , max_expiry_date\n  , dd_lcy_ledger_bal\nFROM\n  oracle_bulanding.df_2.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vw_df_overdraft_tier002_union_all"}, "model.dga_data_model.stg_landing__way4_trans_type": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_bulanding.way4_trans_type @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["pkg_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "daily", "stg_landing__way4_trans_type"], "unique_id": "model.dga_data_model.stg_landing__way4_trans_type", "raw_code": "{{\r\n  config(\r\n    materialized='view'\r\n  )\r\n}}\r\nSELECT\r\n  amnd_state\r\n  , amnd_date\r\n  , amnd_officer\r\n  , amnd_prev\r\n  , id\r\n  , name\r\n  , service_class\r\n  , s_cat\r\n  , t_cat\r\n  , dr_cr\r\n  , is_impersonal\r\n  , is_authorized\r\n  , is_required\r\n  , enable_adjustment\r\n  , enable_reversal\r\n  , enable_request\r\n  , prev_trans_type\r\n  , chain_type\r\n  , charge_event\r\n  , dispute_trn_class\r\n  , terminal_category\r\n  , production_type\r\n  , production_event\r\n  , trans_code\r\n  , reversal_code\r\n  , trans_type_idt\r\n  , etl_date\r\nFROM\r\n  {{ source('daily_bulanding', 'way4_trans_type @DGA_READ_BULANDING_DBL') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\daily\\stg_landing__way4_trans_type.sql", "original_file_path": "models\\staging\\landing\\daily\\stg_landing__way4_trans_type.sql", "name": "stg_landing__way4_trans_type", "alias": "stg_landing__way4_trans_type", "checksum": {"name": "sha256", "checksum": "61f8a12fd43c3852a87e36399be035b74a856e1b920c7e5a2b04e0172249cbfe"}, "tags": ["pkg_daily"], "refs": [], "sources": [["daily_bulanding", "way4_trans_type @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\daily\\landing_daily.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\stg_landing__way4_trans_type.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "pkg_daily", "materialized": "view"}, "created_at": 1685959753.1172965, "compiled_code": "\nSELECT\n  amnd_state\n  , amnd_date\n  , amnd_officer\n  , amnd_prev\n  , id\n  , name\n  , service_class\n  , s_cat\n  , t_cat\n  , dr_cr\n  , is_impersonal\n  , is_authorized\n  , is_required\n  , enable_adjustment\n  , enable_reversal\n  , enable_request\n  , prev_trans_type\n  , chain_type\n  , charge_event\n  , dispute_trn_class\n  , terminal_category\n  , production_type\n  , production_event\n  , trans_code\n  , reversal_code\n  , trans_type_idt\n  , etl_date\nFROM\n  oracle_bulanding.df_2.way4_trans_type @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__way4_trans_type"}, "model.dga_data_model.stg_landing__vision_currency_rates_daily": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision_bulanding.vision_currency_rates_daily @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "vision", "stg_landing__vision_currency_rates_daily"], "unique_id": "model.dga_data_model.stg_landing__vision_currency_rates_daily", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n    country\r\n    , le_book\r\n    , currency\r\n    , category\r\n    , year_month\r\n    , rate_01\r\n    , rate_02\r\n    , rate_03\r\n    , rate_04\r\n    , rate_05\r\n    , rate_06\r\n    , rate_07\r\n    , rate_08\r\n    , rate_09\r\n    , rate_10\r\n    , rate_11\r\n    , rate_12\r\n    , rate_13\r\n    , rate_14\r\n    , rate_15\r\n    , rate_16\r\n    , rate_17\r\n    , rate_18\r\n    , rate_19\r\n    , rate_20\r\n    , rate_21\r\n    , rate_22\r\n    , rate_23\r\n    , rate_24\r\n    , rate_25\r\n    , rate_26\r\n    , rate_27\r\n    , rate_28\r\n    , rate_29\r\n    , rate_30\r\n    , rate_31\r\n FROM {{ source('vision_bulanding', 'vision_currency_rates_daily @DGA_READ_BULANDING_DBL' )}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\vision\\stg_landing__vision_currency_rates_daily.sql", "original_file_path": "models\\staging\\landing\\vision\\stg_landing__vision_currency_rates_daily.sql", "name": "stg_landing__vision_currency_rates_daily", "alias": "stg_landing__vision_currency_rates_daily", "checksum": {"name": "sha256", "checksum": "2e819fa626f2e7cb57a19855a3da7076d61dcba5435cb1c057f0a72ff0d383b9"}, "tags": ["bal_eb_daily"], "refs": [], "sources": [["vision_bulanding", "vision_currency_rates_daily @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\vision\\landing_vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\vision\\stg_landing__vision_currency_rates_daily.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "bal_eb_daily", "materialized": "view"}, "created_at": 1685959753.2053697, "compiled_code": "\nWITH source AS (\n SELECT\n    country\n    , le_book\n    , currency\n    , category\n    , year_month\n    , rate_01\n    , rate_02\n    , rate_03\n    , rate_04\n    , rate_05\n    , rate_06\n    , rate_07\n    , rate_08\n    , rate_09\n    , rate_10\n    , rate_11\n    , rate_12\n    , rate_13\n    , rate_14\n    , rate_15\n    , rate_16\n    , rate_17\n    , rate_18\n    , rate_19\n    , rate_20\n    , rate_21\n    , rate_22\n    , rate_23\n    , rate_24\n    , rate_25\n    , rate_26\n    , rate_27\n    , rate_28\n    , rate_29\n    , rate_30\n    , rate_31\n FROM oracle_bulanding.df_2.vision_currency_rates_daily @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vision_currency_rates_daily"}, "model.dga_data_model.stg_landing__vision_fin_dly_balances": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision_bulanding.vision_fin_dly_balances @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "vision", "stg_landing__vision_fin_dly_balances"], "unique_id": "model.dga_data_model.stg_landing__vision_fin_dly_balances", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n    country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , dr_cr_bal_ind\r\n    , bal_type\r\n    , balance_01\r\n    , balance_02\r\n    , balance_03\r\n    , balance_04\r\n    , balance_05\r\n    , balance_06\r\n    , balance_07\r\n    , balance_08\r\n    , balance_09\r\n    , balance_10\r\n    , balance_11\r\n    , balance_12\r\n    , balance_13\r\n    , balance_14\r\n    , balance_15\r\n    , balance_16\r\n    , balance_17\r\n    , balance_18\r\n    , balance_19\r\n    , balance_20\r\n    , balance_21\r\n    , balance_22\r\n    , balance_23\r\n    , balance_24\r\n    , balance_25\r\n    , balance_26\r\n    , balance_27\r\n    , balance_28\r\n    , balance_29\r\n    , balance_30\r\n    , balance_31\r\n FROM {{ source('vision_bulanding', 'vision_fin_dly_balances @DGA_READ_BULANDING_DBL' )}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\vision\\stg_landing__vision_fin_dly_balances.sql", "original_file_path": "models\\staging\\landing\\vision\\stg_landing__vision_fin_dly_balances.sql", "name": "stg_landing__vision_fin_dly_balances", "alias": "stg_landing__vision_fin_dly_balances", "checksum": {"name": "sha256", "checksum": "591dea574741086a84286095505159d317a0ba60ed0dd032279c130e6e17d3f5"}, "tags": ["bal_eb_daily"], "refs": [], "sources": [["vision_bulanding", "vision_fin_dly_balances @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\vision\\landing_vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\vision\\stg_landing__vision_fin_dly_balances.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "bal_eb_daily", "materialized": "view"}, "created_at": 1685959753.2043667, "compiled_code": "\nWITH source AS (\n SELECT\n    country\n    , le_book\n    , year_month\n    , sequence_fd\n    , dr_cr_bal_ind\n    , bal_type\n    , balance_01\n    , balance_02\n    , balance_03\n    , balance_04\n    , balance_05\n    , balance_06\n    , balance_07\n    , balance_08\n    , balance_09\n    , balance_10\n    , balance_11\n    , balance_12\n    , balance_13\n    , balance_14\n    , balance_15\n    , balance_16\n    , balance_17\n    , balance_18\n    , balance_19\n    , balance_20\n    , balance_21\n    , balance_22\n    , balance_23\n    , balance_24\n    , balance_25\n    , balance_26\n    , balance_27\n    , balance_28\n    , balance_29\n    , balance_30\n    , balance_31\n FROM oracle_bulanding.df_2.vision_fin_dly_balances @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vision_fin_dly_balances"}, "model.dga_data_model.stg_landing__vision_fin_dly_headers": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision_bulanding.vision_fin_dly_headers @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "vision", "stg_landing__vision_fin_dly_headers"], "unique_id": "model.dga_data_model.stg_landing__vision_fin_dly_headers", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n    vision_sbu\r\n    , vision_ouc\r\n    , cost_center\r\n    , bs_gl\r\n    , contract_id\r\n    , customer_id AS customer_number\r\n    , currency\r\n    , country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , record_type\r\n    , pl_gl\r\n    , substr(vision_ouc,5,4) AS brn\r\n FROM {{ source('vision_bulanding', 'vision_fin_dly_headers @DGA_READ_BULANDING_DBL' )}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\vision\\stg_landing__vision_fin_dly_headers.sql", "original_file_path": "models\\staging\\landing\\vision\\stg_landing__vision_fin_dly_headers.sql", "name": "stg_landing__vision_fin_dly_headers", "alias": "stg_landing__vision_fin_dly_headers", "checksum": {"name": "sha256", "checksum": "5822293ac88931650968c7e46ad4ec9d943daa5ecaf771f655fe23db3fd4ee7e"}, "tags": ["bal_eb_daily"], "refs": [], "sources": [["vision_bulanding", "vision_fin_dly_headers @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\vision\\landing_vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\vision\\stg_landing__vision_fin_dly_headers.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "bal_eb_daily", "materialized": "view"}, "created_at": 1685959753.2033658, "compiled_code": "\nWITH source AS (\n SELECT\n    vision_sbu\n    , vision_ouc\n    , cost_center\n    , bs_gl\n    , contract_id\n    , customer_id AS customer_number\n    , currency\n    , country\n    , le_book\n    , year_month\n    , sequence_fd\n    , record_type\n    , pl_gl\n    , substr(vision_ouc,5,4) AS brn\n FROM oracle_bulanding.df_2.vision_fin_dly_headers @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vision_fin_dly_headers"}, "model.dga_data_model.stg_landing__vision_fin_dly_mappings": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision_bulanding.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "vision", "stg_landing__vision_fin_dly_mappings"], "unique_id": "model.dga_data_model.stg_landing__vision_fin_dly_mappings", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n    country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , dr_cr_bal_ind\r\n    , mrl_line\r\n FROM {{ source('vision_bulanding', 'vision_fin_dly_mappings @DGA_READ_BULANDING_DBL' )}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\vision\\stg_landing__vision_fin_dly_mappings.sql", "original_file_path": "models\\staging\\landing\\vision\\stg_landing__vision_fin_dly_mappings.sql", "name": "stg_landing__vision_fin_dly_mappings", "alias": "stg_landing__vision_fin_dly_mappings", "checksum": {"name": "sha256", "checksum": "8f0da5375cfe3f02780f9049e9ca57eb589690ff15b88ba7cf92ac4760d20fc8"}, "tags": ["bal_eb_daily"], "refs": [], "sources": [["vision_bulanding", "vision_fin_dly_mappings @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\vision\\landing_vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\vision\\stg_landing__vision_fin_dly_mappings.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "bal_eb_daily", "materialized": "view"}, "created_at": 1685959753.2043667, "compiled_code": "\nWITH source AS (\n SELECT\n    country\n    , le_book\n    , year_month\n    , sequence_fd\n    , dr_cr_bal_ind\n    , mrl_line\n FROM oracle_bulanding.df_2.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vision_fin_dly_mappings"}, "model.dga_data_model.stg_landing__vision_mgt_expanded": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision_bulanding.vision_mgt_expanded @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["bal_eb_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "landing", "vision", "stg_landing__vision_mgt_expanded"], "unique_id": "model.dga_data_model.stg_landing__vision_mgt_expanded", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nWITH source AS (\r\n SELECT\r\n    mgt_line_level\r\n    , source_mrl_line\r\n    , source_bal_type\r\n    , source_type\r\n    , mgt_line\r\n    , mgt_line_description\r\n    , mgt_line_short_desc\r\n FROM {{ source('vision_bulanding', 'vision_mgt_expanded @DGA_READ_BULANDING_DBL' )}}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\landing\\vision\\stg_landing__vision_mgt_expanded.sql", "original_file_path": "models\\staging\\landing\\vision\\stg_landing__vision_mgt_expanded.sql", "name": "stg_landing__vision_mgt_expanded", "alias": "stg_landing__vision_mgt_expanded", "checksum": {"name": "sha256", "checksum": "f8879dfb312151a152efb1777a6e967918fec6d48b1ef6abde3ed2da4f2f0823"}, "tags": ["bal_eb_daily"], "refs": [], "sources": [["vision_bulanding", "vision_mgt_expanded @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\landing\\vision\\landing_vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\vision\\stg_landing__vision_mgt_expanded.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "bal_eb_daily", "materialized": "view"}, "created_at": 1685959753.2043667, "compiled_code": "\nWITH source AS (\n SELECT\n    mgt_line_level\n    , source_mrl_line\n    , source_bal_type\n    , source_type\n    , mgt_line\n    , mgt_line_description\n    , mgt_line_short_desc\n FROM oracle_bulanding.df_2.vision_mgt_expanded @DGA_READ_BULANDING_DBL\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__vision_mgt_expanded"}, "model.dga_data_model.stg_los__addoncarddetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.addoncarddetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__addoncarddetails"], "unique_id": "model.dga_data_model.stg_los__addoncarddetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  addoncarddetailsid\r\n, creditcardproductid\r\n, existingcif\r\n, embossednameaddoncard\r\n, relationship\r\n, cifid\r\n, isdeleted\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, customcardholderphone\r\n, customcardtype\r\n, customway4code\r\n, customaddinfo1\r\n, customaddinfo2\r\n, customaddinfo3\r\n, customlimitofcard\r\nFROM {{ source('crmuser', 'addoncarddetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__addoncarddetails.sql", "original_file_path": "models\\staging\\los\\stg_los__addoncarddetails.sql", "name": "stg_los__addoncarddetails", "alias": "stg_los__addoncarddetails", "checksum": {"name": "sha256", "checksum": "e3c9d77f0b9b28866864ad8409f5eeb5c71a099e7eedf5c78898fefc75952d6f"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "addoncarddetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__addoncarddetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3130105, "compiled_code": "\nWITH source AS(\nSELECT  addoncarddetailsid\n, creditcardproductid\n, existingcif\n, embossednameaddoncard\n, relationship\n, cifid\n, isdeleted\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\n, customcardholderphone\n, customcardtype\n, customway4code\n, customaddinfo1\n, customaddinfo2\n, customaddinfo3\n, customlimitofcard\nFROM oracle_los.crmuser.addoncarddetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__addoncarddetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__addoncarddetails"}, "model.dga_data_model.stg_los__agents": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.agents"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__agents"], "unique_id": "model.dga_data_model.stg_los__agents", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT personid\r\n, channel\r\n, bhid\r\n, enablealert\r\n, home_bank_id\r\n, bcid\r\n, ccid\r\n, tlpassword\r\n, tlavailabilitystatus\r\n, loggedin_bank\r\n, acdpassword\r\n, acdrepid\r\n, location\r\n, agentavailability\r\n, supervisorid\r\n, agenttype\r\n, designation\r\n, defaultemail\r\n, thresincidents\r\n, thresoppor\r\n, sla\r\n, availstring\r\n,  cast(referencedate as timestamp(3)) as referencedate\r\n, wrapuptime\r\n, shiftstarttime\r\n, shiftendtime\r\n, referenceday\r\n, asgenflag\r\n, numofopeninci\r\n, numofopenoppr\r\n, primarybcgid\r\n, defaultchannel\r\n, primarygroupid\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, numofopencamptgt\r\n, threscamptgt\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n, userfield5\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, primarysegment\r\n, primaryroleid\r\n, thresretentities\r\n, noofopenretentities\r\n, threscorpentities\r\n, noofopencorpentities\r\n, seedavailstring\r\n, dsaname\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'agents') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__agents.sql", "original_file_path": "models\\staging\\los\\stg_los__agents.sql", "name": "stg_los__agents", "alias": "stg_los__agents", "checksum": {"name": "sha256", "checksum": "278a3af1b6f60e7f62d3867ee538fd16bfa44bfd03497a66c116e0164bf84946"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "agents"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__agents.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3160093, "compiled_code": "\nWITH source AS(\nSELECT personid\n, channel\n, bhid\n, enablealert\n, home_bank_id\n, bcid\n, ccid\n, tlpassword\n, tlavailabilitystatus\n, loggedin_bank\n, acdpassword\n, acdrepid\n, location\n, agentavailability\n, supervisorid\n, agenttype\n, designation\n, defaultemail\n, thresincidents\n, thresoppor\n, sla\n, availstring\n,  cast(referencedate as timestamp(3)) as referencedate\n, wrapuptime\n, shiftstarttime\n, shiftendtime\n, referenceday\n, asgenflag\n, numofopeninci\n, numofopenoppr\n, primarybcgid\n, defaultchannel\n, primarygroupid\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, numofopencamptgt\n, threscamptgt\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n, userfield5\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, primarysegment\n, primaryroleid\n, thresretentities\n, noofopenretentities\n, threscorpentities\n, noofopencorpentities\n, seedavailstring\n, dsaname\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.agents\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__agents)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__agents"}, "model.dga_data_model.stg_los__agent_entity_details": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.agent_entity_details"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__agent_entity_details"], "unique_id": "model.dga_data_model.stg_los__agent_entity_details", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT detail_record_id\r\n, personid\r\n, bank_id\r\n, primarysegment\r\n, designation\r\n, hascardreaderaccess\r\n, signaturetemplate\r\n, tlaccessflag\r\n, primaryroleid\r\n, primarygroupid\r\n, supervisorid\r\n, aut_cal_dist_id\r\n, aut_cal_dist_pwd\r\n, wrapuptime\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'agent_entity_details') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__agent_entity_details.sql", "original_file_path": "models\\staging\\los\\stg_los__agent_entity_details.sql", "name": "stg_los__agent_entity_details", "alias": "stg_los__agent_entity_details", "checksum": {"name": "sha256", "checksum": "fcf64bdcf952fa0f6c7010d2794e564f95da52cf6f8c1092fd7aaead8d185342"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "agent_entity_details"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__agent_entity_details.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.320012, "compiled_code": "\nWITH source AS(\nSELECT detail_record_id\n, personid\n, bank_id\n, primarysegment\n, designation\n, hascardreaderaccess\n, signaturetemplate\n, tlaccessflag\n, primaryroleid\n, primarygroupid\n, supervisorid\n, aut_cal_dist_id\n, aut_cal_dist_pwd\n, wrapuptime\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.agent_entity_details\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__agent_entity_details)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__agent_entity_details"}, "model.dga_data_model.stg_los__applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.applicant"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__applicant"], "unique_id": "model.dga_data_model.stg_los__applicant", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantid\r\n, immigrationstatus\r\n, totamount1\r\n, totamount2\r\n, totamount3\r\n, isdeleted\r\n, isassociated\r\n, cifid\r\n, applicationid\r\n, productid\r\n, applicanttype\r\n, relationtype\r\n, title\r\n, firstname\r\n, middlename\r\n, lastname\r\n,  cast(dob as timestamp(3)) as dob\r\n, gender\r\n, nationality\r\n, langcode\r\n, resdindicator\r\n, resdtype\r\n, custoccupation\r\n, maritalstatus\r\n, veteran\r\n, yrofschool\r\n, noofdependents\r\n, staffindicator\r\n, custsegment\r\n, subsegment\r\n, custrating\r\n, isblacklistchkdone\r\n, blacklisted\r\n, blacklistnote\r\n, blacklistreason\r\n, isneglistchkdone\r\n, negated\r\n, neglistnote\r\n, neglistreason\r\n, isdedupchkdone\r\n, dedupchknote\r\n, suspended\r\n, suspendednote\r\n, suspendedreason\r\n, status\r\n, statuscode\r\n, basecurrency\r\n, crmentitytype\r\n, minorindicator\r\n, preferredname\r\n, primaryrmi\r\n, primarysolid\r\n, staffid\r\n, nickname\r\n, shortname\r\n,  cast(turnednonresidenton as timestamp(3)) as turnednonresidenton\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, parentapplicationid\r\n, applicationreferencenumber\r\n, prodrefnum\r\n, networthweightage\r\n, applntdedupdecision\r\n, applntdedupdecremarks\r\n, applntblacklistdesicion\r\n, applntblacklistdesremarks\r\n, applntnegativlistdesicion\r\n, applntnegativlistdesremarks\r\n, applntkycdesicion\r\n, applntkycdesremarks\r\n, applntkycdescomments\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, cntryofcitizenship\r\n, employmentstatus\r\n, foreigntaxcomments\r\n, foreigntaxrepcntry\r\n, foreigntaxreptingstatus\r\n,  cast(foreigntaxrptingdate as timestamp(3)) as foreigntaxrptingdate\r\n, freecode1\r\n, freecode2\r\n,  cast(freedate1 as timestamp(3)) as freedate1\r\n,  cast(freedate2 as timestamp(3)) as freedate2\r\n, freetext1\r\n, freetext10\r\n, freetext2\r\n, freetext6\r\n, freetext8\r\n, grossincome\r\n, grossincomecurrency\r\n, industrytype\r\n, insiderrole\r\n, insidertobank\r\n, isforeignacctaxrepreqd\r\n, jobtitle\r\n, noofdependentchildren\r\n, taxdetdsourccifid\r\n, taxdetdsourctable\r\n, taxid\r\n, nointerection\r\n, donotemail\r\n, donotphone\r\n, nosweepstakes\r\n, notificationflags\r\nFROM {{ source('crmuser', 'applicant') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__applicant.sql", "original_file_path": "models\\staging\\los\\stg_los__applicant.sql", "name": "stg_los__applicant", "alias": "stg_los__applicant", "checksum": {"name": "sha256", "checksum": "260bb0587c3c7e7922c76b3b34848282b3509deab81886aa6b5fb902f17d1c74"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicant"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3140104, "compiled_code": "\nWITH source AS(\nSELECT  applicantid\n, immigrationstatus\n, totamount1\n, totamount2\n, totamount3\n, isdeleted\n, isassociated\n, cifid\n, applicationid\n, productid\n, applicanttype\n, relationtype\n, title\n, firstname\n, middlename\n, lastname\n,  cast(dob as timestamp(3)) as dob\n, gender\n, nationality\n, langcode\n, resdindicator\n, resdtype\n, custoccupation\n, maritalstatus\n, veteran\n, yrofschool\n, noofdependents\n, staffindicator\n, custsegment\n, subsegment\n, custrating\n, isblacklistchkdone\n, blacklisted\n, blacklistnote\n, blacklistreason\n, isneglistchkdone\n, negated\n, neglistnote\n, neglistreason\n, isdedupchkdone\n, dedupchknote\n, suspended\n, suspendednote\n, suspendedreason\n, status\n, statuscode\n, basecurrency\n, crmentitytype\n, minorindicator\n, preferredname\n, primaryrmi\n, primarysolid\n, staffid\n, nickname\n, shortname\n,  cast(turnednonresidenton as timestamp(3)) as turnednonresidenton\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, parentapplicationid\n, applicationreferencenumber\n, prodrefnum\n, networthweightage\n, applntdedupdecision\n, applntdedupdecremarks\n, applntblacklistdesicion\n, applntblacklistdesremarks\n, applntnegativlistdesicion\n, applntnegativlistdesremarks\n, applntkycdesicion\n, applntkycdesremarks\n, applntkycdescomments\n,  cast(tmdate as timestamp(3)) as tmdate\n, cntryofcitizenship\n, employmentstatus\n, foreigntaxcomments\n, foreigntaxrepcntry\n, foreigntaxreptingstatus\n,  cast(foreigntaxrptingdate as timestamp(3)) as foreigntaxrptingdate\n, freecode1\n, freecode2\n,  cast(freedate1 as timestamp(3)) as freedate1\n,  cast(freedate2 as timestamp(3)) as freedate2\n, freetext1\n, freetext10\n, freetext2\n, freetext6\n, freetext8\n, grossincome\n, grossincomecurrency\n, industrytype\n, insiderrole\n, insidertobank\n, isforeignacctaxrepreqd\n, jobtitle\n, noofdependentchildren\n, taxdetdsourccifid\n, taxdetdsourctable\n, taxid\n, nointerection\n, donotemail\n, donotphone\n, nosweepstakes\n, notificationflags\nFROM oracle_los.crmuser.applicant\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__applicant)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__applicant"}, "model.dga_data_model.stg_los__applicantcontact": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.applicantcontact"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__applicantcontact"], "unique_id": "model.dga_data_model.stg_los__applicantcontact", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantcontactid\r\n, applicantid\r\n, appid\r\n, cifid\r\n, prefercommlang\r\n, besttimetocontact\r\n, timezone\r\n, donotemail\r\n, donotmail\r\n, donotphone\r\n, nosweepstakes\r\n, nointerection\r\n, deleteflag\r\n, isassociated\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, prefcommchannel\r\n, prefmobilealerttype\r\n, preflocale\r\n, prefcontactnotype\r\n, prefemailidtype\r\n, crmdemographicid\r\n, preferredmobilealertno\r\n, preferredemail\r\n, preferredcontactno\r\n, psychographicid\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'applicantcontact') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__applicantcontact.sql", "original_file_path": "models\\staging\\los\\stg_los__applicantcontact.sql", "name": "stg_los__applicantcontact", "alias": "stg_los__applicantcontact", "checksum": {"name": "sha256", "checksum": "7a5860eb3734993241cd2352aaa3cbb56ac0a893efe4c32fbe72aec87f813350"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicantcontact"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__applicantcontact.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3030107, "compiled_code": "\nWITH source AS(\nSELECT  applicantcontactid\n, applicantid\n, appid\n, cifid\n, prefercommlang\n, besttimetocontact\n, timezone\n, donotemail\n, donotmail\n, donotphone\n, nosweepstakes\n, nointerection\n, deleteflag\n, isassociated\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, prefcommchannel\n, prefmobilealerttype\n, preflocale\n, prefcontactnotype\n, prefemailidtype\n, crmdemographicid\n, preferredmobilealertno\n, preferredemail\n, preferredcontactno\n, psychographicid\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.applicantcontact\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__applicantcontact)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__applicantcontact"}, "model.dga_data_model.stg_los__applicantcontactphnemllist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.applicantcontactphnemllist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__applicantcontactphnemllist"], "unique_id": "model.dga_data_model.stg_los__applicantcontactphnemllist", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantcontactphnemllistid\r\n, phoneoremail\r\n, phonenumlocalcode\r\n, phonenumcountrycode\r\n, phonenumcitycode\r\n, phoneemailtypevalue\r\n,  cast(dateofreq as timestamp(3)) as dateofreq\r\n, extnsion\r\n, deletestatus\r\n, emailid\r\n, applicantcontactid\r\n, dnd\r\n, holdemailflag\r\n, holdemailinitiatedby\r\n, holdemailreason\r\n, crmphoneemailid\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'applicantcontactphnemllist') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__applicantcontactphnemllist.sql", "original_file_path": "models\\staging\\los\\stg_los__applicantcontactphnemllist.sql", "name": "stg_los__applicantcontactphnemllist", "alias": "stg_los__applicantcontactphnemllist", "checksum": {"name": "sha256", "checksum": "f926d0f1e68ad709f00229ccf7c7e4cd4797b50dc1e3e78952a97cd9be5d8b86"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicantcontactphnemllist"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__applicantcontactphnemllist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3290112, "compiled_code": "\nWITH source AS(\nSELECT  applicantcontactphnemllistid\n, phoneoremail\n, phonenumlocalcode\n, phonenumcountrycode\n, phonenumcitycode\n, phoneemailtypevalue\n,  cast(dateofreq as timestamp(3)) as dateofreq\n, extnsion\n, deletestatus\n, emailid\n, applicantcontactid\n, dnd\n, holdemailflag\n, holdemailinitiatedby\n, holdemailreason\n, crmphoneemailid\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.applicantcontactphnemllist\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__applicantcontactphnemllist)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__applicantcontactphnemllist"}, "model.dga_data_model.stg_los__applicantidentitydetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.applicantidentitydetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__applicantidentitydetail"], "unique_id": "model.dga_data_model.stg_los__applicantidentitydetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantidentitydetailid\r\n, doctype\r\n, documentuniqueid\r\n, placeofissue\r\n, cityofissue\r\n, stateofissue\r\n, countryofissue\r\n,  cast(docissuedt as timestamp(3)) as docissuedt\r\n,  cast(docexpdt as timestamp(3)) as docexpdt\r\n, idissuedorganisation\r\n, applicantid\r\n, docrmks\r\n, deletestatus\r\n, prefuniqueidind\r\n, docverifiedind\r\n, refnum\r\n, status\r\n, scanreqdind\r\n, doccode\r\n, crmdocumentid\r\n, doccodedesc\r\n, doctypedesc\r\n, bank_id\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'applicantidentitydetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__applicantidentitydetail.sql", "original_file_path": "models\\staging\\los\\stg_los__applicantidentitydetail.sql", "name": "stg_los__applicantidentitydetail", "alias": "stg_los__applicantidentitydetail", "checksum": {"name": "sha256", "checksum": "3052bcc0f5d51e011e5352f40c54f2eab5821348459d9fd2bba8801428d313e4"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicantidentitydetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__applicantidentitydetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3560107, "compiled_code": "\nWITH source AS(\nSELECT  applicantidentitydetailid\n, doctype\n, documentuniqueid\n, placeofissue\n, cityofissue\n, stateofissue\n, countryofissue\n,  cast(docissuedt as timestamp(3)) as docissuedt\n,  cast(docexpdt as timestamp(3)) as docexpdt\n, idissuedorganisation\n, applicantid\n, docrmks\n, deletestatus\n, prefuniqueidind\n, docverifiedind\n, refnum\n, status\n, scanreqdind\n, doccode\n, crmdocumentid\n, doccodedesc\n, doctypedesc\n, bank_id\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.applicantidentitydetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__applicantidentitydetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__applicantidentitydetail"}, "model.dga_data_model.stg_los__applicantmiscdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.applicantmiscdetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__applicantmiscdetail"], "unique_id": "model.dga_data_model.stg_los__applicantmiscdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicantmiscdetailid\r\n,  cast(dateandtime as timestamp(3)) as dateandtime\r\n, applicantsequenceno\r\n, disclosureconsent\r\n, disclosurecontextid\r\n, disclosurecontexttype\r\n,  cast(disclosuredateandtime as timestamp(3)) as disclosuredateandtime\r\n, disclosureid\r\n, disclosureversion\r\n, ipaddress\r\n, isdeleted\r\n, isassociated\r\n, cifid\r\n, applicationid\r\n, isprintacstmt\r\n, isprintdepnotice\r\n, isexcldcombstmt\r\n, isprintacstndordr\r\n, isprintloannotice\r\n, isconsentreceived\r\n,  cast(oralconsrecdate as timestamp(3)) as oralconsrecdate\r\n,  cast(writtenconsrecdate as timestamp(3)) as writtenconsrecdate\r\n, applicantid\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, receiveelecdiscl\r\n, ethnicity\r\n, color\r\n, nationalorigin\r\n, insidertobank\r\n, insiderrole\r\n, religion\r\n, dispatchmode\r\n,  cast(esign_consent_date as timestamp(3)) as esign_consent_date\r\n, esign_consent_type\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, referenceaddress1\r\n, referenceaddress2\r\n, referencename1\r\n, referencename2\r\n, referencephonenumber1\r\n, referencephonenumber2\r\n, referencerelationshiptype1\r\n, referencerelationshiptype2\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\nFROM {{ source('crmuser', 'applicantmiscdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__applicantmiscdetail.sql", "original_file_path": "models\\staging\\los\\stg_los__applicantmiscdetail.sql", "name": "stg_los__applicantmiscdetail", "alias": "stg_los__applicantmiscdetail", "checksum": {"name": "sha256", "checksum": "4e587d35bc003a9a3f1c46c518d2fed8729ab9068b9d9fec1862d8e34e1a074d"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicantmiscdetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__applicantmiscdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3070104, "compiled_code": "\nWITH source AS(\nSELECT  applicantmiscdetailid\n,  cast(dateandtime as timestamp(3)) as dateandtime\n, applicantsequenceno\n, disclosureconsent\n, disclosurecontextid\n, disclosurecontexttype\n,  cast(disclosuredateandtime as timestamp(3)) as disclosuredateandtime\n, disclosureid\n, disclosureversion\n, ipaddress\n, isdeleted\n, isassociated\n, cifid\n, applicationid\n, isprintacstmt\n, isprintdepnotice\n, isexcldcombstmt\n, isprintacstndordr\n, isprintloannotice\n, isconsentreceived\n,  cast(oralconsrecdate as timestamp(3)) as oralconsrecdate\n,  cast(writtenconsrecdate as timestamp(3)) as writtenconsrecdate\n, applicantid\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, receiveelecdiscl\n, ethnicity\n, color\n, nationalorigin\n, insidertobank\n, insiderrole\n, religion\n, dispatchmode\n,  cast(esign_consent_date as timestamp(3)) as esign_consent_date\n, esign_consent_type\n,  cast(tmdate as timestamp(3)) as tmdate\n, referenceaddress1\n, referenceaddress2\n, referencename1\n, referencename2\n, referencephonenumber1\n, referencephonenumber2\n, referencerelationshiptype1\n, referencerelationshiptype2\n, freetext1\n, freetext2\n, freetext3\n, freetext4\n, freetext5\nFROM oracle_los.crmuser.applicantmiscdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__applicantmiscdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__applicantmiscdetail"}, "model.dga_data_model.stg_los__applicationdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.applicationdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__applicationdetails"], "unique_id": "model.dga_data_model.stg_los__applicationdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicationdetailsid\r\n, recompeligibility\r\n, fileclosereason\r\n, filecloseremarks\r\n, filecloseresult\r\n, reason\r\n, appldetailssequenceno\r\n, rejectremarks\r\n, productcategory\r\n, productsubcategory\r\n, productclassification\r\n, producttype\r\n, productcode\r\n, productname\r\n, currency\r\n,  cast(applrecieveddate as timestamp(3)) as applrecieveddate\r\n, applreferenceno\r\n, isqualified\r\n, applicationstatus\r\n, frontendratio\r\n, backendratio\r\n, approach\r\n, applicationstage\r\n, agencyrefno\r\n, opportunityid\r\n, completedsteps\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isdeleted\r\n, purposeofloan\r\n, applicationno\r\n, accountnumber\r\n, accountname\r\n, parentapplicationid\r\n, amountrequested\r\n, tenorrequestedmm\r\n, tenorrequesteddd\r\n, intraterequested\r\n, ismandatory\r\n, isproductrejected\r\n, applrejectedstage\r\n, remarks\r\n, applicationstep\r\n, userenteligibleamt\r\n, preapprovedcode\r\n, preapprovedloan\r\n, underwriterid\r\n, underwritername\r\n, interimstatus\r\n, transactiontype\r\n, applicationtype\r\n, syseligibleamt\r\n, enrichmentstatus\r\n, eligibilitystatus\r\n, disposition\r\n, networthweightage\r\n, osproductid\r\n, amountrequestedccy\r\n, cancelremark\r\n, cancelreason\r\n, interest\r\n, apy\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\n, freetext6\r\n, freetext7\r\n, freetext8\r\n, freetext9\r\n, freetext10\r\n,  cast(freedate1 as timestamp(3)) as freedate1\r\n,  cast(freedate2 as timestamp(3)) as freedate2\r\n,  cast(stepduedate as timestamp(3)) as stepduedate\r\n,  cast(appduedate as timestamp(3)) as appduedate\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, processflag\r\nFROM {{ source('crmuser', 'applicationdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__applicationdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__applicationdetails.sql", "name": "stg_los__applicationdetails", "alias": "stg_los__applicationdetails", "checksum": {"name": "sha256", "checksum": "806a30f380499529bf48fdb44f031a16ba190d228fd4ac56e08d559902008b85"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "applicationdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__applicationdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3580105, "compiled_code": "\nWITH source AS(\nSELECT  applicationdetailsid\n, recompeligibility\n, fileclosereason\n, filecloseremarks\n, filecloseresult\n, reason\n, appldetailssequenceno\n, rejectremarks\n, productcategory\n, productsubcategory\n, productclassification\n, producttype\n, productcode\n, productname\n, currency\n,  cast(applrecieveddate as timestamp(3)) as applrecieveddate\n, applreferenceno\n, isqualified\n, applicationstatus\n, frontendratio\n, backendratio\n, approach\n, applicationstage\n, agencyrefno\n, opportunityid\n, completedsteps\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isdeleted\n, purposeofloan\n, applicationno\n, accountnumber\n, accountname\n, parentapplicationid\n, amountrequested\n, tenorrequestedmm\n, tenorrequesteddd\n, intraterequested\n, ismandatory\n, isproductrejected\n, applrejectedstage\n, remarks\n, applicationstep\n, userenteligibleamt\n, preapprovedcode\n, preapprovedloan\n, underwriterid\n, underwritername\n, interimstatus\n, transactiontype\n, applicationtype\n, syseligibleamt\n, enrichmentstatus\n, eligibilitystatus\n, disposition\n, networthweightage\n, osproductid\n, amountrequestedccy\n, cancelremark\n, cancelreason\n, interest\n, apy\n, freetext1\n, freetext2\n, freetext3\n, freetext4\n, freetext5\n, freetext6\n, freetext7\n, freetext8\n, freetext9\n, freetext10\n,  cast(freedate1 as timestamp(3)) as freedate1\n,  cast(freedate2 as timestamp(3)) as freedate2\n,  cast(stepduedate as timestamp(3)) as stepduedate\n,  cast(appduedate as timestamp(3)) as appduedate\n,  cast(tmdate as timestamp(3)) as tmdate\n, processflag\nFROM oracle_los.crmuser.applicationdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__applicationdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__applicationdetails"}, "model.dga_data_model.stg_los__appraisal_custom": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.crmuser.appraisal_custom"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__appraisal_custom"], "unique_id": "model.dga_data_model.stg_los__appraisal_custom", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  applicationid\r\n, appraisalcustid\r\n, isdeleted\r\n, opportunityid\r\n, amtountratiofld\r\n, appraisalcode\r\n, associationid\r\n, remarks\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\n, freeint1\r\n, freeint2\r\n, freeint3\r\n, freeint4\r\n, freeamount1\r\n, freeamount2\r\n, freeamount3\r\n, freeamount4\r\nFROM {{ source('crmuser', 'appraisal_custom') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__appraisal_custom.sql", "original_file_path": "models\\staging\\los\\stg_los__appraisal_custom.sql", "name": "stg_los__appraisal_custom", "alias": "stg_los__appraisal_custom", "checksum": {"name": "sha256", "checksum": "641d4f66ed40f622556458d865db910ecf000cb98a1396dac4ba9f3593679422"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "appraisal_custom"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__appraisal_custom.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3320107, "compiled_code": "\nWITH source AS(\nSELECT  applicationid\n, appraisalcustid\n, isdeleted\n, opportunityid\n, amtountratiofld\n, appraisalcode\n, associationid\n, remarks\n, freetext1\n, freetext2\n, freetext3\n, freetext4\n, freetext5\n, freeint1\n, freeint2\n, freeint3\n, freeint4\n, freeamount1\n, freeamount2\n, freeamount3\n, freeamount4\nFROM oracle_los.crmuser.appraisal_custom\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__appraisal_custom"}, "model.dga_data_model.stg_los__areas": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.areas"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__areas"], "unique_id": "model.dga_data_model.stg_los__areas", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  areasid\r\n, code\r\n, name\r\n, isdeleted\r\n, freetext1\r\n, freetext2\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, modifiedby\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, createdby\r\nFROM {{ source('crmuser', 'areas') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where bodatemodified > (select max(bodatemodified) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__areas.sql", "original_file_path": "models\\staging\\los\\stg_los__areas.sql", "name": "stg_los__areas", "alias": "stg_los__areas", "checksum": {"name": "sha256", "checksum": "5291981218608fc6ec925dd8732bb2af27cdc73200f193013544e7215a5a22a7"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "areas"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__areas.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.359011, "compiled_code": "\nWITH source AS(\nSELECT  areasid\n, code\n, name\n, isdeleted\n, freetext1\n, freetext2\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, modifiedby\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, createdby\nFROM oracle_los.crmuser.areas\n)\nSELECT * FROM source\n\n  where bodatemodified > (select max(bodatemodified) from \"oracle_dgaworkzone\".staging.stg_los__areas)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__areas"}, "model.dga_data_model.stg_los__bizcenter": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.bizcenter"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__bizcenter"], "unique_id": "model.dga_data_model.stg_los__bizcenter", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT bcid\r\n, bcname\r\n, bccode\r\n, bctypeid\r\n, isactive\r\n, region\r\n, manager\r\n, timezone\r\n, houseno\r\n, premisename\r\n, buildinglevel\r\n, streetno\r\n, suburb\r\n, streetname\r\n, locality\r\n, town\r\n, email\r\n, mailstop\r\n, city\r\n, state\r\n, zip\r\n, country\r\n, phone\r\n, fax\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n,  cast(userdatefield1 as timestamp(3)) as userdatefield1\r\n,  cast(userdatefield2 as timestamp(3)) as userdatefield2\r\n, useramtfield1\r\n, useramtfield2\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'bizcenter') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__bizcenter.sql", "original_file_path": "models\\staging\\los\\stg_los__bizcenter.sql", "name": "stg_los__bizcenter", "alias": "stg_los__bizcenter", "checksum": {"name": "sha256", "checksum": "cb7d60b1e3b3c44ff7a04937434eadd44312e07c789fa4780c69400cc5919af0"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "bizcenter"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__bizcenter.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3100104, "compiled_code": "\nWITH source AS(\nSELECT bcid\n, bcname\n, bccode\n, bctypeid\n, isactive\n, region\n, manager\n, timezone\n, houseno\n, premisename\n, buildinglevel\n, streetno\n, suburb\n, streetname\n, locality\n, town\n, email\n, mailstop\n, city\n, state\n, zip\n, country\n, phone\n, fax\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n,  cast(userdatefield1 as timestamp(3)) as userdatefield1\n,  cast(userdatefield2 as timestamp(3)) as userdatefield2\n, useramtfield1\n, useramtfield2\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.bizcenter\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__bizcenter)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__bizcenter"}, "model.dga_data_model.stg_los__categories": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.categories"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__categories"], "unique_id": "model.dga_data_model.stg_los__categories", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT categoryid\r\n, bank_id\r\n, remarks\r\n, categorycode\r\n, categorytype\r\n, value\r\n, allowmodify\r\n, rating\r\n, ratingtype\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, del_flg\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'categories') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__categories.sql", "original_file_path": "models\\staging\\los\\stg_los__categories.sql", "name": "stg_los__categories", "alias": "stg_los__categories", "checksum": {"name": "sha256", "checksum": "113a3d94059f47c7c835695fb622ff1de364d3654ca80cc80f89ce1ce55dd26a"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "categories"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__categories.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3370104, "compiled_code": "\nWITH source AS(\nSELECT categoryid\n, bank_id\n, remarks\n, categorycode\n, categorytype\n, value\n, allowmodify\n, rating\n, ratingtype\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, del_flg\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.categories\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__categories)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__categories"}, "model.dga_data_model.stg_los__category_lang": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.category_lang"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__category_lang"], "unique_id": "model.dga_data_model.stg_los__category_lang", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  categorylangid\r\n, bank_id\r\n, categoryid\r\n, localecode\r\n, localetext\r\n, cmlabelcode\r\n, isexceeded\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'category_lang') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__category_lang.sql", "original_file_path": "models\\staging\\los\\stg_los__category_lang.sql", "name": "stg_los__category_lang", "alias": "stg_los__category_lang", "checksum": {"name": "sha256", "checksum": "fa84d4baccbfb19af066845da8ae1d63693a41af6fa63c49c2863d4cb43d6c2e"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "category_lang"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__category_lang.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3350127, "compiled_code": "\nWITH source AS(\nSELECT  categorylangid\n, bank_id\n, categoryid\n, localecode\n, localetext\n, cmlabelcode\n, isexceeded\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.category_lang\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__category_lang)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__category_lang"}, "model.dga_data_model.stg_los__closroutingdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.closroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__closroutingdetails"], "unique_id": "model.dga_data_model.stg_los__closroutingdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT closroutingdetailsid\r\n, loginid\r\n, bank_id\r\n, useractiontrayid\r\n, assignedby\r\n, assignedto\r\n, ownerid\r\n, routetostep\r\n, routingreasoncode\r\n, routingcomments\r\n, timestatus\r\n, compliancestatus\r\n, waiverstatus\r\n, userfield1\r\n, userfield2\r\n, userflag1\r\n, userflag2\r\n,  cast(routingdate as timestamp(3)) as routingdate\r\n, routingtime\r\n, applcomments\r\n, stepid\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, stepslahours\r\n, steptathours\r\n,  cast(stepduedate as timestamp(3)) as stepduedate\r\nFROM {{ source('crmuser', 'closroutingdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__closroutingdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__closroutingdetails.sql", "name": "stg_los__closroutingdetails", "alias": "stg_los__closroutingdetails", "checksum": {"name": "sha256", "checksum": "8e8a1be5329f7e751d4d7e0c23a26d44dcbdf0116124d8a2569c799b6823fbb1"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "closroutingdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__closroutingdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3610108, "compiled_code": "\nWITH source AS(\nSELECT closroutingdetailsid\n, loginid\n, bank_id\n, useractiontrayid\n, assignedby\n, assignedto\n, ownerid\n, routetostep\n, routingreasoncode\n, routingcomments\n, timestatus\n, compliancestatus\n, waiverstatus\n, userfield1\n, userfield2\n, userflag1\n, userflag2\n,  cast(routingdate as timestamp(3)) as routingdate\n, routingtime\n, applcomments\n, stepid\n,  cast(tmdate as timestamp(3)) as tmdate\n, stepslahours\n, steptathours\n,  cast(stepduedate as timestamp(3)) as stepduedate\nFROM oracle_los.crmuser.closroutingdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__closroutingdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__closroutingdetails"}, "model.dga_data_model.stg_los__collateralgeneraldetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.collateralgeneraldetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__collateralgeneraldetails"], "unique_id": "model.dga_data_model.stg_los__collateralgeneraldetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT collateralgeneraldetailsid\r\n,  cast(actualdateofvaluation as timestamp(3)) as actualdateofvaluation\r\n, collateralgenseqno\r\n,  cast(nextdateofvaluation as timestamp(3)) as nextdateofvaluation\r\n, remarks\r\n, thirdpartylienvalue\r\n, valuationagency\r\n, valuemarker\r\n, grosscollateralvalue\r\n,  cast(lastvaluationdate as timestamp(3)) as lastvaluationdate\r\n, marginpercnt\r\n, collateralvalue\r\n, ceilinglimit\r\n, collateralid\r\n, collateralcode\r\n, collateralstatus\r\n, collateraltype\r\n, collateralvaluebeforelien\r\n, description\r\n, existingyn\r\n, frequency\r\n, isinno\r\n, unitvalue\r\n, currency\r\n, apportioningmethod\r\n, restrictedvalue\r\n, collateralreferenceno\r\n, bookingstatus\r\n, accessowneragent\r\n, accessassigneeagent\r\n, accessownerbc\r\n, accessownersegment\r\n, accessownergroup\r\n, accountfeesdr\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, iscollateraladded\r\n, collateralvaluemodifyflag\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, customcollateralname\r\n, customcollateraltype\r\n, customdescription\r\n, custommortgagetype\r\n, customcollateralofficer\r\n, customtitlenoprefix\r\n, custommodeldescription\r\n,  cast(customagreementstartdate as timestamp(3)) as customagreementstartdate\r\n,  cast(customagreemenetenddate as timestamp(3)) as customagreemenetenddate\r\n, customcountryofregistration\r\n, custombgbankname\r\n, customdescriptionofextra\r\n, customregistrationnumber\r\n, customregofownerplace\r\n, customsecuredtrnxregplace\r\n,  cast(custombgstartdate as timestamp(3)) as custombgstartdate\r\n,  cast(custombgenddate as timestamp(3)) as custombgenddate\r\n,  cast(customsecredtrnxregdate6 as timestamp(3)) as customsecredtrnxregdate6\r\n, customyearofmanuf\r\n,  cast(customexternalorappraisaldate as timestamp(3)) as customexternalorappraisaldate\r\n,  cast(customdepositexpirationdate as timestamp(3)) as customdepositexpirationdate\r\n, customitemtype\r\n, customgoldcode\r\n, custompurchasereceiptno\r\n, customlogbookno\r\n, customenginenumber\r\n, customchassisnumber\r\n, customnewusedrecond\r\n, custommodelnumber\r\n, customregisteredownername\r\n,  cast(customroadtaxexpirydate as timestamp(3)) as customroadtaxexpirydate\r\n, customplaceofnotarypublic\r\n, customremarks\r\n,  cast(customregisterdate as timestamp(3)) as customregisterdate\r\n, customremarksvaluation\r\n, custommsbaccount\r\n, customdeposittenor\r\n, customdeposittenordays\r\n, customcollateralcodeccy\r\n, custominterestrate\r\n, customissuinginstitution\r\n,  cast(customissuedate as timestamp(3)) as customissuedate\r\n,  cast(customregofownerrightdate6 as timestamp(3)) as customregofownerrightdate6\r\n, customexternalorappraisername\r\n, customregofownernumber\r\n, customofficialvaluation\r\n,  cast(customvaluationdate as timestamp(3)) as customvaluationdate\r\n, customkeyid\r\n, customcontactname\r\n, customcontactno\r\n, customalternatecontactno\r\n, customcollat4qsubtype\r\n, customlandcategory\r\n,  cast(customnotarydate as timestamp(3)) as customnotarydate\r\n, customprojectcode\r\n, customvaluationreport\r\n,  cast(customvaluationexpdate as timestamp(3)) as customvaluationexpdate\r\n, customcollateralbranch\r\n, custommaintbranch\r\n, custompowerattno\r\n, custompowerattplace\r\n, customissuebranch\r\n,  cast(custompowerattdate as timestamp(3)) as custompowerattdate\r\n, customstr1\r\n, customstr2\r\n, customstr3\r\n, customstr4\r\n,  cast(customusrdate1 as timestamp(3)) as customusrdate1\r\n,  cast(customusrdate2 as timestamp(3)) as customusrdate2\r\n,  cast(customusrdate3 as timestamp(3)) as customusrdate3\r\n, customofficialvaluer\r\n, customvaluername\r\n, customcountrycode\r\n, customrelationship\r\n, custompurchaseprice\r\n, customappraisalvalue\r\n, customguarantoramount\r\n, customforcesalevalue\r\n, custombranch\r\n, customregisteredownercif\r\n, customextradesc\r\n\r\nFROM {{ source('crmuser', 'collateralgeneraldetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__collateralgeneraldetails.sql", "original_file_path": "models\\staging\\los\\stg_los__collateralgeneraldetails.sql", "name": "stg_los__collateralgeneraldetails", "alias": "stg_los__collateralgeneraldetails", "checksum": {"name": "sha256", "checksum": "ff637c0c4edfd5bea7a53842059008c849848d89655cc7cd5155cfc057949a2a"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "collateralgeneraldetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__collateralgeneraldetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3650107, "compiled_code": "\nWITH source AS(\nSELECT collateralgeneraldetailsid\n,  cast(actualdateofvaluation as timestamp(3)) as actualdateofvaluation\n, collateralgenseqno\n,  cast(nextdateofvaluation as timestamp(3)) as nextdateofvaluation\n, remarks\n, thirdpartylienvalue\n, valuationagency\n, valuemarker\n, grosscollateralvalue\n,  cast(lastvaluationdate as timestamp(3)) as lastvaluationdate\n, marginpercnt\n, collateralvalue\n, ceilinglimit\n, collateralid\n, collateralcode\n, collateralstatus\n, collateraltype\n, collateralvaluebeforelien\n, description\n, existingyn\n, frequency\n, isinno\n, unitvalue\n, currency\n, apportioningmethod\n, restrictedvalue\n, collateralreferenceno\n, bookingstatus\n, accessowneragent\n, accessassigneeagent\n, accessownerbc\n, accessownersegment\n, accessownergroup\n, accountfeesdr\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, iscollateraladded\n, collateralvaluemodifyflag\n,  cast(tmdate as timestamp(3)) as tmdate\n, customcollateralname\n, customcollateraltype\n, customdescription\n, custommortgagetype\n, customcollateralofficer\n, customtitlenoprefix\n, custommodeldescription\n,  cast(customagreementstartdate as timestamp(3)) as customagreementstartdate\n,  cast(customagreemenetenddate as timestamp(3)) as customagreemenetenddate\n, customcountryofregistration\n, custombgbankname\n, customdescriptionofextra\n, customregistrationnumber\n, customregofownerplace\n, customsecuredtrnxregplace\n,  cast(custombgstartdate as timestamp(3)) as custombgstartdate\n,  cast(custombgenddate as timestamp(3)) as custombgenddate\n,  cast(customsecredtrnxregdate6 as timestamp(3)) as customsecredtrnxregdate6\n, customyearofmanuf\n,  cast(customexternalorappraisaldate as timestamp(3)) as customexternalorappraisaldate\n,  cast(customdepositexpirationdate as timestamp(3)) as customdepositexpirationdate\n, customitemtype\n, customgoldcode\n, custompurchasereceiptno\n, customlogbookno\n, customenginenumber\n, customchassisnumber\n, customnewusedrecond\n, custommodelnumber\n, customregisteredownername\n,  cast(customroadtaxexpirydate as timestamp(3)) as customroadtaxexpirydate\n, customplaceofnotarypublic\n, customremarks\n,  cast(customregisterdate as timestamp(3)) as customregisterdate\n, customremarksvaluation\n, custommsbaccount\n, customdeposittenor\n, customdeposittenordays\n, customcollateralcodeccy\n, custominterestrate\n, customissuinginstitution\n,  cast(customissuedate as timestamp(3)) as customissuedate\n,  cast(customregofownerrightdate6 as timestamp(3)) as customregofownerrightdate6\n, customexternalorappraisername\n, customregofownernumber\n, customofficialvaluation\n,  cast(customvaluationdate as timestamp(3)) as customvaluationdate\n, customkeyid\n, customcontactname\n, customcontactno\n, customalternatecontactno\n, customcollat4qsubtype\n, customlandcategory\n,  cast(customnotarydate as timestamp(3)) as customnotarydate\n, customprojectcode\n, customvaluationreport\n,  cast(customvaluationexpdate as timestamp(3)) as customvaluationexpdate\n, customcollateralbranch\n, custommaintbranch\n, custompowerattno\n, custompowerattplace\n, customissuebranch\n,  cast(custompowerattdate as timestamp(3)) as custompowerattdate\n, customstr1\n, customstr2\n, customstr3\n, customstr4\n,  cast(customusrdate1 as timestamp(3)) as customusrdate1\n,  cast(customusrdate2 as timestamp(3)) as customusrdate2\n,  cast(customusrdate3 as timestamp(3)) as customusrdate3\n, customofficialvaluer\n, customvaluername\n, customcountrycode\n, customrelationship\n, custompurchaseprice\n, customappraisalvalue\n, customguarantoramount\n, customforcesalevalue\n, custombranch\n, customregisteredownercif\n, customextradesc\n\nFROM oracle_los.crmuser.collateralgeneraldetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__collateralgeneraldetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__collateralgeneraldetails"}, "model.dga_data_model.stg_los__collaterallinkage": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.collaterallinkage"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__collaterallinkage"], "unique_id": "model.dga_data_model.stg_los__collaterallinkage", "raw_code": "{{\r\n    config(\r\n        materialized='incremental'\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT collaterallinkageid\r\n\t,  collateralgenseqno\r\n\t,  \"PRIMARY\"\r\n\t,  prodrefsequenceno\r\n\t,  collateralgeneraldetailsid\r\n\t,  marginpercnt\r\n\t,  apportionedvalue\r\n\t,  associatedto\r\n\t,  limitrefno\r\n\t,  productrefno\r\n\t,  valuationrequired\r\n\t,  totalapportionedvalue\r\n\t,  applicationrefno\r\n\t,  availablevalue\r\n\t,  isdeleted\r\n\t,  applicationtype\r\n\t,  linkage\r\n\t,  islinkedtocore\r\n\t,  apportionedpercnt\r\n\t,  applicationid\r\n\t,  bank_id\r\n\t,  bodatecreated\r\n\t,  bocreatedby\r\n\t,  bodatemodified\r\n\t,  bomodifiedby\r\n\t,  concurdetect_x\r\n\t,  boaclid\r\n\t,  securityilhint\r\n\t,  securityiuhint\r\n\t,  securityglhint\r\n\t,  securityguhint\r\n\t,  cast(tmdate as timestamp(3)) as tmdate\r\n\t,  custommaxcovvalue\r\n\t,  maxcovperc\r\nFROM\r\n{{ source('crmuser', 'collaterallinkage') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__collaterallinkage.sql", "original_file_path": "models\\staging\\los\\stg_los__collaterallinkage.sql", "name": "stg_los__collaterallinkage", "alias": "stg_los__collaterallinkage", "checksum": {"name": "sha256", "checksum": "fb320c95a3b06910c318e1932712e10ee543459cca0b86b9ea9ea221f3ac8dee"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "collaterallinkage"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__collaterallinkage.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": "los", "materialized": "incremental"}, "created_at": 1685959751.6901193, "compiled_code": "\nWITH source AS(\nSELECT collaterallinkageid\n\t,  collateralgenseqno\n\t,  \"PRIMARY\"\n\t,  prodrefsequenceno\n\t,  collateralgeneraldetailsid\n\t,  marginpercnt\n\t,  apportionedvalue\n\t,  associatedto\n\t,  limitrefno\n\t,  productrefno\n\t,  valuationrequired\n\t,  totalapportionedvalue\n\t,  applicationrefno\n\t,  availablevalue\n\t,  isdeleted\n\t,  applicationtype\n\t,  linkage\n\t,  islinkedtocore\n\t,  apportionedpercnt\n\t,  applicationid\n\t,  bank_id\n\t,  bodatecreated\n\t,  bocreatedby\n\t,  bodatemodified\n\t,  bomodifiedby\n\t,  concurdetect_x\n\t,  boaclid\n\t,  securityilhint\n\t,  securityiuhint\n\t,  securityglhint\n\t,  securityguhint\n\t,  cast(tmdate as timestamp(3)) as tmdate\n\t,  custommaxcovvalue\n\t,  maxcovperc\nFROM\noracle_los.crmuser.collaterallinkage\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__collaterallinkage)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__collaterallinkage"}, "model.dga_data_model.stg_los__corpappentitydetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.corpappentitydetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__corpappentitydetails"], "unique_id": "model.dga_data_model.stg_los__corpappentitydetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT corpappentitydetailsid\r\n, entityname\r\n, snapshot\r\n, overrideriskgrade\r\n, overrideriskreasoncode\r\n, corpapplicationdetailsid\r\n, entityid\r\n, entitytype\r\n,  cast(overriddendate as timestamp(3)) as overriddendate\r\n, overriddenby\r\n, watchlistflg\r\n, strictreportmarkflg\r\n, reviewingteam\r\n, proposedriskgrade\r\n, existingriskgrade\r\n,  cast(incorpdate as timestamp(3)) as incorpdate\r\n,  cast(relshipstdate as timestamp(3)) as relshipstdate\r\n, existingexposure\r\n, parentgroupid\r\n, entitysubtype\r\n, proposedexposure\r\n, changeinexposure\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, corpapplicantrefno\r\n, isentitybooked\r\nFROM {{ source('crmuser', 'corpappentitydetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__corpappentitydetails.sql", "original_file_path": "models\\staging\\los\\stg_los__corpappentitydetails.sql", "name": "stg_los__corpappentitydetails", "alias": "stg_los__corpappentitydetails", "checksum": {"name": "sha256", "checksum": "99ae0812031d03a8c2fb811bef424bc4fe1944ddc7208a04c39316f4cb38bde6"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "corpappentitydetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__corpappentitydetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3540106, "compiled_code": "\nWITH source AS(\nSELECT corpappentitydetailsid\n, entityname\n, snapshot\n, overrideriskgrade\n, overrideriskreasoncode\n, corpapplicationdetailsid\n, entityid\n, entitytype\n,  cast(overriddendate as timestamp(3)) as overriddendate\n, overriddenby\n, watchlistflg\n, strictreportmarkflg\n, reviewingteam\n, proposedriskgrade\n, existingriskgrade\n,  cast(incorpdate as timestamp(3)) as incorpdate\n,  cast(relshipstdate as timestamp(3)) as relshipstdate\n, existingexposure\n, parentgroupid\n, entitysubtype\n, proposedexposure\n, changeinexposure\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\n, corpapplicantrefno\n, isentitybooked\nFROM oracle_los.crmuser.corpappentitydetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__corpappentitydetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__corpappentitydetails"}, "model.dga_data_model.stg_los__corpapplicationdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.corpapplicationdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__corpapplicationdetails"], "unique_id": "model.dga_data_model.stg_los__corpapplicationdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpapplicationdetailsid\r\n, snapshot\r\n, applicationtype\r\n, applicationsubtype\r\n, applnumber\r\n, applicationdesc\r\n,  cast(applstartdate as timestamp(3)) as applstartdate\r\n, underwriterid\r\n, salesownerid\r\n, prequalificationflg\r\n,  cast(fullreviewdate as timestamp(3)) as fullreviewdate\r\n, criteriametflg\r\n, priority\r\n, applicationstatus\r\n,  cast(interimreviewdate as timestamp(3)) as interimreviewdate\r\n, applcomments\r\n, writeupcomment\r\n,  cast(appclosedate as timestamp(3)) as appclosedate\r\n, appstage\r\n,  cast(appdecisiondate as timestamp(3)) as appdecisiondate\r\n, accessowneragent\r\n, accessassigneeagent\r\n, accessownerbc\r\n, accessownersegment\r\n, accessownergroup\r\n, isaddendumraised\r\n, linkedapplication\r\n, appldecisionstatus\r\n, bcgroup\r\n, processnamespace\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, strusercomment1\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n,  cast(creditdecivaldate as timestamp(3)) as creditdecivaldate\r\nFROM {{ source('crmuser', 'corpapplicationdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__corpapplicationdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__corpapplicationdetails.sql", "name": "stg_los__corpapplicationdetails", "alias": "stg_los__corpapplicationdetails", "checksum": {"name": "sha256", "checksum": "a101c3bbb81a4c606063c5e56cdd5d3b4276a2a7b1b8be0492f275cd03873d16"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "corpapplicationdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__corpapplicationdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3430107, "compiled_code": "\nWITH source AS(\nSELECT  corpapplicationdetailsid\n, snapshot\n, applicationtype\n, applicationsubtype\n, applnumber\n, applicationdesc\n,  cast(applstartdate as timestamp(3)) as applstartdate\n, underwriterid\n, salesownerid\n, prequalificationflg\n,  cast(fullreviewdate as timestamp(3)) as fullreviewdate\n, criteriametflg\n, priority\n, applicationstatus\n,  cast(interimreviewdate as timestamp(3)) as interimreviewdate\n, applcomments\n, writeupcomment\n,  cast(appclosedate as timestamp(3)) as appclosedate\n, appstage\n,  cast(appdecisiondate as timestamp(3)) as appdecisiondate\n, accessowneragent\n, accessassigneeagent\n, accessownerbc\n, accessownersegment\n, accessownergroup\n, isaddendumraised\n, linkedapplication\n, appldecisionstatus\n, bcgroup\n, processnamespace\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, strusercomment1\n,  cast(tmdate as timestamp(3)) as tmdate\n,  cast(creditdecivaldate as timestamp(3)) as creditdecivaldate\nFROM oracle_los.crmuser.corpapplicationdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__corpapplicationdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__corpapplicationdetails"}, "model.dga_data_model.stg_los__corpapplimitdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.corpapplimitdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__corpapplimitdetails"], "unique_id": "model.dga_data_model.stg_los__corpapplimitdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpapplimitdetailsid\r\n, syndfacilityrefno\r\n, syndfacilitydesc\r\n, agentbankcode\r\n, agentbranchcode\r\n, availableperiodmonths\r\n, availableperioddays\r\n, totalsyndicationlimit\r\n, totalsyndicationlimitccy\r\n, corpappentitydetailsid\r\n, limitclassification\r\n, limitcategory\r\n, purposecode\r\n, limitdescription\r\n, amtderivedchildflg\r\n, netlimitapplicableflg\r\n, existinglimit\r\n, proposedlimit\r\n, existingnetlimit\r\n, existinggrosslimit\r\n, proposednetlimit\r\n, proposedgrosslimit\r\n, existinglimitccy\r\n, proposedlimitccy\r\n, existingnetlimitccy\r\n, existinggrosslimitccy\r\n, proposednetlimitccy\r\n, proposedgrosslimitccy\r\n, limitshared\r\n,  cast(effectivedate as timestamp(3)) as effectivedate\r\n, limittermdays\r\n, limittermmonths\r\n,  cast(expirydate as timestamp(3)) as expirydate\r\n,  cast(limitreviewdate as timestamp(3)) as limitreviewdate\r\n,  cast(availabilityenddate as timestamp(3)) as availabilityenddate\r\n, revolvingflg\r\n, committedflg\r\n, indemnityheldflg\r\n, accountsofficer\r\n, primarysrcrepayment\r\n, secondarysrcrepayment\r\n, syndicationflg\r\n, limitstatus\r\n, remarks\r\n, sncdetailid\r\n, underwritingamount\r\n, underwritingamountccy\r\n, underwritingamounthome\r\n, takeholdamount\r\n, takeholdamountccy\r\n, takeholdamounthome\r\n, underwritingamounthomeccy\r\n, takeholdamounthomeccy\r\n, agent\r\n, participant\r\n, underwriter\r\n, isdeleted\r\n, limitrefno\r\n, parentlimitrefno\r\n, proposedlimitinhomeccy\r\n, limitccy\r\n, proposedlimitinlimitccy\r\n, relationshiplevel\r\n, approvedlimit\r\n, approvedlimitccy\r\n, approvedlimithomeccy\r\n, approvedlimitinlimitccy\r\n, approvednetlimit\r\n, approvednetlimitccy\r\n, approvedgrosslimit\r\n, approvedgrosslimitccy\r\n, drawingpwrind\r\n, drawingpwrpcnt\r\n, drawingpwrretained\r\n,  cast(offerletterreceiveddate as timestamp(3)) as offerletterreceiveddate\r\n, offerletterreceived\r\n, intratetablecode\r\n, priorityloan\r\n, ispapfield\r\n, routetostep\r\n, routingreasoncode\r\n, papagent\r\n, limitdecision\r\n, limitdecisioncode\r\n, limitremarks\r\n, dlod\r\n, dlodlimitclassification\r\n, dlodlimitcategory\r\n, existingdaylightlimit\r\n, existingdaylightcurrency\r\n, proposeddaylightlimit\r\n, proposeddaylightcurrency\r\n, dlodlimitstatus\r\n, limitidprefix\r\n, limitidsuffix\r\n, applnumber\r\n,  cast(offerlettersentdate as timestamp(3)) as offerlettersentdate\r\n, bookingstatus\r\n, accountfeesdr\r\n, lastapprovedlimit\r\n, partlimitstatus\r\n, snapshot\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, versionnumber\r\n, islimitadded\r\n, existinglimithomeccy\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, silverlakebranchcode\r\n, officercode\r\n, availablebalanceindicator\r\n, producttype\r\n, paymentcode\r\n, contractnumber\r\n, contractsignedby\r\n, contractdelegatedby\r\n, unsecuredlimit\r\n, totalderivedvalue\r\n, supportlimit1\r\n, supportlimit2\r\n, securedlimit\r\n,  cast(contractdate as timestamp(3)) as contractdate\r\n, paymentfrequencydays\r\n, interestfrequencydays\r\n, paymentfrequencymonths\r\n, interestfrequencymonths\r\n, facilityseq\r\n, ismainfacility\r\n, mainfacilitycode\r\n, mainfacilityseq\r\n, outputlevel\r\n, islimitmodified\r\n, customcreditapprovedlimit\r\nFROM {{ source('crmuser', 'corpapplimitdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__corpapplimitdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__corpapplimitdetails.sql", "name": "stg_los__corpapplimitdetails", "alias": "stg_los__corpapplimitdetails", "checksum": {"name": "sha256", "checksum": "3c0a535319dc1f378ea5ba70c317ed3e08dfe9a2cb639d08ff8cf796c5376aca"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "corpapplimitdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__corpapplimitdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3400104, "compiled_code": "\nWITH source AS(\nSELECT  corpapplimitdetailsid\n, syndfacilityrefno\n, syndfacilitydesc\n, agentbankcode\n, agentbranchcode\n, availableperiodmonths\n, availableperioddays\n, totalsyndicationlimit\n, totalsyndicationlimitccy\n, corpappentitydetailsid\n, limitclassification\n, limitcategory\n, purposecode\n, limitdescription\n, amtderivedchildflg\n, netlimitapplicableflg\n, existinglimit\n, proposedlimit\n, existingnetlimit\n, existinggrosslimit\n, proposednetlimit\n, proposedgrosslimit\n, existinglimitccy\n, proposedlimitccy\n, existingnetlimitccy\n, existinggrosslimitccy\n, proposednetlimitccy\n, proposedgrosslimitccy\n, limitshared\n,  cast(effectivedate as timestamp(3)) as effectivedate\n, limittermdays\n, limittermmonths\n,  cast(expirydate as timestamp(3)) as expirydate\n,  cast(limitreviewdate as timestamp(3)) as limitreviewdate\n,  cast(availabilityenddate as timestamp(3)) as availabilityenddate\n, revolvingflg\n, committedflg\n, indemnityheldflg\n, accountsofficer\n, primarysrcrepayment\n, secondarysrcrepayment\n, syndicationflg\n, limitstatus\n, remarks\n, sncdetailid\n, underwritingamount\n, underwritingamountccy\n, underwritingamounthome\n, takeholdamount\n, takeholdamountccy\n, takeholdamounthome\n, underwritingamounthomeccy\n, takeholdamounthomeccy\n, agent\n, participant\n, underwriter\n, isdeleted\n, limitrefno\n, parentlimitrefno\n, proposedlimitinhomeccy\n, limitccy\n, proposedlimitinlimitccy\n, relationshiplevel\n, approvedlimit\n, approvedlimitccy\n, approvedlimithomeccy\n, approvedlimitinlimitccy\n, approvednetlimit\n, approvednetlimitccy\n, approvedgrosslimit\n, approvedgrosslimitccy\n, drawingpwrind\n, drawingpwrpcnt\n, drawingpwrretained\n,  cast(offerletterreceiveddate as timestamp(3)) as offerletterreceiveddate\n, offerletterreceived\n, intratetablecode\n, priorityloan\n, ispapfield\n, routetostep\n, routingreasoncode\n, papagent\n, limitdecision\n, limitdecisioncode\n, limitremarks\n, dlod\n, dlodlimitclassification\n, dlodlimitcategory\n, existingdaylightlimit\n, existingdaylightcurrency\n, proposeddaylightlimit\n, proposeddaylightcurrency\n, dlodlimitstatus\n, limitidprefix\n, limitidsuffix\n, applnumber\n,  cast(offerlettersentdate as timestamp(3)) as offerlettersentdate\n, bookingstatus\n, accountfeesdr\n, lastapprovedlimit\n, partlimitstatus\n, snapshot\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, versionnumber\n, islimitadded\n, existinglimithomeccy\n,  cast(tmdate as timestamp(3)) as tmdate\n, silverlakebranchcode\n, officercode\n, availablebalanceindicator\n, producttype\n, paymentcode\n, contractnumber\n, contractsignedby\n, contractdelegatedby\n, unsecuredlimit\n, totalderivedvalue\n, supportlimit1\n, supportlimit2\n, securedlimit\n,  cast(contractdate as timestamp(3)) as contractdate\n, paymentfrequencydays\n, interestfrequencydays\n, paymentfrequencymonths\n, interestfrequencymonths\n, facilityseq\n, ismainfacility\n, mainfacilitycode\n, mainfacilityseq\n, outputlevel\n, islimitmodified\n, customcreditapprovedlimit\nFROM oracle_los.crmuser.corpapplimitdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__corpapplimitdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__corpapplimitdetails"}, "model.dga_data_model.stg_los__corpdecisioncode": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.corpdecisioncode"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__corpdecisioncode"], "unique_id": "model.dga_data_model.stg_los__corpdecisioncode", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpdecisioncodeid\r\n, creditcommiteenumber\r\n,  cast(creditapprovaldate as timestamp(3)) as creditapprovaldate\r\n, corpapplicationdetailsid\r\n, appldecisioncode\r\n, codedecsription\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, creditcommitteenumber\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'corpdecisioncode') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__corpdecisioncode.sql", "original_file_path": "models\\staging\\los\\stg_los__corpdecisioncode.sql", "name": "stg_los__corpdecisioncode", "alias": "stg_los__corpdecisioncode", "checksum": {"name": "sha256", "checksum": "7737d460a52ed685533969656b56d63e64e2838052c07f311193cb0a7611e164"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "corpdecisioncode"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__corpdecisioncode.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3230104, "compiled_code": "\nWITH source AS(\nSELECT  corpdecisioncodeid\n, creditcommiteenumber\n,  cast(creditapprovaldate as timestamp(3)) as creditapprovaldate\n, corpapplicationdetailsid\n, appldecisioncode\n, codedecsription\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, creditcommitteenumber\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.corpdecisioncode\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__corpdecisioncode)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__corpdecisioncode"}, "model.dga_data_model.stg_los__creditcardproduct": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.creditcardproduct"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__creditcardproduct"], "unique_id": "model.dga_data_model.stg_los__creditcardproduct", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  creditcardproductid\r\n, applicationdetailsid\r\n, creditcardlimit\r\n, cashwithdrawallimit\r\n, minimumamtduepercent\r\n, accountnumber\r\n, accountname\r\n, currency\r\n, interestratecode\r\n, interestrate\r\n, sequenceno\r\n, embossedname\r\n,  cast(validfromdate as timestamp(3)) as validfromdate\r\n,  cast(validtilldate as timestamp(3)) as validtilldate\r\n, dispatchmode\r\n, repaymenttype\r\n, addoncardrequired\r\n, billingfrequency\r\n, repaymentmode\r\n, cardtype\r\n, balancetransferrequested\r\n, includeaccruedinterest\r\n, graceperiod\r\n, isdeleted\r\n, biccode\r\n, paysysid\r\n, billingfreqnumbers\r\n, billingfreqweekofmonth\r\n, billingfreqdayofweek\r\n, billingfreqdate\r\n, billingfreqholiday\r\n,  cast(billingfreqstartdate as timestamp(3)) as billingfreqstartdate\r\n, billingfreqcalendar\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, customsecquestion\r\n, custompartmember\r\n, customcrosssalename\r\n, customcrosssaleid\r\n, customcrosssalephone\r\n, customcrosssaleemail\r\n, custompintype\r\n, customcardtype\r\nFROM {{ source('crmuser', 'creditcardproduct') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__creditcardproduct.sql", "original_file_path": "models\\staging\\los\\stg_los__creditcardproduct.sql", "name": "stg_los__creditcardproduct", "alias": "stg_los__creditcardproduct", "checksum": {"name": "sha256", "checksum": "f0086a6c179ee858d4a8946cea592483e65b11801748398410b91f6de019f075"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "creditcardproduct"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__creditcardproduct.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3480105, "compiled_code": "\nWITH source AS(\nSELECT  creditcardproductid\n, applicationdetailsid\n, creditcardlimit\n, cashwithdrawallimit\n, minimumamtduepercent\n, accountnumber\n, accountname\n, currency\n, interestratecode\n, interestrate\n, sequenceno\n, embossedname\n,  cast(validfromdate as timestamp(3)) as validfromdate\n,  cast(validtilldate as timestamp(3)) as validtilldate\n, dispatchmode\n, repaymenttype\n, addoncardrequired\n, billingfrequency\n, repaymentmode\n, cardtype\n, balancetransferrequested\n, includeaccruedinterest\n, graceperiod\n, isdeleted\n, biccode\n, paysysid\n, billingfreqnumbers\n, billingfreqweekofmonth\n, billingfreqdayofweek\n, billingfreqdate\n, billingfreqholiday\n,  cast(billingfreqstartdate as timestamp(3)) as billingfreqstartdate\n, billingfreqcalendar\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\n, customsecquestion\n, custompartmember\n, customcrosssalename\n, customcrosssaleid\n, customcrosssalephone\n, customcrosssaleemail\n, custompintype\n, customcardtype\nFROM oracle_los.crmuser.creditcardproduct\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__creditcardproduct)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__creditcardproduct"}, "model.dga_data_model.stg_los__creditscoringdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.creditscoringdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__creditscoringdetails"], "unique_id": "model.dga_data_model.stg_los__creditscoringdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  scoringapplicationid\r\n, parentapplicationid\r\n, score\r\n, grade\r\n, recommendedmodel\r\n,  cast(scoringdate as timestamp(3)) as scoringdate\r\n, scoringuser\r\n, prescreenresult\r\n,  cast(dateofupdation as timestamp(3)) as dateofupdation\r\n, scoringappstatus\r\n, ewsresults\r\n, monthofewsresult\r\n, remarks\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, freenum1\r\n, freenum2\r\n, freenum3\r\n,  cast(freedate1 as timestamp(3)) as freedate1\r\n,  cast(freedate2 as timestamp(3)) as freedate2\r\n,  cast(freedate3 as timestamp(3)) as freedate3\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'creditscoringdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__creditscoringdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__creditscoringdetails.sql", "name": "stg_los__creditscoringdetails", "alias": "stg_los__creditscoringdetails", "checksum": {"name": "sha256", "checksum": "ab72f16d1be0bff3bd43cb37df6f978fa60c90c248c6d59d12d2dc5e3513b47f"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "creditscoringdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__creditscoringdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3080108, "compiled_code": "\nWITH source AS(\nSELECT  scoringapplicationid\n, parentapplicationid\n, score\n, grade\n, recommendedmodel\n,  cast(scoringdate as timestamp(3)) as scoringdate\n, scoringuser\n, prescreenresult\n,  cast(dateofupdation as timestamp(3)) as dateofupdation\n, scoringappstatus\n, ewsresults\n, monthofewsresult\n, remarks\n, freetext1\n, freetext2\n, freetext3\n, freenum1\n, freenum2\n, freenum3\n,  cast(freedate1 as timestamp(3)) as freedate1\n,  cast(freedate2 as timestamp(3)) as freedate2\n,  cast(freedate3 as timestamp(3)) as freedate3\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.creditscoringdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__creditscoringdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__creditscoringdetails"}, "model.dga_data_model.stg_los__custidentitydetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.custidentitydetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__custidentitydetail"], "unique_id": "model.dga_data_model.stg_los__custidentitydetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  custidentitydetailid\r\n, documentuniqueid\r\n, documentcode\r\n, doctypedesc\r\n, placeofissue\r\n, cityofissue\r\n, stateofissue\r\n, countryofissue\r\n,  cast(docissuedt as timestamp(3)) as docissuedt\r\n,  cast(docexpdt as timestamp(3)) as docexpdt\r\n, idissuedby\r\n, fdmadocumentid\r\n, customerdetailid\r\n, doccodedesc\r\n, docrmks\r\n, deletestatus\r\n, prefuniqueidind\r\n, docverifiedind\r\n, refnum\r\n, status\r\n, scanreqdind\r\n, entitytype\r\n, idendoctype\r\n, crmdocumentid\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, filename\r\n, cifid\r\n, parentapplicationid\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'custidentitydetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__custidentitydetail.sql", "original_file_path": "models\\staging\\los\\stg_los__custidentitydetail.sql", "name": "stg_los__custidentitydetail", "alias": "stg_los__custidentitydetail", "checksum": {"name": "sha256", "checksum": "c4bf7060a360bffa34c3f3d644bb522a00405c6dadebe4d7dc866c359c40c158"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "custidentitydetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__custidentitydetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3440108, "compiled_code": "\nWITH source AS(\nSELECT  custidentitydetailid\n, documentuniqueid\n, documentcode\n, doctypedesc\n, placeofissue\n, cityofissue\n, stateofissue\n, countryofissue\n,  cast(docissuedt as timestamp(3)) as docissuedt\n,  cast(docexpdt as timestamp(3)) as docexpdt\n, idissuedby\n, fdmadocumentid\n, customerdetailid\n, doccodedesc\n, docrmks\n, deletestatus\n, prefuniqueidind\n, docverifiedind\n, refnum\n, status\n, scanreqdind\n, entitytype\n, idendoctype\n, crmdocumentid\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, filename\n, cifid\n, parentapplicationid\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.custidentitydetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__custidentitydetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__custidentitydetail"}, "model.dga_data_model.stg_los__customerdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.customerdetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__customerdetail"], "unique_id": "model.dga_data_model.stg_los__customerdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  customerdetailid\r\n, isapplicantdedupchkdone\r\n, fisrvcalltype\r\n, custsequenceno\r\n, ficallstatus\r\n, kycscore\r\n,  cast(kycdate as timestamp(3)) as kycdate\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, accessowneragent\r\n, accessassigneeagent\r\n, cifid\r\n, custtype\r\n, cifassociationcount\r\n, title\r\n, fname\r\n, lname\r\n, mname\r\n,  cast(dob as timestamp(3)) as dob\r\n, gender\r\n, nationality\r\n, nativelangcode\r\n, nonresdindicator\r\n, resdtype\r\n, custoccupation\r\n, maritalstatus\r\n, veteran\r\n, noofyrofschool\r\n, noofdependents\r\n, ageofdependents\r\n, staffindicator\r\n, custsegment\r\n, custsubsegment\r\n, custrating\r\n, ecifnotified\r\n, cifresponseflg\r\n, cifresponsermrk\r\n, deletestatus\r\n, blacklisted\r\n, blacklistnote\r\n, blacklistreason\r\n, isblacklistchkdone\r\n, negated\r\n, neglistnote\r\n, neglistreason\r\n, isneglistchkdone\r\n, isdedupchkdone\r\n, dedupchknote\r\n, suspended\r\n, suspendedreason\r\n, suspendednote\r\n, status\r\n, statuscode\r\n, totalamount3\r\n, totalamount1\r\n, totalamount2\r\n, dedupreasoncode\r\n, bank_id\r\n, staffid\r\n, preferredname\r\n, prirelmanagerid\r\n, shortname\r\n, region\r\n, smsbankingenabledind\r\n, smsbankingmobilenum\r\n, nameinpreflang\r\n, isebankingenabled\r\n, primaryservicecenter\r\n, prospectminind\r\n,  cast(relashipopendt as timestamp(3)) as relashipopendt\r\n, tfpartyind\r\n, tdstbl\r\n, tdstblcode\r\n,  cast(nrbecomingdt as timestamp(3)) as nrbecomingdt\r\n, nickname\r\n, prospectid\r\n, crmentitytype\r\n, surname\r\n, prospecttocustomerconvflag\r\n, preferredaddress\r\n, basecurrency\r\n, primarysolid\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, immigrationstatus\r\n, insidertobank\r\n, insiderrole\r\n, decisionremark\r\n, decisionresult\r\n, employmentstatus\r\n, grossincome\r\n, grossincomecurrency\r\n, industrytype\r\n, isautoapproved\r\n, isguardianrequired\r\n, jobtitle\r\n, noofdependentchildren\r\n, suffix\r\n, taxid\r\n, cntryofcitizenship\r\n, govtempofaclstcntry\r\n, freetext1\r\n, freetext2\r\n, freecode1\r\n, freecode2\r\n, taxdetdsourccifid\r\n, taxdetdsourctable\r\n, isforeignacctaxrepreqd\r\n, foreigntaxrepcntry\r\n, foreigntaxreptingstatus\r\n,  cast(foreigntaxrptingdate as timestamp(3)) as foreigntaxrptingdate\r\n, foreigntaxcomments\r\n, insiderciftype\r\n, insidercifid\r\n, freetext3\r\n, freetext4\r\n, freetext5\r\n, freetext6\r\n, freetext7\r\n, freetext8\r\n, freetext9\r\n, freetext10\r\n,  cast(freedate1 as timestamp(3)) as freedate1\r\n,  cast(freedate2 as timestamp(3)) as freedate2\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'customerdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__customerdetail.sql", "original_file_path": "models\\staging\\los\\stg_los__customerdetail.sql", "name": "stg_los__customerdetail", "alias": "stg_los__customerdetail", "checksum": {"name": "sha256", "checksum": "176943eacde9653a33b395c89a54e386dbfa0607b7bc7dffde4d313ddd60b07e"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "customerdetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__customerdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.2980103, "compiled_code": "\nWITH source AS(\nSELECT  customerdetailid\n, isapplicantdedupchkdone\n, fisrvcalltype\n, custsequenceno\n, ficallstatus\n, kycscore\n,  cast(kycdate as timestamp(3)) as kycdate\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, accessowneragent\n, accessassigneeagent\n, cifid\n, custtype\n, cifassociationcount\n, title\n, fname\n, lname\n, mname\n,  cast(dob as timestamp(3)) as dob\n, gender\n, nationality\n, nativelangcode\n, nonresdindicator\n, resdtype\n, custoccupation\n, maritalstatus\n, veteran\n, noofyrofschool\n, noofdependents\n, ageofdependents\n, staffindicator\n, custsegment\n, custsubsegment\n, custrating\n, ecifnotified\n, cifresponseflg\n, cifresponsermrk\n, deletestatus\n, blacklisted\n, blacklistnote\n, blacklistreason\n, isblacklistchkdone\n, negated\n, neglistnote\n, neglistreason\n, isneglistchkdone\n, isdedupchkdone\n, dedupchknote\n, suspended\n, suspendedreason\n, suspendednote\n, status\n, statuscode\n, totalamount3\n, totalamount1\n, totalamount2\n, dedupreasoncode\n, bank_id\n, staffid\n, preferredname\n, prirelmanagerid\n, shortname\n, region\n, smsbankingenabledind\n, smsbankingmobilenum\n, nameinpreflang\n, isebankingenabled\n, primaryservicecenter\n, prospectminind\n,  cast(relashipopendt as timestamp(3)) as relashipopendt\n, tfpartyind\n, tdstbl\n, tdstblcode\n,  cast(nrbecomingdt as timestamp(3)) as nrbecomingdt\n, nickname\n, prospectid\n, crmentitytype\n, surname\n, prospecttocustomerconvflag\n, preferredaddress\n, basecurrency\n, primarysolid\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, immigrationstatus\n, insidertobank\n, insiderrole\n, decisionremark\n, decisionresult\n, employmentstatus\n, grossincome\n, grossincomecurrency\n, industrytype\n, isautoapproved\n, isguardianrequired\n, jobtitle\n, noofdependentchildren\n, suffix\n, taxid\n, cntryofcitizenship\n, govtempofaclstcntry\n, freetext1\n, freetext2\n, freecode1\n, freecode2\n, taxdetdsourccifid\n, taxdetdsourctable\n, isforeignacctaxrepreqd\n, foreigntaxrepcntry\n, foreigntaxreptingstatus\n,  cast(foreigntaxrptingdate as timestamp(3)) as foreigntaxrptingdate\n, foreigntaxcomments\n, insiderciftype\n, insidercifid\n, freetext3\n, freetext4\n, freetext5\n, freetext6\n, freetext7\n, freetext8\n, freetext9\n, freetext10\n,  cast(freedate1 as timestamp(3)) as freedate1\n,  cast(freedate2 as timestamp(3)) as freedate2\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.customerdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__customerdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__customerdetail"}, "model.dga_data_model.stg_los__decision": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.decision"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__decision"], "unique_id": "model.dga_data_model.stg_los__decision", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  decisionid\r\n, decision\r\n, applicationid\r\n, ruleid\r\n, decisionresult\r\n, userid\r\n, internalscore\r\n,  cast(timestamp as timestamp(3)) as timestamp\r\n, decisioningtype\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isdeleted\r\n, comments\r\n,  cast(decisionexpirydate as timestamp(3)) as decisionexpirydate\r\n, groupid\r\n, frontendratio\r\n, backendratio\r\n, piamount\r\n, isparent\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'decision') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__decision.sql", "original_file_path": "models\\staging\\los\\stg_los__decision.sql", "name": "stg_los__decision", "alias": "stg_los__decision", "checksum": {"name": "sha256", "checksum": "7a45f70a33793141d37ab7a8b684071a8ebab8e42b6558768935a2014b80e9a7"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "decision"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__decision.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3310108, "compiled_code": "\nWITH source AS(\nSELECT  decisionid\n, decision\n, applicationid\n, ruleid\n, decisionresult\n, userid\n, internalscore\n,  cast(timestamp as timestamp(3)) as timestamp\n, decisioningtype\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isdeleted\n, comments\n,  cast(decisionexpirydate as timestamp(3)) as decisionexpirydate\n, groupid\n, frontendratio\n, backendratio\n, piamount\n, isparent\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.decision\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__decision)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__decision"}, "model.dga_data_model.stg_los__loanproductdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.loanproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__loanproductdetails"], "unique_id": "model.dga_data_model.stg_los__loanproductdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  loanproductdetailsid\r\n, offsetaccountnumber\r\n, spread\r\n, sequenceno\r\n, interestratecode\r\n, interestrate\r\n, documentationtype\r\n, iascode\r\n, assumptioneligible\r\n, installmenttype\r\n, repricingplan\r\n, repaymenttype\r\n, repaymentmethod\r\n, ratelockrequired\r\n, autopaydiscountapplicable\r\n, subsidyrequired\r\n, disbtype\r\n, buydownrequired\r\n, excldecredit\r\n, savingshomeflag\r\n, principalsubsidyamount\r\n, principalsubsidycurr\r\n, intbenefitsubsidy\r\n, buydowntype\r\n, currency\r\n,  cast(conversionallowedfrom as timestamp(3)) as conversionallowedfrom\r\n,  cast(conversionallowedto as timestamp(3)) as conversionallowedto\r\n, escrowaccountreq\r\n, armintladjcapincr\r\n, armintladjcapdecr\r\n, armperiodicadjcapincr\r\n, armperiodicadjcapdecr\r\n, armlifetimeadjcapdecr\r\n, armlifetimeadjcapincr\r\n, armintrmovmntrestrct\r\n, armminchangeintr\r\n, armadvintrratefixreq\r\n, armadvnoticeintchng\r\n, tenormonths\r\n, applicationdetailsid\r\n, amount\r\n, tenordays\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isdeleted\r\n, enrforcreditprotection\r\n,  cast(enrollmentfromdate as timestamp(3)) as enrollmentfromdate\r\n,  cast(enrollmenttodate as timestamp(3)) as enrollmenttodate\r\n, insured\r\n, maxcreproperiod\r\n, minbillamount\r\n, minpaymentapplicable\r\n, nameofinscompany\r\n, noofmissedpayallowed\r\n, promoperiod\r\n, promoperiodintrate\r\n, promoperiodintapplication\r\n, excludereason\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'loanproductdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__loanproductdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__loanproductdetails.sql", "name": "stg_los__loanproductdetails", "alias": "stg_los__loanproductdetails", "checksum": {"name": "sha256", "checksum": "d3e27f0eb26fb833283aa07b0d01598be4c5c8a1b68c37b5e291c1f7ea33bb71"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "loanproductdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__loanproductdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3640108, "compiled_code": "\nWITH source AS(\nSELECT  loanproductdetailsid\n, offsetaccountnumber\n, spread\n, sequenceno\n, interestratecode\n, interestrate\n, documentationtype\n, iascode\n, assumptioneligible\n, installmenttype\n, repricingplan\n, repaymenttype\n, repaymentmethod\n, ratelockrequired\n, autopaydiscountapplicable\n, subsidyrequired\n, disbtype\n, buydownrequired\n, excldecredit\n, savingshomeflag\n, principalsubsidyamount\n, principalsubsidycurr\n, intbenefitsubsidy\n, buydowntype\n, currency\n,  cast(conversionallowedfrom as timestamp(3)) as conversionallowedfrom\n,  cast(conversionallowedto as timestamp(3)) as conversionallowedto\n, escrowaccountreq\n, armintladjcapincr\n, armintladjcapdecr\n, armperiodicadjcapincr\n, armperiodicadjcapdecr\n, armlifetimeadjcapdecr\n, armlifetimeadjcapincr\n, armintrmovmntrestrct\n, armminchangeintr\n, armadvintrratefixreq\n, armadvnoticeintchng\n, tenormonths\n, applicationdetailsid\n, amount\n, tenordays\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isdeleted\n, enrforcreditprotection\n,  cast(enrollmentfromdate as timestamp(3)) as enrollmentfromdate\n,  cast(enrollmenttodate as timestamp(3)) as enrollmenttodate\n, insured\n, maxcreproperiod\n, minbillamount\n, minpaymentapplicable\n, nameofinscompany\n, noofmissedpayallowed\n, promoperiod\n, promoperiodintrate\n, promoperiodintapplication\n, excludereason\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.loanproductdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__loanproductdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__loanproductdetails"}, "model.dga_data_model.stg_los__losprocessentity": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.losprocessentity"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__losprocessentity"], "unique_id": "model.dga_data_model.stg_los__losprocessentity", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  losprocessentityid\r\n, processid\r\n, entityid\r\n, entityname\r\n, currentactivityid\r\n, parentactivityid\r\n, processstepstatus\r\n, salesownerid\r\n, salesownergroup\r\n, assigneduserid\r\n, assignedusergroup\r\n, assignedlocationid\r\n, entityowner\r\n, entityownergroup\r\n, entityownerlocationid\r\n, entitystage\r\n, routingtype\r\n, routingcomment\r\n, routingreasonecode\r\n, routingmatrixid\r\n, sla\r\n, activityname\r\n, userfield1\r\n, userfield2\r\n, processname\r\n, losprocessid\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, opportunityproductsid\r\n, entitystep\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'losprocessentity') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__losprocessentity.sql", "original_file_path": "models\\staging\\los\\stg_los__losprocessentity.sql", "name": "stg_los__losprocessentity", "alias": "stg_los__losprocessentity", "checksum": {"name": "sha256", "checksum": "c437863128409b752b7989b61abcb95acff2135436fa25983cfd1c91ad23de23"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "losprocessentity"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__losprocessentity.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3460107, "compiled_code": "\nWITH source AS(\nSELECT  losprocessentityid\n, processid\n, entityid\n, entityname\n, currentactivityid\n, parentactivityid\n, processstepstatus\n, salesownerid\n, salesownergroup\n, assigneduserid\n, assignedusergroup\n, assignedlocationid\n, entityowner\n, entityownergroup\n, entityownerlocationid\n, entitystage\n, routingtype\n, routingcomment\n, routingreasonecode\n, routingmatrixid\n, sla\n, activityname\n, userfield1\n, userfield2\n, processname\n, losprocessid\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, opportunityproductsid\n, entitystep\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.losprocessentity\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__losprocessentity)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__losprocessentity"}, "model.dga_data_model.stg_los__opportunities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.opportunities"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__opportunities"], "unique_id": "model.dga_data_model.stg_los__opportunities", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  opportunityid\r\n, productclassification\r\n, authtype\r\n, producttype\r\n, productcode\r\n, productname\r\n, currency\r\n, productcategory\r\n, businesscenter\r\n, dsarepname\r\n, repname\r\n, productsubcategory\r\n, accountbranch\r\n, transactiontype\r\n, assigntransfer\r\n, groupname\r\n, transferuserid\r\n, tier\r\n, isdeleted\r\n, is_ssa_acct\r\n, tempsalesid\r\n, applicationtype\r\n, userstrfield1\r\n, userstrfield2\r\n, userstrfield3\r\n, userstrfield4\r\n,  cast(userdatefield as timestamp(3)) as userdatefield\r\n, bank_id\r\n, stopprocescalation\r\n, rejectreason\r\n, lockrollback\r\n, lockrecompute\r\n, salesownergroup\r\n, ownergroup\r\n, oldsalesownerid\r\n, referencetype\r\n, noofrollback\r\n, firstrollbackat\r\n, accountnumber\r\n, leadvalue\r\n, valueunits\r\n, basevalue\r\n, probability\r\n, processstage\r\n, disposition\r\n, leadtype\r\n, opportunitiessource\r\n, description\r\n, leadmode\r\n, campaigntargetid\r\n, reasoncode\r\n, reasondetails\r\n, opportunityname\r\n, caseid\r\n, opportunitytype\r\n, processid\r\n, currentstep\r\n, orgid\r\n, suspectid\r\n, status\r\n, hasattachment\r\n, notes\r\n, additionalnotes\r\n, owneruserid\r\n, assigneduserid\r\n, createduserid\r\n, assignedgroupid\r\n, crmcallid\r\n, mergedwith\r\n, priority\r\n,  cast(startdate as timestamp(3)) as startdate\r\n,  cast(duedate as timestamp(3)) as duedate\r\n, competitors\r\n,  cast(enddate as timestamp(3)) as enddate\r\n,  cast(currstepduedate as timestamp(3)) as currstepduedate\r\n, region\r\n, ismerger\r\n, assignedbyuserid\r\n, transferredbyuserid\r\n, opportunityfor\r\n, autocreateapplform\r\n, opprstage\r\n, opprstatus\r\n, lastname\r\n, opprchannel\r\n, oppreditable\r\n, promotionoffer\r\n,  cast(promotionvalidity as timestamp(3)) as promotionvalidity\r\n, branchlocation\r\n, processeditable\r\n, oldapplicationid\r\n, channelrefid\r\n, salesownerid\r\n, contactid\r\n, purposeofcredit\r\n, isautomated\r\n, campaignid\r\n, timerstatus\r\n, secoppcaseid\r\n, issecondaryopp\r\n,  cast(assignedtime as timestamp(3)) as assignedtime\r\n, slalevel\r\n, ownedlocationid\r\n, assignedlocationid\r\n, isrouted\r\n,  cast(esc_due_time as timestamp(3)) as esc_due_time\r\n, esc_level\r\n, nocurstepassign\r\n, tatduration\r\n, stopescalation\r\n, entityemail\r\n, manualrouting\r\n, customersegment\r\n,  cast(routedtime as timestamp(3)) as routedtime\r\n,  cast(procescduetime as timestamp(3)) as procescduetime\r\n, firstgrownid\r\n, firstbcownid\r\n, firstuserownid\r\n, currnumposesc\r\n, currnumnegesc\r\n, numofposesc\r\n, numofnegesc\r\n, procesclevel\r\n, routeruleforgroup\r\n, routeruleforbc\r\n, routeruleforuser\r\n, escalationattr1\r\n, escalationattr2\r\n, escalationattr3\r\n, createdlocationid\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n, userfield5\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, parentintxnid\r\n,  cast(prevstependdate as timestamp(3)) as prevstependdate\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, accessowneragent\r\n, accessassigneeagent\r\n, opportunityvalue\r\n, leadsourceid\r\n, quotaid\r\n, cifid\r\n, firstname\r\n, offerid\r\n, optionid\r\n, loanamt\r\n, channelname\r\n, loantenordays\r\n, loantenormonths\r\n, assignedbcgid\r\n, ownerbcgid\r\n,  cast(applrecieveddate as timestamp(3)) as applrecieveddate\r\n, extoriginatorname\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'opportunities') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__opportunities.sql", "original_file_path": "models\\staging\\los\\stg_los__opportunities.sql", "name": "stg_los__opportunities", "alias": "stg_los__opportunities", "checksum": {"name": "sha256", "checksum": "b62930f9e34e420e2fa7c0ebcb687ae9f15be9b9c1a4be04d11b9c64fe9237d4"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "opportunities"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__opportunities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3380105, "compiled_code": "\nWITH source AS(\nSELECT  opportunityid\n, productclassification\n, authtype\n, producttype\n, productcode\n, productname\n, currency\n, productcategory\n, businesscenter\n, dsarepname\n, repname\n, productsubcategory\n, accountbranch\n, transactiontype\n, assigntransfer\n, groupname\n, transferuserid\n, tier\n, isdeleted\n, is_ssa_acct\n, tempsalesid\n, applicationtype\n, userstrfield1\n, userstrfield2\n, userstrfield3\n, userstrfield4\n,  cast(userdatefield as timestamp(3)) as userdatefield\n, bank_id\n, stopprocescalation\n, rejectreason\n, lockrollback\n, lockrecompute\n, salesownergroup\n, ownergroup\n, oldsalesownerid\n, referencetype\n, noofrollback\n, firstrollbackat\n, accountnumber\n, leadvalue\n, valueunits\n, basevalue\n, probability\n, processstage\n, disposition\n, leadtype\n, opportunitiessource\n, description\n, leadmode\n, campaigntargetid\n, reasoncode\n, reasondetails\n, opportunityname\n, caseid\n, opportunitytype\n, processid\n, currentstep\n, orgid\n, suspectid\n, status\n, hasattachment\n, notes\n, additionalnotes\n, owneruserid\n, assigneduserid\n, createduserid\n, assignedgroupid\n, crmcallid\n, mergedwith\n, priority\n,  cast(startdate as timestamp(3)) as startdate\n,  cast(duedate as timestamp(3)) as duedate\n, competitors\n,  cast(enddate as timestamp(3)) as enddate\n,  cast(currstepduedate as timestamp(3)) as currstepduedate\n, region\n, ismerger\n, assignedbyuserid\n, transferredbyuserid\n, opportunityfor\n, autocreateapplform\n, opprstage\n, opprstatus\n, lastname\n, opprchannel\n, oppreditable\n, promotionoffer\n,  cast(promotionvalidity as timestamp(3)) as promotionvalidity\n, branchlocation\n, processeditable\n, oldapplicationid\n, channelrefid\n, salesownerid\n, contactid\n, purposeofcredit\n, isautomated\n, campaignid\n, timerstatus\n, secoppcaseid\n, issecondaryopp\n,  cast(assignedtime as timestamp(3)) as assignedtime\n, slalevel\n, ownedlocationid\n, assignedlocationid\n, isrouted\n,  cast(esc_due_time as timestamp(3)) as esc_due_time\n, esc_level\n, nocurstepassign\n, tatduration\n, stopescalation\n, entityemail\n, manualrouting\n, customersegment\n,  cast(routedtime as timestamp(3)) as routedtime\n,  cast(procescduetime as timestamp(3)) as procescduetime\n, firstgrownid\n, firstbcownid\n, firstuserownid\n, currnumposesc\n, currnumnegesc\n, numofposesc\n, numofnegesc\n, procesclevel\n, routeruleforgroup\n, routeruleforbc\n, routeruleforuser\n, escalationattr1\n, escalationattr2\n, escalationattr3\n, createdlocationid\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n, userfield5\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, parentintxnid\n,  cast(prevstependdate as timestamp(3)) as prevstependdate\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, accessowneragent\n, accessassigneeagent\n, opportunityvalue\n, leadsourceid\n, quotaid\n, cifid\n, firstname\n, offerid\n, optionid\n, loanamt\n, channelname\n, loantenordays\n, loantenormonths\n, assignedbcgid\n, ownerbcgid\n,  cast(applrecieveddate as timestamp(3)) as applrecieveddate\n, extoriginatorname\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.opportunities\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__opportunities)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__opportunities"}, "model.dga_data_model.stg_los__oscorpcustomerdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.oscorpcustomerdetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__oscorpcustomerdetail"], "unique_id": "model.dga_data_model.stg_los__oscorpcustomerdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  oscorpcustomerdetailid\r\n, cifid\r\n, shortname\r\n, legalentitytype\r\n, corporatesegment\r\n, registrationnumber\r\n, corporatename\r\n, countryofincorporation\r\n, industrytype\r\n,  cast(dateofincorporation as timestamp(3)) as dateofincorporation\r\n, applicantid\r\n, preferredaddress\r\n, preferredphone\r\n, preferredemail\r\n, primarysolid\r\n, isblacklisted\r\n, isnegated\r\n, issuspended\r\n, isblacklistcheckdone\r\n, isnegativelistcheckdone\r\n, isdedupcheckdone\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, isautoapproved\r\n, decisionresult\r\n, decisionremark\r\n, kycscore\r\n,  cast(kycdate as timestamp(3)) as kycdate\r\n, ficallstatus\r\n, fisrvcalltype\r\n, remarks\r\n, creditscorecode\r\n, isforeignacctaxrepreqd\r\n, foreigntaxrepcntry\r\n, foreigntaxreptingstatus\r\n,  cast(foreigntaxrptingdate as timestamp(3)) as foreigntaxrptingdate\r\n, foreigntaxcomments\r\n, taxdetdsourccifid\r\n, taxdetdsourctable\r\n, taxid\r\n, freetext1\r\n, freetext2\r\n, freecode1\r\n, freecode2\r\n, publiclytraded\r\n, stocksymbol\r\n, ownedbyforeigner\r\n, ownedbywomen\r\n, ownedbyminority\r\n, publiclyheld\r\n, notforprofit\r\n, prirelmgrid\r\n, stockexname\r\n, healthcode\r\n, isapplicantdedupchkdone\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, struserfield1\r\n, struserfield2\r\n, struserfield3\r\n, struserfield4\r\n, struserfield5\r\n, struserfield6\r\n, struserfield7\r\n, struserfield8\r\n, struserfield9\r\n, struserfield10\r\n, struserfield11\r\n, struserfield12\r\n, struserfield13\r\n, struserfield14\r\n, struserfield15\r\n,  cast(dateuserfield1 as timestamp(3)) as dateuserfield1\r\n,  cast(dateuserfield2 as timestamp(3)) as dateuserfield2\r\n,  cast(dateuserfield3 as timestamp(3)) as dateuserfield3\r\n,  cast(dateuserfield4 as timestamp(3)) as dateuserfield4\r\n, integeruserfield1\r\n, integeruserfield2\r\n, integeruserfield3\r\n, integeruserfield4\r\n, doubleuserfield1\r\n, doubleuserfield2\r\n, doubleuserfield3\r\n, doubleuserfield4\r\n,  cast(relationshipstartdate as timestamp(3)) as relationshipstartdate\r\n, sector\r\n, subsector\r\n, region\r\n, riskrating\r\nFROM {{ source('crmuser', 'oscorpcustomerdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__oscorpcustomerdetail.sql", "original_file_path": "models\\staging\\los\\stg_los__oscorpcustomerdetail.sql", "name": "stg_los__oscorpcustomerdetail", "alias": "stg_los__oscorpcustomerdetail", "checksum": {"name": "sha256", "checksum": "537320e1491935ae2c122d16462262fc303d1922c8dab5f80e00a22ca1684171"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "oscorpcustomerdetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__oscorpcustomerdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3510108, "compiled_code": "\nWITH source AS(\nSELECT  oscorpcustomerdetailid\n, cifid\n, shortname\n, legalentitytype\n, corporatesegment\n, registrationnumber\n, corporatename\n, countryofincorporation\n, industrytype\n,  cast(dateofincorporation as timestamp(3)) as dateofincorporation\n, applicantid\n, preferredaddress\n, preferredphone\n, preferredemail\n, primarysolid\n, isblacklisted\n, isnegated\n, issuspended\n, isblacklistcheckdone\n, isnegativelistcheckdone\n, isdedupcheckdone\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, isautoapproved\n, decisionresult\n, decisionremark\n, kycscore\n,  cast(kycdate as timestamp(3)) as kycdate\n, ficallstatus\n, fisrvcalltype\n, remarks\n, creditscorecode\n, isforeignacctaxrepreqd\n, foreigntaxrepcntry\n, foreigntaxreptingstatus\n,  cast(foreigntaxrptingdate as timestamp(3)) as foreigntaxrptingdate\n, foreigntaxcomments\n, taxdetdsourccifid\n, taxdetdsourctable\n, taxid\n, freetext1\n, freetext2\n, freecode1\n, freecode2\n, publiclytraded\n, stocksymbol\n, ownedbyforeigner\n, ownedbywomen\n, ownedbyminority\n, publiclyheld\n, notforprofit\n, prirelmgrid\n, stockexname\n, healthcode\n, isapplicantdedupchkdone\n,  cast(tmdate as timestamp(3)) as tmdate\n, struserfield1\n, struserfield2\n, struserfield3\n, struserfield4\n, struserfield5\n, struserfield6\n, struserfield7\n, struserfield8\n, struserfield9\n, struserfield10\n, struserfield11\n, struserfield12\n, struserfield13\n, struserfield14\n, struserfield15\n,  cast(dateuserfield1 as timestamp(3)) as dateuserfield1\n,  cast(dateuserfield2 as timestamp(3)) as dateuserfield2\n,  cast(dateuserfield3 as timestamp(3)) as dateuserfield3\n,  cast(dateuserfield4 as timestamp(3)) as dateuserfield4\n, integeruserfield1\n, integeruserfield2\n, integeruserfield3\n, integeruserfield4\n, doubleuserfield1\n, doubleuserfield2\n, doubleuserfield3\n, doubleuserfield4\n,  cast(relationshipstartdate as timestamp(3)) as relationshipstartdate\n, sector\n, subsector\n, region\n, riskrating\nFROM oracle_los.crmuser.oscorpcustomerdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__oscorpcustomerdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__oscorpcustomerdetail"}, "model.dga_data_model.stg_los__oscorpdocumentdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.oscorpdocumentdetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__oscorpdocumentdetail"], "unique_id": "model.dga_data_model.stg_los__oscorpdocumentdetail", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  oscorpdocumentdetailid\r\n, idendoctype\r\n, documentuniqueid\r\n, documentcode\r\n, placeofissue\r\n, cityofissue\r\n, stateofissue\r\n, countryofissue\r\n,  cast(docissuedt as timestamp(3)) as docissuedt\r\n,  cast(docexpdt as timestamp(3)) as docexpdt\r\n, idissuedby\r\n, oscorpcustomerdetailid\r\n, docrmks\r\n, prefuniqueidind\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, fdmadocumentid\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'oscorpdocumentdetail') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__oscorpdocumentdetail.sql", "original_file_path": "models\\staging\\los\\stg_los__oscorpdocumentdetail.sql", "name": "stg_los__oscorpdocumentdetail", "alias": "stg_los__oscorpdocumentdetail", "checksum": {"name": "sha256", "checksum": "48e01e88aef578a3a5e8e4c339ceb858c7da8e9a859cd6582259d55c432670ab"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "oscorpdocumentdetail"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__oscorpdocumentdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3500109, "compiled_code": "\nWITH source AS(\nSELECT  oscorpdocumentdetailid\n, idendoctype\n, documentuniqueid\n, documentcode\n, placeofissue\n, cityofissue\n, stateofissue\n, countryofissue\n,  cast(docissuedt as timestamp(3)) as docissuedt\n,  cast(docexpdt as timestamp(3)) as docexpdt\n, idissuedby\n, oscorpcustomerdetailid\n, docrmks\n, prefuniqueidind\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, fdmadocumentid\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.oscorpdocumentdetail\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__oscorpdocumentdetail)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__oscorpdocumentdetail"}, "model.dga_data_model.stg_los__oslineproductdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.oslineproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__oslineproductdetails"], "unique_id": "model.dga_data_model.stg_los__oslineproductdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  oslineproductdetailsid\r\n, excldcreditreport\r\n, sequenceno\r\n, eligibleforratelock\r\n, applicationdetailsid\r\n, limitsought\r\n, drawperioddays\r\n, drawperiodmonths\r\n, repayperioddays\r\n, repayperiodmonths\r\n,  cast(reviewdate as timestamp(3)) as reviewdate\r\n, producttype\r\n, repricingplan\r\n, ratelockrequired\r\n, escrowaccountreq\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, custombaseintrate\r\n, customminint\r\n, customseqnumber\r\n, customspread\r\n,  cast(customstartdate as timestamp(3)) as customstartdate\r\n, customtenordays\r\n, customtenormonths\r\n, customtotalvariance\r\n, customvariance\r\n, customcurrentaccountid\r\n, customeffectiverate\r\n,  cast(customenddate as timestamp(3)) as customenddate\r\n, customfinalintrate\r\n, customintmodrequired\r\n, custominttabcode\r\n, custommaxint\r\n, customstrfield1\r\n, customstrfield2\r\n, customstrfield3\r\n, customint1\r\n, customint2\r\n,  cast(customdate1 as timestamp(3)) as customdate1\r\n, customeffectiverate1\r\nFROM {{ source('crmuser', 'oslineproductdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__oslineproductdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__oslineproductdetails.sql", "name": "stg_los__oslineproductdetails", "alias": "stg_los__oslineproductdetails", "checksum": {"name": "sha256", "checksum": "984397da82380c0ba233168d2171c8a5cc63d98f918ab398498326f392b1ac0d"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "oslineproductdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__oslineproductdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.305012, "compiled_code": "\nWITH source AS(\nSELECT  oslineproductdetailsid\n, excldcreditreport\n, sequenceno\n, eligibleforratelock\n, applicationdetailsid\n, limitsought\n, drawperioddays\n, drawperiodmonths\n, repayperioddays\n, repayperiodmonths\n,  cast(reviewdate as timestamp(3)) as reviewdate\n, producttype\n, repricingplan\n, ratelockrequired\n, escrowaccountreq\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\n, custombaseintrate\n, customminint\n, customseqnumber\n, customspread\n,  cast(customstartdate as timestamp(3)) as customstartdate\n, customtenordays\n, customtenormonths\n, customtotalvariance\n, customvariance\n, customcurrentaccountid\n, customeffectiverate\n,  cast(customenddate as timestamp(3)) as customenddate\n, customfinalintrate\n, customintmodrequired\n, custominttabcode\n, custommaxint\n, customstrfield1\n, customstrfield2\n, customstrfield3\n, customint1\n, customint2\n,  cast(customdate1 as timestamp(3)) as customdate1\n, customeffectiverate1\nFROM oracle_los.crmuser.oslineproductdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__oslineproductdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__oslineproductdetails"}, "model.dga_data_model.stg_los__osproduct": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.osproduct"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__osproduct"], "unique_id": "model.dga_data_model.stg_los__osproduct", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  osproductid\r\n, exposurecat\r\n, shadowproductid\r\n, productcategory\r\n, productsubcategory\r\n, productname\r\n, productcode\r\n, productprocessor\r\n,  cast(productvalidfrom as timestamp(3)) as productvalidfrom\r\n, intcompoundingfreqdr\r\n, intcalcfreqtypedr\r\n, intcalcfreqweekdaydr\r\n, intcalcfreqweeknumdr\r\n, intcalcfreqholidaydr\r\n, intcalcfreqstartdatedr\r\n, intcalcfreqcalendardr\r\n, collinterestflg\r\n,  cast(productvalidtill as timestamp(3)) as productvalidtill\r\n, producttype\r\n, productmanagername\r\n, applformtemplate\r\n, acctemplate\r\n, businessgroup\r\n, region\r\n, permittedsectorcode\r\n, jointholderdsr\r\n, programid\r\n, feepackageid\r\n, validationpackageid\r\n, coolingoffperiod\r\n, coolingoffperioddesc\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, attachmentname\r\n, producthandlingskill\r\n, iasclassification\r\n, availablechannels\r\n, lifecyclestatus\r\n, activate\r\n, statusdescription\r\n, remarks\r\n, authorisedby\r\n, authorisationstatus\r\n, authorisationremarks\r\n, isdeleted\r\n, policypackageid\r\n, repaymentcycle_ftr\r\n, repricing_ftr\r\n, regulatory_ftr\r\n, miscellaneous_ftr\r\n, mandatorydetails_ftr\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, productsecsubcategory\r\n, createdby\r\n, productclassification\r\n, eligibilitypackageid\r\n, creditauthorizationmatrixid\r\n, subsidydetails_ftr\r\n, systemdefinedacnum\r\n, payinterest\r\n, nonresident\r\n, channelflg\r\n, glsubheadcode\r\n, productgroup\r\n, freecode1\r\n, freecode2\r\n, freecode3\r\n, freetext1\r\n, freetext2\r\n, freetext3\r\n, transactionrestriction\r\n, minageyy\r\n, minagemm\r\n, maxageyy\r\n, maxagemm\r\n, intcompoundingfreqcr\r\n, intcalcfreqtypecr\r\n, intcalcfreqweekdaycr\r\n, intcalcfreqweeknumcr\r\n, intcalcfreqholidaycr\r\n, intcalcfreqstartdatecr\r\n, intcalcfreqcalendarcr\r\n, fcnrflg\r\n, staffschemeflg\r\n, eefcflg\r\n, chequebookallowed\r\n, interest\r\n, apy\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'osproduct') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__osproduct.sql", "original_file_path": "models\\staging\\los\\stg_los__osproduct.sql", "name": "stg_los__osproduct", "alias": "stg_los__osproduct", "checksum": {"name": "sha256", "checksum": "ba786dd15f85ed3892952dc7d1dd63444b06911e250214da2da6389db7511095"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "osproduct"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__osproduct.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3410106, "compiled_code": "\nWITH source AS(\nSELECT  osproductid\n, exposurecat\n, shadowproductid\n, productcategory\n, productsubcategory\n, productname\n, productcode\n, productprocessor\n,  cast(productvalidfrom as timestamp(3)) as productvalidfrom\n, intcompoundingfreqdr\n, intcalcfreqtypedr\n, intcalcfreqweekdaydr\n, intcalcfreqweeknumdr\n, intcalcfreqholidaydr\n, intcalcfreqstartdatedr\n, intcalcfreqcalendardr\n, collinterestflg\n,  cast(productvalidtill as timestamp(3)) as productvalidtill\n, producttype\n, productmanagername\n, applformtemplate\n, acctemplate\n, businessgroup\n, region\n, permittedsectorcode\n, jointholderdsr\n, programid\n, feepackageid\n, validationpackageid\n, coolingoffperiod\n, coolingoffperioddesc\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, attachmentname\n, producthandlingskill\n, iasclassification\n, availablechannels\n, lifecyclestatus\n, activate\n, statusdescription\n, remarks\n, authorisedby\n, authorisationstatus\n, authorisationremarks\n, isdeleted\n, policypackageid\n, repaymentcycle_ftr\n, repricing_ftr\n, regulatory_ftr\n, miscellaneous_ftr\n, mandatorydetails_ftr\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, productsecsubcategory\n, createdby\n, productclassification\n, eligibilitypackageid\n, creditauthorizationmatrixid\n, subsidydetails_ftr\n, systemdefinedacnum\n, payinterest\n, nonresident\n, channelflg\n, glsubheadcode\n, productgroup\n, freecode1\n, freecode2\n, freecode3\n, freetext1\n, freetext2\n, freetext3\n, transactionrestriction\n, minageyy\n, minagemm\n, maxageyy\n, maxagemm\n, intcompoundingfreqcr\n, intcalcfreqtypecr\n, intcalcfreqweekdaycr\n, intcalcfreqweeknumcr\n, intcalcfreqholidaycr\n, intcalcfreqstartdatecr\n, intcalcfreqcalendarcr\n, fcnrflg\n, staffschemeflg\n, eefcflg\n, chequebookallowed\n, interest\n, apy\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.osproduct\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__osproduct)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__osproduct"}, "model.dga_data_model.stg_los__parentapplication": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.parentapplication"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__parentapplication"], "unique_id": "model.dga_data_model.stg_los__parentapplication", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  parentapplicationid\r\n, iscorporateapplication\r\n, disclosureaccepted\r\n, customerdetailid\r\n, applicantid\r\n, issubmitted\r\n, applicationstatus\r\n, applicationreferencenumber\r\n, requestmode\r\n, decisionremark\r\n, decisionresult\r\n, reasondetails\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, ipaddress\r\n,  cast(datetime as timestamp(3)) as datetime\r\n, disclosurecontextid\r\n, disclosureid\r\n, disclosureversion\r\n, disclosureconsent\r\n,  cast(disclosuredatetime as timestamp(3)) as disclosuredatetime\r\n, customercifid\r\n, isapplsubmitted\r\n, parentapplrefnumber\r\n, isforked\r\n, channel\r\n, opportunitiesid\r\n, isdeleted\r\n, applicationstep\r\n, aplicationstage\r\n, interimstatus\r\n, extoriginatorname\r\n, disposition\r\n, overallapplicationdecision\r\n, overalldecisionreason\r\n, overallremarks\r\n, indivapplicantdecisioncd\r\n, indivdecisionremarkscd\r\n, indivapplicantdecisionnl\r\n, indivapplicantdecisionbl\r\n, indivapplicantdecisionad\r\n, indivdecisionremarksbl\r\n, indivdecisionremarksnl\r\n, indivdecisionremarksad\r\n,  cast(stepduedate as timestamp(3)) as stepduedate\r\n,  cast(appduedate as timestamp(3)) as appduedate\r\n, rlosfolderflag\r\n, indivapplicantdecision\r\n, indivdecisionremarks\r\n, licenseincremented\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'parentapplication') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__parentapplication.sql", "original_file_path": "models\\staging\\los\\stg_los__parentapplication.sql", "name": "stg_los__parentapplication", "alias": "stg_los__parentapplication", "checksum": {"name": "sha256", "checksum": "d5d98189b83494de95e71a90cb652f1e2e8e10914cc541f2c59684456ca164ac"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "parentapplication"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__parentapplication.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.328011, "compiled_code": "\nWITH source AS(\nSELECT  parentapplicationid\n, iscorporateapplication\n, disclosureaccepted\n, customerdetailid\n, applicantid\n, issubmitted\n, applicationstatus\n, applicationreferencenumber\n, requestmode\n, decisionremark\n, decisionresult\n, reasondetails\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, ipaddress\n,  cast(datetime as timestamp(3)) as datetime\n, disclosurecontextid\n, disclosureid\n, disclosureversion\n, disclosureconsent\n,  cast(disclosuredatetime as timestamp(3)) as disclosuredatetime\n, customercifid\n, isapplsubmitted\n, parentapplrefnumber\n, isforked\n, channel\n, opportunitiesid\n, isdeleted\n, applicationstep\n, aplicationstage\n, interimstatus\n, extoriginatorname\n, disposition\n, overallapplicationdecision\n, overalldecisionreason\n, overallremarks\n, indivapplicantdecisioncd\n, indivdecisionremarkscd\n, indivapplicantdecisionnl\n, indivapplicantdecisionbl\n, indivapplicantdecisionad\n, indivdecisionremarksbl\n, indivdecisionremarksnl\n, indivdecisionremarksad\n,  cast(stepduedate as timestamp(3)) as stepduedate\n,  cast(appduedate as timestamp(3)) as appduedate\n, rlosfolderflag\n, indivapplicantdecision\n, indivdecisionremarks\n, licenseincremented\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.parentapplication\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__parentapplication)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__parentapplication"}, "model.dga_data_model.stg_los__person": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.person"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__person"], "unique_id": "model.dga_data_model.stg_los__person", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  personid\r\n, middlename_alt1\r\n, lastname_alt1\r\n, firstname_alt1\r\n, orgid\r\n, persontype\r\n, lastname\r\n, firstname\r\n, gender\r\n, notes\r\n, birth_day\r\n, birth_month\r\n, birth_year\r\n, phone_home1\r\n, phone_home2\r\n, phone_work\r\n, extn\r\n, phone_cell\r\n, fax_home\r\n, fax_work\r\n, email_home\r\n, email_work\r\n, email_palm\r\n, preferredchannelid\r\n, middlename\r\n, salutation\r\n,  cast(dob as timestamp(3)) as dob\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'person') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__person.sql", "original_file_path": "models\\staging\\los\\stg_los__person.sql", "name": "stg_los__person", "alias": "stg_los__person", "checksum": {"name": "sha256", "checksum": "d6af096823321eb067f1d9f6682aea6193886b69bf2be0248091cb41b38dc2ef"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "person"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__person.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3220103, "compiled_code": "\nWITH source AS(\nSELECT  personid\n, middlename_alt1\n, lastname_alt1\n, firstname_alt1\n, orgid\n, persontype\n, lastname\n, firstname\n, gender\n, notes\n, birth_day\n, birth_month\n, birth_year\n, phone_home1\n, phone_home2\n, phone_work\n, extn\n, phone_cell\n, fax_home\n, fax_work\n, email_home\n, email_work\n, email_palm\n, preferredchannelid\n, middlename\n, salutation\n,  cast(dob as timestamp(3)) as dob\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.person\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__person)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__person"}, "model.dga_data_model.stg_los__rlosroutingdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.rlosroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__rlosroutingdetails"], "unique_id": "model.dga_data_model.stg_los__rlosroutingdetails", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  rlosroutingdetailsid\r\n, bank_id\r\n, opportunitiesid\r\n, assignedby\r\n, assignedto\r\n, applcomments\r\n, routetostep\r\n, routingreasoncode\r\n, routingcomments\r\n, userfield1\r\n, userfield2\r\n, userflag1\r\n, userflag2\r\n,  cast(routingdate as timestamp(3)) as routingdate\r\n, ishistory\r\n, routefromstep\r\n, routeto\r\n, routetype\r\n, transferredby\r\n, transferredto\r\n, transferredfrom\r\n, assignedfrom\r\n, assigneetype\r\n, assignertype\r\n, transfereetype\r\n, transferortype\r\n, opportunityproductsid\r\n, routefromstagestep\r\n, routetostagestep\r\n, decision\r\n, reason\r\n, remarks\r\n, boaclid\r\n, bocreatedby\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, securityglhint\r\n, securityguhint\r\n, securityilhint\r\n, securityiuhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'rlosroutingdetails') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__rlosroutingdetails.sql", "original_file_path": "models\\staging\\los\\stg_los__rlosroutingdetails.sql", "name": "stg_los__rlosroutingdetails", "alias": "stg_los__rlosroutingdetails", "checksum": {"name": "sha256", "checksum": "5464b308fdda6e61ea548419206eda30155faf5b93313a6af30671aa689c547b"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "rlosroutingdetails"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__rlosroutingdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3250108, "compiled_code": "\nWITH source AS(\nSELECT  rlosroutingdetailsid\n, bank_id\n, opportunitiesid\n, assignedby\n, assignedto\n, applcomments\n, routetostep\n, routingreasoncode\n, routingcomments\n, userfield1\n, userfield2\n, userflag1\n, userflag2\n,  cast(routingdate as timestamp(3)) as routingdate\n, ishistory\n, routefromstep\n, routeto\n, routetype\n, transferredby\n, transferredto\n, transferredfrom\n, assignedfrom\n, assigneetype\n, assignertype\n, transfereetype\n, transferortype\n, opportunityproductsid\n, routefromstagestep\n, routetostagestep\n, decision\n, reason\n, remarks\n, boaclid\n, bocreatedby\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, securityglhint\n, securityguhint\n, securityilhint\n, securityiuhint\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.rlosroutingdetails\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__rlosroutingdetails)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__rlosroutingdetails"}, "model.dga_data_model.stg_los__rlosworknotes": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.rlosworknotes"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__rlosworknotes"], "unique_id": "model.dga_data_model.stg_los__rlosworknotes", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  rlosworknotesid\r\n, parentapplicationid\r\n, notecode\r\n, notedescription\r\n, userid\r\n, step\r\n, stage\r\n,  cast(creationdatetime as timestamp(3)) as creationdatetime\r\n, deletedflag\r\n, associationtype\r\n, associationid\r\n, remarks\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'rlosworknotes') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__rlosworknotes.sql", "original_file_path": "models\\staging\\los\\stg_los__rlosworknotes.sql", "name": "stg_los__rlosworknotes", "alias": "stg_los__rlosworknotes", "checksum": {"name": "sha256", "checksum": "b89b6412bc8904f5af4b0f65e1e7b350acbda929482a6ea27cf21f7d1d63108d"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "rlosworknotes"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__rlosworknotes.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3180106, "compiled_code": "\nWITH source AS(\nSELECT  rlosworknotesid\n, parentapplicationid\n, notecode\n, notedescription\n, userid\n, step\n, stage\n,  cast(creationdatetime as timestamp(3)) as creationdatetime\n, deletedflag\n, associationtype\n, associationid\n, remarks\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.rlosworknotes\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__rlosworknotes)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__rlosworknotes"}, "model.dga_data_model.stg_los__rollback": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.rollback"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__rollback"], "unique_id": "model.dga_data_model.stg_los__rollback", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  rollbackid\r\n, applicationdetailsid\r\n, reasoncode\r\n, reasondesc\r\n, rbfromstage\r\n, rbtostage\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, remarks\r\n, isdeleted\r\n, userid\r\n, rbstep\r\n, parentapplicationid\r\n, rbfromstep\r\n, rbtostep\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'rollback') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__rollback.sql", "original_file_path": "models\\staging\\los\\stg_los__rollback.sql", "name": "stg_los__rollback", "alias": "stg_los__rollback", "checksum": {"name": "sha256", "checksum": "8e172c9c26fcd838f48afaa122e17b2f79fb1798de1edcbb00efea62d98ef0a8"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "rollback"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__rollback.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.2990127, "compiled_code": "\nWITH source AS(\nSELECT  rollbackid\n, applicationdetailsid\n, reasoncode\n, reasondesc\n, rbfromstage\n, rbtostage\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, remarks\n, isdeleted\n, userid\n, rbstep\n, parentapplicationid\n, rbfromstep\n, rbtostep\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.rollback\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__rollback)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__rollback"}, "model.dga_data_model.stg_los__srmgroups": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.srmgroups"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__srmgroups"], "unique_id": "model.dga_data_model.stg_los__srmgroups", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  groupid\r\n, bank_id\r\n, groupname_alt1\r\n, acrossentity\r\n, groupname\r\n, notes\r\n, division\r\n, product\r\n, organization\r\n, grouptype\r\n, foreignexchange\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, extensionid\r\n, coordinatorid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, gcifflag\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'srmgroups') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__srmgroups.sql", "original_file_path": "models\\staging\\los\\stg_los__srmgroups.sql", "name": "stg_los__srmgroups", "alias": "stg_los__srmgroups", "checksum": {"name": "sha256", "checksum": "2e7b66f01d84876286bbcb8620a00f71edee99874ea2f5831b9be13c95d6e2a9"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "srmgroups"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__srmgroups.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.362011, "compiled_code": "\nWITH source AS(\nSELECT  groupid\n, bank_id\n, groupname_alt1\n, acrossentity\n, groupname\n, notes\n, division\n, product\n, organization\n, grouptype\n, foreignexchange\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, extensionid\n, coordinatorid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, gcifflag\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.srmgroups\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__srmgroups)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__srmgroups"}, "model.dga_data_model.stg_los__transactiondepartment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.transactiondepartment"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__transactiondepartment"], "unique_id": "model.dga_data_model.stg_los__transactiondepartment", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  transactiondepartmentid\r\n, bccode\r\n, name\r\n, standartname\r\n, areasid\r\n, isdeleted\r\n, createdby\r\n, modifiedby\r\n, freetext1\r\n, freetext2\r\n,  cast(datemodified as timestamp(3)) as datemodified\r\n,  cast(datecreated as timestamp(3)) as datecreated\r\nFROM {{ source('crmuser', 'transactiondepartment') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where datemodified > (select max(datemodified) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__transactiondepartment.sql", "original_file_path": "models\\staging\\los\\stg_los__transactiondepartment.sql", "name": "stg_los__transactiondepartment", "alias": "stg_los__transactiondepartment", "checksum": {"name": "sha256", "checksum": "409cad3064edbfb1e128fddcdd15ed09fc986124973532d9214a895380cfbbb6"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "transactiondepartment"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__transactiondepartment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.326011, "compiled_code": "\nWITH source AS(\nSELECT  transactiondepartmentid\n, bccode\n, name\n, standartname\n, areasid\n, isdeleted\n, createdby\n, modifiedby\n, freetext1\n, freetext2\n,  cast(datemodified as timestamp(3)) as datemodified\n,  cast(datecreated as timestamp(3)) as datecreated\nFROM oracle_los.crmuser.transactiondepartment\n)\nSELECT * FROM source\n\n  where datemodified > (select max(datemodified) from \"oracle_dgaworkzone\".staging.stg_los__transactiondepartment)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__transactiondepartment"}, "model.dga_data_model.stg_los__useractiontray": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.useractiontray"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__useractiontray"], "unique_id": "model.dga_data_model.stg_los__useractiontray", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  useractiontrayid\r\n, loginid\r\n, useractiontraytype\r\n, useractiontraytypeid\r\n, assigneeid\r\n, ownerid\r\n, assigneegroupid\r\n, ownergroupid\r\n, userfield1\r\n, userfield2\r\n, userflag1\r\n, userflag2\r\n, applicationstage\r\n, routetype\r\n, routeto\r\n, processnamespace\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, processid\r\n, processname\r\n, stepid\r\n, activityid\r\n,  cast(appduedate as timestamp(3)) as appduedate\r\n,  cast(stepduedate as timestamp(3)) as stepduedate\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'useractiontray') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__useractiontray.sql", "original_file_path": "models\\staging\\los\\stg_los__useractiontray.sql", "name": "stg_los__useractiontray", "alias": "stg_los__useractiontray", "checksum": {"name": "sha256", "checksum": "829cdc987a389dac649ec5f3bc7859aec78509f70ce7c01f92f572afe558a3a9"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "useractiontray"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__useractiontray.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3110106, "compiled_code": "\nWITH source AS(\nSELECT  useractiontrayid\n, loginid\n, useractiontraytype\n, useractiontraytypeid\n, assigneeid\n, ownerid\n, assigneegroupid\n, ownergroupid\n, userfield1\n, userfield2\n, userflag1\n, userflag2\n, applicationstage\n, routetype\n, routeto\n, processnamespace\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, processid\n, processname\n, stepid\n, activityid\n,  cast(appduedate as timestamp(3)) as appduedate\n,  cast(stepduedate as timestamp(3)) as stepduedate\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.useractiontray\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__useractiontray)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__useractiontray"}, "model.dga_data_model.stg_los__users": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.users"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__users"], "unique_id": "model.dga_data_model.stg_los__users", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  personid\r\n, usertype\r\n, loginid\r\n, password\r\n, screenid\r\n, active\r\n, isinternaluser\r\n, available\r\n, locale\r\n, timezone\r\n, cifidaccess\r\n, custrelation\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'users') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__users.sql", "original_file_path": "models\\staging\\los\\stg_los__users.sql", "name": "stg_los__users", "alias": "stg_los__users", "checksum": {"name": "sha256", "checksum": "e5b63d65ae6fa9475057cbd6eb1f471933e77cdf7eee6002ec2e8a5bb6fa5faf"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "users"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__users.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3530107, "compiled_code": "\nWITH source AS(\nSELECT  personid\n, usertype\n, loginid\n, password\n, screenid\n, active\n, isinternaluser\n, available\n, locale\n, timezone\n, cifidaccess\n, custrelation\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.users\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__users)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__users"}, "model.dga_data_model.stg_los__user_groups": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.user_groups"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "stg_los__user_groups"], "unique_id": "model.dga_data_model.stg_los__user_groups", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  groupaccessid\r\n, bank_id\r\n, roleid\r\n, extensionid\r\n, groupid\r\n, personid\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('crmuser', 'user_groups') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\stg_los__user_groups.sql", "original_file_path": "models\\staging\\los\\stg_los__user_groups.sql", "name": "stg_los__user_groups", "alias": "stg_los__user_groups", "checksum": {"name": "sha256", "checksum": "d69d80681cd1ad65a16af6047eab060e379aa097fc2d8d99da2f622ed03493b2"}, "tags": ["los"], "refs": [], "sources": [["crmuser", "user_groups"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\los\\los.yaml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\stg_los__user_groups.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "thaidv3"}, "tags": ["los"], "materialized": "incremental"}, "created_at": 1685959753.3010108, "compiled_code": "\nWITH source AS(\nSELECT  groupaccessid\n, bank_id\n, roleid\n, extensionid\n, groupid\n, personid\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_los.crmuser.user_groups\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.stg_los__user_groups)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__user_groups"}, "model.dga_data_model.stg_los__transactiondepartmentinfo": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_rb_los__transactiondepartment", "model.dga_data_model.stg_rb_los__areas"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_los__transactiondepartmentinfo"], "unique_id": "model.dga_data_model.stg_los__transactiondepartmentinfo", "raw_code": "{{ config( materialized='table') }}\r\nSELECT\r\n    tr.*,\r\n    ar.name AS area_name\r\nFROM\r\n  {{ ref('stg_rb_los__transactiondepartment')}} tr\r\nINNER JOIN {{ ref('stg_rb_los__areas')}} ar ON tr.areasid = ar.areasid", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_los__transactiondepartmentinfo.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_los__transactiondepartmentinfo.sql", "name": "stg_los__transactiondepartmentinfo", "alias": "stg_los__transactiondepartmentinfo", "checksum": {"name": "sha256", "checksum": "7b05902142149898b5a939b4dee306587eea622235dcb9a3fb2093a298180103"}, "tags": ["los", "los_tf"], "refs": [["stg_rb_los__transactiondepartment"], ["stg_rb_los__areas"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_los__transactiondepartmentinfo.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959751.825121, "compiled_code": "\nSELECT\n    tr.*,\n    ar.name AS area_name\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__transactiondepartment tr\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__areas ar ON tr.areasid = ar.areasid", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_los__transactiondepartmentinfo"}, "model.dga_data_model.stg_rb_los__addoncarddetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__addoncarddetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__addoncarddetails"], "unique_id": "model.dga_data_model.stg_rb_los__addoncarddetails", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        addoncarddetailsid\r\n      ,  creditcardproductid\r\n      ,  existingcif\r\n      ,  embossednameaddoncard\r\n      ,  relationship\r\n      ,  cifid\r\n      ,  isdeleted\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  tmdate\r\n      ,  customcardholderphone\r\n      ,  customcardtype\r\n      ,  customway4code\r\n      ,  customaddinfo1\r\n      ,  customaddinfo2\r\n      ,  customaddinfo3\r\n      ,  customlimitofcard\r\n\r\n    FROM\r\n      {{ ref('los__addoncarddetails') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__addoncarddetails.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__addoncarddetails.sql", "name": "stg_rb_los__addoncarddetails", "alias": "stg_rb_los__addoncarddetails", "checksum": {"name": "sha256", "checksum": "ebdbde2d6f02bf76edfa2c5fbbb0fa8b1ce09bd0cee062d41eda0f7c603b6728"}, "tags": ["los", "los_tf"], "refs": [["los__addoncarddetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__addoncarddetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8281257, "compiled_code": "\n    SELECT\n        addoncarddetailsid\n      ,  creditcardproductid\n      ,  existingcif\n      ,  embossednameaddoncard\n      ,  relationship\n      ,  cifid\n      ,  isdeleted\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  tmdate\n      ,  customcardholderphone\n      ,  customcardtype\n      ,  customway4code\n      ,  customaddinfo1\n      ,  customaddinfo2\n      ,  customaddinfo3\n      ,  customlimitofcard\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__addoncarddetails", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__addoncarddetails"}, "model.dga_data_model.stg_rb_los__address": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__address"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__address"], "unique_id": "model.dga_data_model.stg_rb_los__address", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        addressid\r\n      ,  bank_id\r\n      ,  lastverifieddate\r\n      ,  addresskey\r\n      ,  seasonal_flag\r\n      ,  subzip\r\n      ,  isaddressverified\r\n      ,  swift_name\r\n      ,  name_alt1\r\n      ,  corp_rep_id\r\n      ,  corp_id\r\n      ,  swift_code\r\n      ,  templateid\r\n      ,  personid\r\n      ,  orgid\r\n      ,  accountid\r\n      ,  contactid\r\n      ,  suspectid\r\n      ,  partnerid\r\n      ,  addresscategory\r\n      ,  address_line1\r\n      ,  address_line2\r\n      ,  address_line3\r\n      ,  city\r\n      ,  state\r\n      ,  zip\r\n      ,  mailstop\r\n      ,  country\r\n      ,  start_date\r\n      ,  end_date\r\n      ,  residentialstatus\r\n      ,  userfield1\r\n      ,  userfield2\r\n      ,  userfield3\r\n      ,  userfield4\r\n      ,  userfield5\r\n      ,  userdatefield1\r\n      ,  userdatefield2\r\n      ,  userfield6\r\n      ,  userfield7\r\n      ,  extensionid\r\n      ,  name\r\n      ,  salutation_code\r\n      ,  address_proof_doc_id\r\n      ,  phoneno1\r\n      ,  phoneno1localcode\r\n      ,  phoneno1citycode\r\n      ,  phoneno1countrycode\r\n      ,  phoneno2\r\n      ,  phoneno2localcode\r\n      ,  phoneno2citycode\r\n      ,  phoneno2countrycode\r\n      ,  workextension\r\n      ,  cellno\r\n      ,  cellnolocalcode\r\n      ,  cellnocitycode\r\n      ,  cellnocountrycode\r\n      ,  faxno\r\n      ,  faxnolocalcode\r\n      ,  faxnocitycode\r\n      ,  faxnocountrycode\r\n      ,  faxno2\r\n      ,  faxnolocalcode2\r\n      ,  faxnocitycode2\r\n      ,  faxnocountrycode2\r\n      ,  email\r\n      ,  pagerno\r\n      ,  pagernolocalcode\r\n      ,  pagernocitycode\r\n      ,  pagernocountrycode\r\n      ,  emailpalm\r\n      ,  url\r\n      ,  house_no\r\n      ,  premise_name\r\n      ,  building_level\r\n      ,  street_no\r\n      ,  street_name\r\n      ,  suburb\r\n      ,  locality_name\r\n      ,  town\r\n      ,  domicile\r\n      ,  telex\r\n      ,  telexlocalcode\r\n      ,  telexcitycode\r\n      ,  telexcountrycode\r\n      ,  mluserfield1\r\n      ,  mluserfield2\r\n      ,  mluserfield3\r\n      ,  mluserfield4\r\n      ,  mluserfield5\r\n      ,  mluserfield6\r\n      ,  mluserfield7\r\n      ,  mluserfield8\r\n      ,  mluserfield9\r\n      ,  mluserfield10\r\n      ,  mluserfield11\r\n      ,  mluserfield12\r\n      ,  mluserfield13\r\n      ,  mluserfield14\r\n      ,  mluserfield15\r\n      ,  mluserfield16\r\n      ,  mluserfield17\r\n      ,  mluserfield18\r\n      ,  mluserfield19\r\n      ,  mluserfield20\r\n      ,  mluserfield21\r\n      ,  mluserfield22\r\n      ,  mluserfield23\r\n      ,  mluserfield24\r\n      ,  mluserfield25\r\n      ,  mluserfield26\r\n      ,  mluserfield27\r\n      ,  mluserfield28\r\n      ,  mluserfield29\r\n      ,  mluserfield30\r\n      ,  city_code\r\n      ,  state_code\r\n      ,  country_code\r\n      ,  core_cust_id\r\n      ,  concurdetect_x\r\n      ,  preferredaddress\r\n      ,  holdmailinitiatedby\r\n      ,  holdmailflag\r\n      ,  businesscenter\r\n      ,  holdmailreason\r\n      ,  preferredformat\r\n      ,  freetextaddress\r\n      ,  freetextlabel\r\n      ,  noncustomerid\r\n      ,  is_address_proof_rcvd\r\n      ,  lastupdate_date\r\n      ,  orgkey\r\n      ,  salutation\r\n      ,  holdmailstartdate\r\n      ,  holdmailenddate\r\n      ,  addressvalidity\r\n      ,  multi_addr_same_day\r\n      ,  core_start_date\r\n      ,  core_end_date\r\n      ,  exp_def_addr_type\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__address') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__address.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__address.sql", "name": "stg_rb_los__address", "alias": "stg_rb_los__address", "checksum": {"name": "sha256", "checksum": "354838e09d71401b036a81b9e2dddc2242c31004d9a40acadef1a0443dfb8142"}, "tags": ["los", "los_tf"], "refs": [["los__address"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__address.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8297822, "compiled_code": "\n    SELECT\n        addressid\n      ,  bank_id\n      ,  lastverifieddate\n      ,  addresskey\n      ,  seasonal_flag\n      ,  subzip\n      ,  isaddressverified\n      ,  swift_name\n      ,  name_alt1\n      ,  corp_rep_id\n      ,  corp_id\n      ,  swift_code\n      ,  templateid\n      ,  personid\n      ,  orgid\n      ,  accountid\n      ,  contactid\n      ,  suspectid\n      ,  partnerid\n      ,  addresscategory\n      ,  address_line1\n      ,  address_line2\n      ,  address_line3\n      ,  city\n      ,  state\n      ,  zip\n      ,  mailstop\n      ,  country\n      ,  start_date\n      ,  end_date\n      ,  residentialstatus\n      ,  userfield1\n      ,  userfield2\n      ,  userfield3\n      ,  userfield4\n      ,  userfield5\n      ,  userdatefield1\n      ,  userdatefield2\n      ,  userfield6\n      ,  userfield7\n      ,  extensionid\n      ,  name\n      ,  salutation_code\n      ,  address_proof_doc_id\n      ,  phoneno1\n      ,  phoneno1localcode\n      ,  phoneno1citycode\n      ,  phoneno1countrycode\n      ,  phoneno2\n      ,  phoneno2localcode\n      ,  phoneno2citycode\n      ,  phoneno2countrycode\n      ,  workextension\n      ,  cellno\n      ,  cellnolocalcode\n      ,  cellnocitycode\n      ,  cellnocountrycode\n      ,  faxno\n      ,  faxnolocalcode\n      ,  faxnocitycode\n      ,  faxnocountrycode\n      ,  faxno2\n      ,  faxnolocalcode2\n      ,  faxnocitycode2\n      ,  faxnocountrycode2\n      ,  email\n      ,  pagerno\n      ,  pagernolocalcode\n      ,  pagernocitycode\n      ,  pagernocountrycode\n      ,  emailpalm\n      ,  url\n      ,  house_no\n      ,  premise_name\n      ,  building_level\n      ,  street_no\n      ,  street_name\n      ,  suburb\n      ,  locality_name\n      ,  town\n      ,  domicile\n      ,  telex\n      ,  telexlocalcode\n      ,  telexcitycode\n      ,  telexcountrycode\n      ,  mluserfield1\n      ,  mluserfield2\n      ,  mluserfield3\n      ,  mluserfield4\n      ,  mluserfield5\n      ,  mluserfield6\n      ,  mluserfield7\n      ,  mluserfield8\n      ,  mluserfield9\n      ,  mluserfield10\n      ,  mluserfield11\n      ,  mluserfield12\n      ,  mluserfield13\n      ,  mluserfield14\n      ,  mluserfield15\n      ,  mluserfield16\n      ,  mluserfield17\n      ,  mluserfield18\n      ,  mluserfield19\n      ,  mluserfield20\n      ,  mluserfield21\n      ,  mluserfield22\n      ,  mluserfield23\n      ,  mluserfield24\n      ,  mluserfield25\n      ,  mluserfield26\n      ,  mluserfield27\n      ,  mluserfield28\n      ,  mluserfield29\n      ,  mluserfield30\n      ,  city_code\n      ,  state_code\n      ,  country_code\n      ,  core_cust_id\n      ,  concurdetect_x\n      ,  preferredaddress\n      ,  holdmailinitiatedby\n      ,  holdmailflag\n      ,  businesscenter\n      ,  holdmailreason\n      ,  preferredformat\n      ,  freetextaddress\n      ,  freetextlabel\n      ,  noncustomerid\n      ,  is_address_proof_rcvd\n      ,  lastupdate_date\n      ,  orgkey\n      ,  salutation\n      ,  holdmailstartdate\n      ,  holdmailenddate\n      ,  addressvalidity\n      ,  multi_addr_same_day\n      ,  core_start_date\n      ,  core_end_date\n      ,  exp_def_addr_type\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__address", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__address"}, "model.dga_data_model.stg_rb_los__addressdetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__addressdetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__addressdetail"], "unique_id": "model.dga_data_model.stg_rb_los__addressdetail", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        addressdetailid\r\n      , holdmailreason\r\n      , custsequenceno\r\n      , bccode\r\n      , addressproofrcvdind\r\n      , addressverifiedind\r\n      , holdmailinitiatedby\r\n      , crmaddressid\r\n      , holdmailflag\r\n      , addresslabel\r\n      , moduleid\r\n      , modulename\r\n      , houseno\r\n      , buildinglevel\r\n      , premisename\r\n      , streetno\r\n      , streetname\r\n      , locality\r\n      , suburb\r\n      , town\r\n      , addresstype\r\n      , residencytype\r\n      , addressline1\r\n      , addressline2\r\n      , addressline3\r\n      , addressLine1 || ' ' || addressLine2 AS address\r\n      , city\r\n      , state\r\n      , country\r\n      , postalcode\r\n      , ispresentaddress\r\n      , residingfromdate\r\n      , residingtilldate\r\n      , deletestatus\r\n      , isstructured\r\n      , bank_id\r\n      , bodatecreated\r\n      , bocreatedby\r\n      , bodatemodified\r\n      , bomodifiedby\r\n      , concurdetect_x\r\n      , boaclid\r\n      , securityilhint\r\n      , securityiuhint\r\n      , securityglhint\r\n      , securityguhint\r\n      , holdmailfromdate\r\n      , holdmailtilldate\r\n      , ispreferred\r\n      , tmdate\r\n  FROM\r\n    {{ ref('los__addressdetail') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__addressdetail.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__addressdetail.sql", "name": "stg_rb_los__addressdetail", "alias": "stg_rb_los__addressdetail", "checksum": {"name": "sha256", "checksum": "9f0685616d9bbf0b5e26781a4d51d4219a380b4eacfd24d9861e17180d5382f7"}, "tags": ["los", "los_tf"], "refs": [["los__addressdetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__addressdetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8320656, "compiled_code": "\n    SELECT\n        addressdetailid\n      , holdmailreason\n      , custsequenceno\n      , bccode\n      , addressproofrcvdind\n      , addressverifiedind\n      , holdmailinitiatedby\n      , crmaddressid\n      , holdmailflag\n      , addresslabel\n      , moduleid\n      , modulename\n      , houseno\n      , buildinglevel\n      , premisename\n      , streetno\n      , streetname\n      , locality\n      , suburb\n      , town\n      , addresstype\n      , residencytype\n      , addressline1\n      , addressline2\n      , addressline3\n      , addressLine1 || ' ' || addressLine2 AS address\n      , city\n      , state\n      , country\n      , postalcode\n      , ispresentaddress\n      , residingfromdate\n      , residingtilldate\n      , deletestatus\n      , isstructured\n      , bank_id\n      , bodatecreated\n      , bocreatedby\n      , bodatemodified\n      , bomodifiedby\n      , concurdetect_x\n      , boaclid\n      , securityilhint\n      , securityiuhint\n      , securityglhint\n      , securityguhint\n      , holdmailfromdate\n      , holdmailtilldate\n      , ispreferred\n      , tmdate\n  FROM\n    \"oracle_dgaworkzone\".base.los__addressdetail", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__addressdetail"}, "model.dga_data_model.stg_rb_los__agents": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__agents"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__agents"], "unique_id": "model.dga_data_model.stg_rb_los__agents", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        personid\r\n      ,  channel\r\n      ,  bhid\r\n      ,  enablealert\r\n      ,  home_bank_id\r\n      ,  bcid\r\n      ,  ccid\r\n      ,  tlpassword\r\n      ,  tlavailabilitystatus\r\n      ,  loggedin_bank\r\n      ,  acdpassword\r\n      ,  acdrepid\r\n      ,  location\r\n      ,  agentavailability\r\n      ,  supervisorid\r\n      ,  agenttype\r\n      ,  designation\r\n      ,  defaultemail\r\n      ,  thresincidents\r\n      ,  thresoppor\r\n      ,  sla\r\n      ,  availstring\r\n      ,  referencedate\r\n      ,  wrapuptime\r\n      ,  shiftstarttime\r\n      ,  shiftendtime\r\n      ,  referenceday\r\n      ,  asgenflag\r\n      ,  numofopeninci\r\n      ,  numofopenoppr\r\n      ,  primarybcgid\r\n      ,  defaultchannel\r\n      ,  primarygroupid\r\n      ,  bodatecreated\r\n      ,  numofopencamptgt\r\n      ,  threscamptgt\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  userfield1\r\n      ,  userfield2\r\n      ,  userfield3\r\n      ,  userfield4\r\n      ,  userfield5\r\n      ,  xmldata\r\n      ,  extensionid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  primarysegment\r\n      ,  primaryroleid\r\n      ,  thresretentities\r\n      ,  noofopenretentities\r\n      ,  threscorpentities\r\n      ,  noofopencorpentities\r\n      ,  seedavailstring\r\n      ,  dsaname\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__agents') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__agents.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__agents.sql", "name": "stg_rb_los__agents", "alias": "stg_rb_los__agents", "checksum": {"name": "sha256", "checksum": "f78816c84603a191a1ece1fdcb84d0bd1ee42420c5dbdeaeefd21c95fe3884ec"}, "tags": ["los", "los_tf"], "refs": [["los__agents"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__agents.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8350747, "compiled_code": "\n    SELECT\n        personid\n      ,  channel\n      ,  bhid\n      ,  enablealert\n      ,  home_bank_id\n      ,  bcid\n      ,  ccid\n      ,  tlpassword\n      ,  tlavailabilitystatus\n      ,  loggedin_bank\n      ,  acdpassword\n      ,  acdrepid\n      ,  location\n      ,  agentavailability\n      ,  supervisorid\n      ,  agenttype\n      ,  designation\n      ,  defaultemail\n      ,  thresincidents\n      ,  thresoppor\n      ,  sla\n      ,  availstring\n      ,  referencedate\n      ,  wrapuptime\n      ,  shiftstarttime\n      ,  shiftendtime\n      ,  referenceday\n      ,  asgenflag\n      ,  numofopeninci\n      ,  numofopenoppr\n      ,  primarybcgid\n      ,  defaultchannel\n      ,  primarygroupid\n      ,  bodatecreated\n      ,  numofopencamptgt\n      ,  threscamptgt\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  userfield1\n      ,  userfield2\n      ,  userfield3\n      ,  userfield4\n      ,  userfield5\n      ,  xmldata\n      ,  extensionid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  primarysegment\n      ,  primaryroleid\n      ,  thresretentities\n      ,  noofopenretentities\n      ,  threscorpentities\n      ,  noofopencorpentities\n      ,  seedavailstring\n      ,  dsaname\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__agents", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__agents"}, "model.dga_data_model.stg_rb_los__applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicant"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__applicant"], "unique_id": "model.dga_data_model.stg_rb_los__applicant", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        applicantid\r\n      , immigrationstatus\r\n      , totamount1\r\n      , totamount2\r\n      , totamount3\r\n      , isdeleted\r\n      , isassociated\r\n      , cifid\r\n      , applicationid\r\n      , productid\r\n      , applicanttype\r\n      , relationtype\r\n      , title\r\n      , firstname\r\n      , middlename\r\n      , lastname\r\n      , dob\r\n      , gender\r\n      , nationality\r\n      , langcode\r\n      , resdindicator\r\n      , resdtype\r\n      , custoccupation\r\n      , maritalstatus\r\n      , veteran\r\n      , yrofschool\r\n      , noofdependents\r\n      , staffindicator\r\n      , custsegment\r\n      , subsegment\r\n      , custrating\r\n      , isblacklistchkdone\r\n      , blacklisted\r\n      , blacklistnote\r\n      , blacklistreason\r\n      , isneglistchkdone\r\n      , negated\r\n      , neglistnote\r\n      , neglistreason\r\n      , isdedupchkdone\r\n      , dedupchknote\r\n      , suspended\r\n      , suspendednote\r\n      , suspendedreason\r\n      , status\r\n      , statuscode\r\n      , basecurrency\r\n      , crmentitytype\r\n      , minorindicator\r\n      , preferredname\r\n      , primaryrmi\r\n      , primarysolid\r\n      , staffid\r\n      , nickname\r\n      , shortname\r\n      , turnednonresidenton\r\n      , bank_id\r\n      , bodatecreated\r\n      , bocreatedby\r\n      , bodatemodified\r\n      , bomodifiedby\r\n      , concurdetect_x\r\n      , boaclid\r\n      , securityilhint\r\n      , securityiuhint\r\n      , securityglhint\r\n      , securityguhint\r\n      , parentapplicationid\r\n      , applicationreferencenumber\r\n      , prodrefnum\r\n      , networthweightage\r\n      , applntdedupdecision\r\n      , applntdedupdecremarks\r\n      , applntblacklistdesicion\r\n      , applntblacklistdesremarks\r\n      , applntnegativlistdesicion\r\n      , applntnegativlistdesremarks\r\n      , applntkycdesicion\r\n      , applntkycdesremarks\r\n      , applntkycdescomments\r\n      , tmdate\r\n      , cntryofcitizenship\r\n      , employmentstatus\r\n      , foreigntaxcomments\r\n      , foreigntaxrepcntry\r\n      , foreigntaxreptingstatus\r\n      , foreigntaxrptingdate\r\n      , freecode1\r\n      , freecode2\r\n      , freedate1\r\n      , freedate2\r\n      , freetext1\r\n      , freetext10\r\n      , freetext2\r\n      , freetext6\r\n      , freetext8\r\n      , grossincome\r\n      , grossincomecurrency\r\n      , industrytype\r\n      , insiderrole\r\n      , insidertobank\r\n      , isforeignacctaxrepreqd\r\n      , jobtitle\r\n      , noofdependentchildren\r\n      , taxdetdsourccifid\r\n      , taxdetdsourctable\r\n      , taxid\r\n      , nointerection\r\n      , donotemail\r\n      , donotphone\r\n      , nosweepstakes\r\n      , notificationflags\r\n\r\n    FROM\r\n      {{ ref('los__applicant') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__applicant.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__applicant.sql", "name": "stg_rb_los__applicant", "alias": "stg_rb_los__applicant", "checksum": {"name": "sha256", "checksum": "239567dde9f243dce5b5417934ce823b7ccaea2696979d134aeca2ed77798cd3"}, "tags": ["los", "los_tf"], "refs": [["los__applicant"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.836701, "compiled_code": "\n    SELECT\n        applicantid\n      , immigrationstatus\n      , totamount1\n      , totamount2\n      , totamount3\n      , isdeleted\n      , isassociated\n      , cifid\n      , applicationid\n      , productid\n      , applicanttype\n      , relationtype\n      , title\n      , firstname\n      , middlename\n      , lastname\n      , dob\n      , gender\n      , nationality\n      , langcode\n      , resdindicator\n      , resdtype\n      , custoccupation\n      , maritalstatus\n      , veteran\n      , yrofschool\n      , noofdependents\n      , staffindicator\n      , custsegment\n      , subsegment\n      , custrating\n      , isblacklistchkdone\n      , blacklisted\n      , blacklistnote\n      , blacklistreason\n      , isneglistchkdone\n      , negated\n      , neglistnote\n      , neglistreason\n      , isdedupchkdone\n      , dedupchknote\n      , suspended\n      , suspendednote\n      , suspendedreason\n      , status\n      , statuscode\n      , basecurrency\n      , crmentitytype\n      , minorindicator\n      , preferredname\n      , primaryrmi\n      , primarysolid\n      , staffid\n      , nickname\n      , shortname\n      , turnednonresidenton\n      , bank_id\n      , bodatecreated\n      , bocreatedby\n      , bodatemodified\n      , bomodifiedby\n      , concurdetect_x\n      , boaclid\n      , securityilhint\n      , securityiuhint\n      , securityglhint\n      , securityguhint\n      , parentapplicationid\n      , applicationreferencenumber\n      , prodrefnum\n      , networthweightage\n      , applntdedupdecision\n      , applntdedupdecremarks\n      , applntblacklistdesicion\n      , applntblacklistdesremarks\n      , applntnegativlistdesicion\n      , applntnegativlistdesremarks\n      , applntkycdesicion\n      , applntkycdesremarks\n      , applntkycdescomments\n      , tmdate\n      , cntryofcitizenship\n      , employmentstatus\n      , foreigntaxcomments\n      , foreigntaxrepcntry\n      , foreigntaxreptingstatus\n      , foreigntaxrptingdate\n      , freecode1\n      , freecode2\n      , freedate1\n      , freedate2\n      , freetext1\n      , freetext10\n      , freetext2\n      , freetext6\n      , freetext8\n      , grossincome\n      , grossincomecurrency\n      , industrytype\n      , insiderrole\n      , insidertobank\n      , isforeignacctaxrepreqd\n      , jobtitle\n      , noofdependentchildren\n      , taxdetdsourccifid\n      , taxdetdsourctable\n      , taxid\n      , nointerection\n      , donotemail\n      , donotphone\n      , nosweepstakes\n      , notificationflags\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__applicant", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__applicant"}, "model.dga_data_model.stg_rb_los__applicantaddress": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicantaddress"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__applicantaddress"], "unique_id": "model.dga_data_model.stg_rb_los__applicantaddress", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        applicantaddressid\r\n      , applicantid\r\n      , applicationid\r\n      , cifid\r\n      , isassociated\r\n      , isdeleted\r\n      , bank_id\r\n      , bodatecreated\r\n      , bocreatedby\r\n      , bodatemodified\r\n      , bomodifiedby\r\n      , concurdetect_x\r\n      , boaclid\r\n      , securityilhint\r\n      , securityiuhint\r\n      , securityglhint\r\n      , securityguhint\r\n      , tmdate\r\n\r\n    FROM\r\n      {{ ref('los__applicantaddress') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__applicantaddress.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__applicantaddress.sql", "name": "stg_rb_los__applicantaddress", "alias": "stg_rb_los__applicantaddress", "checksum": {"name": "sha256", "checksum": "fdab883f969d387c844e05d24568074e50c3e3c92b16c3caf42ec3032cedf370"}, "tags": ["los", "los_tf"], "refs": [["los__applicantaddress"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__applicantaddress.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8397763, "compiled_code": "\n    SELECT\n        applicantaddressid\n      , applicantid\n      , applicationid\n      , cifid\n      , isassociated\n      , isdeleted\n      , bank_id\n      , bodatecreated\n      , bocreatedby\n      , bodatemodified\n      , bomodifiedby\n      , concurdetect_x\n      , boaclid\n      , securityilhint\n      , securityiuhint\n      , securityglhint\n      , securityguhint\n      , tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__applicantaddress", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__applicantaddress"}, "model.dga_data_model.stg_rb_los__applicantcontact": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicantcontact"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__applicantcontact"], "unique_id": "model.dga_data_model.stg_rb_los__applicantcontact", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        applicantcontactid\r\n      , applicantid\r\n      , appid\r\n      , cifid\r\n      , prefercommlang\r\n      , besttimetocontact\r\n      , timezone\r\n      , donotemail\r\n      , donotmail\r\n      , donotphone\r\n      , nosweepstakes\r\n      , nointerection\r\n      , deleteflag\r\n      , isassociated\r\n      , bank_id\r\n      , bodatecreated\r\n      , bocreatedby\r\n      , bodatemodified\r\n      , bomodifiedby\r\n      , concurdetect_x\r\n      , boaclid\r\n      , securityilhint\r\n      , securityiuhint\r\n      , securityglhint\r\n      , securityguhint\r\n      , prefcommchannel\r\n      , prefmobilealerttype\r\n      , preflocale\r\n      , prefcontactnotype\r\n      , prefemailidtype\r\n      , crmdemographicid\r\n      , preferredmobilealertno\r\n      , preferredemail\r\n      , preferredcontactno\r\n      , psychographicid\r\n      , tmdate\r\n\r\n    FROM\r\n      {{ ref('los__applicantcontact') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__applicantcontact.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__applicantcontact.sql", "name": "stg_rb_los__applicantcontact", "alias": "stg_rb_los__applicantcontact", "checksum": {"name": "sha256", "checksum": "2c6d595dcad9d02eb94b8d93734057d153aaede5173fe54f38ac6066dbb5923f"}, "tags": ["los", "los_tf"], "refs": [["los__applicantcontact"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__applicantcontact.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8410242, "compiled_code": "\n    SELECT\n        applicantcontactid\n      , applicantid\n      , appid\n      , cifid\n      , prefercommlang\n      , besttimetocontact\n      , timezone\n      , donotemail\n      , donotmail\n      , donotphone\n      , nosweepstakes\n      , nointerection\n      , deleteflag\n      , isassociated\n      , bank_id\n      , bodatecreated\n      , bocreatedby\n      , bodatemodified\n      , bomodifiedby\n      , concurdetect_x\n      , boaclid\n      , securityilhint\n      , securityiuhint\n      , securityglhint\n      , securityguhint\n      , prefcommchannel\n      , prefmobilealerttype\n      , preflocale\n      , prefcontactnotype\n      , prefemailidtype\n      , crmdemographicid\n      , preferredmobilealertno\n      , preferredemail\n      , preferredcontactno\n      , psychographicid\n      , tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__applicantcontact", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontact"}, "model.dga_data_model.stg_rb_los__applicantcontactphnemllist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicantcontactphnemllist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__applicantcontactphnemllist"], "unique_id": "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        applicantcontactphnemllistid\r\n      , phoneoremail\r\n      , phonenumlocalcode\r\n      , phonenumcountrycode\r\n      , phonenumcitycode\r\n      , phoneemailtypevalue\r\n      , dateofreq\r\n      , extnsion\r\n      , deletestatus\r\n      , emailid\r\n      , applicantcontactid\r\n      , dnd\r\n      , holdemailflag\r\n      , holdemailinitiatedby\r\n      , holdemailreason\r\n      , crmphoneemailid\r\n      , bank_id\r\n      , bodatecreated\r\n      , bocreatedby\r\n      , bodatemodified\r\n      , bomodifiedby\r\n      , concurdetect_x\r\n      , boaclid\r\n      , securityilhint\r\n      , securityiuhint\r\n      , securityglhint\r\n      , securityguhint\r\n      , tmdate\r\n    FROM\r\n      {{ ref('los__applicantcontactphnemllist') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__applicantcontactphnemllist.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__applicantcontactphnemllist.sql", "name": "stg_rb_los__applicantcontactphnemllist", "alias": "stg_rb_los__applicantcontactphnemllist", "checksum": {"name": "sha256", "checksum": "ff9387ea4f6e9559b03826e3b86bdf0038172e313517af43be49198f6246d595"}, "tags": ["los", "los_tf"], "refs": [["los__applicantcontactphnemllist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__applicantcontactphnemllist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8431606, "compiled_code": "\n    SELECT\n        applicantcontactphnemllistid\n      , phoneoremail\n      , phonenumlocalcode\n      , phonenumcountrycode\n      , phonenumcitycode\n      , phoneemailtypevalue\n      , dateofreq\n      , extnsion\n      , deletestatus\n      , emailid\n      , applicantcontactid\n      , dnd\n      , holdemailflag\n      , holdemailinitiatedby\n      , holdemailreason\n      , crmphoneemailid\n      , bank_id\n      , bodatecreated\n      , bocreatedby\n      , bodatemodified\n      , bomodifiedby\n      , concurdetect_x\n      , boaclid\n      , securityilhint\n      , securityiuhint\n      , securityglhint\n      , securityguhint\n      , tmdate\n    FROM\n      \"oracle_dgaworkzone\".base.los__applicantcontactphnemllist", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__applicantcontactphnemllist"}, "model.dga_data_model.stg_rb_los__applicantidentitydetail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicantidentitydetail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__applicantidentitydetail"], "unique_id": "model.dga_data_model.stg_rb_los__applicantidentitydetail", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        applicantidentitydetailid\r\n      , doctype\r\n      , documentuniqueid\r\n      , placeofissue\r\n      , cityofissue\r\n      , stateofissue\r\n      , countryofissue\r\n      , docissuedt\r\n      , docexpdt\r\n      , idissuedorganisation\r\n      , applicantid\r\n      , docrmks\r\n      , deletestatus\r\n      , prefuniqueidind\r\n      , docverifiedind\r\n      , refnum\r\n      , status\r\n      , scanreqdind\r\n      , doccode\r\n      , crmdocumentid\r\n      , doccodedesc\r\n      , doctypedesc\r\n      , bank_id\r\n      , tmdate\r\n\r\n    FROM\r\n      {{ ref('los__applicantidentitydetail') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__applicantidentitydetail.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__applicantidentitydetail.sql", "name": "stg_rb_los__applicantidentitydetail", "alias": "stg_rb_los__applicantidentitydetail", "checksum": {"name": "sha256", "checksum": "4ddb438037d114f32b4ad23ddf6766230bd752ddb295dc9ffc26118cfc2e0094"}, "tags": ["los", "los_tf"], "refs": [["los__applicantidentitydetail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__applicantidentitydetail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8451588, "compiled_code": "\n    SELECT\n        applicantidentitydetailid\n      , doctype\n      , documentuniqueid\n      , placeofissue\n      , cityofissue\n      , stateofissue\n      , countryofissue\n      , docissuedt\n      , docexpdt\n      , idissuedorganisation\n      , applicantid\n      , docrmks\n      , deletestatus\n      , prefuniqueidind\n      , docverifiedind\n      , refnum\n      , status\n      , scanreqdind\n      , doccode\n      , crmdocumentid\n      , doccodedesc\n      , doctypedesc\n      , bank_id\n      , tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__applicantidentitydetail", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__applicantidentitydetail"}, "model.dga_data_model.stg_rb_los__applicationdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__applicationdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__applicationdetails"], "unique_id": "model.dga_data_model.stg_rb_los__applicationdetails", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        applicationdetailsid\r\n      ,  recompeligibility\r\n      ,  fileclosereason\r\n      ,  filecloseremarks\r\n      ,  filecloseresult\r\n      ,  reason\r\n      ,  appldetailssequenceno\r\n      ,  rejectremarks\r\n      ,  productcategory\r\n      ,  productsubcategory\r\n      ,  productclassification\r\n      ,  producttype\r\n      ,  productcode\r\n      ,  productname\r\n      ,  currency\r\n      ,  applrecieveddate\r\n      ,  applreferenceno\r\n      ,  isqualified\r\n      ,  applicationstatus\r\n      ,  frontendratio\r\n      ,  backendratio\r\n      ,  approach\r\n      ,  applicationstage\r\n      ,  agencyrefno\r\n      ,  opportunityid\r\n      ,  completedsteps\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  isdeleted\r\n      ,  purposeofloan\r\n      ,  applicationno\r\n      ,  accountnumber\r\n      ,  accountname\r\n      ,  parentapplicationid\r\n      ,  amountrequested\r\n      ,  tenorrequestedmm\r\n      ,  tenorrequesteddd\r\n      ,  intraterequested\r\n      ,  ismandatory\r\n      ,  isproductrejected\r\n      ,  applrejectedstage\r\n      ,  remarks\r\n      ,  applicationstep\r\n      ,  userenteligibleamt\r\n      ,  preapprovedcode\r\n      ,  preapprovedloan\r\n      ,  underwriterid\r\n      ,  underwritername\r\n      ,  interimstatus\r\n      ,  transactiontype\r\n      ,  applicationtype\r\n      ,  syseligibleamt\r\n      ,  enrichmentstatus\r\n      ,  eligibilitystatus\r\n      ,  disposition\r\n      ,  networthweightage\r\n      ,  osproductid\r\n      ,  amountrequestedccy\r\n      ,  cancelremark\r\n      ,  cancelreason\r\n      ,  interest\r\n      ,  apy\r\n      ,  freetext1\r\n      ,  freetext2\r\n      ,  freetext3\r\n      ,  freetext4\r\n      ,  freetext5\r\n      ,  freetext6\r\n      ,  freetext7\r\n      ,  freetext8\r\n      ,  freetext9\r\n      ,  freetext10\r\n      ,  freedate1\r\n      ,  freedate2\r\n      ,  stepduedate\r\n      ,  appduedate\r\n      ,  tmdate\r\n      ,  processflag\r\n\r\n    FROM\r\n      {{ ref('los__applicationdetails') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__applicationdetails.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__applicationdetails.sql", "name": "stg_rb_los__applicationdetails", "alias": "stg_rb_los__applicationdetails", "checksum": {"name": "sha256", "checksum": "df95e570860ec77bef6c66cc374988f510c64a251b685067c7c0bedff1193061"}, "tags": ["los", "los_tf"], "refs": [["los__applicationdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__applicationdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.847417, "compiled_code": "\n    SELECT\n        applicationdetailsid\n      ,  recompeligibility\n      ,  fileclosereason\n      ,  filecloseremarks\n      ,  filecloseresult\n      ,  reason\n      ,  appldetailssequenceno\n      ,  rejectremarks\n      ,  productcategory\n      ,  productsubcategory\n      ,  productclassification\n      ,  producttype\n      ,  productcode\n      ,  productname\n      ,  currency\n      ,  applrecieveddate\n      ,  applreferenceno\n      ,  isqualified\n      ,  applicationstatus\n      ,  frontendratio\n      ,  backendratio\n      ,  approach\n      ,  applicationstage\n      ,  agencyrefno\n      ,  opportunityid\n      ,  completedsteps\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  isdeleted\n      ,  purposeofloan\n      ,  applicationno\n      ,  accountnumber\n      ,  accountname\n      ,  parentapplicationid\n      ,  amountrequested\n      ,  tenorrequestedmm\n      ,  tenorrequesteddd\n      ,  intraterequested\n      ,  ismandatory\n      ,  isproductrejected\n      ,  applrejectedstage\n      ,  remarks\n      ,  applicationstep\n      ,  userenteligibleamt\n      ,  preapprovedcode\n      ,  preapprovedloan\n      ,  underwriterid\n      ,  underwritername\n      ,  interimstatus\n      ,  transactiontype\n      ,  applicationtype\n      ,  syseligibleamt\n      ,  enrichmentstatus\n      ,  eligibilitystatus\n      ,  disposition\n      ,  networthweightage\n      ,  osproductid\n      ,  amountrequestedccy\n      ,  cancelremark\n      ,  cancelreason\n      ,  interest\n      ,  apy\n      ,  freetext1\n      ,  freetext2\n      ,  freetext3\n      ,  freetext4\n      ,  freetext5\n      ,  freetext6\n      ,  freetext7\n      ,  freetext8\n      ,  freetext9\n      ,  freetext10\n      ,  freedate1\n      ,  freedate2\n      ,  stepduedate\n      ,  appduedate\n      ,  tmdate\n      ,  processflag\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__applicationdetails", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__applicationdetails"}, "model.dga_data_model.stg_rb_los__areas": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__areas"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__areas"], "unique_id": "model.dga_data_model.stg_rb_los__areas", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n      areasid\r\n    , code\r\n    , name\r\n    , isdeleted\r\n    , freetext1\r\n    , freetext2\r\n    , bodatemodified\r\n    , modifiedby\r\n    , bodatecreated\r\n    , createdby\r\n    FROM\r\n      {{ ref('los__areas') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__areas.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__areas.sql", "name": "stg_rb_los__areas", "alias": "stg_rb_los__areas", "checksum": {"name": "sha256", "checksum": "74ddb33bc4cc4f7464476b9eb6b35ba33ddf77c4dde4f7319ccc493753f42a60"}, "tags": ["los", "los_tf"], "refs": [["los__areas"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__areas.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8494182, "compiled_code": "\n    SELECT\n      areasid\n    , code\n    , name\n    , isdeleted\n    , freetext1\n    , freetext2\n    , bodatemodified\n    , modifiedby\n    , bodatecreated\n    , createdby\n    FROM\n      \"oracle_dgaworkzone\".base.los__areas", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__areas"}, "model.dga_data_model.stg_rb_los__bizcenter": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__bizcenter"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__bizcenter"], "unique_id": "model.dga_data_model.stg_rb_los__bizcenter", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        bcid\r\n      ,  bcname\r\n      ,  bccode\r\n      ,  bctypeid\r\n      ,  isactive\r\n      ,  region\r\n      ,  manager\r\n      ,  timezone\r\n      ,  houseno\r\n      ,  premisename\r\n      ,  buildinglevel\r\n      ,  streetno\r\n      ,  suburb\r\n      ,  streetname\r\n      ,  locality\r\n      ,  town\r\n      ,  email\r\n      ,  mailstop\r\n      ,  city\r\n      ,  state\r\n      ,  zip\r\n      ,  country\r\n      ,  phone\r\n      ,  fax\r\n      ,  userfield1\r\n      ,  userfield2\r\n      ,  userfield3\r\n      ,  userfield4\r\n      ,  userdatefield1\r\n      ,  userdatefield2\r\n      ,  useramtfield1\r\n      ,  useramtfield2\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  xmldata\r\n      ,  extensionid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  tmdate\r\n    FROM\r\n      {{ ref('los__bizcenter') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__bizcenter.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__bizcenter.sql", "name": "stg_rb_los__bizcenter", "alias": "stg_rb_los__bizcenter", "checksum": {"name": "sha256", "checksum": "2594d221952ead5bd31481eb37db5320e36f74619ab5000cafbe01f1927b5546"}, "tags": ["los", "los_tf"], "refs": [["los__bizcenter"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__bizcenter.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8526523, "compiled_code": "\n    SELECT\n        bcid\n      ,  bcname\n      ,  bccode\n      ,  bctypeid\n      ,  isactive\n      ,  region\n      ,  manager\n      ,  timezone\n      ,  houseno\n      ,  premisename\n      ,  buildinglevel\n      ,  streetno\n      ,  suburb\n      ,  streetname\n      ,  locality\n      ,  town\n      ,  email\n      ,  mailstop\n      ,  city\n      ,  state\n      ,  zip\n      ,  country\n      ,  phone\n      ,  fax\n      ,  userfield1\n      ,  userfield2\n      ,  userfield3\n      ,  userfield4\n      ,  userdatefield1\n      ,  userdatefield2\n      ,  useramtfield1\n      ,  useramtfield2\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  xmldata\n      ,  extensionid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  tmdate\n    FROM\n      \"oracle_dgaworkzone\".base.los__bizcenter", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__bizcenter"}, "model.dga_data_model.stg_rb_los__categories": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__categories"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__categories"], "unique_id": "model.dga_data_model.stg_rb_los__categories", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        categoryid\r\n      ,  bank_id\r\n      ,  remarks\r\n      ,  categorycode\r\n      ,  categorytype\r\n      ,  value\r\n      ,  allowmodify\r\n      ,  rating\r\n      ,  ratingtype\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  xmldata\r\n      ,  extensionid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  del_flg\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__categories') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__categories.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__categories.sql", "name": "stg_rb_los__categories", "alias": "stg_rb_los__categories", "checksum": {"name": "sha256", "checksum": "768f58ff4a451f40db5fc77e7a6184b3df4877adb3911c69fad5da539b83fb49"}, "tags": ["los", "los_tf"], "refs": [["los__categories"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__categories.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8546524, "compiled_code": "\n    SELECT\n        categoryid\n      ,  bank_id\n      ,  remarks\n      ,  categorycode\n      ,  categorytype\n      ,  value\n      ,  allowmodify\n      ,  rating\n      ,  ratingtype\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  xmldata\n      ,  extensionid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  del_flg\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__categories", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__categories"}, "model.dga_data_model.stg_rb_los__category_lang": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__category_lang"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__category_lang"], "unique_id": "model.dga_data_model.stg_rb_los__category_lang", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        categorylangid\r\n      ,  bank_id\r\n      ,  categoryid\r\n      ,  localecode\r\n      ,  localetext\r\n      ,  cmlabelcode\r\n      ,  isexceeded\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__category_lang') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__category_lang.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__category_lang.sql", "name": "stg_rb_los__category_lang", "alias": "stg_rb_los__category_lang", "checksum": {"name": "sha256", "checksum": "9372dd565ee0418b565e7d266c7daa9155ea0fdd53b8388e518f2625b59f32e9"}, "tags": ["los", "los_tf"], "refs": [["los__category_lang"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__category_lang.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8567412, "compiled_code": "\n    SELECT\n        categorylangid\n      ,  bank_id\n      ,  categoryid\n      ,  localecode\n      ,  localetext\n      ,  cmlabelcode\n      ,  isexceeded\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__category_lang", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__category_lang"}, "model.dga_data_model.stg_rb_los__creditcardproduct": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__creditcardproduct"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__creditcardproduct"], "unique_id": "model.dga_data_model.stg_rb_los__creditcardproduct", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        creditcardproductid\r\n      ,  applicationdetailsid\r\n      ,  creditcardlimit\r\n      ,  cashwithdrawallimit\r\n      ,  minimumamtduepercent\r\n      ,  accountnumber\r\n      ,  accountname\r\n      ,  currency\r\n      ,  interestratecode\r\n      ,  interestrate\r\n      ,  sequenceno\r\n      ,  embossedname\r\n      ,  validfromdate\r\n      ,  validtilldate\r\n      ,  dispatchmode\r\n      ,  repaymenttype\r\n      ,  addoncardrequired\r\n      ,  billingfrequency\r\n      ,  repaymentmode\r\n      ,  cardtype\r\n      ,  balancetransferrequested\r\n      ,  includeaccruedinterest\r\n      ,  graceperiod\r\n      ,  isdeleted\r\n      ,  biccode\r\n      ,  paysysid\r\n      ,  billingfreqnumbers\r\n      ,  billingfreqweekofmonth\r\n      ,  billingfreqdayofweek\r\n      ,  billingfreqdate\r\n      ,  billingfreqholiday\r\n      ,  billingfreqstartdate\r\n      ,  billingfreqcalendar\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  tmdate\r\n      ,  customsecquestion\r\n      ,  custompartmember\r\n      ,  customcrosssalename\r\n      ,  customcrosssaleid\r\n      ,  customcrosssalephone\r\n      ,  customcrosssaleemail\r\n      ,  custompintype\r\n      ,  customcardtype\r\n\r\n    FROM\r\n      {{ ref('los__creditcardproduct') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__creditcardproduct.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__creditcardproduct.sql", "name": "stg_rb_los__creditcardproduct", "alias": "stg_rb_los__creditcardproduct", "checksum": {"name": "sha256", "checksum": "4a975a982e9934d19ed44087c315daed2dc8e9d29972a862926665c107e18438"}, "tags": ["los", "los_tf"], "refs": [["los__creditcardproduct"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__creditcardproduct.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8588235, "compiled_code": "\n    SELECT\n        creditcardproductid\n      ,  applicationdetailsid\n      ,  creditcardlimit\n      ,  cashwithdrawallimit\n      ,  minimumamtduepercent\n      ,  accountnumber\n      ,  accountname\n      ,  currency\n      ,  interestratecode\n      ,  interestrate\n      ,  sequenceno\n      ,  embossedname\n      ,  validfromdate\n      ,  validtilldate\n      ,  dispatchmode\n      ,  repaymenttype\n      ,  addoncardrequired\n      ,  billingfrequency\n      ,  repaymentmode\n      ,  cardtype\n      ,  balancetransferrequested\n      ,  includeaccruedinterest\n      ,  graceperiod\n      ,  isdeleted\n      ,  biccode\n      ,  paysysid\n      ,  billingfreqnumbers\n      ,  billingfreqweekofmonth\n      ,  billingfreqdayofweek\n      ,  billingfreqdate\n      ,  billingfreqholiday\n      ,  billingfreqstartdate\n      ,  billingfreqcalendar\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  tmdate\n      ,  customsecquestion\n      ,  custompartmember\n      ,  customcrosssalename\n      ,  customcrosssaleid\n      ,  customcrosssalephone\n      ,  customcrosssaleemail\n      ,  custompintype\n      ,  customcardtype\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__creditcardproduct", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__creditcardproduct"}, "model.dga_data_model.stg_rb_los__decision": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__decision"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__decision"], "unique_id": "model.dga_data_model.stg_rb_los__decision", "raw_code": "{{\r\n    config(\r\n        materialized='view',\r\n    )\r\n}}\r\nSELECT\r\n    decisionid\r\n  , decision\r\n  , applicationid\r\n  , ruleid\r\n  , decisionresult\r\n  , userid\r\n  , internalscore\r\n  , timestamp\r\n  , decisioningtype\r\n  , bank_id\r\n  , bodatecreated\r\n  , bocreatedby\r\n  , bodatemodified\r\n  , bomodifiedby\r\n  , concurdetect_x\r\n  , boaclid\r\n  , securityilhint\r\n  , securityiuhint\r\n  , securityglhint\r\n  , securityguhint\r\n  , isdeleted\r\n  , comments\r\n  , decisionexpirydate\r\n  , groupid\r\n  , frontendratio\r\n  , backendratio\r\n  , piamount\r\n  , isparent\r\n  , tmdate\r\nFROM {{ ref('los__decision')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__decision.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__decision.sql", "name": "stg_rb_los__decision", "alias": "stg_rb_los__decision", "checksum": {"name": "sha256", "checksum": "d62ca266cf1c53c9342930d7ecfc63585226701fffd39571b4c3082791753100"}, "tags": ["los", "los_tf"], "refs": [["los__decision"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__decision.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.861032, "compiled_code": "\nSELECT\n    decisionid\n  , decision\n  , applicationid\n  , ruleid\n  , decisionresult\n  , userid\n  , internalscore\n  , timestamp\n  , decisioningtype\n  , bank_id\n  , bodatecreated\n  , bocreatedby\n  , bodatemodified\n  , bomodifiedby\n  , concurdetect_x\n  , boaclid\n  , securityilhint\n  , securityiuhint\n  , securityglhint\n  , securityguhint\n  , isdeleted\n  , comments\n  , decisionexpirydate\n  , groupid\n  , frontendratio\n  , backendratio\n  , piamount\n  , isparent\n  , tmdate\nFROM \"oracle_dgaworkzone\".base.los__decision", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__decision"}, "model.dga_data_model.stg_rb_los__loanproductdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__loanproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__loanproductdetails"], "unique_id": "model.dga_data_model.stg_rb_los__loanproductdetails", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        loanproductdetailsid\r\n      ,  offsetaccountnumber\r\n      ,  spread\r\n      ,  sequenceno\r\n      ,  interestratecode\r\n      ,  interestrate\r\n      ,  documentationtype\r\n      ,  iascode\r\n      ,  assumptioneligible\r\n      ,  installmenttype\r\n      ,  repricingplan\r\n      ,  repaymenttype\r\n      ,  repaymentmethod\r\n      ,  ratelockrequired\r\n      ,  autopaydiscountapplicable\r\n      ,  subsidyrequired\r\n      ,  disbtype\r\n      ,  buydownrequired\r\n      ,  excldecredit\r\n      ,  savingshomeflag\r\n      ,  principalsubsidyamount\r\n      ,  principalsubsidycurr\r\n      ,  intbenefitsubsidy\r\n      ,  buydowntype\r\n      ,  currency\r\n      ,  conversionallowedfrom\r\n      ,  conversionallowedto\r\n      ,  escrowaccountreq\r\n      ,  armintladjcapincr\r\n      ,  armintladjcapdecr\r\n      ,  armperiodicadjcapincr\r\n      ,  armperiodicadjcapdecr\r\n      ,  armlifetimeadjcapdecr\r\n      ,  armlifetimeadjcapincr\r\n      ,  armintrmovmntrestrct\r\n      ,  armminchangeintr\r\n      ,  armadvintrratefixreq\r\n      ,  armadvnoticeintchng\r\n      ,  tenormonths\r\n      ,  applicationdetailsid\r\n      ,  amount\r\n      ,  tenordays\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  isdeleted\r\n      ,  enrforcreditprotection\r\n      ,  enrollmentfromdate\r\n      ,  enrollmenttodate\r\n      ,  insured\r\n      ,  maxcreproperiod\r\n      ,  minbillamount\r\n      ,  minpaymentapplicable\r\n      ,  nameofinscompany\r\n      ,  noofmissedpayallowed\r\n      ,  promoperiod\r\n      ,  promoperiodintrate\r\n      ,  promoperiodintapplication\r\n      ,  excludereason\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__loanproductdetails') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__loanproductdetails.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__loanproductdetails.sql", "name": "stg_rb_los__loanproductdetails", "alias": "stg_rb_los__loanproductdetails", "checksum": {"name": "sha256", "checksum": "dd07608ae835934e798bcf827e4977080453d41e0b5efa17eba13faf275fedd4"}, "tags": ["los", "los_tf"], "refs": [["los__loanproductdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__loanproductdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8632152, "compiled_code": "\n    SELECT\n        loanproductdetailsid\n      ,  offsetaccountnumber\n      ,  spread\n      ,  sequenceno\n      ,  interestratecode\n      ,  interestrate\n      ,  documentationtype\n      ,  iascode\n      ,  assumptioneligible\n      ,  installmenttype\n      ,  repricingplan\n      ,  repaymenttype\n      ,  repaymentmethod\n      ,  ratelockrequired\n      ,  autopaydiscountapplicable\n      ,  subsidyrequired\n      ,  disbtype\n      ,  buydownrequired\n      ,  excldecredit\n      ,  savingshomeflag\n      ,  principalsubsidyamount\n      ,  principalsubsidycurr\n      ,  intbenefitsubsidy\n      ,  buydowntype\n      ,  currency\n      ,  conversionallowedfrom\n      ,  conversionallowedto\n      ,  escrowaccountreq\n      ,  armintladjcapincr\n      ,  armintladjcapdecr\n      ,  armperiodicadjcapincr\n      ,  armperiodicadjcapdecr\n      ,  armlifetimeadjcapdecr\n      ,  armlifetimeadjcapincr\n      ,  armintrmovmntrestrct\n      ,  armminchangeintr\n      ,  armadvintrratefixreq\n      ,  armadvnoticeintchng\n      ,  tenormonths\n      ,  applicationdetailsid\n      ,  amount\n      ,  tenordays\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  isdeleted\n      ,  enrforcreditprotection\n      ,  enrollmentfromdate\n      ,  enrollmenttodate\n      ,  insured\n      ,  maxcreproperiod\n      ,  minbillamount\n      ,  minpaymentapplicable\n      ,  nameofinscompany\n      ,  noofmissedpayallowed\n      ,  promoperiod\n      ,  promoperiodintrate\n      ,  promoperiodintapplication\n      ,  excludereason\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__loanproductdetails", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__loanproductdetails"}, "model.dga_data_model.stg_rb_los__losprocessentity": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__losprocessentity"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__losprocessentity"], "unique_id": "model.dga_data_model.stg_rb_los__losprocessentity", "raw_code": "{{\r\n    config(\r\n        materialized='view'\r\n    )\r\n}}\r\nSELECT\r\n    losprocessentityid\r\n  , processid\r\n  , entityid\r\n  , entityname\r\n  , currentactivityid\r\n  , parentactivityid\r\n  , processstepstatus\r\n  , salesownerid\r\n  , salesownergroup\r\n  , assigneduserid\r\n  , assignedusergroup\r\n  , assignedlocationid\r\n  , entityowner\r\n  , entityownergroup\r\n  , entityownerlocationid\r\n  , entitystage\r\n  , routingtype\r\n  , routingcomment\r\n  , routingreasonecode\r\n  , routingmatrixid\r\n  , sla\r\n  , activityname\r\n  , userfield1\r\n  , userfield2\r\n  , processname\r\n  , losprocessid\r\n  , bank_id\r\n  , bodatecreated\r\n  , bocreatedby\r\n  , bodatemodified\r\n  , bomodifiedby\r\n  , concurdetect_x\r\n  , boaclid\r\n  , securityilhint\r\n  , securityiuhint\r\n  , securityglhint\r\n  , securityguhint\r\n  , opportunityproductsid\r\n  , entitystep\r\n  , tmdate\r\nFROM {{ ref('los__losprocessentity') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__losprocessentity.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__losprocessentity.sql", "name": "stg_rb_los__losprocessentity", "alias": "stg_rb_los__losprocessentity", "checksum": {"name": "sha256", "checksum": "342c30d75388cfd5d1668da232967a0c3bd72057deef422752e8892bad4692c4"}, "tags": ["los", "los_tf"], "refs": [["los__losprocessentity"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__losprocessentity.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8653378, "compiled_code": "\nSELECT\n    losprocessentityid\n  , processid\n  , entityid\n  , entityname\n  , currentactivityid\n  , parentactivityid\n  , processstepstatus\n  , salesownerid\n  , salesownergroup\n  , assigneduserid\n  , assignedusergroup\n  , assignedlocationid\n  , entityowner\n  , entityownergroup\n  , entityownerlocationid\n  , entitystage\n  , routingtype\n  , routingcomment\n  , routingreasonecode\n  , routingmatrixid\n  , sla\n  , activityname\n  , userfield1\n  , userfield2\n  , processname\n  , losprocessid\n  , bank_id\n  , bodatecreated\n  , bocreatedby\n  , bodatemodified\n  , bomodifiedby\n  , concurdetect_x\n  , boaclid\n  , securityilhint\n  , securityiuhint\n  , securityglhint\n  , securityguhint\n  , opportunityproductsid\n  , entitystep\n  , tmdate\nFROM \"oracle_dgaworkzone\".base.los__losprocessentity", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__losprocessentity"}, "model.dga_data_model.stg_rb_los__opportunities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__opportunities"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__opportunities"], "unique_id": "model.dga_data_model.stg_rb_los__opportunities", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        opportunityid\r\n      ,  productclassification\r\n      ,  authtype\r\n      ,  producttype\r\n      ,  productcode\r\n      ,  productname\r\n      ,  currency\r\n      ,  productcategory\r\n      ,  businesscenter\r\n      ,  dsarepname\r\n      ,  repname\r\n      ,  productsubcategory\r\n      ,  accountbranch\r\n      ,  transactiontype\r\n      ,  assigntransfer\r\n      ,  groupname\r\n      ,  transferuserid\r\n      ,  tier\r\n      ,  isdeleted\r\n      ,  is_ssa_acct\r\n      ,  tempsalesid\r\n      ,  applicationtype\r\n      ,  userstrfield1\r\n      ,  userstrfield2\r\n      ,  userstrfield3\r\n      ,  userstrfield4\r\n      ,  userdatefield\r\n      ,  bank_id\r\n      ,  stopprocescalation\r\n      ,  rejectreason\r\n      ,  lockrollback\r\n      ,  lockrecompute\r\n      ,  salesownergroup\r\n      ,  ownergroup\r\n      ,  oldsalesownerid\r\n      ,  referencetype\r\n      ,  noofrollback\r\n      ,  firstrollbackat\r\n      ,  accountnumber\r\n      ,  leadvalue\r\n      ,  valueunits\r\n      ,  basevalue\r\n      ,  probability\r\n      ,  processstage\r\n      ,  disposition\r\n      ,  leadtype\r\n      ,  opportunitiessource\r\n      ,  description\r\n      ,  leadmode\r\n      ,  campaigntargetid\r\n      ,  reasoncode\r\n      ,  reasondetails\r\n      ,  opportunityname\r\n      ,  caseid\r\n      ,  opportunitytype\r\n      ,  processid\r\n      ,  currentstep\r\n      ,  orgid\r\n      ,  suspectid\r\n      ,  status\r\n      ,  hasattachment\r\n      ,  notes\r\n      ,  additionalnotes\r\n      ,  owneruserid\r\n      ,  assigneduserid\r\n      ,  createduserid\r\n      ,  assignedgroupid\r\n      ,  crmcallid\r\n      ,  mergedwith\r\n      ,  priority\r\n      ,  startdate\r\n      ,  duedate\r\n      ,  competitors\r\n      ,  enddate\r\n      ,  currstepduedate\r\n      ,  region\r\n      ,  ismerger\r\n      ,  assignedbyuserid\r\n      ,  transferredbyuserid\r\n      ,  opportunityfor\r\n      ,  autocreateapplform\r\n      ,  opprstage\r\n      ,  opprstatus\r\n      ,  lastname\r\n      ,  opprchannel\r\n      ,  oppreditable\r\n      ,  promotionoffer\r\n      ,  promotionvalidity\r\n      ,  branchlocation\r\n      ,  processeditable\r\n      ,  oldapplicationid\r\n      ,  channelrefid\r\n      ,  salesownerid\r\n      ,  contactid\r\n      ,  purposeofcredit\r\n      ,  isautomated\r\n      ,  campaignid\r\n      ,  timerstatus\r\n      ,  secoppcaseid\r\n      ,  issecondaryopp\r\n      ,  assignedtime\r\n      ,  slalevel\r\n      ,  ownedlocationid\r\n      ,  assignedlocationid\r\n      ,  isrouted\r\n      ,  esc_due_time\r\n      ,  esc_level\r\n      ,  nocurstepassign\r\n      ,  tatduration\r\n      ,  stopescalation\r\n      ,  entityemail\r\n      ,  manualrouting\r\n      ,  customersegment\r\n      ,  routedtime\r\n      ,  procescduetime\r\n      ,  firstgrownid\r\n      ,  firstbcownid\r\n      ,  firstuserownid\r\n      ,  currnumposesc\r\n      ,  currnumnegesc\r\n      ,  numofposesc\r\n      ,  numofnegesc\r\n      ,  procesclevel\r\n      ,  routeruleforgroup\r\n      ,  routeruleforbc\r\n      ,  routeruleforuser\r\n      ,  escalationattr1\r\n      ,  escalationattr2\r\n      ,  escalationattr3\r\n      ,  createdlocationid\r\n      ,  userfield1\r\n      ,  userfield2\r\n      ,  userfield3\r\n      ,  userfield4\r\n      ,  userfield5\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  xmldata\r\n      ,  extensionid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  parentintxnid\r\n      ,  prevstependdate\r\n      ,  accessownergroup\r\n      ,  accessownersegment\r\n      ,  accessownerbc\r\n      ,  accessowneragent\r\n      ,  accessassigneeagent\r\n      ,  opportunityvalue\r\n      ,  leadsourceid\r\n      ,  quotaid\r\n      ,  cifid\r\n      ,  firstname\r\n      ,  offerid\r\n      ,  optionid\r\n      ,  loanamt\r\n      ,  channelname\r\n      ,  loantenordays\r\n      ,  loantenormonths\r\n      ,  assignedbcgid\r\n      ,  ownerbcgid\r\n      ,  applrecieveddate\r\n      ,  extoriginatorname\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__opportunities') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__opportunities.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__opportunities.sql", "name": "stg_rb_los__opportunities", "alias": "stg_rb_los__opportunities", "checksum": {"name": "sha256", "checksum": "d7cfcb55e9bdecbfa54f82b73f398864b1050ef81f51dccf48f2f67efcbfd7a2"}, "tags": ["los", "los_tf"], "refs": [["los__opportunities"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__opportunities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.868339, "compiled_code": "\n    SELECT\n        opportunityid\n      ,  productclassification\n      ,  authtype\n      ,  producttype\n      ,  productcode\n      ,  productname\n      ,  currency\n      ,  productcategory\n      ,  businesscenter\n      ,  dsarepname\n      ,  repname\n      ,  productsubcategory\n      ,  accountbranch\n      ,  transactiontype\n      ,  assigntransfer\n      ,  groupname\n      ,  transferuserid\n      ,  tier\n      ,  isdeleted\n      ,  is_ssa_acct\n      ,  tempsalesid\n      ,  applicationtype\n      ,  userstrfield1\n      ,  userstrfield2\n      ,  userstrfield3\n      ,  userstrfield4\n      ,  userdatefield\n      ,  bank_id\n      ,  stopprocescalation\n      ,  rejectreason\n      ,  lockrollback\n      ,  lockrecompute\n      ,  salesownergroup\n      ,  ownergroup\n      ,  oldsalesownerid\n      ,  referencetype\n      ,  noofrollback\n      ,  firstrollbackat\n      ,  accountnumber\n      ,  leadvalue\n      ,  valueunits\n      ,  basevalue\n      ,  probability\n      ,  processstage\n      ,  disposition\n      ,  leadtype\n      ,  opportunitiessource\n      ,  description\n      ,  leadmode\n      ,  campaigntargetid\n      ,  reasoncode\n      ,  reasondetails\n      ,  opportunityname\n      ,  caseid\n      ,  opportunitytype\n      ,  processid\n      ,  currentstep\n      ,  orgid\n      ,  suspectid\n      ,  status\n      ,  hasattachment\n      ,  notes\n      ,  additionalnotes\n      ,  owneruserid\n      ,  assigneduserid\n      ,  createduserid\n      ,  assignedgroupid\n      ,  crmcallid\n      ,  mergedwith\n      ,  priority\n      ,  startdate\n      ,  duedate\n      ,  competitors\n      ,  enddate\n      ,  currstepduedate\n      ,  region\n      ,  ismerger\n      ,  assignedbyuserid\n      ,  transferredbyuserid\n      ,  opportunityfor\n      ,  autocreateapplform\n      ,  opprstage\n      ,  opprstatus\n      ,  lastname\n      ,  opprchannel\n      ,  oppreditable\n      ,  promotionoffer\n      ,  promotionvalidity\n      ,  branchlocation\n      ,  processeditable\n      ,  oldapplicationid\n      ,  channelrefid\n      ,  salesownerid\n      ,  contactid\n      ,  purposeofcredit\n      ,  isautomated\n      ,  campaignid\n      ,  timerstatus\n      ,  secoppcaseid\n      ,  issecondaryopp\n      ,  assignedtime\n      ,  slalevel\n      ,  ownedlocationid\n      ,  assignedlocationid\n      ,  isrouted\n      ,  esc_due_time\n      ,  esc_level\n      ,  nocurstepassign\n      ,  tatduration\n      ,  stopescalation\n      ,  entityemail\n      ,  manualrouting\n      ,  customersegment\n      ,  routedtime\n      ,  procescduetime\n      ,  firstgrownid\n      ,  firstbcownid\n      ,  firstuserownid\n      ,  currnumposesc\n      ,  currnumnegesc\n      ,  numofposesc\n      ,  numofnegesc\n      ,  procesclevel\n      ,  routeruleforgroup\n      ,  routeruleforbc\n      ,  routeruleforuser\n      ,  escalationattr1\n      ,  escalationattr2\n      ,  escalationattr3\n      ,  createdlocationid\n      ,  userfield1\n      ,  userfield2\n      ,  userfield3\n      ,  userfield4\n      ,  userfield5\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  xmldata\n      ,  extensionid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  parentintxnid\n      ,  prevstependdate\n      ,  accessownergroup\n      ,  accessownersegment\n      ,  accessownerbc\n      ,  accessowneragent\n      ,  accessassigneeagent\n      ,  opportunityvalue\n      ,  leadsourceid\n      ,  quotaid\n      ,  cifid\n      ,  firstname\n      ,  offerid\n      ,  optionid\n      ,  loanamt\n      ,  channelname\n      ,  loantenordays\n      ,  loantenormonths\n      ,  assignedbcgid\n      ,  ownerbcgid\n      ,  applrecieveddate\n      ,  extoriginatorname\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__opportunities", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__opportunities"}, "model.dga_data_model.stg_rb_los__oslineproductdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__oslineproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__oslineproductdetails"], "unique_id": "model.dga_data_model.stg_rb_los__oslineproductdetails", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        oslineproductdetailsid\r\n      ,  excldcreditreport\r\n      ,  sequenceno\r\n      ,  eligibleforratelock\r\n      ,  applicationdetailsid\r\n      ,  limitsought\r\n      ,  drawperioddays\r\n      ,  drawperiodmonths\r\n      ,  repayperioddays\r\n      ,  repayperiodmonths\r\n      ,  reviewdate\r\n      ,  producttype\r\n      ,  repricingplan\r\n      ,  ratelockrequired\r\n      ,  escrowaccountreq\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  tmdate\r\n      ,  custombaseintrate\r\n      ,  customminint\r\n      ,  customseqnumber\r\n      ,  customspread\r\n      ,  customstartdate\r\n      ,  customtenordays\r\n      ,  customtenormonths\r\n      ,  customtotalvariance\r\n      ,  customvariance\r\n      ,  customcurrentaccountid\r\n      ,  customeffectiverate\r\n      ,  customenddate\r\n      ,  customfinalintrate\r\n      ,  customintmodrequired\r\n      ,  custominttabcode\r\n      ,  custommaxint\r\n      ,  customstrfield1\r\n      ,  customstrfield2\r\n      ,  customstrfield3\r\n      ,  customint1\r\n      ,  customint2\r\n      ,  customdate1\r\n      ,  customeffectiverate1\r\n\r\n    FROM\r\n      {{ ref('los__oslineproductdetails') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__oslineproductdetails.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__oslineproductdetails.sql", "name": "stg_rb_los__oslineproductdetails", "alias": "stg_rb_los__oslineproductdetails", "checksum": {"name": "sha256", "checksum": "2f2c3ca694bb1a2bbd0f6b74a9349aae51a7fa1d6893f32a69459ffb7d014181"}, "tags": ["los", "los_tf"], "refs": [["los__oslineproductdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__oslineproductdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8703377, "compiled_code": "\n    SELECT\n        oslineproductdetailsid\n      ,  excldcreditreport\n      ,  sequenceno\n      ,  eligibleforratelock\n      ,  applicationdetailsid\n      ,  limitsought\n      ,  drawperioddays\n      ,  drawperiodmonths\n      ,  repayperioddays\n      ,  repayperiodmonths\n      ,  reviewdate\n      ,  producttype\n      ,  repricingplan\n      ,  ratelockrequired\n      ,  escrowaccountreq\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  tmdate\n      ,  custombaseintrate\n      ,  customminint\n      ,  customseqnumber\n      ,  customspread\n      ,  customstartdate\n      ,  customtenordays\n      ,  customtenormonths\n      ,  customtotalvariance\n      ,  customvariance\n      ,  customcurrentaccountid\n      ,  customeffectiverate\n      ,  customenddate\n      ,  customfinalintrate\n      ,  customintmodrequired\n      ,  custominttabcode\n      ,  custommaxint\n      ,  customstrfield1\n      ,  customstrfield2\n      ,  customstrfield3\n      ,  customint1\n      ,  customint2\n      ,  customdate1\n      ,  customeffectiverate1\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__oslineproductdetails", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__oslineproductdetails"}, "model.dga_data_model.stg_rb_los__osproduct": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__osproduct"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__osproduct"], "unique_id": "model.dga_data_model.stg_rb_los__osproduct", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        osproductid\r\n      ,  exposurecat\r\n      ,  shadowproductid\r\n      ,  productcategory\r\n      ,  productsubcategory\r\n      ,  productname\r\n      ,  productcode\r\n      ,  productprocessor\r\n      ,  productvalidfrom\r\n      ,  intcompoundingfreqdr\r\n      ,  intcalcfreqtypedr\r\n      ,  intcalcfreqweekdaydr\r\n      ,  intcalcfreqweeknumdr\r\n      ,  intcalcfreqholidaydr\r\n      ,  intcalcfreqstartdatedr\r\n      ,  intcalcfreqcalendardr\r\n      ,  collinterestflg\r\n      ,  productvalidtill\r\n      ,  producttype\r\n      ,  productmanagername\r\n      ,  applformtemplate\r\n      ,  acctemplate\r\n      ,  businessgroup\r\n      ,  region\r\n      ,  permittedsectorcode\r\n      ,  jointholderdsr\r\n      ,  programid\r\n      ,  feepackageid\r\n      ,  validationpackageid\r\n      ,  coolingoffperiod\r\n      ,  coolingoffperioddesc\r\n      ,  accessownergroup\r\n      ,  accessownersegment\r\n      ,  accessownerbc\r\n      ,  attachmentname\r\n      ,  producthandlingskill\r\n      ,  iasclassification\r\n      ,  availablechannels\r\n      ,  lifecyclestatus\r\n      ,  activate\r\n      ,  statusdescription\r\n      ,  remarks\r\n      ,  authorisedby\r\n      ,  authorisationstatus\r\n      ,  authorisationremarks\r\n      ,  isdeleted\r\n      ,  policypackageid\r\n      ,  repaymentcycle_ftr\r\n      ,  repricing_ftr\r\n      ,  regulatory_ftr\r\n      ,  miscellaneous_ftr\r\n      ,  mandatorydetails_ftr\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  productsecsubcategory\r\n      ,  createdby\r\n      ,  productclassification\r\n      ,  eligibilitypackageid\r\n      ,  creditauthorizationmatrixid\r\n      ,  subsidydetails_ftr\r\n      ,  systemdefinedacnum\r\n      ,  payinterest\r\n      ,  nonresident\r\n      ,  channelflg\r\n      ,  glsubheadcode\r\n      ,  productgroup\r\n      ,  freecode1\r\n      ,  freecode2\r\n      ,  freecode3\r\n      ,  freetext1\r\n      ,  freetext2\r\n      ,  freetext3\r\n      ,  transactionrestriction\r\n      ,  minageyy\r\n      ,  minagemm\r\n      ,  maxageyy\r\n      ,  maxagemm\r\n      ,  intcompoundingfreqcr\r\n      ,  intcalcfreqtypecr\r\n      ,  intcalcfreqweekdaycr\r\n      ,  intcalcfreqweeknumcr\r\n      ,  intcalcfreqholidaycr\r\n      ,  intcalcfreqstartdatecr\r\n      ,  intcalcfreqcalendarcr\r\n      ,  fcnrflg\r\n      ,  staffschemeflg\r\n      ,  eefcflg\r\n      ,  chequebookallowed\r\n      ,  interest\r\n      ,  apy\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__osproduct') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__osproduct.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__osproduct.sql", "name": "stg_rb_los__osproduct", "alias": "stg_rb_los__osproduct", "checksum": {"name": "sha256", "checksum": "ff28d2a320b3e334f5a0eba0a105b04b8bba2bc5e9f751d5caa7a52c5638c22d"}, "tags": ["los", "los_tf"], "refs": [["los__osproduct"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__osproduct.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8723378, "compiled_code": "\n    SELECT\n        osproductid\n      ,  exposurecat\n      ,  shadowproductid\n      ,  productcategory\n      ,  productsubcategory\n      ,  productname\n      ,  productcode\n      ,  productprocessor\n      ,  productvalidfrom\n      ,  intcompoundingfreqdr\n      ,  intcalcfreqtypedr\n      ,  intcalcfreqweekdaydr\n      ,  intcalcfreqweeknumdr\n      ,  intcalcfreqholidaydr\n      ,  intcalcfreqstartdatedr\n      ,  intcalcfreqcalendardr\n      ,  collinterestflg\n      ,  productvalidtill\n      ,  producttype\n      ,  productmanagername\n      ,  applformtemplate\n      ,  acctemplate\n      ,  businessgroup\n      ,  region\n      ,  permittedsectorcode\n      ,  jointholderdsr\n      ,  programid\n      ,  feepackageid\n      ,  validationpackageid\n      ,  coolingoffperiod\n      ,  coolingoffperioddesc\n      ,  accessownergroup\n      ,  accessownersegment\n      ,  accessownerbc\n      ,  attachmentname\n      ,  producthandlingskill\n      ,  iasclassification\n      ,  availablechannels\n      ,  lifecyclestatus\n      ,  activate\n      ,  statusdescription\n      ,  remarks\n      ,  authorisedby\n      ,  authorisationstatus\n      ,  authorisationremarks\n      ,  isdeleted\n      ,  policypackageid\n      ,  repaymentcycle_ftr\n      ,  repricing_ftr\n      ,  regulatory_ftr\n      ,  miscellaneous_ftr\n      ,  mandatorydetails_ftr\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  productsecsubcategory\n      ,  createdby\n      ,  productclassification\n      ,  eligibilitypackageid\n      ,  creditauthorizationmatrixid\n      ,  subsidydetails_ftr\n      ,  systemdefinedacnum\n      ,  payinterest\n      ,  nonresident\n      ,  channelflg\n      ,  glsubheadcode\n      ,  productgroup\n      ,  freecode1\n      ,  freecode2\n      ,  freecode3\n      ,  freetext1\n      ,  freetext2\n      ,  freetext3\n      ,  transactionrestriction\n      ,  minageyy\n      ,  minagemm\n      ,  maxageyy\n      ,  maxagemm\n      ,  intcompoundingfreqcr\n      ,  intcalcfreqtypecr\n      ,  intcalcfreqweekdaycr\n      ,  intcalcfreqweeknumcr\n      ,  intcalcfreqholidaycr\n      ,  intcalcfreqstartdatecr\n      ,  intcalcfreqcalendarcr\n      ,  fcnrflg\n      ,  staffschemeflg\n      ,  eefcflg\n      ,  chequebookallowed\n      ,  interest\n      ,  apy\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__osproduct", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__osproduct"}, "model.dga_data_model.stg_rb_los__parentapplication": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__parentapplication"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__parentapplication"], "unique_id": "model.dga_data_model.stg_rb_los__parentapplication", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        parentapplicationid\r\n      ,  iscorporateapplication\r\n      ,  disclosureaccepted\r\n      ,  customerdetailid\r\n      ,  applicantid\r\n      ,  issubmitted\r\n      ,  applicationstatus\r\n      ,  applicationreferencenumber\r\n      ,  requestmode\r\n      ,  decisionremark\r\n      ,  decisionresult\r\n      ,  reasondetails\r\n      ,  bank_id\r\n      ,  bodatecreated\r\n      ,  bocreatedby\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  boaclid\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  ipaddress\r\n      ,  datetime\r\n      ,  disclosurecontextid\r\n      ,  disclosureid\r\n      ,  disclosureversion\r\n      ,  disclosureconsent\r\n      ,  disclosuredatetime\r\n      ,  customercifid\r\n      ,  isapplsubmitted\r\n      ,  parentapplrefnumber\r\n      ,  isforked\r\n      ,  channel\r\n      ,  opportunitiesid\r\n      ,  isdeleted\r\n      ,  applicationstep\r\n      ,  aplicationstage\r\n      ,  interimstatus\r\n      ,  extoriginatorname\r\n      ,  disposition\r\n      ,  overallapplicationdecision\r\n      ,  overalldecisionreason\r\n      ,  overallremarks\r\n      ,  indivapplicantdecisioncd\r\n      ,  indivdecisionremarkscd\r\n      ,  indivapplicantdecisionnl\r\n      ,  indivapplicantdecisionbl\r\n      ,  indivapplicantdecisionad\r\n      ,  indivdecisionremarksbl\r\n      ,  indivdecisionremarksnl\r\n      ,  indivdecisionremarksad\r\n      ,  stepduedate\r\n      ,  appduedate\r\n      ,  rlosfolderflag\r\n      ,  indivapplicantdecision\r\n      ,  indivdecisionremarks\r\n      ,  licenseincremented\r\n      ,  tmdate\r\n      , SUBSTR(parentapplrefnumber,11,6) AS opportunitiesid_ref\r\n    FROM\r\n      {{ ref('los__parentapplication') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__parentapplication.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__parentapplication.sql", "name": "stg_rb_los__parentapplication", "alias": "stg_rb_los__parentapplication", "checksum": {"name": "sha256", "checksum": "47143e7821f004d4125cf105ce5b9c32398125b16e23be86e335eb39bd9b9b3f"}, "tags": ["los", "los_tf"], "refs": [["los__parentapplication"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__parentapplication.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.875542, "compiled_code": "\n    SELECT\n        parentapplicationid\n      ,  iscorporateapplication\n      ,  disclosureaccepted\n      ,  customerdetailid\n      ,  applicantid\n      ,  issubmitted\n      ,  applicationstatus\n      ,  applicationreferencenumber\n      ,  requestmode\n      ,  decisionremark\n      ,  decisionresult\n      ,  reasondetails\n      ,  bank_id\n      ,  bodatecreated\n      ,  bocreatedby\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  boaclid\n      ,  securityilhint\n      ,  securityiuhint\n      ,  securityglhint\n      ,  securityguhint\n      ,  ipaddress\n      ,  datetime\n      ,  disclosurecontextid\n      ,  disclosureid\n      ,  disclosureversion\n      ,  disclosureconsent\n      ,  disclosuredatetime\n      ,  customercifid\n      ,  isapplsubmitted\n      ,  parentapplrefnumber\n      ,  isforked\n      ,  channel\n      ,  opportunitiesid\n      ,  isdeleted\n      ,  applicationstep\n      ,  aplicationstage\n      ,  interimstatus\n      ,  extoriginatorname\n      ,  disposition\n      ,  overallapplicationdecision\n      ,  overalldecisionreason\n      ,  overallremarks\n      ,  indivapplicantdecisioncd\n      ,  indivdecisionremarkscd\n      ,  indivapplicantdecisionnl\n      ,  indivapplicantdecisionbl\n      ,  indivapplicantdecisionad\n      ,  indivdecisionremarksbl\n      ,  indivdecisionremarksnl\n      ,  indivdecisionremarksad\n      ,  stepduedate\n      ,  appduedate\n      ,  rlosfolderflag\n      ,  indivapplicantdecision\n      ,  indivdecisionremarks\n      ,  licenseincremented\n      ,  tmdate\n      , SUBSTR(parentapplrefnumber,11,6) AS opportunitiesid_ref\n    FROM\n      \"oracle_dgaworkzone\".base.los__parentapplication", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__parentapplication"}, "model.dga_data_model.stg_rb_los__person": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__person"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__person"], "unique_id": "model.dga_data_model.stg_rb_los__person", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        personid\r\n      ,  middlename_alt1\r\n      ,  lastname_alt1\r\n      ,  firstname_alt1\r\n      ,  orgid\r\n      ,  persontype\r\n      ,  lastname\r\n      ,  firstname\r\n      ,  gender\r\n      ,  notes\r\n      ,  birth_day\r\n      ,  birth_month\r\n      ,  birth_year\r\n      ,  phone_home1\r\n      ,  phone_home2\r\n      ,  phone_work\r\n      ,  extn\r\n      ,  phone_cell\r\n      ,  fax_home\r\n      ,  fax_work\r\n      ,  email_home\r\n      ,  email_work\r\n      ,  email_palm\r\n      ,  preferredchannelid\r\n      ,  middlename\r\n      ,  salutation\r\n      ,  dob\r\n      ,  tmdate\r\n      , trim(lastname) || ' ' || trim(firstname) AS full_name\r\n\r\n    FROM\r\n      {{ ref('los__person') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__person.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__person.sql", "name": "stg_rb_los__person", "alias": "stg_rb_los__person", "checksum": {"name": "sha256", "checksum": "4477800eb3dbce8fa6bf7adfd404c42e7493965ff11494dc37dff72d2f8e3015"}, "tags": ["los", "los_tf"], "refs": [["los__person"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__person.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8775423, "compiled_code": "\n    SELECT\n        personid\n      ,  middlename_alt1\n      ,  lastname_alt1\n      ,  firstname_alt1\n      ,  orgid\n      ,  persontype\n      ,  lastname\n      ,  firstname\n      ,  gender\n      ,  notes\n      ,  birth_day\n      ,  birth_month\n      ,  birth_year\n      ,  phone_home1\n      ,  phone_home2\n      ,  phone_work\n      ,  extn\n      ,  phone_cell\n      ,  fax_home\n      ,  fax_work\n      ,  email_home\n      ,  email_work\n      ,  email_palm\n      ,  preferredchannelid\n      ,  middlename\n      ,  salutation\n      ,  dob\n      ,  tmdate\n      , trim(lastname) || ' ' || trim(firstname) AS full_name\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__person", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__person"}, "model.dga_data_model.stg_rb_los__rlosroutingdetails": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__rlosroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__rlosroutingdetails"], "unique_id": "model.dga_data_model.stg_rb_los__rlosroutingdetails", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        rlosroutingdetailsid\r\n      ,  bank_id\r\n      ,  opportunitiesid\r\n      ,  assignedby\r\n      ,  assignedto\r\n      ,  applcomments\r\n      ,  routetostep\r\n      ,  routingreasoncode\r\n      ,  routingcomments\r\n      ,  userfield1\r\n      ,  userfield2\r\n      ,  userflag1\r\n      ,  userflag2\r\n      ,  routingdate\r\n      ,  ishistory\r\n      ,  routefromstep\r\n      ,  routeto\r\n      ,  routetype\r\n      ,  transferredby\r\n      ,  transferredto\r\n      ,  transferredfrom\r\n      ,  assignedfrom\r\n      ,  assigneetype\r\n      ,  assignertype\r\n      ,  transfereetype\r\n      ,  transferortype\r\n      ,  opportunityproductsid\r\n      ,  routefromstagestep\r\n      ,  routetostagestep\r\n      ,  decision\r\n      ,  reason\r\n      ,  remarks\r\n      ,  boaclid\r\n      ,  bocreatedby\r\n      ,  bodatecreated\r\n      ,  bodatemodified\r\n      ,  bomodifiedby\r\n      ,  concurdetect_x\r\n      ,  securityglhint\r\n      ,  securityguhint\r\n      ,  securityilhint\r\n      ,  securityiuhint\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__rlosroutingdetails') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__rlosroutingdetails.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__rlosroutingdetails.sql", "name": "stg_rb_los__rlosroutingdetails", "alias": "stg_rb_los__rlosroutingdetails", "checksum": {"name": "sha256", "checksum": "f12e40eb6e4d85afb1c7522169e9d36393134bff3a63321e702ac5a929dc87e2"}, "tags": ["los", "los_tf"], "refs": [["los__rlosroutingdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__rlosroutingdetails.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8789485, "compiled_code": "\n    SELECT\n        rlosroutingdetailsid\n      ,  bank_id\n      ,  opportunitiesid\n      ,  assignedby\n      ,  assignedto\n      ,  applcomments\n      ,  routetostep\n      ,  routingreasoncode\n      ,  routingcomments\n      ,  userfield1\n      ,  userfield2\n      ,  userflag1\n      ,  userflag2\n      ,  routingdate\n      ,  ishistory\n      ,  routefromstep\n      ,  routeto\n      ,  routetype\n      ,  transferredby\n      ,  transferredto\n      ,  transferredfrom\n      ,  assignedfrom\n      ,  assigneetype\n      ,  assignertype\n      ,  transfereetype\n      ,  transferortype\n      ,  opportunityproductsid\n      ,  routefromstagestep\n      ,  routetostagestep\n      ,  decision\n      ,  reason\n      ,  remarks\n      ,  boaclid\n      ,  bocreatedby\n      ,  bodatecreated\n      ,  bodatemodified\n      ,  bomodifiedby\n      ,  concurdetect_x\n      ,  securityglhint\n      ,  securityguhint\n      ,  securityilhint\n      ,  securityiuhint\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__rlosroutingdetails", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__rlosroutingdetails"}, "model.dga_data_model.stg_rb_los__rlosworknotes": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__rlosworknotes"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__rlosworknotes"], "unique_id": "model.dga_data_model.stg_rb_los__rlosworknotes", "raw_code": "{{\r\n    config(\r\n        materialized='view',\r\n    )\r\n}}\r\nSELECT\r\n    rlosworknotesid\r\n  , parentapplicationid\r\n  , notecode\r\n  , notedescription\r\n  , userid\r\n  , step\r\n  , stage\r\n  , creationdatetime\r\n  , deletedflag\r\n  , associationtype\r\n  , associationid\r\n  , remarks\r\n  , bank_id\r\n  , bodatecreated\r\n  , bocreatedby\r\n  , bodatemodified\r\n  , bomodifiedby\r\n  , concurdetect_x\r\n  , boaclid\r\n  , securityilhint\r\n  , securityiuhint\r\n  , securityglhint\r\n  , securityguhint\r\n  , tmdate\r\n  , CASE\r\n      WHEN to_char(remarks) IS NULL OR to_char(remarks) = '\u0110\u00c2Y L\u00c0 H\u1ed2 S\u01a0 NH\u1eacP B\u1edeI ROBOT RPA MERCURY' THEN 1\r\n      ELSE 0\r\n  END AS is_real_remarks\r\nFROM {{ ref('los__rlosworknotes')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__rlosworknotes.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__rlosworknotes.sql", "name": "stg_rb_los__rlosworknotes", "alias": "stg_rb_los__rlosworknotes", "checksum": {"name": "sha256", "checksum": "f014d206407a0a5ea9316c023590d130b38a2371fb5361a585ce4466af78163b"}, "tags": ["los", "los_tf"], "refs": [["los__rlosworknotes"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__rlosworknotes.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8813472, "compiled_code": "\nSELECT\n    rlosworknotesid\n  , parentapplicationid\n  , notecode\n  , notedescription\n  , userid\n  , step\n  , stage\n  , creationdatetime\n  , deletedflag\n  , associationtype\n  , associationid\n  , remarks\n  , bank_id\n  , bodatecreated\n  , bocreatedby\n  , bodatemodified\n  , bomodifiedby\n  , concurdetect_x\n  , boaclid\n  , securityilhint\n  , securityiuhint\n  , securityglhint\n  , securityguhint\n  , tmdate\n  , CASE\n      WHEN to_char(remarks) IS NULL OR to_char(remarks) = '\u0110\u00c2Y L\u00c0 H\u1ed2 S\u01a0 NH\u1eacP B\u1edeI ROBOT RPA MERCURY' THEN 1\n      ELSE 0\n  END AS is_real_remarks\nFROM \"oracle_dgaworkzone\".base.los__rlosworknotes", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__rlosworknotes"}, "model.dga_data_model.stg_rb_los__rollback": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__rollback"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__rollback"], "unique_id": "model.dga_data_model.stg_rb_los__rollback", "raw_code": "{{\r\n    config(\r\n        materialized='view',\r\n    )\r\n}}\r\nSELECT\r\n    rollbackid\r\n  , applicationdetailsid\r\n  , reasoncode\r\n  , reasondesc\r\n  , rbfromstage\r\n  , rbtostage\r\n  , bank_id\r\n  , bodatecreated\r\n  , bocreatedby\r\n  , bodatemodified\r\n  , bomodifiedby\r\n  , concurdetect_x\r\n  , boaclid\r\n  , securityilhint\r\n  , securityiuhint\r\n  , securityglhint\r\n  , securityguhint\r\n  , remarks\r\n  , isdeleted\r\n  , userid\r\n  , rbstep\r\n  , parentapplicationid\r\n  , rbfromstep\r\n  , rbtostep\r\n  , tmdate\r\nFROM {{ ref('los__rollback')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__rollback.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__rollback.sql", "name": "stg_rb_los__rollback", "alias": "stg_rb_los__rollback", "checksum": {"name": "sha256", "checksum": "d52f7b7cee82a115bbc064243331477422efdb09f5060c2738be237c8545d56a"}, "tags": ["los", "los_tf"], "refs": [["los__rollback"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__rollback.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8833468, "compiled_code": "\nSELECT\n    rollbackid\n  , applicationdetailsid\n  , reasoncode\n  , reasondesc\n  , rbfromstage\n  , rbtostage\n  , bank_id\n  , bodatecreated\n  , bocreatedby\n  , bodatemodified\n  , bomodifiedby\n  , concurdetect_x\n  , boaclid\n  , securityilhint\n  , securityiuhint\n  , securityglhint\n  , securityguhint\n  , remarks\n  , isdeleted\n  , userid\n  , rbstep\n  , parentapplicationid\n  , rbfromstep\n  , rbtostep\n  , tmdate\nFROM \"oracle_dgaworkzone\".base.los__rollback", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__rollback"}, "model.dga_data_model.stg_rb_los__slbccodemapping": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__slbccodemapping"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__slbccodemapping"], "unique_id": "model.dga_data_model.stg_rb_los__slbccodemapping", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        bccode\r\n      ,  slbranchcode\r\n      ,  slbranchname\r\n      ,  specialized_bank\r\n\r\n    FROM\r\n      {{ ref('los__slbccodemapping') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__slbccodemapping.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__slbccodemapping.sql", "name": "stg_rb_los__slbccodemapping", "alias": "stg_rb_los__slbccodemapping", "checksum": {"name": "sha256", "checksum": "994eaa59e8f677311f01f26aee0cafa1a1e765288a7a07e7262e5503db4aaebd"}, "tags": ["los", "los_tf"], "refs": [["los__slbccodemapping"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__slbccodemapping.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.886347, "compiled_code": "\n    SELECT\n        bccode\n      ,  slbranchcode\n      ,  slbranchname\n      ,  specialized_bank\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__slbccodemapping", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__slbccodemapping"}, "model.dga_data_model.stg_rb_los__syncapplicantaddressmap": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__syncapplicantaddressmap"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__syncapplicantaddressmap"], "unique_id": "model.dga_data_model.stg_rb_los__syncapplicantaddressmap", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        syncapplicantaddressmapid\r\n      , applicantaddressid\r\n      , addressdetailid\r\n      , bank_id\r\n      , bodatecreated\r\n      , bocreatedby\r\n      , bodatemodified\r\n      , bomodifiedby\r\n      , concurdetect_x\r\n      , boaclid\r\n      , securityilhint\r\n      , securityiuhint\r\n      , securityglhint\r\n      , securityguhint\r\n      , tmdate\r\n    FROM\r\n      {{ ref('los__syncapplicantaddressmap') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__syncapplicantaddressmap.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__syncapplicantaddressmap.sql", "name": "stg_rb_los__syncapplicantaddressmap", "alias": "stg_rb_los__syncapplicantaddressmap", "checksum": {"name": "sha256", "checksum": "1ad7c162cf08d606b6e28afdaed58d059e620fb2e8a55afd682f78be1e36c53f"}, "tags": ["los", "los_tf"], "refs": [["los__syncapplicantaddressmap"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__syncapplicantaddressmap.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.887767, "compiled_code": "\n    SELECT\n        syncapplicantaddressmapid\n      , applicantaddressid\n      , addressdetailid\n      , bank_id\n      , bodatecreated\n      , bocreatedby\n      , bodatemodified\n      , bomodifiedby\n      , concurdetect_x\n      , boaclid\n      , securityilhint\n      , securityiuhint\n      , securityglhint\n      , securityguhint\n      , tmdate\n    FROM\n      \"oracle_dgaworkzone\".base.los__syncapplicantaddressmap", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__syncapplicantaddressmap"}, "model.dga_data_model.stg_rb_los__transactiondepartment": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__transactiondepartment"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__transactiondepartment"], "unique_id": "model.dga_data_model.stg_rb_los__transactiondepartment", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n      transactiondepartmentid\r\n      , bccode\r\n      , name\r\n      , standartname\r\n      , areasid\r\n      , isdeleted\r\n      , createdby\r\n      , modifiedby\r\n      , freetext1\r\n      , freetext2\r\n      , datemodified\r\n      , datecreated\r\n    FROM\r\n      {{ ref('los__transactiondepartment') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__transactiondepartment.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__transactiondepartment.sql", "name": "stg_rb_los__transactiondepartment", "alias": "stg_rb_los__transactiondepartment", "checksum": {"name": "sha256", "checksum": "807a4a2b6938b38436ff9971c2621f8a30035c9909ec40b2cfe59856ae3776ca"}, "tags": ["los", "los_tf"], "refs": [["los__transactiondepartment"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__transactiondepartment.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8899555, "compiled_code": "\n    SELECT\n      transactiondepartmentid\n      , bccode\n      , name\n      , standartname\n      , areasid\n      , isdeleted\n      , createdby\n      , modifiedby\n      , freetext1\n      , freetext2\n      , datemodified\n      , datecreated\n    FROM\n      \"oracle_dgaworkzone\".base.los__transactiondepartment", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__transactiondepartment"}, "model.dga_data_model.stg_rb_los__users": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.los__users"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg_rb_los__users"], "unique_id": "model.dga_data_model.stg_rb_los__users", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        personid\r\n      ,  usertype\r\n      ,  loginid\r\n      ,  password\r\n      ,  screenid\r\n      ,  active\r\n      ,  isinternaluser\r\n      ,  available\r\n      ,  locale\r\n      ,  timezone\r\n      ,  cifidaccess\r\n      ,  custrelation\r\n      ,  tmdate\r\n\r\n    FROM\r\n      {{ ref('los__users') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg_rb_los__users.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg_rb_los__users.sql", "name": "stg_rb_los__users", "alias": "stg_rb_los__users", "checksum": {"name": "sha256", "checksum": "2e9829721c9af751a5357a77d3e33dbc3d73ac0ace8f87dfe68ab23db8845268"}, "tags": ["los", "los_tf"], "refs": [["los__users"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg_rb_los__users.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "view"}, "created_at": 1685959751.8929565, "compiled_code": "\n    SELECT\n        personid\n      ,  usertype\n      ,  loginid\n      ,  password\n      ,  screenid\n      ,  active\n      ,  isinternaluser\n      ,  available\n      ,  locale\n      ,  timezone\n      ,  cifidaccess\n      ,  custrelation\n      ,  tmdate\n\n    FROM\n      \"oracle_dgaworkzone\".base.los__users", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_rb_los__users"}, "model.dga_data_model.stg__los_category": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_rb_los__categories", "model.dga_data_model.stg_rb_los__category_lang"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg__los_category"], "unique_id": "model.dga_data_model.stg__los_category", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nSELECT\r\n    ct.value\r\n  , ct.categorytype\r\n  , MIN(CASE WHEN ctl.localecode = 'en_US' THEN ctl.localetext END ) AS en_localetext\r\n  , MIN(CASE WHEN ctl.localecode = 'vi_VN' THEN ctl.localetext END ) AS vi_localetext\r\nFROM\r\n  {{ ref('stg_rb_los__categories')}} ct\r\nINNER JOIN {{ ref('stg_rb_los__category_lang') }} ctl ON ct.categoryid = ctl.categoryid\r\nWHERE\r\n  ct.bank_id = 'DFBANK1'\r\n  AND ctl.bank_id = 'DFBANK1'\r\n  AND ct.categorytype\r\n    IN ( 'DECISION_RESULT', 'PRODUCT_SECSUBCATEGORY', 'APPLICATION_STAGE', 'RLOS_APP_STEPS', 'SERVICE_OUTLET' )\r\nGROUP BY\r\n    ct.value\r\n  , ct.categorytype", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg__los_category.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg__los_category.sql", "name": "stg__los_category", "alias": "stg__los_category", "checksum": {"name": "sha256", "checksum": "22e668d7d2b3f2c9744e93674f7ed70ec037558aa9721a53655a1e754b79c723"}, "tags": ["los", "los_tf"], "refs": [["stg_rb_los__categories"], ["stg_rb_los__category_lang"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg__los_category.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959751.8942766, "compiled_code": "\nSELECT\n    ct.value\n  , ct.categorytype\n  , MIN(CASE WHEN ctl.localecode = 'en_US' THEN ctl.localetext END ) AS en_localetext\n  , MIN(CASE WHEN ctl.localecode = 'vi_VN' THEN ctl.localetext END ) AS vi_localetext\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__categories ct\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__category_lang ctl ON ct.categoryid = ctl.categoryid\nWHERE\n  ct.bank_id = 'DFBANK1'\n  AND ctl.bank_id = 'DFBANK1'\n  AND ct.categorytype\n    IN ( 'DECISION_RESULT', 'PRODUCT_SECSUBCATEGORY', 'APPLICATION_STAGE', 'RLOS_APP_STEPS', 'SERVICE_OUTLET' )\nGROUP BY\n    ct.value\n  , ct.categorytype", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__los_category"}, "model.dga_data_model.stg__los_user": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_rb_los__users", "model.dga_data_model.stg_rb_los__person", "model.dga_data_model.stg_rb_los__agents", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__address"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["los", "los_tf"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "los", "los_rb", "stg__los_user"], "unique_id": "model.dga_data_model.stg__los_user", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nSELECT\r\n  u.personid,\r\n  u.usertype,\r\n  u.loginid,\r\n  u.active,\r\n  u.available,\r\n  u.locale,\r\n  u.custrelation,\r\n  p.lastname,\r\n  p.firstname,\r\n  p.lastname || ' ' || p.middlename || ' ' || p.firstname as UserName,\r\n  p.gender,\r\n  p.dob ,\r\n  a.bcid,\r\n  b.bccode,\r\n  b.bcname,\r\n  la.ADDRESS_LINE3 AS home_address\r\nFROM\r\n  {{ ref('stg_rb_los__users') }} u\r\nINNER JOIN {{ ref('stg_rb_los__person')}} p ON u.personid = p.personid\r\nINNER JOIN {{ ref('stg_rb_los__agents') }} a ON u.personid = a.personid\r\nINNER JOIN {{ ref('stg_rb_los__bizcenter') }} b ON a.bcid = b.bcid\r\nLEFT JOIN {{ ref('stg_rb_los__address') }} la ON la.personid = u.personid AND la.addresscategory = 'Home'", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\los\\los_rb\\stg__los_user.sql", "original_file_path": "models\\staging\\los\\los_rb\\stg__los_user.sql", "name": "stg__los_user", "alias": "stg__los_user", "checksum": {"name": "sha256", "checksum": "35f4c98126c254e005b40e20289dee1a6dc56fad129f4cfe9d7ac882de91c91d"}, "tags": ["los", "los_tf"], "refs": [["stg_rb_los__users"], ["stg_rb_los__person"], ["stg_rb_los__agents"], ["stg_rb_los__bizcenter"], ["stg_rb_los__address"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\los\\los_rb\\stg__los_user.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "los_tf", "materialized": "table"}, "created_at": 1685959751.896518, "compiled_code": "\nSELECT\n  u.personid,\n  u.usertype,\n  u.loginid,\n  u.active,\n  u.available,\n  u.locale,\n  u.custrelation,\n  p.lastname,\n  p.firstname,\n  p.lastname || ' ' || p.middlename || ' ' || p.firstname as UserName,\n  p.gender,\n  p.dob ,\n  a.bcid,\n  b.bccode,\n  b.bcname,\n  la.ADDRESS_LINE3 AS home_address\nFROM\n  \"oracle_dgaworkzone\".staging.stg_rb_los__users u\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__person p ON u.personid = p.personid\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__agents a ON u.personid = a.personid\nINNER JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__bizcenter b ON a.bcid = b.bcid\nLEFT JOIN \"oracle_dgaworkzone\".staging.stg_rb_los__address la ON la.personid = u.personid AND la.addresscategory = 'Home'", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__los_user"}, "model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.mercury.tbl_applicant_enterprise_income"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_applicant_enterprise_income"], "unique_id": "model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n        id\r\n        , version\r\n        , employer_name\r\n        , is_deleted\r\n        , ward\r\n        , industry\r\n        , CAST(profit AS BIGINT) AS profit\r\n        , district\r\n        , CAST(customer_profit AS BIGINT) AS customer_profit\r\n        , CAST(expenses AS BIGINT) AS expenses\r\n        , CAST(TRIM(business_registration_id) AS VARCHAR(255)) AS business_registration_id\r\n        , CAST(revenue AS BIGINT) AS revenue\r\n        , applicant_income_id\r\n        , weight_of_cap_contrib\r\n        , city\r\n        , address_line1\r\n        , evaluation_period_mth\r\n        , CAST(issue_date AS timestamp(3)) AS issue_date\r\n        , CAST(authorized_capital AS BIGINT) AS authorized_capital\r\n        , CAST(income AS BIGINT) AS income\r\n        , remark\r\n        , CAST(recent_change_date AS timestamp(3)) AS recent_change_date\r\n        , credit_reputation\r\n        , CAST(profit_margin AS BIGINT) AS profit_margin\r\n        , evaluation_period\r\n        , business_production_process\r\n        , recording_method\r\n        , business_scale\r\n        , location_ownership_form\r\n        , original_source\r\n        , inventory\r\n        , output\r\n        , primary_product\r\n        , business_type\r\n  FROM {{ source('mercury', 'tbl_applicant_enterprise_income') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_applicant_enterprise_income.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_applicant_enterprise_income.sql", "name": "stg_mercury__tbl_applicant_enterprise_income", "alias": "stg_mercury__tbl_applicant_enterprise_income", "checksum": {"name": "sha256", "checksum": "cc3e6406331adf5a8f1e25974448c682751a269e8f745cb43874fe3ca9581ec9"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_applicant_enterprise_income"]], "metrics": [], "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_applicant_enterprise_income.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959753.2193716, "compiled_code": "\nWITH source AS(\n  SELECT\n        id\n        , version\n        , employer_name\n        , is_deleted\n        , ward\n        , industry\n        , CAST(profit AS BIGINT) AS profit\n        , district\n        , CAST(customer_profit AS BIGINT) AS customer_profit\n        , CAST(expenses AS BIGINT) AS expenses\n        , CAST(TRIM(business_registration_id) AS VARCHAR(255)) AS business_registration_id\n        , CAST(revenue AS BIGINT) AS revenue\n        , applicant_income_id\n        , weight_of_cap_contrib\n        , city\n        , address_line1\n        , evaluation_period_mth\n        , CAST(issue_date AS timestamp(3)) AS issue_date\n        , CAST(authorized_capital AS BIGINT) AS authorized_capital\n        , CAST(income AS BIGINT) AS income\n        , remark\n        , CAST(recent_change_date AS timestamp(3)) AS recent_change_date\n        , credit_reputation\n        , CAST(profit_margin AS BIGINT) AS profit_margin\n        , evaluation_period\n        , business_production_process\n        , recording_method\n        , business_scale\n        , location_ownership_form\n        , original_source\n        , inventory\n        , output\n        , primary_product\n        , business_type\n  FROM mysql_bpm_117.mercury.tbl_applicant_enterprise_income\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_applicant_enterprise_income"}, "model.dga_data_model.stg_mercury__tbl_css_eb_applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.mercury.tbl_css_eb_applicant"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "sync_date"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_css_eb_applicant"], "unique_id": "model.dga_data_model.stg_mercury__tbl_css_eb_applicant", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key='id'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n        id\r\n        , version\r\n        , CAST(sync_date AS timestamp(3)) AS sync_date\r\n        , newest\r\n        , id_ho_so\r\n        , chi_nhanh\r\n        , sync_by\r\n        , cif_num\r\n        , xep_hang\r\n        , full_name\r\n        , business_registration_number\r\n        , eb_application_id\r\n        , muc_dich_captd\r\n        , nganh_kt\r\n        , hook1\r\n        , nhom_kt_chinh\r\n        , hook2\r\n        , khu_vuc\r\n        , lhdn\r\n  FROM {{ source('mercury', 'tbl_css_eb_applicant') }}\r\n  {% if is_incremental() %}\r\n  WHERE sync_date > (SELECT MAX(sync_date) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_css_eb_applicant.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_css_eb_applicant.sql", "name": "stg_mercury__tbl_css_eb_applicant", "alias": "stg_mercury__tbl_css_eb_applicant", "checksum": {"name": "sha256", "checksum": "402484296666fcf78e6447b5f05d4782af1b35601e5b069554ae410259a67536"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_css_eb_applicant"]], "metrics": [], "description": "", "columns": {"eb_application_id": {"name": "eb_application_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "sync_date"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_css_eb_applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "sync_date"}, "tags": "mercury_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959753.2093718, "compiled_code": "\nWITH source AS(\n  SELECT\n        id\n        , version\n        , CAST(sync_date AS timestamp(3)) AS sync_date\n        , newest\n        , id_ho_so\n        , chi_nhanh\n        , sync_by\n        , cif_num\n        , xep_hang\n        , full_name\n        , business_registration_number\n        , eb_application_id\n        , muc_dich_captd\n        , nganh_kt\n        , hook1\n        , nhom_kt_chinh\n        , hook2\n        , khu_vuc\n        , lhdn\n  FROM mysql_bpm_117.mercury.tbl_css_eb_applicant\n  \n  WHERE sync_date > (SELECT MAX(sync_date) FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_css_eb_applicant)\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_css_eb_applicant"}, "model.dga_data_model.stg_mercury__tbl_doc_detail": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.mercury.tbl_doc_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_doc_detail"], "unique_id": "model.dga_data_model.stg_mercury__tbl_doc_detail", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n   \tid\r\n\t, version\r\n\t, sub_type\r\n\t, CAST(created_at AS timestamp(3)) AS created_at\r\n\t, newest\r\n\t, created_by\r\n\t, number_prop1\r\n\t, CAST(updated_at AS timestamp(3)) AS updated_at\r\n\t, CAST(updated_by AS timestamp(3)) AS updated_by\r\n\t, type\r\n\t, process_instance_id\r\n\t, doc_version\r\n\t, doc_template_id\r\n\t, doc_need_list_id\r\n\t, byte_prop1\r\n\t, draft_version\r\n\t, otp_verified\r\n\t, is_deleted\r\n\t, CAST(JSON_VALUE(data, 'lax $.i_totalCollateralKValue') AS VARCHAR)\r\n\t    AS total_collateral_kvalue\r\n\t, CAST(JSON_VALUE(data, 'lax $.i_totalCollateralValue') AS VARCHAR)\r\n\t    AS total_collateral_value\r\n\t, CAST(JSON_VALUE(data, 'lax $.duration') AS VARCHAR)\r\n\t    AS duration\r\n\t, CAST(JSON_VALUE(data, 'lax $.customerManagementCondition.commitmentAmount') AS VARCHAR)\r\n\t    AS ckdt_hmcs\r\n\t, CAST(JSON_VALUE(data, 'lax $.customerManagementCondition.minimumAmount') AS VARCHAR)\r\n\t    AS ckdt_month\r\n\t, CAST(JSON_VALUE(data, 'lax $.customerManagementCondition.commitmentAmountStr') AS VARCHAR)\r\n\t    AS ckdt_text\r\n\t, CAST(TRANSLATE(JSON_VALUE(data, 'lax $.cacException'),CHR(10) || CHR(13) || CHR(09), ' ') AS VARCHAR)\r\n\t    AS details\r\n\t, CAST(JSON_VALUE(data, 'lax $.approvalSuggestionStr') AS VARCHAR)\r\n\t    AS approval_suggestion\r\n\t, CAST(JSON_VALUE(data, 'lax $.rejectReason') AS VARCHAR) AS reject_reason\r\n\t, CAST(JSON_VALUE(data, 'lax $.maximumAmount') AS VARCHAR) AS maximum_amount\r\n  FROM {{ source('mercury', 'tbl_doc_detail') }}\r\n  WHERE newest = 1\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_doc_detail.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_doc_detail.sql", "name": "stg_mercury__tbl_doc_detail", "alias": "stg_mercury__tbl_doc_detail", "checksum": {"name": "sha256", "checksum": "5600e195005a9579008d73c0c7472ca1c61792800b9c0fb7ea694ca417699a1c"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_doc_detail"]], "metrics": [], "description": "", "columns": {"doc_need_list_id": {"name": "doc_need_list_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_doc_detail.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959753.2113664, "compiled_code": "\nWITH source AS (\n  SELECT\n   \tid\n\t, version\n\t, sub_type\n\t, CAST(created_at AS timestamp(3)) AS created_at\n\t, newest\n\t, created_by\n\t, number_prop1\n\t, CAST(updated_at AS timestamp(3)) AS updated_at\n\t, CAST(updated_by AS timestamp(3)) AS updated_by\n\t, type\n\t, process_instance_id\n\t, doc_version\n\t, doc_template_id\n\t, doc_need_list_id\n\t, byte_prop1\n\t, draft_version\n\t, otp_verified\n\t, is_deleted\n\t, CAST(JSON_VALUE(data, 'lax $.i_totalCollateralKValue') AS VARCHAR)\n\t    AS total_collateral_kvalue\n\t, CAST(JSON_VALUE(data, 'lax $.i_totalCollateralValue') AS VARCHAR)\n\t    AS total_collateral_value\n\t, CAST(JSON_VALUE(data, 'lax $.duration') AS VARCHAR)\n\t    AS duration\n\t, CAST(JSON_VALUE(data, 'lax $.customerManagementCondition.commitmentAmount') AS VARCHAR)\n\t    AS ckdt_hmcs\n\t, CAST(JSON_VALUE(data, 'lax $.customerManagementCondition.minimumAmount') AS VARCHAR)\n\t    AS ckdt_month\n\t, CAST(JSON_VALUE(data, 'lax $.customerManagementCondition.commitmentAmountStr') AS VARCHAR)\n\t    AS ckdt_text\n\t, CAST(TRANSLATE(JSON_VALUE(data, 'lax $.cacException'),CHR(10) || CHR(13) || CHR(09), ' ') AS VARCHAR)\n\t    AS details\n\t, CAST(JSON_VALUE(data, 'lax $.approvalSuggestionStr') AS VARCHAR)\n\t    AS approval_suggestion\n\t, CAST(JSON_VALUE(data, 'lax $.rejectReason') AS VARCHAR) AS reject_reason\n\t, CAST(JSON_VALUE(data, 'lax $.maximumAmount') AS VARCHAR) AS maximum_amount\n  FROM mysql_bpm_117.mercury.tbl_doc_detail\n  WHERE newest = 1\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_detail"}, "model.dga_data_model.stg_mercury__tbl_doc_detail_clean": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_detail"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_doc_detail_clean"], "unique_id": "model.dga_data_model.stg_mercury__tbl_doc_detail_clean", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n   \t  id\r\n    , version\r\n    , sub_type\r\n    , created_at\r\n    , newest\r\n    , number_prop1\r\n    , updated_at\r\n    , updated_by\r\n    , type\r\n    , process_instance_id\r\n    , created_by\r\n    , doc_version\r\n    , doc_template_id\r\n    , doc_need_list_id\r\n    , byte_prop1\r\n    , draft_version\r\n    , otp_verified\r\n    , is_deleted\r\n    , to_number(nvl(REPLACE(REPLACE(regexp_replace(CAST(total_collateral_kvalue AS VARCHAR2(200 CHAR)), '\\D'),'.',''),CHR(49824),''),0))\r\n        AS total_collateral_kvalue\r\n    , to_number(nvl(REPLACE(REPLACE(regexp_replace(CAST(total_collateral_value AS VARCHAR2(200 CHAR)), '\\D'),'.',''),CHR(49824),''),0))\r\n        AS total_collateral_value\r\n    , to_number(nvl(REPLACE(REPLACE(REPLACE(regexp_replace(CAST(duration AS VARCHAR2(200 CHAR)), '\\D'), '.', ''), CHR(49824), ''), CHR(32), ''), 0))\r\n        AS duration\r\n    , to_number(nvl(REPLACE(REPLACE(REPLACE(regexp_replace(CAST(ckdt_hmcs AS VARCHAR2(200 CHAR)), '\\D'), '.', ''), CHR(49824), ''), CHR(32), ''), 0))\r\n        AS ckdt_hmcs\r\n    , nvl(REPLACE(REPLACE(CAST(ckdt_month AS VARCHAR2(200 CHAR)),'.',''),CHR(49824),''),0)\r\n        AS ckdt_month\r\n    , CAST(ckdt_text AS VARCHAR2(200 CHAR)) AS ckdt_text\r\n    , CAST(details AS VARCHAR2(1000 CHAR)) AS details\r\n    , CAST(approval_suggestion AS VARCHAR2(200 CHAR)) AS approval_suggestion\r\n    , CAST(reject_reason AS VARCHAR2(200 CHAR)) AS reject_reason\r\n    , to_number(nvl(REPLACE(REPLACE(REPLACE(regexp_replace(CAST(maximum_amount AS VARCHAR2(200 CHAR)), '\\D'), '.', ''), CHR(49824), ''), CHR(32), ''), 0))\r\n        AS maximum_amount\r\n  FROM {{ ref('stg_mercury__tbl_doc_detail') }}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_doc_detail_clean.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_doc_detail_clean.sql", "name": "stg_mercury__tbl_doc_detail_clean", "alias": "stg_mercury__tbl_doc_detail_clean", "checksum": {"name": "sha256", "checksum": "881282ad81e98dfb28561853cba3ed96ddb0245b067e8815e5ca8f30331bf1c9"}, "tags": ["mercury_daily"], "refs": [["stg_mercury__tbl_doc_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "phuongnt89"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_doc_detail_clean.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "phuongnt89"}, "tags": "mercury_daily", "materialized": "table"}, "created_at": 1685959751.907885, "compiled_code": "\nWITH source AS (\n  SELECT\n   \t  id\n    , version\n    , sub_type\n    , created_at\n    , newest\n    , number_prop1\n    , updated_at\n    , updated_by\n    , type\n    , process_instance_id\n    , created_by\n    , doc_version\n    , doc_template_id\n    , doc_need_list_id\n    , byte_prop1\n    , draft_version\n    , otp_verified\n    , is_deleted\n    , to_number(nvl(REPLACE(REPLACE(regexp_replace(CAST(total_collateral_kvalue AS VARCHAR2(200 CHAR)), '\\D'),'.',''),CHR(49824),''),0))\n        AS total_collateral_kvalue\n    , to_number(nvl(REPLACE(REPLACE(regexp_replace(CAST(total_collateral_value AS VARCHAR2(200 CHAR)), '\\D'),'.',''),CHR(49824),''),0))\n        AS total_collateral_value\n    , to_number(nvl(REPLACE(REPLACE(REPLACE(regexp_replace(CAST(duration AS VARCHAR2(200 CHAR)), '\\D'), '.', ''), CHR(49824), ''), CHR(32), ''), 0))\n        AS duration\n    , to_number(nvl(REPLACE(REPLACE(REPLACE(regexp_replace(CAST(ckdt_hmcs AS VARCHAR2(200 CHAR)), '\\D'), '.', ''), CHR(49824), ''), CHR(32), ''), 0))\n        AS ckdt_hmcs\n    , nvl(REPLACE(REPLACE(CAST(ckdt_month AS VARCHAR2(200 CHAR)),'.',''),CHR(49824),''),0)\n        AS ckdt_month\n    , CAST(ckdt_text AS VARCHAR2(200 CHAR)) AS ckdt_text\n    , CAST(details AS VARCHAR2(1000 CHAR)) AS details\n    , CAST(approval_suggestion AS VARCHAR2(200 CHAR)) AS approval_suggestion\n    , CAST(reject_reason AS VARCHAR2(200 CHAR)) AS reject_reason\n    , to_number(nvl(REPLACE(REPLACE(REPLACE(regexp_replace(CAST(maximum_amount AS VARCHAR2(200 CHAR)), '\\D'), '.', ''), CHR(49824), ''), CHR(32), ''), 0))\n        AS maximum_amount\n  FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_detail\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_detail_clean"}, "model.dga_data_model.stg_mercury__tbl_doc_need_list": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.mercury.tbl_doc_need_list"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_doc_need_list"], "unique_id": "model.dga_data_model.stg_mercury__tbl_doc_need_list", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key='id'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n    id\r\n    , version\r\n    , query_params\r\n    , CAST(created_at AS timestamp(3)) AS created_at\r\n    , doc_template_code\r\n    , name\r\n    , process_instance_id\r\n    , upload_log_id\r\n    , status\r\n    , is_deleted\r\n    , CAST(deleted_at AS timestamp(3)) AS deleted_at\r\n    , string_prop1\r\n    , otp_required\r\n    , props\r\n    , override_upload_log_id\r\n    , can_auto_generate\r\n    , path\r\n    , ord\r\n    , is_processing\r\n    , override_upload_log_ids\r\n    , generate_error_content\r\n    , eb_request_id\r\n  FROM {{ source('mercury', 'tbl_doc_need_list') }} a\r\n  {% if is_incremental() %}\r\n  WHERE created_at > (SELECT MAX(created_at) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_doc_need_list.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_doc_need_list.sql", "name": "stg_mercury__tbl_doc_need_list", "alias": "stg_mercury__tbl_doc_need_list", "checksum": {"name": "sha256", "checksum": "222ec5bfc1c53d102d1728be27b3ff521bf6352ec3700490306f66125450d635"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_doc_need_list"]], "metrics": [], "description": "", "columns": {"process_instance_id": {"name": "process_instance_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_doc_need_list.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959753.2133796, "compiled_code": "\nWITH source AS(\n  SELECT\n    id\n    , version\n    , query_params\n    , CAST(created_at AS timestamp(3)) AS created_at\n    , doc_template_code\n    , name\n    , process_instance_id\n    , upload_log_id\n    , status\n    , is_deleted\n    , CAST(deleted_at AS timestamp(3)) AS deleted_at\n    , string_prop1\n    , otp_required\n    , props\n    , override_upload_log_id\n    , can_auto_generate\n    , path\n    , ord\n    , is_processing\n    , override_upload_log_ids\n    , generate_error_content\n    , eb_request_id\n  FROM mysql_bpm_117.mercury.tbl_doc_need_list a\n  \n  WHERE created_at > (SELECT MAX(created_at) FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_need_list)\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_need_list"}, "model.dga_data_model.stg_mercury__tbl_doc_no_hist": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.mercury.tbl_doc_no_hist"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_doc_no_hist"], "unique_id": "model.dga_data_model.stg_mercury__tbl_doc_no_hist", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key='id'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n    id\r\n    , version\r\n    , sub_type\r\n    , CAST(created_at AS timestamp(3)) AS created_at\r\n    , number_prop1\r\n    , type\r\n    , process_instance_id\r\n    , created_by\r\n    , inc_num\r\n    , number_prop2\r\n    , composite_doc_no\r\n    , doc_template_id\r\n    , doc_need_list_id\r\n    , CAST(approve_date AS timestamp(3)) AS approve_date\r\n    , sub_num\r\n  FROM {{ source('mercury', 'tbl_doc_no_hist') }}\r\n  {% if is_incremental() %}\r\n  WHERE created_at > (SELECT MAX(created_at) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_doc_no_hist.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_doc_no_hist.sql", "name": "stg_mercury__tbl_doc_no_hist", "alias": "stg_mercury__tbl_doc_no_hist", "checksum": {"name": "sha256", "checksum": "ea125173f1948b6f6cbf53d9578115d1800ab63954ae558d1192f084766a0299"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_doc_no_hist"]], "metrics": [], "description": "", "columns": {"doc_need_list_id": {"name": "doc_need_list_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_doc_no_hist.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959753.215355, "compiled_code": "\nWITH source AS(\n  SELECT\n    id\n    , version\n    , sub_type\n    , CAST(created_at AS timestamp(3)) AS created_at\n    , number_prop1\n    , type\n    , process_instance_id\n    , created_by\n    , inc_num\n    , number_prop2\n    , composite_doc_no\n    , doc_template_id\n    , doc_need_list_id\n    , CAST(approve_date AS timestamp(3)) AS approve_date\n    , sub_num\n  FROM mysql_bpm_117.mercury.tbl_doc_no_hist\n  \n  WHERE created_at > (SELECT MAX(created_at) FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_no_hist)\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_no_hist"}, "model.dga_data_model.stg_mercury__tbl_eb_applicant": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.mercury.tbl_eb_applicant"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_eb_applicant"], "unique_id": "model.dga_data_model.stg_mercury__tbl_eb_applicant", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key='id'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n   \tid\r\n    , version\r\n    , CAST(created_at AS timestamp(3)) AS created_at\r\n    , process_instance_id\r\n    , created_by\r\n    , cif_num\r\n    , full_name\r\n    , eb_application_id\r\n    , business_registration_number\r\n    , branch_name\r\n    , composite_status\r\n    , props\r\n  FROM {{ source('mercury', 'tbl_eb_applicant') }}\r\n  {% if is_incremental() %}\r\n  WHERE created_at > (SELECT MAX(created_at) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_eb_applicant.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_eb_applicant.sql", "name": "stg_mercury__tbl_eb_applicant", "alias": "stg_mercury__tbl_eb_applicant", "checksum": {"name": "sha256", "checksum": "420abf14cd6b0c6948b53e987079b7a7fed8407a3ea70294ae7fb6e2bdeebc4b"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_eb_applicant"]], "metrics": [], "description": "", "columns": {"eb_application_id": {"name": "eb_application_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_eb_applicant.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959753.2173674, "compiled_code": "\nWITH source AS(\n  SELECT\n   \tid\n    , version\n    , CAST(created_at AS timestamp(3)) AS created_at\n    , process_instance_id\n    , created_by\n    , cif_num\n    , full_name\n    , eb_application_id\n    , business_registration_number\n    , branch_name\n    , composite_status\n    , props\n  FROM mysql_bpm_117.mercury.tbl_eb_applicant\n  \n  WHERE created_at > (SELECT MAX(created_at) FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_applicant)\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_applicant"}, "model.dga_data_model.stg_mercury__tbl_eb_application": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.mercury.tbl_eb_application"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["mercury_daily"], "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "mercury", "stg_mercury__tbl_eb_application"], "unique_id": "model.dga_data_model.stg_mercury__tbl_eb_application", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n        unique_key='id'\r\n    )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n    id\r\n    , version\r\n    , css_sync_status\r\n    , is_deleted\r\n    , los_app_ref_num\r\n    , industry\r\n    , customer_segment\r\n    , collateral_count\r\n    , process_instance_id\r\n    , deleted_by\r\n    , other_industry\r\n    , limit_type\r\n    , approval_minutes_type\r\n    , css_id\r\n    , CAST(deleted_at AS timestamp(3)) AS deleted_at\r\n    , CAST(created_at AS timestamp(3)) AS created_at\r\n    , editing_purpose\r\n    , approval_suggestion\r\n    , limit_sub_type\r\n    , expire_time\r\n    , created_by\r\n    , status\r\n    , los_sync_status\r\n    , area\r\n    , criteriamet_flg\r\n    , roles\r\n    , composite_status\r\n  FROM {{ source('mercury', 'tbl_eb_application') }}\r\n  {% if is_incremental() %}\r\n  WHERE created_at > (SELECT MAX(created_at) FROM {{ this }})\r\n  {% endif %}\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\mercury\\stg_mercury__tbl_eb_application.sql", "original_file_path": "models\\staging\\mercury\\stg_mercury__tbl_eb_application.sql", "name": "stg_mercury__tbl_eb_application", "alias": "stg_mercury__tbl_eb_application", "checksum": {"name": "sha256", "checksum": "d2f0a85520ad3484fabc30438649b73d92e3c102d0cd0095a2570c42497cdec4"}, "tags": ["mercury_daily"], "refs": [], "sources": [["mercury", "tbl_eb_application"]], "metrics": [], "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "phuongnt89", "date_column": "created_at"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\mercury\\source_mercury.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\stg_mercury__tbl_eb_application.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "created_at"}, "tags": "mercury_daily", "materialized": "incremental", "unique_key": "id"}, "created_at": 1685959753.2183661, "compiled_code": "\nWITH source AS(\n  SELECT\n    id\n    , version\n    , css_sync_status\n    , is_deleted\n    , los_app_ref_num\n    , industry\n    , customer_segment\n    , collateral_count\n    , process_instance_id\n    , deleted_by\n    , other_industry\n    , limit_type\n    , approval_minutes_type\n    , css_id\n    , CAST(deleted_at AS timestamp(3)) AS deleted_at\n    , CAST(created_at AS timestamp(3)) AS created_at\n    , editing_purpose\n    , approval_suggestion\n    , limit_sub_type\n    , expire_time\n    , created_by\n    , status\n    , los_sync_status\n    , area\n    , criteriamet_flg\n    , roles\n    , composite_status\n  FROM mysql_bpm_117.mercury.tbl_eb_application\n  \n  WHERE created_at > (SELECT MAX(created_at) FROM \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_application)\n  \n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_application"}, "model.dga_data_model.stg__card_acnt_contract_plus_bk": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dga_data_model.create_index"], "nodes": ["model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_appl_product", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.int_way4__client", "model.dga_data_model.stg_landing__card_contr_status", "model.dga_data_model.stg_landing__card_acnt_contract"]}, "config": {"enabled": true, "alias": "stg__card_acnt_contract_plus_bk", "schema": "staging", "database": null, "tags": [], "meta": {}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [{"sql": "{{ create_index( this, \"id, acnt_contract__oid\") }}", "transaction": true, "index": null}], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "test", "stg__card_acnt_contract_plus_bk"], "unique_id": "model.dga_data_model.stg__card_acnt_contract_plus_bk", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    post_hook= '{{ create_index( this, \"id, acnt_contract__oid\") }}' ,\r\n    alias = 'stg__card_acnt_contract_plus_bk'\r\n  )\r\n}}\r\nWITH contract AS (\r\n  SELECT\r\n      a.etl_date\r\n    , a.id\r\n    , a.acnt_contract__id\r\n    , a.acnt_contract__oid\r\n    , a.liab_contract\r\n    , a.ccat\r\n    , a.branch\r\n    , a.contract_number\r\n    , a.contract_name\r\n    , a.channel\r\n    , C.channel_desc\r\n    , a.product_code AS product_code_internal\r\n    , b.product_code\r\n    , b.name AS product_name\r\n    , b.product_group\r\n    , a.client_id AS customer_id_internal\r\n    , d.customer_number\r\n    , decode(a.auth_limit_amount, 0, f.auth_limit_amount, a.auth_limit_amount) AS auth_limit_amount\r\n    , a.date_open\r\n    , a.date_expire\r\n    , a.last_billing_date\r\n    , a.next_billing_date\r\n    , a.contract_status\r\n    , e.name AS contract_status_name\r\n    , a.tr_first_nam\r\n    , a.tr_last_nam\r\n    , a.cycle_length\r\n    , a.interval_type\r\n    , a.is_ready\r\n    , a.billing_contract\r\n    , a.amnd_date\r\n    , a.rbs_number\r\n    , a.bpm_loan_id\r\n    , a.card_sales_channel\r\n    , a.add_info_01\r\n    , a.add_info_02\r\n    , a.add_info_03\r\n    , a.add_info_04\r\n    , a.los_id\r\n    , a.card_expire\r\n    , a.con_cat\r\n    , CASE\r\n        WHEN b.product_group='ISSDEB' THEN CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\r\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\r\n        WHEN b.product_group='ISSCRD' THEN CASE WHEN SUBSTR(a.contract_number,1,3)='999' THEN 'OTHER' ELSE 'CREDIT_CARD' END\r\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\r\n        WHEN b.product_group='ACQRET' THEN 'DEVICE'\r\n        ELSE 'OTHER'\r\n      END AS type_of_card\r\n    , CASE\r\n        WHEN b.product_group='ISSDEB' THEN\r\n          CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\r\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\r\n        WHEN b.product_group='ISSCRD' THEN\r\n          CASE\r\n            WHEN REGEXP_LIKE(a.contract_number,'L') THEN 'LIAB'\r\n            WHEN REGEXP_LIKE(a.contract_number,'-[WOBU]-') THEN 'LENDINGS'\r\n            ELSE 'CREDIT_CARD'\r\n          END\r\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\r\n        WHEN b.product_group='ACQRET' THEN 'DEVICE' ELSE 'OTHER'\r\n      END AS type_of_contract\r\n    , a.f_i\r\n    , a.amnd_state\r\n  FROM\r\n    {{ ref('stg_landing__card_acnt_contract')}} a\r\n  LEFT JOIN {{ ref('stg_landing__card_appl_product')}} b\r\n    ON a.product_code = b.internal_code\r\n      AND a.ccat = b.ccat\r\n      AND a.con_cat = b.con_cat\r\n      AND b.amnd_state = 'A'\r\n  LEFT JOIN {{ ref('stg_landing__df_card_channel')}} C ON a.channel = C.channel_code\r\n  LEFT JOIN {{ ref('int_way4__client')}} d ON a.client_id = d.id\r\n  LEFT JOIN {{ ref('stg_landing__card_contr_status')}} e\r\n    ON a.contract_status = e.id\r\n      AND a.con_cat = e.con_cat\r\n      AND e.amnd_state = 'A'\r\n  LEFT JOIN {{ ref ('stg_landing__card_acnt_contract')}} f\r\n    ON a.acnt_contract__oid = f.id\r\n      AND a.ccat = f.ccat\r\n      AND a.con_cat = f.con_cat\r\n      AND f.amnd_state = 'A'\r\n  WHERE\r\n    a.amnd_state = 'A'\r\n)\r\nSELECT * FROM contract", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\test\\stg__card_acnt_contract_plus_bk.sql", "original_file_path": "models\\staging\\test\\stg__card_acnt_contract_plus_bk.sql", "name": "stg__card_acnt_contract_plus_bk", "alias": "stg__card_acnt_contract_plus_bk", "checksum": {"name": "sha256", "checksum": "3b6e53b4499a7a1f12f1eed38b14e4b8be145c907240fea75db75ebe20263ba0"}, "tags": [], "refs": [["stg_landing__card_acnt_contract"], ["stg_landing__card_appl_product"], ["stg_landing__df_card_channel"], ["int_way4__client"], ["stg_landing__card_contr_status"], ["stg_landing__card_acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\test\\stg__card_acnt_contract_plus_bk.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table", "alias": "stg__card_acnt_contract_plus_bk", "post-hook": ["{{ create_index( this, \"id, acnt_contract__oid\") }}"]}, "created_at": 1685959751.9288845, "compiled_code": "\nWITH contract AS (\n  SELECT\n      a.etl_date\n    , a.id\n    , a.acnt_contract__id\n    , a.acnt_contract__oid\n    , a.liab_contract\n    , a.ccat\n    , a.branch\n    , a.contract_number\n    , a.contract_name\n    , a.channel\n    , C.channel_desc\n    , a.product_code AS product_code_internal\n    , b.product_code\n    , b.name AS product_name\n    , b.product_group\n    , a.client_id AS customer_id_internal\n    , d.customer_number\n    , decode(a.auth_limit_amount, 0, f.auth_limit_amount, a.auth_limit_amount) AS auth_limit_amount\n    , a.date_open\n    , a.date_expire\n    , a.last_billing_date\n    , a.next_billing_date\n    , a.contract_status\n    , e.name AS contract_status_name\n    , a.tr_first_nam\n    , a.tr_last_nam\n    , a.cycle_length\n    , a.interval_type\n    , a.is_ready\n    , a.billing_contract\n    , a.amnd_date\n    , a.rbs_number\n    , a.bpm_loan_id\n    , a.card_sales_channel\n    , a.add_info_01\n    , a.add_info_02\n    , a.add_info_03\n    , a.add_info_04\n    , a.los_id\n    , a.card_expire\n    , a.con_cat\n    , CASE\n        WHEN b.product_group='ISSDEB' THEN CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\n        WHEN b.product_group='ISSCRD' THEN CASE WHEN SUBSTR(a.contract_number,1,3)='999' THEN 'OTHER' ELSE 'CREDIT_CARD' END\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\n        WHEN b.product_group='ACQRET' THEN 'DEVICE'\n        ELSE 'OTHER'\n      END AS type_of_card\n    , CASE\n        WHEN b.product_group='ISSDEB' THEN\n          CASE WHEN UPPER(b.name) LIKE '%PREPAID%' THEN 'PREPAID_CARD' ELSE 'DEBIT_CARD' END\n        WHEN b.product_group='ISSCORP' THEN 'CREDIT_CARD'\n        WHEN b.product_group='ISSCRD' THEN\n          CASE\n            WHEN REGEXP_LIKE(a.contract_number,'L') THEN 'LIAB'\n            WHEN REGEXP_LIKE(a.contract_number,'-[WOBU]-') THEN 'LENDINGS'\n            ELSE 'CREDIT_CARD'\n          END\n        WHEN b.product_group='ISS_DB' THEN 'DEBIT_CARD'\n        WHEN b.product_group='ACQRET' THEN 'DEVICE' ELSE 'OTHER'\n      END AS type_of_contract\n    , a.f_i\n    , a.amnd_state\n  FROM\n    \"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract a\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_appl_product b\n    ON a.product_code = b.internal_code\n      AND a.ccat = b.ccat\n      AND a.con_cat = b.con_cat\n      AND b.amnd_state = 'A'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__df_card_channel C ON a.channel = C.channel_code\n  LEFT JOIN \"oracle_dgaworkzone\".int.int_way4__client d ON a.client_id = d.id\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_contr_status e\n    ON a.contract_status = e.id\n      AND a.con_cat = e.con_cat\n      AND e.amnd_state = 'A'\n  LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract f\n    ON a.acnt_contract__oid = f.id\n      AND a.ccat = f.ccat\n      AND a.con_cat = f.con_cat\n      AND f.amnd_state = 'A'\n  WHERE\n    a.amnd_state = 'A'\n)\nSELECT * FROM contract", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__card_acnt_contract_plus_bk"}, "model.dga_data_model.stg__ddft_transaction_map_ibmb": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.daily_dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl", "source.dga_data_model.daily_bulanding.bb_transfer_history@dga_read_bulanding_dbl", "source.dga_data_model.daily_bulanding.bb_ttr_history@dga_read_bulanding_dbl", "model.dga_data_model.stg_dwh__demanddeposit_transaction001", "model.dga_data_model.stg_landing__demanddeposit_master002"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "test", "stg__ddft_transaction_map_ibmb"], "unique_id": "model.dga_data_model.stg__ddft_transaction_map_ibmb", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n  )\r\n}}\r\nWITH t AS (\r\n        SELECT\r\n        CAST(core_sn AS NVARCHAR2(130)) as core_sn,\r\n        user_id AS user_id_ibmb,\r\n        CAST(rollout_account_no  AS NVARCHAR2(130)) as rollout_account_no,\r\n        CAST(rollout_account_name AS NVARCHAR2(130))   rollout_account_name,\r\n        CAST(beneficiary_account_no AS NVARCHAR2(130)) beneficiary_account_no,\r\n        CAST(beneficiary_name AS NVARCHAR2(130))       beneficiary_name,\r\n        CAST(BENEFICIARY_BANK_ID AS NVARCHAR2(130)) as BENEFICIARY_BANK_ID,\r\n        CAST(BENEFICIARY_BANK_NAME AS NVARCHAR2(130)) as BENEFICIARY_BANK_NAME,\r\n        CAST(REMARK AS NVARCHAR2(1300)) AS remark_ibmb,\r\n        amount,\r\n        fee\r\n    FROM\r\n        {{ source('daily_dwh', 'ebft_bc_transfer_history @dga_read_dwhpro_dbl') }}\r\n    WHERE\r\n        tran_date = {{ var('julian_date')}}\r\n    UNION ALL\r\n    SELECT\r\n        CAST(core_sn AS NVARCHAR2(130)),\r\n        user_id,\r\n        CAST(rollout_account_number AS NVARCHAR2(130)),\r\n        CAST(rollout_acct_name AS NVARCHAR2(130)),\r\n        CAST(beneficiary_account_number AS NVARCHAR2(130)),\r\n        CAST(beneficiary_name AS NVARCHAR2(130)),\r\n        CAST(BENEFICIARY_BRANCH_CODE AS NVARCHAR2(130)),\r\n        CAST(BENEFICIARY_BANK_NAME AS NVARCHAR2(130)),\r\n        CAST(REMARK AS NVARCHAR2(1300)) AS remark,\r\n        amount,\r\n        FEE_AMOUNT\r\n    FROM\r\n        {{ source('daily_bulanding', 'bb_transfer_history@dga_read_bulanding_dbl')}}\r\n    WHERE\r\n        etl_date = {{ var('julian_date')}}\r\n    UNION ALL\r\n    SELECT\r\n      CAST(core_sn AS NVARCHAR2(130)),\r\n      user_id,\r\n      CAST(rollout_account_number AS NVARCHAR2(130)),\r\n      CAST(rollout_acct_name AS NVARCHAR2(130)),\r\n      CAST(beneficiary_account_number AS NVARCHAR2(130)),\r\n      CAST(bnfc_name AS NVARCHAR2(130)),\r\n      CAST(bnfc_bank_id AS NVARCHAR2(130)),\r\n      CAST(bnfc_bank_name AS NVARCHAR2(130)),\r\n      CAST(remark AS NVARCHAR2(1300)) AS remark,\r\n      to_number(amount_convert) AS amount_convert,\r\n      total_fee\r\n    FROM\r\n      {{ source('daily_bulanding', 'bb_ttr_history@dga_read_bulanding_dbl')}} a\r\n    WHERE\r\n      status = 'SUCC'\r\n      AND service_type = 'TTR'\r\n)\r\n, t2 as (\r\nselect distinct * from t\r\nUNPIVOT (\r\n    value\r\n    for value_type in ( amount AS 'amount', fee as 'fee')\r\n)\r\n)\r\nSELECT\r\n      dt.txn_id\r\n    , dt.trn_ref_no\r\n    , dt.src_ref_no\r\n    , dt.sub_ref_no\r\n    , dt.affect_code\r\n    , dt.trn_sk\r\n    , dt.trn_time\r\n    , dt.trn_date\r\n    , dt.value_date\r\n    , dt.currency\r\n    , dt.dorc_ind\r\n    , dt.acy_amount\r\n    , dt.exchange_rate\r\n    , dt.lcy_amount\r\n    , dt.product_sk\r\n    , dt.status\r\n    , dt.channel\r\n    , dt.channel_trn\r\n    , dt.ac_branch_sk\r\n    , dt.trn_branch_sk\r\n    , dt.account_no_sk\r\n    , dt.customer_sk\r\n    , dt.gl_code_sk\r\n    , dt.maker_sk\r\n    , dt.checker_sk\r\n    , COALESCE(CAST(dt.related_person AS NVARCHAR2(254)), th.rollout_account_name) AS related_person\r\n    , COALESCE(cast(dt.related_account as NVARCHAR2(254)), th.beneficiary_account_no) AS related_account\r\n    , dt.trf_sys\r\n    , dt.trf_bank_sk\r\n    , dt.remark\r\n    , dt.seq_number\r\n    , dt.posting_order\r\n    , dt.before_balance\r\n    , dt.current_balance\r\n    , dt.user_id\r\n    , dt.eqv_tramt\r\n    , th.*\r\n    , acc.account_no\r\nFROM\r\n    {{ ref('stg_dwh__demanddeposit_transaction001')}} dt\r\n    LEFT JOIN {{ ref('stg_landing__demanddeposit_master002')}} acc on dt.ACCOUNT_NO_SK = acc.ACCOUNT_NO_SK\r\n    LEFT JOIN t2                                        th ON dt.seq_number = th.core_sn\r\n    AND to_number(is_number(th.rollout_account_no)) = acc.ACCOUNT_NO\r\n    AND dt.lcy_amount = th.VALUE\r\nWHERE\r\n        dt.trn_date = {{ var('julian_date')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\test\\stg__ddft_transaction_map_ibmb.sql", "original_file_path": "models\\staging\\test\\stg__ddft_transaction_map_ibmb.sql", "name": "stg__ddft_transaction_map_ibmb", "alias": "stg__ddft_transaction_map_ibmb", "checksum": {"name": "sha256", "checksum": "90db0fe14e4dc5fa25335d13245a8ea867bacc2541e563cdc4ddeb7c2b1a72e1"}, "tags": [], "refs": [["stg_dwh__demanddeposit_transaction001"], ["stg_landing__demanddeposit_master002"]], "sources": [["daily_dwh", "ebft_bc_transfer_history @dga_read_dwhpro_dbl"], ["daily_bulanding", "bb_transfer_history@dga_read_bulanding_dbl"], ["daily_bulanding", "bb_ttr_history@dga_read_bulanding_dbl"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\test\\stg__ddft_transaction_map_ibmb.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "materialized": "table"}, "created_at": 1685959751.9369116, "compiled_code": "\nWITH t AS (\n        SELECT\n        CAST(core_sn AS NVARCHAR2(130)) as core_sn,\n        user_id AS user_id_ibmb,\n        CAST(rollout_account_no  AS NVARCHAR2(130)) as rollout_account_no,\n        CAST(rollout_account_name AS NVARCHAR2(130))   rollout_account_name,\n        CAST(beneficiary_account_no AS NVARCHAR2(130)) beneficiary_account_no,\n        CAST(beneficiary_name AS NVARCHAR2(130))       beneficiary_name,\n        CAST(BENEFICIARY_BANK_ID AS NVARCHAR2(130)) as BENEFICIARY_BANK_ID,\n        CAST(BENEFICIARY_BANK_NAME AS NVARCHAR2(130)) as BENEFICIARY_BANK_NAME,\n        CAST(REMARK AS NVARCHAR2(1300)) AS remark_ibmb,\n        amount,\n        fee\n    FROM\n        oracle_dwh.dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl\n    WHERE\n        tran_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n    UNION ALL\n    SELECT\n        CAST(core_sn AS NVARCHAR2(130)),\n        user_id,\n        CAST(rollout_account_number AS NVARCHAR2(130)),\n        CAST(rollout_acct_name AS NVARCHAR2(130)),\n        CAST(beneficiary_account_number AS NVARCHAR2(130)),\n        CAST(beneficiary_name AS NVARCHAR2(130)),\n        CAST(BENEFICIARY_BRANCH_CODE AS NVARCHAR2(130)),\n        CAST(BENEFICIARY_BANK_NAME AS NVARCHAR2(130)),\n        CAST(REMARK AS NVARCHAR2(1300)) AS remark,\n        amount,\n        FEE_AMOUNT\n    FROM\n        oracle_bulanding.df_2.bb_transfer_history@dga_read_bulanding_dbl\n    WHERE\n        etl_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))\n    UNION ALL\n    SELECT\n      CAST(core_sn AS NVARCHAR2(130)),\n      user_id,\n      CAST(rollout_account_number AS NVARCHAR2(130)),\n      CAST(rollout_acct_name AS NVARCHAR2(130)),\n      CAST(beneficiary_account_number AS NVARCHAR2(130)),\n      CAST(bnfc_name AS NVARCHAR2(130)),\n      CAST(bnfc_bank_id AS NVARCHAR2(130)),\n      CAST(bnfc_bank_name AS NVARCHAR2(130)),\n      CAST(remark AS NVARCHAR2(1300)) AS remark,\n      to_number(amount_convert) AS amount_convert,\n      total_fee\n    FROM\n      oracle_bulanding.df_2.bb_ttr_history@dga_read_bulanding_dbl a\n    WHERE\n      status = 'SUCC'\n      AND service_type = 'TTR'\n)\n, t2 as (\nselect distinct * from t\nUNPIVOT (\n    value\n    for value_type in ( amount AS 'amount', fee as 'fee')\n)\n)\nSELECT\n      dt.txn_id\n    , dt.trn_ref_no\n    , dt.src_ref_no\n    , dt.sub_ref_no\n    , dt.affect_code\n    , dt.trn_sk\n    , dt.trn_time\n    , dt.trn_date\n    , dt.value_date\n    , dt.currency\n    , dt.dorc_ind\n    , dt.acy_amount\n    , dt.exchange_rate\n    , dt.lcy_amount\n    , dt.product_sk\n    , dt.status\n    , dt.channel\n    , dt.channel_trn\n    , dt.ac_branch_sk\n    , dt.trn_branch_sk\n    , dt.account_no_sk\n    , dt.customer_sk\n    , dt.gl_code_sk\n    , dt.maker_sk\n    , dt.checker_sk\n    , COALESCE(CAST(dt.related_person AS NVARCHAR2(254)), th.rollout_account_name) AS related_person\n    , COALESCE(cast(dt.related_account as NVARCHAR2(254)), th.beneficiary_account_no) AS related_account\n    , dt.trf_sys\n    , dt.trf_bank_sk\n    , dt.remark\n    , dt.seq_number\n    , dt.posting_order\n    , dt.before_balance\n    , dt.current_balance\n    , dt.user_id\n    , dt.eqv_tramt\n    , th.*\n    , acc.account_no\nFROM\n    \"oracle_dgaworkzone\".staging.stg_dwh__demanddeposit_transaction001 dt\n    LEFT JOIN \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002 acc on dt.ACCOUNT_NO_SK = acc.ACCOUNT_NO_SK\n    LEFT JOIN t2                                        th ON dt.seq_number = th.core_sn\n    AND to_number(is_number(th.rollout_account_no)) = acc.ACCOUNT_NO\n    AND dt.lcy_amount = th.VALUE\nWHERE\n        dt.trn_date = to_number(to_char(to_date(to_number(to_char(sysdate - 1, 'YYYYMMDD')), 'YYYYMMDD'), 'YYYYDDD'))", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg__ddft_transaction_map_ibmb"}, "model.dga_data_model.test_los__categories_run": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.staging.stg_los__categories_test"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "test", "test_los__categories_run"], "unique_id": "model.dga_data_model.test_los__categories_run", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  categoryid\r\n, bank_id\r\n, remarks\r\n, categorycode\r\n, categorytype\r\n, value\r\n, allowmodify\r\n, rating\r\n, ratingtype\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, del_flg\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('staging', 'stg_los__categories_test') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\test\\test_los__categories_run.sql", "original_file_path": "models\\staging\\test\\test_los__categories_run.sql", "name": "test_los__categories_run", "alias": "test_los__categories_run", "checksum": {"name": "sha256", "checksum": "57039b44c9b5ed15a49837822114c418d6935fb2c8a722e6a0ac6466a5c62872"}, "tags": ["test_los"], "refs": [], "sources": [["staging", "stg_los__categories_test"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\test\\test_case.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\test\\test_los__categories_run.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental"}, "created_at": 1685959753.2353666, "compiled_code": "\nWITH source AS(\nSELECT  categoryid\n, bank_id\n, remarks\n, categorycode\n, categorytype\n, value\n, allowmodify\n, rating\n, ratingtype\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, del_flg\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_dgaworkzone.staging.stg_los__categories_test\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.test_los__categories_run)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.test_los__categories_run"}, "model.dga_data_model.test_los__corpapplimitdetails_run": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.staging.stg_los__corpapplimitdetails_test"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "test", "test_los__corpapplimitdetails_run"], "unique_id": "model.dga_data_model.test_los__corpapplimitdetails_run", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  corpapplimitdetailsid\r\n, syndfacilityrefno\r\n, syndfacilitydesc\r\n, agentbankcode\r\n, agentbranchcode\r\n, availableperiodmonths\r\n, availableperioddays\r\n, totalsyndicationlimit\r\n, totalsyndicationlimitccy\r\n, corpappentitydetailsid\r\n, limitclassification\r\n, limitcategory\r\n, purposecode\r\n, limitdescription\r\n, amtderivedchildflg\r\n, netlimitapplicableflg\r\n, existinglimit\r\n, proposedlimit\r\n, existingnetlimit\r\n, existinggrosslimit\r\n, proposednetlimit\r\n, proposedgrosslimit\r\n, existinglimitccy\r\n, proposedlimitccy\r\n, existingnetlimitccy\r\n, existinggrosslimitccy\r\n, proposednetlimitccy\r\n, proposedgrosslimitccy\r\n, limitshared\r\n,  cast(effectivedate as timestamp(3)) as effectivedate\r\n, limittermdays\r\n, limittermmonths\r\n,  cast(expirydate as timestamp(3)) as expirydate\r\n,  cast(limitreviewdate as timestamp(3)) as limitreviewdate\r\n,  cast(availabilityenddate as timestamp(3)) as availabilityenddate\r\n, revolvingflg\r\n, committedflg\r\n, indemnityheldflg\r\n, accountsofficer\r\n, primarysrcrepayment\r\n, secondarysrcrepayment\r\n, syndicationflg\r\n, limitstatus\r\n, remarks\r\n, sncdetailid\r\n, underwritingamount\r\n, underwritingamountccy\r\n, underwritingamounthome\r\n, takeholdamount\r\n, takeholdamountccy\r\n, takeholdamounthome\r\n, underwritingamounthomeccy\r\n, takeholdamounthomeccy\r\n, agent\r\n, participant\r\n, underwriter\r\n, isdeleted\r\n, limitrefno\r\n, parentlimitrefno\r\n, proposedlimitinhomeccy\r\n, limitccy\r\n, proposedlimitinlimitccy\r\n, relationshiplevel\r\n, approvedlimit\r\n, approvedlimitccy\r\n, approvedlimithomeccy\r\n, approvedlimitinlimitccy\r\n, approvednetlimit\r\n, approvednetlimitccy\r\n, approvedgrosslimit\r\n, approvedgrosslimitccy\r\n, drawingpwrind\r\n, drawingpwrpcnt\r\n, drawingpwrretained\r\n,  cast(offerletterreceiveddate as timestamp(3)) as offerletterreceiveddate\r\n, offerletterreceived\r\n, intratetablecode\r\n, priorityloan\r\n, ispapfield\r\n, routetostep\r\n, routingreasoncode\r\n, papagent\r\n, limitdecision\r\n, limitdecisioncode\r\n, limitremarks\r\n, dlod\r\n, dlodlimitclassification\r\n, dlodlimitcategory\r\n, existingdaylightlimit\r\n, existingdaylightcurrency\r\n, proposeddaylightlimit\r\n, proposeddaylightcurrency\r\n, dlodlimitstatus\r\n, limitidprefix\r\n, limitidsuffix\r\n, applnumber\r\n,  cast(offerlettersentdate as timestamp(3)) as offerlettersentdate\r\n, bookingstatus\r\n, accountfeesdr\r\n, lastapprovedlimit\r\n, partlimitstatus\r\n, snapshot\r\n, bank_id\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, versionnumber\r\n, islimitadded\r\n, existinglimithomeccy\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\n, silverlakebranchcode\r\n, officercode\r\n, availablebalanceindicator\r\n, producttype\r\n, paymentcode\r\n, contractnumber\r\n, contractsignedby\r\n, contractdelegatedby\r\n, unsecuredlimit\r\n, totalderivedvalue\r\n, supportlimit1\r\n, supportlimit2\r\n, securedlimit\r\n,  cast(contractdate as timestamp(3)) as contractdate\r\n, paymentfrequencydays\r\n, interestfrequencydays\r\n, paymentfrequencymonths\r\n, interestfrequencymonths\r\n, facilityseq\r\n, ismainfacility\r\n, mainfacilitycode\r\n, mainfacilityseq\r\n, outputlevel\r\n, islimitmodified\r\n, customcreditapprovedlimit\r\nFROM {{ source('staging', 'stg_los__corpapplimitdetails_test') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\test\\test_los__corpapplimitdetails_run.sql", "original_file_path": "models\\staging\\test\\test_los__corpapplimitdetails_run.sql", "name": "test_los__corpapplimitdetails_run", "alias": "test_los__corpapplimitdetails_run", "checksum": {"name": "sha256", "checksum": "bcd69775a5fd60a8eeff5c9b418e3288f8cd946cef4532936dc7a9a1fc96778d"}, "tags": ["test_los"], "refs": [], "sources": [["staging", "stg_los__corpapplimitdetails_test"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\test\\test_case.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\test\\test_los__corpapplimitdetails_run.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental"}, "created_at": 1685959753.2393668, "compiled_code": "\nWITH source AS(\nSELECT  corpapplimitdetailsid\n, syndfacilityrefno\n, syndfacilitydesc\n, agentbankcode\n, agentbranchcode\n, availableperiodmonths\n, availableperioddays\n, totalsyndicationlimit\n, totalsyndicationlimitccy\n, corpappentitydetailsid\n, limitclassification\n, limitcategory\n, purposecode\n, limitdescription\n, amtderivedchildflg\n, netlimitapplicableflg\n, existinglimit\n, proposedlimit\n, existingnetlimit\n, existinggrosslimit\n, proposednetlimit\n, proposedgrosslimit\n, existinglimitccy\n, proposedlimitccy\n, existingnetlimitccy\n, existinggrosslimitccy\n, proposednetlimitccy\n, proposedgrosslimitccy\n, limitshared\n,  cast(effectivedate as timestamp(3)) as effectivedate\n, limittermdays\n, limittermmonths\n,  cast(expirydate as timestamp(3)) as expirydate\n,  cast(limitreviewdate as timestamp(3)) as limitreviewdate\n,  cast(availabilityenddate as timestamp(3)) as availabilityenddate\n, revolvingflg\n, committedflg\n, indemnityheldflg\n, accountsofficer\n, primarysrcrepayment\n, secondarysrcrepayment\n, syndicationflg\n, limitstatus\n, remarks\n, sncdetailid\n, underwritingamount\n, underwritingamountccy\n, underwritingamounthome\n, takeholdamount\n, takeholdamountccy\n, takeholdamounthome\n, underwritingamounthomeccy\n, takeholdamounthomeccy\n, agent\n, participant\n, underwriter\n, isdeleted\n, limitrefno\n, parentlimitrefno\n, proposedlimitinhomeccy\n, limitccy\n, proposedlimitinlimitccy\n, relationshiplevel\n, approvedlimit\n, approvedlimitccy\n, approvedlimithomeccy\n, approvedlimitinlimitccy\n, approvednetlimit\n, approvednetlimitccy\n, approvedgrosslimit\n, approvedgrosslimitccy\n, drawingpwrind\n, drawingpwrpcnt\n, drawingpwrretained\n,  cast(offerletterreceiveddate as timestamp(3)) as offerletterreceiveddate\n, offerletterreceived\n, intratetablecode\n, priorityloan\n, ispapfield\n, routetostep\n, routingreasoncode\n, papagent\n, limitdecision\n, limitdecisioncode\n, limitremarks\n, dlod\n, dlodlimitclassification\n, dlodlimitcategory\n, existingdaylightlimit\n, existingdaylightcurrency\n, proposeddaylightlimit\n, proposeddaylightcurrency\n, dlodlimitstatus\n, limitidprefix\n, limitidsuffix\n, applnumber\n,  cast(offerlettersentdate as timestamp(3)) as offerlettersentdate\n, bookingstatus\n, accountfeesdr\n, lastapprovedlimit\n, partlimitstatus\n, snapshot\n, bank_id\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, versionnumber\n, islimitadded\n, existinglimithomeccy\n,  cast(tmdate as timestamp(3)) as tmdate\n, silverlakebranchcode\n, officercode\n, availablebalanceindicator\n, producttype\n, paymentcode\n, contractnumber\n, contractsignedby\n, contractdelegatedby\n, unsecuredlimit\n, totalderivedvalue\n, supportlimit1\n, supportlimit2\n, securedlimit\n,  cast(contractdate as timestamp(3)) as contractdate\n, paymentfrequencydays\n, interestfrequencydays\n, paymentfrequencymonths\n, interestfrequencymonths\n, facilityseq\n, ismainfacility\n, mainfacilitycode\n, mainfacilityseq\n, outputlevel\n, islimitmodified\n, customcreditapprovedlimit\nFROM oracle_dgaworkzone.staging.stg_los__corpapplimitdetails_test\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.test_los__corpapplimitdetails_run)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.test_los__corpapplimitdetails_run"}, "model.dga_data_model.test_los__opportunities_run": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.staging.stg_los__opportunities_test"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "test", "test_los__opportunities_run"], "unique_id": "model.dga_data_model.test_los__opportunities_run", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  opportunityid\r\n, productclassification\r\n, authtype\r\n, producttype\r\n, productcode\r\n, productname\r\n, currency\r\n, productcategory\r\n, businesscenter\r\n, dsarepname\r\n, repname\r\n, productsubcategory\r\n, accountbranch\r\n, transactiontype\r\n, assigntransfer\r\n, groupname\r\n, transferuserid\r\n, tier\r\n, isdeleted\r\n, is_ssa_acct\r\n, tempsalesid\r\n, applicationtype\r\n, userstrfield1\r\n, userstrfield2\r\n, userstrfield3\r\n, userstrfield4\r\n,  cast(userdatefield as timestamp(3)) as userdatefield\r\n, bank_id\r\n, stopprocescalation\r\n, rejectreason\r\n, lockrollback\r\n, lockrecompute\r\n, salesownergroup\r\n, ownergroup\r\n, oldsalesownerid\r\n, referencetype\r\n, noofrollback\r\n, firstrollbackat\r\n, accountnumber\r\n, leadvalue\r\n, valueunits\r\n, basevalue\r\n, probability\r\n, processstage\r\n, disposition\r\n, leadtype\r\n, opportunitiessource\r\n, description\r\n, leadmode\r\n, campaigntargetid\r\n, reasoncode\r\n, reasondetails\r\n, opportunityname\r\n, caseid\r\n, opportunitytype\r\n, processid\r\n, currentstep\r\n, orgid\r\n, suspectid\r\n, status\r\n, hasattachment\r\n, notes\r\n, additionalnotes\r\n, owneruserid\r\n, assigneduserid\r\n, createduserid\r\n, assignedgroupid\r\n, crmcallid\r\n, mergedwith\r\n, priority\r\n,  cast(startdate as timestamp(3)) as startdate\r\n,  cast(duedate as timestamp(3)) as duedate\r\n, competitors\r\n,  cast(enddate as timestamp(3)) as enddate\r\n,  cast(currstepduedate as timestamp(3)) as currstepduedate\r\n, region\r\n, ismerger\r\n, assignedbyuserid\r\n, transferredbyuserid\r\n, opportunityfor\r\n, autocreateapplform\r\n, opprstage\r\n, opprstatus\r\n, lastname\r\n, opprchannel\r\n, oppreditable\r\n, promotionoffer\r\n,  cast(promotionvalidity as timestamp(3)) as promotionvalidity\r\n, branchlocation\r\n, processeditable\r\n, oldapplicationid\r\n, channelrefid\r\n, salesownerid\r\n, contactid\r\n, purposeofcredit\r\n, isautomated\r\n, campaignid\r\n, timerstatus\r\n, secoppcaseid\r\n, issecondaryopp\r\n,  cast(assignedtime as timestamp(3)) as assignedtime\r\n, slalevel\r\n, ownedlocationid\r\n, assignedlocationid\r\n, isrouted\r\n,  cast(esc_due_time as timestamp(3)) as esc_due_time\r\n, esc_level\r\n, nocurstepassign\r\n, tatduration\r\n, stopescalation\r\n, entityemail\r\n, manualrouting\r\n, customersegment\r\n,  cast(routedtime as timestamp(3)) as routedtime\r\n,  cast(procescduetime as timestamp(3)) as procescduetime\r\n, firstgrownid\r\n, firstbcownid\r\n, firstuserownid\r\n, currnumposesc\r\n, currnumnegesc\r\n, numofposesc\r\n, numofnegesc\r\n, procesclevel\r\n, routeruleforgroup\r\n, routeruleforbc\r\n, routeruleforuser\r\n, escalationattr1\r\n, escalationattr2\r\n, escalationattr3\r\n, createdlocationid\r\n, userfield1\r\n, userfield2\r\n, userfield3\r\n, userfield4\r\n, userfield5\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, bocreatedby\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, bomodifiedby\r\n, concurdetect_x\r\n, boaclid\r\n, xmldata\r\n, extensionid\r\n, securityilhint\r\n, securityiuhint\r\n, securityglhint\r\n, securityguhint\r\n, parentintxnid\r\n,  cast(prevstependdate as timestamp(3)) as prevstependdate\r\n, accessownergroup\r\n, accessownersegment\r\n, accessownerbc\r\n, accessowneragent\r\n, accessassigneeagent\r\n, opportunityvalue\r\n, leadsourceid\r\n, quotaid\r\n, cifid\r\n, firstname\r\n, offerid\r\n, optionid\r\n, loanamt\r\n, channelname\r\n, loantenordays\r\n, loantenormonths\r\n, assignedbcgid\r\n, ownerbcgid\r\n,  cast(applrecieveddate as timestamp(3)) as applrecieveddate\r\n, extoriginatorname\r\n,  cast(tmdate as timestamp(3)) as tmdate\r\nFROM {{ source('staging', 'stg_los__opportunities_test') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where tmdate > (select max(tmdate) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\test\\test_los__opportunities_run.sql", "original_file_path": "models\\staging\\test\\test_los__opportunities_run.sql", "name": "test_los__opportunities_run", "alias": "test_los__opportunities_run", "checksum": {"name": "sha256", "checksum": "2daf766a9d63803543e1839c3b435200566e35466a6e874f8c50801726ea14b4"}, "tags": ["test_los"], "refs": [], "sources": [["staging", "stg_los__opportunities_test"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\test\\test_case.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\test\\test_los__opportunities_run.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental"}, "created_at": 1685959753.2373748, "compiled_code": "\nWITH source AS(\nSELECT  opportunityid\n, productclassification\n, authtype\n, producttype\n, productcode\n, productname\n, currency\n, productcategory\n, businesscenter\n, dsarepname\n, repname\n, productsubcategory\n, accountbranch\n, transactiontype\n, assigntransfer\n, groupname\n, transferuserid\n, tier\n, isdeleted\n, is_ssa_acct\n, tempsalesid\n, applicationtype\n, userstrfield1\n, userstrfield2\n, userstrfield3\n, userstrfield4\n,  cast(userdatefield as timestamp(3)) as userdatefield\n, bank_id\n, stopprocescalation\n, rejectreason\n, lockrollback\n, lockrecompute\n, salesownergroup\n, ownergroup\n, oldsalesownerid\n, referencetype\n, noofrollback\n, firstrollbackat\n, accountnumber\n, leadvalue\n, valueunits\n, basevalue\n, probability\n, processstage\n, disposition\n, leadtype\n, opportunitiessource\n, description\n, leadmode\n, campaigntargetid\n, reasoncode\n, reasondetails\n, opportunityname\n, caseid\n, opportunitytype\n, processid\n, currentstep\n, orgid\n, suspectid\n, status\n, hasattachment\n, notes\n, additionalnotes\n, owneruserid\n, assigneduserid\n, createduserid\n, assignedgroupid\n, crmcallid\n, mergedwith\n, priority\n,  cast(startdate as timestamp(3)) as startdate\n,  cast(duedate as timestamp(3)) as duedate\n, competitors\n,  cast(enddate as timestamp(3)) as enddate\n,  cast(currstepduedate as timestamp(3)) as currstepduedate\n, region\n, ismerger\n, assignedbyuserid\n, transferredbyuserid\n, opportunityfor\n, autocreateapplform\n, opprstage\n, opprstatus\n, lastname\n, opprchannel\n, oppreditable\n, promotionoffer\n,  cast(promotionvalidity as timestamp(3)) as promotionvalidity\n, branchlocation\n, processeditable\n, oldapplicationid\n, channelrefid\n, salesownerid\n, contactid\n, purposeofcredit\n, isautomated\n, campaignid\n, timerstatus\n, secoppcaseid\n, issecondaryopp\n,  cast(assignedtime as timestamp(3)) as assignedtime\n, slalevel\n, ownedlocationid\n, assignedlocationid\n, isrouted\n,  cast(esc_due_time as timestamp(3)) as esc_due_time\n, esc_level\n, nocurstepassign\n, tatduration\n, stopescalation\n, entityemail\n, manualrouting\n, customersegment\n,  cast(routedtime as timestamp(3)) as routedtime\n,  cast(procescduetime as timestamp(3)) as procescduetime\n, firstgrownid\n, firstbcownid\n, firstuserownid\n, currnumposesc\n, currnumnegesc\n, numofposesc\n, numofnegesc\n, procesclevel\n, routeruleforgroup\n, routeruleforbc\n, routeruleforuser\n, escalationattr1\n, escalationattr2\n, escalationattr3\n, createdlocationid\n, userfield1\n, userfield2\n, userfield3\n, userfield4\n, userfield5\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, bocreatedby\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, bomodifiedby\n, concurdetect_x\n, boaclid\n, xmldata\n, extensionid\n, securityilhint\n, securityiuhint\n, securityglhint\n, securityguhint\n, parentintxnid\n,  cast(prevstependdate as timestamp(3)) as prevstependdate\n, accessownergroup\n, accessownersegment\n, accessownerbc\n, accessowneragent\n, accessassigneeagent\n, opportunityvalue\n, leadsourceid\n, quotaid\n, cifid\n, firstname\n, offerid\n, optionid\n, loanamt\n, channelname\n, loantenordays\n, loantenormonths\n, assignedbcgid\n, ownerbcgid\n,  cast(applrecieveddate as timestamp(3)) as applrecieveddate\n, extoriginatorname\n,  cast(tmdate as timestamp(3)) as tmdate\nFROM oracle_dgaworkzone.staging.stg_los__opportunities_test\n)\nSELECT * FROM source\n\n  where tmdate > (select max(tmdate) from \"oracle_dgaworkzone\".staging.test_los__opportunities_run)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.test_los__opportunities_run"}, "model.dga_data_model.test_stg_los__areas_run": {"compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.dga_data_model.crmuser.areas"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "test", "test_stg_los__areas_run"], "unique_id": "model.dga_data_model.test_stg_los__areas_run", "raw_code": "{{\r\n    config(\r\n        materialized='incremental',\r\n    )\r\n}}\r\nWITH source AS(\r\nSELECT  areasid\r\n, code\r\n, name\r\n, isdeleted\r\n, freetext1\r\n, freetext2\r\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\r\n, modifiedby\r\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\r\n, createdby\r\nFROM {{ source('crmuser', 'areas') }}\r\n)\r\nSELECT * FROM source\r\n{% if is_incremental() %}\r\n  where bodatemodified > (select max(bodatemodified) from {{ this }})\r\n{% endif %}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\test\\test_stg_los__areas_run.sql", "original_file_path": "models\\staging\\test\\test_stg_los__areas_run.sql", "name": "test_stg_los__areas_run", "alias": "test_stg_los__areas_run", "checksum": {"name": "sha256", "checksum": "5291981218608fc6ec925dd8732bb2af27cdc73200f193013544e7215a5a22a7"}, "tags": ["test_los"], "refs": [], "sources": [["crmuser", "areas"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "thaidv3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\test\\test_case.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\test\\test_stg_los__areas_run.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "tags": ["test_los"], "meta": {"owner": "thaidv3"}, "materialized": "incremental"}, "created_at": 1685959753.2413666, "compiled_code": "\nWITH source AS(\nSELECT  areasid\n, code\n, name\n, isdeleted\n, freetext1\n, freetext2\n,  cast(bodatemodified as timestamp(3)) as bodatemodified\n, modifiedby\n,  cast(bodatecreated as timestamp(3)) as bodatecreated\n, createdby\nFROM oracle_los.crmuser.areas\n)\nSELECT * FROM source\n\n  where bodatemodified > (select max(bodatemodified) from \"oracle_dgaworkzone\".staging.test_stg_los__areas_run)\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.test_stg_los__areas_run"}, "model.dga_data_model.stg_tms__tbldailyperformance": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.sys.dual", "source.dga_data_model.dbo.tbldailyperformance"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "process_time"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "tms", "stg_tms__tbldailyperformance"], "unique_id": "model.dga_data_model.stg_tms__tbldailyperformance", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat AS( SELECT\r\n    id,\r\n    branchid,\r\n    atmid,\r\n    totaltime,\r\n    oostime,\r\n    outofsupplytime,\r\n    lostcommtime,\r\n    servicetime,\r\n    inservicetime,\r\n    CAST(\"date\" AS TIMESTAMP(3))     AS process_time,\r\n    oosbyapplication,\r\n    oosbydevice,\r\n    oosbyother,\r\n    lostcommbypoweroff,\r\n    lostcommbynetworkfail,\r\n    outcash,\r\n    fullcash,\r\n    CAST(lastupdate AS TIMESTAMP(3)) AS lastupdate\r\n  FROM {{ source('dbo', 'tbldailyperformance') }}\r\n  WHERE CAST(\"date\" AS TIMESTAMP(3)) > (\r\n                                        SELECT\r\n                                            current_date  - INTERVAL '1' MONTH\r\n                                        FROM {{source('sys', 'dual')}}\r\n                                        )\r\n)\r\nSELECT * FROM dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\tms\\stg_tms__tbldailyperformance.sql", "original_file_path": "models\\staging\\tms\\stg_tms__tbldailyperformance.sql", "name": "stg_tms__tbldailyperformance", "alias": "stg_tms__tbldailyperformance", "checksum": {"name": "sha256", "checksum": "a3e8936b4abdd2a53e9cb6972831db1f010ae9254e7f8e561354e0581e49f8d9"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["sys", "dual"], ["dbo", "tbldailyperformance"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "process_time"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\tms\\tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\tms\\stg_tms__tbldailyperformance.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "process_time"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959753.246373, "compiled_code": "\nWITH dat AS( SELECT\n    id,\n    branchid,\n    atmid,\n    totaltime,\n    oostime,\n    outofsupplytime,\n    lostcommtime,\n    servicetime,\n    inservicetime,\n    CAST(\"date\" AS TIMESTAMP(3))     AS process_time,\n    oosbyapplication,\n    oosbydevice,\n    oosbyother,\n    lostcommbypoweroff,\n    lostcommbynetworkfail,\n    outcash,\n    fullcash,\n    CAST(lastupdate AS TIMESTAMP(3)) AS lastupdate\n  FROM sqlserver_tms.dbo.tbldailyperformance\n  WHERE CAST(\"date\" AS TIMESTAMP(3)) > (\n                                        SELECT\n                                            current_date  - INTERVAL '1' MONTH\n                                        FROM oracle_dgaworkzone.sys.dual\n                                        )\n)\nSELECT * FROM dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_tms__tbldailyperformance"}, "model.dga_data_model.stg_tms__tblevent": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.sys.dual", "source.dga_data_model.dbo.tblevent"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "dstart"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "tms", "stg_tms__tblevent"], "unique_id": "model.dga_data_model.stg_tms__tblevent", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat AS( SELECT\r\n    ieventid,\r\n    satmid,\r\n    sdevicecode,\r\n    smodulecode,\r\n    sstatuscode,\r\n    sprocesscode,\r\n    CAST(dstart AS TIMESTAMP(3)) AS dstart,\r\n    icreateby,\r\n    imodifyby,\r\n    imanualcreate,\r\n    sdescription,\r\n    ieventtype,\r\n    sreason,\r\n    mstatus,\r\n    mdata,\r\n    supplystatus,\r\n    dstarttimezone,\r\n    starttimeserver,\r\n    errorseverity\r\n  FROM {{ source('dbo', 'tblevent') }}\r\n  WHERE CAST(dstart AS TIMESTAMP(3)) > (\r\n                                        SELECT\r\n                                            current_date  - INTERVAL '1' MONTH\r\n                                        FROM {{source('sys', 'dual')}}\r\n                                        )\r\n)\r\nSELECT *\r\nFROM dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\tms\\stg_tms__tblevent.sql", "original_file_path": "models\\staging\\tms\\stg_tms__tblevent.sql", "name": "stg_tms__tblevent", "alias": "stg_tms__tblevent", "checksum": {"name": "sha256", "checksum": "87717168dfcb9c9a1d9940fed5c76db66ec5618c6f6c9c7e5e4cb05ad9cbe3a0"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["sys", "dual"], ["dbo", "tblevent"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "dstart"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\tms\\tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\tms\\stg_tms__tblevent.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "dstart"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959753.248378, "compiled_code": "\nWITH dat AS( SELECT\n    ieventid,\n    satmid,\n    sdevicecode,\n    smodulecode,\n    sstatuscode,\n    sprocesscode,\n    CAST(dstart AS TIMESTAMP(3)) AS dstart,\n    icreateby,\n    imodifyby,\n    imanualcreate,\n    sdescription,\n    ieventtype,\n    sreason,\n    mstatus,\n    mdata,\n    supplystatus,\n    dstarttimezone,\n    starttimeserver,\n    errorseverity\n  FROM sqlserver_tms.dbo.tblevent\n  WHERE CAST(dstart AS TIMESTAMP(3)) > (\n                                        SELECT\n                                            current_date  - INTERVAL '1' MONTH\n                                        FROM oracle_dgaworkzone.sys.dual\n                                        )\n)\nSELECT *\nFROM dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_tms__tblevent"}, "model.dga_data_model.stg_tms__tbleventhistory": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.sys.dual", "source.dga_data_model.dbo.tbleventhistory"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "dstart"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "tms", "stg_tms__tbleventhistory"], "unique_id": "model.dga_data_model.stg_tms__tbleventhistory", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat AS(\r\n  SELECT\r\n    ieventhistoryid,\r\n    ieventid,\r\n    satmid,\r\n    sdevicecode,\r\n    smodulecode,\r\n    sstatuscode,\r\n    sprocesscode,\r\n    CAST(dstart AS TIMESTAMP(3)) AS dstart,\r\n    CAST(dend AS TIMESTAMP(3))   AS dend,\r\n    icreateby,\r\n    imodifyby,\r\n    imanualcreate,\r\n    sdescription,\r\n    sreason,\r\n    sfile,\r\n    mstatus,\r\n    mdata,\r\n    supplystatus,\r\n    dstarttimezone,\r\n    starttimeserver,\r\n    dendtimezone,\r\n    endtimeserver,\r\n    errorseverity\r\n  FROM {{ source('dbo', 'tbleventhistory') }}\r\n  WHERE CAST(dstart AS TIMESTAMP(3)) > (\r\n                                        SELECT\r\n                                            current_date  - INTERVAL '10' DAY\r\n                                        FROM {{ source('sys', 'dual')}}\r\n                                        )\r\n)\r\nSELECT *\r\nFROM dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\tms\\stg_tms__tbleventhistory.sql", "original_file_path": "models\\staging\\tms\\stg_tms__tbleventhistory.sql", "name": "stg_tms__tbleventhistory", "alias": "stg_tms__tbleventhistory", "checksum": {"name": "sha256", "checksum": "5ca1e4564d75a4aaa372e5c995104ba4e0a1a14c3e215fccfbfcc7f2c9b8ecaf"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["sys", "dual"], ["dbo", "tbleventhistory"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "dstart"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\tms\\tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\tms\\stg_tms__tbleventhistory.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "dstart"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959753.2503662, "compiled_code": "\nWITH dat AS(\n  SELECT\n    ieventhistoryid,\n    ieventid,\n    satmid,\n    sdevicecode,\n    smodulecode,\n    sstatuscode,\n    sprocesscode,\n    CAST(dstart AS TIMESTAMP(3)) AS dstart,\n    CAST(dend AS TIMESTAMP(3))   AS dend,\n    icreateby,\n    imodifyby,\n    imanualcreate,\n    sdescription,\n    sreason,\n    sfile,\n    mstatus,\n    mdata,\n    supplystatus,\n    dstarttimezone,\n    starttimeserver,\n    dendtimezone,\n    endtimeserver,\n    errorseverity\n  FROM sqlserver_tms.dbo.tbleventhistory\n  WHERE CAST(dstart AS TIMESTAMP(3)) > (\n                                        SELECT\n                                            current_date  - INTERVAL '10' DAY\n                                        FROM oracle_dgaworkzone.sys.dual\n                                        )\n)\nSELECT *\nFROM dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_tms__tbleventhistory"}, "model.dga_data_model.stg_tms__tblincident": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.dbo.tblincident", "source.dga_data_model.sys.dual"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "starttime"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "tms", "stg_tms__tblincident"], "unique_id": "model.dga_data_model.stg_tms__tblincident", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat AS(\r\n    SELECT\r\n        id,\r\n        incidentdefinitionid,\r\n        ticketid,\r\n        prioritylevel,\r\n        roleid,\r\n        atmid,\r\n        incidenttype,\r\n        stepid,\r\n        statusid,\r\n        zoneid,\r\n        CAST(starttime AS TIMESTAMP(3))            AS starttime,\r\n        CAST(assigndate AS TIMESTAMP(3))           AS assigndate,\r\n        CAST(arrivedate AS TIMESTAMP(3))           AS arrivedate,\r\n        CAST(enddatemanual AS TIMESTAMP(3))        AS enddatemanual,\r\n        CAST(enddate AS TIMESTAMP(3))              AS enddate,\r\n        problem,\r\n        devicecode,\r\n        categorycode,\r\n        statuscode,\r\n        assigneecontactid,\r\n        warningassignee,\r\n        description,\r\n        CAST(predictpendingassign AS TIMESTAMP(3)) AS predictpendingassign,\r\n        CAST(predictpendingarrive AS TIMESTAMP(3)) AS predictpendingarrive,\r\n        CAST(pendingassigndate AS TIMESTAMP(3))    AS pendingassigndate,\r\n        CAST(pendingarrivedate AS TIMESTAMP(3))    AS pendingarrivedate,\r\n        incidentclassifyid,\r\n        startservertimezone,\r\n        endservertimezone,\r\n        endservermanualtimezone\r\n  FROM {{ source('dbo', 'tblincident') }}\r\n  WHERE CAST(starttime AS TIMESTAMP(3)) > (\r\n                                        SELECT\r\n                                            CURRENT_DATE  - INTERVAL '1' MONTH\r\n                                        FROM {{source('sys', 'dual')}}\r\n                                        )\r\n)\r\nSELECT *\r\nFROM dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\tms\\stg_tms__tblincident.sql", "original_file_path": "models\\staging\\tms\\stg_tms__tblincident.sql", "name": "stg_tms__tblincident", "alias": "stg_tms__tblincident", "checksum": {"name": "sha256", "checksum": "4945182dab09da581dc56e8a8bdd00c8ffa8afa2d2cdb07743e2962c31156509"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["dbo", "tblincident"], ["sys", "dual"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "starttime"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\tms\\tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\tms\\stg_tms__tblincident.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "starttime"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959753.2523732, "compiled_code": "\nWITH dat AS(\n    SELECT\n        id,\n        incidentdefinitionid,\n        ticketid,\n        prioritylevel,\n        roleid,\n        atmid,\n        incidenttype,\n        stepid,\n        statusid,\n        zoneid,\n        CAST(starttime AS TIMESTAMP(3))            AS starttime,\n        CAST(assigndate AS TIMESTAMP(3))           AS assigndate,\n        CAST(arrivedate AS TIMESTAMP(3))           AS arrivedate,\n        CAST(enddatemanual AS TIMESTAMP(3))        AS enddatemanual,\n        CAST(enddate AS TIMESTAMP(3))              AS enddate,\n        problem,\n        devicecode,\n        categorycode,\n        statuscode,\n        assigneecontactid,\n        warningassignee,\n        description,\n        CAST(predictpendingassign AS TIMESTAMP(3)) AS predictpendingassign,\n        CAST(predictpendingarrive AS TIMESTAMP(3)) AS predictpendingarrive,\n        CAST(pendingassigndate AS TIMESTAMP(3))    AS pendingassigndate,\n        CAST(pendingarrivedate AS TIMESTAMP(3))    AS pendingarrivedate,\n        incidentclassifyid,\n        startservertimezone,\n        endservertimezone,\n        endservermanualtimezone\n  FROM sqlserver_tms.dbo.tblincident\n  WHERE CAST(starttime AS TIMESTAMP(3)) > (\n                                        SELECT\n                                            CURRENT_DATE  - INTERVAL '1' MONTH\n                                        FROM oracle_dgaworkzone.sys.dual\n                                        )\n)\nSELECT *\nFROM dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_tms__tblincident"}, "model.dga_data_model.stg_tms__tblincidenthistory": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.sys.dual", "source.dga_data_model.dbo.tblincidenthistory"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vhkq_daily"], "meta": {"owner": "giangtt11", "date_column": "starttime"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "tms", "stg_tms__tblincidenthistory"], "unique_id": "model.dga_data_model.stg_tms__tblincidenthistory", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nWITH dat AS(\r\n    SELECT\r\n        id,\r\n        incidentdefinitionid,\r\n        ticketid,\r\n        prioritylevel,\r\n        roleid,\r\n        atmid,\r\n        incidenttype,\r\n        stepid,\r\n        statusid,\r\n        zoneid,\r\n        CAST(starttime AS TIMESTAMP(3)) AS starttime,\r\n        CAST(starttime AS TIMESTAMP(3)) AS assigndate,\r\n        CAST(starttime AS TIMESTAMP(3)) AS arrivedate,\r\n        CAST(starttime AS TIMESTAMP(3)) AS enddatemanual,\r\n        CAST(starttime AS TIMESTAMP(3)) AS enddate,\r\n        problem,\r\n        devicecode,\r\n        categorycode,\r\n        statuscode,\r\n        assigneecontactid,\r\n        warningassignee,\r\n        description,\r\n        eventlist,\r\n        commentlist,\r\n        CAST(starttime AS TIMESTAMP(3)) AS pendingassigndate,\r\n        CAST(starttime AS TIMESTAMP(3)) AS pendingarrivedate,\r\n        incidentclassifyid,\r\n        startservertimezone,\r\n        endservertimezone,\r\n        endservermanualtimezone\r\n  FROM {{ source('dbo', 'tblincidenthistory') }}\r\n  WHERE CAST(starttime AS TIMESTAMP(3)) > (\r\n                                        SELECT\r\n                                            current_date  - INTERVAL '1' MONTH\r\n                                        FROM {{source('sys', 'dual')}}\r\n                                        )\r\n)\r\nSELECT *\r\nFROM dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\tms\\stg_tms__tblincidenthistory.sql", "original_file_path": "models\\staging\\tms\\stg_tms__tblincidenthistory.sql", "name": "stg_tms__tblincidenthistory", "alias": "stg_tms__tblincidenthistory", "checksum": {"name": "sha256", "checksum": "9c53d2836233c8dd3cfe1984e869a57888a1af0e8f4b23d770eef89d13aec7e3"}, "tags": ["vhkq_daily"], "refs": [], "sources": [["sys", "dual"], ["dbo", "tblincidenthistory"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "giangtt11", "date_column": "starttime"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\tms\\tms.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\tms\\stg_tms__tblincidenthistory.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"date_column": "starttime"}, "tags": ["vhkq_daily"], "materialized": "table"}, "created_at": 1685959753.253376, "compiled_code": "\nWITH dat AS(\n    SELECT\n        id,\n        incidentdefinitionid,\n        ticketid,\n        prioritylevel,\n        roleid,\n        atmid,\n        incidenttype,\n        stepid,\n        statusid,\n        zoneid,\n        CAST(starttime AS TIMESTAMP(3)) AS starttime,\n        CAST(starttime AS TIMESTAMP(3)) AS assigndate,\n        CAST(starttime AS TIMESTAMP(3)) AS arrivedate,\n        CAST(starttime AS TIMESTAMP(3)) AS enddatemanual,\n        CAST(starttime AS TIMESTAMP(3)) AS enddate,\n        problem,\n        devicecode,\n        categorycode,\n        statuscode,\n        assigneecontactid,\n        warningassignee,\n        description,\n        eventlist,\n        commentlist,\n        CAST(starttime AS TIMESTAMP(3)) AS pendingassigndate,\n        CAST(starttime AS TIMESTAMP(3)) AS pendingarrivedate,\n        incidentclassifyid,\n        startservertimezone,\n        endservertimezone,\n        endservermanualtimezone\n  FROM sqlserver_tms.dbo.tblincidenthistory\n  WHERE CAST(starttime AS TIMESTAMP(3)) > (\n                                        SELECT\n                                            current_date  - INTERVAL '1' MONTH\n                                        FROM oracle_dgaworkzone.sys.dual\n                                        )\n)\nSELECT *\nFROM dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_tms__tblincidenthistory"}, "model.dga_data_model.stg_landing__sppl_m_account_planning": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_account_planning @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_account_planning"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_account_planning", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  activities_id\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  new_version\r\n      ,  owner\r\n      ,  status\r\n      ,  suggest_customer_id\r\n      ,  times_change\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_account_planning @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_account_planning.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_account_planning.sql", "name": "stg_landing__sppl_m_account_planning", "alias": "stg_landing__sppl_m_account_planning", "checksum": {"name": "sha256", "checksum": "697b9690f255e98e2b281df3e3ce1bfd53d7186d3b519d83838e5066ff31c118"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_account_planning @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_account_planning.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.9769843, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  activities_id\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  effective_date\n      ,  expire_date\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  new_version\n      ,  owner\n      ,  status\n      ,  suggest_customer_id\n      ,  times_change\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_account_planning @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_account_planning"}, "model.dga_data_model.stg_landing__sppl_m_activities": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_activities @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_activities"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_activities", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  base_amount_bond\r\n      ,  base_amountfd\r\n      ,  base_amount_loan\r\n      ,  close_date_bond\r\n      ,  close_datefd\r\n      ,  close_date_loan\r\n      ,  combo_casa\r\n      ,  contract_number_bond\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deal_datefx\r\n      ,  dealer_code_loan\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  feefx\r\n      ,  fyp\r\n      ,  interest_rate_bond\r\n      ,  interest_ratefd\r\n      ,  interest_rate_loan\r\n      ,  last_level_product_id\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  limit_loan\r\n      ,  money_date_banca\r\n      ,  money_type_bond\r\n      ,  money_type_casa\r\n      ,  money_typefd\r\n      ,  money_type_loan\r\n      ,  new_version\r\n      ,  officer_code_loan\r\n      ,  open_date_banca\r\n      ,  open_date_bond\r\n      ,  open_date_card\r\n      ,  open_date_casa\r\n      ,  open_date_ebank\r\n      ,  open_datefd\r\n      ,  open_date_loan\r\n      ,  renewfd\r\n      ,  request_numberfx\r\n      ,  status\r\n      ,  teller_code_casa\r\n      ,  teller_codefd\r\n      ,  term_bond\r\n      ,  termfd\r\n      ,  term_loan\r\n      ,  times_change\r\n      ,  user_code_loan\r\n      ,  approve_system\r\n      ,  contract_number_banca\r\n      ,  date_close\r\n      ,  fail_reason_id\r\n      ,  is_link_card\r\n      ,  is_login_ebank\r\n      ,  is_trade_ebank\r\n      ,  money_banca\r\n      ,  money_typefx\r\n      ,  result\r\n      ,  type_of_card\r\n      ,  type_of_tradingfx\r\n      ,  typeof_bond\r\n      ,  selling_opportunity_id\r\n      ,  acctno_casa\r\n      ,  acctnofd\r\n      ,  acctno_loan\r\n      ,  amountfx\r\n      ,  ape_atm_banca\r\n      ,  balance_acy_casa\r\n      ,  balance_acyfd\r\n      ,  balance_lcy_casa\r\n      ,  balance_lcyfd\r\n      ,  balance_lcy_loan\r\n      ,  branch_code\r\n      ,  cif_number\r\n      ,  class_card\r\n      ,  doanh_sofx\r\n      ,  fyp_atm_banca\r\n      ,  identification_id\r\n      ,  identity_number\r\n      ,  is_mapping_error\r\n      ,  last_actionid\r\n      ,  last_step_active_name\r\n      ,  legal_id_banca\r\n      ,  limit_card\r\n      ,  maturity_datefd\r\n      ,  maturity_date_loan\r\n      ,  money_type2fx\r\n      ,  open_date_mbank\r\n      ,  open_datesmsbank\r\n      ,  product_code\r\n      ,  product_type_banca\r\n      ,  productlevel1_id\r\n      ,  rate_code_loan\r\n      ,  semi_last_product_id\r\n      ,  semi_last_product_code\r\n      ,  term_dayfd\r\n      ,  branch_id\r\n      ,  selling_status\r\n      ,  last_call_status_code\r\n      ,  last_result_code\r\n      ,  active_date_card\r\n      ,  casa_status\r\n      ,  first_payment\r\n      ,  first_payment_date\r\n      ,  gia_tri_du_kien\r\n      ,  is_active\r\n      ,  is_approved\r\n      ,  is_register\r\n      ,  is_submit\r\n      ,  ky_han_khoan_bond\r\n      ,  ma_ho_so\r\n      ,  ngay_gia_han_gan_nhatfd\r\n      ,  note\r\n      ,  reject_reason\r\n      ,  so_du_ban_dauntfd\r\n      ,  so_du_ban_dauqdfd\r\n      ,  thoi_gian_du_kien\r\n      ,  thu_thuan_option\r\n      ,  trade_date_option\r\n      ,  emp_code\r\n      ,  is_vip_casa\r\n      ,  vip_price\r\n      ,  los_fail_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_activities @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_activities.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_activities.sql", "name": "stg_landing__sppl_m_activities", "alias": "stg_landing__sppl_m_activities", "checksum": {"name": "sha256", "checksum": "4a87760706bc5abf2df68faf1f441e2dbf386748475f957122ab3f825fb19ec7"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_activities @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_activities.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.9789894, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  base_amount_bond\n      ,  base_amountfd\n      ,  base_amount_loan\n      ,  close_date_bond\n      ,  close_datefd\n      ,  close_date_loan\n      ,  combo_casa\n      ,  contract_number_bond\n      ,  created_by\n      ,  date_created\n      ,  deal_datefx\n      ,  dealer_code_loan\n      ,  deleted\n      ,  effective_date\n      ,  expire_date\n      ,  feefx\n      ,  fyp\n      ,  interest_rate_bond\n      ,  interest_ratefd\n      ,  interest_rate_loan\n      ,  last_level_product_id\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  limit_loan\n      ,  money_date_banca\n      ,  money_type_bond\n      ,  money_type_casa\n      ,  money_typefd\n      ,  money_type_loan\n      ,  new_version\n      ,  officer_code_loan\n      ,  open_date_banca\n      ,  open_date_bond\n      ,  open_date_card\n      ,  open_date_casa\n      ,  open_date_ebank\n      ,  open_datefd\n      ,  open_date_loan\n      ,  renewfd\n      ,  request_numberfx\n      ,  status\n      ,  teller_code_casa\n      ,  teller_codefd\n      ,  term_bond\n      ,  termfd\n      ,  term_loan\n      ,  times_change\n      ,  user_code_loan\n      ,  approve_system\n      ,  contract_number_banca\n      ,  date_close\n      ,  fail_reason_id\n      ,  is_link_card\n      ,  is_login_ebank\n      ,  is_trade_ebank\n      ,  money_banca\n      ,  money_typefx\n      ,  result\n      ,  type_of_card\n      ,  type_of_tradingfx\n      ,  typeof_bond\n      ,  selling_opportunity_id\n      ,  acctno_casa\n      ,  acctnofd\n      ,  acctno_loan\n      ,  amountfx\n      ,  ape_atm_banca\n      ,  balance_acy_casa\n      ,  balance_acyfd\n      ,  balance_lcy_casa\n      ,  balance_lcyfd\n      ,  balance_lcy_loan\n      ,  branch_code\n      ,  cif_number\n      ,  class_card\n      ,  doanh_sofx\n      ,  fyp_atm_banca\n      ,  identification_id\n      ,  identity_number\n      ,  is_mapping_error\n      ,  last_actionid\n      ,  last_step_active_name\n      ,  legal_id_banca\n      ,  limit_card\n      ,  maturity_datefd\n      ,  maturity_date_loan\n      ,  money_type2fx\n      ,  open_date_mbank\n      ,  open_datesmsbank\n      ,  product_code\n      ,  product_type_banca\n      ,  productlevel1_id\n      ,  rate_code_loan\n      ,  semi_last_product_id\n      ,  semi_last_product_code\n      ,  term_dayfd\n      ,  branch_id\n      ,  selling_status\n      ,  last_call_status_code\n      ,  last_result_code\n      ,  active_date_card\n      ,  casa_status\n      ,  first_payment\n      ,  first_payment_date\n      ,  gia_tri_du_kien\n      ,  is_active\n      ,  is_approved\n      ,  is_register\n      ,  is_submit\n      ,  ky_han_khoan_bond\n      ,  ma_ho_so\n      ,  ngay_gia_han_gan_nhatfd\n      ,  note\n      ,  reject_reason\n      ,  so_du_ban_dauntfd\n      ,  so_du_ban_dauqdfd\n      ,  thoi_gian_du_kien\n      ,  thu_thuan_option\n      ,  trade_date_option\n      ,  emp_code\n      ,  is_vip_casa\n      ,  vip_price\n      ,  los_fail_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_activities @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_activities"}, "model.dga_data_model.stg_landing__sppl_m_branch": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_branch @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_branch"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_branch", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  code\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  description\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  name\r\n      ,  new_version\r\n      ,  parent_id\r\n      ,  sort_order\r\n      ,  specialized_bank_id\r\n      ,  status\r\n      ,  times_change\r\n      ,  tree_level\r\n      ,  user_owner\r\n      ,  path\r\n      ,  isttkheb\r\n      ,  province_level\r\n      ,  is_leaf\r\n      ,  branch_code\r\n      ,  parent_name\r\n      ,  parent_code\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_branch @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_branch.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_branch.sql", "name": "stg_landing__sppl_m_branch", "alias": "stg_landing__sppl_m_branch", "checksum": {"name": "sha256", "checksum": "923f0db842fc714c162a78524c685ba56f05c2c75b51d407b4ac9a77f96ad173"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_branch @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_branch.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.980984, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  code\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  description\n      ,  effective_date\n      ,  expire_date\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  name\n      ,  new_version\n      ,  parent_id\n      ,  sort_order\n      ,  specialized_bank_id\n      ,  status\n      ,  times_change\n      ,  tree_level\n      ,  user_owner\n      ,  path\n      ,  isttkheb\n      ,  province_level\n      ,  is_leaf\n      ,  branch_code\n      ,  parent_name\n      ,  parent_code\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_branch @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_branch"}, "model.dga_data_model.stg_landing__sppl_m_campaign": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_campaign @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_campaign"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_campaign", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  code\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  expiration_date\r\n      ,  expire_date\r\n      ,  group_id\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  name\r\n      ,  new_version\r\n      ,  status\r\n      ,  times_change\r\n      ,  campaign_action\r\n      ,  campaign_comments\r\n      ,  campaign_script\r\n      ,  campaign_tgt_prod_cat\r\n      ,  campaign_tgt_prod_sub_cat\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_campaign @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_campaign.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_campaign.sql", "name": "stg_landing__sppl_m_campaign", "alias": "stg_landing__sppl_m_campaign", "checksum": {"name": "sha256", "checksum": "094f3676eba2ebf117d95bedc149da6e56e8bcbcfb94dad9b6b5739123edbd6e"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_campaign @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_campaign.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.9839103, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  code\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  effective_date\n      ,  expiration_date\n      ,  expire_date\n      ,  group_id\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  name\n      ,  new_version\n      ,  status\n      ,  times_change\n      ,  campaign_action\n      ,  campaign_comments\n      ,  campaign_script\n      ,  campaign_tgt_prod_cat\n      ,  campaign_tgt_prod_sub_cat\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_campaign @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_campaign"}, "model.dga_data_model.stg_landing__sppl_m_customer": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_customer @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_customer"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_customer", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  account\r\n      ,  bank_type\r\n      ,  business_registration_number\r\n      ,  career_id\r\n      ,  cif_number\r\n      ,  created_by\r\n      ,  created_date\r\n      ,  customer_industry_id\r\n      ,  customer_status\r\n      ,  customer_type\r\n      ,  customer_type2_id\r\n      ,  date_created\r\n      ,  date_of_birth\r\n      ,  deleted\r\n      ,  dependent_person\r\n      ,  education_level\r\n      ,  education_level2_id\r\n      ,  effective_date\r\n      ,  email\r\n      ,  email_address\r\n      ,  enterprise_type_id\r\n      ,  enumeration1\r\n      ,  expire_date\r\n      ,  fax\r\n      ,  fcb\r\n      ,  first_name\r\n      ,  full_name\r\n      ,  full_name1\r\n      ,  gender\r\n      ,  gender2\r\n      ,  hobby\r\n      ,  home_phone\r\n      ,  last_name\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  m_payrool\r\n      ,  marital_status\r\n      ,  mobile_phone\r\n      ,  msb_staff\r\n      ,  new_version\r\n      ,  number_of_childrend\r\n      ,  office_phone\r\n      ,  organization_id\r\n      ,  ownership\r\n      ,  religion_id\r\n      ,  short_name\r\n      ,  specialized_bank_id\r\n      ,  status\r\n      ,  tax_code\r\n      ,  tax_id\r\n      ,  times_change\r\n      ,  updated_date\r\n      ,  vip_code\r\n      ,  customer_age\r\n      ,  anniversary_date\r\n      ,  number_of_lifeinsurance\r\n      ,  owned_cars\r\n      ,  owned_houses\r\n      ,  total_value_of_asset_estimated\r\n      ,  total_value_of_loan_estimated\r\n      ,  total_value_of_saving\r\n      ,  total_value_of_stock\r\n      ,  insurance_summary_id\r\n      ,  investment_summary_id\r\n      ,  business_sector\r\n      ,  company_address\r\n      ,  company_name\r\n      ,  monthy_income\r\n      ,  other_note\r\n      ,  position\r\n      ,  position_other\r\n      ,  source_of_income\r\n      ,  fx_id\r\n      ,  customer_group\r\n      ,  customer_rank\r\n      ,  id_date\r\n      ,  id_place\r\n      ,  main_id_number\r\n      ,  main_passport\r\n      ,  passport_date\r\n      ,  id_number\r\n      ,  passport_id\r\n      ,  activities_id\r\n      ,  day_of_birth\r\n      ,  month_of_birth\r\n      ,  close_datetc\r\n      ,  customer_segment\r\n      ,  open_datetc\r\n      ,  customer_rank_lastm\r\n      ,  level1branch_id\r\n      ,  owner_id\r\n      ,  fx_fn_id\r\n      ,  insurance_fn_id\r\n      ,  investment_fn_id\r\n      ,  taxcode\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_customer @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_customer.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_customer.sql", "name": "stg_landing__sppl_m_customer", "alias": "stg_landing__sppl_m_customer", "checksum": {"name": "sha256", "checksum": "ef16c2af8db69b13a834e39e78703d982b7015d96f9f3985431e5decfa45b871"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_customer @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_customer.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.985218, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  account\n      ,  bank_type\n      ,  business_registration_number\n      ,  career_id\n      ,  cif_number\n      ,  created_by\n      ,  created_date\n      ,  customer_industry_id\n      ,  customer_status\n      ,  customer_type\n      ,  customer_type2_id\n      ,  date_created\n      ,  date_of_birth\n      ,  deleted\n      ,  dependent_person\n      ,  education_level\n      ,  education_level2_id\n      ,  effective_date\n      ,  email\n      ,  email_address\n      ,  enterprise_type_id\n      ,  enumeration1\n      ,  expire_date\n      ,  fax\n      ,  fcb\n      ,  first_name\n      ,  full_name\n      ,  full_name1\n      ,  gender\n      ,  gender2\n      ,  hobby\n      ,  home_phone\n      ,  last_name\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  m_payrool\n      ,  marital_status\n      ,  mobile_phone\n      ,  msb_staff\n      ,  new_version\n      ,  number_of_childrend\n      ,  office_phone\n      ,  organization_id\n      ,  ownership\n      ,  religion_id\n      ,  short_name\n      ,  specialized_bank_id\n      ,  status\n      ,  tax_code\n      ,  tax_id\n      ,  times_change\n      ,  updated_date\n      ,  vip_code\n      ,  customer_age\n      ,  anniversary_date\n      ,  number_of_lifeinsurance\n      ,  owned_cars\n      ,  owned_houses\n      ,  total_value_of_asset_estimated\n      ,  total_value_of_loan_estimated\n      ,  total_value_of_saving\n      ,  total_value_of_stock\n      ,  insurance_summary_id\n      ,  investment_summary_id\n      ,  business_sector\n      ,  company_address\n      ,  company_name\n      ,  monthy_income\n      ,  other_note\n      ,  position\n      ,  position_other\n      ,  source_of_income\n      ,  fx_id\n      ,  customer_group\n      ,  customer_rank\n      ,  id_date\n      ,  id_place\n      ,  main_id_number\n      ,  main_passport\n      ,  passport_date\n      ,  id_number\n      ,  passport_id\n      ,  activities_id\n      ,  day_of_birth\n      ,  month_of_birth\n      ,  close_datetc\n      ,  customer_segment\n      ,  open_datetc\n      ,  customer_rank_lastm\n      ,  level1branch_id\n      ,  owner_id\n      ,  fx_fn_id\n      ,  insurance_fn_id\n      ,  investment_fn_id\n      ,  taxcode\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_customer @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_customer"}, "model.dga_data_model.stg_landing__sppl_m_flow_activities_status": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_flow_activities_status"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_flow_activities_status", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  activities_id\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  new_version\r\n      ,  selling_status_id\r\n      ,  status\r\n      ,  step_status\r\n      , CASE step_status\r\n          WHEN 'DONE' THEN 'Ho\u00e0n th\u00e0nh'\r\n          WHEN 'ACTIVE' THEN '\u0110ang th\u1ef1c hi\u1ec7n'\r\n          WHEN 'CLOSE' THEN 'Th\u1ea5t b\u1ea1i'\r\n          WHEN 'PENDING' THEN '\u0110ang Ch\u1edd'\r\n          ELSE ''\r\n        END AS vn_step_status\r\n      ,  times_change\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_flow_activities_status.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_flow_activities_status.sql", "name": "stg_landing__sppl_m_flow_activities_status", "alias": "stg_landing__sppl_m_flow_activities_status", "checksum": {"name": "sha256", "checksum": "f5ae92fda21163bef97c03d75edca1198c4b2654d8ced0f2af757fd0c11ae2f5"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_flow_activities_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.987217, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  activities_id\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  effective_date\n      ,  expire_date\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  new_version\n      ,  selling_status_id\n      ,  status\n      ,  step_status\n      , CASE step_status\n          WHEN 'DONE' THEN 'Ho\u00e0n th\u00e0nh'\n          WHEN 'ACTIVE' THEN '\u0110ang th\u1ef1c hi\u1ec7n'\n          WHEN 'CLOSE' THEN 'Th\u1ea5t b\u1ea1i'\n          WHEN 'PENDING' THEN '\u0110ang Ch\u1edd'\n          ELSE ''\n        END AS vn_step_status\n      ,  times_change\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_flow_activities_status"}, "model.dga_data_model.stg_landing__sppl_m_lead": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_lead @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_lead"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_lead", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  address\r\n      ,  assigned_user_id\r\n      ,  branch_id\r\n      ,  code\r\n      ,  created_by\r\n      ,  customer_id\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  district_id\r\n      ,  effective_date\r\n      ,  email\r\n      ,  expire_date\r\n      ,  full_name\r\n      ,  identification_id\r\n      ,  identify_number\r\n      ,  income_source_id\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  lead_status_id\r\n      ,  loan_amount\r\n      ,  monthly_income_id\r\n      ,  new_version\r\n      ,  province_id\r\n      ,  status\r\n      ,  team_group_id\r\n      ,  times_change\r\n      ,  advisory_branch_id\r\n      ,  agency\r\n      ,  career_id\r\n      ,  contact_result_id\r\n      ,  contact_status_id\r\n      ,  converted\r\n      ,  country_id\r\n      ,  date_of_birth\r\n      ,  education_level_id\r\n      ,  email1\r\n      ,  email2\r\n      ,  first_name\r\n      ,  full_address\r\n      ,  gender\r\n      ,  home_phone\r\n      ,  interest_product\r\n      ,  interest_product_list\r\n      ,  issue_date\r\n      ,  issue_place\r\n      ,  last_name\r\n      ,  marital_status_id\r\n      ,  msb_customer\r\n      ,  msb_staff\r\n      ,  note\r\n      ,  note_identify\r\n      ,  owner_branch_id\r\n      ,  sale_owner_id\r\n      ,  street_id\r\n      ,  team_id\r\n      ,  tele_sale_id\r\n      ,  tele_sale_note\r\n      ,  utm_campaign\r\n      ,  utm_content\r\n      ,  utm_medium\r\n      ,  utm_source\r\n      ,  ward_id\r\n      ,  work_phone\r\n      ,  income\r\n      ,  cif_number\r\n      ,  amount\r\n      ,  branch_advice_id\r\n      ,  customer_msb\r\n      ,  customer_register\r\n      ,  product_cat_name\r\n      ,  product_name\r\n      ,  reject\r\n      ,  tls_call_cus_result\r\n      ,  tls_call_customer\r\n      ,  tls_code\r\n      ,  tls_mobile\r\n      ,  tls_name\r\n      ,  tls_note\r\n      ,  transaction_id\r\n      ,  lead_source\r\n      ,  tls_call_cus_status\r\n      ,  lead_source_id\r\n      ,  company\r\n      ,  mobile\r\n      ,  position\r\n      ,  sex\r\n      ,  age\r\n      ,  expiration_lead\r\n      ,  note1\r\n      ,  note2\r\n      ,  note3\r\n      ,  note4\r\n      ,  draft\r\n      ,  has_many_draft\r\n      ,  activities_id\r\n      ,  full_name_strip\r\n      ,  branch_advice_name\r\n      ,  district_name\r\n      ,  identification_name\r\n      ,  income_source_name\r\n      ,  lead_source_name\r\n      ,  lead_status_name\r\n      ,  monthly_income_name\r\n      ,  province_name\r\n      ,  transaction_name\r\n      ,  clone\r\n      ,  mobile2\r\n      ,  is_new\r\n      ,  success_selling\r\n      ,  tax_code\r\n      ,  product_ids\r\n      ,  branch_name\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_lead @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_lead.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_lead.sql", "name": "stg_landing__sppl_m_lead", "alias": "stg_landing__sppl_m_lead", "checksum": {"name": "sha256", "checksum": "b86fc90bea4266f8b4359ae3045a866d9511c8666c7a790375b9f6897ec05c51"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_lead @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_lead.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.9892166, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  address\n      ,  assigned_user_id\n      ,  branch_id\n      ,  code\n      ,  created_by\n      ,  customer_id\n      ,  date_created\n      ,  deleted\n      ,  district_id\n      ,  effective_date\n      ,  email\n      ,  expire_date\n      ,  full_name\n      ,  identification_id\n      ,  identify_number\n      ,  income_source_id\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  lead_status_id\n      ,  loan_amount\n      ,  monthly_income_id\n      ,  new_version\n      ,  province_id\n      ,  status\n      ,  team_group_id\n      ,  times_change\n      ,  advisory_branch_id\n      ,  agency\n      ,  career_id\n      ,  contact_result_id\n      ,  contact_status_id\n      ,  converted\n      ,  country_id\n      ,  date_of_birth\n      ,  education_level_id\n      ,  email1\n      ,  email2\n      ,  first_name\n      ,  full_address\n      ,  gender\n      ,  home_phone\n      ,  interest_product\n      ,  interest_product_list\n      ,  issue_date\n      ,  issue_place\n      ,  last_name\n      ,  marital_status_id\n      ,  msb_customer\n      ,  msb_staff\n      ,  note\n      ,  note_identify\n      ,  owner_branch_id\n      ,  sale_owner_id\n      ,  street_id\n      ,  team_id\n      ,  tele_sale_id\n      ,  tele_sale_note\n      ,  utm_campaign\n      ,  utm_content\n      ,  utm_medium\n      ,  utm_source\n      ,  ward_id\n      ,  work_phone\n      ,  income\n      ,  cif_number\n      ,  amount\n      ,  branch_advice_id\n      ,  customer_msb\n      ,  customer_register\n      ,  product_cat_name\n      ,  product_name\n      ,  reject\n      ,  tls_call_cus_result\n      ,  tls_call_customer\n      ,  tls_code\n      ,  tls_mobile\n      ,  tls_name\n      ,  tls_note\n      ,  transaction_id\n      ,  lead_source\n      ,  tls_call_cus_status\n      ,  lead_source_id\n      ,  company\n      ,  mobile\n      ,  position\n      ,  sex\n      ,  age\n      ,  expiration_lead\n      ,  note1\n      ,  note2\n      ,  note3\n      ,  note4\n      ,  draft\n      ,  has_many_draft\n      ,  activities_id\n      ,  full_name_strip\n      ,  branch_advice_name\n      ,  district_name\n      ,  identification_name\n      ,  income_source_name\n      ,  lead_source_name\n      ,  lead_status_name\n      ,  monthly_income_name\n      ,  province_name\n      ,  transaction_name\n      ,  clone\n      ,  mobile2\n      ,  is_new\n      ,  success_selling\n      ,  tax_code\n      ,  product_ids\n      ,  branch_name\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_lead @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_lead"}, "model.dga_data_model.stg_landing__sppl_m_selling_opportunity": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_selling_opportunity"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  area_id\r\n      ,  branch_id\r\n      ,  created_by\r\n      ,  customer_id\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  name\r\n      ,  new_version\r\n      ,  product_id\r\n      ,  sale_code\r\n      ,  sale_name\r\n      ,  sale_title\r\n      ,  selling_opportunity_owner_id\r\n      ,  status\r\n      ,  times_change\r\n      ,  lead_id\r\n      ,  selling_status\r\n      ,  team_group_id\r\n      ,  owner_id\r\n      ,  cmt\r\n      ,  activities_id\r\n      ,  last_status_change\r\n      ,  selling_status_name\r\n      ,  area_level2_id\r\n      ,  draft\r\n      ,  is_second_hand\r\n      ,  los_open_close\r\n      ,  los_status_name\r\n      ,  campaign_id\r\n      ,  average_income\r\n      ,  cif_number\r\n      ,  loan_limit\r\n      ,  note1\r\n      ,  note2\r\n      ,  note3\r\n      ,  note4\r\n      ,  note5\r\n      ,  note6\r\n      ,  is_auto_close\r\n      ,  account_planning_id\r\n      ,  product_code\r\n      ,  is_out_datexltc\r\n      ,  ma_ho_so\r\n      ,  last_assign_date\r\n      ,  los_fail_date\r\n      ,  selling_opportunity_tnr_id\r\n      ,  note7\r\n      ,  note8\r\n      ,  note9\r\n      ,  note10\r\n      ,  note11\r\n      ,  note12\r\n      ,  note13\r\n      ,  note14\r\n      ,  note15\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL' )}}\r\n    WHERE deleted = 0\r\n      AND (last_updated > to_date('14/02/2022','dd/mm/yyyy') OR date_created > to_date('14/02/2022','dd/mm/yyyy'))\r\n      AND date_created >= to_date('07/06/2021','dd/mm/yyyy')", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_selling_opportunity.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_selling_opportunity.sql", "name": "stg_landing__sppl_m_selling_opportunity", "alias": "stg_landing__sppl_m_selling_opportunity", "checksum": {"name": "sha256", "checksum": "7989608196f62d27e753f572497d7905f8f84898143df54fcba4f1a922b43061"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_selling_opportunity.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.991217, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  area_id\n      ,  branch_id\n      ,  created_by\n      ,  customer_id\n      ,  date_created\n      ,  deleted\n      ,  effective_date\n      ,  expire_date\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  name\n      ,  new_version\n      ,  product_id\n      ,  sale_code\n      ,  sale_name\n      ,  sale_title\n      ,  selling_opportunity_owner_id\n      ,  status\n      ,  times_change\n      ,  lead_id\n      ,  selling_status\n      ,  team_group_id\n      ,  owner_id\n      ,  cmt\n      ,  activities_id\n      ,  last_status_change\n      ,  selling_status_name\n      ,  area_level2_id\n      ,  draft\n      ,  is_second_hand\n      ,  los_open_close\n      ,  los_status_name\n      ,  campaign_id\n      ,  average_income\n      ,  cif_number\n      ,  loan_limit\n      ,  note1\n      ,  note2\n      ,  note3\n      ,  note4\n      ,  note5\n      ,  note6\n      ,  is_auto_close\n      ,  account_planning_id\n      ,  product_code\n      ,  is_out_datexltc\n      ,  ma_ho_so\n      ,  last_assign_date\n      ,  los_fail_date\n      ,  selling_opportunity_tnr_id\n      ,  note7\n      ,  note8\n      ,  note9\n      ,  note10\n      ,  note11\n      ,  note12\n      ,  note13\n      ,  note14\n      ,  note15\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL\n    WHERE deleted = 0\n      AND (last_updated > to_date('14/02/2022','dd/mm/yyyy') OR date_created > to_date('14/02/2022','dd/mm/yyyy'))\n      AND date_created >= to_date('07/06/2021','dd/mm/yyyy')", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_opportunity"}, "model.dga_data_model.stg_landing__sppl_m_selling_status": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_selling_status @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_selling_status"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_selling_status", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  code\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  name\r\n      ,  new_version\r\n      ,  status\r\n      ,  times_change\r\n      ,  sort\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_selling_status @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_selling_status.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_selling_status.sql", "name": "stg_landing__sppl_m_selling_status", "alias": "stg_landing__sppl_m_selling_status", "checksum": {"name": "sha256", "checksum": "014f612d45a1fd4b230c1d1cdc731a7c04db1e8c6fe8080b88d17458a9a29cb2"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_selling_status @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_selling_status.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.9932168, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  code\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  effective_date\n      ,  expire_date\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  name\n      ,  new_version\n      ,  status\n      ,  times_change\n      ,  sort\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_selling_status @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_selling_status"}, "model.dga_data_model.stg_landing__sppl_m_team_group": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_team_group @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_team_group"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_team_group", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  branch_id\r\n      ,  created_date\r\n      ,  name\r\n      ,  updated_date\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  code\r\n      ,  description\r\n      ,  effective_date\r\n      ,  expire_date\r\n      ,  latest\r\n      ,  new_version\r\n      ,  sort_order\r\n      ,  status\r\n      ,  times_change\r\n      ,  email_leader\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_team_group @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_team_group.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_team_group.sql", "name": "stg_landing__sppl_m_team_group", "alias": "stg_landing__sppl_m_team_group", "checksum": {"name": "sha256", "checksum": "c9bdb5c0d6356d9de540cbee2fb29ae811646ec20d54f96a3c172fbeb8797581"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_team_group @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_team_group.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.995219, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  branch_id\n      ,  created_date\n      ,  name\n      ,  updated_date\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  last_updated\n      ,  last_updated_by\n      ,  code\n      ,  description\n      ,  effective_date\n      ,  expire_date\n      ,  latest\n      ,  new_version\n      ,  sort_order\n      ,  status\n      ,  times_change\n      ,  email_leader\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_team_group @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_team_group"}, "model.dga_data_model.stg_landing__sppl_m_user": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.venus_bulanding.sppl_m_user @DGA_READ_BULANDING_DBL"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["venus_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "venus", "source", "stg_landing__sppl_m_user"], "unique_id": "model.dga_data_model.stg_landing__sppl_m_user", "raw_code": "{{ config( materialized='view') }}\r\n    SELECT\r\n        id\r\n      ,  version\r\n      ,  account_expired\r\n      ,  account_locked\r\n      ,  branch_id\r\n      ,  created_by\r\n      ,  date_created\r\n      ,  deleted\r\n      ,  effective_date\r\n      ,  email\r\n      ,  employee_code\r\n      ,  enabled\r\n      ,  expire_date\r\n      ,  fullname\r\n      ,  job_title_id\r\n      ,  last_login\r\n      ,  last_logout\r\n      ,  last_updated\r\n      ,  last_updated_by\r\n      ,  latest\r\n      ,  new_version\r\n      ,  password_expired\r\n      ,  status\r\n      ,  times_change\r\n      ,  username\r\n      ,  phone_number\r\n      ,  sale_code\r\n      ,  point_rm\r\n      ,  rank_rm\r\n      ,  rmsegment_dic_id\r\n      ,  job_title2\r\n      ,  etl_date\r\n\r\n    FROM\r\n      {{ source('venus_bulanding', 'sppl_m_user @DGA_READ_BULANDING_DBL' )}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\venus\\source\\stg_landing__sppl_m_user.sql", "original_file_path": "models\\staging\\venus\\source\\stg_landing__sppl_m_user.sql", "name": "stg_landing__sppl_m_user", "alias": "stg_landing__sppl_m_user", "checksum": {"name": "sha256", "checksum": "bcfb0038d69bbf2d9a2308d879d934b4f4b3bf90e12dc7c81fe2cdc9743c42a7"}, "tags": ["venus_daily"], "refs": [], "sources": [["venus_bulanding", "sppl_m_user @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\venus\\source\\stg_landing__sppl_m_user.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "venus_daily", "materialized": "view"}, "created_at": 1685959751.9972284, "compiled_code": "\n    SELECT\n        id\n      ,  version\n      ,  account_expired\n      ,  account_locked\n      ,  branch_id\n      ,  created_by\n      ,  date_created\n      ,  deleted\n      ,  effective_date\n      ,  email\n      ,  employee_code\n      ,  enabled\n      ,  expire_date\n      ,  fullname\n      ,  job_title_id\n      ,  last_login\n      ,  last_logout\n      ,  last_updated\n      ,  last_updated_by\n      ,  latest\n      ,  new_version\n      ,  password_expired\n      ,  status\n      ,  times_change\n      ,  username\n      ,  phone_number\n      ,  sale_code\n      ,  point_rm\n      ,  rank_rm\n      ,  rmsegment_dic_id\n      ,  job_title2\n      ,  etl_date\n\n    FROM\n      oracle_bulanding.df_2.sppl_m_user @DGA_READ_BULANDING_DBL", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_landing__sppl_m_user"}, "model.dga_data_model.stg_vision_tmp__contracts": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.contracts"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "contract_sequence_number", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "vision", "stg_vision_tmp__contracts"], "unique_id": "model.dga_data_model.stg_vision_tmp__contracts", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key='contract_sequence_number'\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      contract_sequence_number\r\n    , country\r\n    , le_book\r\n    , customer_id\r\n    , contract_id\r\n    , record_type_nt\r\n    , record_type\r\n    , source_id_nt\r\n    , source_id\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , account_officer\r\n    , issue_id\r\n    , deal_type\r\n    , deal_sub_type\r\n    , start_date\r\n    , maturity_date\r\n    , settlement_date\r\n    , days_remaining_mat\r\n    , days_start_mat\r\n    , accrual_status_nt\r\n    , accrual_status\r\n    , contract_status_nt\r\n    , contract_status\r\n    , principal_gl\r\n    , principal_amount\r\n    , mis_currency\r\n    , pool_code\r\n    , interest_rate\r\n    , cost_of_funds_rate\r\n    , gl_enrich_id\r\n    , date_last_modified\r\n    , date_creation\r\n    , status_nt\r\n    , status\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n  FROM {{ source('vision', 'contracts') }}\r\n  WHERE date_last_modified > date_add('day', -4, current_date)\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\vision\\stg_vision_tmp__contracts.sql", "original_file_path": "models\\staging\\vision\\stg_vision_tmp__contracts.sql", "name": "stg_vision_tmp__contracts", "alias": "stg_vision_tmp__contracts", "checksum": {"name": "sha256", "checksum": "4da2cc7b094c138e70d40224bedcf947a810b78754ea5998432325037e4e6d0c"}, "tags": ["vision_etl"], "refs": [], "sources": [["vision", "contracts"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\vision\\stg_vision_tmp__contracts.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table", "unique_key": "contract_sequence_number"}, "created_at": 1685959753.2633665, "compiled_code": "\nWITH source AS(\n  SELECT\n      contract_sequence_number\n    , country\n    , le_book\n    , customer_id\n    , contract_id\n    , record_type_nt\n    , record_type\n    , source_id_nt\n    , source_id\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , account_officer\n    , issue_id\n    , deal_type\n    , deal_sub_type\n    , start_date\n    , maturity_date\n    , settlement_date\n    , days_remaining_mat\n    , days_start_mat\n    , accrual_status_nt\n    , accrual_status\n    , contract_status_nt\n    , contract_status\n    , principal_gl\n    , principal_amount\n    , mis_currency\n    , pool_code\n    , interest_rate\n    , cost_of_funds_rate\n    , gl_enrich_id\n    , date_last_modified\n    , date_creation\n    , status_nt\n    , status\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n  FROM oracle_vision.vision.contracts\n  WHERE date_last_modified > date_add('day', -4, current_date)\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_vision_tmp__contracts"}, "model.dga_data_model.stg_vision_tmp__customers": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.customers"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "customer_id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "vision", "stg_vision_tmp__customers"], "unique_id": "model.dga_data_model.stg_vision_tmp__customers", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key='customer_id'\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , customer_id\r\n    , customer_name\r\n    , customer_acronym\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , global_customer_id\r\n    , naics_code\r\n    , cb_org_code_at\r\n    , cb_org_code\r\n    , cb_economic_act_code_at\r\n    , cb_economic_act_code\r\n    , cb_domicile\r\n    , cb_nationality\r\n    , cb_residence\r\n    , cb_major_party_indicator\r\n    , customer_id_type_at\r\n    , customer_id_type\r\n    , id_details\r\n    , primary_cid\r\n    , parent_cid\r\n    , ultimate_parent\r\n    , customer_hierarchy_1\r\n    , customer_hierarchy_2\r\n    , customer_hierarchy_3\r\n    , account_officer\r\n    , customer_sex_at\r\n    , customer_sex\r\n    , credit_classification_at\r\n    , credit_classification\r\n    , external_risk_rating_at\r\n    , external_risk_rating\r\n    , obligor_risk_rating_at\r\n    , obligor_risk_rating\r\n    , related_party_at\r\n    , related_party\r\n    , customer_tiering_at\r\n    , customer_tiering\r\n    , sales_acquisition_channel_at\r\n    , sales_acquisition_channel\r\n    , marketing_campaign\r\n    , crosssale_refer_id\r\n    , customer_indicator_at\r\n    , customer_indicator\r\n    , num_of_accounts\r\n    , customer_attribute_1\r\n    , customer_attribute_2\r\n    , customer_attribute_3\r\n    , customer_status_nt\r\n    , customer_status\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n    , customer_open_date\r\n    , comm_address_1\r\n    , comm_address_2\r\n    , comm_city_at\r\n    , comm_city\r\n    , comm_state_at\r\n    , comm_state\r\n    , comm_pin_code\r\n    , phone_number\r\n    , customer_tin\r\n    , customer_type_code_at\r\n    , customer_type_code\r\n    , profit_center\r\n    , customer_segment_at\r\n    , customer_segment\r\n    , customer_user_segment_at\r\n    , customer_user_segment\r\n  FROM {{ source('vision', 'customers') }}\r\n  WHERE date_last_modified > date_add('day', -4, current_date)\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\vision\\stg_vision_tmp__customers.sql", "original_file_path": "models\\staging\\vision\\stg_vision_tmp__customers.sql", "name": "stg_vision_tmp__customers", "alias": "stg_vision_tmp__customers", "checksum": {"name": "sha256", "checksum": "0384e1a23bb70f8255dfe7313f7996427b5fd1d4dac835a0707097d85c4a4d91"}, "tags": ["vision_etl"], "refs": [], "sources": [["vision", "customers"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\vision\\stg_vision_tmp__customers.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table", "unique_key": "customer_id"}, "created_at": 1685959753.2653556, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , customer_id\n    , customer_name\n    , customer_acronym\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , global_customer_id\n    , naics_code\n    , cb_org_code_at\n    , cb_org_code\n    , cb_economic_act_code_at\n    , cb_economic_act_code\n    , cb_domicile\n    , cb_nationality\n    , cb_residence\n    , cb_major_party_indicator\n    , customer_id_type_at\n    , customer_id_type\n    , id_details\n    , primary_cid\n    , parent_cid\n    , ultimate_parent\n    , customer_hierarchy_1\n    , customer_hierarchy_2\n    , customer_hierarchy_3\n    , account_officer\n    , customer_sex_at\n    , customer_sex\n    , credit_classification_at\n    , credit_classification\n    , external_risk_rating_at\n    , external_risk_rating\n    , obligor_risk_rating_at\n    , obligor_risk_rating\n    , related_party_at\n    , related_party\n    , customer_tiering_at\n    , customer_tiering\n    , sales_acquisition_channel_at\n    , sales_acquisition_channel\n    , marketing_campaign\n    , crosssale_refer_id\n    , customer_indicator_at\n    , customer_indicator\n    , num_of_accounts\n    , customer_attribute_1\n    , customer_attribute_2\n    , customer_attribute_3\n    , customer_status_nt\n    , customer_status\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n    , customer_open_date\n    , comm_address_1\n    , comm_address_2\n    , comm_city_at\n    , comm_city\n    , comm_state_at\n    , comm_state\n    , comm_pin_code\n    , phone_number\n    , customer_tin\n    , customer_type_code_at\n    , customer_type_code\n    , profit_center\n    , customer_segment_at\n    , customer_segment\n    , customer_user_segment_at\n    , customer_user_segment\n  FROM oracle_vision.vision.customers\n  WHERE date_last_modified > date_add('day', -4, current_date)\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_vision_tmp__customers"}, "model.dga_data_model.stg_vision_tmp__fin_dly_balances": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "vision", "stg_vision_tmp__fin_dly_balances"], "unique_id": "model.dga_data_model.stg_vision_tmp__fin_dly_balances", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , dr_cr_bal_ind\r\n    , bal_type_nt\r\n    , bal_type\r\n    , bal_start_month\r\n    , balance_01\r\n    , balance_02\r\n    , balance_03\r\n    , balance_04\r\n    , balance_05\r\n    , balance_06\r\n    , balance_07\r\n    , balance_08\r\n    , balance_09\r\n    , balance_10\r\n    , balance_11\r\n    , balance_12\r\n    , balance_13\r\n    , balance_14\r\n    , balance_15\r\n    , balance_16\r\n    , balance_17\r\n    , balance_18\r\n    , balance_19\r\n    , balance_20\r\n    , balance_21\r\n    , balance_22\r\n    , balance_23\r\n    , balance_24\r\n    , balance_25\r\n    , balance_26\r\n    , balance_27\r\n    , balance_28\r\n    , balance_29\r\n    , balance_30\r\n    , balance_31\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM oracle_vision.vision.fin_dly_balances\r\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM  {{ this }} )\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\vision\\stg_vision_tmp__fin_dly_balances.sql", "original_file_path": "models\\staging\\vision\\stg_vision_tmp__fin_dly_balances.sql", "name": "stg_vision_tmp__fin_dly_balances", "alias": "stg_vision_tmp__fin_dly_balances", "checksum": {"name": "sha256", "checksum": "2cf87c75f2f08356c6fcf2dcf6cfca25579bacda5ea80f7ba620d211feddec57"}, "tags": ["vision_etl"], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\vision\\stg_vision_tmp__fin_dly_balances.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table"}, "created_at": 1685959753.266297, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , dr_cr_bal_ind\n    , bal_type_nt\n    , bal_type\n    , bal_start_month\n    , balance_01\n    , balance_02\n    , balance_03\n    , balance_04\n    , balance_05\n    , balance_06\n    , balance_07\n    , balance_08\n    , balance_09\n    , balance_10\n    , balance_11\n    , balance_12\n    , balance_13\n    , balance_14\n    , balance_15\n    , balance_16\n    , balance_17\n    , balance_18\n    , balance_19\n    , balance_20\n    , balance_21\n    , balance_22\n    , balance_23\n    , balance_24\n    , balance_25\n    , balance_26\n    , balance_27\n    , balance_28\n    , balance_29\n    , balance_30\n    , balance_31\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.fin_dly_balances\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM  \"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_balances )\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_balances"}, "model.dga_data_model.stg_vision_tmp__fin_dly_headers": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "vision", "stg_vision_tmp__fin_dly_headers"], "unique_id": "model.dga_data_model.stg_vision_tmp__fin_dly_headers", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , customer_id\r\n    , gl_enrich_id\r\n    , contract_id\r\n    , office_account\r\n    , bs_gl\r\n    , pl_gl\r\n    , vision_ouc\r\n    , vision_sbu_at\r\n    , vision_sbu\r\n    , account_officer\r\n    , cost_center\r\n    , currency\r\n    , mis_currency\r\n    , accrual_status_nt\r\n    , accrual_status\r\n    , credit_line\r\n    , pool_code\r\n    , source_id_nt\r\n    , source_id\r\n    , record_type_nt\r\n    , record_type\r\n    , original_ouc\r\n    , financial_attribute_1\r\n    , financial_attribute_2\r\n    , financial_attribute_3\r\n    , record_indicator_nt\r\n    , record_indicator\r\n    , maker\r\n    , verifier\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM oracle_vision.vision.fin_dly_headers\r\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM  {{ this }} )\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\vision\\stg_vision_tmp__fin_dly_headers.sql", "original_file_path": "models\\staging\\vision\\stg_vision_tmp__fin_dly_headers.sql", "name": "stg_vision_tmp__fin_dly_headers", "alias": "stg_vision_tmp__fin_dly_headers", "checksum": {"name": "sha256", "checksum": "3bc9adfb37aaa4a632ba60e82d04125d7c5f0ed196aa07ee289fe4a5eddec93a"}, "tags": ["vision_etl"], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\vision\\stg_vision_tmp__fin_dly_headers.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table"}, "created_at": 1685959753.2683666, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , customer_id\n    , gl_enrich_id\n    , contract_id\n    , office_account\n    , bs_gl\n    , pl_gl\n    , vision_ouc\n    , vision_sbu_at\n    , vision_sbu\n    , account_officer\n    , cost_center\n    , currency\n    , mis_currency\n    , accrual_status_nt\n    , accrual_status\n    , credit_line\n    , pool_code\n    , source_id_nt\n    , source_id\n    , record_type_nt\n    , record_type\n    , original_ouc\n    , financial_attribute_1\n    , financial_attribute_2\n    , financial_attribute_3\n    , record_indicator_nt\n    , record_indicator\n    , maker\n    , verifier\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.fin_dly_headers\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM  \"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_headers )\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_headers"}, "model.dga_data_model.stg_vision_tmp__fin_dly_mappings": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "vision", "stg_vision_tmp__fin_dly_mappings"], "unique_id": "model.dga_data_model.stg_vision_tmp__fin_dly_mappings", "raw_code": "{{\r\n  config(\r\n    materialized='table'\r\n  )\r\n}}\r\nWITH source AS(\r\n  SELECT\r\n      country\r\n    , le_book\r\n    , year_month\r\n    , sequence_fd\r\n    , dr_cr_bal_ind\r\n    , frl_line_bs\r\n    , frl_line_pl\r\n    , mrl_line\r\n    , product\r\n    , gl_product\r\n    , ouc_override\r\n    , ouc_product\r\n    , internal_status\r\n    , date_last_modified\r\n    , date_creation\r\n  FROM oracle_vision.vision.fin_dly_mappings_pm\r\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM {{ this }} )\r\n)\r\nSELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\vision\\stg_vision_tmp__fin_dly_mappings.sql", "original_file_path": "models\\staging\\vision\\stg_vision_tmp__fin_dly_mappings.sql", "name": "stg_vision_tmp__fin_dly_mappings", "alias": "stg_vision_tmp__fin_dly_mappings", "checksum": {"name": "sha256", "checksum": "604dab85381341c8452fbef40907959ad853f06ab5f2ce69ab09671290661928"}, "tags": ["vision_etl"], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\vision\\vision.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\vision\\stg_vision_tmp__fin_dly_mappings.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table"}, "created_at": 1685959753.269367, "compiled_code": "\nWITH source AS(\n  SELECT\n      country\n    , le_book\n    , year_month\n    , sequence_fd\n    , dr_cr_bal_ind\n    , frl_line_bs\n    , frl_line_pl\n    , mrl_line\n    , product\n    , gl_product\n    , ouc_override\n    , ouc_product\n    , internal_status\n    , date_last_modified\n    , date_creation\n  FROM oracle_vision.vision.fin_dly_mappings_pm\n  WHERE date_last_modified > (SELECT MAX(date_last_modified) FROM \"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_mappings )\n)\nSELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_vision_tmp__fin_dly_mappings"}, "model.dga_data_model.stg_vision__ftp_term_rates": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.vision.ftp_term_rates"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": [], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "vision", "stg_vision__ftp_term_rates"], "unique_id": "model.dga_data_model.stg_vision__ftp_term_rates", "raw_code": "{{\r\n  config(\r\n    materialized = \"table\"\r\n  )\r\n}}\r\nwith dat as(\r\n    SELECT\r\n        ftp_rate_id,\r\n        effective_date,\r\n        ftp_curve,\r\n        ftp_rate_status_nt,\r\n        ftp_rate_status,\r\n        record_indicator_nt,\r\n        record_indicator,\r\n        maker,\r\n        verifier,\r\n        internal_status,\r\n        date_last_modified,\r\n        date_creation,\r\n        insurance_rate,\r\n        required_reserve_rate,\r\n        gl_allocation_rate,\r\n        subsidy,\r\n        addon_deposit_rate,\r\n        addon_lending_rate,\r\n        addon_att_rate1,\r\n        addon_att_rate2,\r\n        addon_att_rate3,\r\n        addon_att_rate4\r\n   FROM {{ source('vision', 'ftp_term_rates') }}\r\n   where date_last_modified > (select max(date_last_modified) from {{ this }})\r\n)\r\nselect *\r\nfrom dat", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\vision\\stg_vision__ftp_term_rates.sql", "original_file_path": "models\\staging\\vision\\stg_vision__ftp_term_rates.sql", "name": "stg_vision__ftp_term_rates", "alias": "stg_vision__ftp_term_rates", "checksum": {"name": "sha256", "checksum": "667f97b485244a36fd60b60c05e4110d973597a45bb3aff68c1b7808becdefd2"}, "tags": [], "refs": [], "sources": [["vision", "ftp_term_rates"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\vision\\stg_vision__ftp_term_rates.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "materialized": "table"}, "created_at": 1685959752.0182226, "compiled_code": "\nwith dat as(\n    SELECT\n        ftp_rate_id,\n        effective_date,\n        ftp_curve,\n        ftp_rate_status_nt,\n        ftp_rate_status,\n        record_indicator_nt,\n        record_indicator,\n        maker,\n        verifier,\n        internal_status,\n        date_last_modified,\n        date_creation,\n        insurance_rate,\n        required_reserve_rate,\n        gl_allocation_rate,\n        subsidy,\n        addon_deposit_rate,\n        addon_lending_rate,\n        addon_att_rate1,\n        addon_att_rate2,\n        addon_att_rate3,\n        addon_att_rate4\n   FROM oracle_vision.vision.ftp_term_rates\n   where date_last_modified > (select max(date_last_modified) from \"oracle_dgaworkzone\".staging.stg_vision__ftp_term_rates)\n)\nselect *\nfrom dat", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_vision__ftp_term_rates"}, "model.dga_data_model.stg_way4__acnt_contract": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.msb.acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["way4_daily", "vision_etl"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "way4", "stg_way4__acnt_contract"], "unique_id": "model.dga_data_model.stg_way4__acnt_contract", "raw_code": "{{\r\n  config(\r\n    materialized='table',\r\n    unique_key='id'\r\n  )\r\n}}\r\nWITH source AS (\r\n  SELECT\r\n      amnd_date\r\n    , amnd_state\r\n    , amnd_officer\r\n    , amnd_prev\r\n    , id\r\n    , pcat\r\n    , con_cat\r\n    , terminal_category\r\n    , ccat\r\n    , f_i\r\n    , branch\r\n    , service_group\r\n    , contract_number\r\n    , contract_name\r\n    , comment_text\r\n    , base_relation\r\n    , relation_tag\r\n    , acnt_contract__id\r\n    , contr_type\r\n    , contr_subtype__id\r\n    , serv_pack__id\r\n    , old_pack\r\n    , channel\r\n    , acc_scheme__id\r\n    , old_scheme\r\n    , product\r\n    , product_prev\r\n    , parent_product\r\n    , main_product\r\n    , client__id\r\n    , client_type\r\n    , acnt_contract__oid\r\n    , liab_category\r\n    , liab_contract\r\n    , liab_contract_prev\r\n    , behavior_group\r\n    , behavior_type\r\n    , behavior_type_prev\r\n    , check_available\r\n    , check_usage\r\n    , curr\r\n    , old_curr\r\n    , auth_limit_amount\r\n    , base_auth_limit\r\n    , liab_balance\r\n    , liab_blocked\r\n    , own_balance\r\n    , own_blocked\r\n    , sub_balance\r\n    , sub_blocked\r\n    , total_blocked\r\n    , total_balance\r\n    , shared_balance\r\n    , shared_blocked\r\n    , amount_available\r\n    , date_open\r\n    , date_expire\r\n    , last_billing_date\r\n    , next_billing_date\r\n    , last_scan\r\n    , card_expire\r\n    , production_status\r\n    , rbs_member_id\r\n    , rbs_number\r\n    , report_type\r\n    , max_pin_attempts\r\n    , pin_attempts\r\n    , chip_scheme\r\n    , risk_scheme\r\n    , risk_factor\r\n    , risk_factor_prev\r\n    , contr_status\r\n    , merchant_id\r\n    , tr_title\r\n    , tr_company\r\n    , tr_country\r\n    , tr_first_nam\r\n    , tr_last_nam\r\n    , tr_sic\r\n    , add_info_01\r\n    , add_info_02\r\n    , add_info_03\r\n    , add_info_04\r\n    , contract_level\r\n    , ext_data\r\n    , report_address\r\n    , share_balance\r\n    , is_multycurrency\r\n    , enables_item\r\n    , cycle_length\r\n    , interval_type\r\n    , status_category\r\n    , limit_is_active\r\n    , settlement_type\r\n    , is_ready\r\n    , billing_contract\r\n    , auth_seq_n\r\n    , routing_idt\r\n    , apply_dt\r\n    , local_version\r\n    , remote_version\r\nFROM\r\n  {{ source('msb', 'acnt_contract') }}\r\n  WHERE last_scan > (SELECT MAX (last_scan) FROM {{ this }} )\r\n)\r\n  SELECT * FROM source", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\way4\\stg_way4__acnt_contract.sql", "original_file_path": "models\\staging\\way4\\stg_way4__acnt_contract.sql", "name": "stg_way4__acnt_contract", "alias": "stg_way4__acnt_contract", "checksum": {"name": "sha256", "checksum": "0a099305cf12eedabd9d44c6ae0cf70ba8499fb6d8efbe41b667c64ce12d84ba"}, "tags": ["way4_daily", "vision_etl"], "refs": [], "sources": [["msb", "acnt_contract"]], "metrics": [], "description": "", "columns": {"id": {"name": "id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": "dga_data_model://models\\staging\\way4\\way4.yml", "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\way4\\stg_way4__acnt_contract.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": ["vision_etl"], "materialized": "table", "unique_key": "id"}, "created_at": 1685959753.2713683, "compiled_code": "\nWITH source AS (\n  SELECT\n      amnd_date\n    , amnd_state\n    , amnd_officer\n    , amnd_prev\n    , id\n    , pcat\n    , con_cat\n    , terminal_category\n    , ccat\n    , f_i\n    , branch\n    , service_group\n    , contract_number\n    , contract_name\n    , comment_text\n    , base_relation\n    , relation_tag\n    , acnt_contract__id\n    , contr_type\n    , contr_subtype__id\n    , serv_pack__id\n    , old_pack\n    , channel\n    , acc_scheme__id\n    , old_scheme\n    , product\n    , product_prev\n    , parent_product\n    , main_product\n    , client__id\n    , client_type\n    , acnt_contract__oid\n    , liab_category\n    , liab_contract\n    , liab_contract_prev\n    , behavior_group\n    , behavior_type\n    , behavior_type_prev\n    , check_available\n    , check_usage\n    , curr\n    , old_curr\n    , auth_limit_amount\n    , base_auth_limit\n    , liab_balance\n    , liab_blocked\n    , own_balance\n    , own_blocked\n    , sub_balance\n    , sub_blocked\n    , total_blocked\n    , total_balance\n    , shared_balance\n    , shared_blocked\n    , amount_available\n    , date_open\n    , date_expire\n    , last_billing_date\n    , next_billing_date\n    , last_scan\n    , card_expire\n    , production_status\n    , rbs_member_id\n    , rbs_number\n    , report_type\n    , max_pin_attempts\n    , pin_attempts\n    , chip_scheme\n    , risk_scheme\n    , risk_factor\n    , risk_factor_prev\n    , contr_status\n    , merchant_id\n    , tr_title\n    , tr_company\n    , tr_country\n    , tr_first_nam\n    , tr_last_nam\n    , tr_sic\n    , add_info_01\n    , add_info_02\n    , add_info_03\n    , add_info_04\n    , contract_level\n    , ext_data\n    , report_address\n    , share_balance\n    , is_multycurrency\n    , enables_item\n    , cycle_length\n    , interval_type\n    , status_category\n    , limit_is_active\n    , settlement_type\n    , is_ready\n    , billing_contract\n    , auth_seq_n\n    , routing_idt\n    , apply_dt\n    , local_version\n    , remote_version\nFROM\n  oracle_way4.msb.acnt_contract\n  WHERE last_scan > (SELECT MAX (last_scan) FROM \"oracle_dgaworkzone\".staging.stg_way4__acnt_contract )\n)\n  SELECT * FROM source", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_way4__acnt_contract"}, "model.dga_data_model.stg_way4__cr_limit_log": {"compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.dga_data_model.msb.cr_limit_log"]}, "config": {"enabled": true, "alias": null, "schema": "staging", "database": null, "tags": ["way4_daily"], "meta": {"owner": "huyendtk3"}, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "staging", "way4", "stg_way4__cr_limit_log"], "unique_id": "model.dga_data_model.stg_way4__cr_limit_log", "raw_code": "{{\r\n    config(\r\n        materialized='table'\r\n    )\r\n}}\r\nSELECT id,\r\n    acnt_contract__oid as acnt_contract_oid,\r\n    doc__id            as doc_id,\r\n    doc__orig__id      as doc_orig_id,\r\n    curr,\r\n    amount,\r\n    result_amount,\r\n    credit_type,\r\n    credit_status,\r\n    credit_class,\r\n    trans_details,\r\n    reason_details,\r\n    posted_dt,\r\n    closed_dt,\r\n    input_dt,\r\n    date_from,\r\n    date_to,\r\n    officer,\r\n    source_contract,\r\n    cast(to_char(posted_dt,'yyyymmdd')  as int) etl_date\r\nFROM  {{ source('msb', 'cr_limit_log' ) }}\r\nWHERE posted_dt > (select max(posted_dt) from {{ this }} )", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "staging\\way4\\stg_way4__cr_limit_log.sql", "original_file_path": "models\\staging\\way4\\stg_way4__cr_limit_log.sql", "name": "stg_way4__cr_limit_log", "alias": "stg_way4__cr_limit_log", "checksum": {"name": "sha256", "checksum": "458533f2bb1e98c425932795826b1a509110512090306a7b940d7e84d8ea2ba3"}, "tags": ["way4_daily"], "refs": [], "sources": [["msb", "cr_limit_log"]], "metrics": [], "description": "", "columns": {}, "meta": {"owner": "huyendtk3"}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\way4\\stg_way4__cr_limit_log.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "staging", "meta": {"owner": "huyendtk3"}, "tags": "way4_daily", "materialized": "table"}, "created_at": 1685959752.0272555, "compiled_code": "\nSELECT id,\n    acnt_contract__oid as acnt_contract_oid,\n    doc__id            as doc_id,\n    doc__orig__id      as doc_orig_id,\n    curr,\n    amount,\n    result_amount,\n    credit_type,\n    credit_status,\n    credit_class,\n    trans_details,\n    reason_details,\n    posted_dt,\n    closed_dt,\n    input_dt,\n    date_from,\n    date_to,\n    officer,\n    source_contract,\n    cast(to_char(posted_dt,'yyyymmdd')  as int) etl_date\nFROM  oracle_way4.msb.cr_limit_log\nWHERE posted_dt > (select max(posted_dt) from \"oracle_dgaworkzone\".staging.stg_way4__cr_limit_log )", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_way4__cr_limit_log"}, "snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd": {"compiled": true, "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_bpm_vhkq__staff"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "strategy": "timestamp", "target_schema": "staging", "updated_at": "updated_at", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "vhkq", "stg_bpm_vhkq__staff_tsd", "stg_bpm_vhkq__staff_tsd"], "unique_id": "snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd", "raw_code": "\r\n\r\n{{\r\n    config(\r\n      target_schema='staging',\r\n      unique_key='id',\r\n      strategy='timestamp',\r\n      updated_at='updated_at'\r\n    )\r\n}}\r\nSELECT\r\n    *\r\nfrom {{ ref ('stg_bpm_vhkq__staff') }}\r\n\r\n", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "vhkq\\stg_bpm_vhkq__staff_tsd.sql", "original_file_path": "snapshots\\vhkq\\stg_bpm_vhkq__staff_tsd.sql", "name": "stg_bpm_vhkq__staff_tsd", "alias": "stg_bpm_vhkq__staff_tsd", "checksum": {"name": "sha256", "checksum": "f18912e5cad1e411e5672ea178f2bb62a1359b27e467a02a02e6af4ed5cd2290"}, "tags": [], "refs": [["stg_bpm_vhkq__staff"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "staging", "unique_key": "id", "strategy": "timestamp", "updated_at": "updated_at"}, "created_at": 1685959752.0412164, "compiled_code": "\n\n\nSELECT\n    *\nfrom \"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_bpm_vhkq__staff_tsd"}, "snapshot.dga_data_model.stg_mart__atm_dim": {"compiled": true, "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mart_vhkq__atm"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "atm_code", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "strategy": "check", "target_schema": "staging", "check_cols": "all", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "vhkq", "stg_mart__atm_dim", "stg_mart__atm_dim"], "unique_id": "snapshot.dga_data_model.stg_mart__atm_dim", "raw_code": "\r\n\r\n{{\r\n    config(\r\n      target_schema='staging',\r\n      unique_key='atm_code',\r\n      strategy='check',\r\n      check_cols='all'\r\n    )\r\n}}\r\nSELECT\r\n    *\r\nfrom {{ ref ('stg_mart_vhkq__atm') }}\r\n\r\n", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "vhkq\\stg_mart__atm_dim.sql", "original_file_path": "snapshots\\vhkq\\stg_mart__atm_dim.sql", "name": "stg_mart__atm_dim", "alias": "stg_mart__atm_dim", "checksum": {"name": "sha256", "checksum": "8c23fe47f52fa4e54fd282f95bed06e992dd1fb1305af468600d0076f2f327df"}, "tags": [], "refs": [["stg_mart_vhkq__atm"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "staging", "unique_key": "atm_code", "strategy": "check", "check_cols": "all"}, "created_at": 1685959752.0471473, "compiled_code": "\n\n\nSELECT\n    *\nfrom \"oracle_dgaworkzone\".staging.stg_mart_vhkq__atm\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart__atm_dim"}, "snapshot.dga_data_model.stg_mart__sub_branch": {"compiled": true, "resource_type": "snapshot", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg_mart_vhkq__subbranch_dim"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "snapshot", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "id_upd", "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "strategy": "check", "target_schema": "staging", "check_cols": "all", "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "staging", "fqn": ["dga_data_model", "vhkq", "stg_mart__sub_branch", "stg_mart__sub_branch"], "unique_id": "snapshot.dga_data_model.stg_mart__sub_branch", "raw_code": "\r\n\r\n{{\r\n    config(\r\n      target_schema='staging',\r\n      unique_key='id_upd',\r\n      strategy='check',\r\n      check_cols='all'\r\n    )\r\n}}\r\nSELECT\r\n    *\r\nfrom {{ ref ('stg_mart_vhkq__subbranch_dim') }}\r\n\r\n", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "vhkq\\stg_mart__sub_branch.sql", "original_file_path": "snapshots\\vhkq\\stg_mart__sub_branch.sql", "name": "stg_mart__sub_branch", "alias": "stg_mart__sub_branch", "checksum": {"name": "sha256", "checksum": "ec9d4d04b1e5c0264429472b7d68265931454e88e40f5499d17d3ce018682583"}, "tags": [], "refs": [["stg_mart_vhkq__subbranch_dim"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"target_schema": "staging", "unique_key": "id_upd", "strategy": "check", "check_cols": "all"}, "created_at": 1685959752.0512173, "compiled_code": "\n\n\nSELECT\n    *\nfrom \"oracle_dgaworkzone\".staging.stg_mart_vhkq__subbranch_dim\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "\"oracle_dgaworkzone\".staging.stg_mart__sub_branch"}, "test.dga_data_model.fct__trans_casa_test_sum": {"resource_type": "test", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.fct__trans_casa_test"]}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "fct__trans_casa_test_sum"], "unique_id": "test.dga_data_model.fct__trans_casa_test_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_dwh', 'ddft_transaction @DGA_READ_DWHPRO_DBL')}} a\r\nWHERE trn_date = {{ var('julian_date')}}\r\nminus\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('fct__trans_casa_test')}}\r\nWHERE trn_date = {{ var('julian_date')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "fct__trans_casa_test_sum.sql", "original_file_path": "tests\\fct__trans_casa_test_sum.sql", "name": "fct__trans_casa_test_sum", "alias": "fct__trans_casa_test_sum", "checksum": {"name": "sha256", "checksum": "4350d4ae3f7516042653323c2c571c5defa5f72fe23df2858ad4d3b77420da88"}, "tags": [], "refs": [["fct__trans_casa_test"]], "sources": [["compare_dwh", "ddft_transaction @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.0931466}, "test.dga_data_model.stg__ddft_transaction_test": {"resource_type": "test", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.stg__ddft_transaction_map_ibmb"]}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "stg__ddft_transaction_test"], "unique_id": "test.dga_data_model.stg__ddft_transaction_test", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_dwh', 'ddft_transaction @DGA_READ_DWHPRO_DBL')}} a\r\nWHERE trn_date = {{ var('julian_date')}}\r\nminus\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('stg__ddft_transaction_map_ibmb')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "stg__ddft_transaction_test.sql", "original_file_path": "tests\\stg__ddft_transaction_test.sql", "name": "stg__ddft_transaction_test", "alias": "stg__ddft_transaction_test", "checksum": {"name": "sha256", "checksum": "7e7fc03529893e8929c544f7bd644e0c9a379a95023da11b06c3a62de44686f4"}, "tags": [], "refs": [["stg__ddft_transaction_map_ibmb"]], "sources": [["compare_dwh", "ddft_transaction @DGA_READ_DWHPRO_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.0981479}, "test.dga_data_model.mart__dim_arrangement_unique": {"compiled": true, "resource_type": "test", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.dim__arrangement"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "singular_test", "mart__dim_arrangement_unique"], "unique_id": "test.dga_data_model.mart__dim_arrangement_unique", "raw_code": "SELECT\r\n  unq_id\r\n, COUNT(1)\r\nFROM {{ ref('dim__arrangement') }}\r\nWHERE is_cur_rec = 1\r\nGROUP BY unq_id\r\nHAVING COUNT (1) > 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\singular_test\\mart__dim_arrangement_unique.sql", "original_file_path": "tests\\daily\\singular_test\\mart__dim_arrangement_unique.sql", "name": "mart__dim_arrangement_unique", "alias": "mart__dim_arrangement_unique", "checksum": {"name": "sha256", "checksum": "ab79764542a2a5f1903204bd52bac13264953a1a3bf0a1683d57a20358915576"}, "tags": [], "refs": [["dim__arrangement"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\tests\\daily\\singular_test\\mart__dim_arrangement_unique.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.236148, "compiled_code": "SELECT\n  unq_id\n, COUNT(1)\nFROM \"oracle_dgaworkzone\".mart.dim__arrangement\nWHERE is_cur_rec = 1\nGROUP BY unq_id\nHAVING COUNT (1) > 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null}, "test.dga_data_model.mart__dim_casa_account_unique": {"compiled": true, "resource_type": "test", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.dim__casa_account"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "singular_test", "mart__dim_casa_account_unique"], "unique_id": "test.dga_data_model.mart__dim_casa_account_unique", "raw_code": "SELECT\r\n  account_number\r\n, COUNT(1)\r\nFROM {{ ref('dim__casa_account') }}\r\nWHERE is_cur_rec = 1\r\nGROUP BY account_number\r\nHAVING COUNT (1) > 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\singular_test\\mart__dim_casa_account_unique.sql", "original_file_path": "tests\\daily\\singular_test\\mart__dim_casa_account_unique.sql", "name": "mart__dim_casa_account_unique", "alias": "mart__dim_casa_account_unique", "checksum": {"name": "sha256", "checksum": "92fb3563962726a482e060300f59ed4605af82f8a3455eed30824badec9a3fbf"}, "tags": [], "refs": [["dim__casa_account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\tests\\daily\\singular_test\\mart__dim_casa_account_unique.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.2391486, "compiled_code": "SELECT\n  account_number\n, COUNT(1)\nFROM \"oracle_dgaworkzone\".mart.dim__casa_account\nWHERE is_cur_rec = 1\nGROUP BY account_number\nHAVING COUNT (1) > 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null}, "test.dga_data_model.mart__dim_customer_unique": {"compiled": true, "resource_type": "test", "depends_on": {"macros": [], "nodes": ["model.dga_data_model.dim__customer"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "singular_test", "mart__dim_customer_unique"], "unique_id": "test.dga_data_model.mart__dim_customer_unique", "raw_code": "SELECT\r\n  customer_number\r\n  , COUNT(1)\r\nFROM\r\n  {{ ref('dim__customer' ) }}\r\nWHERE is_cur_rec = 1\r\nGROUP BY customer_number\r\nHAVING COUNT(1) > 1", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\singular_test\\mart__dim_customer_unique.sql", "original_file_path": "tests\\daily\\singular_test\\mart__dim_customer_unique.sql", "name": "mart__dim_customer_unique", "alias": "mart__dim_customer_unique", "checksum": {"name": "sha256", "checksum": "4b720ab99a8336cd6e6e604bf49affa9829b7b74dd96b92da0756a1ed5bb025e"}, "tags": [], "refs": [["dim__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\tests\\daily\\singular_test\\mart__dim_customer_unique.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.2421482, "compiled_code": "SELECT\n  customer_number\n  , COUNT(1)\nFROM\n  \"oracle_dgaworkzone\".mart.dim__customer\nWHERE is_cur_rec = 1\nGROUP BY customer_number\nHAVING COUNT(1) > 1", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null}, "operation.dga_data_model.dga_data_model-on-run-end-0": {"compiled": true, "resource_type": "operation", "depends_on": {"macros": ["macro.dga_data_model.log_dbt_results"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "post-hook": [], "pre-hook": []}, "database": "oracle_dgaworkzone", "schema": "base", "fqn": ["dga_data_model", "hooks", "dga_data_model-on-run-end-0"], "unique_id": "operation.dga_data_model.dga_data_model-on-run-end-0", "raw_code": "{{ log_dbt_results(results) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "hooks\\dga_data_model-on-run-end-0.sql", "original_file_path": ".\\dbt_project.yml", "name": "dga_data_model-on-run-end-0", "alias": "dga_data_model-on-run-end-0", "checksum": {"name": "sha256", "checksum": "902f095a4b9891caa76037fe130bdaae19e1e994419fa559848f3f1beb2cd7f9"}, "tags": ["on-run-end"], "refs": [], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.253146, "compiled_code": "", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "index": 0}, "test.dga_data_model.unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date.4761489701": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["etl_date", "account_no_sk"], "condition_columns": "etl_date", "model": "{{ get_where_subquery(ref('dwh__demanddeposit_master003')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.dwh__demanddeposit_master003"]}, "config": {"enabled": true, "alias": "unique_combination_of_columns__e50bde7ad0db57559b7c14dfa3fa7d2e", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date"], "unique_id": "test.dga_data_model.unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date.4761489701", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"unique_combination_of_columns__e50bde7ad0db57559b7c14dfa3fa7d2e\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_combination_of_columns__e50bde7ad0db57559b7c14dfa3fa7d2e.sql", "original_file_path": "models\\base\\base.yml", "name": "unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date", "alias": "unique_combination_of_columns__e50bde7ad0db57559b7c14dfa3fa7d2e", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["dwh__demanddeposit_master003"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\unique_combination_of_columns__e50bde7ad0db57559b7c14dfa3fa7d2e.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "unique_combination_of_columns__e50bde7ad0db57559b7c14dfa3fa7d2e"}, "created_at": 1685959752.321982, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        etl_date, account_no_sk\n    from \"oracle_dgaworkzone\".base.dwh__demanddeposit_master003\n    where etl_date >= (select max(etl_date) from \"oracle_dgaworkzone\".base.dwh__demanddeposit_master003)\n    group by etl_date, account_no_sk\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.dwh__demanddeposit_master003"}, "test.dga_data_model.unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date.744a049d76": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["etl_date", "account_sk"], "condition_columns": "etl_date", "model": "{{ get_where_subquery(ref('dwh__fixeddeposit_master003')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.dwh__fixeddeposit_master003"]}, "config": {"enabled": true, "alias": "unique_combination_of_columns__79c3356d910f2d10a82281ed25ba18c2", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date"], "unique_id": "test.dga_data_model.unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date.744a049d76", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"unique_combination_of_columns__79c3356d910f2d10a82281ed25ba18c2\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_combination_of_columns__79c3356d910f2d10a82281ed25ba18c2.sql", "original_file_path": "models\\base\\base.yml", "name": "unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date", "alias": "unique_combination_of_columns__79c3356d910f2d10a82281ed25ba18c2", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["dwh__fixeddeposit_master003"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\unique_combination_of_columns__79c3356d910f2d10a82281ed25ba18c2.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "unique_combination_of_columns__79c3356d910f2d10a82281ed25ba18c2"}, "created_at": 1685959752.3339057, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        etl_date, account_sk\n    from \"oracle_dgaworkzone\".base.dwh__fixeddeposit_master003\n    where etl_date >= (select max(etl_date) from \"oracle_dgaworkzone\".base.dwh__fixeddeposit_master003)\n    group by etl_date, account_sk\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.dwh__fixeddeposit_master003"}, "test.dga_data_model.unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date.caecc3fb45": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["etl_date", "account_no_sk"], "condition_columns": "etl_date", "model": "{{ get_where_subquery(ref('dwh__loan_master003')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.dwh__loan_master003"]}, "config": {"enabled": true, "alias": "unique_combination_of_columns__7c0a02ec80894d80ec9b32167597cad4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date"], "unique_id": "test.dga_data_model.unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date.caecc3fb45", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"unique_combination_of_columns__7c0a02ec80894d80ec9b32167597cad4\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_combination_of_columns__7c0a02ec80894d80ec9b32167597cad4.sql", "original_file_path": "models\\base\\base.yml", "name": "unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date", "alias": "unique_combination_of_columns__7c0a02ec80894d80ec9b32167597cad4", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["dwh__loan_master003"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\unique_combination_of_columns__7c0a02ec80894d80ec9b32167597cad4.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "unique_combination_of_columns__7c0a02ec80894d80ec9b32167597cad4"}, "created_at": 1685959752.3389053, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        etl_date, account_no_sk\n    from \"oracle_dgaworkzone\".base.dwh__loan_master003\n    where etl_date >= (select max(etl_date) from \"oracle_dgaworkzone\".base.dwh__loan_master003)\n    group by etl_date, account_no_sk\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.dwh__loan_master003"}, "test.dga_data_model.not_null_imp_topup_bscore_cif.fe574724d3": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "cif", "model": "{{ get_where_subquery(ref('imp_topup_bscore')) }}"}, "namespace": null}, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "not_null_imp_topup_bscore_cif"], "unique_id": "test.dga_data_model.not_null_imp_topup_bscore_cif.fe574724d3", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_imp_topup_bscore_cif.sql", "original_file_path": "models\\base\\base.yml", "name": "not_null_imp_topup_bscore_cif", "alias": "not_null_imp_topup_bscore_cif", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["imp_topup_bscore"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.3439772, "column_name": "cif", "file_key_name": "models.imp_topup_bscore"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_imp_topup_bscore_import_month__cif.6fee4edf88": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["import_month", "cif"], "model": "{{ get_where_subquery(ref('imp_topup_bscore')) }}"}, "namespace": "dbt_utils"}, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_473b47fb743424cbf0bac0161157f8e3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "dbt_utils_unique_combination_of_columns_imp_topup_bscore_import_month__cif"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_imp_topup_bscore_import_month__cif.6fee4edf88", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_473b47fb743424cbf0bac0161157f8e3\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_473b47fb743424cbf0bac0161157f8e3.sql", "original_file_path": "models\\base\\base.yml", "name": "dbt_utils_unique_combination_of_columns_imp_topup_bscore_import_month__cif", "alias": "dbt_utils_unique_combination_o_473b47fb743424cbf0bac0161157f8e3", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["imp_topup_bscore"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_473b47fb743424cbf0bac0161157f8e3"}, "created_at": 1685959752.3449774, "column_name": null, "file_key_name": "models.imp_topup_bscore"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date.ce6b98aa4f": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["cuif001", "etl_date"], "model": "{{ get_where_subquery(ref('landing_hist__ews_rb_cust_info')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.landing_hist__ews_rb_cust_info"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_380f15d445e54eba8551bb4349fb64da", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "ews_rb", "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date.ce6b98aa4f", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_380f15d445e54eba8551bb4349fb64da\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_380f15d445e54eba8551bb4349fb64da.sql", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date", "alias": "dbt_utils_unique_combination_o_380f15d445e54eba8551bb4349fb64da", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["landing_hist__ews_rb_cust_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\ews_rb.yml\\dbt_utils_unique_combination_o_380f15d445e54eba8551bb4349fb64da.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_380f15d445e54eba8551bb4349fb64da"}, "created_at": 1685959752.4299765, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        cuif001, etl_date\n    from \"oracle_dgaworkzone\".base.landing_hist__ews_rb_cust_info\n    group by cuif001, etl_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.landing_hist__ews_rb_cust_info"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date.0ebf942566": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["cifno", "etl_date"], "model": "{{ get_where_subquery(ref('landing_hist__ews_rb_thruput_casa')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.landing_hist__ews_rb_thruput_casa"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_b39412e304121c58110647c3cd3bc72f", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "ews_rb", "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date.0ebf942566", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_b39412e304121c58110647c3cd3bc72f\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_b39412e304121c58110647c3cd3bc72f.sql", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date", "alias": "dbt_utils_unique_combination_o_b39412e304121c58110647c3cd3bc72f", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["landing_hist__ews_rb_thruput_casa"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\ews_rb.yml\\dbt_utils_unique_combination_o_b39412e304121c58110647c3cd3bc72f.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_b39412e304121c58110647c3cd3bc72f"}, "created_at": 1685959752.43398, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        cifno, etl_date\n    from \"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_casa\n    group by cifno, etl_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.landing_hist__ews_rb_thruput_casa"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date.858f988552": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["cifno", "etl_date"], "model": "{{ get_where_subquery(ref('landing_hist__ews_rb_thruput_fd')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.landing_hist__ews_rb_thruput_fd"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_d417c20de7c57d4101adff3df16401a1", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "ews_rb", "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date.858f988552", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_d417c20de7c57d4101adff3df16401a1\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_d417c20de7c57d4101adff3df16401a1.sql", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date", "alias": "dbt_utils_unique_combination_o_d417c20de7c57d4101adff3df16401a1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["landing_hist__ews_rb_thruput_fd"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\ews_rb.yml\\dbt_utils_unique_combination_o_d417c20de7c57d4101adff3df16401a1.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_d417c20de7c57d4101adff3df16401a1"}, "created_at": 1685959752.4379067, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        cifno, etl_date\n    from \"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_fd\n    group by cifno, etl_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.landing_hist__ews_rb_thruput_fd"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date.8158943d76": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["cifno", "etl_date"], "model": "{{ get_where_subquery(ref('landing_hist__ews_rb_thruput_in')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.landing_hist__ews_rb_thruput_in"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_3d2f15f2ed469fb3d9e7d047aa4f477e", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "ews_rb", "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date.8158943d76", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_3d2f15f2ed469fb3d9e7d047aa4f477e\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_3d2f15f2ed469fb3d9e7d047aa4f477e.sql", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date", "alias": "dbt_utils_unique_combination_o_3d2f15f2ed469fb3d9e7d047aa4f477e", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["landing_hist__ews_rb_thruput_in"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\ews_rb.yml\\dbt_utils_unique_combination_o_3d2f15f2ed469fb3d9e7d047aa4f477e.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_3d2f15f2ed469fb3d9e7d047aa4f477e"}, "created_at": 1685959752.4409883, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        cifno, etl_date\n    from \"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_in\n    group by cifno, etl_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.landing_hist__ews_rb_thruput_in"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date.8a73bd2fef": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["cifno", "etl_date"], "model": "{{ get_where_subquery(ref('landing_hist__ews_rb_thruput_out')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.landing_hist__ews_rb_thruput_out"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_033daf66cdeaa4218b79f0b6ac6ce7ac", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "ews_rb", "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date.8a73bd2fef", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_033daf66cdeaa4218b79f0b6ac6ce7ac\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_033daf66cdeaa4218b79f0b6ac6ce7ac.sql", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date", "alias": "dbt_utils_unique_combination_o_033daf66cdeaa4218b79f0b6ac6ce7ac", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["landing_hist__ews_rb_thruput_out"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\ews_rb\\ews_rb.yml\\dbt_utils_unique_combination_o_033daf66cdeaa4218b79f0b6ac6ce7ac.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_033daf66cdeaa4218b79f0b6ac6ce7ac"}, "created_at": 1685959752.4449797, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        cifno, etl_date\n    from \"oracle_dgaworkzone\".base.landing_hist__ews_rb_thruput_out\n    group by cifno, etl_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.landing_hist__ews_rb_thruput_out"}, "test.dga_data_model.dbt_utils_recency_los__addoncarddetails_day__tmdate__1.bc4d5c6a33": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__addoncarddetails')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__addoncarddetails"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__addoncarddetails_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__addoncarddetails_day__tmdate__1.bc4d5c6a33", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__addoncarddetails_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__addoncarddetails_day__tmdate__1", "alias": "dbt_utils_recency_los__addoncarddetails_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__addoncarddetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__addoncarddetails_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.530979, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__addoncarddetails\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__addoncarddetails"}, "test.dga_data_model.dbt_utils_recency_los__applicationdetails_day__tmdate__1.da6d96a64a": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__applicationdetails')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__applicationdetails"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__applicationdetails_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__applicationdetails_day__tmdate__1.da6d96a64a", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__applicationdetails_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__applicationdetails_day__tmdate__1", "alias": "dbt_utils_recency_los__applicationdetails_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__applicationdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__applicationdetails_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.545978, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__applicationdetails\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__applicationdetails"}, "test.dga_data_model.dbt_utils_recency_los__decision_day__tmdate__1.146f2ebedd": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__decision')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__decision"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__decision_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__decision_day__tmdate__1.146f2ebedd", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__decision_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__decision_day__tmdate__1", "alias": "dbt_utils_recency_los__decision_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__decision"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__decision_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.5499063, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__decision\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__decision"}, "test.dga_data_model.dbt_utils_recency_los__loanproductdetails_day__tmdate__1.458576e248": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__loanproductdetails')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__loanproductdetails"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__loanproductdetails_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__loanproductdetails_day__tmdate__1.458576e248", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__loanproductdetails_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__loanproductdetails_day__tmdate__1", "alias": "dbt_utils_recency_los__loanproductdetails_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__loanproductdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__loanproductdetails_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.5549061, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__loanproductdetails\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__loanproductdetails"}, "test.dga_data_model.dbt_utils_recency_los__opportunities_day__tmdate__1.0df0f3f09e": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__opportunities')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__opportunities"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__opportunities_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__opportunities_day__tmdate__1.0df0f3f09e", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__opportunities_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__opportunities_day__tmdate__1", "alias": "dbt_utils_recency_los__opportunities_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__opportunities"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__opportunities_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.5579786, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__opportunities\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__opportunities"}, "test.dga_data_model.dbt_utils_recency_los__parentapplication_day__tmdate__1.2894f8d3ff": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__parentapplication')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__parentapplication"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__parentapplication_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__parentapplication_day__tmdate__1.2894f8d3ff", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__parentapplication_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__parentapplication_day__tmdate__1", "alias": "dbt_utils_recency_los__parentapplication_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__parentapplication"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__parentapplication_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.5629766, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__parentapplication\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__parentapplication"}, "test.dga_data_model.dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.3f5502f1a8": {"test_metadata": {"name": "recency", "kwargs": {"datepart": "day", "field": "tmdate", "interval": 1, "model": "{{ get_where_subquery(ref('los__rlosroutingdetails')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.test_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.los__rlosroutingdetails"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "los", "dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1"], "unique_id": "test.dga_data_model.dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.3f5502f1a8", "raw_code": "{{ dbt_utils.test_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.sql", "original_file_path": "models\\base\\los\\los.yml", "name": "dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1", "alias": "dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["los__rlosroutingdetails"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\los\\los.yml\\dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.5669792, "compiled_code": "\n\n\n\n\n\n\nwith recency as (\n\n    select \n\n      \n      \n        max(tmdate) as most_recent\n\n    from \"oracle_dgaworkzone\".base.los__rlosroutingdetails\n\n    \n\n)\n\nselect\n\n    \n    most_recent,\n    cast(date_add('day', -1, current_timestamp) as TIMESTAMP) as threshold\n\nfrom recency\nwhere most_recent < cast(date_add('day', -1, current_timestamp) as TIMESTAMP)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.los__rlosroutingdetails"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno.193e15dda9": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["yearmonth", "cifno"], "model": "{{ get_where_subquery(ref('qlhs__customer_active_df')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.qlhs__customer_active_df"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_03ea85bfc7a24ab4a09ae008646b1cb0", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno.193e15dda9", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_03ea85bfc7a24ab4a09ae008646b1cb0\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_03ea85bfc7a24ab4a09ae008646b1cb0.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno", "alias": "dbt_utils_unique_combination_o_03ea85bfc7a24ab4a09ae008646b1cb0", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["qlhs__customer_active_df"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\dbt_utils_unique_combination_o_03ea85bfc7a24ab4a09ae008646b1cb0.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_03ea85bfc7a24ab4a09ae008646b1cb0"}, "created_at": 1685959752.581907, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        yearmonth, cifno\n    from \"oracle_dgaworkzone\".base.qlhs__customer_active_df\n    group by yearmonth, cifno\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.qlhs__customer_active_df"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno.effa5cebe5": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["yearmonth", "cifno"], "model": "{{ get_where_subquery(ref('qlhs__customer_product_holding_df')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.qlhs__customer_product_holding_df"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_ba40d0d7f887434f2eba9bbb3b4e7436", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno.effa5cebe5", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_ba40d0d7f887434f2eba9bbb3b4e7436\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_ba40d0d7f887434f2eba9bbb3b4e7436.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno", "alias": "dbt_utils_unique_combination_o_ba40d0d7f887434f2eba9bbb3b4e7436", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["qlhs__customer_product_holding_df"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\dbt_utils_unique_combination_o_ba40d0d7f887434f2eba9bbb3b4e7436.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_ba40d0d7f887434f2eba9bbb3b4e7436"}, "created_at": 1685959752.5859067, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        yearmonth, cifno\n    from \"oracle_dgaworkzone\".base.qlhs__customer_product_holding_df\n    group by yearmonth, cifno\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.qlhs__customer_product_holding_df"}, "test.dga_data_model.unique_way4__account_id.606c041c7e": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('way4__account')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.way4__account"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "way4", "unique_way4__account_id"], "unique_id": "test.dga_data_model.unique_way4__account_id.606c041c7e", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_way4__account_id.sql", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "unique_way4__account_id", "alias": "unique_way4__account_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["way4__account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\base_way4.yml\\unique_way4__account_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.6309767, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".base.way4__account\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.way4__account"}, "test.dga_data_model.not_null_way4__account_id.42250b14a9": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('way4__account')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.way4__account"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "way4", "not_null_way4__account_id"], "unique_id": "test.dga_data_model.not_null_way4__account_id.42250b14a9", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_way4__account_id.sql", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "not_null_way4__account_id", "alias": "not_null_way4__account_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["way4__account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\base_way4.yml\\not_null_way4__account_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.631978, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"oracle_dgaworkzone\".base.way4__account\nwhere id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.way4__account"}, "test.dga_data_model.unique_way4__acnt_contract_id.d8efeb3890": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('way4__acnt_contract')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.way4__acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "way4", "unique_way4__acnt_contract_id"], "unique_id": "test.dga_data_model.unique_way4__acnt_contract_id.d8efeb3890", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_way4__acnt_contract_id.sql", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "unique_way4__acnt_contract_id", "alias": "unique_way4__acnt_contract_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["way4__acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\base_way4.yml\\unique_way4__acnt_contract_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.6329064, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".base.way4__acnt_contract\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.way4__acnt_contract"}, "test.dga_data_model.not_null_way4__acnt_contract_id.0c26c772e0": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('way4__acnt_contract')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.way4__acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "way4", "not_null_way4__acnt_contract_id"], "unique_id": "test.dga_data_model.not_null_way4__acnt_contract_id.0c26c772e0", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_way4__acnt_contract_id.sql", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "not_null_way4__acnt_contract_id", "alias": "not_null_way4__acnt_contract_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["way4__acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\way4\\base_way4.yml\\not_null_way4__acnt_contract_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.634982, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"oracle_dgaworkzone\".base.way4__acnt_contract\nwhere id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.way4__acnt_contract"}, "test.dga_data_model.not_null_int_vision__bal_dly_contract_id.ccfb098323": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "contract_id", "model": "{{ get_where_subquery(ref('int_vision__bal_dly')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_vision__bal_dly"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "bal_eb", "not_null_int_vision__bal_dly_contract_id"], "unique_id": "test.dga_data_model.not_null_int_vision__bal_dly_contract_id.ccfb098323", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_int_vision__bal_dly_contract_id.sql", "original_file_path": "models\\int\\bal_eb\\int_bal_eb.yml", "name": "not_null_int_vision__bal_dly_contract_id", "alias": "not_null_int_vision__bal_dly_contract_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_vision__bal_dly"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_bal_eb.yml\\not_null_int_vision__bal_dly_contract_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.654991, "compiled_code": "\n    \n    \n\n\n\nselect contract_id\nfrom \"oracle_dgaworkzone\".int.int_vision__bal_dly\nwhere contract_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "contract_id", "file_key_name": "models.int_vision__bal_dly"}, "test.dga_data_model.not_null_int_vision__bal_dly_customer_number.98f4fd21ca": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "customer_number", "model": "{{ get_where_subquery(ref('int_vision__bal_dly')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_vision__bal_dly"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "bal_eb", "not_null_int_vision__bal_dly_customer_number"], "unique_id": "test.dga_data_model.not_null_int_vision__bal_dly_customer_number.98f4fd21ca", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_int_vision__bal_dly_customer_number.sql", "original_file_path": "models\\int\\bal_eb\\int_bal_eb.yml", "name": "not_null_int_vision__bal_dly_customer_number", "alias": "not_null_int_vision__bal_dly_customer_number", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_vision__bal_dly"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_bal_eb.yml\\not_null_int_vision__bal_dly_customer_number.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.6559796, "compiled_code": "\n    \n    \n\n\n\nselect customer_number\nfrom \"oracle_dgaworkzone\".int.int_vision__bal_dly\nwhere customer_number is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "customer_number", "file_key_name": "models.int_vision__bal_dly"}, "test.dga_data_model.not_null_int_qlhs__bal_mly_eb_customer_number.89b884b56a": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "customer_number", "model": "{{ get_where_subquery(ref('int_qlhs__bal_mly_eb')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_qlhs__bal_mly_eb"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "bal_eb", "not_null_int_qlhs__bal_mly_eb_customer_number"], "unique_id": "test.dga_data_model.not_null_int_qlhs__bal_mly_eb_customer_number.89b884b56a", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_int_qlhs__bal_mly_eb_customer_number.sql", "original_file_path": "models\\int\\bal_eb\\int_bal_eb.yml", "name": "not_null_int_qlhs__bal_mly_eb_customer_number", "alias": "not_null_int_qlhs__bal_mly_eb_customer_number", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_qlhs__bal_mly_eb"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bal_eb\\int_bal_eb.yml\\not_null_int_qlhs__bal_mly_eb_customer_number.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.6569786, "compiled_code": "\n    \n    \n\n\n\nselect customer_number\nfrom \"oracle_dgaworkzone\".int.int_qlhs__bal_mly_eb\nwhere customer_number is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "customer_number", "file_key_name": "models.int_qlhs__bal_mly_eb"}, "test.dga_data_model.orc_is_recency_int__gl_bal_etl_date.05b7836690": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('int__gl_bal')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int__gl_bal"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "bpm_vhkq", "orc_is_recency_int__gl_bal_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_int__gl_bal_etl_date.05b7836690", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_int__gl_bal_etl_date.sql", "original_file_path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "name": "orc_is_recency_int__gl_bal_etl_date", "alias": "orc_is_recency_int__gl_bal_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int__gl_bal"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\bpm_vhkq\\int_bpm_vhkq.yml\\orc_is_recency_int__gl_bal_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.6709788, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".int.int__gl_bal\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.int__gl_bal"}, "test.dga_data_model.unique_int__customer_customer_number.1cd17835b2": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "customer_number", "model": "{{ get_where_subquery(ref('int__customer')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "daily", "unique_int__customer_customer_number"], "unique_id": "test.dga_data_model.unique_int__customer_customer_number.1cd17835b2", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_int__customer_customer_number.sql", "original_file_path": "models\\int\\daily\\daily_int.yml", "name": "unique_int__customer_customer_number", "alias": "unique_int__customer_customer_number", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\daily_int.yml\\unique_int__customer_customer_number.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.717983, "compiled_code": "\n    \n    \n\nselect\n    customer_number as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".int.int__customer\nwhere customer_number is not null\ngroup by customer_number\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "customer_number", "file_key_name": "models.int__customer"}, "test.dga_data_model.not_null_int__customer_customer_number.aac0557946": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "customer_number", "model": "{{ get_where_subquery(ref('int__customer')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int__customer"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "daily", "not_null_int__customer_customer_number"], "unique_id": "test.dga_data_model.not_null_int__customer_customer_number.aac0557946", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_int__customer_customer_number.sql", "original_file_path": "models\\int\\daily\\daily_int.yml", "name": "not_null_int__customer_customer_number", "alias": "not_null_int__customer_customer_number", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int__customer"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\daily_int.yml\\not_null_int__customer_customer_number.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7199805, "compiled_code": "\n    \n    \n\n\n\nselect customer_number\nfrom \"oracle_dgaworkzone\".int.int__customer\nwhere customer_number is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "customer_number", "file_key_name": "models.int__customer"}, "test.dga_data_model.unique_int__fd_account_account_number.603b8c0377": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "account_number", "model": "{{ get_where_subquery(ref('int__fd_account')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int__fd_account"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "daily", "unique_int__fd_account_account_number"], "unique_id": "test.dga_data_model.unique_int__fd_account_account_number.603b8c0377", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_int__fd_account_account_number.sql", "original_file_path": "models\\int\\daily\\daily_int.yml", "name": "unique_int__fd_account_account_number", "alias": "unique_int__fd_account_account_number", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int__fd_account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\daily_int.yml\\unique_int__fd_account_account_number.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7209773, "compiled_code": "\n    \n    \n\nselect\n    account_number as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".int.int__fd_account\nwhere account_number is not null\ngroup by account_number\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "account_number", "file_key_name": "models.int__fd_account"}, "test.dga_data_model.not_null_int__fd_account_account_number.81310a0a6b": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "account_number", "model": "{{ get_where_subquery(ref('int__fd_account')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int__fd_account"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "daily", "not_null_int__fd_account_account_number"], "unique_id": "test.dga_data_model.not_null_int__fd_account_account_number.81310a0a6b", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_int__fd_account_account_number.sql", "original_file_path": "models\\int\\daily\\daily_int.yml", "name": "not_null_int__fd_account_account_number", "alias": "not_null_int__fd_account_account_number", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int__fd_account"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\daily\\daily_int.yml\\not_null_int__fd_account_account_number.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7219777, "compiled_code": "\n    \n    \n\n\n\nselect account_number\nfrom \"oracle_dgaworkzone\".int.int__fd_account\nwhere account_number is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "account_number", "file_key_name": "models.int__fd_account"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid.c510d4509a": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["loanproductdetailsid", "addoncarddetailsid", "applicationdetailsid"], "model": "{{ get_where_subquery(ref('int_los__product')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["model.dga_data_model.int_los__product"]}, "config": {"enabled": true, "alias": "dbt_utils_unique_combination_o_ecfc689cb059bfe957e3b12601e3b4a3", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "los", "dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid.c510d4509a", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_ecfc689cb059bfe957e3b12601e3b4a3\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_ecfc689cb059bfe957e3b12601e3b4a3.sql", "original_file_path": "models\\int\\los\\int_los.yml", "name": "dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid", "alias": "dbt_utils_unique_combination_o_ecfc689cb059bfe957e3b12601e3b4a3", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_los__product"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los.yml\\dbt_utils_unique_combination_o_ecfc689cb059bfe957e3b12601e3b4a3.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_ecfc689cb059bfe957e3b12601e3b4a3"}, "created_at": 1685959752.7309773, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        loanproductdetailsid, addoncarddetailsid, applicationdetailsid\n    from \"oracle_dgaworkzone\".int.int_los__product\n    group by loanproductdetailsid, addoncarddetailsid, applicationdetailsid\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "models.int_los__product"}, "test.dga_data_model.unique_int_los__tat_rlosroutingdetailsid.4b99cb2e71": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "rlosroutingdetailsid", "model": "{{ get_where_subquery(ref('int_los__tat')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_los__tat"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "los", "unique_int_los__tat_rlosroutingdetailsid"], "unique_id": "test.dga_data_model.unique_int_los__tat_rlosroutingdetailsid.4b99cb2e71", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_int_los__tat_rlosroutingdetailsid.sql", "original_file_path": "models\\int\\los\\int_los.yml", "name": "unique_int_los__tat_rlosroutingdetailsid", "alias": "unique_int_los__tat_rlosroutingdetailsid", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_los__tat"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\los\\int_los.yml\\unique_int_los__tat_rlosroutingdetailsid.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7349894, "compiled_code": "\n    \n    \n\nselect\n    rlosroutingdetailsid as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".int.int_los__tat\nwhere rlosroutingdetailsid is not null\ngroup by rlosroutingdetailsid\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "rlosroutingdetailsid", "file_key_name": "models.int_los__tat"}, "test.dga_data_model.unique_int_mercury__customer_ckdt_process_instance_id.ddc0fb4315": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "process_instance_id", "model": "{{ get_where_subquery(ref('int_mercury__customer_ckdt')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_mercury__customer_ckdt"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "mercury", "unique_int_mercury__customer_ckdt_process_instance_id"], "unique_id": "test.dga_data_model.unique_int_mercury__customer_ckdt_process_instance_id.ddc0fb4315", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_int_mercury__customer_ckdt_process_instance_id.sql", "original_file_path": "models\\int\\mercury\\int_mercury.yml", "name": "unique_int_mercury__customer_ckdt_process_instance_id", "alias": "unique_int_mercury__customer_ckdt_process_instance_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_mercury__customer_ckdt"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\mercury\\int_mercury.yml\\unique_int_mercury__customer_ckdt_process_instance_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7390063, "compiled_code": "\n    \n    \n\nselect\n    process_instance_id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".int.int_mercury__customer_ckdt\nwhere process_instance_id is not null\ngroup by process_instance_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "process_instance_id", "file_key_name": "models.int_mercury__customer_ckdt"}, "test.dga_data_model.not_null_int_mercury__customer_ckdt_process_instance_id.a7717a0618": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "process_instance_id", "model": "{{ get_where_subquery(ref('int_mercury__customer_ckdt')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_mercury__customer_ckdt"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "mercury", "not_null_int_mercury__customer_ckdt_process_instance_id"], "unique_id": "test.dga_data_model.not_null_int_mercury__customer_ckdt_process_instance_id.a7717a0618", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_int_mercury__customer_ckdt_process_instance_id.sql", "original_file_path": "models\\int\\mercury\\int_mercury.yml", "name": "not_null_int_mercury__customer_ckdt_process_instance_id", "alias": "not_null_int_mercury__customer_ckdt_process_instance_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_mercury__customer_ckdt"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\mercury\\int_mercury.yml\\not_null_int_mercury__customer_ckdt_process_instance_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7409112, "compiled_code": "\n    \n    \n\n\n\nselect process_instance_id\nfrom \"oracle_dgaworkzone\".int.int_mercury__customer_ckdt\nwhere process_instance_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "process_instance_id", "file_key_name": "models.int_mercury__customer_ckdt"}, "test.dga_data_model.relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_.9f85424705": {"test_metadata": {"name": "relationships", "kwargs": {"to": "ref('mercury__tbl_doc_need_list')", "field": "process_instance_id", "column_name": "process_instance_id", "model": "{{ get_where_subquery(ref('int_mercury__customer_ckdt')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_relationships", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.mercury__tbl_doc_need_list", "model.dga_data_model.int_mercury__customer_ckdt"]}, "config": {"enabled": true, "alias": "relationships_int_mercury__cus_6e76485c05dec4ca5582ea00a17bb1b7", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "mercury", "relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_"], "unique_id": "test.dga_data_model.relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_.9f85424705", "raw_code": "{{ test_relationships(**_dbt_generic_test_kwargs) }}{{ config(alias=\"relationships_int_mercury__cus_6e76485c05dec4ca5582ea00a17bb1b7\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "relationships_int_mercury__cus_6e76485c05dec4ca5582ea00a17bb1b7.sql", "original_file_path": "models\\int\\mercury\\int_mercury.yml", "name": "relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_", "alias": "relationships_int_mercury__cus_6e76485c05dec4ca5582ea00a17bb1b7", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["mercury__tbl_doc_need_list"], ["int_mercury__customer_ckdt"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\mercury\\int_mercury.yml\\relationships_int_mercury__cus_6e76485c05dec4ca5582ea00a17bb1b7.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "relationships_int_mercury__cus_6e76485c05dec4ca5582ea00a17bb1b7"}, "created_at": 1685959752.741983, "compiled_code": "\n    \n    \n\nwith child as (\n    select process_instance_id as from_field\n    from \"oracle_dgaworkzone\".int.int_mercury__customer_ckdt\n    where process_instance_id is not null\n),\n\nparent as (\n    select process_instance_id as to_field\n    from \"oracle_dgaworkzone\".base.mercury__tbl_doc_need_list\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "process_instance_id", "file_key_name": "models.int_mercury__customer_ckdt"}, "test.dga_data_model.unique_int_venus__oppotunity_opportunity_id.109c0e1c9c": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "opportunity_id", "model": "{{ get_where_subquery(ref('int_venus__oppotunity')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.int_venus__oppotunity"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "int", "venus", "unique_int_venus__oppotunity_opportunity_id"], "unique_id": "test.dga_data_model.unique_int_venus__oppotunity_opportunity_id.109c0e1c9c", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_int_venus__oppotunity_opportunity_id.sql", "original_file_path": "models\\int\\venus\\venus_int.yml", "name": "unique_int_venus__oppotunity_opportunity_id", "alias": "unique_int_venus__oppotunity_opportunity_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["int_venus__oppotunity"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\int\\venus\\venus_int.yml\\unique_int_venus__oppotunity_opportunity_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.7499073, "compiled_code": "\n    \n    \n\nselect\n    opportunity_id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".int.int_venus__oppotunity\nwhere opportunity_id is not null\ngroup by opportunity_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "opportunity_id", "file_key_name": "models.int_venus__oppotunity"}, "test.dga_data_model.dbt_utils_unique_combination_of_columns_report__list_approved_customer_by_df_001_created_month__customer_number.d3e2d5794d": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["created_month", "customer_number"], "model": "{{ get_where_subquery(ref('report__list_approved_customer_by_df_001')) }}"}, "namespace": "dbt_utils"}, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": []}, "config": {"enabled": false, "alias": "dbt_utils_unique_combination_o_e41859fb522bfa1b7b8911d1387ebd89", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "mart", "report", "dbt_utils_unique_combination_of_columns_report__list_approved_customer_by_df_001_created_month__customer_number"], "unique_id": "test.dga_data_model.dbt_utils_unique_combination_of_columns_report__list_approved_customer_by_df_001_created_month__customer_number.d3e2d5794d", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_unique_combination_o_e41859fb522bfa1b7b8911d1387ebd89\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_unique_combination_o_e41859fb522bfa1b7b8911d1387ebd89.sql", "original_file_path": "models\\mart\\report\\report.yml", "name": "dbt_utils_unique_combination_of_columns_report__list_approved_customer_by_df_001_created_month__customer_number", "alias": "dbt_utils_unique_combination_o_e41859fb522bfa1b7b8911d1387ebd89", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["report__list_approved_customer_by_df_001"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_unique_combination_o_e41859fb522bfa1b7b8911d1387ebd89"}, "created_at": 1685959752.8639832, "column_name": null, "file_key_name": "models.report__list_approved_customer_by_df_001"}, "test.dga_data_model.unique_fct__acc_opportunity_step_opportunity_id.3a6507fb55": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "opportunity_id", "model": "{{ get_where_subquery(ref('fct__acc_opportunity_step')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.fct__acc_opportunity_step"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "mart", "venus", "unique_fct__acc_opportunity_step_opportunity_id"], "unique_id": "test.dga_data_model.unique_fct__acc_opportunity_step_opportunity_id.3a6507fb55", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_fct__acc_opportunity_step_opportunity_id.sql", "original_file_path": "models\\mart\\venus\\venus_mart.yml", "name": "unique_fct__acc_opportunity_step_opportunity_id", "alias": "unique_fct__acc_opportunity_step_opportunity_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["fct__acc_opportunity_step"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\mart\\venus\\venus_mart.yml\\unique_fct__acc_opportunity_step_opportunity_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959752.8809822, "compiled_code": "\n    \n    \n\nselect\n    opportunity_id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".mart.fct__acc_opportunity_step\nwhere opportunity_id is not null\ngroup by opportunity_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "opportunity_id", "file_key_name": "models.fct__acc_opportunity_step"}, "test.dga_data_model.orc_is_recency_stg_cic__cicmaster_etl_date.1bdcafa3a4": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__cicmaster')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__cicmaster"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__cicmaster_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__cicmaster_etl_date.1bdcafa3a4", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__cicmaster_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__cicmaster_etl_date", "alias": "orc_is_recency_stg_cic__cicmaster_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__cicmaster"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__cicmaster_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.0013044, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__cicmaster\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__cicmaster"}, "test.dga_data_model.orc_is_recency_stg_cic__customer_info_etl_date.e0ab189878": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__customer_info')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__customer_info"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__customer_info_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__customer_info_etl_date.e0ab189878", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__customer_info_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__customer_info_etl_date", "alias": "orc_is_recency_stg_cic__customer_info_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__customer_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__customer_info_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.0043733, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__customer_info\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__customer_info"}, "test.dga_data_model.orc_is_recency_stg_cic__duno12thang_etl_date.dbfc93bf54": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__duno12thang')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__duno12thang"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__duno12thang_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__duno12thang_etl_date.dbfc93bf54", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__duno12thang_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__duno12thang_etl_date", "alias": "orc_is_recency_stg_cic__duno12thang_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__duno12thang"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__duno12thang_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.007374, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__duno12thang\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__duno12thang"}, "test.dga_data_model.orc_is_recency_stg_cic__dunothetd_etl_date.d37908707e": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__dunothetd')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__dunothetd"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__dunothetd_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__dunothetd_etl_date.d37908707e", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__dunothetd_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__dunothetd_etl_date", "alias": "orc_is_recency_stg_cic__dunothetd_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__dunothetd"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__dunothetd_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.0093718, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__dunothetd\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__dunothetd"}, "test.dga_data_model.orc_is_recency_stg_cic__dunothetd12thang_etl_date.eebb1d0751": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__dunothetd12thang')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__dunothetd12thang"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__dunothetd12thang_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__dunothetd12thang_etl_date.eebb1d0751", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__dunothetd12thang_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__dunothetd12thang_etl_date", "alias": "orc_is_recency_stg_cic__dunothetd12thang_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__dunothetd12thang"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__dunothetd12thang_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.012381, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__dunothetd12thang\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__dunothetd12thang"}, "test.dga_data_model.orc_is_recency_stg_cic__thongtinchung_etl_date.876fedf12a": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__thongtinchung')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__thongtinchung"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__thongtinchung_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__thongtinchung_etl_date.876fedf12a", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__thongtinchung_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__thongtinchung_etl_date", "alias": "orc_is_recency_stg_cic__thongtinchung_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__thongtinchung"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__thongtinchung_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.0143726, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__thongtinchung\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__thongtinchung"}, "test.dga_data_model.orc_is_recency_stg_cic__ttduno_etl_date.2af45cc849": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_cic__ttduno')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_cic__ttduno"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "cic", "orc_is_recency_stg_cic__ttduno_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_cic__ttduno_etl_date.2af45cc849", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_cic__ttduno_etl_date.sql", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "orc_is_recency_stg_cic__ttduno_etl_date", "alias": "orc_is_recency_stg_cic__ttduno_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cic__ttduno"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\cic\\stg_cic.yml\\orc_is_recency_stg_cic__ttduno_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.0193653, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_cic__ttduno\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_cic__ttduno"}, "test.dga_data_model.orc_is_recency_stg_landing__bc_user_info_etl_date.2dc6d694c8": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__bc_user_info')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__bc_user_info"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__bc_user_info_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__bc_user_info_etl_date.2dc6d694c8", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__bc_user_info_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__bc_user_info_etl_date", "alias": "orc_is_recency_stg_landing__bc_user_info_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__bc_user_info"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__bc_user_info_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1182966, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__bc_user_info\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__bc_user_info"}, "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.8c71b1b163": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__fixeddeposit_master003')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__fixeddeposit_master003"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__fixeddeposit_master003_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.8c71b1b163", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__fixeddeposit_master003_etl_date", "alias": "orc_is_recency_stg_landing__fixeddeposit_master003_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__fixeddeposit_master003"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.121296, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master003\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__fixeddeposit_master003"}, "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.99deaed4d2": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__fixeddeposit_master002')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__fixeddeposit_master002"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__fixeddeposit_master002_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.99deaed4d2", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__fixeddeposit_master002_etl_date", "alias": "orc_is_recency_stg_landing__fixeddeposit_master002_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__fixeddeposit_master002"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1263652, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master002\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__fixeddeposit_master002"}, "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.97ff66932f": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__fixeddeposit_master001')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__fixeddeposit_master001"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__fixeddeposit_master001_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.97ff66932f", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__fixeddeposit_master001_etl_date", "alias": "orc_is_recency_stg_landing__fixeddeposit_master001_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__fixeddeposit_master001"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1283777, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__fixeddeposit_master001\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__fixeddeposit_master001"}, "test.dga_data_model.orc_is_recency_stg_landing__card_acnt_contract_etl_date.5369951f37": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__card_acnt_contract')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__card_acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__card_acnt_contract_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__card_acnt_contract_etl_date.5369951f37", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__card_acnt_contract_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__card_acnt_contract_etl_date", "alias": "orc_is_recency_stg_landing__card_acnt_contract_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__card_acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__card_acnt_contract_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1313655, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__card_acnt_contract\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__card_acnt_contract"}, "test.dga_data_model.orc_is_recency_stg_landing__card_add_data_etl_date.942f1931e9": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__card_add_data')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__card_add_data"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__card_add_data_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__card_add_data_etl_date.942f1931e9", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__card_add_data_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__card_add_data_etl_date", "alias": "orc_is_recency_stg_landing__card_add_data_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__card_add_data"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__card_add_data_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1352973, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__card_add_data\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__card_add_data"}, "test.dga_data_model.orc_is_recency_stg_landing__card_appl_product_etl_date.f3c5a7deb6": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__card_appl_product')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__card_appl_product"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__card_appl_product_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__card_appl_product_etl_date.f3c5a7deb6", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__card_appl_product_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__card_appl_product_etl_date", "alias": "orc_is_recency_stg_landing__card_appl_product_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__card_appl_product"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__card_appl_product_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1393745, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__card_appl_product\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__card_appl_product"}, "test.dga_data_model.orc_is_recency_stg_landing__card_client_etl_date.8d85cbdf16": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__card_client')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__card_client"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__card_client_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__card_client_etl_date.8d85cbdf16", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__card_client_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__card_client_etl_date", "alias": "orc_is_recency_stg_landing__card_client_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__card_client"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__card_client_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1423762, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__card_client\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__card_client"}, "test.dga_data_model.orc_is_recency_stg_landing__card_contr_status_etl_date.6a4f16b203": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__card_contr_status')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__card_contr_status"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__card_contr_status_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__card_contr_status_etl_date.6a4f16b203", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__card_contr_status_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__card_contr_status_etl_date", "alias": "orc_is_recency_stg_landing__card_contr_status_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__card_contr_status"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__card_contr_status_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.145366, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__card_contr_status\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__card_contr_status"}, "test.dga_data_model.orc_is_recency_stg_landing__card_f_i_etl_date.672b25084d": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__card_f_i')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__card_f_i"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__card_f_i_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__card_f_i_etl_date.672b25084d", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__card_f_i_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__card_f_i_etl_date", "alias": "orc_is_recency_stg_landing__card_f_i_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__card_f_i"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__card_f_i_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1473775, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__card_f_i\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__card_f_i"}, "test.dga_data_model.orc_is_recency_stg_landing__customer_address_etl_date.eb7993f041": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__customer_address')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__customer_address"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__customer_address_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__customer_address_etl_date.eb7993f041", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__customer_address_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__customer_address_etl_date", "alias": "orc_is_recency_stg_landing__customer_address_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__customer_address"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__customer_address_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1502953, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__customer_address\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__customer_address"}, "test.dga_data_model.orc_is_recency_stg_landing__customer_job_infomation_etl_date.ffc5a514d9": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__customer_job_infomation')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__customer_job_infomation"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__customer_job_infomation_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__customer_job_infomation_etl_date.ffc5a514d9", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__customer_job_infomation_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__customer_job_infomation_etl_date", "alias": "orc_is_recency_stg_landing__customer_job_infomation_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__customer_job_infomation"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__customer_job_infomation_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.154368, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__customer_job_infomation\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__customer_job_infomation"}, "test.dga_data_model.orc_is_recency_stg_landing__customer_marital_status_etl_date.8162991b78": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__customer_marital_status')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__customer_marital_status"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__customer_marital_status_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__customer_marital_status_etl_date.8162991b78", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__customer_marital_status_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__customer_marital_status_etl_date", "alias": "orc_is_recency_stg_landing__customer_marital_status_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__customer_marital_status"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__customer_marital_status_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1573658, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__customer_marital_status\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__customer_marital_status"}, "test.dga_data_model.orc_is_recency_stg_landing__customer_master001_etl_date.99881945be": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__customer_master001')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__customer_master001"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__customer_master001_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__customer_master001_etl_date.99881945be", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__customer_master001_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__customer_master001_etl_date", "alias": "orc_is_recency_stg_landing__customer_master001_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__customer_master001"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__customer_master001_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1603765, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__customer_master001\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__customer_master001"}, "test.dga_data_model.orc_is_recency_stg_landing__customer_master002_etl_date.1dcd6f7517": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__customer_master002')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__customer_master002"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__customer_master002_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__customer_master002_etl_date.1dcd6f7517", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__customer_master002_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__customer_master002_etl_date", "alias": "orc_is_recency_stg_landing__customer_master002_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__customer_master002"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__customer_master002_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1623662, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__customer_master002\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__customer_master002"}, "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master001_etl_date.7948d90a59": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__demanddeposit_master001')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__demanddeposit_master001"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__demanddeposit_master001_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master001_etl_date.7948d90a59", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__demanddeposit_master001_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__demanddeposit_master001_etl_date", "alias": "orc_is_recency_stg_landing__demanddeposit_master001_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__demanddeposit_master001"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__demanddeposit_master001_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1653552, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master001\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__demanddeposit_master001"}, "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master002_etl_date.b33614734e": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__demanddeposit_master002')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__demanddeposit_master002"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__demanddeposit_master002_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master002_etl_date.b33614734e", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__demanddeposit_master002_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__demanddeposit_master002_etl_date", "alias": "orc_is_recency_stg_landing__demanddeposit_master002_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__demanddeposit_master002"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__demanddeposit_master002_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1692972, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__demanddeposit_master002\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__demanddeposit_master002"}, "test.dga_data_model.orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date.61793b6aea": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__jupiter_cif_register_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__jupiter_cif_register_history"]}, "config": {"enabled": true, "alias": "orc_is_recency_stg_landing__ju_3c0dda1f906168dedf36327411b33dbf", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date.61793b6aea", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}{{ config(alias=\"orc_is_recency_stg_landing__ju_3c0dda1f906168dedf36327411b33dbf\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__ju_3c0dda1f906168dedf36327411b33dbf.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date", "alias": "orc_is_recency_stg_landing__ju_3c0dda1f906168dedf36327411b33dbf", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__jupiter_cif_register_history"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__ju_3c0dda1f906168dedf36327411b33dbf.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "orc_is_recency_stg_landing__ju_3c0dda1f906168dedf36327411b33dbf"}, "created_at": 1685959753.1722972, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__jupiter_cif_register_history\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__jupiter_cif_register_history"}, "test.dga_data_model.orc_is_recency_stg_landing__loan_application_facility_etl_date.c67bbe90a8": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__loan_application_facility')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__loan_application_facility"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__loan_application_facility_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__loan_application_facility_etl_date.c67bbe90a8", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__loan_application_facility_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__loan_application_facility_etl_date", "alias": "orc_is_recency_stg_landing__loan_application_facility_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__loan_application_facility"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__loan_application_facility_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.175297, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__loan_application_facility\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__loan_application_facility"}, "test.dga_data_model.orc_is_recency_stg_landing__loan_master002_etl_date.1bc920035b": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__loan_master002')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__loan_master002"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__loan_master002_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__loan_master002_etl_date.1bc920035b", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__loan_master002_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__loan_master002_etl_date", "alias": "orc_is_recency_stg_landing__loan_master002_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__loan_master002"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__loan_master002_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.178297, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__loan_master002\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__loan_master002"}, "test.dga_data_model.orc_is_recency_stg_landing__overdraft_tier001_etl_date.9945cfd653": {"test_metadata": {"name": "orc_is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(ref('stg_landing__overdraft_tier001')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_orc_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_landing__overdraft_tier001"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "landing", "daily", "orc_is_recency_stg_landing__overdraft_tier001_etl_date"], "unique_id": "test.dga_data_model.orc_is_recency_stg_landing__overdraft_tier001_etl_date.9945cfd653", "raw_code": "{{ test_orc_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "orc_is_recency_stg_landing__overdraft_tier001_etl_date.sql", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "orc_is_recency_stg_landing__overdraft_tier001_etl_date", "alias": "orc_is_recency_stg_landing__overdraft_tier001_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_landing__overdraft_tier001"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\landing\\daily\\landing_daily.yml\\orc_is_recency_stg_landing__overdraft_tier001_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.1802971, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    CASE\n      WHEN MAX(etl_date) >= to_number(to_char(sysdate- 1, 'YYYYDDD')) THEN 'true'\n      ELSE 'false'\n    END AS expression\n  FROM \"oracle_dgaworkzone\".staging.stg_landing__overdraft_tier001\n)\n, validation_errors as (\n  SELECT\n    *\n  FROM\n    test_expression\n  WHERE\n    expression = 'false'\n)\nSELECT *\nFROM validation_errors\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "models.stg_landing__overdraft_tier001"}, "test.dga_data_model.not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.fdf155c0bf": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "eb_application_id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_css_eb_applicant')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_css_eb_applicant"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.fdf155c0bf", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id", "alias": "not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_css_eb_applicant"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2203677, "compiled_code": "\n    \n    \n\n\n\nselect eb_application_id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_css_eb_applicant\nwhere eb_application_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "eb_application_id", "file_key_name": "models.stg_mercury__tbl_css_eb_applicant"}, "test.dga_data_model.not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.b4c30eb3a4": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "doc_need_list_id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_doc_detail')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_detail"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_doc_detail_doc_need_list_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.b4c30eb3a4", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_doc_detail_doc_need_list_id", "alias": "not_null_stg_mercury__tbl_doc_detail_doc_need_list_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_doc_detail"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2213688, "compiled_code": "\n    \n    \n\n\n\nselect doc_need_list_id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_detail\nwhere doc_need_list_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "doc_need_list_id", "file_key_name": "models.stg_mercury__tbl_doc_detail"}, "test.dga_data_model.not_null_stg_mercury__tbl_doc_need_list_process_instance_id.0c46006a7b": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "process_instance_id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_doc_need_list')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_need_list"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_doc_need_list_process_instance_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_doc_need_list_process_instance_id.0c46006a7b", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_doc_need_list_process_instance_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_doc_need_list_process_instance_id", "alias": "not_null_stg_mercury__tbl_doc_need_list_process_instance_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_doc_need_list"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_doc_need_list_process_instance_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.222366, "compiled_code": "\n    \n    \n\n\n\nselect process_instance_id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_need_list\nwhere process_instance_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "process_instance_id", "file_key_name": "models.stg_mercury__tbl_doc_need_list"}, "test.dga_data_model.not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.9ffee0b510": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "doc_need_list_id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_doc_no_hist')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_doc_no_hist"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.9ffee0b510", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id", "alias": "not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_doc_no_hist"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2243755, "compiled_code": "\n    \n    \n\n\n\nselect doc_need_list_id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_doc_no_hist\nwhere doc_need_list_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "doc_need_list_id", "file_key_name": "models.stg_mercury__tbl_doc_no_hist"}, "test.dga_data_model.not_null_stg_mercury__tbl_eb_applicant_eb_application_id.15581b5933": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "eb_application_id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_eb_applicant')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_eb_applicant"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_eb_applicant_eb_application_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_eb_applicant_eb_application_id.15581b5933", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_eb_applicant_eb_application_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_eb_applicant_eb_application_id", "alias": "not_null_stg_mercury__tbl_eb_applicant_eb_application_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_eb_applicant"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_eb_applicant_eb_application_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2253654, "compiled_code": "\n    \n    \n\n\n\nselect eb_application_id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_applicant\nwhere eb_application_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "eb_application_id", "file_key_name": "models.stg_mercury__tbl_eb_applicant"}, "test.dga_data_model.unique_stg_mercury__tbl_eb_application_id.f4697dc688": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_eb_application')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_eb_application"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "unique_stg_mercury__tbl_eb_application_id"], "unique_id": "test.dga_data_model.unique_stg_mercury__tbl_eb_application_id.f4697dc688", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_stg_mercury__tbl_eb_application_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "unique_stg_mercury__tbl_eb_application_id", "alias": "unique_stg_mercury__tbl_eb_application_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_eb_application"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\unique_stg_mercury__tbl_eb_application_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.226367, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_application\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.stg_mercury__tbl_eb_application"}, "test.dga_data_model.not_null_stg_mercury__tbl_eb_application_id.313e1bda9c": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_eb_application')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_eb_application"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_eb_application_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_eb_application_id.313e1bda9c", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_eb_application_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_eb_application_id", "alias": "not_null_stg_mercury__tbl_eb_application_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_eb_application"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_eb_application_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2283673, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_eb_application\nwhere id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.stg_mercury__tbl_eb_application"}, "test.dga_data_model.unique_stg_mercury__tbl_applicant_enterprise_income_id.4dc6760cd3": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_applicant_enterprise_income')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "unique_stg_mercury__tbl_applicant_enterprise_income_id"], "unique_id": "test.dga_data_model.unique_stg_mercury__tbl_applicant_enterprise_income_id.4dc6760cd3", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_stg_mercury__tbl_applicant_enterprise_income_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "unique_stg_mercury__tbl_applicant_enterprise_income_id", "alias": "unique_stg_mercury__tbl_applicant_enterprise_income_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_applicant_enterprise_income"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\unique_stg_mercury__tbl_applicant_enterprise_income_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2293682, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_applicant_enterprise_income\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.stg_mercury__tbl_applicant_enterprise_income"}, "test.dga_data_model.not_null_stg_mercury__tbl_applicant_enterprise_income_id.1112240430": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_mercury__tbl_applicant_enterprise_income')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "mercury", "not_null_stg_mercury__tbl_applicant_enterprise_income_id"], "unique_id": "test.dga_data_model.not_null_stg_mercury__tbl_applicant_enterprise_income_id.1112240430", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_mercury__tbl_applicant_enterprise_income_id.sql", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "not_null_stg_mercury__tbl_applicant_enterprise_income_id", "alias": "not_null_stg_mercury__tbl_applicant_enterprise_income_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_mercury__tbl_applicant_enterprise_income"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\mercury\\source_mercury.yml\\not_null_stg_mercury__tbl_applicant_enterprise_income_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2303667, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"oracle_dgaworkzone\".staging.stg_mercury__tbl_applicant_enterprise_income\nwhere id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.stg_mercury__tbl_applicant_enterprise_income"}, "test.dga_data_model.unique_stg_way4__acnt_contract_id.6d1e1f65a1": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_way4__acnt_contract')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_way4__acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "way4", "unique_stg_way4__acnt_contract_id"], "unique_id": "test.dga_data_model.unique_stg_way4__acnt_contract_id.6d1e1f65a1", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_stg_way4__acnt_contract_id.sql", "original_file_path": "models\\staging\\way4\\way4.yml", "name": "unique_stg_way4__acnt_contract_id", "alias": "unique_stg_way4__acnt_contract_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_way4__acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\way4\\way4.yml\\unique_stg_way4__acnt_contract_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2752957, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"oracle_dgaworkzone\".staging.stg_way4__acnt_contract\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.stg_way4__acnt_contract"}, "test.dga_data_model.not_null_stg_way4__acnt_contract_id.c5a7413b7e": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_way4__acnt_contract')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.dga_data_model.stg_way4__acnt_contract"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "way4", "not_null_stg_way4__acnt_contract_id"], "unique_id": "test.dga_data_model.not_null_stg_way4__acnt_contract_id.c5a7413b7e", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_way4__acnt_contract_id.sql", "original_file_path": "models\\staging\\way4\\way4.yml", "name": "not_null_stg_way4__acnt_contract_id", "alias": "not_null_stg_way4__acnt_contract_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_way4__acnt_contract"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\staging\\way4\\way4.yml\\not_null_stg_way4__acnt_contract_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2763245, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"oracle_dgaworkzone\".staging.stg_way4__acnt_contract\nwhere id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "id", "file_key_name": "models.stg_way4__acnt_contract"}, "test.dga_data_model.unique_stg_cr_limit_log_id.72e579340e": {"test_metadata": {"name": "unique", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_cr_limit_log')) }}"}, "namespace": null}, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "way4", "unique_stg_cr_limit_log_id"], "unique_id": "test.dga_data_model.unique_stg_cr_limit_log_id.72e579340e", "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "unique_stg_cr_limit_log_id.sql", "original_file_path": "models\\staging\\way4\\way4.yml", "name": "unique_stg_cr_limit_log_id", "alias": "unique_stg_cr_limit_log_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cr_limit_log"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2782972, "column_name": "id", "file_key_name": "models.stg_cr_limit_log"}, "test.dga_data_model.not_null_stg_cr_limit_log_id.65f3470229": {"test_metadata": {"name": "not_null", "kwargs": {"column_name": "id", "model": "{{ get_where_subquery(ref('stg_cr_limit_log')) }}"}, "namespace": null}, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "staging", "way4", "not_null_stg_cr_limit_log_id"], "unique_id": "test.dga_data_model.not_null_stg_cr_limit_log_id.65f3470229", "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "not_null_stg_cr_limit_log_id.sql", "original_file_path": "models\\staging\\way4\\way4.yml", "name": "not_null_stg_cr_limit_log_id", "alias": "not_null_stg_cr_limit_log_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_cr_limit_log"]], "sources": [], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.2803667, "column_name": "id", "file_key_name": "models.stg_cr_limit_log"}, "test.dga_data_model.source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date.1cf303bcbd": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["etl_date", "account_no_sk"], "condition_columns": "etl_date", "model": "{{ get_where_subquery(source('dwh', 'ddft_master')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.ddft_master"]}, "config": {"enabled": true, "alias": "source_unique_combination_of_c_8e29ed9f3acb91bf7fa6845cffb4589c", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date"], "unique_id": "test.dga_data_model.source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date.1cf303bcbd", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_unique_combination_of_c_8e29ed9f3acb91bf7fa6845cffb4589c\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_unique_combination_of_c_8e29ed9f3acb91bf7fa6845cffb4589c.sql", "original_file_path": "models\\base\\base.yml", "name": "source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date", "alias": "source_unique_combination_of_c_8e29ed9f3acb91bf7fa6845cffb4589c", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "ddft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_unique_combination_of_c_8e29ed9f3acb91bf7fa6845cffb4589c.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_unique_combination_of_c_8e29ed9f3acb91bf7fa6845cffb4589c"}, "created_at": 1685959753.3860106, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        etl_date, account_no_sk\n    from oracle_dwh.dwh.ddft_master\n    where etl_date >= (select max(etl_date) from oracle_dwh.dwh.ddft_master)\n    group by etl_date, account_no_sk\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dwh"}, "test.dga_data_model.source_is_recency_dwh_ddft_master_etl_date.58b2088fa3": {"test_metadata": {"name": "is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(source('dwh', 'ddft_master')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.ddft_master"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_is_recency_dwh_ddft_master_etl_date"], "unique_id": "test.dga_data_model.source_is_recency_dwh_ddft_master_etl_date.58b2088fa3", "raw_code": "{{ test_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_recency_dwh_ddft_master_etl_date.sql", "original_file_path": "models\\base\\base.yml", "name": "source_is_recency_dwh_ddft_master_etl_date", "alias": "source_is_recency_dwh_ddft_master_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "ddft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_is_recency_dwh_ddft_master_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.3900108, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    MAX(etl_date) >=\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - 1) AS expression\n  FROM oracle_dwh.dwh.ddft_master\n)\n, validation_errors as (\n  SELECT\n      *\n  FROM\n      test_expression\n  WHERE\n    NOT(expression = true)\n)\nSELECT *\nFROM validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "sources.dwh"}, "test.dga_data_model.source_is_recency_dwh_ddft_transaction_trn_date.b05d64f57c": {"test_metadata": {"name": "is_recency", "kwargs": {"column_name": "trn_date", "model": "{{ get_where_subquery(source('dwh', 'ddft_transaction')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.ddft_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_is_recency_dwh_ddft_transaction_trn_date"], "unique_id": "test.dga_data_model.source_is_recency_dwh_ddft_transaction_trn_date.b05d64f57c", "raw_code": "{{ test_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_recency_dwh_ddft_transaction_trn_date.sql", "original_file_path": "models\\base\\base.yml", "name": "source_is_recency_dwh_ddft_transaction_trn_date", "alias": "source_is_recency_dwh_ddft_transaction_trn_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "ddft_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_is_recency_dwh_ddft_transaction_trn_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.3940108, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    MAX(trn_date) >=\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - 1) AS expression\n  FROM oracle_dwh.dwh.ddft_transaction\n)\n, validation_errors as (\n  SELECT\n      *\n  FROM\n      test_expression\n  WHERE\n    NOT(expression = true)\n)\nSELECT *\nFROM validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "trn_date", "file_key_name": "sources.dwh"}, "test.dga_data_model.source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date.6f8ee49248": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["etl_date", "account_sk"], "condition_columns": "etl_date", "model": "{{ get_where_subquery(source('dwh', 'fdft_master')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.fdft_master"]}, "config": {"enabled": true, "alias": "source_unique_combination_of_c_7a6babda8e2b76bfaaaa7da1792a39c4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date"], "unique_id": "test.dga_data_model.source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date.6f8ee49248", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_unique_combination_of_c_7a6babda8e2b76bfaaaa7da1792a39c4\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_unique_combination_of_c_7a6babda8e2b76bfaaaa7da1792a39c4.sql", "original_file_path": "models\\base\\base.yml", "name": "source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date", "alias": "source_unique_combination_of_c_7a6babda8e2b76bfaaaa7da1792a39c4", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "fdft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_unique_combination_of_c_7a6babda8e2b76bfaaaa7da1792a39c4.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_unique_combination_of_c_7a6babda8e2b76bfaaaa7da1792a39c4"}, "created_at": 1685959753.397012, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        etl_date, account_sk\n    from oracle_dwh.dwh.fdft_master\n    where etl_date >= (select max(etl_date) from oracle_dwh.dwh.fdft_master)\n    group by etl_date, account_sk\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dwh"}, "test.dga_data_model.source_is_recency_dwh_fdft_master_etl_date.9ed31cec99": {"test_metadata": {"name": "is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(source('dwh', 'fdft_master')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.fdft_master"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_is_recency_dwh_fdft_master_etl_date"], "unique_id": "test.dga_data_model.source_is_recency_dwh_fdft_master_etl_date.9ed31cec99", "raw_code": "{{ test_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_recency_dwh_fdft_master_etl_date.sql", "original_file_path": "models\\base\\base.yml", "name": "source_is_recency_dwh_fdft_master_etl_date", "alias": "source_is_recency_dwh_fdft_master_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "fdft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_is_recency_dwh_fdft_master_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.401011, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    MAX(etl_date) >=\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - 1) AS expression\n  FROM oracle_dwh.dwh.fdft_master\n)\n, validation_errors as (\n  SELECT\n      *\n  FROM\n      test_expression\n  WHERE\n    NOT(expression = true)\n)\nSELECT *\nFROM validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "sources.dwh"}, "test.dga_data_model.source_is_recency_dwh_fdft_transaction_trn_date.05214279e7": {"test_metadata": {"name": "is_recency", "kwargs": {"column_name": "trn_date", "model": "{{ get_where_subquery(source('dwh', 'fdft_transaction')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.fdft_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_is_recency_dwh_fdft_transaction_trn_date"], "unique_id": "test.dga_data_model.source_is_recency_dwh_fdft_transaction_trn_date.05214279e7", "raw_code": "{{ test_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_recency_dwh_fdft_transaction_trn_date.sql", "original_file_path": "models\\base\\base.yml", "name": "source_is_recency_dwh_fdft_transaction_trn_date", "alias": "source_is_recency_dwh_fdft_transaction_trn_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "fdft_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_is_recency_dwh_fdft_transaction_trn_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.4040108, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    MAX(trn_date) >=\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - 1) AS expression\n  FROM oracle_dwh.dwh.fdft_transaction\n)\n, validation_errors as (\n  SELECT\n      *\n  FROM\n      test_expression\n  WHERE\n    NOT(expression = true)\n)\nSELECT *\nFROM validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "trn_date", "file_key_name": "sources.dwh"}, "test.dga_data_model.source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date.f516a10e24": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["etl_date", "account_no_sk"], "condition_columns": "etl_date", "model": "{{ get_where_subquery(source('dwh', 'lnft_master')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.lnft_master"]}, "config": {"enabled": true, "alias": "source_unique_combination_of_c_649711706f360a990568ceba96c6dd20", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date"], "unique_id": "test.dga_data_model.source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date.f516a10e24", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_unique_combination_of_c_649711706f360a990568ceba96c6dd20\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_unique_combination_of_c_649711706f360a990568ceba96c6dd20.sql", "original_file_path": "models\\base\\base.yml", "name": "source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date", "alias": "source_unique_combination_of_c_649711706f360a990568ceba96c6dd20", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "lnft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_unique_combination_of_c_649711706f360a990568ceba96c6dd20.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_unique_combination_of_c_649711706f360a990568ceba96c6dd20"}, "created_at": 1685959753.4070108, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        etl_date, account_no_sk\n    from oracle_dwh.dwh.lnft_master\n    where etl_date >= (select max(etl_date) from oracle_dwh.dwh.lnft_master)\n    group by etl_date, account_no_sk\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dwh"}, "test.dga_data_model.source_is_recency_dwh_lnft_master_etl_date.7d978c35de": {"test_metadata": {"name": "is_recency", "kwargs": {"column_name": "etl_date", "model": "{{ get_where_subquery(source('dwh', 'lnft_master')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.lnft_master"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_is_recency_dwh_lnft_master_etl_date"], "unique_id": "test.dga_data_model.source_is_recency_dwh_lnft_master_etl_date.7d978c35de", "raw_code": "{{ test_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_recency_dwh_lnft_master_etl_date.sql", "original_file_path": "models\\base\\base.yml", "name": "source_is_recency_dwh_lnft_master_etl_date", "alias": "source_is_recency_dwh_lnft_master_etl_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "lnft_master"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_is_recency_dwh_lnft_master_etl_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.4110107, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    MAX(etl_date) >=\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - 1) AS expression\n  FROM oracle_dwh.dwh.lnft_master\n)\n, validation_errors as (\n  SELECT\n      *\n  FROM\n      test_expression\n  WHERE\n    NOT(expression = true)\n)\nSELECT *\nFROM validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "etl_date", "file_key_name": "sources.dwh"}, "test.dga_data_model.source_is_recency_dwh_lnft_transaction_tran_date.396f7d9c7e": {"test_metadata": {"name": "is_recency", "kwargs": {"column_name": "tran_date", "model": "{{ get_where_subquery(source('dwh', 'lnft_transaction')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_recency", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dwh.lnft_transaction"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_is_recency_dwh_lnft_transaction_tran_date"], "unique_id": "test.dga_data_model.source_is_recency_dwh_lnft_transaction_tran_date.396f7d9c7e", "raw_code": "{{ test_is_recency(**_dbt_generic_test_kwargs) }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_recency_dwh_lnft_transaction_tran_date.sql", "original_file_path": "models\\base\\base.yml", "name": "source_is_recency_dwh_lnft_transaction_tran_date", "alias": "source_is_recency_dwh_lnft_transaction_tran_date", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dwh", "lnft_transaction"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_is_recency_dwh_lnft_transaction_tran_date.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1685959753.4140108, "compiled_code": "\n\nWITH test_expression as (\n  SELECT\n    MAX(tran_date) >=\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - 1) AS expression\n  FROM oracle_dwh.dwh.lnft_transaction\n)\n, validation_errors as (\n  SELECT\n      *\n  FROM\n      test_expression\n  WHERE\n    NOT(expression = true)\n)\nSELECT *\nFROM validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "tran_date", "file_key_name": "sources.dwh"}, "test.dga_data_model.source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode.281de86ed2": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["yearmonth", "cif", "taxcode"], "model": "{{ get_where_subquery(source('dga', 'thuvh3_eb_dm_luyke')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dga.thuvh3_eb_dm_luyke"]}, "config": {"enabled": true, "alias": "source_unique_combination_of_c_eda22ab6e28e5a7646df3fd10ac8279b", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode"], "unique_id": "test.dga_data_model.source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode.281de86ed2", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_unique_combination_of_c_eda22ab6e28e5a7646df3fd10ac8279b\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_unique_combination_of_c_eda22ab6e28e5a7646df3fd10ac8279b.sql", "original_file_path": "models\\base\\base.yml", "name": "source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode", "alias": "source_unique_combination_of_c_eda22ab6e28e5a7646df3fd10ac8279b", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dga", "thuvh3_eb_dm_luyke"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_unique_combination_of_c_eda22ab6e28e5a7646df3fd10ac8279b.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_unique_combination_of_c_eda22ab6e28e5a7646df3fd10ac8279b"}, "created_at": 1685959753.4170108, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        yearmonth, cif, taxcode\n    from oracle_dgaworkzone.dga.thuvh3_eb_dm_luyke\n    where  >= (select max() from oracle_dgaworkzone.dga.thuvh3_eb_dm_luyke)\n    group by yearmonth, cif, taxcode\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dga"}, "test.dga_data_model.source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode.7aa21fe19d": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["year", "cifno", "taxcode"], "model": "{{ get_where_subquery(source('dga', 'tunglt_eb_acct_khsx')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dga.tunglt_eb_acct_khsx"]}, "config": {"enabled": true, "alias": "source_unique_combination_of_c_540903da4113383cb86d7c108b983bed", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode"], "unique_id": "test.dga_data_model.source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode.7aa21fe19d", "raw_code": "{{ test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_unique_combination_of_c_540903da4113383cb86d7c108b983bed\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_unique_combination_of_c_540903da4113383cb86d7c108b983bed.sql", "original_file_path": "models\\base\\base.yml", "name": "source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode", "alias": "source_unique_combination_of_c_540903da4113383cb86d7c108b983bed", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dga", "tunglt_eb_acct_khsx"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\base.yml\\source_unique_combination_of_c_540903da4113383cb86d7c108b983bed.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_unique_combination_of_c_540903da4113383cb86d7c108b983bed"}, "created_at": 1685959753.421011, "compiled_code": "\n\nwith validation_errors as (\n\n    select\n        year, cifno, taxcode\n    from oracle_dgaworkzone.dga.tunglt_eb_acct_khsx\n    where  >= (select max() from oracle_dgaworkzone.dga.tunglt_eb_acct_khsx)\n    group by year, cifno, taxcode\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dga"}, "test.dga_data_model.source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_.22fea21b94": {"test_metadata": {"name": "is_updated", "kwargs": {"expression": "MAX(cast(yearmonth AS integer))", "compare_model": "oracle_dgaworkzone.base.qlhs__data_toi", "model": "{{ get_where_subquery(source('dbo', 'data_toi_df')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_updated", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dbo.data_toi_df"]}, "config": {"enabled": true, "alias": "source_is_updated_dbo_data_toi_1dd9bd31571f85ca02278e64ee51df21", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_"], "unique_id": "test.dga_data_model.source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_.22fea21b94", "raw_code": "{{ test_is_updated(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_is_updated_dbo_data_toi_1dd9bd31571f85ca02278e64ee51df21\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_updated_dbo_data_toi_1dd9bd31571f85ca02278e64ee51df21.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_", "alias": "source_is_updated_dbo_data_toi_1dd9bd31571f85ca02278e64ee51df21", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dbo", "data_toi_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\source_is_updated_dbo_data_toi_1dd9bd31571f85ca02278e64ee51df21.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_is_updated_dbo_data_toi_1dd9bd31571f85ca02278e64ee51df21"}, "created_at": 1685959753.4260106, "compiled_code": "\n\nWITH source as (\n  SELECT\n    MAX(cast(yearmonth AS integer)) AS exp\n  FROM sql_server_qlhs.dbo.data_toi_df\n)\n, destination as (\n  SELECT\n    MAX(cast(yearmonth AS integer)) AS exp\n  FROM oracle_dgaworkzone.base.qlhs__data_toi\n)\n, is_updated AS (\nSELECT\n  CASE\n    WHEN s.exp > d.exp THEN 't'\n    ELSE 'f'\n  END AS is_updated\nFROM source s, destination d\n)\n  SELECT * FROM is_updated\n  WHERE is_updated = 'f'\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dbo"}, "test.dga_data_model.source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_.08dc2fc82f": {"test_metadata": {"name": "is_updated", "kwargs": {"expression": "MAX(cast(yearmonth AS integer))", "compare_model": "oracle_dgaworkzone.base.qlhs__customer_product_holding_df", "model": "{{ get_where_subquery(source('dbo', 'customer_product_holding_df')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_updated", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dbo.customer_product_holding_df"]}, "config": {"enabled": true, "alias": "source_is_updated_dbo_customer_16bf02dcdb4db0db4c01fdcb4288b3d4", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_"], "unique_id": "test.dga_data_model.source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_.08dc2fc82f", "raw_code": "{{ test_is_updated(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_is_updated_dbo_customer_16bf02dcdb4db0db4c01fdcb4288b3d4\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_updated_dbo_customer_16bf02dcdb4db0db4c01fdcb4288b3d4.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_", "alias": "source_is_updated_dbo_customer_16bf02dcdb4db0db4c01fdcb4288b3d4", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dbo", "customer_product_holding_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\source_is_updated_dbo_customer_16bf02dcdb4db0db4c01fdcb4288b3d4.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_is_updated_dbo_customer_16bf02dcdb4db0db4c01fdcb4288b3d4"}, "created_at": 1685959753.4310107, "compiled_code": "\n\nWITH source as (\n  SELECT\n    MAX(cast(yearmonth AS integer)) AS exp\n  FROM sql_server_qlhs.dbo.customer_product_holding_df\n)\n, destination as (\n  SELECT\n    MAX(cast(yearmonth AS integer)) AS exp\n  FROM oracle_dgaworkzone.base.qlhs__customer_product_holding_df\n)\n, is_updated AS (\nSELECT\n  CASE\n    WHEN s.exp > d.exp THEN 't'\n    ELSE 'f'\n  END AS is_updated\nFROM source s, destination d\n)\n  SELECT * FROM is_updated\n  WHERE is_updated = 'f'\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dbo"}, "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno.a1d6695c4f": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["yearmonth", "cifno"], "model": "{{ get_where_subquery(source('dbo', 'customer_product_holding_df')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["source.dga_data_model.dbo.customer_product_holding_df"]}, "config": {"enabled": true, "alias": "dbt_utils_source_unique_combin_39b8b9e1c12fdb9f9f33cc89a7847f10", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno"], "unique_id": "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno.a1d6695c4f", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_source_unique_combin_39b8b9e1c12fdb9f9f33cc89a7847f10\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_source_unique_combin_39b8b9e1c12fdb9f9f33cc89a7847f10.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno", "alias": "dbt_utils_source_unique_combin_39b8b9e1c12fdb9f9f33cc89a7847f10", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dbo", "customer_product_holding_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\dbt_utils_source_unique_combin_39b8b9e1c12fdb9f9f33cc89a7847f10.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_source_unique_combin_39b8b9e1c12fdb9f9f33cc89a7847f10"}, "created_at": 1685959753.435011, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        yearmonth, cifno\n    from sql_server_qlhs.dbo.customer_product_holding_df\n    group by yearmonth, cifno\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dbo"}, "test.dga_data_model.source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_.f4966ea198": {"test_metadata": {"name": "is_updated", "kwargs": {"expression": "MAX(cast(yearmonth AS integer))", "compare_model": "oracle_dgaworkzone.base.qlhs__customer_active_df", "model": "{{ get_where_subquery(source('dbo', 'customer_active_df')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_is_updated", "macro.dbt.get_where_subquery"], "nodes": ["source.dga_data_model.dbo.customer_active_df"]}, "config": {"enabled": true, "alias": "source_is_updated_dbo_customer_1fb5577e7f71a6481fe149c36b728bd6", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_"], "unique_id": "test.dga_data_model.source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_.f4966ea198", "raw_code": "{{ test_is_updated(**_dbt_generic_test_kwargs) }}{{ config(alias=\"source_is_updated_dbo_customer_1fb5577e7f71a6481fe149c36b728bd6\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "source_is_updated_dbo_customer_1fb5577e7f71a6481fe149c36b728bd6.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_", "alias": "source_is_updated_dbo_customer_1fb5577e7f71a6481fe149c36b728bd6", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dbo", "customer_active_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\source_is_updated_dbo_customer_1fb5577e7f71a6481fe149c36b728bd6.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "source_is_updated_dbo_customer_1fb5577e7f71a6481fe149c36b728bd6"}, "created_at": 1685959753.439011, "compiled_code": "\n\nWITH source as (\n  SELECT\n    MAX(cast(yearmonth AS integer)) AS exp\n  FROM sql_server_qlhs.dbo.customer_active_df\n)\n, destination as (\n  SELECT\n    MAX(cast(yearmonth AS integer)) AS exp\n  FROM oracle_dgaworkzone.base.qlhs__customer_active_df\n)\n, is_updated AS (\nSELECT\n  CASE\n    WHEN s.exp > d.exp THEN 't'\n    ELSE 'f'\n  END AS is_updated\nFROM source s, destination d\n)\n  SELECT * FROM is_updated\n  WHERE is_updated = 'f'\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dbo"}, "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno.d645917cc2": {"test_metadata": {"name": "unique_combination_of_columns", "kwargs": {"combination_of_columns": ["yearmonth", "cifno"], "model": "{{ get_where_subquery(source('dbo', 'customer_active_df')) }}"}, "namespace": "dbt_utils"}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dga_data_model.test_unique_combination_of_columns", "macro.dbt.get_where_subquery", "macro.dbt_utils.test_unique_combination_of_columns"], "nodes": ["source.dga_data_model.dbo.customer_active_df"]}, "config": {"enabled": true, "alias": "dbt_utils_source_unique_combin_f201eb300703dd702a93dd3667548006", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "base", "qlhs", "dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno"], "unique_id": "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno.d645917cc2", "raw_code": "{{ dbt_utils.test_unique_combination_of_columns(**_dbt_generic_test_kwargs) }}{{ config(alias=\"dbt_utils_source_unique_combin_f201eb300703dd702a93dd3667548006\") }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "dbt_utils_source_unique_combin_f201eb300703dd702a93dd3667548006.sql", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno", "alias": "dbt_utils_source_unique_combin_f201eb300703dd702a93dd3667548006", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [], "sources": [["dbo", "customer_active_df"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": "/tmp/target\\compiled\\dga_data_model\\models\\base\\qlhs\\qlhs.yml\\dbt_utils_source_unique_combin_f201eb300703dd702a93dd3667548006.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "dbt_utils_source_unique_combin_f201eb300703dd702a93dd3667548006"}, "created_at": 1685959753.442011, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        yearmonth, cifno\n    from sql_server_qlhs.dbo.customer_active_df\n    group by yearmonth, cifno\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": null, "file_key_name": "sources.dbo"}}, "sources": {"source.dga_data_model.dwh.ddft_master": {"fqn": ["dga_data_model", "base", "dwh", "ddft_master"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.ddft_master", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "ddft_master", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "ddft_master", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.ddft_master", "created_at": 1685959753.3940108}, "source.dga_data_model.dwh.ddft_transaction": {"fqn": ["dga_data_model", "base", "dwh", "ddft_transaction"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.ddft_transaction", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "ddft_transaction", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "ddft_transaction", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {"trn_date": {"name": "trn_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.ddft_transaction", "created_at": 1685959753.396011}, "source.dga_data_model.dwh.fdft_master": {"fqn": ["dga_data_model", "base", "dwh", "fdft_master"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.fdft_master", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "fdft_master", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "fdft_master", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.fdft_master", "created_at": 1685959753.4030108}, "source.dga_data_model.dwh.fdft_transaction": {"fqn": ["dga_data_model", "base", "dwh", "fdft_transaction"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.fdft_transaction", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "fdft_transaction", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "fdft_transaction", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {"trn_date": {"name": "trn_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.fdft_transaction", "created_at": 1685959753.4060109}, "source.dga_data_model.dwh.lnft_master": {"fqn": ["dga_data_model", "base", "dwh", "lnft_master"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.lnft_master", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "lnft_master", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "lnft_master", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {"etl_date": {"name": "etl_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.lnft_master", "created_at": 1685959753.4130108}, "source.dga_data_model.dwh.lnft_transaction": {"fqn": ["dga_data_model", "base", "dwh", "lnft_transaction"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.lnft_transaction", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "lnft_transaction", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "lnft_transaction", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {"tran_date": {"name": "tran_date", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.lnft_transaction", "created_at": 1685959753.416011}, "source.dga_data_model.dwh.ccl_pln": {"fqn": ["dga_data_model", "base", "dwh", "ccl_pln"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.ccl_pln", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "ccl_pln", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "ccl_pln", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.ccl_pln", "created_at": 1685959753.416011}, "source.dga_data_model.dwh.glft_his_transaction": {"fqn": ["dga_data_model", "base", "dwh", "glft_his_transaction"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.dwh.glft_his_transaction", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "glft_his_transaction", "source_name": "dwh", "source_description": "", "loader": "", "identifier": "glft_his_transaction", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.glft_his_transaction", "created_at": 1685959753.416011}, "source.dga_data_model.dga_ingest.lc_cc_mast": {"fqn": ["dga_data_model", "base", "dga_ingest", "lc_cc_mast"], "database": "oracle_ldz", "schema": "dga_ingest", "unique_id": "source.dga_data_model.dga_ingest.lc_cc_mast", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "lc_cc_mast", "source_name": "dga_ingest", "source_description": "", "loader": "", "identifier": "lc_cc_mast", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "pstd", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {"pstd": {"name": "pstd", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_ldz.dga_ingest.lc_cc_mast", "created_at": 1685959753.416011}, "source.dga_data_model.base.dbt_test_materialized": {"fqn": ["dga_data_model", "base", "base", "dbt_test_materialized"], "database": "oracle_dgaworkzone", "schema": "base", "unique_id": "source.dga_data_model.base.dbt_test_materialized", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "dbt_test_materialized", "source_name": "base", "source_description": "", "loader": "", "identifier": "dbt_test_materialized", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.base.dbt_test_materialized", "created_at": 1685959753.416011}, "source.dga_data_model.dga.thuvh3_eb_dm_luyke": {"fqn": ["dga_data_model", "base", "dga", "thuvh3_eb_dm_luyke"], "database": "oracle_dgaworkzone", "schema": "dga", "unique_id": "source.dga_data_model.dga.thuvh3_eb_dm_luyke", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "thuvh3_eb_dm_luyke", "source_name": "dga", "source_description": "", "loader": "", "identifier": "thuvh3_eb_dm_luyke", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.dga.thuvh3_eb_dm_luyke", "created_at": 1685959753.420011}, "source.dga_data_model.dga.anlt4_eb_txn_processed": {"fqn": ["dga_data_model", "base", "dga", "anlt4_eb_txn_processed"], "database": "oracle_dgaworkzone", "schema": "dga", "unique_id": "source.dga_data_model.dga.anlt4_eb_txn_processed", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "anlt4_eb_txn_processed", "source_name": "dga", "source_description": "", "loader": "", "identifier": "anlt4_eb_txn_processed", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(dayid,'yyyymmdd')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 5, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.dga.anlt4_eb_txn_processed", "created_at": 1685959753.421011}, "source.dga_data_model.dga.tunglt_eb_acct_khsx": {"fqn": ["dga_data_model", "base", "dga", "tunglt_eb_acct_khsx"], "database": "oracle_dgaworkzone", "schema": "dga", "unique_id": "source.dga_data_model.dga.tunglt_eb_acct_khsx", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "tunglt_eb_acct_khsx", "source_name": "dga", "source_description": "", "loader": "", "identifier": "tunglt_eb_acct_khsx", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.dga.tunglt_eb_acct_khsx", "created_at": 1685959753.4250112}, "source.dga_data_model.dga.tunglt_eb_health_financing": {"fqn": ["dga_data_model", "base", "dga", "tunglt_eb_health_financing"], "database": "oracle_dgaworkzone", "schema": "dga", "unique_id": "source.dga_data_model.dga.tunglt_eb_health_financing", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "tunglt_eb_health_financing", "source_name": "dga", "source_description": "", "loader": "", "identifier": "tunglt_eb_health_financing", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.dga.tunglt_eb_health_financing", "created_at": 1685959753.4250112}, "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "bpm_bulanding", "thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL", "source_name": "bpm_bulanding", "source_description": "", "loader": "", "identifier": "thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "bpm_bulanding", "thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\base.yml", "original_file_path": "models\\base\\base.yml", "name": "thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL", "source_name": "bpm_bulanding", "source_description": "", "loader": "", "identifier": "thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.ews_bulanding.ews_rb_cust_info @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "ews_rb", "ews_bulanding", "ews_rb_cust_info @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.ews_bulanding.ews_rb_cust_info @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\ews_rb\\ews_rb.yml", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "ews_rb_cust_info @DGA_READ_BULANDING_DBL", "source_name": "ews_bulanding", "source_description": "", "loader": "", "identifier": "ews_rb_cust_info @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.ews_rb_cust_info @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.ews_bulanding.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "ews_rb", "ews_bulanding", "ews_rb_thruput_casa @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.ews_bulanding.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\ews_rb\\ews_rb.yml", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "ews_rb_thruput_casa @DGA_READ_BULANDING_DBL", "source_name": "ews_bulanding", "source_description": "", "loader": "", "identifier": "ews_rb_thruput_casa @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.ews_bulanding.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "ews_rb", "ews_bulanding", "ews_rb_thruput_fd @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.ews_bulanding.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\ews_rb\\ews_rb.yml", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "ews_rb_thruput_fd @DGA_READ_BULANDING_DBL", "source_name": "ews_bulanding", "source_description": "", "loader": "", "identifier": "ews_rb_thruput_fd @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.ews_bulanding.ews_rb_thruput_in @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "ews_rb", "ews_bulanding", "ews_rb_thruput_in @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.ews_bulanding.ews_rb_thruput_in @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\ews_rb\\ews_rb.yml", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "ews_rb_thruput_in @DGA_READ_BULANDING_DBL", "source_name": "ews_bulanding", "source_description": "", "loader": "", "identifier": "ews_rb_thruput_in @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.ews_rb_thruput_in @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.ews_bulanding.ews_rb_thruput_out @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "base", "ews_rb", "ews_bulanding", "ews_rb_thruput_out @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.ews_bulanding.ews_rb_thruput_out @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\ews_rb\\ews_rb.yml", "original_file_path": "models\\base\\ews_rb\\ews_rb.yml", "name": "ews_rb_thruput_out @DGA_READ_BULANDING_DBL", "source_name": "ews_bulanding", "source_description": "", "loader": "", "identifier": "ews_rb_thruput_out @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.ews_rb_thruput_out @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4250112}, "source.dga_data_model.dbo.data_toi_df": {"fqn": ["dga_data_model", "base", "qlhs", "dbo", "data_toi_df"], "database": "sql_server_qlhs", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.data_toi_df", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\qlhs\\qlhs.yml", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "data_toi_df", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "data_toi_df", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sql_server_qlhs.dbo.data_toi_df", "created_at": 1685959753.4300108}, "source.dga_data_model.dbo.customer_product_holding_df": {"fqn": ["dga_data_model", "base", "qlhs", "dbo", "customer_product_holding_df"], "database": "sql_server_qlhs", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.customer_product_holding_df", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\qlhs\\qlhs.yml", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "customer_product_holding_df", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "customer_product_holding_df", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sql_server_qlhs.dbo.customer_product_holding_df", "created_at": 1685959753.4380112}, "source.dga_data_model.dbo.customer_active_df": {"fqn": ["dga_data_model", "base", "qlhs", "dbo", "customer_active_df"], "database": "sql_server_qlhs", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.customer_active_df", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\qlhs\\qlhs.yml", "original_file_path": "models\\base\\qlhs\\qlhs.yml", "name": "customer_active_df", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "customer_active_df", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sql_server_qlhs.dbo.customer_active_df", "created_at": 1685959753.4450111}, "source.dga_data_model.vision.mgt_result_headers": {"fqn": ["dga_data_model", "base", "vision", "vision", "mgt_result_headers"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.mgt_result_headers", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "mgt_result_headers", "source_name": "vision", "source_description": "", "loader": "", "identifier": "mgt_result_headers", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.mgt_result_headers", "created_at": 1685959753.4450111}, "source.dga_data_model.vision.currency_rates_daily": {"fqn": ["dga_data_model", "base", "vision", "vision", "currency_rates_daily"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.currency_rates_daily", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "currency_rates_daily", "source_name": "vision", "source_description": "", "loader": "", "identifier": "currency_rates_daily", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.currency_rates_daily", "created_at": 1685959753.446011}, "source.dga_data_model.vision.mgt_expanded": {"fqn": ["dga_data_model", "base", "vision", "vision", "mgt_expanded"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.mgt_expanded", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "mgt_expanded", "source_name": "vision", "source_description": "", "loader": "", "identifier": "mgt_expanded", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.mgt_expanded", "created_at": 1685959753.446011}, "source.dga_data_model.vision.contracts": {"fqn": ["dga_data_model", "base", "vision", "vision", "contracts"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.contracts", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "contracts", "source_name": "vision", "source_description": "", "loader": "", "identifier": "contracts", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.contracts", "created_at": 1685959753.446011}, "source.dga_data_model.vision.customers": {"fqn": ["dga_data_model", "base", "vision", "vision", "customers"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.customers", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "customers", "source_name": "vision", "source_description": "", "loader": "", "identifier": "customers", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.customers", "created_at": 1685959753.446011}, "source.dga_data_model.vision.fin_dly_mappings_pm": {"fqn": ["dga_data_model", "base", "vision", "vision", "fin_dly_mappings_pm"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.fin_dly_mappings_pm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "fin_dly_mappings_pm", "source_name": "vision", "source_description": "", "loader": "", "identifier": "fin_dly_mappings_pm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.fin_dly_mappings_pm", "created_at": 1685959753.446011}, "source.dga_data_model.vision.fin_dly_balances_pm": {"fqn": ["dga_data_model", "base", "vision", "vision", "fin_dly_balances_pm"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.fin_dly_balances_pm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "fin_dly_balances_pm", "source_name": "vision", "source_description": "", "loader": "", "identifier": "fin_dly_balances_pm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.fin_dly_balances_pm", "created_at": 1685959753.446011}, "source.dga_data_model.vision.vw_fin_dly_headers_pm": {"fqn": ["dga_data_model", "base", "vision", "vision", "vw_fin_dly_headers_pm"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.vw_fin_dly_headers_pm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "vw_fin_dly_headers_pm", "source_name": "vision", "source_description": "", "loader": "", "identifier": "vw_fin_dly_headers_pm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.vw_fin_dly_headers_pm", "created_at": 1685959753.446011}, "source.dga_data_model.vision.mgt_result_balances": {"fqn": ["dga_data_model", "base", "vision", "vision", "mgt_result_balances"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.mgt_result_balances", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "mgt_result_balances", "source_name": "vision", "source_description": "", "loader": "", "identifier": "mgt_result_balances", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.mgt_result_balances", "created_at": 1685959753.446011}, "source.dga_data_model.vision.fin_dly_audit": {"fqn": ["dga_data_model", "base", "vision", "vision", "fin_dly_audit"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.fin_dly_audit", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "fin_dly_audit", "source_name": "vision", "source_description": "", "loader": "", "identifier": "fin_dly_audit", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.fin_dly_audit", "created_at": 1685959753.446011}, "source.dga_data_model.vision.ftp_term_rates": {"fqn": ["dga_data_model", "base", "vision", "vision", "ftp_term_rates"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.ftp_term_rates", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "ftp_term_rates", "source_name": "vision", "source_description": "", "loader": "", "identifier": "ftp_term_rates", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.ftp_term_rates", "created_at": 1685959753.446011}, "source.dga_data_model.vision.build_schedules_details_audit": {"fqn": ["dga_data_model", "base", "vision", "vision", "build_schedules_details_audit"], "database": "oracle_vision", "schema": "vision", "unique_id": "source.dga_data_model.vision.build_schedules_details_audit", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "build_schedules_details_audit", "source_name": "vision", "source_description": "", "loader": "", "identifier": "build_schedules_details_audit", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.vision.build_schedules_details_audit", "created_at": 1685959753.446011}, "source.dga_data_model.eb_datasource.zlnthang_cif_ftpnew_2023": {"fqn": ["dga_data_model", "base", "vision", "eb_datasource", "zlnthang_cif_ftpnew_2023"], "database": "oracle_vision", "schema": "eb_datasource", "unique_id": "source.dga_data_model.eb_datasource.zlnthang_cif_ftpnew_2023", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "zlnthang_cif_ftpnew_2023", "source_name": "eb_datasource", "source_description": "", "loader": "", "identifier": "zlnthang_cif_ftpnew_2023", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.eb_datasource.zlnthang_cif_ftpnew_2023", "created_at": 1685959753.446011}, "source.dga_data_model.eb_datasource.tambtt3_sanpham_kh_sudung_2023": {"fqn": ["dga_data_model", "base", "vision", "eb_datasource", "tambtt3_sanpham_kh_sudung_2023"], "database": "oracle_vision", "schema": "eb_datasource", "unique_id": "source.dga_data_model.eb_datasource.tambtt3_sanpham_kh_sudung_2023", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "tambtt3_sanpham_kh_sudung_2023", "source_name": "eb_datasource", "source_description": "", "loader": "", "identifier": "tambtt3_sanpham_kh_sudung_2023", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.eb_datasource.tambtt3_sanpham_kh_sudung_2023", "created_at": 1685959753.446011}, "source.dga_data_model.eb_datasource.trang_thai_kh_2023": {"fqn": ["dga_data_model", "base", "vision", "eb_datasource", "trang_thai_kh_2023"], "database": "oracle_vision", "schema": "eb_datasource", "unique_id": "source.dga_data_model.eb_datasource.trang_thai_kh_2023", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "trang_thai_kh_2023", "source_name": "eb_datasource", "source_description": "", "loader": "", "identifier": "trang_thai_kh_2023", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.eb_datasource.trang_thai_kh_2023", "created_at": 1685959753.446011}, "source.dga_data_model.eb_datasource.zcustomersall_2023": {"fqn": ["dga_data_model", "base", "vision", "eb_datasource", "zcustomersall_2023"], "database": "oracle_vision", "schema": "eb_datasource", "unique_id": "source.dga_data_model.eb_datasource.zcustomersall_2023", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "zcustomersall_2023", "source_name": "eb_datasource", "source_description": "", "loader": "", "identifier": "zcustomersall_2023", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.eb_datasource.zcustomersall_2023", "created_at": 1685959753.44701}, "source.dga_data_model.eb_datasource.huong_atf_vision_mth_2023": {"fqn": ["dga_data_model", "base", "vision", "eb_datasource", "huong_atf_vision_mth_2023"], "database": "oracle_vision", "schema": "eb_datasource", "unique_id": "source.dga_data_model.eb_datasource.huong_atf_vision_mth_2023", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\vision\\vision.yml", "original_file_path": "models\\base\\vision\\vision.yml", "name": "huong_atf_vision_mth_2023", "source_name": "eb_datasource", "source_description": "", "loader": "", "identifier": "huong_atf_vision_mth_2023", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_vision.eb_datasource.huong_atf_vision_mth_2023", "created_at": 1685959753.44701}, "source.dga_data_model.msb.account": {"fqn": ["dga_data_model", "base", "way4", "msb", "account"], "database": "oracle_way4", "schema": "msb", "unique_id": "source.dga_data_model.msb.account", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\way4\\base_way4.yml", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "account", "source_name": "msb", "source_description": "", "loader": "", "identifier": "account", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_way4.msb.account", "created_at": 1685959753.44701}, "source.dga_data_model.msb.acnt_contract": {"fqn": ["dga_data_model", "base", "way4", "msb", "acnt_contract"], "database": "oracle_way4", "schema": "msb", "unique_id": "source.dga_data_model.msb.acnt_contract", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\way4\\base_way4.yml", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "acnt_contract", "source_name": "msb", "source_description": "", "loader": "", "identifier": "acnt_contract", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_way4.msb.acnt_contract", "created_at": 1685959753.44701}, "source.dga_data_model.msb.cs_decision": {"fqn": ["dga_data_model", "base", "way4", "msb", "cs_decision"], "database": "oracle_way4", "schema": "msb", "unique_id": "source.dga_data_model.msb.cs_decision", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\way4\\base_way4.yml", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "cs_decision", "source_name": "msb", "source_description": "", "loader": "", "identifier": "cs_decision", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_way4.msb.cs_decision", "created_at": 1685959753.44701}, "source.dga_data_model.msb.cs_status_type": {"fqn": ["dga_data_model", "base", "way4", "msb", "cs_status_type"], "database": "oracle_way4", "schema": "msb", "unique_id": "source.dga_data_model.msb.cs_status_type", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\base\\way4\\base_way4.yml", "original_file_path": "models\\base\\way4\\base_way4.yml", "name": "cs_status_type", "source_name": "msb", "source_description": "", "loader": "", "identifier": "cs_status_type", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_way4.msb.cs_status_type", "created_at": 1685959753.44701}, "source.dga_data_model.base.imp_bpm_vhkq__category": {"fqn": ["dga_data_model", "int", "bpm_vhkq", "base", "imp_bpm_vhkq__category"], "database": "oracle_dgaworkzone", "schema": "base", "unique_id": "source.dga_data_model.base.imp_bpm_vhkq__category", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "original_file_path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "name": "imp_bpm_vhkq__category", "source_name": "base", "source_description": "", "loader": "", "identifier": "imp_bpm_vhkq__category", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.base.imp_bpm_vhkq__category", "created_at": 1685959753.44701}, "source.dga_data_model.base.imp_vhkq__cust_thu_chi_ho": {"fqn": ["dga_data_model", "int", "bpm_vhkq", "base", "imp_vhkq__cust_thu_chi_ho"], "database": "oracle_dgaworkzone", "schema": "base", "unique_id": "source.dga_data_model.base.imp_vhkq__cust_thu_chi_ho", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "original_file_path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "name": "imp_vhkq__cust_thu_chi_ho", "source_name": "base", "source_description": "", "loader": "", "identifier": "imp_vhkq__cust_thu_chi_ho", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.base.imp_vhkq__cust_thu_chi_ho", "created_at": 1685959753.44701}, "source.dga_data_model.base.imp_bpm_vhkq__gl_khoquy": {"fqn": ["dga_data_model", "int", "bpm_vhkq", "base", "imp_bpm_vhkq__gl_khoquy"], "database": "oracle_dgaworkzone", "schema": "base", "unique_id": "source.dga_data_model.base.imp_bpm_vhkq__gl_khoquy", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "original_file_path": "models\\int\\bpm_vhkq\\int_bpm_vhkq.yml", "name": "imp_bpm_vhkq__gl_khoquy", "source_name": "base", "source_description": "", "loader": "", "identifier": "imp_bpm_vhkq__gl_khoquy", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.base.imp_bpm_vhkq__gl_khoquy", "created_at": 1685959753.44701}, "source.dga_data_model.int.int_tax__customer_info": {"fqn": ["dga_data_model", "int", "daily", "int", "int_tax__customer_info"], "database": "oracle_dgaworkzone", "schema": "int", "unique_id": "source.dga_data_model.int.int_tax__customer_info", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\int\\daily\\daily_int.yml", "original_file_path": "models\\int\\daily\\daily_int.yml", "name": "int_tax__customer_info", "source_name": "int", "source_description": "", "loader": "", "identifier": "int_tax__customer_info", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.int.int_tax__customer_info", "created_at": 1685959753.44701}, "source.dga_data_model.mart.dim__industry": {"fqn": ["dga_data_model", "int", "daily", "mart", "dim__industry"], "database": "oracle_dgaworkzone", "schema": "mart", "unique_id": "source.dga_data_model.mart.dim__industry", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\int\\daily\\daily_int.yml", "original_file_path": "models\\int\\daily\\daily_int.yml", "name": "dim__industry", "source_name": "mart", "source_description": "", "loader": "", "identifier": "dim__industry", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.mart.dim__industry", "created_at": 1685959753.44701}, "source.dga_data_model.mart.dim_clos_limit_tree": {"fqn": ["dga_data_model", "int", "los", "mart", "dim_clos_limit_tree"], "database": "oracle_dgaworkzone", "schema": "mart", "unique_id": "source.dga_data_model.mart.dim_clos_limit_tree", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\int\\los\\int_los.yml", "original_file_path": "models\\int\\los\\int_los.yml", "name": "dim_clos_limit_tree", "source_name": "mart", "source_description": "", "loader": "", "identifier": "dim_clos_limit_tree", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.mart.dim_clos_limit_tree", "created_at": 1685959753.44701}, "source.dga_data_model.df_2.bpm_branch_mapping": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_branch_mapping"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_branch_mapping", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_branch_mapping", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_branch_mapping", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_branch_mapping", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.bpm_opportunity": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_opportunity"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_opportunity", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_opportunity", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_opportunity", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_opportunity", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.bpm_eb_customer": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_eb_customer"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_eb_customer", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_eb_customer", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_eb_customer", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_eb_customer", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.bpm_application_data": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_application_data"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_application_data", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_application_data", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_application_data", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_application_data", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.bpm_application": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_application"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_application", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_application", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_application", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_application", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.bpm_application_history_detail": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_application_history_detail"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_application_history_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_application_history_detail", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_application_history_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_application_history_detail", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.bpm_application_history": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "bpm_application_history"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.bpm_application_history", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "bpm_application_history", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "bpm_application_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bpm_application_history", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_111": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_111"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_111", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_111", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_111", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_111", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_12": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_12"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_12", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_12", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_12", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_12", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_110": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_110"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_110", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_110", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_110", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_110", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_123": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_123"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_123", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_123", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_123", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_123", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_153": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_153"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_153", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_153", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_153", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_153", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_155": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_155"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_155", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_155", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_155", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_155", "created_at": 1685959753.4480104}, "source.dga_data_model.df_2.jstb_118": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_118"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_118", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_118", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_118", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_118", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_143": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_143"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_143", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_143", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_143", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_143", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_115": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_115"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_115", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_115", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_115", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_115", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_122": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_122"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_122", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_122", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_122", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_122", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_152": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_152"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_152", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_152", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_152", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_152", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_154": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_154"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_154", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_154", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_154", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_154", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_147": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_147"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_147", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_147", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_147", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_147", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_183": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_183"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_183", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_183", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_183", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_183", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_184": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_184"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_184", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_184", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_184", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_184", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_159": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_159"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_159", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_159", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_159", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_159", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_188": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_188"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_188", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_188", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_188", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_188", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_189": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_189"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_189", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_189", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_189", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_189", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_135": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_135"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_135", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_135", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_135", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_135", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_171": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_171"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_171", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_171", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_171", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_171", "created_at": 1685959753.4490101}, "source.dga_data_model.df_2.jstb_174": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_174"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_174", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_174", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_174", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_174", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.jstb_20363": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_20363"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_20363", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_20363", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_20363", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_20363", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.jstb_240": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_240"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_240", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_240", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_240", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_240", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.jstb_3": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_3"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_3", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_3", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_3", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_3", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.jstb_145": {"fqn": ["dga_data_model", "mart", "bpm_thamdinh", "df_2", "jstb_145"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.jstb_145", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "original_file_path": "models\\mart\\bpm_thamdinh\\bpm_thamdinh.yml", "name": "jstb_145", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "jstb_145", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jstb_145", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_history_assign_lead": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_history_assign_lead"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_history_assign_lead", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_history_assign_lead", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_history_assign_lead", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_history_assign_lead", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_history_update_loan": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_history_update_loan"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_history_update_loan", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_history_update_loan", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_history_update_loan", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_history_update_loan", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_staff": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_staff"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_staff", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_staff", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_staff", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_staff", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_file_upload_loan": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_file_upload_loan"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_file_upload_loan", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_file_upload_loan", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_file_upload_loan", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_file_upload_loan", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_loan_application": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_loan_application"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_loan_application", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_loan_application", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_loan_application", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_loan_application", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_leads_activities": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_leads_activities"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_leads_activities", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_leads_activities", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_leads_activities", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_leads_activities", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.thuvh3_tax_code_test": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "thuvh3_tax_code_test"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.thuvh3_tax_code_test", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "thuvh3_tax_code_test", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "thuvh3_tax_code_test", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.thuvh3_tax_code_test", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_loan_application_tracking": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_loan_application_tracking"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_loan_application_tracking", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_loan_application_tracking", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_loan_application_tracking", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_loan_application_tracking", "created_at": 1685959753.4500105}, "source.dga_data_model.df_2.cj3_leads_info": {"fqn": ["dga_data_model", "mart", "cms", "df_2", "cj3_leads_info"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.df_2.cj3_leads_info", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\mart\\cms\\cms.yml", "original_file_path": "models\\mart\\cms\\cms.yml", "name": "cj3_leads_info", "source_name": "df_2", "source_description": "", "loader": "", "identifier": "cj3_leads_info", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cj3_leads_info", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.atm": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "atm"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.atm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "atm", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "atm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.atm", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.atm_category_tray": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "atm_category_tray"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.atm_category_tray", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "atm_category_tray", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "atm_category_tray", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.atm_category_tray", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.atm_detail": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "atm_detail"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.atm_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "atm_detail", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "atm_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.atm_detail", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.attachment": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "attachment"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.attachment", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "attachment", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "attachment", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.attachment", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.category": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "category"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.category", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "category", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "category", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.category", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.delivery": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "delivery"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.delivery", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "delivery", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "delivery", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.delivery", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.doc_no": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "doc_no"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.doc_no", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "doc_no", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "doc_no", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.doc_no", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.mail_log": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "mail_log"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.mail_log", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "mail_log", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "mail_log", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.mail_log", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.position": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "position"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.position", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "position", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "position", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.position", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.process_definition": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "process_definition"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.process_definition", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "process_definition", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "process_definition", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.process_definition", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.process_instance": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "process_instance"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.process_instance", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "process_instance", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "process_instance", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.process_instance", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.process_instance_his": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "process_instance_his"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.process_instance_his", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "process_instance_his", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "process_instance_his", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.process_instance_his", "created_at": 1685959753.4510102}, "source.dga_data_model.ms_kho_quy.request_atm": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_atm"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_atm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_atm", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_atm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_atm", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.request_atm_card_detail": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_atm_card_detail"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_atm_card_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_atm_card_detail", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_atm_card_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_atm_card_detail", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.request_atm_detail": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_atm_detail"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_atm_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_atm_detail", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_atm_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_atm_detail", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.request_atm_tray_control": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_atm_tray_control"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_atm_tray_control", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_atm_tray_control", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_atm_tray_control", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_atm_tray_control", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.request_atm_tray_detail": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_atm_tray_detail"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_atm_tray_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_atm_tray_detail", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_atm_tray_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_atm_tray_detail", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.request_branch": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_branch"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_branch", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_branch", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_branch", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_branch", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.request_branch_detail": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "request_branch_detail"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.request_branch_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "request_branch_detail", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "request_branch_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.request_branch_detail", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.skewed_threshold": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "skewed_threshold"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.skewed_threshold", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "skewed_threshold", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "skewed_threshold", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.skewed_threshold", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.staff": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "staff"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.staff", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "staff", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "staff", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.staff", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.staff_assignment": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "staff_assignment"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.staff_assignment", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "staff_assignment", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "staff_assignment", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.staff_assignment", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.staff_request_atm": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "staff_request_atm"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.staff_request_atm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "staff_request_atm", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "staff_request_atm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.staff_request_atm", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.staff_request_branch": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "staff_request_branch"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.staff_request_branch", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "staff_request_branch", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "staff_request_branch", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.staff_request_branch", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.staff_transfer_history": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "staff_transfer_history"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.staff_transfer_history", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "staff_transfer_history", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "staff_transfer_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.staff_transfer_history", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.template": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "template"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.template", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "template", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "template", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.template", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.user_unit": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "user_unit"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.user_unit", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "user_unit", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "user_unit", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.user_unit", "created_at": 1685959753.4520102}, "source.dga_data_model.ms_kho_quy.volume": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "volume"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.volume", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "volume", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "volume", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.volume", "created_at": 1685959753.4530098}, "source.dga_data_model.ms_kho_quy.volume_detail": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "volume_detail"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.volume_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "volume_detail", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "volume_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.volume_detail", "created_at": 1685959753.4530098}, "source.dga_data_model.ms_kho_quy.warehouse": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "warehouse"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.warehouse", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "warehouse", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "warehouse", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.warehouse", "created_at": 1685959753.4530098}, "source.dga_data_model.ms_kho_quy.warehouse_organization": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "warehouse_organization"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.warehouse_organization", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "warehouse_organization", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "warehouse_organization", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.warehouse_organization", "created_at": 1685959753.4530098}, "source.dga_data_model.ms_kho_quy.warehouse_user": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "ms_kho_quy", "warehouse_user"], "database": "mysql_bpm_119", "schema": "ms_kho_quy", "unique_id": "source.dga_data_model.ms_kho_quy.warehouse_user", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "original_file_path": "models\\staging\\bpm_vhkq\\bpm_khoquy.yml", "name": "warehouse_user", "source_name": "ms_kho_quy", "source_description": "", "loader": "", "identifier": "warehouse_user", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_119.ms_kho_quy.warehouse_user", "created_at": 1685959753.4530098}, "source.dga_data_model.vhkq_atm_daily_bul.card_doc": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "vhkq_atm_daily_bul", "card_doc"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.vhkq_atm_daily_bul.card_doc", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "name": "card_doc", "source_name": "vhkq_atm_daily_bul", "source_description": "", "loader": "", "identifier": "card_doc", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "check_condition: 'date_diff( 'day', date_parse(cast(cast (max(etl_date) as int) as varchar), '%Y%j'), current_date ) = 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_doc", "created_at": 1685959753.4530098}, "source.dga_data_model.vhkq_atm_daily_az_int.int__gl_bal": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "vhkq_atm_daily_az_int", "int__gl_bal"], "database": "oracle_dgaworkzone", "schema": "int", "unique_id": "source.dga_data_model.vhkq_atm_daily_az_int.int__gl_bal", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "name": "int__gl_bal", "source_name": "vhkq_atm_daily_az_int", "source_description": "", "loader": "", "identifier": "int__gl_bal", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.int.int__gl_bal", "created_at": 1685959753.4530098}, "source.dga_data_model.vhkq_atm_daily_az_base.imp_bpm_vhkq__atm": {"fqn": ["dga_data_model", "staging", "bpm_vhkq", "van_hanh_atm", "vhkq_atm_daily_az_base", "imp_bpm_vhkq__atm"], "database": "oracle_dgaworkzone", "schema": "base", "unique_id": "source.dga_data_model.vhkq_atm_daily_az_base.imp_bpm_vhkq__atm", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "original_file_path": "models\\staging\\bpm_vhkq\\van_hanh_atm\\vhkq_van_hanh_atm.yml", "name": "imp_bpm_vhkq__atm", "source_name": "vhkq_atm_daily_az_base", "source_description": "", "loader": "", "identifier": "imp_bpm_vhkq__atm", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.base.imp_bpm_vhkq__atm", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_cicmaster @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicmaster @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicmaster @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicmaster @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicmaster @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicmaster @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_customer_info @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_customer_info @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_customer_info @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_customer_info @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_customer_info @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_customer_info @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_duno12thang @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_duno12thang @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_duno12thang @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_dunothetd @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_dunothetd @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_dunothetd @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4530098}, "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.cic_bulanding.cic_cicth_novamc @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_novamc @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_novamc @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_novamc @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_novamc @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_novamc @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.cic_bulanding.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.cic_bulanding.cic_cicth_ttduno @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "cic", "cic_bulanding", "cic_cicth_ttduno @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.cic_bulanding.cic_cicth_ttduno @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\cic\\stg_cic.yml", "original_file_path": "models\\staging\\cic\\stg_cic.yml", "name": "cic_cicth_ttduno @DGA_READ_BULANDING_DBL", "source_name": "cic_bulanding", "source_description": "", "loader": "", "identifier": "cic_cicth_ttduno @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.cic_cicth_ttduno @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_bul.si_his_glhist": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_bul", "si_his_glhist"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.gl_daily_bul.si_his_glhist", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "si_his_glhist", "source_name": "gl_daily_bul", "source_description": "", "loader": "", "identifier": "si_his_glhist", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "check_condition: 'date_diff( 'day', date_parse(cast(cast (max(etl_date) as int) as varchar), '%Y%j'), current_date ) = 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.si_his_glhist", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_bul.gl_account_master": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_bul", "gl_account_master"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.gl_daily_bul.gl_account_master", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "gl_account_master", "source_name": "gl_daily_bul", "source_description": "", "loader": "", "identifier": "gl_account_master", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "check_condition: 'date_diff( 'day', date_parse(cast(cast (max(etl_date) as int) as varchar), '%Y%j'), current_date ) = 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.gl_account_master", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_bul.fixeddeposit_transaction001": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_bul", "fixeddeposit_transaction001"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.gl_daily_bul.fixeddeposit_transaction001", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "fixeddeposit_transaction001", "source_name": "gl_daily_bul", "source_description": "", "loader": "", "identifier": "fixeddeposit_transaction001", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "check_condition: 'date_diff( 'day', date_parse(cast(cast (max(etl_date) as int) as varchar), '%Y%j'), current_date ) = 1'  \n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.fixeddeposit_transaction001", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_bul.demanddeposit_transaction001": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_bul", "demanddeposit_transaction001"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.gl_daily_bul.demanddeposit_transaction001", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "demanddeposit_transaction001", "source_name": "gl_daily_bul", "source_description": "", "loader": "", "identifier": "demanddeposit_transaction001", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "check_condition: 'date_diff( 'day', date_parse(cast(cast (max(etl_date) as int) as varchar), '%Y%j'), current_date ) = 1' \n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.demanddeposit_transaction001", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_bul.loan_transaction001": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_bul", "loan_transaction001"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.gl_daily_bul.loan_transaction001", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "loan_transaction001", "source_name": "gl_daily_bul", "source_description": "", "loader": "", "identifier": "loan_transaction001", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "check_condition: 'date_diff( 'day', date_parse(cast(cast (max(etl_date) as int) as varchar), '%Y%j'), current_date ) = 1'      \n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.loan_transaction001", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_az_stg.stg_int__gl_txn": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_az_stg", "stg_int__gl_txn"], "database": "oracle_dgaworkzone", "schema": "staging", "unique_id": "source.dga_data_model.gl_daily_az_stg.stg_int__gl_txn", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "stg_int__gl_txn", "source_name": "gl_daily_az_stg", "source_description": "", "loader": "", "identifier": "stg_int__gl_txn", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.staging.stg_int__gl_txn", "created_at": 1685959753.45401}, "source.dga_data_model.gl_daily_az_int.int__gl_txn": {"fqn": ["dga_data_model", "staging", "gl_txn", "gl_daily_az_int", "int__gl_txn"], "database": "oracle_dgaworkzone", "schema": "int", "unique_id": "source.dga_data_model.gl_daily_az_int.int__gl_txn", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "original_file_path": "models\\staging\\gl_txn\\stg_int__gl_txn.yml", "name": "int__gl_txn", "source_name": "gl_daily_az_int", "source_description": "", "loader": "", "identifier": "int__gl_txn", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "date_parse(cast(cast (etl_date as int) as varchar), '%Y%j')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date = cast(date_format(current_date - interval '1' day, '%Y%j') as int)"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.int.int__gl_txn", "created_at": 1685959753.45401}, "source.dga_data_model.daily_bulanding.bc_user_info @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "bc_user_info @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.bc_user_info @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "bc_user_info @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "bc_user_info @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bc_user_info @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.daily_bulanding.card_acnt_contract @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_acnt_contract @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_acnt_contract @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_acnt_contract @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_acnt_contract @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_acnt_contract @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.daily_bulanding.card_add_data @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_add_data @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_add_data @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_add_data @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_add_data @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_add_data @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45401}, "source.dga_data_model.daily_bulanding.card_appl_product @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_appl_product @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_appl_product @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_appl_product @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_appl_product @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_appl_product @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.card_client @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_client @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_client @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_client @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_client @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_client @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.card_contr_status @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_contr_status @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_contr_status @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_contr_status @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_contr_status @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_contr_status @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.card_currency @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_currency @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_currency @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_currency @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_currency @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_currency @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.card_doc @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_doc @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_doc @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_doc @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_doc @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_doc @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.card_f_i @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_f_i @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_f_i @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_f_i @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_f_i @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_f_i @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.card_m_transaction @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_m_transaction @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_m_transaction @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_m_transaction @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_m_transaction @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_m_transaction @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.customer_address @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "customer_address @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.customer_address @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "customer_address @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "customer_address @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.customer_address @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.customer_connection @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "customer_connection @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.customer_connection @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "customer_connection @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "customer_connection @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.customer_connection @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.customer_job_infomation @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "customer_job_infomation @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.customer_job_infomation @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "customer_job_infomation @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "customer_job_infomation @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.customer_job_infomation @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.customer_marital_status @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "customer_marital_status @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.customer_marital_status @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "customer_marital_status @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "customer_marital_status @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.customer_marital_status @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.customer_master001 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "customer_master001 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.customer_master001 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "customer_master001 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "customer_master001 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.customer_master001 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.customer_master002 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "customer_master002 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.customer_master002 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "customer_master002 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "customer_master002 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.customer_master002 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.demanddeposit_master001 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "demanddeposit_master001 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.demanddeposit_master001 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "demanddeposit_master001 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "demanddeposit_master001 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.demanddeposit_master001 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45501}, "source.dga_data_model.daily_bulanding.demanddeposit_master002 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "demanddeposit_master002 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.demanddeposit_master002 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "demanddeposit_master002 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "demanddeposit_master002 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.demanddeposit_master002 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.df_card_channel @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "df_card_channel @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.df_card_channel @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "df_card_channel @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "df_card_channel @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.df_card_channel @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.df_card_sic @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "df_card_sic @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.df_card_sic @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "df_card_sic @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "df_card_sic @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.df_card_sic @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "df_casa_channel_trn_type @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "df_casa_channel_trn_type @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "df_casa_channel_trn_type @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.df_customer_sts_type @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "df_customer_sts_type @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.df_customer_sts_type @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "df_customer_sts_type @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "df_customer_sts_type @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.df_customer_sts_type @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.fixeddeposit_master001 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "fixeddeposit_master001 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.fixeddeposit_master001 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "fixeddeposit_master001 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "fixeddeposit_master001 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.fixeddeposit_master001 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.fixeddeposit_master002 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "fixeddeposit_master002 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.fixeddeposit_master002 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "fixeddeposit_master002 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "fixeddeposit_master002 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.fixeddeposit_master002 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.fixeddeposit_master003 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "fixeddeposit_master003 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.fixeddeposit_master003 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "fixeddeposit_master003 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "fixeddeposit_master003 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.fixeddeposit_master003 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.jupiter_account_register_hist @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "jupiter_account_register_hist @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.jupiter_account_register_hist @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "jupiter_account_register_hist @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "jupiter_account_register_hist @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jupiter_account_register_hist @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.jupiter_cif_register_history @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "jupiter_cif_register_history @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.jupiter_cif_register_history @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "jupiter_cif_register_history @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "jupiter_cif_register_history @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jupiter_cif_register_history @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.jupiter_customer_temp @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "jupiter_customer_temp @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.jupiter_customer_temp @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "jupiter_customer_temp @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "jupiter_customer_temp @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.jupiter_customer_temp @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.loan_application_facility @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "loan_application_facility @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.loan_application_facility @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "loan_application_facility @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "loan_application_facility @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.loan_application_facility @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.loan_master002 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "loan_master002 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.loan_master002 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "loan_master002 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "loan_master002 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.loan_master002 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4560099}, "source.dga_data_model.daily_bulanding.overdraft_tier001 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "overdraft_tier001 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.overdraft_tier001 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "overdraft_tier001 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "overdraft_tier001 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.overdraft_tier001 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "vw_df_customer_active_latest @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "vw_df_customer_active_latest @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "vw_df_customer_active_latest @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.way4_trans_type @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "way4_trans_type @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.way4_trans_type @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "way4_trans_type @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "way4_trans_type @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.way4_trans_type @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.bb_ttr_history@dga_read_bulanding_dbl": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "bb_ttr_history@dga_read_bulanding_dbl"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.bb_ttr_history@dga_read_bulanding_dbl", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "bb_ttr_history@dga_read_bulanding_dbl", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "bb_ttr_history@dga_read_bulanding_dbl", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bb_ttr_history@dga_read_bulanding_dbl", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.bb_transfer_history@dga_read_bulanding_dbl": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "bb_transfer_history@dga_read_bulanding_dbl"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.bb_transfer_history@dga_read_bulanding_dbl", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "bb_transfer_history@dga_read_bulanding_dbl", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "bb_transfer_history@dga_read_bulanding_dbl", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.bb_transfer_history@dga_read_bulanding_dbl", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.df_date_dim @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "df_date_dim @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.df_date_dim @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "df_date_dim @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "df_date_dim @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.df_date_dim @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.demanddeposit_master003 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "demanddeposit_master003 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.demanddeposit_master003 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "demanddeposit_master003 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "demanddeposit_master003 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.demanddeposit_master003 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_bulanding.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_bulanding", "card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.daily_bulanding.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL", "source_name": "daily_bulanding", "source_description": "", "loader": "", "identifier": "card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.staging.temp_daily_transaction_remark_define_product": {"fqn": ["dga_data_model", "staging", "landing", "daily", "staging", "temp_daily_transaction_remark_define_product"], "database": "oracle_dgaworkzone", "schema": "staging", "unique_id": "source.dga_data_model.staging.temp_daily_transaction_remark_define_product", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "temp_daily_transaction_remark_define_product", "source_name": "staging", "source_description": "", "loader": "", "identifier": "temp_daily_transaction_remark_define_product", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.staging.temp_daily_transaction_remark_define_product", "created_at": 1685959753.45701}, "source.dga_data_model.daily_dwh.ddft_transaction @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "ddft_transaction @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.ddft_transaction @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "ddft_transaction @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "ddft_transaction @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(trn_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "trn_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.ddft_transaction @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.45701}, "source.dga_data_model.daily_dwh.crtb_odtier @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "crtb_odtier @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.crtb_odtier @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "crtb_odtier @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "crtb_odtier @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "etl_date > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.crtb_odtier @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.csdm_branch @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "csdm_branch @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.csdm_branch @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "csdm_branch @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "csdm_branch @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.csdm_branch @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "csdm_transaction_code @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "csdm_transaction_code @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "csdm_transaction_code @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "cydm_rate_history @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "cydm_rate_history @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "cydm_rate_history @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(datekey, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "datekey > to_number(to_char(sysdate, 'YYYYDDD')) - 2"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.dddm_product @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "dddm_product @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.dddm_product @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "dddm_product @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "dddm_product @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.dddm_product @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.ddft_master @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "ddft_master @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.ddft_master @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "ddft_master @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "ddft_master @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.ddft_master @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.fddm_product @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "fddm_product @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.fddm_product @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "fddm_product @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "fddm_product @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.fddm_product @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.lnft_master @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "lnft_master @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.lnft_master @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "lnft_master @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "lnft_master @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.lnft_master @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.lndm_account @DGA_READ_DWHPRO_DBL": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "lndm_account @DGA_READ_DWHPRO_DBL"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.lndm_account @DGA_READ_DWHPRO_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "lndm_account @DGA_READ_DWHPRO_DBL", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "lndm_account @DGA_READ_DWHPRO_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.lndm_account @DGA_READ_DWHPRO_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.daily_dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl": {"fqn": ["dga_data_model", "staging", "landing", "daily", "daily_dwh", "ebft_bc_transfer_history @dga_read_dwhpro_dbl"], "database": "oracle_dwh", "schema": "dwh", "unique_id": "source.dga_data_model.daily_dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\daily\\landing_daily.yml", "original_file_path": "models\\staging\\landing\\daily\\landing_daily.yml", "name": "ebft_bc_transfer_history @dga_read_dwhpro_dbl", "source_name": "daily_dwh", "source_description": "", "loader": "", "identifier": "ebft_bc_transfer_history @dga_read_dwhpro_dbl", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dwh.dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl", "created_at": 1685959753.4580102}, "source.dga_data_model.vision_bulanding.vision_currency_rates_daily @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "vision", "vision_bulanding", "vision_currency_rates_daily @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.vision_bulanding.vision_currency_rates_daily @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\vision\\landing_vision.yml", "original_file_path": "models\\staging\\landing\\vision\\landing_vision.yml", "name": "vision_currency_rates_daily @DGA_READ_BULANDING_DBL", "source_name": "vision_bulanding", "source_description": "", "loader": "", "identifier": "vision_currency_rates_daily @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vision_currency_rates_daily @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.vision_bulanding.vision_fin_dly_balances @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "vision", "vision_bulanding", "vision_fin_dly_balances @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.vision_bulanding.vision_fin_dly_balances @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\vision\\landing_vision.yml", "original_file_path": "models\\staging\\landing\\vision\\landing_vision.yml", "name": "vision_fin_dly_balances @DGA_READ_BULANDING_DBL", "source_name": "vision_bulanding", "source_description": "", "loader": "", "identifier": "vision_fin_dly_balances @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vision_fin_dly_balances @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.vision_bulanding.vision_fin_dly_headers @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "vision", "vision_bulanding", "vision_fin_dly_headers @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.vision_bulanding.vision_fin_dly_headers @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\vision\\landing_vision.yml", "original_file_path": "models\\staging\\landing\\vision\\landing_vision.yml", "name": "vision_fin_dly_headers @DGA_READ_BULANDING_DBL", "source_name": "vision_bulanding", "source_description": "", "loader": "", "identifier": "vision_fin_dly_headers @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vision_fin_dly_headers @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.vision_bulanding.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "vision", "vision_bulanding", "vision_fin_dly_mappings @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.vision_bulanding.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\vision\\landing_vision.yml", "original_file_path": "models\\staging\\landing\\vision\\landing_vision.yml", "name": "vision_fin_dly_mappings @DGA_READ_BULANDING_DBL", "source_name": "vision_bulanding", "source_description": "", "loader": "", "identifier": "vision_fin_dly_mappings @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4580102}, "source.dga_data_model.vision_bulanding.vision_mgt_expanded @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "landing", "vision", "vision_bulanding", "vision_mgt_expanded @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.vision_bulanding.vision_mgt_expanded @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\landing\\vision\\landing_vision.yml", "original_file_path": "models\\staging\\landing\\vision\\landing_vision.yml", "name": "vision_mgt_expanded @DGA_READ_BULANDING_DBL", "source_name": "vision_bulanding", "source_description": "", "loader": "", "identifier": "vision_mgt_expanded @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.vision_mgt_expanded @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_eb_application": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_eb_application"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_eb_application", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_eb_application", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_eb_application", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: 'date_diff( 'day', max(created_at), current_date ) <= 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_eb_application", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_eb_applicant": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_eb_applicant"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_eb_applicant", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_eb_applicant", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_eb_applicant", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: 'date_diff( 'day', max(created_at), current_date ) <= 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_eb_applicant", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_css_eb_applicant": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_css_eb_applicant"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_css_eb_applicant", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_css_eb_applicant", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_css_eb_applicant", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: 'date_diff( 'day', max(sync_date), current_date ) <= 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_css_eb_applicant", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_doc_need_list": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_doc_need_list"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_doc_need_list", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_doc_need_list", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_doc_need_list", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: 'date_diff( 'day', max(created_at), current_date ) <= 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_doc_need_list", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_doc_detail": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_doc_detail"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_doc_detail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_doc_detail", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_doc_detail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: 'date_diff( 'day', max(created_at), current_date ) <= 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_doc_detail", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_doc_no_hist": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_doc_no_hist"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_doc_no_hist", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_doc_no_hist", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_doc_no_hist", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: 'date_diff( 'day', max(created_at), current_date ) <= 1'\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_doc_no_hist", "created_at": 1685959753.4590101}, "source.dga_data_model.mercury.tbl_applicant_enterprise_income": {"fqn": ["dga_data_model", "staging", "mercury", "mercury", "tbl_applicant_enterprise_income"], "database": "mysql_bpm_117", "schema": "mercury", "unique_id": "source.dga_data_model.mercury.tbl_applicant_enterprise_income", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\mercury\\source_mercury.yml", "original_file_path": "models\\staging\\mercury\\source_mercury.yml", "name": "tbl_applicant_enterprise_income", "source_name": "mercury", "source_description": "", "loader": "", "identifier": "tbl_applicant_enterprise_income", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "mysql_bpm_117.mercury.tbl_applicant_enterprise_income", "created_at": 1685959753.4590101}, "source.dga_data_model.staging.stg_los__categories_test": {"fqn": ["dga_data_model", "staging", "test", "staging", "stg_los__categories_test"], "database": "oracle_dgaworkzone", "schema": "staging", "unique_id": "source.dga_data_model.staging.stg_los__categories_test", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\test\\test_case.yml", "original_file_path": "models\\staging\\test\\test_case.yml", "name": "stg_los__categories_test", "source_name": "staging", "source_description": "", "loader": "", "identifier": "stg_los__categories_test", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "check_condition: ' max(date(tmdate)) = current_date - interval '1' day '\n", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.staging.stg_los__categories_test", "created_at": 1685959753.4590101}, "source.dga_data_model.staging.stg_los__opportunities_test": {"fqn": ["dga_data_model", "staging", "test", "staging", "stg_los__opportunities_test"], "database": "oracle_dgaworkzone", "schema": "staging", "unique_id": "source.dga_data_model.staging.stg_los__opportunities_test", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\test\\test_case.yml", "original_file_path": "models\\staging\\test\\test_case.yml", "name": "stg_los__opportunities_test", "source_name": "staging", "source_description": "", "loader": "", "identifier": "stg_los__opportunities_test", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "tmdate", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.staging.stg_los__opportunities_test", "created_at": 1685959753.4590101}, "source.dga_data_model.staging.stg_los__corpapplimitdetails_test": {"fqn": ["dga_data_model", "staging", "test", "staging", "stg_los__corpapplimitdetails_test"], "database": "oracle_dgaworkzone", "schema": "staging", "unique_id": "source.dga_data_model.staging.stg_los__corpapplimitdetails_test", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\test\\test_case.yml", "original_file_path": "models\\staging\\test\\test_case.yml", "name": "stg_los__corpapplimitdetails_test", "source_name": "staging", "source_description": "", "loader": "", "identifier": "stg_los__corpapplimitdetails_test", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "tmdate", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": "date(tmdate) >= current_date - interval '10' day"}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.staging.stg_los__corpapplimitdetails_test", "created_at": 1685959753.4590101}, "source.dga_data_model.staging.stg_los__areas_test": {"fqn": ["dga_data_model", "staging", "test", "staging", "stg_los__areas_test"], "database": "oracle_dgaworkzone", "schema": "staging", "unique_id": "source.dga_data_model.staging.stg_los__areas_test", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\test\\test_case.yml", "original_file_path": "models\\staging\\test\\test_case.yml", "name": "stg_los__areas_test", "source_name": "staging", "source_description": "", "loader": "", "identifier": "stg_los__areas_test", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "bodatemodified", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.staging.stg_los__areas_test", "created_at": 1685959753.4590101}, "source.dga_data_model.dbo.tbldailyperformance": {"fqn": ["dga_data_model", "staging", "tms", "dbo", "tbldailyperformance"], "database": "sqlserver_tms", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.tbldailyperformance", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\tms\\tms.yml", "original_file_path": "models\\staging\\tms\\tms.yml", "name": "tbldailyperformance", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "tbldailyperformance", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sqlserver_tms.dbo.tbldailyperformance", "created_at": 1685959753.4590101}, "source.dga_data_model.dbo.tblevent": {"fqn": ["dga_data_model", "staging", "tms", "dbo", "tblevent"], "database": "sqlserver_tms", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.tblevent", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\tms\\tms.yml", "original_file_path": "models\\staging\\tms\\tms.yml", "name": "tblevent", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "tblevent", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sqlserver_tms.dbo.tblevent", "created_at": 1685959753.4590101}, "source.dga_data_model.dbo.tbleventhistory": {"fqn": ["dga_data_model", "staging", "tms", "dbo", "tbleventhistory"], "database": "sqlserver_tms", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.tbleventhistory", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\tms\\tms.yml", "original_file_path": "models\\staging\\tms\\tms.yml", "name": "tbleventhistory", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "tbleventhistory", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sqlserver_tms.dbo.tbleventhistory", "created_at": 1685959753.46001}, "source.dga_data_model.dbo.tblincident": {"fqn": ["dga_data_model", "staging", "tms", "dbo", "tblincident"], "database": "sqlserver_tms", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.tblincident", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\tms\\tms.yml", "original_file_path": "models\\staging\\tms\\tms.yml", "name": "tblincident", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "tblincident", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sqlserver_tms.dbo.tblincident", "created_at": 1685959753.46001}, "source.dga_data_model.dbo.tblincidenthistory": {"fqn": ["dga_data_model", "staging", "tms", "dbo", "tblincidenthistory"], "database": "sqlserver_tms", "schema": "dbo", "unique_id": "source.dga_data_model.dbo.tblincidenthistory", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\tms\\tms.yml", "original_file_path": "models\\staging\\tms\\tms.yml", "name": "tblincidenthistory", "source_name": "dbo", "source_description": "", "loader": "", "identifier": "tblincidenthistory", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "sqlserver_tms.dbo.tblincidenthistory", "created_at": 1685959753.46001}, "source.dga_data_model.sys.dual": {"fqn": ["dga_data_model", "staging", "tms", "sys", "dual"], "database": "oracle_dgaworkzone", "schema": "sys", "unique_id": "source.dga_data_model.sys.dual", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\tms\\tms.yml", "original_file_path": "models\\staging\\tms\\tms.yml", "name": "dual", "source_name": "sys", "source_description": "", "loader": "", "identifier": "dual", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_dgaworkzone.sys.dual", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_account_planning @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_account_planning @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_account_planning @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_account_planning @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_account_planning @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_account_planning @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_activities @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_activities @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_activities @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_activities @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_activities @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_activities @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_branch @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_branch @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_branch @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_branch @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_branch @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_branch @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_campaign @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_campaign @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_campaign @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_campaign @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_campaign @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_campaign @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_customer @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_customer @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_customer @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_customer @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_customer @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_customer @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_lead @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_lead @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_lead @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_lead @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_lead @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_lead @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_selling_status @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_selling_status @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_selling_status @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_selling_status @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_selling_status @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_selling_status @DGA_READ_BULANDING_DBL", "created_at": 1685959753.46001}, "source.dga_data_model.venus_bulanding.sppl_m_team_group @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_team_group @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_team_group @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_team_group @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_team_group @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_team_group @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4610102}, "source.dga_data_model.venus_bulanding.sppl_m_user @DGA_READ_BULANDING_DBL": {"fqn": ["dga_data_model", "staging", "venus", "source", "venus_bulanding", "sppl_m_user @DGA_READ_BULANDING_DBL"], "database": "oracle_bulanding", "schema": "df_2", "unique_id": "source.dga_data_model.venus_bulanding.sppl_m_user @DGA_READ_BULANDING_DBL", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\venus\\source\\source_venus.yml", "original_file_path": "models\\staging\\venus\\source\\source_venus.yml", "name": "sppl_m_user @DGA_READ_BULANDING_DBL", "source_name": "venus_bulanding", "source_description": "", "loader": "", "identifier": "sppl_m_user @DGA_READ_BULANDING_DBL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "to_date(etl_date, 'YYYYDDD')", "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": 2, "period": "day"}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_bulanding.df_2.sppl_m_user @DGA_READ_BULANDING_DBL", "created_at": 1685959753.4610102}, "source.dga_data_model.msb.cr_limit_log": {"fqn": ["dga_data_model", "staging", "way4", "msb", "cr_limit_log"], "database": "oracle_way4", "schema": "msb", "unique_id": "source.dga_data_model.msb.cr_limit_log", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\way4\\way4.yml", "original_file_path": "models\\staging\\way4\\way4.yml", "name": "cr_limit_log", "source_name": "msb", "source_description": "", "loader": "", "identifier": "cr_limit_log", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_way4.msb.cr_limit_log", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.collaterallinkage": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "collaterallinkage"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.collaterallinkage", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "collaterallinkage", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "collaterallinkage", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.collaterallinkage", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.customerdetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "customerdetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.customerdetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "customerdetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "customerdetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.customerdetail", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.rollback": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "rollback"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.rollback", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "rollback", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "rollback", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.rollback", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.user_groups": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "user_groups"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.user_groups", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "user_groups", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "user_groups", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.user_groups", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.applicantcontact": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicantcontact"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicantcontact", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicantcontact", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicantcontact", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicantcontact", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.oslineproductdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "oslineproductdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.oslineproductdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "oslineproductdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "oslineproductdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.oslineproductdetails", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.applicantmiscdetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicantmiscdetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicantmiscdetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicantmiscdetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicantmiscdetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicantmiscdetail", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.creditscoringdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "creditscoringdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.creditscoringdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "creditscoringdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "creditscoringdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.creditscoringdetails", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.bizcenter": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "bizcenter"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.bizcenter", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "bizcenter", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "bizcenter", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.bizcenter", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.useractiontray": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "useractiontray"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.useractiontray", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "useractiontray", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "useractiontray", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.useractiontray", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.addoncarddetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "addoncarddetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.addoncarddetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "addoncarddetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "addoncarddetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.addoncarddetails", "created_at": 1685959753.4610102}, "source.dga_data_model.crmuser.applicant": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicant"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicant", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicant", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicant", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicant", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.agents": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "agents"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.agents", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "agents", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "agents", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.agents", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.rlosworknotes": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "rlosworknotes"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.rlosworknotes", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "rlosworknotes", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "rlosworknotes", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.rlosworknotes", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.agent_entity_details": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "agent_entity_details"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.agent_entity_details", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "agent_entity_details", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "agent_entity_details", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.agent_entity_details", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.person": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "person"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.person", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "person", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "person", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.person", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.corpdecisioncode": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "corpdecisioncode"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.corpdecisioncode", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "corpdecisioncode", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "corpdecisioncode", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.corpdecisioncode", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.rlosroutingdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "rlosroutingdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.rlosroutingdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "rlosroutingdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "rlosroutingdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.rlosroutingdetails", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.transactiondepartment": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "transactiondepartment"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.transactiondepartment", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "transactiondepartment", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "transactiondepartment", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.transactiondepartment", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.parentapplication": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "parentapplication"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.parentapplication", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "parentapplication", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "parentapplication", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.parentapplication", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.applicantcontactphnemllist": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicantcontactphnemllist"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicantcontactphnemllist", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicantcontactphnemllist", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicantcontactphnemllist", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicantcontactphnemllist", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.decision": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "decision"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.decision", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "decision", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "decision", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.decision", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.appraisal_custom": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "appraisal_custom"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.appraisal_custom", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "appraisal_custom", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "appraisal_custom", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.appraisal_custom", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.category_lang": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "category_lang"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.category_lang", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "category_lang", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "category_lang", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.category_lang", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.categories": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "categories"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.categories", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "categories", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "categories", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.categories", "created_at": 1685959753.462013}, "source.dga_data_model.crmuser.opportunities": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "opportunities"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.opportunities", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "opportunities", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "opportunities", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.opportunities", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.corpapplimitdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "corpapplimitdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.corpapplimitdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "corpapplimitdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "corpapplimitdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.corpapplimitdetails", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.osproduct": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "osproduct"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.osproduct", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "osproduct", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "osproduct", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.osproduct", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.corpapplicationdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "corpapplicationdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.corpapplicationdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "corpapplicationdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "corpapplicationdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.corpapplicationdetails", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.custidentitydetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "custidentitydetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.custidentitydetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "custidentitydetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "custidentitydetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.custidentitydetail", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.losprocessentity": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "losprocessentity"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.losprocessentity", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "losprocessentity", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "losprocessentity", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.losprocessentity", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.creditcardproduct": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "creditcardproduct"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.creditcardproduct", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "creditcardproduct", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "creditcardproduct", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.creditcardproduct", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.oscorpdocumentdetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "oscorpdocumentdetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.oscorpdocumentdetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "oscorpdocumentdetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "oscorpdocumentdetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.oscorpdocumentdetail", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.oscorpcustomerdetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "oscorpcustomerdetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.oscorpcustomerdetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "oscorpcustomerdetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "oscorpcustomerdetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.oscorpcustomerdetail", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.users": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "users"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.users", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "users", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "users", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.users", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.corpappentitydetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "corpappentitydetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.corpappentitydetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "corpappentitydetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "corpappentitydetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.corpappentitydetails", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.applicantidentitydetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicantidentitydetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicantidentitydetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicantidentitydetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicantidentitydetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicantidentitydetail", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.applicationdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicationdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicationdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicationdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicationdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicationdetails", "created_at": 1685959753.46301}, "source.dga_data_model.crmuser.areas": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "areas"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.areas", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "areas", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "areas", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.areas", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.closroutingdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "closroutingdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.closroutingdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "closroutingdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "closroutingdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.closroutingdetails", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.srmgroups": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "srmgroups"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.srmgroups", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "srmgroups", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "srmgroups", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.srmgroups", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.loanproductdetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "loanproductdetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.loanproductdetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "loanproductdetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "loanproductdetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.loanproductdetails", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.address": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "address"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.address", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "address", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "address", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.address", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.slbccodemapping": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "slbccodemapping"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.slbccodemapping", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "slbccodemapping", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "slbccodemapping", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.slbccodemapping", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.collateralgeneraldetails": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "collateralgeneraldetails"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.collateralgeneraldetails", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "collateralgeneraldetails", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "collateralgeneraldetails", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.collateralgeneraldetails", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.addressdetail": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "addressdetail"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.addressdetail", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "addressdetail", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "addressdetail", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.addressdetail", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.applicantaddress": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "applicantaddress"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.applicantaddress", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "applicantaddress", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "applicantaddress", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.applicantaddress", "created_at": 1685959753.46401}, "source.dga_data_model.crmuser.syncapplicantaddressmap": {"fqn": ["dga_data_model", "staging", "los", "crmuser", "syncapplicantaddressmap"], "database": "oracle_los", "schema": "crmuser", "unique_id": "source.dga_data_model.crmuser.syncapplicantaddressmap", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "models\\staging\\los\\los.yaml", "original_file_path": "models\\staging\\los\\los.yaml", "name": "syncapplicantaddressmap", "source_name": "crmuser", "source_description": "", "loader": "", "identifier": "syncapplicantaddressmap", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "oracle_los.crmuser.syncapplicantaddressmap", "created_at": 1685959753.46401}}, "macros": {"macro.dga_data_model.cast_as_julian_date": {"unique_id": "macro.dga_data_model.cast_as_julian_date", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\cast_as_julian_date.sql", "original_file_path": "macros\\cast_as_julian_date.sql", "name": "cast_as_julian_date", "macro_sql": "{% macro cast_as_julian_date( date_id) -%} \r\n  \r\n  (to_number(to_char(to_date({{ date_id}}, 'YYYYMMDD'), 'YYYYDDD')))\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.116876, "supported_languages": null}, "macro.dga_data_model.convert_date_to_julian": {"unique_id": "macro.dga_data_model.convert_date_to_julian", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\convert_date_to_julian.sql", "original_file_path": "macros\\convert_date_to_julian.sql", "name": "convert_date_to_julian", "macro_sql": "{%- macro convert_date_to_julian(date) -%}\r\n  CAST(CAST(year({{date}}) AS varchar)|| CAST(day_of_year({{date}}) AS varchar) AS int)\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1178803, "supported_languages": null}, "macro.dga_data_model.convert_julian_to_date": {"unique_id": "macro.dga_data_model.convert_julian_to_date", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\convert_julian_to_date.sql", "original_file_path": "macros\\convert_julian_to_date.sql", "name": "convert_julian_to_date", "macro_sql": "{%- macro convert_julian_to_date(julian_date) -%}\r\n\r\n  date_add('day', CAST(substr('{{julian_date}}', 5, 3) AS int)-1, cast(substr('{{julian_date}}', 1, 4) || '-01-01' AS date) )\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1178803, "supported_languages": null}, "macro.dga_data_model.create_index": {"unique_id": "macro.dga_data_model.create_index", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\create_index.sql", "original_file_path": "macros\\create_index.sql", "name": "create_index", "macro_sql": "{% macro create_index(this, columns) -%} \r\n\r\n{% set column_names = columns | replace(', ', '__') | replace(',', '__')  %}\r\n\r\n{% set index_name = this ~ \"__index_\"  ~ \"_on__\" ~ column_names  %}\r\n\r\n{% set check_index_query %}\r\n  SELECT \r\n    count(*)   \r\n  FROM \r\n    user_indexes \r\n  WHERE index_name = '{{ index_name }}'\r\n{% endset %}\r\n\r\n{% set results_table = run_query(check_index_query) %}\r\n\r\n{% if execute %}\r\n\r\n  {% set results = results_table.columns[0].values()[0] %}\r\n\r\n{% endif %}\r\n\r\n{{ print(results) }}\r\n\r\n{% set create_index_query %}\r\n  CREATE INDEX \"{{ index_name}}\" ON {{ this }} ({{ columns}})\r\n{% endset %}\r\n\r\n{% if results == 0 -%}\r\n  {% do run_query(create_index_query) %}\r\n{% else -%}\r\n  {{ print(\"Index Name already exits\") }}\r\n{% endif %}\r\n\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1208885, "supported_languages": null}, "macro.dga_data_model.delete_tmp_table": {"unique_id": "macro.dga_data_model.delete_tmp_table", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\delete_tmp_table.sql", "original_file_path": "macros\\delete_tmp_table.sql", "name": "delete_tmp_table", "macro_sql": "{% macro delete_tmp_table() %}\r\n\r\n{%- set generate_drop_table_statement -%}\r\n    with tbl_info as\r\n    (\r\n    select * from oracle_dgaworkzone.information_schema.tables\r\n    )\r\n    select distinct concat('DROP TABLE IF EXISTS ', table_catalog,'.',table_schema, '.\"', table_name, '\";') temp_table from tbl_info\r\n    where  (table_name like 'o$pt_%' and length(regexp_extract(replace(table_name, 'o$pt_'), '\\d+')) >= 12 )\r\n           or table_name like ('%_dbt_tmp')\r\n           or table_name like ('%_dbt_backup')\r\n           or table_name like ('%tmp_trino%')\r\n{%- endset -%}\r\n\r\n{%- set get_drop_statements = run_query(generate_drop_table_statement) -%}\r\n\r\n{%- if execute -%}\r\n{%- set drop_statements = get_drop_statements.columns[0].values() -%}\r\n\r\n{%- set exec_query -%}\r\n    {{ log(drop_statements, info=True) }}\r\n\r\n    {% for drop_statement in drop_statements %}\r\n        {{ log(drop_statement, info=True) }}\r\n        {%- do run_query(drop_statement) -%}\r\n    {% endfor %}\r\n{%- endset -%}\r\n\r\n{%- else -%}\r\n{%- set drop_statements = [] -%}\r\n{%- endif -%}\r\n\r\n{{ return ('select 1 as col') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1218822, "supported_languages": null}, "macro.dga_data_model.dynamic_source": {"unique_id": "macro.dga_data_model.dynamic_source", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\dynamic_source.sql", "original_file_path": "macros\\dynamic_source.sql", "name": "dynamic_source", "macro_sql": "{%- macro dynamic_source(schema_name, table_name, month_name ) -%}\r\n\r\n  {%- set current_month -%}\r\n    select to_number(to_char(ADD_MONTHS(SYSDATE, -1), 'YYYYMM')) from dual\r\n  {%- endset -%}\r\n  {%- set month = run_query(current_month) -%}\r\n  {%- if execute -%}\r\n    {%- set results = month.columns[0].values()[0] -%}\r\n  {%- endif -%}\r\n  {%- if month_name is defined  -%}\r\n    {%- if month_name is defined  -%}\r\n      {%- set suffixes = month_name -%}\r\n    {%- endif -%}\r\n  {%- else -%}\r\n    {%- set suffixes = results -%}\r\n  {%- endif -%}\r\n\r\n  {{schema_name}}.{{table_name}}_{{suffixes}}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1238763, "supported_languages": null}, "macro.dga_data_model.generate_schema_name": {"unique_id": "macro.dga_data_model.generate_schema_name", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\generate_schema_name.sql", "original_file_path": "macros\\generate_schema_name.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\r\n\r\n{%- set default_schema = target.schema -%}\r\n{%- if custom_schema_name is none -%}\r\n\r\n{{ default_schema }}\r\n\r\n{%- else -%}\r\n\r\n{{ custom_schema_name | trim }}\r\n\r\n{%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1238763, "supported_languages": null}, "macro.dga_data_model.generate_surrogate_key": {"unique_id": "macro.dga_data_model.generate_surrogate_key", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\generate_surrogate_key.sql", "original_file_path": "macros\\generate_surrogate_key.sql", "name": "generate_surrogate_key", "macro_sql": "{%- macro generate_surrogate_key(field_list) -%}\r\n\r\n{% if var('surrogate_key_treat_nulls_as_empty_strings', False) %}\r\n    {% set default_null_value = \"\" %}\r\n{% else %}\r\n    {% set default_null_value = '_dbt_utils_surrogate_key_null_'%}\r\n{% endif %}\r\n\r\n{%- set fields = [] -%}\r\n\r\n{%- for field in field_list -%}\r\n\r\n    {%- do fields.append(\r\n        \"coalesce(cast(\" ~ field ~ \" as \" ~ dbt.type_string() ~ \"), '\" ~ default_null_value  ~\"')\"\r\n    ) -%}\r\n\r\n    {%- if not loop.last %}\r\n        {%- do fields.append(\"'-'\") -%}\r\n    {%- endif -%}\r\n\r\n{%- endfor -%}\r\n\r\n{{ dbt.hash(dbt.concat(fields)) }}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.type_string", "macro.dbt.hash", "macro.dbt.concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1258051, "supported_languages": null}, "macro.dga_data_model.get_period_boundaries_j": {"unique_id": "macro.dga_data_model.get_period_boundaries_j", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_julian_period.sql", "original_file_path": "macros\\insert_by_julian_period.sql", "name": "get_period_boundaries_j", "macro_sql": "{% macro get_period_boundaries_j(target_database, target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\r\n\r\n  {% call statement('period_boundaries', fetch_result=True) -%}\r\n    with data as (\r\n      select\r\n          coalesce(max(\"{{timestamp_field}}\"), cast('{{start_date}}' as int)) as start_timestamp,\r\n          coalesce(cast('{{ stop_date }}' as int), CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int))  as stop_timestamp\r\n      from \"{{target_database}}\".\"{{target_schema}}\".\"{{target_table}}\"\r\n    )\r\n    , ts AS (\r\n    SELECT\r\n      date_add('day', CAST(substr(CAST(start_timestamp AS VARCHAR), 5, 3) AS INT)-1,\r\n        CAST(substr(CAST(start_timestamp AS VARCHAR), 1, 4) || '-01-01' AS DATE) ) AS start_timestamp,\r\n      date_add('day', CAST(substr(CAST(stop_timestamp AS VARCHAR), 5, 3) AS INT)-1,\r\n        CAST(substr(CAST(stop_timestamp AS VARCHAR), 1, 4) || '-01-01' AS DATE) ) AS stop_timestamp\r\n    FROM DATA\r\n    )\r\n    select\r\n      start_timestamp,\r\n      stop_timestamp,\r\n      date_diff('{{period}}', start_timestamp, stop_timestamp) AS num_periods\r\n    from ts\r\n  {%- endcall %}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.132799, "supported_languages": null}, "macro.dga_data_model.get_period_sql_j": {"unique_id": "macro.dga_data_model.get_period_sql_j", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_julian_period.sql", "original_file_path": "macros\\insert_by_julian_period.sql", "name": "get_period_sql_j", "macro_sql": "{% macro get_period_sql_j(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\r\n\r\n  {%- call statement('period_filter_julian_st', fetch_result=True) -%}\r\n    select CAST(CAST(year(date_add('{{period}}', {{offset}}+1, cast('{{start_timestamp}}' AS date) )) AS varchar)\r\n                  || CAST(format('%03d',day_of_year(date_add('{{period}}', {{offset}}+1, cast('{{start_timestamp}}' AS date) ))) AS varchar) AS int)\r\n  {%- endcall -%}\r\n  {%- set period_filter_julian = load_result('period_filter_julian_st')['data'][0][0] | string -%}\r\n  {{ log( \"Current date is \" ~ period_filter_julian)}}\r\n  {%- set period_filter -%}\r\n    ({{timestamp_field}}  = {{ period_filter_julian }})\r\n  {%- endset -%}\r\n\r\n  {%- set filtered_sql = sql | replace(\"__PERIOD_FILTER__\", period_filter) -%}\r\n\r\n  select\r\n    {{target_cols_csv}}\r\n  from (\r\n    {{filtered_sql}}\r\n  )\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1338718, "supported_languages": null}, "macro.dga_data_model.materialization_insert_by_julian_period_default": {"unique_id": "macro.dga_data_model.materialization_insert_by_julian_period_default", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_julian_period.sql", "original_file_path": "macros\\insert_by_julian_period.sql", "name": "materialization_insert_by_julian_period_default", "macro_sql": "{% materialization insert_by_julian_period, default -%}\r\n  {%- set timestamp_field = config.require('timestamp_field') -%}\r\n  {%- set start_date = config.require('start_date') -%}\r\n  {%- set stop_date = config.get('stop_date') or '' -%}\r\n  {%- set period = config.get('period') or 'week' -%}\r\n\r\n  {%- if sql.find('__PERIOD_FILTER__') == -1 -%}\r\n    {%- set error_message -%}\r\n      Model '{{ model.unique_id }}' does not include the required string '__PERIOD_FILTER__' in its sql\r\n    {%- endset -%}\r\n    {{ exceptions.raise_compiler_error(error_message) }}\r\n  {%- endif -%}\r\n\r\n  {%- set identifier = model['name'] -%}\r\n\r\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\r\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, type='table') -%}\r\n\r\n  {%- set non_destructive_mode = (flags.NON_DESTRUCTIVE == True) -%}\r\n  {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\r\n\r\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\r\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\r\n\r\n  {%- set should_truncate = (non_destructive_mode and full_refresh_mode and exists_as_table) -%}\r\n  {%- set should_drop = (not should_truncate and (full_refresh_mode or exists_not_as_table)) -%}\r\n  {%- set force_create = (flags.FULL_REFRESH and not flags.NON_DESTRUCTIVE) -%}\r\n\r\n  -- setup\r\n  {% if old_relation is none -%}\r\n    -- noop\r\n  {%- elif should_truncate -%}\r\n    {{adapter.truncate_relation(old_relation)}}\r\n  {%- elif should_drop -%}\r\n    {{adapter.drop_relation(old_relation)}}\r\n    {%- set old_relation = none -%}\r\n  {%- endif %}\r\n\r\n  {{run_hooks(pre_hooks, inside_transaction=False)}}\r\n\r\n  -- `begin` happens here, so `commit` after it to finish the transaction\r\n  {{run_hooks(pre_hooks, inside_transaction=True)}}\r\n\r\n\r\n\r\n  -- build model\r\n  {% if force_create or old_relation is none -%}\r\n    {# Create an empty target table -#}\r\n    {% call statement('main') -%}\r\n      {%- set empty_sql = sql | replace(\"__PERIOD_FILTER__\", 'false') -%}\r\n      {{create_table_as(False, target_relation, empty_sql)}}\r\n    {%- endcall %}\r\n  {%- endif %}\r\n\r\n  {% set _ = get_period_boundaries_j(database, schema,\r\n                                              identifier,\r\n                                              timestamp_field,\r\n                                              start_date,\r\n                                              stop_date,\r\n                                              period) %}\r\n  {%- set start_timestamp = load_result('period_boundaries')['data'][0][0] | string -%}\r\n  {%- set stop_timestamp = load_result('period_boundaries')['data'][0][1] | string -%}\r\n  {%- set num_periods = load_result('period_boundaries')['data'][0][2] | int -%}\r\n\r\n  {% set target_columns = adapter.get_columns_in_relation(target_relation) %}\r\n  {%- set target_cols_csv = target_columns | map(attribute='quoted') | join(', ') -%}\r\n  {%- set loop_vars = {'sum_rows_inserted': 0} -%}\r\n  -- commit each period as a separate transaction\r\n  {% for i in range(num_periods) -%}\r\n    {%- set msg = \"Running for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) -%}\r\n    {{ log(msg) }}\r\n    {{ print(msg)}}\r\n\r\n    {%- set tmp_identifier = model['name'] ~ '__dbt_incremental_period' ~ i ~ '_tmp' -%}\r\n\r\n    {% set existing = adapter.get_relation(identifier=tmp_identifier,schema=\"int\",database=database) %}\r\n    {% if existing  %}\r\n      {% do adapter.drop_relation(existing) %}\r\n    {% endif %}\r\n\r\n    {%- set tmp_relation = api.Relation.create(identifier=tmp_identifier,\r\n                                               schema=\"int\",database=database, type='table') -%}\r\n    {% call statement() -%}\r\n      {% set tmp_table_sql = get_period_sql_j(target_cols_csv,\r\n                                                       sql,\r\n                                                       timestamp_field,\r\n                                                       period,\r\n                                                       start_timestamp,\r\n                                                       stop_timestamp,\r\n                                                       i) %}\r\n      {{dbt.create_table_as(True, tmp_relation, tmp_table_sql)}}\r\n    {%- endcall %}\r\n\r\n    {{adapter.expand_target_column_types(from_relation=tmp_relation,\r\n                                         to_relation=target_relation)}}\r\n    {%- set name = 'main-' ~ i -%}\r\n    {% call statement(name, fetch_result=True) -%}\r\n      insert into  {{target_relation}} ({{target_cols_csv}})\r\n      (\r\n          select\r\n              {{target_cols_csv}}\r\n          from {{tmp_relation }}\r\n      );\r\n    {%- endcall %}\r\n    {{ adapter.drop_relation(tmp_relation) }}\r\n\r\n    {% set result = load_result('main-' ~ i) %}\r\n    {{ print(result) }}\r\n    {% if 'response' in result.keys() %} {# added in v0.19.0 #}\r\n        {% set rows_inserted = result['data'] %}\r\n    {% else %} {# older versions #}\r\n        {% set rows_inserted = result['status'].split(\" \")[2] | int %}\r\n    {% endif %}\r\n    {{ print(\"debug\" ~ rows_inserted)}}\r\n    {%- set msg = \"Ran success for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) ~ \"; \" -%}\r\n    {{ log(msg) }}\r\n    {{ print(msg)}}\r\n    {{ adapter.commit() }}\r\n\r\n  {%- endfor %}\r\n\r\n\r\n  -- Return the relations created in this materialization\r\n  {{ return({'relations': [target_relation]}) }}\r\n\r\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dga_data_model.get_period_boundaries_j", "macro.dga_data_model.get_period_sql_j"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1418722, "supported_languages": ["sql"]}, "macro.dga_data_model.get_period_boundaries": {"unique_id": "macro.dga_data_model.get_period_boundaries", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_period.sql", "original_file_path": "macros\\insert_by_period.sql", "name": "get_period_boundaries", "macro_sql": "{% macro get_period_boundaries(target_database, target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\r\n\r\n{% call statement('period_boundaries', fetch_result=True) -%}\r\n    with data as (\r\n      select\r\n          coalesce(max(cast({{timestamp_field}} as date)), cast('{{start_date}}' as date)) as start_timestamp,\r\n          coalesce(cast('{{ stop_date }}' as date), cast(current_date AS date))  as stop_timestamp\r\n      from \"{{target_database}}\".\"{{target_schema}}\".\"{{target_table}}\"\r\n    )\r\n    select\r\n      start_timestamp,\r\n      stop_timestamp,\r\n      date_diff('{{period}}', start_timestamp, stop_timestamp) as num_periods\r\n    from data\r\n  {%- endcall %}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1487978, "supported_languages": null}, "macro.dga_data_model.get_period_sql": {"unique_id": "macro.dga_data_model.get_period_sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_period.sql", "original_file_path": "macros\\insert_by_period.sql", "name": "get_period_sql", "macro_sql": "{% macro get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\r\n\r\n\r\n  {%- call statement('period_filter_julian_st', fetch_result=True) -%}\r\n    select date_trunc('{{period}}', date_add('{{period}}', {{offset}}+1, cast('{{start_timestamp}}' AS date) ))\r\n  {%- endcall -%}\r\n  {%- set period_filter_julian = load_result('period_filter_julian_st')['data'][0][0] | string -%}\r\n  {{ log( \"Current date is \" ~ period_filter_julian)}}\r\n  {%- set period_filter -%}\r\n    (date_trunc('{{period}}', {{timestamp_field}} )  = cast('{{ period_filter_julian }}' as date))\r\n  {%- endset -%}\r\n\r\n  {%- set filtered_sql = sql | replace(\"__PERIOD_FILTER__\", period_filter) -%}\r\n\r\n  select\r\n    {{target_cols_csv}}\r\n  from (\r\n    {{filtered_sql}}\r\n  )\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1508696, "supported_languages": null}, "macro.dga_data_model.materialization_insert_by_period_default": {"unique_id": "macro.dga_data_model.materialization_insert_by_period_default", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_period.sql", "original_file_path": "macros\\insert_by_period.sql", "name": "materialization_insert_by_period_default", "macro_sql": "{% materialization insert_by_period, default -%}\r\n  {%- set timestamp_field = config.require('timestamp_field') -%}\r\n  {%- set start_date = config.require('start_date') -%}\r\n  {%- set stop_date = config.get('stop_date') or '' -%}\r\n  {%- set period = config.get('period') or 'week' -%}\r\n\r\n  {%- if sql.find('__PERIOD_FILTER__') == -1 -%}\r\n    {%- set error_message -%}\r\n      Model '{{ model.unique_id }}' does not include the required string '__PERIOD_FILTER__' in its sql\r\n    {%- endset -%}\r\n    {{ exceptions.raise_compiler_error(error_message) }}\r\n  {%- endif -%}\r\n\r\n  {%- set identifier = model['name'] -%}\r\n\r\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\r\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, type='table') -%}\r\n\r\n  {%- set non_destructive_mode = (flags.NON_DESTRUCTIVE == True) -%}\r\n  {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\r\n\r\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\r\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\r\n\r\n  {%- set should_truncate = (non_destructive_mode and full_refresh_mode and exists_as_table) -%}\r\n  {%- set should_drop = (not should_truncate and (full_refresh_mode or exists_not_as_table)) -%}\r\n  {%- set force_create = (flags.FULL_REFRESH and not flags.NON_DESTRUCTIVE) -%}\r\n\r\n  -- setup\r\n  {% if old_relation is none -%}\r\n    -- noop\r\n  {%- elif should_truncate -%}\r\n    {{adapter.truncate_relation(old_relation)}}\r\n  {%- elif should_drop -%}\r\n    {{adapter.drop_relation(old_relation)}}\r\n    {%- set old_relation = none -%}\r\n  {%- endif %}\r\n\r\n  {{run_hooks(pre_hooks, inside_transaction=False)}}\r\n\r\n  -- `begin` happens here, so `commit` after it to finish the transaction\r\n  {{run_hooks(pre_hooks, inside_transaction=True)}}\r\n\r\n\r\n\r\n  -- build model\r\n  {% if force_create or old_relation is none -%}\r\n    {# Create an empty target table -#}\r\n    {% call statement('main') -%}\r\n      {%- set empty_sql = sql | replace(\"__PERIOD_FILTER__\", 'false') -%}\r\n      {{create_table_as(False, target_relation, empty_sql)}}\r\n    {%- endcall %}\r\n  {%- endif %}\r\n\r\n  {% set _ = get_period_boundaries(database, schema,\r\n                                              identifier,\r\n                                              timestamp_field,\r\n                                              start_date,\r\n                                              stop_date,\r\n                                              period) %}\r\n  {%- set start_timestamp = load_result('period_boundaries')['data'][0][0] | string -%}\r\n  {%- set stop_timestamp = load_result('period_boundaries')['data'][0][1] | string -%}\r\n  {%- set num_periods = load_result('period_boundaries')['data'][0][2] | int -%}\r\n\r\n  {% set target_columns = adapter.get_columns_in_relation(target_relation) %}\r\n  {%- set target_cols_csv = target_columns | map(attribute='quoted') | join(', ') -%}\r\n  {%- set loop_vars = {'sum_rows_inserted': 0} -%}\r\n  -- commit each period as a separate transaction\r\n  {% for i in range(num_periods) -%}\r\n    {%- set msg = \"Running for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) -%}\r\n    {{ log(msg) }}\r\n    {{ print(msg)}}\r\n\r\n    {%- set tmp_identifier = model['name'] ~ '__dbt_incremental_period' ~ i ~ '_tmp' -%}\r\n\r\n    {% set existing = adapter.get_relation(identifier=tmp_identifier,schema=schema,database=database) %}\r\n    {% if existing  %}\r\n      {% do adapter.drop_relation(existing) %}\r\n    {% endif %}\r\n\r\n    {%- set tmp_relation = api.Relation.create(identifier=tmp_identifier,\r\n                                               schema=schema,database=database, type='table') -%}\r\n    {% call statement() -%}\r\n      {% set tmp_table_sql = get_period_sql(target_cols_csv,\r\n                                                       sql,                                                       timestamp_field,\r\n                                                       period,                                                       start_timestamp,\r\n                                                       stop_timestamp,\r\n                                                       i) %}\r\n      {{dbt.create_table_as(True, tmp_relation, tmp_table_sql)}}\r\n    {%- endcall %}\r\n\r\n    {{adapter.expand_target_column_types(from_relation=tmp_relation,\r\n                                         to_relation=target_relation)}}\r\n    {%- set name = 'main-' ~ i -%}\r\n    {% call statement(name, fetch_result=True) -%}\r\n      insert into  {{target_relation}} ({{target_cols_csv}})\r\n      (\r\n          select\r\n              {{target_cols_csv}}\r\n          from {{tmp_relation }}\r\n      );\r\n    {%- endcall %}\r\n    {{ adapter.drop_relation(tmp_relation) }}\r\n\r\n    {% set result = load_result('main-' ~ i) %}\r\n    {{ print(result) }}\r\n    {% if 'response' in result.keys() %} {# added in v0.19.0 #}\r\n        {% set rows_inserted = result['data'] %}\r\n    {% else %} {# older versions #}\r\n        {% set rows_inserted = result['status'].split(\" \")[2] | int %}\r\n    {% endif %}\r\n    {{ print(\"debug\" ~ rows_inserted)}}\r\n    {%- set msg = \"Ran success for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) ~ \"; \" -%}\r\n    {{ log(msg) }}\r\n    {{ print(msg)}}\r\n    {{ adapter.commit() }}\r\n\r\n  {%- endfor %}\r\n\r\n\r\n  -- Return the relations created in this materialization\r\n  {{ return({'relations': [target_relation]}) }}\r\n\r\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dga_data_model.get_period_boundaries", "macro.dga_data_model.get_period_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1587965, "supported_languages": ["sql"]}, "macro.dga_data_model.get_year_range_boundaries": {"unique_id": "macro.dga_data_model.get_year_range_boundaries", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_range_period.sql", "original_file_path": "macros\\insert_by_range_period.sql", "name": "get_year_range_boundaries", "macro_sql": "{% macro get_year_range_boundaries(year_column, source_table, target_database, target_schema, target_table, start_year) -%}\r\n\r\n  {%- call statement('list_value_by_columns_source', fetch_result=True) -%}\r\n    with t as (\r\n    SELECT {{ year_column }}\r\n    FROM {{ source_table }}\r\n    WHERE {{ year_column }} >=  {{ start_year }}\r\n    GROUP BY 1\r\n    )\r\n    select * from t\r\n    order by 1 asc\r\n  {%- endcall -%}\r\n  {%- set list_year = load_result('list_value_by_columns_source')['data']| list -%}\r\n  {{ return(list_year) }}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1687963, "supported_languages": null}, "macro.dga_data_model.get_ts_period_boundaries": {"unique_id": "macro.dga_data_model.get_ts_period_boundaries", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_range_period.sql", "original_file_path": "macros\\insert_by_range_period.sql", "name": "get_ts_period_boundaries", "macro_sql": "{% macro get_ts_period_boundaries(source_table, target_database, target_schema, target_table, timestamp_field, start_date, stop_date, period, year_column, year_value) -%}\r\n\r\n  {% call statement('period_boundaries', fetch_result=True) -%}\r\n    with d as (\r\n      select\r\n          max(cast({{timestamp_field}} as date)) as start_timestamp\r\n      from \"{{target_database}}\".\"{{target_schema}}\".\"{{target_table}}\"\r\n      where {{ year_column }} = {{ year_value }}\r\n    )\r\n    , s as (\r\n      select\r\n          date_add('day', -1, min(cast({{timestamp_field}} as date))) as start_timestamp,\r\n          max(cast({{timestamp_field}} as date)) as stop_timestamp\r\n      from {{ source_table }}\r\n      where {{ year_column }} = {{ year_value }}\r\n      )\r\n    select\r\n      coalesce(d.start_timestamp, s.start_timestamp) as start_timestamp,\r\n      stop_timestamp,\r\n      date_diff('{{period}}', coalesce(d.start_timestamp, s.start_timestamp), stop_timestamp) as num_periods\r\n    from d, s\r\n  {%- endcall %}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.169796, "supported_languages": null}, "macro.dga_data_model.get_sql": {"unique_id": "macro.dga_data_model.get_sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_range_period.sql", "original_file_path": "macros\\insert_by_range_period.sql", "name": "get_sql", "macro_sql": "{% macro get_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset, year_column, year_value) -%}\r\n\r\n  {%- call statement('period_filter_julian_st', fetch_result=True) -%}\r\n    select date_trunc('{{period}}', date_add('{{period}}', {{offset}}+1, cast('{{start_timestamp}}' AS date) ))\r\n  {%- endcall -%}\r\n  {%- set period_filter_julian = load_result('period_filter_julian_st')['data'][0][0] | string -%}\r\n  {{ log( \"Current date is \" ~ period_filter_julian)}}\r\n  {%- set period_filter -%}\r\n    (date_trunc('{{period}}', {{timestamp_field}})  = cast('{{ period_filter_julian }}' as date) and {{ year_column }} = {{ year_value }} )\r\n  {%- endset -%}\r\n\r\n  {%- set filtered_sql = sql | replace(\"__PERIOD_FILTER__\", period_filter) -%}\r\n\r\n  select\r\n    {{target_cols_csv}}\r\n  from (\r\n    {{filtered_sql}}\r\n  )\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1707964, "supported_languages": null}, "macro.dga_data_model.materialization_insert_by_range_period_default": {"unique_id": "macro.dga_data_model.materialization_insert_by_range_period_default", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\insert_by_range_period.sql", "original_file_path": "macros\\insert_by_range_period.sql", "name": "materialization_insert_by_range_period_default", "macro_sql": "{% materialization insert_by_range_period, default -%}\r\n  {%- set timestamp_field = config.require('timestamp_field') -%}\r\n  {%- set start_date = config.get('start_date') or NULL -%}\r\n  {%- set stop_date = config.get('stop_date') or NULL -%}\r\n  {%- set period = config.get('period') or 'week' -%}\r\n  {%- set year_column = config.require('year_column')  -%}\r\n  {%- set start_year = config.require('start_year')  -%}\r\n  {%- set source_table = config.require('source_table') -%}\r\n\r\n  {%- if sql.find('__PERIOD_FILTER__') == -1 -%}\r\n    {%- set error_message -%}\r\n      Model '{{ model.unique_id }}' does not include the required string '__PERIOD_FILTER__' in its sql\r\n    {%- endset -%}\r\n    {{ exceptions.raise_compiler_error(error_message) }}\r\n  {%- endif -%}\r\n\r\n  {%- set identifier = model['name'] -%}\r\n\r\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\r\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, type='table') -%}\r\n\r\n  {%- set non_destructive_mode = (flags.NON_DESTRUCTIVE == True) -%}\r\n  {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\r\n\r\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\r\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\r\n\r\n  {%- set should_truncate = (non_destructive_mode and full_refresh_mode and exists_as_table) -%}\r\n  {%- set should_drop = (not should_truncate and (full_refresh_mode or exists_not_as_table)) -%}\r\n  {%- set force_create = (flags.FULL_REFRESH and not flags.NON_DESTRUCTIVE) -%}\r\n\r\n  -- setup\r\n  {% if old_relation is none -%}\r\n    -- noop\r\n  {%- elif should_truncate -%}\r\n    {{adapter.truncate_relation(old_relation)}}\r\n  {%- elif should_drop -%}\r\n    {{adapter.drop_relation(old_relation)}}\r\n    {%- set old_relation = none -%}\r\n  {%- endif %}\r\n\r\n  {{run_hooks(pre_hooks, inside_transaction=False)}}\r\n\r\n  -- `begin` happens here, so `commit` after it to finish the transaction\r\n  {{run_hooks(pre_hooks, inside_transaction=True)}}\r\n\r\n\r\n  -- build model\r\n  {% if force_create or old_relation is none -%}\r\n    {# Create an empty target table -#}\r\n    {% call statement('main') -%}\r\n      {%- set empty_sql = sql | replace(\"__PERIOD_FILTER__\", 'false') -%}\r\n      {{create_table_as(False, target_relation, empty_sql)}}\r\n    {%- endcall %}\r\n  {%- endif %}\r\n\r\n  {% set loop = get_year_range_boundaries(year_column, source_table, database, schema, identifier, start_year) %}\r\n\r\n  -- commit each period as a separate transaction\r\n  {% for loop_value in loop -%}\r\n    {{ print(loop_value[0] ~ 'delelta ')}}\r\n    {% set _ = get_ts_period_boundaries(source_table, database, schema,\r\n                                              identifier,\r\n                                              timestamp_field,\r\n                                              start_date,\r\n                                              stop_date,\r\n                                              period,\r\n                                              year_column,\r\n                                              loop_value[0]) %}\r\n    {%- set start_timestamp = load_result('period_boundaries')['data'][0][0] | string -%}\r\n    {%- set stop_timestamp = load_result('period_boundaries')['data'][0][1] | string -%}\r\n    {%- set num_periods = load_result('period_boundaries')['data'][0][2] | int -%}\r\n    {% set target_columns = adapter.get_columns_in_relation(target_relation) %}\r\n    {%- set target_cols_csv = target_columns | map(attribute='quoted') | join(', ') -%}\r\n    {%- set loop_vars = {'sum_rows_inserted': 0} -%}\r\n\r\n    {% for i in range(num_periods) -%}\r\n\r\n      {%- set msg = \"Running for \" ~ year_column ~ \": \" ~ loop_value ~ \"period \"~ i ~ \"over \" ~ num_periods -%}\r\n      {{ print(msg) }}\r\n\r\n      {%- set tmp_identifier = model['name'] ~ '__dbt_incremental_period_'~ year_value ~ i ~ '_tmp' -%}\r\n\r\n      {% set existing = adapter.get_relation(identifier=tmp_identifier,schema=schema,database=database) %}\r\n      {% if existing  %}\r\n        {% do adapter.drop_relation(existing) %}\r\n      {% endif %}\r\n\r\n      {%- set tmp_relation = api.Relation.create(identifier=tmp_identifier,\r\n                                                 schema=schema,database=database, type='table') -%}\r\n      {% call statement() -%}\r\n        {% set tmp_table_sql = get_sql(target_cols_csv,\r\n                                                         sql,\r\n                                                         timestamp_field,\r\n                                                         period,\r\n                                                         start_timestamp,\r\n                                                         stop_timestamp,\r\n                                                         i,\r\n                                                        year_column,\r\n                                                        loop_value[0]\r\n      ) %}\r\n        {{dbt.create_table_as(True, tmp_relation, tmp_table_sql)}}\r\n      {%- endcall %}\r\n\r\n      {{adapter.expand_target_column_types(from_relation=tmp_relation,\r\n                                           to_relation=target_relation)}}\r\n      {%- set name = 'main-' ~ i -%}\r\n      {% call statement(name, fetch_result=True) -%}\r\n        insert into  {{target_relation}} ({{target_cols_csv}})\r\n        (\r\n            select\r\n                {{target_cols_csv}}\r\n            from {{tmp_relation }}\r\n        );\r\n      {%- endcall %}\r\n      {{ adapter.drop_relation(tmp_relation) }}\r\n\r\n      {% set result = load_result('main-' ~ i) %}\r\n      {{ print(result) }}\r\n      {% if 'response' in result.keys() %} {# added in v0.19.0 #}\r\n          {% set rows_inserted = result['data'] %}\r\n      {% else %} {# older versions #}\r\n          {% set rows_inserted = result['status'].split(\" \")[2] | int %}\r\n      {% endif %}\r\n      {{ print(\"debug\" ~ rows_inserted)}}\r\n      {%- set msg = \"Ran success for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) ~ \"; \" -%}\r\n      {{ log(msg) }}\r\n      {{ print(msg)}}\r\n      {{ adapter.commit() }}\r\n    {%- endfor %}\r\n\r\n  {%- endfor %}\r\n\r\n\r\n  -- Return the relations created in this materialization\r\n  {{ return({'relations': [target_relation]}) }}\r\n\r\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dga_data_model.get_year_range_boundaries", "macro.dga_data_model.get_ts_period_boundaries", "macro.dga_data_model.get_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.1807964, "supported_languages": ["sql"]}, "macro.dga_data_model.parse_dbt_results": {"unique_id": "macro.dga_data_model.parse_dbt_results", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "parse_dbt_results", "macro_sql": "{% macro parse_dbt_results(results) %}\r\n    -- Create a list of parsed results\r\n    {%- set parsed_results = [] %}\r\n    -- Flatten results and add to list\r\n    {% for run_result in results %}\r\n        -- Convert the run result object to a simple dictionary\r\n        {% set run_result_dict = run_result.to_dict() %}\r\n        -- Get the underlying dbt graph node that was executed\r\n        {% set node = run_result_dict.get('node') %}\r\n        {% set rows_affected = run_result_dict.get('adapter_response', {}).get('rows_affected', 0) %}\r\n        {% set start_at = run_result_dict.get('timing', {})[0].get('started_at') %}\r\n        {% set completed_at = run_result_dict.get('timing', {})[0].get('completed_at') %}\r\n        {% set materialized = node.get('config', {}).get('materialized') %}\r\n        {% set incremental_strategy = node.get('config', {}).get('incremental_strategy') %}\r\n        {% set target = flags.target %}\r\n        {% set owner = node.get('config', {}).get('meta').get('owner') %}\r\n        {% set date_column = node.get('config', {}).get('meta').get('date_column') %}\r\n        {% set full_refresh = flags.FULL_REFRESH  %}\r\n        {% set which = flags.WHICH %}\r\n\r\n        {%- if not rows_affected -%}\r\n            {% set rows_affected = 0 %}\r\n        {%- endif -%}\r\n        {% set parsed_result_dict = {\r\n                'result_id': invocation_id ~ '.' ~ node.get('unique_id'),\r\n                'invocation_id': invocation_id,\r\n                'unique_id': node.get('unique_id'),\r\n                'database_name': node.get('database'),\r\n                'schema_name': node.get('schema'),\r\n                'name': node.get('name'),\r\n                'resource_type': node.get('resource_type'),\r\n                'status': run_result_dict.get('status'),\r\n                'execution_time': run_result_dict.get('execution_time'),\r\n                'rows_affected': rows_affected,\r\n                'start_at': start_at,\r\n                'completed_at': completed_at,\r\n                'materialized': materialized ,\r\n                'incremental_strategy' : incremental_strategy,\r\n                'target': target,\r\n                'owner': owner,\r\n                'full_refresh': full_refresh,\r\n                'date_column': date_column,\r\n                'which': which\r\n                }%}\r\n        {% do parsed_results.append(parsed_result_dict) %}\r\n    {% endfor %}\r\n    {{ return(parsed_results) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2517965, "supported_languages": null}, "macro.dga_data_model.cast_to_date": {"unique_id": "macro.dga_data_model.cast_to_date", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "cast_to_date", "macro_sql": "{% macro cast_to_date(date_column, schemaname, tablename) %}\r\n    -- each table has difference column with difference data type that use to check latest record.\r\n    {{ return(adapter.dispatch('cast_to_date')(date_column, schemaname, tablename)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dga_data_model.trino__cast_to_date"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2517965, "supported_languages": null}, "macro.dga_data_model.default__cast_to_date": {"unique_id": "macro.dga_data_model.default__cast_to_date", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "default__cast_to_date", "macro_sql": "{% macro default__cast_to_date(date_column,  schemaname, tablename) %}\r\n  -- get column_type\r\n  {% set get_column_type -%}\r\n      select DATA_TYPE from all_tab_columns\r\n      where lower(table_name) = lower('{{ tablename}}')\r\n      and lower(owner) = lower('{{ schemaname }}')\r\n      and lower(column_name) = lower('{{ date_column }}')\r\n  {%- endset -%}\r\n  {%- set get_column_type_result = run_query(get_column_type) -%}\r\n  {% if execute %}\r\n      {%- set column_type = get_column_type_result.columns[0].values()[0] -%}\r\n  {% else %}\r\n      {% set column_type = null %}\r\n  {% endif %}\r\n    {% if column_type == 'NUMBER'  %}\r\n    -- get column len to distinguish between julian date and 'YYYYMMDD' format date\r\n      {% set get_column_len %}\r\n      select length({{date_column}}) from {{ schemaname}}.{{tablename}}\r\n      FETCH FIRST 1 ROWS ONLY\r\n      {% endset %}\r\n      {%- set get_column_len_result = run_query(get_column_len) -%}\r\n      {%- set column_len = get_column_len_result.columns[0].values()[0] -%}\r\n      {% if column_len == 7 %}\r\n        {% set cast_statement %}\r\n          to_date( {{ date_column }} , 'YYYYDDD')\r\n        {% endset%}\r\n      {% else %}\r\n        {% set cast_statement %}\r\n          to_date( {{ date_column }} , 'YYYYMMDD')\r\n        {% endset%}\r\n      {% endif %}\r\n\r\n    {% else %}\r\n      {% set cast_statement %}\r\n        trunc( {{ date_column }} )\r\n      {% endset%}\r\n    {% endif %}\r\n\r\n    {{ return(cast_statement) }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2537966, "supported_languages": null}, "macro.dga_data_model.trino__cast_to_date": {"unique_id": "macro.dga_data_model.trino__cast_to_date", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "trino__cast_to_date", "macro_sql": "{% macro trino__cast_to_date(date_column,  schemaname, tablename) %}\r\n  -- get column_type\r\n  {% set get_column_type -%}\r\n      show columns FROM oracle_dgaworkzone.{{ schemaname }}.{{ tablename}} LIKE '%{{ date_column }}%'\r\n  {%- endset -%}\r\n  {%- set get_column_type_result = run_query(get_column_type) -%}\r\n  {% if execute %}\r\n      {%- set column_type = get_column_type_result.columns[1].values()[0] -%}\r\n  {% else %}\r\n      {% set column_type = null %}\r\n  {% endif %}\r\n\r\n\r\n    {% if 'decimal' in column_type  %}\r\n      -- get column len to distinguish between julian date and 'YYYYMMDD' format date\r\n      {% set get_column_len %}\r\n        select length(CAST(CAST( {{ date_column }} AS int) AS varchar)) from {{ schemaname}}.{{tablename}}\r\n        limit 1\r\n      {% endset %}\r\n      {%- set get_column_len_result = run_query(get_column_len) -%}\r\n      {%- set column_len = get_column_len_result.columns[0].values()[0] -%}\r\n\r\n      {% if column_len == 7 %} -- julian format\r\n        {% set cast_statement %}\r\n          date_add('day',\r\n            CAST(substr(CAST( {{ date_column }} AS varchar), 5, 3) AS int)-1,\r\n            cast(substr(CAST( {{ date_column }} AS varchar), 1, 4) || '-01-01' AS date))\r\n        {% endset%}\r\n      {% else %} -- YYYYMMDD format\r\n        {% set cast_statement %}\r\n          date_parse(CAST (CAST (created_at AS INT) AS VARCHAR), '%Y%m%d')\r\n        {% endset%}\r\n      {% endif %}\r\n    {% else %}\r\n      {% set cast_statement %}\r\n          date_trunc('day', {{ date_column }} )\r\n      {% endset%}\r\n    {% endif %}\r\n\r\n    {{ return(cast_statement) }}\r\n\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2557964, "supported_languages": null}, "macro.dga_data_model.log_dbt_results": {"unique_id": "macro.dga_data_model.log_dbt_results", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "log_dbt_results", "macro_sql": "{% macro log_dbt_results(results) %}\r\n    {{ return(adapter.dispatch('log_dbt_results')(results)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dga_data_model.trino__log_dbt_results"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2557964, "supported_languages": null}, "macro.dga_data_model.default__log_dbt_results": {"unique_id": "macro.dga_data_model.default__log_dbt_results", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "default__log_dbt_results", "macro_sql": "{% macro default__log_dbt_results(results) %}\r\n    {%- if execute -%}\r\n        {% if flags.WHICH == 'run' %}\r\n        {%- set parsed_results = parse_dbt_results(results) -%}\r\n        {%- if parsed_results | length  > 0 -%}\r\n            {%- for parsed_result_dict in parsed_results -%}\r\n\r\n                {%- set date_column =  parsed_result_dict.get('date_column')  -%}\r\n                {% if date_column is not none %}\r\n                {%- set date_column_format = cast_to_date(date_column, parsed_result_dict.get('schema_name'), parsed_result_dict.get('name') )  -%}\r\n                {% set last_record_query -%}\r\n                    select  to_char(max( {{ date_column_format }}), 'YYYY-MM-DD')\r\n                    from {{ parsed_result_dict.get('schema_name') }}.{{ parsed_result_dict.get('name') }}\r\n                {%- endset -%}\r\n                {%- set last_record_result = run_query(last_record_query) -%}\r\n                {% if execute %}\r\n                    {%- set last_record = last_record_result.columns[0].values()[0] -%}\r\n                    {% if last_record is none %}\r\n                      {% set last_record = null %}\r\n                    {% endif %}\r\n                {% else %}\r\n                    {% set last_record = null %}\r\n                {% endif %}\r\n                {% else %}\r\n                    {% set last_record = null %}\r\n                {% endif %}\r\n                {% set insert_dbt_results_query -%}\r\n                    insert into staging.log_results\r\n                        (\r\n                            result_id,\r\n                            invocation_id,\r\n                            unique_id,\r\n                            database_name,\r\n                            schema_name,\r\n                            name,\r\n                            MATERIALIZED,\r\n                            INCREMENTAL_STRATEGY,\r\n                            resource_type,\r\n                            status,\r\n                            start_at,\r\n                            completed_at,\r\n                            execution_time,\r\n                            rows_affected,\r\n                            last_record_at,\r\n                            date_column,\r\n                            owner,\r\n                            full_refresh\r\n                    ) values\r\n                        (\r\n                            '{{ parsed_result_dict.get('result_id') }}',\r\n                            '{{ parsed_result_dict.get('invocation_id') }}',\r\n                            '{{ parsed_result_dict.get('unique_id') }}',\r\n                            '{{ parsed_result_dict.get('database_name') }}',\r\n                            '{{ parsed_result_dict.get('schema_name') }}',\r\n                            '{{ parsed_result_dict.get('name') }}',\r\n                            '{{ parsed_result_dict.get('materialized') }}',\r\n                            '{{ parsed_result_dict.get('incremental_strategy') }}',\r\n                            '{{ parsed_result_dict.get('resource_type') }}',\r\n                            '{{ parsed_result_dict.get('status') }}',\r\n                            TO_UTC_TIMESTAMP_TZ('{{ parsed_result_dict.get('start_at') }}'),\r\n                            TO_UTC_TIMESTAMP_TZ('{{ parsed_result_dict.get('completed_at') }}'),\r\n                            '{{ parsed_result_dict.get('execution_time') }}',\r\n                            '{{ parsed_result_dict.get('rows_affected') }}',\r\n                            TO_DATE('{{ last_record }}', 'YYYY-MM-DD'),\r\n                            '{{ date_column }}',\r\n                            '{{ parsed_result_dict.get('owner') }}',\r\n                            '{{ parsed_result_dict.get('full_refresh') }}'\r\n                        )\r\n                {%- endset -%}\r\n                {%- do run_query(insert_dbt_results_query) -%}\r\n                {%- do run_query('commit') -%}\r\n            {%- endfor -%}\r\n\r\n\r\n      {%- endif -%}\r\n    {%- endif -%}\r\n    {%- endif -%}\r\n    {{ return ('') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dga_data_model.parse_dbt_results", "macro.dga_data_model.cast_to_date", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2597964, "supported_languages": null}, "macro.dga_data_model.trino__log_dbt_results": {"unique_id": "macro.dga_data_model.trino__log_dbt_results", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\log_results.sql", "original_file_path": "macros\\log_results.sql", "name": "trino__log_dbt_results", "macro_sql": "{% macro trino__log_dbt_results(results) %}\r\n    {%- if execute -%}\r\n        {% if flags.WHICH == 'run' %}\r\n        {%- set parsed_results = parse_dbt_results(results) -%}\r\n        {%- if parsed_results | length  > 0 -%}\r\n            {%- for parsed_result_dict in parsed_results -%}\r\n              {%- set date_column =  parsed_result_dict.get('date_column')  -%}\r\n              {% if date_column is not none %}\r\n              {%- set date_column_format = cast_to_date(date_column, parsed_result_dict.get('schema_name'), parsed_result_dict.get('name') )  -%}\r\n                {% set last_record_query -%}\r\n                    select date_format(date_trunc('day', MAX({{date_column_format}})), '%Y-%m-%d')\r\n                    from {{ parsed_result_dict.get('schema_name') }}.{{ parsed_result_dict.get('name') }}\r\n                {%- endset -%}\r\n                {%- set last_record_result = run_query(last_record_query) -%}\r\n                {% if execute %}\r\n                    {%- set last_record = last_record_result.columns[0].values()[0] -%}\r\n                {% else %}\r\n                    {% set last_record = none %}\r\n                {% endif %}\r\n                {% else %}\r\n                    {% set last_record = none %}\r\n                {% endif %}\r\n\r\n                {% set insert_dbt_results_query -%}\r\n                    insert into staging.log_results\r\n                        (\r\n                            result_id,\r\n                            invocation_id,\r\n                            unique_id,\r\n                            database_name,\r\n                            schema_name,\r\n                            name,\r\n                            MATERIALIZED,\r\n                            INCREMENTAL_STRATEGY,\r\n                            resource_type,\r\n                            status,\r\n                            start_at,\r\n                            completed_at,\r\n                            execution_time,\r\n                            rows_affected,\r\n                            last_record_at,\r\n                            date_column,\r\n                            owner,\r\n                            full_refresh\r\n                    ) values\r\n                        (\r\n                            '{{ parsed_result_dict.get('result_id') }}',\r\n                            '{{ parsed_result_dict.get('invocation_id') }}',\r\n                            '{{ parsed_result_dict.get('unique_id') }}',\r\n                            '{{ parsed_result_dict.get('database_name') }}',\r\n                            '{{ parsed_result_dict.get('schema_name') }}',\r\n                            '{{ parsed_result_dict.get('name') }}',\r\n                            '{{ parsed_result_dict.get('materialized') }}',\r\n                            '{{ parsed_result_dict.get('incremental_strategy') }}',\r\n                            '{{ parsed_result_dict.get('resource_type') }}',\r\n                            '{{ parsed_result_dict.get('status') }}',\r\n                            from_iso8601_timestamp('{{ parsed_result_dict.get('start_at') }}'),\r\n                            from_iso8601_timestamp('{{ parsed_result_dict.get('completed_at') }}'),\r\n                            '{{ parsed_result_dict.get('execution_time') }}',\r\n                            '{{ parsed_result_dict.get('rows_affected') }}',\r\n                            {% if last_record  is not none %}\r\n                              date_parse('{{ last_record }}', '%Y-%m-%d'),\r\n                            {% else %}\r\n                              null ,\r\n                            {% endif %}\r\n                            '{{ parsed_result_dict.get('date_column') }}',\r\n                            '{{ parsed_result_dict.get('owner') }}',\r\n                            '{{ parsed_result_dict.get('full_refresh') }}'\r\n                        )\r\n                {%- endset -%}\r\n                {%- do run_query(insert_dbt_results_query) -%}\r\n            {%- endfor -%}\r\n      {%- endif -%}\r\n    {%- endif -%}\r\n    {%- endif -%}\r\n    {{ return ('') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dga_data_model.parse_dbt_results", "macro.dga_data_model.cast_to_date", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2637966, "supported_languages": null}, "macro.dga_data_model.create_index_if_not_exists": {"unique_id": "macro.dga_data_model.create_index_if_not_exists", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "macros\\oracle\\create_index_if_not_exists.sql", "original_file_path": "macros\\oracle\\create_index_if_not_exists.sql", "name": "create_index_if_not_exists", "macro_sql": "{% macro create_index_if_not_exists (this, columns) -%}\r\n\r\nDECLARE\r\n  already_exists EXCEPTION;\r\n  columns_indexed EXCEPTION;\r\n  PRAGMA exception_init ( already_exists, -955 );\r\n  PRAGMA exception_init ( columns_indexed, -1408 );\r\nBEGIN\r\n  EXECUTE IMMEDIATE 'CREATE INDEX {{ this.table }}__{{ columns }} ON {{ this }}( {{ columns }} )';\r\nEXCEPTION\r\n  WHEN already_exists OR columns_indexed THEN\r\n    EXECUTE IMMEDIATE 'DROP INDEX {{ this.table }}__{{ columns }}';\r\n    COMMIT ;\r\n    EXECUTE IMMEDIATE 'CREATE INDEX {{ this.table }}__{{ columns }} ON {{ this }}( {{ columns }} )';\r\n    COMMIT;\r\nEND;\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2647965, "supported_languages": null}, "macro.dga_data_model.test_is_recency": {"unique_id": "macro.dga_data_model.test_is_recency", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "tests\\generic\\is_recency.sql", "original_file_path": "tests\\generic\\is_recency.sql", "name": "test_is_recency", "macro_sql": "{% test is_recency(model, column_name , interval=1) %}\r\n\r\nWITH test_expression as (\r\n  SELECT\r\n    MAX({{ column_name }}) >=\r\n    (CAST(CAST(year(current_date) AS varchar)|| CAST(day_of_year(current_date) AS varchar) AS int) - {{ interval}}) AS expression\r\n  FROM {{ model }}\r\n)\r\n, validation_errors as (\r\n  SELECT\r\n      *\r\n  FROM\r\n      test_expression\r\n  WHERE\r\n    NOT(expression = true)\r\n)\r\nSELECT *\r\nFROM validation_errors\r\n\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2667968, "supported_languages": null}, "macro.dga_data_model.test_is_updated": {"unique_id": "macro.dga_data_model.test_is_updated", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "tests\\generic\\is_updated.sql", "original_file_path": "tests\\generic\\is_updated.sql", "name": "test_is_updated", "macro_sql": "{% test is_updated(model, expression, compare_model) %}\r\n\r\nWITH source as (\r\n  SELECT\r\n    {{ expression }} AS exp\r\n  FROM {{ model }}\r\n)\r\n, destination as (\r\n  SELECT\r\n    {{ expression }} AS exp\r\n  FROM {{ compare_model }}\r\n)\r\n, is_updated AS (\r\nSELECT\r\n  CASE\r\n    WHEN s.exp > d.exp THEN 't'\r\n    ELSE 'f'\r\n  END AS is_updated\r\nFROM source s, destination d\r\n)\r\n  SELECT * FROM is_updated\r\n  WHERE is_updated = 'f'\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2667968, "supported_languages": null}, "macro.dga_data_model.test_orc_is_recency": {"unique_id": "macro.dga_data_model.test_orc_is_recency", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "tests\\generic\\orc_is_recency.sql", "original_file_path": "tests\\generic\\orc_is_recency.sql", "name": "test_orc_is_recency", "macro_sql": "{% test orc_is_recency(model, column_name , interval=1) %}\r\n\r\nWITH test_expression as (\r\n  SELECT\r\n    CASE\r\n      WHEN MAX({{ column_name }}) >= to_number(to_char(sysdate- {{interval}}, 'YYYYDDD')) THEN 'true'\r\n      ELSE 'false'\r\n    END AS expression\r\n  FROM {{ model }}\r\n)\r\n, validation_errors as (\r\n  SELECT\r\n    *\r\n  FROM\r\n    test_expression\r\n  WHERE\r\n    expression = 'false'\r\n)\r\nSELECT *\r\nFROM validation_errors\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.267797, "supported_languages": null}, "macro.dga_data_model.test_unique_combination_of_columns": {"unique_id": "macro.dga_data_model.test_unique_combination_of_columns", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "tests\\generic\\unique_combination_of_columns.sql", "original_file_path": "tests\\generic\\unique_combination_of_columns.sql", "name": "test_unique_combination_of_columns", "macro_sql": "{% test unique_combination_of_columns(model, combination_of_columns, condition_columns, quote_columns=false) %}\r\n\r\n\r\n{%- set column_list=combination_of_columns %}\r\n\r\n{%- set columns_csv=column_list | join(', ') %}\r\n\r\nwith validation_errors as (\r\n\r\n    select\r\n        {{ columns_csv }}\r\n    from {{ model }}\r\n    where {{ condition_columns }} >= (select max({{ condition_columns }}) from {{ model }})\r\n    group by {{ columns_csv }}\r\n    having count(*) > 1\r\n\r\n)\r\n\r\nselect *\r\nfrom validation_errors\r\n\r\n\r\n\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.268797, "supported_languages": null}, "macro.dbt_trino.trino__get_columns_in_relation": {"unique_id": "macro.dbt_trino.trino__get_columns_in_relation", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__get_columns_in_relation", "macro_sql": "{% macro trino__get_columns_in_relation(relation) -%}\n  {%- set sql -%}\n    describe {{ relation }}\n  {%- endset -%}\n  {%- set result = run_query(sql) -%}\n\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many columns in relation {{ relation }}! dbt can only get\n      information about relations with fewer than {{ maximum }} columns.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n\n  {% set columns = [] %}\n  {% for row in result %}\n    {% do columns.append(api.Column.from_description(row['Column'].lower(), row['Type'])) %}\n  {% endfor %}\n  {% do return(columns) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2787964, "supported_languages": null}, "macro.dbt_trino.trino__list_relations_without_caching": {"unique_id": "macro.dbt_trino.trino__list_relations_without_caching", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__list_relations_without_caching", "macro_sql": "{% macro trino__list_relations_without_caching(relation) %}\n  {% call statement('list_relations_without_caching', fetch_result=True) -%}\n    select\n      table_catalog as database,\n      table_name as name,\n      table_schema as schema,\n      case when table_type = 'BASE TABLE' then 'table'\n           when table_type = 'VIEW' then 'view'\n           else table_type\n      end as table_type\n    from {{ relation.information_schema() }}.tables\n    where table_schema = '{{ relation.schema | lower }}'\n  {% endcall %}\n  {{ return(load_result('list_relations_without_caching').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2797964, "supported_languages": null}, "macro.dbt_trino.trino__reset_csv_table": {"unique_id": "macro.dbt_trino.trino__reset_csv_table", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__reset_csv_table", "macro_sql": "{% macro trino__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {{ adapter.drop_relation(old_relation) }}\n    {{ return(create_csv_table(model, agate_table)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2797964, "supported_languages": null}, "macro.dbt_trino.trino__create_csv_table": {"unique_id": "macro.dbt_trino.trino__create_csv_table", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__create_csv_table", "macro_sql": "{% macro trino__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n  {%- set _properties = config.get('properties') -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    ) {{ properties(_properties) }}\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.properties", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2817967, "supported_languages": null}, "macro.dbt_trino.properties": {"unique_id": "macro.dbt_trino.properties", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "properties", "macro_sql": "{% macro properties(properties) %}\n  {%- if properties is not none -%}\n      WITH (\n          {%- for key, value in properties.items() -%}\n            {{ key }} = {{ value }}\n            {%- if not loop.last -%}{{ ',\\n  ' }}{%- endif -%}\n          {%- endfor -%}\n      )\n  {%- endif -%}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.282797, "supported_languages": null}, "macro.dbt_trino.trino__create_table_as": {"unique_id": "macro.dbt_trino.trino__create_table_as", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__create_table_as", "macro_sql": "{% macro trino__create_table_as(temporary, relation, sql) -%}\n  {%- set _properties = config.get('properties') -%}\n  create table {{ relation }}\n    {{ properties(_properties) }}\n  as (\n    {{ sql }}\n  );\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.properties"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.282797, "supported_languages": null}, "macro.dbt_trino.trino__create_view_as": {"unique_id": "macro.dbt_trino.trino__create_view_as", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__create_view_as", "macro_sql": "{% macro trino__create_view_as(relation, sql) -%}\n  {%- set view_security = config.get('view_security', 'definer') -%}\n  {%- if view_security not in ['definer', 'invoker'] -%}\n      {%- set log_message = 'Invalid value for view_security (%s) specified. Setting default value (%s).' % (view_security, 'definer') -%}\n      {% do log(log_message) %}\n      {%- set on_table_exists = 'definer' -%}\n  {% endif %}\n  create or replace view\n    {{ relation }}\n  security {{ view_security }}\n  as\n    {{ sql }}\n  ;\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2837973, "supported_languages": null}, "macro.dbt_trino.trino__drop_relation": {"unique_id": "macro.dbt_trino.trino__drop_relation", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__drop_relation", "macro_sql": "{% macro trino__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.284797, "supported_languages": null}, "macro.dbt_trino.trino__information_schema_name": {"unique_id": "macro.dbt_trino.trino__information_schema_name", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__information_schema_name", "macro_sql": "{% macro trino__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.284797, "supported_languages": null}, "macro.dbt_trino.trino__drop_schema": {"unique_id": "macro.dbt_trino.trino__drop_schema", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__drop_schema", "macro_sql": "{% macro trino__drop_schema(relation) -%}\n  {% for row in list_relations_without_caching(relation) %}\n    {% set rel_db = row[0] %}\n    {% set rel_identifier = row[1] %}\n    {% set rel_schema = row[2] %}\n    {% set rel_type = api.Relation.get_relation_type(row[3]) %}\n    {% set existing = api.Relation.create(database=rel_db, schema=rel_schema, identifier=rel_identifier, type=rel_type) %}\n    {% do drop_relation(existing) %}\n  {% endfor %}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.list_relations_without_caching", "macro.dbt.drop_relation", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2857969, "supported_languages": null}, "macro.dbt_trino.trino__rename_relation": {"unique_id": "macro.dbt_trino.trino__rename_relation", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__rename_relation", "macro_sql": "{% macro trino__rename_relation(from_relation, to_relation) -%}\n  {% call statement('rename_relation') -%}\n    alter {{ from_relation.type }} {{ from_relation }} rename to {{ to_relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2867968, "supported_languages": null}, "macro.dbt_trino.trino__alter_relation_comment": {"unique_id": "macro.dbt_trino.trino__alter_relation_comment", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__alter_relation_comment", "macro_sql": "{% macro trino__alter_relation_comment(relation, relation_comment) -%}\n  comment on {{ relation.type }} {{ relation }} is '{{ relation_comment | replace(\"'\", \"''\") }}';\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2867968, "supported_languages": null}, "macro.dbt_trino.trino__alter_column_comment": {"unique_id": "macro.dbt_trino.trino__alter_column_comment", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__alter_column_comment", "macro_sql": "{% macro trino__alter_column_comment(relation, column_dict) %}\n  {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n  {% for column_name in column_dict if (column_name in existing_columns) %}\n    {% set comment = column_dict[column_name]['description'] %}\n    {%- if comment|length -%}\n      comment on column {{ relation }}.{{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} is '{{ comment | replace(\"'\", \"''\") }}';\n    {%- else -%}\n      comment on column {{ relation }}.{{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} is null;\n    {%- endif -%}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.287797, "supported_languages": null}, "macro.dbt_trino.trino__list_schemas": {"unique_id": "macro.dbt_trino.trino__list_schemas", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__list_schemas", "macro_sql": "{% macro trino__list_schemas(database) -%}\n  {% call statement('list_schemas', fetch_result=True, auto_begin=False) %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.schemata\n  {% endcall %}\n  {{ return(load_result('list_schemas').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2887964, "supported_languages": null}, "macro.dbt_trino.trino__check_schema_exists": {"unique_id": "macro.dbt_trino.trino__check_schema_exists", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__check_schema_exists", "macro_sql": "{% macro trino__check_schema_exists(information_schema, schema) -%}\n  {% call statement('check_schema_exists', fetch_result=True, auto_begin=False) -%}\n        select count(*)\n        from {{ information_schema }}.schemata\n        where catalog_name = '{{ information_schema.database }}'\n          and schema_name = '{{ schema | lower }}'\n  {%- endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2887964, "supported_languages": null}, "macro.dbt_trino.trino__get_binding_char": {"unique_id": "macro.dbt_trino.trino__get_binding_char", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__get_binding_char", "macro_sql": "{% macro trino__get_binding_char() %}\n  {%- if target.prepared_statements_enabled|as_bool -%}\n    {{ return('?') }}\n  {%- else -%}\n    {{ return('%s') }}\n  {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2897966, "supported_languages": null}, "macro.dbt_trino.trino__alter_relation_add_remove_columns": {"unique_id": "macro.dbt_trino.trino__alter_relation_add_remove_columns", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "trino__alter_relation_add_remove_columns", "macro_sql": "{% macro trino__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% for column in add_columns %}\n    {% set sql -%}\n      alter {{ relation.type }} {{ relation }} add column {{ column.name }} {{ column.data_type }}\n    {%- endset -%}\n    {% do run_query(sql) %}\n  {% endfor %}\n\n  {% for column in remove_columns %}\n    {% set sql -%}\n      alter {{ relation.type }} {{ relation }} drop column {{ column.name }}\n    {%- endset -%}\n    {% do run_query(sql) %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.290797, "supported_languages": null}, "macro.dbt_trino.trino__get_show_grant_sql": {"unique_id": "macro.dbt_trino.trino__get_show_grant_sql", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\apply_grants.sql", "original_file_path": "macros\\apply_grants.sql", "name": "trino__get_show_grant_sql", "macro_sql": "{% macro trino__get_show_grant_sql(relation) -%}\n    select\n        grantee,\n        lower(privilege_type) as privilege_type\n    from information_schema.table_privileges\n    where table_catalog = '{{ relation.database }}'\n    and table_schema = '{{ relation.schema }}'\n    and table_name = '{{ relation.identifier }}'\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.292797, "supported_languages": null}, "macro.dbt_trino.trino__copy_grants": {"unique_id": "macro.dbt_trino.trino__copy_grants", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\apply_grants.sql", "original_file_path": "macros\\apply_grants.sql", "name": "trino__copy_grants", "macro_sql": "{% macro trino__copy_grants() %}\n    {#\n        -- This macro should return true or false depending on the answer to\n        -- following question:\n        -- when an object is fully replaced on your database, do grants copy over?\n        -- e.g. on Postgres this is never true,\n        -- on Spark this is different for views vs. non-Delta tables vs. Delta tables,\n        -- on Snowflake it depends on the user-supplied copy_grants configuration.\n        -- true by default, which means \u201cplay it safe\u201d: grants MIGHT have copied over,\n        -- so dbt will run an extra query to check them + calculate diffs.\n    #}\n    {{ return(False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.293797, "supported_languages": null}, "macro.dbt_trino.trino__get_grant_sql": {"unique_id": "macro.dbt_trino.trino__get_grant_sql", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\apply_grants.sql", "original_file_path": "macros\\apply_grants.sql", "name": "trino__get_grant_sql", "macro_sql": "\n\n{%- macro trino__get_grant_sql(relation, privilege, grantees) -%}\n    grant {{ privilege }} on {{ relation }} to {{ adapter.quote(grantees[0]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.293797, "supported_languages": null}, "macro.dbt_trino.trino__support_multiple_grantees_per_dcl_statement": {"unique_id": "macro.dbt_trino.trino__support_multiple_grantees_per_dcl_statement", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\apply_grants.sql", "original_file_path": "macros\\apply_grants.sql", "name": "trino__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro trino__support_multiple_grantees_per_dcl_statement() -%}\n    {#\n        -- This macro should return true or false depending on the answer to\n        -- following question:\n        -- does this database support grant {privilege} to user_a, user_b, ...?\n        -- or do user_a + user_b need their own separate grant statements?\n    #}\n    {{ return(False) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.294797, "supported_languages": null}, "macro.dbt_trino.trino__call_dcl_statements": {"unique_id": "macro.dbt_trino.trino__call_dcl_statements", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\apply_grants.sql", "original_file_path": "macros\\apply_grants.sql", "name": "trino__call_dcl_statements", "macro_sql": "{% macro trino__call_dcl_statements(dcl_statement_list) %}\n    {% for dcl_statement in dcl_statement_list %}\n        {% call statement('grant_or_revoke') %}\n            {{ dcl_statement }}\n        {% endcall %}\n    {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.294797, "supported_languages": null}, "macro.dbt_trino.trino__get_catalog": {"unique_id": "macro.dbt_trino.trino__get_catalog", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\catalog.sql", "original_file_path": "macros\\catalog.sql", "name": "trino__get_catalog", "macro_sql": "{% macro trino__get_catalog(information_schema, schemas) -%}\n    {%- call statement('catalog', fetch_result=True) -%}\n        with tables as (\n\n            select\n                table_catalog as \"table_database\",\n                table_schema as \"table_schema\",\n                table_name as \"table_name\",\n                table_type as \"table_type\",\n                null as \"table_owner\"\n\n            from {{ information_schema }}.tables\n            where\n                table_schema != 'information_schema'\n                and\n                table_schema in ('{{ schemas | join(\"','\") | lower }}')\n\n        ),\n\n        columns as (\n\n            select\n                table_catalog as \"table_database\",\n                table_schema as \"table_schema\",\n                table_name as \"table_name\",\n\n                column_name as \"column_name\",\n                ordinal_position as \"column_index\",\n                data_type as \"column_type\",\n                comment as \"column_comment\"\n\n            from {{ information_schema }}.columns\n            where\n                table_schema != 'information_schema'\n                and\n                table_schema in ('{{ schemas | join(\"','\") | lower }}')\n\n        ),\n\n        table_comment as (\n\n            select\n                catalog_name as \"table_database\",\n                schema_name as \"table_schema\",\n                table_name as \"table_name\",\n                comment as \"table_comment\"\n\n            from system.metadata.table_comments\n            where\n                catalog_name = '{{ database }}'\n                and\n                schema_name != 'information_schema'\n                and\n                schema_name in ('{{ schemas | join(\"','\") | lower }}')\n        )\n\n        select *\n        from tables\n        join columns using (\"table_database\", \"table_schema\", \"table_name\")\n        join table_comment using (\"table_database\", \"table_schema\", \"table_name\")\n        order by \"column_index\"\n\n  {%- endcall -%}\n\n  {{ return(load_result('catalog').table) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.2987971, "supported_languages": null}, "macro.dbt_trino.get_incremental_tmp_relation_type": {"unique_id": "macro.dbt_trino.get_incremental_tmp_relation_type", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "get_incremental_tmp_relation_type", "macro_sql": "{% macro get_incremental_tmp_relation_type(strategy, unique_key, language) %}\n\n  /* {#\n       If we are running multiple statements (DELETE + INSERT),\n       we must first save the model query results as a temporary table\n       in order to guarantee consistent inputs to both statements.\n\n       If we are running a single statement (MERGE or INSERT alone),\n       we can save the model query definition as a view instead,\n       for faster overall incremental processing.\n  #} */\n  {%- set views_enabled = config.get('views_enabled', false) -%}\n\n  {% if language == 'sql' and (views_enabled and (strategy in ('default', 'append', 'merge') or (unique_key is none))) %}\n    {{ return('view') }}\n  {% else %}  {#--  play it safe -- #}\n    {{ return('table') }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3067968, "supported_languages": null}, "macro.dbt_trino.materialization_incremental_trino": {"unique_id": "macro.dbt_trino.materialization_incremental_trino", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "materialization_incremental_trino", "macro_sql": "{% materialization incremental, adapter='trino', supported_languages=['sql'] -%}\n\n  {#-- Set vars --#}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n  {%- set language = model['language'] -%}\n  {% set target_relation = this.incorporate(type='table') %}\n  {% set existing_relation = load_relation(this) %}\n\n  {#-- The temp relation will be a view (faster) or temp table, depending on upsert/merge strategy --#}\n  {%- set unique_key = config.get('unique_key') -%}\n  {% set incremental_strategy = config.get('incremental_strategy') or 'default' %}\n  {% set tmp_relation_type = get_incremental_tmp_relation_type(incremental_strategy, unique_key, language) %}\n  {% set tmp_relation = make_temp_relation(this).incorporate(type=tmp_relation_type) %}\n\n  {% set grant_config = config.get('grants') %}\n\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {% if existing_relation is none %}\n    {%- call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n    {%- endcall -%}\n\n  {% elif existing_relation.is_view %}\n    {#-- Can't overwrite a view with a table - we must drop --#}\n    {{ log(\"Dropping relation \" ~ target_relation ~ \" because it is a view and this model is a table.\") }}\n    {% do adapter.drop_relation(existing_relation) %}\n    {%- call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n    {%- endcall -%}\n  {% elif full_refresh_mode %}\n    {#-- Can't replace a table - we must drop --#}\n    {% do adapter.drop_relation(existing_relation) %}\n    {%- call statement('main', language=language) -%}\n      {{ create_table_as(False, target_relation, compiled_code, language) }}\n    {%- endcall -%}\n\n  {% else %}\n    {#-- Create the temp relation, either as a view or as a temp table --#}\n    {% if tmp_relation_type == 'view' %}\n        {%- call statement('create_tmp_relation') -%}\n          {{ create_view_as(tmp_relation, compiled_code) }}\n        {%- endcall -%}\n    {% else %}\n        {%- call statement('create_tmp_relation', language=language) -%}\n          {{ create_table_as(True, tmp_relation, compiled_code, language) }}\n        {%- endcall -%}\n    {% endif %}\n\n    {% do adapter.expand_target_column_types(\n           from_relation=tmp_relation,\n           to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n\n    {#-- Get the incremental_strategy, the macro to use for the strategy, and build the sql --#}\n    {% set incremental_predicates = config.get('incremental_predicates', none) %}\n    {% set strategy_sql_macro_func = adapter.get_incremental_strategy_macro(context, incremental_strategy) %}\n    {% set strategy_arg_dict = ({'target_relation': target_relation, 'temp_relation': tmp_relation, 'unique_key': unique_key, 'dest_columns': dest_columns, 'predicates': incremental_predicates }) %}\n\n    {%- call statement('main') -%}\n      {{ strategy_sql_macro_func(strategy_arg_dict) }}\n    {%- endcall -%}\n  {% endif %}\n\n  {% do drop_relation_if_exists(tmp_relation) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% set should_revoke =\n   should_revoke(existing_relation.is_table, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.load_relation", "macro.dbt_trino.get_incremental_tmp_relation_type", "macro.dbt.make_temp_relation", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.create_view_as", "macro.dbt.process_schema_changes", "macro.dbt.drop_relation_if_exists", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3117964, "supported_languages": ["sql"]}, "macro.dbt_trino.trino__get_delete_insert_merge_sql": {"unique_id": "macro.dbt_trino.trino__get_delete_insert_merge_sql", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "trino__get_delete_insert_merge_sql", "macro_sql": "{% macro trino__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not string %}\n            delete from {{ target }}\n            where\n                {% for key in unique_key %}\n                    {{ target }}.{{ key }} in (select {{ key }} from {{ source }})\n                    {{ \"and \" if not loop.last }}\n                {% endfor %}\n            ;\n        {% else %}\n            delete from {{ target }}\n            where (\n                {{ unique_key }}) in (\n                select {{ unique_key }}\n                from {{ source }}\n            );\n\n        {% endif %}\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3127968, "supported_languages": null}, "macro.dbt_trino.trino__get_merge_sql": {"unique_id": "macro.dbt_trino.trino__get_merge_sql", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "trino__get_merge_sql", "macro_sql": "{% macro trino__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set dest_cols_csv_source = dest_cols_csv.split(', ') -%}\n    {%- set merge_update_columns = config.get('merge_update_columns') -%}\n    {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}\n    {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set unique_key_match %}\n                DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n            {% endset %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n\n        {{ sql_header if sql_header is not none }}\n\n        merge into {{ target }} as DBT_INTERNAL_DEST\n            using {{ source }} as DBT_INTERNAL_SOURCE\n            on {{ predicates | join(' and ') }}\n\n        {% if unique_key %}\n        when matched then update set\n            {% for column_name in update_columns -%}\n                {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n                {%- if not loop.last %}, {%- endif %}\n            {%- endfor %}\n        {% endif %}\n\n        when not matched then insert\n            ({{ dest_cols_csv }})\n        values\n            ({% for dest_cols in dest_cols_csv_source -%}\n                DBT_INTERNAL_SOURCE.{{ dest_cols }}\n                {%- if not loop.last %}, {% endif %}\n            {%- endfor %})\n\n    {% else %}\n        insert into {{ target }} ({{ dest_cols_csv }})\n        (\n            select {{ dest_cols_csv }}\n            from {{ source }}\n        )\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3168852, "supported_languages": null}, "macro.dbt_trino.trino__snapshot_hash_arguments": {"unique_id": "macro.dbt_trino.trino__snapshot_hash_arguments", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "trino__snapshot_hash_arguments", "macro_sql": "{% macro trino__snapshot_hash_arguments(args) -%}\n  lower(to_hex(md5(to_utf8(concat({%- for arg in args -%}\n    coalesce(cast({{ arg }} as varchar), ''){% if not loop.last %}, '|',{% endif -%}\n  {%- endfor -%}\n  )))))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.31888, "supported_languages": null}, "macro.dbt_trino.trino__post_snapshot": {"unique_id": "macro.dbt_trino.trino__post_snapshot", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "trino__post_snapshot", "macro_sql": "{% macro trino__post_snapshot(staging_relation) %}\n  -- Clean up the snapshot temp table\n  {% do drop_relation(staging_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.31888, "supported_languages": null}, "macro.dbt_trino.trino__snapshot_merge_sql": {"unique_id": "macro.dbt_trino.trino__snapshot_merge_sql", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "trino__snapshot_merge_sql", "macro_sql": "{% macro trino__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({% for insert_col in insert_cols -%}\n            DBT_INTERNAL_SOURCE.{{ insert_col }}\n            {%- if not loop.last %}, {% endif %}\n            {%- endfor %})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3198786, "supported_languages": null}, "macro.dbt_trino.materialization_table_trino": {"unique_id": "macro.dbt_trino.materialization_table_trino", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\table.sql", "original_file_path": "macros\\materializations\\table.sql", "name": "materialization_table_trino", "macro_sql": "{% materialization table, adapter = 'trino' %}\n  {%- set on_table_exists = config.get('on_table_exists', 'rename') -%}\n  {% if on_table_exists not in ['rename', 'drop'] %}\n      {%- set log_message = 'Invalid value for on_table_exists (%s) specified. Setting default value (%s).' % (on_table_exists, 'rename') -%}\n      {% do log(log_message) %}\n      {%- set on_table_exists = 'rename' -%}\n  {% endif %}\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type='table') -%}\n\n  {% if on_table_exists == 'rename' %}\n      {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                          schema=schema,\n                                                          database=database,\n                                                          type='table') -%}\n\n      {%- set backup_relation_type = 'table' if old_relation is none else old_relation.type -%}\n      {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                    schema=schema,\n                                                    database=database,\n                                                    type=backup_relation_type) -%}\n\n      {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n      {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n        -- drop the temp relations if they exists for some reason\n      {{ adapter.drop_relation(intermediate_relation) }}\n      {{ adapter.drop_relation(backup_relation) }}\n  {% endif %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  {% if on_table_exists == 'rename' %}\n      {#-- build modeldock #}\n      {% call statement('main') -%}\n        {{ create_table_as(False, intermediate_relation, sql) }}\n      {%- endcall %}\n\n      {#-- cleanup #}\n      {% if old_relation is not none %}\n          {{ adapter.rename_relation(old_relation, backup_relation) }}\n      {% endif %}\n\n      {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n      {#-- finally, drop the existing/backup relation after the commit #}\n      {{ drop_relation_if_exists(backup_relation) }}\n\n  {% elif on_table_exists == 'drop' %}\n      {#-- cleanup #}\n      {%- if old_relation is not none -%}\n          {{ adapter.drop_relation(old_relation) }}\n      {%- endif -%}\n\n      {#-- build model #}\n      {% call statement('main') -%}\n        {{ create_table_as(False, target_relation, sql) }}\n      {%- endcall %}\n  {% endif %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.drop_relation_if_exists", "macro.dbt.persist_docs", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3258727, "supported_languages": ["sql"]}, "macro.dbt_trino.materialization_view_trino": {"unique_id": "macro.dbt_trino.materialization_view_trino", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\view.sql", "original_file_path": "macros\\materializations\\view.sql", "name": "materialization_view_trino", "macro_sql": "{% materialization view, adapter='trino' -%}\n    {% set to_return = create_or_replace_view() %}\n    {% set target_relation = this.incorporate(type='view') %}\n\n    {% do persist_docs(target_relation, model) %}\n\n    {% do return(to_return) %}\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_or_replace_view", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3268702, "supported_languages": ["sql"]}, "macro.dbt_trino.trino__get_batch_size": {"unique_id": "macro.dbt_trino.trino__get_batch_size", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "trino__get_batch_size", "macro_sql": "{% macro trino__get_batch_size() %}\n  {{ return(1000) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3288708, "supported_languages": null}, "macro.dbt_trino.create_bindings": {"unique_id": "macro.dbt_trino.create_bindings", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "create_bindings", "macro_sql": "{% macro create_bindings(row, types) %}\n  {% set values = [] %}\n  {% set re = modules.re %}\n\n  {%- for item in row -%}\n      {%- set type = types[loop.index0] -%}\n      {%- set match_type = re.match(\"(\\w+)(\\(.*\\))?\", type) -%}\n      {%- if item is not none and item is string and 'interval' in match_type.group(1) -%}\n        {%- do values.append((none, match_type.group(1).upper() ~ \" \" ~ item)) -%}\n      {%- elif item is not none and item is string and 'varchar' not in type.lower() -%}\n        {%- do values.append((none, match_type.group(1).upper() ~ \" '\" ~ item ~ \"'\")) -%}\n      {%- elif item is not none and 'varchar' in type.lower() -%}\n        {%- do values.append((get_binding_char(), item|string())) -%}\n      {%- else -%}\n        {%- do values.append((get_binding_char(), item)) -%}\n      {% endif -%}\n  {%- endfor -%}\n  {{ return(values) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3308794, "supported_languages": null}, "macro.dbt_trino.trino__load_csv_rows": {"unique_id": "macro.dbt_trino.trino__load_csv_rows", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "trino__load_csv_rows", "macro_sql": "{% macro trino__load_csv_rows(model, agate_table) %}\n  {% set column_override = model['config'].get('column_types', {}) %}\n  {% set types = [] %}\n\n  {%- for col_name in agate_table.column_names -%}\n      {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n      {%- set type = column_override.get(col_name, inferred_type) -%}\n      {%- do types.append(type) -%}\n  {%- endfor -%}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for tuple in create_bindings(row, types) -%}\n                  {%- if tuple.0 is not none  -%}\n                  {{ tuple.0 }}\n                  {%- do bindings.append(tuple.1) -%}\n                  {%- else -%}\n                  {{ tuple.1 }}\n                  {%- endif -%}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt_trino.create_bindings"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3338761, "supported_languages": null}, "macro.dbt_trino.trino__any_value": {"unique_id": "macro.dbt_trino.trino__any_value", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\any_value.sql", "original_file_path": "macros\\utils\\any_value.sql", "name": "trino__any_value", "macro_sql": "{% macro trino__any_value(expression) -%}\n    min({{ expression }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3348753, "supported_languages": null}, "macro.dbt_trino.trino__array_append": {"unique_id": "macro.dbt_trino.trino__array_append", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\array_append.sql", "original_file_path": "macros\\utils\\array_append.sql", "name": "trino__array_append", "macro_sql": "{% macro trino__array_append(array, new_element) -%}\n    {{ array_concat(array, array_construct([new_element])) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.array_concat", "macro.dbt.array_construct"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3348753, "supported_languages": null}, "macro.dbt_trino.trino__array_concat": {"unique_id": "macro.dbt_trino.trino__array_concat", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\array_concat.sql", "original_file_path": "macros\\utils\\array_concat.sql", "name": "trino__array_concat", "macro_sql": "{% macro trino__array_concat(array_1, array_2) -%}\n    concat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3358712, "supported_languages": null}, "macro.dbt_trino.trino__array_construct": {"unique_id": "macro.dbt_trino.trino__array_construct", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\array_construct.sql", "original_file_path": "macros\\utils\\array_construct.sql", "name": "trino__array_construct", "macro_sql": "{% macro trino__array_construct(inputs, data_type) -%}\n    {%- if not inputs -%}\n    null\n    {%- else -%}\n    array[ {{ inputs|join(' , ') }} ]\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3368707, "supported_languages": null}, "macro.dbt_trino.trino__bool_or": {"unique_id": "macro.dbt_trino.trino__bool_or", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\bool_or.sql", "original_file_path": "macros\\utils\\bool_or.sql", "name": "trino__bool_or", "macro_sql": "{% macro trino__bool_or(expression) -%}\n    bool_or({{ expression }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3368707, "supported_languages": null}, "macro.dbt_trino.trino__type_float": {"unique_id": "macro.dbt_trino.trino__type_float", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\datatypes.sql", "original_file_path": "macros\\utils\\datatypes.sql", "name": "trino__type_float", "macro_sql": "{% macro trino__type_float() -%}\n    double\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3368707, "supported_languages": null}, "macro.dbt_trino.trino__type_string": {"unique_id": "macro.dbt_trino.trino__type_string", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\datatypes.sql", "original_file_path": "macros\\utils\\datatypes.sql", "name": "trino__type_string", "macro_sql": "{% macro trino__type_string() -%}\n    varchar\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3368707, "supported_languages": null}, "macro.dbt_trino.trino__type_numeric": {"unique_id": "macro.dbt_trino.trino__type_numeric", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\datatypes.sql", "original_file_path": "macros\\utils\\datatypes.sql", "name": "trino__type_numeric", "macro_sql": "{% macro trino__type_numeric() -%}\n    decimal(28, 6)\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3378744, "supported_languages": null}, "macro.dbt_trino.trino__type_int": {"unique_id": "macro.dbt_trino.trino__type_int", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\datatypes.sql", "original_file_path": "macros\\utils\\datatypes.sql", "name": "trino__type_int", "macro_sql": "\n\n{%- macro trino__type_int() -%}\n    integer\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3378744, "supported_languages": null}, "macro.dbt_trino.trino__dateadd": {"unique_id": "macro.dbt_trino.trino__dateadd", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\dateadd.sql", "original_file_path": "macros\\utils\\dateadd.sql", "name": "trino__dateadd", "macro_sql": "{% macro trino__dateadd(datepart, interval, from_date_or_timestamp) -%}\n    date_add('{{ datepart }}', {{ interval }}, {{ from_date_or_timestamp }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3378744, "supported_languages": null}, "macro.dbt_trino.trino__datediff": {"unique_id": "macro.dbt_trino.trino__datediff", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\datediff.sql", "original_file_path": "macros\\utils\\datediff.sql", "name": "trino__datediff", "macro_sql": "{% macro trino__datediff(first_date, second_date, datepart) -%}\n    {%- if datepart == 'year' -%}\n        (year(CAST({{ second_date }} AS TIMESTAMP)) - year(CAST({{ first_date }} AS TIMESTAMP)))\n    {%- elif datepart == 'quarter' -%}\n        ({{ datediff(first_date, second_date, 'year') }} * 4) + quarter(CAST({{ second_date }} AS TIMESTAMP)) - quarter(CAST({{ first_date }} AS TIMESTAMP))\n    {%- elif datepart == 'month' -%}\n        ({{ datediff(first_date, second_date, 'year') }} * 12) + month(CAST({{ second_date }} AS TIMESTAMP)) - month(CAST({{ first_date }} AS TIMESTAMP))\n    {%- elif datepart == 'day' -%}\n        ((to_milliseconds((CAST(CAST({{ second_date }} AS TIMESTAMP) AS DATE) - CAST(CAST({{ first_date }} AS TIMESTAMP) AS DATE)))) / 86400000)\n    {%- elif datepart == 'week' -%}\n         ({{ datediff(first_date, second_date, 'day') }} / 7 + case\n            when dow(CAST({{first_date}} AS TIMESTAMP)) <= dow(CAST({{second_date}} AS TIMESTAMP)) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {%- elif datepart == 'hour' -%}\n        ({{ datediff(first_date, second_date, 'day') }} * 24 + hour(CAST({{ second_date }} AS TIMESTAMP)) - hour(CAST({{ first_date }} AS TIMESTAMP)))\n    {%- elif datepart == 'minute' -%}\n        ({{ datediff(first_date, second_date, 'hour') }} * 60 + minute(CAST({{ second_date }} AS TIMESTAMP)) - minute(CAST({{ first_date }} AS TIMESTAMP)))\n    {%- elif datepart == 'second' -%}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60 + second(CAST({{ second_date }} AS TIMESTAMP)) - second(CAST({{ first_date }} AS TIMESTAMP)))\n    {%- elif datepart == 'millisecond' -%}\n        (to_milliseconds((CAST({{ second_date }} AS TIMESTAMP) - CAST({{ first_date }} AS TIMESTAMP))))\n    {%- else -%}\n        {% if execute %}{{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in Trino: {!r}\".format(datepart)) }}{% endif %}\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3418834, "supported_languages": null}, "macro.dbt_trino.trino__date_trunc": {"unique_id": "macro.dbt_trino.trino__date_trunc", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\date_trunc.sql", "original_file_path": "macros\\utils\\date_trunc.sql", "name": "trino__date_trunc", "macro_sql": "{% macro trino__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3428717, "supported_languages": null}, "macro.dbt_trino.trino__hash": {"unique_id": "macro.dbt_trino.trino__hash", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\hash.sql", "original_file_path": "macros\\utils\\hash.sql", "name": "trino__hash", "macro_sql": "{% macro trino__hash(field) -%}\n    lower(to_hex(md5(to_utf8(cast({{field}} as varchar)))))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3428717, "supported_languages": null}, "macro.dbt_trino.trino__listagg": {"unique_id": "macro.dbt_trino.trino__listagg", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\listagg.sql", "original_file_path": "macros\\utils\\listagg.sql", "name": "trino__listagg", "macro_sql": "{% macro trino__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n    {% set collect_list %} array_agg({{ measure }} {% if order_by_clause -%}{{ order_by_clause }}{%- endif %}) {% endset %}\n    {% set limited %} slice({{ collect_list }}, 1, {{ limit_num }}) {% endset %}\n    {% set collected = limited if limit_num else collect_list %}\n    {% set final %} array_join({{ collected }}, {{ delimiter_text }}) {% endset %}\n    {% do return(final) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3438778, "supported_languages": null}, "macro.dbt_trino.trino__right": {"unique_id": "macro.dbt_trino.trino__right", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\right.sql", "original_file_path": "macros\\utils\\right.sql", "name": "trino__right", "macro_sql": "{% macro trino__right(string_text, length_expression) %}\n    case when {{ length_expression }} = 0\n        then ''\n    else\n        substr({{ string_text }}, -1 * ({{ length_expression }}))\n    end\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3448744, "supported_languages": null}, "macro.dbt_trino.trino__safe_cast": {"unique_id": "macro.dbt_trino.trino__safe_cast", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\safe_cast.sql", "original_file_path": "macros\\utils\\safe_cast.sql", "name": "trino__safe_cast", "macro_sql": "{% macro trino__safe_cast(field, type) -%}\n    try_cast({{field}} as {{type}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3457978, "supported_languages": null}, "macro.dbt_trino.trino__split_part": {"unique_id": "macro.dbt_trino.trino__split_part", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\split_part.sql", "original_file_path": "macros\\utils\\split_part.sql", "name": "trino__split_part", "macro_sql": "{% macro trino__split_part(string_text, delimiter_text, part_number) %}\n  {% if part_number >= 0 %}\n    {{ dbt.default__split_part(string_text, delimiter_text, part_number) }}\n  {% else %}\n    {{ dbt._split_part_negative(string_text, delimiter_text, part_number) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__split_part", "macro.dbt._split_part_negative"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3467991, "supported_languages": null}, "macro.dbt_trino.trino__current_timestamp": {"unique_id": "macro.dbt_trino.trino__current_timestamp", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\timestamps.sql", "original_file_path": "macros\\utils\\timestamps.sql", "name": "trino__current_timestamp", "macro_sql": "{% macro trino__current_timestamp() -%}\n    current_timestamp\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3467991, "supported_languages": null}, "macro.dbt_trino.trino__snapshot_string_as_time": {"unique_id": "macro.dbt_trino.trino__snapshot_string_as_time", "package_name": "dbt_trino", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\trino", "path": "macros\\utils\\timestamps.sql", "original_file_path": "macros\\utils\\timestamps.sql", "name": "trino__snapshot_string_as_time", "macro_sql": "{% macro trino__snapshot_string_as_time(timestamp) %}\n    {%- set result = \"timestamp '\" ~ timestamp ~ \"'\" -%}\n    {{ return(result) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3467991, "supported_languages": null}, "macro.dbt.copy_grants": {"unique_id": "macro.dbt.copy_grants", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "copy_grants", "macro_sql": "{% macro copy_grants() %}\n    {{ return(adapter.dispatch('copy_grants', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.349797, "supported_languages": null}, "macro.dbt.default__copy_grants": {"unique_id": "macro.dbt.default__copy_grants", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__copy_grants", "macro_sql": "{% macro default__copy_grants() %}\n    {{ return(True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.349797, "supported_languages": null}, "macro.dbt.support_multiple_grantees_per_dcl_statement": {"unique_id": "macro.dbt.support_multiple_grantees_per_dcl_statement", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "support_multiple_grantees_per_dcl_statement", "macro_sql": "{% macro support_multiple_grantees_per_dcl_statement() %}\n    {{ return(adapter.dispatch('support_multiple_grantees_per_dcl_statement', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3507967, "supported_languages": null}, "macro.dbt.default__support_multiple_grantees_per_dcl_statement": {"unique_id": "macro.dbt.default__support_multiple_grantees_per_dcl_statement", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro default__support_multiple_grantees_per_dcl_statement() -%}\n    {{ return(True) }}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3507967, "supported_languages": null}, "macro.dbt.should_revoke": {"unique_id": "macro.dbt.should_revoke", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "should_revoke", "macro_sql": "{% macro should_revoke(existing_relation, full_refresh_mode=True) %}\n\n    {% if not existing_relation %}\n        {#-- The table doesn't already exist, so no grants to copy over --#}\n        {{ return(False) }}\n    {% elif full_refresh_mode %}\n        {#-- The object is being REPLACED -- whether grants are copied over depends on the value of user config --#}\n        {{ return(copy_grants()) }}\n    {% else %}\n        {#-- The table is being merged/upserted/inserted -- grants will be carried over --#}\n        {{ return(True) }}\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3507967, "supported_languages": null}, "macro.dbt.get_show_grant_sql": {"unique_id": "macro.dbt.get_show_grant_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "get_show_grant_sql", "macro_sql": "{% macro get_show_grant_sql(relation) %}\n    {{ return(adapter.dispatch(\"get_show_grant_sql\", \"dbt\")(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_show_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.351797, "supported_languages": null}, "macro.dbt.default__get_show_grant_sql": {"unique_id": "macro.dbt.default__get_show_grant_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__get_show_grant_sql", "macro_sql": "{% macro default__get_show_grant_sql(relation) %}\n    show grants on {{ relation }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.351797, "supported_languages": null}, "macro.dbt.get_grant_sql": {"unique_id": "macro.dbt.get_grant_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "get_grant_sql", "macro_sql": "{% macro get_grant_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_grant_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.351797, "supported_languages": null}, "macro.dbt.default__get_grant_sql": {"unique_id": "macro.dbt.default__get_grant_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__get_grant_sql", "macro_sql": "\n\n{%- macro default__get_grant_sql(relation, privilege, grantees) -%}\n    grant {{ privilege }} on {{ relation }} to {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.351797, "supported_languages": null}, "macro.dbt.get_revoke_sql": {"unique_id": "macro.dbt.get_revoke_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "get_revoke_sql", "macro_sql": "{% macro get_revoke_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_revoke_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_revoke_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.352797, "supported_languages": null}, "macro.dbt.default__get_revoke_sql": {"unique_id": "macro.dbt.default__get_revoke_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__get_revoke_sql", "macro_sql": "\n\n{%- macro default__get_revoke_sql(relation, privilege, grantees) -%}\n    revoke {{ privilege }} on {{ relation }} from {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.352797, "supported_languages": null}, "macro.dbt.get_dcl_statement_list": {"unique_id": "macro.dbt.get_dcl_statement_list", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "get_dcl_statement_list", "macro_sql": "{% macro get_dcl_statement_list(relation, grant_config, get_dcl_macro) %}\n    {{ return(adapter.dispatch('get_dcl_statement_list', 'dbt')(relation, grant_config, get_dcl_macro)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_dcl_statement_list"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.352797, "supported_languages": null}, "macro.dbt.default__get_dcl_statement_list": {"unique_id": "macro.dbt.default__get_dcl_statement_list", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__get_dcl_statement_list", "macro_sql": "\n\n{%- macro default__get_dcl_statement_list(relation, grant_config, get_dcl_macro) -%}\n    {#\n      -- Unpack grant_config into specific privileges and the set of users who need them granted/revoked.\n      -- Depending on whether this database supports multiple grantees per statement, pass in the list of\n      -- all grantees per privilege, or (if not) template one statement per privilege-grantee pair.\n      -- `get_dcl_macro` will be either `get_grant_sql` or `get_revoke_sql`\n    #}\n    {%- set dcl_statements = [] -%}\n    {%- for privilege, grantees in grant_config.items() %}\n        {%- if support_multiple_grantees_per_dcl_statement() and grantees -%}\n          {%- set dcl = get_dcl_macro(relation, privilege, grantees) -%}\n          {%- do dcl_statements.append(dcl) -%}\n        {%- else -%}\n          {%- for grantee in grantees -%}\n              {% set dcl = get_dcl_macro(relation, privilege, [grantee]) %}\n              {%- do dcl_statements.append(dcl) -%}\n          {% endfor -%}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return(dcl_statements) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.354797, "supported_languages": null}, "macro.dbt.call_dcl_statements": {"unique_id": "macro.dbt.call_dcl_statements", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "call_dcl_statements", "macro_sql": "{% macro call_dcl_statements(dcl_statement_list) %}\n    {{ return(adapter.dispatch(\"call_dcl_statements\", \"dbt\")(dcl_statement_list)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.354797, "supported_languages": null}, "macro.dbt.default__call_dcl_statements": {"unique_id": "macro.dbt.default__call_dcl_statements", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__call_dcl_statements", "macro_sql": "{% macro default__call_dcl_statements(dcl_statement_list) %}\n    {#\n      -- By default, supply all grant + revoke statements in a single semicolon-separated block,\n      -- so that they're all processed together.\n\n      -- Some databases do not support this. Those adapters will need to override this macro\n      -- to run each statement individually.\n    #}\n    {% call statement('grants') %}\n        {% for dcl_statement in dcl_statement_list %}\n            {{ dcl_statement }};\n        {% endfor %}\n    {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.354797, "supported_languages": null}, "macro.dbt.apply_grants": {"unique_id": "macro.dbt.apply_grants", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "apply_grants", "macro_sql": "{% macro apply_grants(relation, grant_config, should_revoke) %}\n    {{ return(adapter.dispatch(\"apply_grants\", \"dbt\")(relation, grant_config, should_revoke)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.355797, "supported_languages": null}, "macro.dbt.default__apply_grants": {"unique_id": "macro.dbt.default__apply_grants", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\apply_grants.sql", "original_file_path": "macros\\adapters\\apply_grants.sql", "name": "default__apply_grants", "macro_sql": "{% macro default__apply_grants(relation, grant_config, should_revoke=True) %}\n    {#-- If grant_config is {} or None, this is a no-op --#}\n    {% if grant_config %}\n        {% if should_revoke %}\n            {#-- We think previous grants may have carried over --#}\n            {#-- Show current grants and calculate diffs --#}\n            {% set current_grants_table = run_query(get_show_grant_sql(relation)) %}\n            {% set current_grants_dict = adapter.standardize_grants_dict(current_grants_table) %}\n            {% set needs_granting = diff_of_two_dicts(grant_config, current_grants_dict) %}\n            {% set needs_revoking = diff_of_two_dicts(current_grants_dict, grant_config) %}\n            {% if not (needs_granting or needs_revoking) %}\n                {{ log('On ' ~ relation ~': All grants are in place, no revocation or granting needed.')}}\n            {% endif %}\n        {% else %}\n            {#-- We don't think there's any chance of previous grants having carried over. --#}\n            {#-- Jump straight to granting what the user has configured. --#}\n            {% set needs_revoking = {} %}\n            {% set needs_granting = grant_config %}\n        {% endif %}\n        {% if needs_granting or needs_revoking %}\n            {% set revoke_statement_list = get_dcl_statement_list(relation, needs_revoking, get_revoke_sql) %}\n            {% set grant_statement_list = get_dcl_statement_list(relation, needs_granting, get_grant_sql) %}\n            {% set dcl_statement_list = revoke_statement_list + grant_statement_list %}\n            {% if dcl_statement_list %}\n                {{ call_dcl_statements(dcl_statement_list) }}\n            {% endif %}\n        {% endif %}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.get_show_grant_sql", "macro.dbt.get_dcl_statement_list", "macro.dbt.call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.356797, "supported_languages": null}, "macro.dbt.get_columns_in_relation": {"unique_id": "macro.dbt.get_columns_in_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3598745, "supported_languages": null}, "macro.dbt.default__get_columns_in_relation": {"unique_id": "macro.dbt.default__get_columns_in_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3598745, "supported_languages": null}, "macro.dbt.sql_convert_columns_in_relation": {"unique_id": "macro.dbt.sql_convert_columns_in_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3608737, "supported_languages": null}, "macro.dbt.get_columns_in_query": {"unique_id": "macro.dbt.get_columns_in_query", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3608737, "supported_languages": null}, "macro.dbt.default__get_columns_in_query": {"unique_id": "macro.dbt.default__get_columns_in_query", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        select * from (\n            {{ select_sql }}\n        ) as __dbt_sbq\n        where false\n        limit 0\n    {% endcall %}\n\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3618815, "supported_languages": null}, "macro.dbt.alter_column_type": {"unique_id": "macro.dbt.alter_column_type", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3618815, "supported_languages": null}, "macro.dbt.default__alter_column_type": {"unique_id": "macro.dbt.default__alter_column_type", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3628726, "supported_languages": null}, "macro.dbt.alter_relation_add_remove_columns": {"unique_id": "macro.dbt.alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3628726, "supported_languages": null}, "macro.dbt.default__alter_relation_add_remove_columns": {"unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% set sql -%}\n\n     alter {{ relation.type }} {{ relation }}\n\n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n\n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n\n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3648746, "supported_languages": null}, "macro.dbt.collect_freshness": {"unique_id": "macro.dbt.collect_freshness", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.365802, "supported_languages": null}, "macro.dbt.default__collect_freshness": {"unique_id": "macro.dbt.default__collect_freshness", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.366798, "supported_languages": null}, "macro.dbt.get_create_index_sql": {"unique_id": "macro.dbt.get_create_index_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.366798, "supported_languages": null}, "macro.dbt.default__get_create_index_sql": {"unique_id": "macro.dbt.default__get_create_index_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3678758, "supported_languages": null}, "macro.dbt.create_indexes": {"unique_id": "macro.dbt.create_indexes", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3678758, "supported_languages": null}, "macro.dbt.default__create_indexes": {"unique_id": "macro.dbt.default__create_indexes", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3688695, "supported_languages": null}, "macro.dbt.get_catalog": {"unique_id": "macro.dbt.get_catalog", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3708775, "supported_languages": null}, "macro.dbt.default__get_catalog": {"unique_id": "macro.dbt.default__get_catalog", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3708775, "supported_languages": null}, "macro.dbt.information_schema_name": {"unique_id": "macro.dbt.information_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3718846, "supported_languages": null}, "macro.dbt.default__information_schema_name": {"unique_id": "macro.dbt.default__information_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3718846, "supported_languages": null}, "macro.dbt.list_schemas": {"unique_id": "macro.dbt.list_schemas", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3718846, "supported_languages": null}, "macro.dbt.default__list_schemas": {"unique_id": "macro.dbt.default__list_schemas", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3728755, "supported_languages": null}, "macro.dbt.check_schema_exists": {"unique_id": "macro.dbt.check_schema_exists", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3728755, "supported_languages": null}, "macro.dbt.default__check_schema_exists": {"unique_id": "macro.dbt.default__check_schema_exists", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.37387, "supported_languages": null}, "macro.dbt.list_relations_without_caching": {"unique_id": "macro.dbt.list_relations_without_caching", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.37387, "supported_languages": null}, "macro.dbt.default__list_relations_without_caching": {"unique_id": "macro.dbt.default__list_relations_without_caching", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.37387, "supported_languages": null}, "macro.dbt.alter_column_comment": {"unique_id": "macro.dbt.alter_column_comment", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3748896, "supported_languages": null}, "macro.dbt.default__alter_column_comment": {"unique_id": "macro.dbt.default__alter_column_comment", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.375873, "supported_languages": null}, "macro.dbt.alter_relation_comment": {"unique_id": "macro.dbt.alter_relation_comment", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.375873, "supported_languages": null}, "macro.dbt.default__alter_relation_comment": {"unique_id": "macro.dbt.default__alter_relation_comment", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.375873, "supported_languages": null}, "macro.dbt.persist_docs": {"unique_id": "macro.dbt.persist_docs", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3769374, "supported_languages": null}, "macro.dbt.default__persist_docs": {"unique_id": "macro.dbt.default__persist_docs", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3778765, "supported_languages": null}, "macro.dbt.make_intermediate_relation": {"unique_id": "macro.dbt.make_intermediate_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "make_intermediate_relation", "macro_sql": "{% macro make_intermediate_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_intermediate_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_intermediate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3818722, "supported_languages": null}, "macro.dbt.default__make_intermediate_relation": {"unique_id": "macro.dbt.default__make_intermediate_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__make_intermediate_relation", "macro_sql": "{% macro default__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(default__make_temp_relation(base_relation, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3827994, "supported_languages": null}, "macro.dbt.make_temp_relation": {"unique_id": "macro.dbt.make_temp_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3827994, "supported_languages": null}, "macro.dbt.default__make_temp_relation": {"unique_id": "macro.dbt.default__make_temp_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {%- set temp_identifier = base_relation.identifier ~ suffix -%}\n    {%- set temp_relation = base_relation.incorporate(\n                                path={\"identifier\": temp_identifier}) -%}\n\n    {{ return(temp_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3827994, "supported_languages": null}, "macro.dbt.make_backup_relation": {"unique_id": "macro.dbt.make_backup_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "make_backup_relation", "macro_sql": "{% macro make_backup_relation(base_relation, backup_relation_type, suffix='__dbt_backup') %}\n    {{ return(adapter.dispatch('make_backup_relation', 'dbt')(base_relation, backup_relation_type, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_backup_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3838701, "supported_languages": null}, "macro.dbt.default__make_backup_relation": {"unique_id": "macro.dbt.default__make_backup_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__make_backup_relation", "macro_sql": "{% macro default__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {%- set backup_identifier = base_relation.identifier ~ suffix -%}\n    {%- set backup_relation = base_relation.incorporate(\n                                  path={\"identifier\": backup_identifier},\n                                  type=backup_relation_type\n    ) -%}\n    {{ return(backup_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3838701, "supported_languages": null}, "macro.dbt.drop_relation": {"unique_id": "macro.dbt.drop_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3848734, "supported_languages": null}, "macro.dbt.default__drop_relation": {"unique_id": "macro.dbt.default__drop_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3848734, "supported_languages": null}, "macro.dbt.truncate_relation": {"unique_id": "macro.dbt.truncate_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3848734, "supported_languages": null}, "macro.dbt.default__truncate_relation": {"unique_id": "macro.dbt.default__truncate_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3848734, "supported_languages": null}, "macro.dbt.rename_relation": {"unique_id": "macro.dbt.rename_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.385886, "supported_languages": null}, "macro.dbt.default__rename_relation": {"unique_id": "macro.dbt.default__rename_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.385886, "supported_languages": null}, "macro.dbt.get_or_create_relation": {"unique_id": "macro.dbt.get_or_create_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3868704, "supported_languages": null}, "macro.dbt.default__get_or_create_relation": {"unique_id": "macro.dbt.default__get_or_create_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3878748, "supported_languages": null}, "macro.dbt.load_cached_relation": {"unique_id": "macro.dbt.load_cached_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "load_cached_relation", "macro_sql": "{% macro load_cached_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3878748, "supported_languages": null}, "macro.dbt.load_relation": {"unique_id": "macro.dbt.load_relation", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "load_relation", "macro_sql": "{% macro load_relation(relation) %}\n    {{ return(load_cached_relation(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3878748, "supported_languages": null}, "macro.dbt.drop_relation_if_exists": {"unique_id": "macro.dbt.drop_relation_if_exists", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3878748, "supported_languages": null}, "macro.dbt.create_schema": {"unique_id": "macro.dbt.create_schema", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3888817, "supported_languages": null}, "macro.dbt.default__create_schema": {"unique_id": "macro.dbt.default__create_schema", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.389875, "supported_languages": null}, "macro.dbt.drop_schema": {"unique_id": "macro.dbt.drop_schema", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.389875, "supported_languages": null}, "macro.dbt.default__drop_schema": {"unique_id": "macro.dbt.default__drop_schema", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.389875, "supported_languages": null}, "macro.dbt.current_timestamp": {"unique_id": "macro.dbt.current_timestamp", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "current_timestamp", "macro_sql": "{%- macro current_timestamp() -%}\n    {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.390878, "supported_languages": null}, "macro.dbt.default__current_timestamp": {"unique_id": "macro.dbt.default__current_timestamp", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter ' + adapter.type()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.391871, "supported_languages": null}, "macro.dbt.snapshot_get_time": {"unique_id": "macro.dbt.snapshot_get_time", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "snapshot_get_time", "macro_sql": "\n\n{%- macro snapshot_get_time() -%}\n    {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.391871, "supported_languages": null}, "macro.dbt.default__snapshot_get_time": {"unique_id": "macro.dbt.default__snapshot_get_time", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() %}\n    {{ current_timestamp() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.391871, "supported_languages": null}, "macro.dbt.current_timestamp_backcompat": {"unique_id": "macro.dbt.current_timestamp_backcompat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "current_timestamp_backcompat", "macro_sql": "{% macro current_timestamp_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.391871, "supported_languages": null}, "macro.dbt.default__current_timestamp_backcompat": {"unique_id": "macro.dbt.default__current_timestamp_backcompat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "default__current_timestamp_backcompat", "macro_sql": "{% macro default__current_timestamp_backcompat() %}\n    current_timestamp::timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.391871, "supported_languages": null}, "macro.dbt.current_timestamp_in_utc_backcompat": {"unique_id": "macro.dbt.current_timestamp_in_utc_backcompat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "current_timestamp_in_utc_backcompat", "macro_sql": "{% macro current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_in_utc_backcompat', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__current_timestamp_in_utc_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3928747, "supported_languages": null}, "macro.dbt.default__current_timestamp_in_utc_backcompat": {"unique_id": "macro.dbt.default__current_timestamp_in_utc_backcompat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\timestamps.sql", "original_file_path": "macros\\adapters\\timestamps.sql", "name": "default__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro default__current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.current_timestamp_backcompat", "macro.dbt.default__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3928747, "supported_languages": null}, "macro.dbt.convert_datetime": {"unique_id": "macro.dbt.convert_datetime", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3958802, "supported_languages": null}, "macro.dbt.dates_in_range": {"unique_id": "macro.dbt.dates_in_range", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.397881, "supported_languages": null}, "macro.dbt.partition_range": {"unique_id": "macro.dbt.partition_range", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3988013, "supported_languages": null}, "macro.dbt.py_current_timestring": {"unique_id": "macro.dbt.py_current_timestring", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.3988013, "supported_languages": null}, "macro.dbt.statement": {"unique_id": "macro.dbt.statement", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "statement", "macro_sql": "\n{%- macro statement(name=None, fetch_result=False, auto_begin=True, language='sql') -%}\n  {%- if execute: -%}\n    {%- set compiled_code = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime {} for node \"{}\"'.format(language, model['unique_id'])) }}\n      {{ write(compiled_code) }}\n    {%- endif -%}\n    {%- if language == 'sql'-%}\n      {%- set res, table = adapter.execute(compiled_code, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- elif language == 'python' -%}\n      {%- set res = submit_python_job(model, compiled_code) -%}\n      {#-- TODO: What should table be for python models? --#}\n      {%- set table = None -%}\n    {%- else -%}\n      {% do exceptions.raise_compiler_error(\"statement macro didn't get supported language\") %}\n    {%- endif -%}\n\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4018703, "supported_languages": null}, "macro.dbt.noop_statement": {"unique_id": "macro.dbt.noop_statement", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4028766, "supported_languages": null}, "macro.dbt.run_query": {"unique_id": "macro.dbt.run_query", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4028766, "supported_languages": null}, "macro.dbt.default__test_accepted_values": {"unique_id": "macro.dbt.default__test_accepted_values", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\accepted_values.sql", "original_file_path": "macros\\generic_test_sql\\accepted_values.sql", "name": "default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4038806, "supported_languages": null}, "macro.dbt.default__test_not_null": {"unique_id": "macro.dbt.default__test_not_null", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\not_null.sql", "original_file_path": "macros\\generic_test_sql\\not_null.sql", "name": "default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else column_name %}\n\nselect {{ column_list }}\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4048724, "supported_languages": null}, "macro.dbt.default__test_relationships": {"unique_id": "macro.dbt.default__test_relationships", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\relationships.sql", "original_file_path": "macros\\generic_test_sql\\relationships.sql", "name": "default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4058766, "supported_languages": null}, "macro.dbt.default__test_unique": {"unique_id": "macro.dbt.default__test_unique", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\unique.sql", "original_file_path": "macros\\generic_test_sql\\unique.sql", "name": "default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4058766, "supported_languages": null}, "macro.dbt.generate_alias_name": {"unique_id": "macro.dbt.generate_alias_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_alias.sql", "original_file_path": "macros\\get_custom_name\\get_custom_alias.sql", "name": "generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4068782, "supported_languages": null}, "macro.dbt.default__generate_alias_name": {"unique_id": "macro.dbt.default__generate_alias_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_alias.sql", "original_file_path": "macros\\get_custom_name\\get_custom_alias.sql", "name": "default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name is none -%}\n\n        {{ node.name }}\n\n    {%- else -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4068782, "supported_languages": null}, "macro.dbt.generate_database_name": {"unique_id": "macro.dbt.generate_database_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_database.sql", "original_file_path": "macros\\get_custom_name\\get_custom_database.sql", "name": "generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4088008, "supported_languages": null}, "macro.dbt.default__generate_database_name": {"unique_id": "macro.dbt.default__generate_database_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_database.sql", "original_file_path": "macros\\get_custom_name\\get_custom_database.sql", "name": "default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4098704, "supported_languages": null}, "macro.dbt.generate_schema_name": {"unique_id": "macro.dbt.generate_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.410881, "supported_languages": null}, "macro.dbt.default__generate_schema_name": {"unique_id": "macro.dbt.default__generate_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4118774, "supported_languages": null}, "macro.dbt.generate_schema_name_for_env": {"unique_id": "macro.dbt.generate_schema_name_for_env", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4128754, "supported_languages": null}, "macro.dbt.set_sql_header": {"unique_id": "macro.dbt.set_sql_header", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4137986, "supported_languages": null}, "macro.dbt.should_full_refresh": {"unique_id": "macro.dbt.should_full_refresh", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4137986, "supported_languages": null}, "macro.dbt.should_store_failures": {"unique_id": "macro.dbt.should_store_failures", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4148073, "supported_languages": null}, "macro.dbt.run_hooks": {"unique_id": "macro.dbt.run_hooks", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4167976, "supported_languages": null}, "macro.dbt.make_hook_config": {"unique_id": "macro.dbt.make_hook_config", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4167976, "supported_languages": null}, "macro.dbt.before_begin": {"unique_id": "macro.dbt.before_begin", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4167976, "supported_languages": null}, "macro.dbt.in_transaction": {"unique_id": "macro.dbt.in_transaction", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.417799, "supported_languages": null}, "macro.dbt.after_commit": {"unique_id": "macro.dbt.after_commit", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.417799, "supported_languages": null}, "macro.dbt.get_quoted_csv": {"unique_id": "macro.dbt.get_quoted_csv", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4197974, "supported_languages": null}, "macro.dbt.diff_columns": {"unique_id": "macro.dbt.diff_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n\n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4207976, "supported_languages": null}, "macro.dbt.diff_column_data_types": {"unique_id": "macro.dbt.diff_column_data_types", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type and not sc.can_expand_to(other_column=tc) %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4217975, "supported_languages": null}, "macro.dbt.get_merge_update_columns": {"unique_id": "macro.dbt.get_merge_update_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "get_merge_update_columns", "macro_sql": "{% macro get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {{ return(adapter.dispatch('get_merge_update_columns', 'dbt')(merge_update_columns, merge_exclude_columns, dest_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.422798, "supported_languages": null}, "macro.dbt.default__get_merge_update_columns": {"unique_id": "macro.dbt.default__get_merge_update_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "default__get_merge_update_columns", "macro_sql": "{% macro default__get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {%- set default_cols = dest_columns | map(attribute=\"quoted\") | list -%}\n\n  {%- if merge_update_columns and merge_exclude_columns -%}\n    {{ exceptions.raise_compiler_error(\n        'Model cannot specify merge_update_columns and merge_exclude_columns. Please update model to use only one config'\n    )}}\n  {%- elif merge_update_columns -%}\n    {%- set update_columns = merge_update_columns -%}\n  {%- elif merge_exclude_columns -%}\n    {%- set update_columns = [] -%}\n    {%- for column in dest_columns -%}\n      {% if column.column | lower not in merge_exclude_columns | map(\"lower\") | list %}\n        {%- do update_columns.append(column.quoted) -%}\n      {% endif %}\n    {%- endfor -%}\n  {%- else -%}\n    {%- set update_columns = default_cols -%}\n  {%- endif -%}\n\n  {{ return(update_columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4238083, "supported_languages": null}, "macro.dbt.materialization_incremental_default": {"unique_id": "macro.dbt.materialization_incremental_default", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\incremental.sql", "original_file_path": "macros\\materializations\\models\\incremental\\incremental.sql", "name": "materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  -- relations\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {%- set intermediate_relation = make_intermediate_relation(target_relation)-%}\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n\n  -- configs\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()  or existing_relation.is_view) -%}\n  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') -%}\n\n  -- the temp_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation)-%}\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n   -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = get_create_table_as_sql(False, target_relation, sql) %}\n  {% elif full_refresh_mode %}\n      {% set build_sql = get_create_table_as_sql(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n  {% else %}\n    {% do run_query(get_create_table_as_sql(True, temp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n             from_relation=temp_relation,\n             to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, temp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n\n    {#-- Get the incremental_strategy, the macro to use for the strategy, and build the sql --#}\n    {% set incremental_strategy = config.get('incremental_strategy') or 'default' %}\n    {% set incremental_predicates = config.get('incremental_predicates', none) %}\n    {% set strategy_sql_macro_func = adapter.get_incremental_strategy_macro(context, incremental_strategy) %}\n    {% set strategy_arg_dict = ({'target_relation': target_relation, 'temp_relation': temp_relation, 'unique_key': unique_key, 'dest_columns': dest_columns, 'predicates': incremental_predicates }) %}\n    {% set build_sql = strategy_sql_macro_func(strategy_arg_dict) %}\n\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %}\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% do adapter.rename_relation(intermediate_relation, target_relation) %}\n      {% do to_drop.append(backup_relation) %}\n  {% endif %}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_temp_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.get_create_table_as_sql", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4327977, "supported_languages": ["sql"]}, "macro.dbt.is_incremental": {"unique_id": "macro.dbt.is_incremental", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\is_incremental.sql", "original_file_path": "macros\\materializations\\models\\incremental\\is_incremental.sql", "name": "is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.434798, "supported_languages": null}, "macro.dbt.get_merge_sql": {"unique_id": "macro.dbt.get_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, predicates=none) -%}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, predicates) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4437985, "supported_languages": null}, "macro.dbt.default__get_merge_sql": {"unique_id": "macro.dbt.default__get_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set merge_update_columns = config.get('merge_update_columns') -%}\n    {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}\n    {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set unique_key_match %}\n                DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n            {% endset %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{ predicates | join(' and ') }}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4468005, "supported_languages": null}, "macro.dbt.get_delete_insert_merge_sql": {"unique_id": "macro.dbt.get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4478, "supported_languages": null}, "macro.dbt.default__get_delete_insert_merge_sql": {"unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not string %}\n            delete from {{target }}\n            using {{ source }}\n            where (\n                {% for key in unique_key %}\n                    {{ source }}.{{ key }} = {{ target }}.{{ key }}\n                    {{ \"and \" if not loop.last }}\n                {% endfor %}\n            );\n        {% else %}\n            delete from {{ target }}\n            where (\n                {{ unique_key }}) in (\n                select ({{ unique_key }})\n                from {{ source }}\n            );\n\n        {% endif %}\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4487972, "supported_languages": null}, "macro.dbt.get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4497995, "supported_languages": null}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {#-- The only time include_sql_header is True: --#}\n    {#-- BigQuery + insert_overwrite strategy + \"static\" partitions config --#}\n    {#-- We should consider including the sql header at the materialization level instead --#}\n\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4508705, "supported_languages": null}, "macro.dbt.incremental_validate_on_schema_change": {"unique_id": "macro.dbt.incremental_validate_on_schema_change", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n\n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n\n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n\n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n\n   {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.457799, "supported_languages": null}, "macro.dbt.check_for_schema_changes": {"unique_id": "macro.dbt.check_for_schema_changes", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n\n  {% set schema_changed = False %}\n\n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n\n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4587986, "supported_languages": null}, "macro.dbt.sync_column_schemas": {"unique_id": "macro.dbt.sync_column_schemas", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n\n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n\n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n\n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(schema_change_message) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4607987, "supported_languages": null}, "macro.dbt.process_schema_changes": {"unique_id": "macro.dbt.process_schema_changes", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n\n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n\n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n\n      {% if schema_changes_dict['schema_changed'] %}\n\n        {% if on_schema_change == 'fail' %}\n\n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways:\n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n\n              Additional troubleshooting context:\n                 Source columns not in target: {{ schema_changes_dict['source_not_in_target'] }}\n                 Target columns not in source: {{ schema_changes_dict['target_not_in_source'] }}\n                 New column types: {{ schema_changes_dict['new_target_types'] }}\n          {% endset %}\n\n          {% do exceptions.raise_compiler_error(fail_msg) %}\n\n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n\n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n        {% endif %}\n\n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4627984, "supported_languages": null}, "macro.dbt.get_incremental_append_sql": {"unique_id": "macro.dbt.get_incremental_append_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "get_incremental_append_sql", "macro_sql": "{% macro get_incremental_append_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_append_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.463799, "supported_languages": null}, "macro.dbt.default__get_incremental_append_sql": {"unique_id": "macro.dbt.default__get_incremental_append_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "default__get_incremental_append_sql", "macro_sql": "{% macro default__get_incremental_append_sql(arg_dict) %}\n\n  {% do return(get_insert_into_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"])) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_insert_into_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.463799, "supported_languages": null}, "macro.dbt.get_incremental_delete_insert_sql": {"unique_id": "macro.dbt.get_incremental_delete_insert_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "get_incremental_delete_insert_sql", "macro_sql": "{% macro get_incremental_delete_insert_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_delete_insert_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_incremental_delete_insert_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.464799, "supported_languages": null}, "macro.dbt.default__get_incremental_delete_insert_sql": {"unique_id": "macro.dbt.default__get_incremental_delete_insert_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "default__get_incremental_delete_insert_sql", "macro_sql": "{% macro default__get_incremental_delete_insert_sql(arg_dict) %}\n\n  {% do return(get_delete_insert_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"])) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.464799, "supported_languages": null}, "macro.dbt.get_incremental_merge_sql": {"unique_id": "macro.dbt.get_incremental_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "get_incremental_merge_sql", "macro_sql": "{% macro get_incremental_merge_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_merge_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_incremental_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.465798, "supported_languages": null}, "macro.dbt.default__get_incremental_merge_sql": {"unique_id": "macro.dbt.default__get_incremental_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "default__get_incremental_merge_sql", "macro_sql": "{% macro default__get_incremental_merge_sql(arg_dict) %}\n\n  {% do return(get_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"])) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.465798, "supported_languages": null}, "macro.dbt.get_incremental_insert_overwrite_sql": {"unique_id": "macro.dbt.get_incremental_insert_overwrite_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "get_incremental_insert_overwrite_sql", "macro_sql": "{% macro get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_insert_overwrite_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_incremental_insert_overwrite_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.466799, "supported_languages": null}, "macro.dbt.default__get_incremental_insert_overwrite_sql": {"unique_id": "macro.dbt.default__get_incremental_insert_overwrite_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "default__get_incremental_insert_overwrite_sql", "macro_sql": "{% macro default__get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {% do return(get_insert_overwrite_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"], arg_dict[\"predicates\"])) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.466799, "supported_languages": null}, "macro.dbt.get_incremental_default_sql": {"unique_id": "macro.dbt.get_incremental_default_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "get_incremental_default_sql", "macro_sql": "{% macro get_incremental_default_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_default_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_incremental_default_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.466799, "supported_languages": null}, "macro.dbt.default__get_incremental_default_sql": {"unique_id": "macro.dbt.default__get_incremental_default_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "default__get_incremental_default_sql", "macro_sql": "{% macro default__get_incremental_default_sql(arg_dict) %}\n\n  {% do return(get_incremental_append_sql(arg_dict)) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.466799, "supported_languages": null}, "macro.dbt.get_insert_into_sql": {"unique_id": "macro.dbt.get_insert_into_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\strategies.sql", "original_file_path": "macros\\materializations\\models\\incremental\\strategies.sql", "name": "get_insert_into_sql", "macro_sql": "{% macro get_insert_into_sql(target_relation, temp_relation, dest_columns) %}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    insert into {{ target_relation }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ temp_relation }}\n    )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.467799, "supported_languages": null}, "macro.dbt.get_create_table_as_sql": {"unique_id": "macro.dbt.get_create_table_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.468802, "supported_languages": null}, "macro.dbt.default__get_create_table_as_sql": {"unique_id": "macro.dbt.default__get_create_table_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.468802, "supported_languages": null}, "macro.dbt.create_table_as": {"unique_id": "macro.dbt.create_table_as", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, compiled_code, language='sql') -%}\n  {# backward compatibility for create_table_as that does not support language #}\n  {% if language == \"sql\" %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code)}}\n  {% else %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code, language) }}\n  {% endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4697995, "supported_languages": null}, "macro.dbt.default__create_table_as": {"unique_id": "macro.dbt.default__create_table_as", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4707992, "supported_languages": null}, "macro.dbt.materialization_table_default": {"unique_id": "macro.dbt.materialization_table_default", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\table.sql", "original_file_path": "macros\\materializations\\models\\table\\table.sql", "name": "materialization_table_default", "macro_sql": "{% materialization table, default %}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') %}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if existing_relation is not none %}\n      {{ adapter.rename_relation(existing_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4747987, "supported_languages": ["sql"]}, "macro.dbt.create_or_replace_view": {"unique_id": "macro.dbt.create_or_replace_view", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_or_replace_view.sql", "original_file_path": "macros\\materializations\\models\\view\\create_or_replace_view.sql", "name": "create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {% set should_revoke = should_revoke(exists_as_view, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=True) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.476799, "supported_languages": null}, "macro.dbt.get_create_view_as_sql": {"unique_id": "macro.dbt.get_create_view_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4777992, "supported_languages": null}, "macro.dbt.default__get_create_view_as_sql": {"unique_id": "macro.dbt.default__get_create_view_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4777992, "supported_languages": null}, "macro.dbt.create_view_as": {"unique_id": "macro.dbt.create_view_as", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4787996, "supported_languages": null}, "macro.dbt.default__create_view_as": {"unique_id": "macro.dbt.default__create_view_as", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }} as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4787996, "supported_languages": null}, "macro.dbt.handle_existing_table": {"unique_id": "macro.dbt.handle_existing_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\helpers.sql", "original_file_path": "macros\\materializations\\models\\view\\helpers.sql", "name": "handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4797993, "supported_languages": null}, "macro.dbt.default__handle_existing_table": {"unique_id": "macro.dbt.default__handle_existing_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\helpers.sql", "original_file_path": "macros\\materializations\\models\\view\\helpers.sql", "name": "default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4797993, "supported_languages": null}, "macro.dbt.materialization_view_default": {"unique_id": "macro.dbt.materialization_view_default", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\view.sql", "original_file_path": "macros\\materializations\\models\\view\\view.sql", "name": "materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='view') -%}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"existing_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the existing_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the existing_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if existing_relation is not none %}\n    {{ adapter.rename_relation(existing_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4847987, "supported_languages": ["sql"]}, "macro.dbt.create_csv_table": {"unique_id": "macro.dbt.create_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4907992, "supported_languages": null}, "macro.dbt.default__create_csv_table": {"unique_id": "macro.dbt.default__create_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4917989, "supported_languages": null}, "macro.dbt.reset_csv_table": {"unique_id": "macro.dbt.reset_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.492799, "supported_languages": null}, "macro.dbt.default__reset_csv_table": {"unique_id": "macro.dbt.default__reset_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.492799, "supported_languages": null}, "macro.dbt.get_csv_sql": {"unique_id": "macro.dbt.get_csv_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_csv_sql", "macro_sql": "{% macro get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ adapter.dispatch('get_csv_sql', 'dbt')(create_or_truncate_sql, insert_sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_csv_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.493799, "supported_languages": null}, "macro.dbt.default__get_csv_sql": {"unique_id": "macro.dbt.default__get_csv_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_csv_sql", "macro_sql": "{% macro default__get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ create_or_truncate_sql }};\n    -- dbt seed --\n    {{ insert_sql }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.493799, "supported_languages": null}, "macro.dbt.get_binding_char": {"unique_id": "macro.dbt.get_binding_char", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.493799, "supported_languages": null}, "macro.dbt.default__get_binding_char": {"unique_id": "macro.dbt.default__get_binding_char", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.493799, "supported_languages": null}, "macro.dbt.get_batch_size": {"unique_id": "macro.dbt.get_batch_size", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4947991, "supported_languages": null}, "macro.dbt.default__get_batch_size": {"unique_id": "macro.dbt.default__get_batch_size", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4947991, "supported_languages": null}, "macro.dbt.get_seed_column_quoted_csv": {"unique_id": "macro.dbt.get_seed_column_quoted_csv", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4957998, "supported_languages": null}, "macro.dbt.load_csv_rows": {"unique_id": "macro.dbt.load_csv_rows", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.4957998, "supported_languages": null}, "macro.dbt.default__load_csv_rows": {"unique_id": "macro.dbt.default__load_csv_rows", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.497799, "supported_languages": null}, "macro.dbt.materialization_seed_default": {"unique_id": "macro.dbt.materialization_seed_default", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\seed.sql", "original_file_path": "macros\\materializations\\seeds\\seed.sql", "name": "materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set grant_config = config.get('grants') -%}\n  {%- set agate_table = load_agate_table() -%}\n  -- grab current tables grants config for comparision later on\n\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ get_csv_sql(create_table_sql, sql) }};\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n\n  {% set should_revoke = should_revoke(old_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.get_csv_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.502799, "supported_languages": ["sql"]}, "macro.dbt.create_columns": {"unique_id": "macro.dbt.create_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5077987, "supported_languages": null}, "macro.dbt.default__create_columns": {"unique_id": "macro.dbt.default__create_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5087993, "supported_languages": null}, "macro.dbt.post_snapshot": {"unique_id": "macro.dbt.post_snapshot", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5087993, "supported_languages": null}, "macro.dbt.default__post_snapshot": {"unique_id": "macro.dbt.default__post_snapshot", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5087993, "supported_languages": null}, "macro.dbt.get_true_sql": {"unique_id": "macro.dbt.get_true_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "get_true_sql", "macro_sql": "{% macro get_true_sql() %}\n  {{ adapter.dispatch('get_true_sql', 'dbt')() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_true_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5087993, "supported_languages": null}, "macro.dbt.default__get_true_sql": {"unique_id": "macro.dbt.default__get_true_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__get_true_sql", "macro_sql": "{% macro default__get_true_sql() %}\n    {{ return('TRUE') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5087993, "supported_languages": null}, "macro.dbt.snapshot_staging_table": {"unique_id": "macro.dbt.snapshot_staging_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5097992, "supported_languages": null}, "macro.dbt.default__snapshot_staging_table": {"unique_id": "macro.dbt.default__snapshot_staging_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n\n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n\n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.510799, "supported_languages": null}, "macro.dbt.build_snapshot_table": {"unique_id": "macro.dbt.build_snapshot_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5117989, "supported_languages": null}, "macro.dbt.default__build_snapshot_table": {"unique_id": "macro.dbt.default__build_snapshot_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5117989, "supported_languages": null}, "macro.dbt.build_snapshot_staging_table": {"unique_id": "macro.dbt.build_snapshot_staging_table", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set temp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, temp_relation, select) }}\n    {% endcall %}\n\n    {% do return(temp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.512799, "supported_languages": null}, "macro.dbt.materialization_snapshot_default": {"unique_id": "macro.dbt.materialization_snapshot_default", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot.sql", "name": "materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n  -- grab current tables grants config for comparision later on\n  {%- set grant_config = config.get('grants') -%}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_code']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% set should_revoke = should_revoke(target_relation_exists, full_refresh_mode=False) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5237975, "supported_languages": ["sql"]}, "macro.dbt.snapshot_merge_sql": {"unique_id": "macro.dbt.snapshot_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "name": "snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5247974, "supported_languages": null}, "macro.dbt.default__snapshot_merge_sql": {"unique_id": "macro.dbt.default__snapshot_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "name": "default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5257978, "supported_languages": null}, "macro.dbt.strategy_dispatch": {"unique_id": "macro.dbt.strategy_dispatch", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.529797, "supported_languages": null}, "macro.dbt.snapshot_hash_arguments": {"unique_id": "macro.dbt.snapshot_hash_arguments", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5308075, "supported_languages": null}, "macro.dbt.default__snapshot_hash_arguments": {"unique_id": "macro.dbt.default__snapshot_hash_arguments", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5308075, "supported_languages": null}, "macro.dbt.snapshot_timestamp_strategy": {"unique_id": "macro.dbt.snapshot_timestamp_strategy", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5318062, "supported_languages": null}, "macro.dbt.snapshot_string_as_time": {"unique_id": "macro.dbt.snapshot_string_as_time", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5318062, "supported_languages": null}, "macro.dbt.default__snapshot_string_as_time": {"unique_id": "macro.dbt.default__snapshot_string_as_time", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.532799, "supported_languages": null}, "macro.dbt.snapshot_check_all_get_existing_columns": {"unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) -%}\n    {%- if not target_exists -%}\n        {#-- no table yet -> return whatever the query does --#}\n        {{ return((false, query_columns)) }}\n    {%- endif -%}\n\n    {#-- handle any schema changes --#}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=node.alias) -%}\n\n    {% if check_cols_config == 'all' %}\n        {%- set query_columns = get_columns_in_query(node['compiled_code']) -%}\n\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {#-- query for proper casing/quoting, to support comparison below --#}\n        {%- set select_check_cols_from_target -%}\n          select {{ check_cols_config | join(', ') }} from ({{ node['compiled_code'] }}) subq\n        {%- endset -%}\n        {% set query_columns = get_columns_in_query(select_check_cols_from_target) %}\n\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set existing_cols = adapter.get_columns_in_relation(target_relation) | map(attribute = 'name') | list -%}\n    {%- set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(adapter.quote(col)) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return((ns.column_added, intersection)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.53481, "supported_languages": null}, "macro.dbt.snapshot_check_strategy": {"unique_id": "macro.dbt.snapshot_check_strategy", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    {% set updated_at = config.get('updated_at', snapshot_get_time()) %}\n\n    {% set column_added = false %}\n\n    {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        {{ get_true_sql() }}\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.get_true_sql", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5368068, "supported_languages": null}, "macro.dbt.get_test_sql": {"unique_id": "macro.dbt.get_test_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\helpers.sql", "original_file_path": "macros\\materializations\\tests\\helpers.sql", "name": "get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.53781, "supported_languages": null}, "macro.dbt.default__get_test_sql": {"unique_id": "macro.dbt.default__get_test_sql", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\helpers.sql", "original_file_path": "macros\\materializations\\tests\\helpers.sql", "name": "default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.53781, "supported_languages": null}, "macro.dbt.materialization_test_default": {"unique_id": "macro.dbt.materialization_test_default", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\test.sql", "original_file_path": "macros\\materializations\\tests\\test.sql", "name": "materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type='table') -%} %}\n\n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n\n    {% call statement(auto_begin=True) %}\n        {{ create_table_as(False, target_relation, sql) }}\n    {% endcall %}\n\n    {% do relations.append(target_relation) %}\n\n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n\n    {{ adapter.commit() }}\n\n  {% else %}\n\n      {% set main_sql = sql %}\n\n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5408063, "supported_languages": ["sql"]}, "macro.dbt.get_where_subquery": {"unique_id": "macro.dbt.get_where_subquery", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\where_subquery.sql", "original_file_path": "macros\\materializations\\tests\\where_subquery.sql", "name": "get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5418067, "supported_languages": null}, "macro.dbt.default__get_where_subquery": {"unique_id": "macro.dbt.default__get_where_subquery", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\where_subquery.sql", "original_file_path": "macros\\materializations\\tests\\where_subquery.sql", "name": "default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.542807, "supported_languages": null}, "macro.dbt.build_ref_function": {"unique_id": "macro.dbt.build_ref_function", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\python_model\\python.sql", "original_file_path": "macros\\python_model\\python.sql", "name": "build_ref_function", "macro_sql": "{% macro build_ref_function(model) %}\n\n    {%- set ref_dict = {} -%}\n    {%- for _ref in model.refs -%}\n        {%- set resolved = ref(*_ref) -%}\n        {%- do ref_dict.update({_ref | join(\".\"): resolved.quote(database=False, schema=False, identifier=False) | string}) -%}\n    {%- endfor -%}\n\ndef ref(*args,dbt_load_df_function):\n    refs = {{ ref_dict | tojson }}\n    key = \".\".join(args)\n    return dbt_load_df_function(refs[key])\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5448065, "supported_languages": null}, "macro.dbt.build_source_function": {"unique_id": "macro.dbt.build_source_function", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\python_model\\python.sql", "original_file_path": "macros\\python_model\\python.sql", "name": "build_source_function", "macro_sql": "{% macro build_source_function(model) %}\n\n    {%- set source_dict = {} -%}\n    {%- for _source in model.sources -%}\n        {%- set resolved = source(*_source) -%}\n        {%- do source_dict.update({_source | join(\".\"): resolved.quote(database=False, schema=False, identifier=False) | string}) -%}\n    {%- endfor -%}\n\ndef source(*args, dbt_load_df_function):\n    sources = {{ source_dict | tojson }}\n    key = \".\".join(args)\n    return dbt_load_df_function(sources[key])\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5448065, "supported_languages": null}, "macro.dbt.build_config_dict": {"unique_id": "macro.dbt.build_config_dict", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\python_model\\python.sql", "original_file_path": "macros\\python_model\\python.sql", "name": "build_config_dict", "macro_sql": "{% macro build_config_dict(model) %}\n    {%- set config_dict = {} -%}\n    {%- for key in model.config.config_keys_used -%}\n        {# weird type testing with enum, would be much easier to write this logic in Python! #}\n        {%- if key == 'language' -%}\n          {%- set value = 'python' -%}\n        {%- endif -%}\n        {%- set value = model.config[key] -%}\n        {%- do config_dict.update({key: value}) -%}\n    {%- endfor -%}\nconfig_dict = {{ config_dict }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5458698, "supported_languages": null}, "macro.dbt.py_script_postfix": {"unique_id": "macro.dbt.py_script_postfix", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\python_model\\python.sql", "original_file_path": "macros\\python_model\\python.sql", "name": "py_script_postfix", "macro_sql": "{% macro py_script_postfix(model) %}\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\n{{ build_ref_function(model ) }}\n{{ build_source_function(model ) }}\n{{ build_config_dict(model) }}\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = '{{ this.database }}'\n    schema = '{{ this.schema }}'\n    identifier = '{{ this.identifier }}'\n    def __repr__(self):\n        return '{{ this }}'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args: ref(*args, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = {{ is_incremental() }}\n\n# COMMAND ----------\n{{py_script_comment()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.build_ref_function", "macro.dbt.build_source_function", "macro.dbt.build_config_dict", "macro.dbt.is_incremental", "macro.dbt.py_script_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.54687, "supported_languages": null}, "macro.dbt.py_script_comment": {"unique_id": "macro.dbt.py_script_comment", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\python_model\\python.sql", "original_file_path": "macros\\python_model\\python.sql", "name": "py_script_comment", "macro_sql": "{%macro py_script_comment()%}\n{%endmacro%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.54687, "supported_languages": null}, "macro.dbt.any_value": {"unique_id": "macro.dbt.any_value", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\any_value.sql", "original_file_path": "macros\\utils\\any_value.sql", "name": "any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__any_value"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.54687, "supported_languages": null}, "macro.dbt.default__any_value": {"unique_id": "macro.dbt.default__any_value", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\any_value.sql", "original_file_path": "macros\\utils\\any_value.sql", "name": "default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n\n    any_value({{ expression }})\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.547882, "supported_languages": null}, "macro.dbt.array_append": {"unique_id": "macro.dbt.array_append", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\array_append.sql", "original_file_path": "macros\\utils\\array_append.sql", "name": "array_append", "macro_sql": "{% macro array_append(array, new_element) -%}\n  {{ return(adapter.dispatch('array_append', 'dbt')(array, new_element)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__array_append"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.547882, "supported_languages": null}, "macro.dbt.default__array_append": {"unique_id": "macro.dbt.default__array_append", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\array_append.sql", "original_file_path": "macros\\utils\\array_append.sql", "name": "default__array_append", "macro_sql": "{% macro default__array_append(array, new_element) -%}\n    array_append({{ array }}, {{ new_element }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.547882, "supported_languages": null}, "macro.dbt.array_concat": {"unique_id": "macro.dbt.array_concat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\array_concat.sql", "original_file_path": "macros\\utils\\array_concat.sql", "name": "array_concat", "macro_sql": "{% macro array_concat(array_1, array_2) -%}\n  {{ return(adapter.dispatch('array_concat', 'dbt')(array_1, array_2)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__array_concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5488007, "supported_languages": null}, "macro.dbt.default__array_concat": {"unique_id": "macro.dbt.default__array_concat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\array_concat.sql", "original_file_path": "macros\\utils\\array_concat.sql", "name": "default__array_concat", "macro_sql": "{% macro default__array_concat(array_1, array_2) -%}\n    array_cat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5488007, "supported_languages": null}, "macro.dbt.array_construct": {"unique_id": "macro.dbt.array_construct", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\array_construct.sql", "original_file_path": "macros\\utils\\array_construct.sql", "name": "array_construct", "macro_sql": "{% macro array_construct(inputs=[], data_type=api.Column.translate_type('integer')) -%}\n  {{ return(adapter.dispatch('array_construct', 'dbt')(inputs, data_type)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__array_construct"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.549799, "supported_languages": null}, "macro.dbt.default__array_construct": {"unique_id": "macro.dbt.default__array_construct", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\array_construct.sql", "original_file_path": "macros\\utils\\array_construct.sql", "name": "default__array_construct", "macro_sql": "{% macro default__array_construct(inputs, data_type) -%}\n    {% if inputs|length > 0 %}\n    array[ {{ inputs|join(' , ') }} ]\n    {% else %}\n    array[]::{{data_type}}[]\n    {% endif %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5508687, "supported_languages": null}, "macro.dbt.bool_or": {"unique_id": "macro.dbt.bool_or", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\bool_or.sql", "original_file_path": "macros\\utils\\bool_or.sql", "name": "bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5508687, "supported_languages": null}, "macro.dbt.default__bool_or": {"unique_id": "macro.dbt.default__bool_or", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\bool_or.sql", "original_file_path": "macros\\utils\\bool_or.sql", "name": "default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n\n    bool_or({{ expression }})\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5518718, "supported_languages": null}, "macro.dbt.cast_bool_to_text": {"unique_id": "macro.dbt.cast_bool_to_text", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\cast_bool_to_text.sql", "original_file_path": "macros\\utils\\cast_bool_to_text.sql", "name": "cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt') (field) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5518718, "supported_languages": null}, "macro.dbt.default__cast_bool_to_text": {"unique_id": "macro.dbt.default__cast_bool_to_text", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\cast_bool_to_text.sql", "original_file_path": "macros\\utils\\cast_bool_to_text.sql", "name": "default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ api.Column.translate_type('string') }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5518718, "supported_languages": null}, "macro.dbt.concat": {"unique_id": "macro.dbt.concat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\concat.sql", "original_file_path": "macros\\utils\\concat.sql", "name": "concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt')(fields)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.552875, "supported_languages": null}, "macro.dbt.default__concat": {"unique_id": "macro.dbt.default__concat", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\concat.sql", "original_file_path": "macros\\utils\\concat.sql", "name": "default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.552875, "supported_languages": null}, "macro.dbt.type_string": {"unique_id": "macro.dbt.type_string", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5548723, "supported_languages": null}, "macro.dbt.default__type_string": {"unique_id": "macro.dbt.default__type_string", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_string", "macro_sql": "{% macro default__type_string() %}\n    {{ return(api.Column.translate_type(\"string\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5548723, "supported_languages": null}, "macro.dbt.type_timestamp": {"unique_id": "macro.dbt.type_timestamp", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5548723, "supported_languages": null}, "macro.dbt.default__type_timestamp": {"unique_id": "macro.dbt.default__type_timestamp", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    {{ return(api.Column.translate_type(\"timestamp\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5548723, "supported_languages": null}, "macro.dbt.type_float": {"unique_id": "macro.dbt.type_float", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__type_float"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5559285, "supported_languages": null}, "macro.dbt.default__type_float": {"unique_id": "macro.dbt.default__type_float", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_float", "macro_sql": "{% macro default__type_float() %}\n    {{ return(api.Column.translate_type(\"float\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5559285, "supported_languages": null}, "macro.dbt.type_numeric": {"unique_id": "macro.dbt.type_numeric", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5559285, "supported_languages": null}, "macro.dbt.default__type_numeric": {"unique_id": "macro.dbt.default__type_numeric", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    {{ return(api.Column.numeric_type(\"numeric\", 28, 6)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5568733, "supported_languages": null}, "macro.dbt.type_bigint": {"unique_id": "macro.dbt.type_bigint", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5568733, "supported_languages": null}, "macro.dbt.default__type_bigint": {"unique_id": "macro.dbt.default__type_bigint", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    {{ return(api.Column.translate_type(\"bigint\")) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5568733, "supported_languages": null}, "macro.dbt.type_int": {"unique_id": "macro.dbt.type_int", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5568733, "supported_languages": null}, "macro.dbt.default__type_int": {"unique_id": "macro.dbt.default__type_int", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_int", "macro_sql": "{%- macro default__type_int() -%}\n  {{ return(api.Column.translate_type(\"integer\")) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5568733, "supported_languages": null}, "macro.dbt.type_boolean": {"unique_id": "macro.dbt.type_boolean", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "type_boolean", "macro_sql": "\n\n{%- macro type_boolean() -%}\n  {{ return(adapter.dispatch('type_boolean', 'dbt')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__type_boolean"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5578842, "supported_languages": null}, "macro.dbt.default__type_boolean": {"unique_id": "macro.dbt.default__type_boolean", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\data_types.sql", "original_file_path": "macros\\utils\\data_types.sql", "name": "default__type_boolean", "macro_sql": "{%- macro default__type_boolean() -%}\n  {{ return(api.Column.translate_type(\"boolean\")) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5578842, "supported_languages": null}, "macro.dbt.dateadd": {"unique_id": "macro.dbt.dateadd", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\dateadd.sql", "original_file_path": "macros\\utils\\dateadd.sql", "name": "dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.558877, "supported_languages": null}, "macro.dbt.default__dateadd": {"unique_id": "macro.dbt.default__dateadd", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\dateadd.sql", "original_file_path": "macros\\utils\\dateadd.sql", "name": "default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.558877, "supported_languages": null}, "macro.dbt.datediff": {"unique_id": "macro.dbt.datediff", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\datediff.sql", "original_file_path": "macros\\utils\\datediff.sql", "name": "datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt')(first_date, second_date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5598736, "supported_languages": null}, "macro.dbt.default__datediff": {"unique_id": "macro.dbt.default__datediff", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\datediff.sql", "original_file_path": "macros\\utils\\datediff.sql", "name": "default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) -%}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5598736, "supported_languages": null}, "macro.dbt.date_trunc": {"unique_id": "macro.dbt.date_trunc", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\date_trunc.sql", "original_file_path": "macros\\utils\\date_trunc.sql", "name": "date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt') (datepart, date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5608768, "supported_languages": null}, "macro.dbt.default__date_trunc": {"unique_id": "macro.dbt.default__date_trunc", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\date_trunc.sql", "original_file_path": "macros\\utils\\date_trunc.sql", "name": "default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5608768, "supported_languages": null}, "macro.dbt.escape_single_quotes": {"unique_id": "macro.dbt.escape_single_quotes", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\escape_single_quotes.sql", "original_file_path": "macros\\utils\\escape_single_quotes.sql", "name": "escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5618875, "supported_languages": null}, "macro.dbt.default__escape_single_quotes": {"unique_id": "macro.dbt.default__escape_single_quotes", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\escape_single_quotes.sql", "original_file_path": "macros\\utils\\escape_single_quotes.sql", "name": "default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5618875, "supported_languages": null}, "macro.dbt.except": {"unique_id": "macro.dbt.except", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\except.sql", "original_file_path": "macros\\utils\\except.sql", "name": "except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5618875, "supported_languages": null}, "macro.dbt.default__except": {"unique_id": "macro.dbt.default__except", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\except.sql", "original_file_path": "macros\\utils\\except.sql", "name": "default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5628827, "supported_languages": null}, "macro.dbt.hash": {"unique_id": "macro.dbt.hash", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\hash.sql", "original_file_path": "macros\\utils\\hash.sql", "name": "hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt') (field)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__hash"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5628827, "supported_languages": null}, "macro.dbt.default__hash": {"unique_id": "macro.dbt.default__hash", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\hash.sql", "original_file_path": "macros\\utils\\hash.sql", "name": "default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{ field }} as {{ api.Column.translate_type('string') }}))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5628827, "supported_languages": null}, "macro.dbt.intersect": {"unique_id": "macro.dbt.intersect", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\intersect.sql", "original_file_path": "macros\\utils\\intersect.sql", "name": "intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5638866, "supported_languages": null}, "macro.dbt.default__intersect": {"unique_id": "macro.dbt.default__intersect", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\intersect.sql", "original_file_path": "macros\\utils\\intersect.sql", "name": "default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5638866, "supported_languages": null}, "macro.dbt.last_day": {"unique_id": "macro.dbt.last_day", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\last_day.sql", "original_file_path": "macros\\utils\\last_day.sql", "name": "last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt') (date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5648782, "supported_languages": null}, "macro.dbt.default_last_day": {"unique_id": "macro.dbt.default_last_day", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\last_day.sql", "original_file_path": "macros\\utils\\last_day.sql", "name": "default_last_day", "macro_sql": "\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd(datepart, '1', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5657997, "supported_languages": null}, "macro.dbt.default__last_day": {"unique_id": "macro.dbt.default__last_day", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\last_day.sql", "original_file_path": "macros\\utils\\last_day.sql", "name": "default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt.default_last_day(date, datepart)}}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5657997, "supported_languages": null}, "macro.dbt.length": {"unique_id": "macro.dbt.length", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\length.sql", "original_file_path": "macros\\utils\\length.sql", "name": "length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__length"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5667996, "supported_languages": null}, "macro.dbt.default__length": {"unique_id": "macro.dbt.default__length", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\length.sql", "original_file_path": "macros\\utils\\length.sql", "name": "default__length", "macro_sql": "{% macro default__length(expression) %}\n\n    length(\n        {{ expression }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5667996, "supported_languages": null}, "macro.dbt.listagg": {"unique_id": "macro.dbt.listagg", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\listagg.sql", "original_file_path": "macros\\utils\\listagg.sql", "name": "listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__listagg"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.568881, "supported_languages": null}, "macro.dbt.default__listagg": {"unique_id": "macro.dbt.default__listagg", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\listagg.sql", "original_file_path": "macros\\utils\\listagg.sql", "name": "default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        array_slice(\n            array_agg(\n                {{ measure }}\n            ){% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n            ,0\n            ,{{ limit_num }}\n        ),\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5698745, "supported_languages": null}, "macro.dbt.string_literal": {"unique_id": "macro.dbt.string_literal", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\literal.sql", "original_file_path": "macros\\utils\\literal.sql", "name": "string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt') (value)) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.570872, "supported_languages": null}, "macro.dbt.default__string_literal": {"unique_id": "macro.dbt.default__string_literal", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\literal.sql", "original_file_path": "macros\\utils\\literal.sql", "name": "default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5718734, "supported_languages": null}, "macro.dbt.position": {"unique_id": "macro.dbt.position", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\position.sql", "original_file_path": "macros\\utils\\position.sql", "name": "position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt') (substring_text, string_text)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__position"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5728722, "supported_languages": null}, "macro.dbt.default__position": {"unique_id": "macro.dbt.default__position", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\position.sql", "original_file_path": "macros\\utils\\position.sql", "name": "default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5728722, "supported_languages": null}, "macro.dbt.replace": {"unique_id": "macro.dbt.replace", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\replace.sql", "original_file_path": "macros\\utils\\replace.sql", "name": "replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt') (field, old_chars, new_chars)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5738728, "supported_languages": null}, "macro.dbt.default__replace": {"unique_id": "macro.dbt.default__replace", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\replace.sql", "original_file_path": "macros\\utils\\replace.sql", "name": "default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5748742, "supported_languages": null}, "macro.dbt.right": {"unique_id": "macro.dbt.right", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\right.sql", "original_file_path": "macros\\utils\\right.sql", "name": "right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt') (string_text, length_expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__right"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5748742, "supported_languages": null}, "macro.dbt.default__right": {"unique_id": "macro.dbt.default__right", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\right.sql", "original_file_path": "macros\\utils\\right.sql", "name": "default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5758002, "supported_languages": null}, "macro.dbt.safe_cast": {"unique_id": "macro.dbt.safe_cast", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\safe_cast.sql", "original_file_path": "macros\\utils\\safe_cast.sql", "name": "safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt') (field, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5758002, "supported_languages": null}, "macro.dbt.default__safe_cast": {"unique_id": "macro.dbt.default__safe_cast", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\safe_cast.sql", "original_file_path": "macros\\utils\\safe_cast.sql", "name": "default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.576799, "supported_languages": null}, "macro.dbt.split_part": {"unique_id": "macro.dbt.split_part", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\split_part.sql", "original_file_path": "macros\\utils\\split_part.sql", "name": "split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_trino.trino__split_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5777998, "supported_languages": null}, "macro.dbt.default__split_part": {"unique_id": "macro.dbt.default__split_part", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\split_part.sql", "original_file_path": "macros\\utils\\split_part.sql", "name": "default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5777998, "supported_languages": null}, "macro.dbt._split_part_negative": {"unique_id": "macro.dbt._split_part_negative", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\utils\\split_part.sql", "original_file_path": "macros\\utils\\split_part.sql", "name": "_split_part_negative", "macro_sql": "{% macro _split_part_negative(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n          length({{ string_text }})\n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 2 {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5777998, "supported_languages": null}, "macro.dbt.test_unique": {"unique_id": "macro.dbt.test_unique", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5787988, "supported_languages": null}, "macro.dbt.test_not_null": {"unique_id": "macro.dbt.test_not_null", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5797987, "supported_languages": null}, "macro.dbt.test_accepted_values": {"unique_id": "macro.dbt.test_accepted_values", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5797987, "supported_languages": null}, "macro.dbt.test_relationships": {"unique_id": "macro.dbt.test_relationships", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5807993, "supported_languages": null}, "macro.dbt_date.get_base_dates": {"unique_id": "macro.dbt_date.get_base_dates", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\get_base_dates.sql", "original_file_path": "macros\\get_base_dates.sql", "name": "get_base_dates", "macro_sql": "{% macro get_base_dates(start_date=None, end_date=None, n_dateparts=None, datepart=\"day\") %}\r\n    {{ adapter.dispatch('get_base_dates', 'dbt_date') (start_date, end_date, n_dateparts, datepart) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__get_base_dates"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5827997, "supported_languages": null}, "macro.dbt_date.default__get_base_dates": {"unique_id": "macro.dbt_date.default__get_base_dates", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\get_base_dates.sql", "original_file_path": "macros\\get_base_dates.sql", "name": "default__get_base_dates", "macro_sql": "{% macro default__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\r\n\r\n{%- if start_date and end_date -%}\r\n{%- set start_date=\"cast('\" ~ start_date ~ \"' as \" ~ dbt_utils.type_timestamp() ~ \")\" -%}\r\n{%- set end_date=\"cast('\" ~ end_date ~ \"' as \" ~ dbt_utils.type_timestamp() ~ \")\"  -%}\r\n\r\n{%- elif n_dateparts and datepart -%}\r\n\r\n{%- set start_date = dbt_utils.dateadd(datepart, -1 * n_dateparts, dbt_date.today()) -%}\r\n{%- set end_date = dbt_date.tomorrow() -%}\r\n{%- endif -%}\r\n\r\nwith date_spine as\r\n(\r\n\r\n    {{ dbt_utils.date_spine(\r\n        datepart=datepart,\r\n        start_date=start_date,\r\n        end_date=end_date,\r\n       )\r\n    }}\r\n\r\n)\r\nselect\r\n    cast(d.date_{{ datepart }} as {{ dbt_utils.type_timestamp() }}) as date_{{ datepart }}\r\nfrom\r\n    date_spine d\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.type_timestamp", "macro.dbt.dateadd", "macro.dbt_date.today", "macro.dbt_date.tomorrow", "macro.dbt_utils.date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5837994, "supported_languages": null}, "macro.dbt_date.bigquery__get_base_dates": {"unique_id": "macro.dbt_date.bigquery__get_base_dates", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\get_base_dates.sql", "original_file_path": "macros\\get_base_dates.sql", "name": "bigquery__get_base_dates", "macro_sql": "{% macro bigquery__get_base_dates(start_date, end_date, n_dateparts, datepart) %}\r\n\r\n{%- if start_date and end_date -%}\r\n{%- set start_date=\"cast('\" ~ start_date ~ \"' as date )\" -%}\r\n{%- set end_date=\"cast('\" ~ end_date ~ \"' as date )\" -%}\r\n\r\n{%- elif n_dateparts and datepart -%}\r\n\r\n{%- set start_date = dbt_utils.dateadd(datepart, -1 * n_dateparts, dbt_date.today()) -%}\r\n{%- set end_date = dbt_date.tomorrow() -%}\r\n{%- endif -%}\r\n\r\nwith date_spine as\r\n(\r\n\r\n    {{ dbt_utils.date_spine(\r\n        datepart=datepart,\r\n        start_date=start_date,\r\n        end_date=end_date,\r\n       )\r\n    }}\r\n\r\n)\r\nselect\r\n    cast(d.date_{{ datepart }} as {{ dbt_utils.type_timestamp() }}) as date_{{ datepart }}\r\nfrom\r\n    date_spine d\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt_date.today", "macro.dbt_date.tomorrow", "macro.dbt_utils.date_spine", "macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5847988, "supported_languages": null}, "macro.dbt_date.get_date_dimension": {"unique_id": "macro.dbt_date.get_date_dimension", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\get_date_dimension.sql", "original_file_path": "macros\\get_date_dimension.sql", "name": "get_date_dimension", "macro_sql": "{% macro get_date_dimension(start_date, end_date) %}\r\n    {{ adapter.dispatch('get_date_dimension', 'dbt_date') (start_date, end_date) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__get_date_dimension"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5957992, "supported_languages": null}, "macro.dbt_date.default__get_date_dimension": {"unique_id": "macro.dbt_date.default__get_date_dimension", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\get_date_dimension.sql", "original_file_path": "macros\\get_date_dimension.sql", "name": "default__get_date_dimension", "macro_sql": "{% macro default__get_date_dimension(start_date, end_date) %}\r\nwith base_dates as (\r\n    {{ dbt_date.get_base_dates(start_date, end_date) }}\r\n),\r\ndates_with_prior_year_dates as (\r\n\r\n    select\r\n        cast(d.date_day as date) as date_day,\r\n        cast({{ dbt_utils.dateadd('year', -1 , 'd.date_day') }} as date) as prior_year_date_day,\r\n        cast({{ dbt_utils.dateadd('day', -364 , 'd.date_day') }} as date) as prior_year_over_year_date_day\r\n    from\r\n    \tbase_dates d\r\n\r\n)\r\nselect\r\n    d.date_day,\r\n    {{ dbt_date.yesterday('d.date_day') }} as prior_date_day,\r\n    {{ dbt_date.tomorrow('d.date_day') }} as next_date_day,\r\n    d.prior_year_date_day as prior_year_date_day,\r\n    d.prior_year_over_year_date_day,\r\n    {{ dbt_date.day_of_week('d.date_day', isoweek=false) }} as day_of_week,\r\n    {{ dbt_date.day_of_week('d.date_day', isoweek=true) }} as day_of_week_iso,\r\n    {{ dbt_date.day_name('d.date_day', short=false) }} as day_of_week_name,\r\n    {{ dbt_date.day_name('d.date_day', short=true) }} as day_of_week_name_short,\r\n    {{ dbt_date.day_of_month('d.date_day') }} as day_of_month,\r\n    {{ dbt_date.day_of_year('d.date_day') }} as day_of_year,\r\n\r\n    {{ dbt_date.week_start('d.date_day') }} as week_start_date,\r\n    {{ dbt_date.week_end('d.date_day') }} as week_end_date,\r\n    {{ dbt_date.week_start('d.prior_year_over_year_date_day') }} as prior_year_week_start_date,\r\n    {{ dbt_date.week_end('d.prior_year_over_year_date_day') }} as prior_year_week_end_date,\r\n    {{ dbt_date.week_of_year('d.date_day') }} as week_of_year,\r\n\r\n    {{ dbt_date.iso_week_start('d.date_day') }} as iso_week_start_date,\r\n    {{ dbt_date.iso_week_end('d.date_day') }} as iso_week_end_date,\r\n    {{ dbt_date.iso_week_start('d.prior_year_over_year_date_day') }} as prior_year_iso_week_start_date,\r\n    {{ dbt_date.iso_week_end('d.prior_year_over_year_date_day') }} as prior_year_iso_week_end_date,\r\n    {{ dbt_date.iso_week_of_year('d.date_day') }} as iso_week_of_year,\r\n\r\n    {{ dbt_date.week_of_year('d.prior_year_over_year_date_day') }} as prior_year_week_of_year,\r\n    {{ dbt_date.iso_week_of_year('d.prior_year_over_year_date_day') }} as prior_year_iso_week_of_year,\r\n\r\n    cast({{ dbt_date.date_part('month', 'd.date_day') }} as {{ dbt_utils.type_int() }}) as month_of_year,\r\n    {{ dbt_date.month_name('d.date_day', short=false) }}  as month_name,\r\n    {{ dbt_date.month_name('d.date_day', short=true) }}  as month_name_short,\r\n\r\n    cast({{ dbt_utils.date_trunc('month', 'd.date_day') }} as date) as month_start_date,\r\n    cast({{ dbt_utils.last_day('d.date_day', 'month') }} as date) as month_end_date,\r\n\r\n    cast({{ dbt_utils.date_trunc('month', 'd.prior_year_date_day') }} as date) as prior_year_month_start_date,\r\n    cast({{ dbt_utils.last_day('d.prior_year_date_day', 'month') }} as date) as prior_year_month_end_date,\r\n\r\n    cast({{ dbt_date.date_part('quarter', 'd.date_day') }} as {{ dbt_utils.type_int() }}) as quarter_of_year,\r\n    cast({{ dbt_utils.date_trunc('quarter', 'd.date_day') }} as date) as quarter_start_date,\r\n    cast({{ dbt_utils.last_day('d.date_day', 'quarter') }} as date) as quarter_end_date,\r\n\r\n    cast({{ dbt_date.date_part('year', 'd.date_day') }} as {{ dbt_utils.type_int() }}) as year_number,\r\n    cast({{ dbt_utils.date_trunc('year', 'd.date_day') }} as date) as year_start_date,\r\n    cast({{ dbt_utils.last_day('d.date_day', 'year') }} as date) as year_end_date\r\nfrom\r\n    dates_with_prior_year_dates d\r\norder by 1\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.get_base_dates", "macro.dbt.dateadd", "macro.dbt_date.yesterday", "macro.dbt_date.tomorrow", "macro.dbt_date.day_of_week", "macro.dbt_date.day_name", "macro.dbt_date.day_of_month", "macro.dbt_date.day_of_year", "macro.dbt_date.week_start", "macro.dbt_date.week_end", "macro.dbt_date.week_of_year", "macro.dbt_date.iso_week_start", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt.type_int", "macro.dbt_date.month_name", "macro.dbt.date_trunc", "macro.dbt.last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.5997994, "supported_languages": null}, "macro.dbt_date.postgres__get_date_dimension": {"unique_id": "macro.dbt_date.postgres__get_date_dimension", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\get_date_dimension.sql", "original_file_path": "macros\\get_date_dimension.sql", "name": "postgres__get_date_dimension", "macro_sql": "{% macro postgres__get_date_dimension(start_date, end_date) %}\r\nwith base_dates as (\r\n    {{ dbt_date.get_base_dates(start_date, end_date) }}\r\n),\r\ndates_with_prior_year_dates as (\r\n\r\n    select\r\n        cast(d.date_day as date) as date_day,\r\n        cast({{ dbt_utils.dateadd('year', -1 , 'd.date_day') }} as date) as prior_year_date_day,\r\n        cast({{ dbt_utils.dateadd('day', -364 , 'd.date_day') }} as date) as prior_year_over_year_date_day\r\n    from\r\n    \tbase_dates d\r\n\r\n)\r\nselect\r\n    d.date_day,\r\n    {{ dbt_date.yesterday('d.date_day') }} as prior_date_day,\r\n    {{ dbt_date.tomorrow('d.date_day') }} as next_date_day,\r\n    d.prior_year_date_day as prior_year_date_day,\r\n    d.prior_year_over_year_date_day,\r\n    {{ dbt_date.day_of_week('d.date_day', isoweek=true) }} as day_of_week,\r\n\r\n    {{ dbt_date.day_name('d.date_day', short=false) }} as day_of_week_name,\r\n    {{ dbt_date.day_name('d.date_day', short=true) }} as day_of_week_name_short,\r\n    {{ dbt_date.day_of_month('d.date_day') }} as day_of_month,\r\n    {{ dbt_date.day_of_year('d.date_day') }} as day_of_year,\r\n\r\n    {{ dbt_date.week_start('d.date_day') }} as week_start_date,\r\n    {{ dbt_date.week_end('d.date_day') }} as week_end_date,\r\n    {{ dbt_date.week_start('d.prior_year_over_year_date_day') }} as prior_year_week_start_date,\r\n    {{ dbt_date.week_end('d.prior_year_over_year_date_day') }} as prior_year_week_end_date,\r\n    {{ dbt_date.week_of_year('d.date_day') }} as week_of_year,\r\n\r\n    {{ dbt_date.iso_week_start('d.date_day') }} as iso_week_start_date,\r\n    {{ dbt_date.iso_week_end('d.date_day') }} as iso_week_end_date,\r\n    {{ dbt_date.iso_week_start('d.prior_year_over_year_date_day') }} as prior_year_iso_week_start_date,\r\n    {{ dbt_date.iso_week_end('d.prior_year_over_year_date_day') }} as prior_year_iso_week_end_date,\r\n    {{ dbt_date.iso_week_of_year('d.date_day') }} as iso_week_of_year,\r\n\r\n    {{ dbt_date.week_of_year('d.prior_year_over_year_date_day') }} as prior_year_week_of_year,\r\n    {{ dbt_date.iso_week_of_year('d.prior_year_over_year_date_day') }} as prior_year_iso_week_of_year,\r\n\r\n    cast({{ dbt_date.date_part('month', 'd.date_day') }} as {{ dbt_utils.type_int() }}) as month_of_year,\r\n    {{ dbt_date.month_name('d.date_day', short=false) }}  as month_name,\r\n    {{ dbt_date.month_name('d.date_day', short=true) }}  as month_name_short,\r\n\r\n    cast({{ dbt_utils.date_trunc('month', 'd.date_day') }} as date) as month_start_date,\r\n    cast({{ dbt_utils.last_day('d.date_day', 'month') }} as date) as month_end_date,\r\n\r\n    cast({{ dbt_utils.date_trunc('month', 'd.prior_year_date_day') }} as date) as prior_year_month_start_date,\r\n    cast({{ dbt_utils.last_day('d.prior_year_date_day', 'month') }} as date) as prior_year_month_end_date,\r\n\r\n    cast({{ dbt_date.date_part('quarter', 'd.date_day') }} as {{ dbt_utils.type_int() }}) as quarter_of_year,\r\n    cast({{ dbt_utils.date_trunc('quarter', 'd.date_day') }} as date) as quarter_start_date,\r\n    {# dbt_utils.last_day does not support quarter because postgresql does not support quarter interval. #}\r\n    cast({{dbt_utils.dateadd('day', '-1', dbt_utils.dateadd('month', '3', dbt_utils.date_trunc('quarter', 'd.date_day')))}} as date) as quarter_end_date,\r\n\r\n    cast({{ dbt_date.date_part('year', 'd.date_day') }} as {{ dbt_utils.type_int() }}) as year_number,\r\n    cast({{ dbt_utils.date_trunc('year', 'd.date_day') }} as date) as year_start_date,\r\n    cast({{ dbt_utils.last_day('d.date_day', 'year') }} as date) as year_end_date\r\nfrom\r\n    dates_with_prior_year_dates d\r\norder by 1\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.get_base_dates", "macro.dbt.dateadd", "macro.dbt_date.yesterday", "macro.dbt_date.tomorrow", "macro.dbt_date.day_of_week", "macro.dbt_date.day_name", "macro.dbt_date.day_of_month", "macro.dbt_date.day_of_year", "macro.dbt_date.week_start", "macro.dbt_date.week_end", "macro.dbt_date.week_of_year", "macro.dbt_date.iso_week_start", "macro.dbt_date.iso_week_end", "macro.dbt_date.iso_week_of_year", "macro.dbt_date.date_part", "macro.dbt.type_int", "macro.dbt_date.month_name", "macro.dbt.date_trunc", "macro.dbt.last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6037989, "supported_languages": null}, "macro.dbt_date.convert_timezone": {"unique_id": "macro.dbt_date.convert_timezone", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\convert_timezone.sql", "original_file_path": "macros\\calendar_date\\convert_timezone.sql", "name": "convert_timezone", "macro_sql": "{%- macro convert_timezone(column, target_tz=None, source_tz=None) -%}\r\n{%- set source_tz = \"UTC\" if not source_tz else source_tz -%}\r\n{%- set target_tz = var(\"dbt_date:time_zone\") if not target_tz else target_tz -%}\r\n{{ adapter.dispatch('convert_timezone', 'dbt_date') (column, target_tz, source_tz) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__convert_timezone"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6058002, "supported_languages": null}, "macro.dbt_date.default__convert_timezone": {"unique_id": "macro.dbt_date.default__convert_timezone", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\convert_timezone.sql", "original_file_path": "macros\\calendar_date\\convert_timezone.sql", "name": "default__convert_timezone", "macro_sql": "{% macro default__convert_timezone(column, target_tz, source_tz) -%}\r\n{%- if not source_tz -%}\r\ncast(convert_timezone('{{ target_tz }}', {{ column }}) as {{ dbt_utils.type_timestamp() }})\r\n{%- else -%}\r\ncast(convert_timezone('{{ source_tz }}', '{{ target_tz }}', {{ column }}) as {{ dbt_utils.type_timestamp() }})\r\n{%- endif -%}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6067991, "supported_languages": null}, "macro.dbt_date.bigquery__convert_timezone": {"unique_id": "macro.dbt_date.bigquery__convert_timezone", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\convert_timezone.sql", "original_file_path": "macros\\calendar_date\\convert_timezone.sql", "name": "bigquery__convert_timezone", "macro_sql": "{%- macro bigquery__convert_timezone(column, target_tz, source_tz=None) -%}\r\ntimestamp(datetime({{ column }}, '{{ target_tz}}'))\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6067991, "supported_languages": null}, "macro.dbt_date.spark__convert_timezone": {"unique_id": "macro.dbt_date.spark__convert_timezone", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\convert_timezone.sql", "original_file_path": "macros\\calendar_date\\convert_timezone.sql", "name": "spark__convert_timezone", "macro_sql": "{%- macro spark__convert_timezone(column, target_tz, source_tz) -%}\r\nfrom_utc_timestamp(\r\n        to_utc_timestamp({{ column }}, '{{ source_tz }}'),\r\n        '{{ target_tz }}'\r\n        )\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6067991, "supported_languages": null}, "macro.dbt_date.postgres__convert_timezone": {"unique_id": "macro.dbt_date.postgres__convert_timezone", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\convert_timezone.sql", "original_file_path": "macros\\calendar_date\\convert_timezone.sql", "name": "postgres__convert_timezone", "macro_sql": "{% macro postgres__convert_timezone(column, target_tz, source_tz) -%}\r\n{%- if source_tz -%}\r\ncast({{ column }} at time zone '{{ source_tz }}' at time zone '{{ target_tz }}' as {{ dbt_utils.type_timestamp() }})\r\n{%- else -%}\r\ncast({{ column }} at time zone '{{ target_tz }}' as {{ dbt_utils.type_timestamp() }})\r\n{%- endif -%}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6077993, "supported_languages": null}, "macro.dbt_date.date_part": {"unique_id": "macro.dbt_date.date_part", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\date_part.sql", "original_file_path": "macros\\calendar_date\\date_part.sql", "name": "date_part", "macro_sql": "{% macro date_part(datepart, date) -%}\r\n    {{ adapter.dispatch('date_part', 'dbt_date') (datepart, date) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6087992, "supported_languages": null}, "macro.dbt_date.default__date_part": {"unique_id": "macro.dbt_date.default__date_part", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\date_part.sql", "original_file_path": "macros\\calendar_date\\date_part.sql", "name": "default__date_part", "macro_sql": "{% macro default__date_part(datepart, date) -%}\r\n    date_part('{{ datepart }}', {{  date }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6087992, "supported_languages": null}, "macro.dbt_date.bigquery__date_part": {"unique_id": "macro.dbt_date.bigquery__date_part", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\date_part.sql", "original_file_path": "macros\\calendar_date\\date_part.sql", "name": "bigquery__date_part", "macro_sql": "{% macro bigquery__date_part(datepart, date) -%}\r\n    extract({{ datepart }} from {{ date }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6087992, "supported_languages": null}, "macro.dbt_date.day_name": {"unique_id": "macro.dbt_date.day_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_name.sql", "original_file_path": "macros\\calendar_date\\day_name.sql", "name": "day_name", "macro_sql": "{%- macro day_name(date, short=True) -%}\r\n    {{ adapter.dispatch('day_name', 'dbt_date') (date, short) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__day_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.609799, "supported_languages": null}, "macro.dbt_date.default__day_name": {"unique_id": "macro.dbt_date.default__day_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_name.sql", "original_file_path": "macros\\calendar_date\\day_name.sql", "name": "default__day_name", "macro_sql": "\r\n\r\n{%- macro default__day_name(date, short) -%}\r\n{%- set f = 'Dy' if short else 'Day' -%}\r\n    to_char({{ date }}, '{{ f }}')\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.610799, "supported_languages": null}, "macro.dbt_date.snowflake__day_name": {"unique_id": "macro.dbt_date.snowflake__day_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_name.sql", "original_file_path": "macros\\calendar_date\\day_name.sql", "name": "snowflake__day_name", "macro_sql": "\r\n\r\n{%- macro snowflake__day_name(date, short) -%}\r\n    {%- if short -%}\r\n    dayname({{ date }})\r\n    {%- else -%}\r\n    -- long version not implemented on Snowflake so we're doing it manually :/\r\n    case dayname({{ date }})\r\n        when 'Mon' then 'Monday'\r\n        when 'Tue' then 'Tuesday'\r\n        when 'Wed' then 'Wednesday'\r\n        when 'Thu' then 'Thursday'\r\n        when 'Fri' then 'Friday'\r\n        when 'Sat' then 'Saturday'\r\n        when 'Sun' then 'Sunday'\r\n    end\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.610799, "supported_languages": null}, "macro.dbt_date.bigquery__day_name": {"unique_id": "macro.dbt_date.bigquery__day_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_name.sql", "original_file_path": "macros\\calendar_date\\day_name.sql", "name": "bigquery__day_name", "macro_sql": "\r\n\r\n{%- macro bigquery__day_name(date, short) -%}\r\n{%- set f = '%a' if short else '%A' -%}\r\n    format_date('{{ f }}', cast({{ date }} as date))\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.611799, "supported_languages": null}, "macro.dbt_date.postgres__day_name": {"unique_id": "macro.dbt_date.postgres__day_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_name.sql", "original_file_path": "macros\\calendar_date\\day_name.sql", "name": "postgres__day_name", "macro_sql": "\r\n\r\n{%- macro postgres__day_name(date, short) -%}\r\n{# FM = Fill mode, which suppresses padding blanks #}\r\n{%- set f = 'FMDy' if short else 'FMDay' -%}\r\n    to_char({{ date }}, '{{ f }}')\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.611799, "supported_languages": null}, "macro.dbt_date.day_of_month": {"unique_id": "macro.dbt_date.day_of_month", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_month.sql", "original_file_path": "macros\\calendar_date\\day_of_month.sql", "name": "day_of_month", "macro_sql": "{%- macro day_of_month(date) -%}\r\n{{ dbt_date.date_part('day', date) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.612799, "supported_languages": null}, "macro.dbt_date.redshift__day_of_month": {"unique_id": "macro.dbt_date.redshift__day_of_month", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_month.sql", "original_file_path": "macros\\calendar_date\\day_of_month.sql", "name": "redshift__day_of_month", "macro_sql": "\r\n\r\n{%- macro redshift__day_of_month(date) -%}\r\ncast({{ dbt_date.date_part('day', date) }} as {{ dbt_utils.type_bigint() }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.612799, "supported_languages": null}, "macro.dbt_date.day_of_week": {"unique_id": "macro.dbt_date.day_of_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_week.sql", "original_file_path": "macros\\calendar_date\\day_of_week.sql", "name": "day_of_week", "macro_sql": "{%- macro day_of_week(date, isoweek=true) -%}\r\n{{ adapter.dispatch('day_of_week', 'dbt_date') (date, isoweek) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__day_of_week"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.615799, "supported_languages": null}, "macro.dbt_date.default__day_of_week": {"unique_id": "macro.dbt_date.default__day_of_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_week.sql", "original_file_path": "macros\\calendar_date\\day_of_week.sql", "name": "default__day_of_week", "macro_sql": "\r\n\r\n{%- macro default__day_of_week(date, isoweek) -%}\r\n\r\n    {%- set dow = dbt_date.date_part('dayofweek', date) -%}\r\n\r\n    {%- if isoweek -%}\r\n    case\r\n        -- Shift start of week from Sunday (0) to Monday (1)\r\n        when {{ dow }} = 0 then 7\r\n        else {{ dow }}\r\n    end\r\n    {%- else -%}\r\n    {{ dow }} + 1\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.615799, "supported_languages": null}, "macro.dbt_date.snowflake__day_of_week": {"unique_id": "macro.dbt_date.snowflake__day_of_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_week.sql", "original_file_path": "macros\\calendar_date\\day_of_week.sql", "name": "snowflake__day_of_week", "macro_sql": "\r\n\r\n{%- macro snowflake__day_of_week(date, isoweek) -%}\r\n\r\n    {%- if isoweek -%}\r\n        {%- set dow_part = 'dayofweekiso' -%}\r\n        {{ dbt_date.date_part(dow_part, date) }}\r\n    {%- else -%}\r\n        {%- set dow_part = 'dayofweek' -%}\r\n        case\r\n            when {{ dbt_date.date_part(dow_part, date) }} = 7 then 1\r\n            else {{ dbt_date.date_part(dow_part, date) }} + 1\r\n        end\r\n    {%- endif -%}\r\n\r\n\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.616802, "supported_languages": null}, "macro.dbt_date.bigquery__day_of_week": {"unique_id": "macro.dbt_date.bigquery__day_of_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_week.sql", "original_file_path": "macros\\calendar_date\\day_of_week.sql", "name": "bigquery__day_of_week", "macro_sql": "\r\n\r\n{%- macro bigquery__day_of_week(date, isoweek) -%}\r\n\r\n    {%- set dow = dbt_date.date_part('dayofweek', date) -%}\r\n\r\n    {%- if isoweek -%}\r\n    case\r\n        -- Shift start of week from Sunday (1) to Monday (2)\r\n        when {{ dow }} = 1 then 7\r\n        else {{ dow }} - 1\r\n    end\r\n    {%- else -%}\r\n    {{ dow }}\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.616802, "supported_languages": null}, "macro.dbt_date.postgres__day_of_week": {"unique_id": "macro.dbt_date.postgres__day_of_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_week.sql", "original_file_path": "macros\\calendar_date\\day_of_week.sql", "name": "postgres__day_of_week", "macro_sql": "\r\n\r\n\r\n{%- macro postgres__day_of_week(date, isoweek) -%}\r\n\r\n    {%- if isoweek -%}\r\n        {%- set dow_part = 'isodow' -%}\r\n        -- Monday(1) to Sunday (7)\r\n        cast({{ dbt_date.date_part(dow_part, date) }} as {{ dbt_utils.type_int() }})\r\n    {%- else -%}\r\n        {%- set dow_part = 'dow' -%}\r\n        -- Sunday(1) to Saturday (7)\r\n        cast({{ dbt_date.date_part(dow_part, date) }} + 1 as {{ dbt_utils.type_int() }})\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6178012, "supported_languages": null}, "macro.dbt_date.redshift__day_of_week": {"unique_id": "macro.dbt_date.redshift__day_of_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_week.sql", "original_file_path": "macros\\calendar_date\\day_of_week.sql", "name": "redshift__day_of_week", "macro_sql": "\r\n\r\n\r\n{%- macro redshift__day_of_week(date, isoweek) -%}\r\n\r\n    {%- set dow = dbt_date.date_part('dayofweek', date) -%}\r\n\r\n    {%- if isoweek -%}\r\n    case\r\n        -- Shift start of week from Sunday (0) to Monday (1)\r\n        when {{ dow }} = 0 then 7\r\n        else cast({{ dow }} as {{ dbt_utils.type_bigint() }})\r\n    end\r\n    {%- else -%}\r\n    cast({{ dow }} + 1 as {{ dbt_utils.type_bigint() }})\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6187987, "supported_languages": null}, "macro.dbt_date.day_of_year": {"unique_id": "macro.dbt_date.day_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_year.sql", "original_file_path": "macros\\calendar_date\\day_of_year.sql", "name": "day_of_year", "macro_sql": "{%- macro day_of_year(date) -%}\r\n{{ adapter.dispatch('day_of_year', 'dbt_date') (date) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__day_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6187987, "supported_languages": null}, "macro.dbt_date.default__day_of_year": {"unique_id": "macro.dbt_date.default__day_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_year.sql", "original_file_path": "macros\\calendar_date\\day_of_year.sql", "name": "default__day_of_year", "macro_sql": "\r\n\r\n{%- macro default__day_of_year(date) -%}\r\n    {{ dbt_date.date_part('dayofyear', date) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6197994, "supported_languages": null}, "macro.dbt_date.postgres__day_of_year": {"unique_id": "macro.dbt_date.postgres__day_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_year.sql", "original_file_path": "macros\\calendar_date\\day_of_year.sql", "name": "postgres__day_of_year", "macro_sql": "\r\n\r\n{%- macro postgres__day_of_year(date) -%}\r\n    {{ dbt_date.date_part('doy', date) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6197994, "supported_languages": null}, "macro.dbt_date.redshift__day_of_year": {"unique_id": "macro.dbt_date.redshift__day_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\day_of_year.sql", "original_file_path": "macros\\calendar_date\\day_of_year.sql", "name": "redshift__day_of_year", "macro_sql": "\r\n\r\n{%- macro redshift__day_of_year(date) -%}\r\n    cast({{ dbt_date.date_part('dayofyear', date) }} as {{ dbt_utils.type_bigint() }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6197994, "supported_languages": null}, "macro.dbt_date.from_unixtimestamp": {"unique_id": "macro.dbt_date.from_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\from_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\from_unixtimestamp.sql", "name": "from_unixtimestamp", "macro_sql": "{%- macro from_unixtimestamp(epochs, format=\"seconds\") -%}\r\n    {{ adapter.dispatch('from_unixtimestamp', 'dbt_date') (epochs, format) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__from_unixtimestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.621799, "supported_languages": null}, "macro.dbt_date.default__from_unixtimestamp": {"unique_id": "macro.dbt_date.default__from_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\from_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\from_unixtimestamp.sql", "name": "default__from_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro default__from_unixtimestamp(epochs, format=\"seconds\") -%}\r\n    {%- if format != \"seconds\" -%}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\r\n        )\r\n    }}\r\n    {% endif -%}\r\n    to_timestamp({{ epochs }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6227994, "supported_languages": null}, "macro.dbt_date.postgres__from_unixtimestamp": {"unique_id": "macro.dbt_date.postgres__from_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\from_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\from_unixtimestamp.sql", "name": "postgres__from_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro postgres__from_unixtimestamp(epochs, format=\"seconds\") -%}\r\n    {%- if format != \"seconds\" -%}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\r\n        )\r\n    }}\r\n    {% endif -%}\r\n    cast(to_timestamp({{ epochs }}) at time zone 'UTC' as timestamp)\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6227994, "supported_languages": null}, "macro.dbt_date.snowflake__from_unixtimestamp": {"unique_id": "macro.dbt_date.snowflake__from_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\from_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\from_unixtimestamp.sql", "name": "snowflake__from_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro snowflake__from_unixtimestamp(epochs, format) -%}\r\n    {%- if format == \"seconds\" -%}\r\n    {%- set scale = 0 -%}\r\n    {%- elif format == \"milliseconds\" -%}\r\n    {%- set scale = 3 -%}\r\n    {%- elif format == \"microseconds\" -%}\r\n    {%- set scale = 6 -%}\r\n    {%- else -%}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\r\n        )\r\n    }}\r\n    {% endif -%}\r\n    to_timestamp_ntz({{ epochs }}, {{ scale }})\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.623799, "supported_languages": null}, "macro.dbt_date.bigquery__from_unixtimestamp": {"unique_id": "macro.dbt_date.bigquery__from_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\from_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\from_unixtimestamp.sql", "name": "bigquery__from_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro bigquery__from_unixtimestamp(epochs, format) -%}\r\n    {%- if format == \"seconds\" -%}\r\n        timestamp_seconds({{ epochs }})\r\n    {%- elif format == \"milliseconds\" -%}\r\n        timestamp_millis({{ epochs }})\r\n    {%- elif format == \"microseconds\" -%}\r\n        timestamp_micros({{ epochs }})\r\n    {%- else -%}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"value \" ~ format ~ \" for `format` for from_unixtimestamp is not supported.\"\r\n        )\r\n    }}\r\n    {% endif -%}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6247993, "supported_languages": null}, "macro.dbt_date.iso_week_end": {"unique_id": "macro.dbt_date.iso_week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_end.sql", "original_file_path": "macros\\calendar_date\\iso_week_end.sql", "name": "iso_week_end", "macro_sql": "{%- macro iso_week_end(date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{{ adapter.dispatch('iso_week_end', 'dbt_date') (dt) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6257994, "supported_languages": null}, "macro.dbt_date._iso_week_end": {"unique_id": "macro.dbt_date._iso_week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_end.sql", "original_file_path": "macros\\calendar_date\\iso_week_end.sql", "name": "_iso_week_end", "macro_sql": "{%- macro _iso_week_end(date, week_type) -%}\r\n{%- set dt = dbt_date.iso_week_start(date) -%}\r\n{{ dbt_date.n_days_away(6, dt) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.iso_week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6257994, "supported_languages": null}, "macro.dbt_date.default__iso_week_end": {"unique_id": "macro.dbt_date.default__iso_week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_end.sql", "original_file_path": "macros\\calendar_date\\iso_week_end.sql", "name": "default__iso_week_end", "macro_sql": "\r\n\r\n{%- macro default__iso_week_end(date) -%}\r\n{{ dbt_date._iso_week_end(date, 'isoweek') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6257994, "supported_languages": null}, "macro.dbt_date.snowflake__iso_week_end": {"unique_id": "macro.dbt_date.snowflake__iso_week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_end.sql", "original_file_path": "macros\\calendar_date\\iso_week_end.sql", "name": "snowflake__iso_week_end", "macro_sql": "\r\n\r\n{%- macro snowflake__iso_week_end(date) -%}\r\n{{ dbt_date._iso_week_end(date, 'weekiso') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.626799, "supported_languages": null}, "macro.dbt_date.iso_week_of_year": {"unique_id": "macro.dbt_date.iso_week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_of_year.sql", "original_file_path": "macros\\calendar_date\\iso_week_of_year.sql", "name": "iso_week_of_year", "macro_sql": "{%- macro iso_week_of_year(date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{{ adapter.dispatch('iso_week_of_year', 'dbt_date') (dt) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6277995, "supported_languages": null}, "macro.dbt_date._iso_week_of_year": {"unique_id": "macro.dbt_date._iso_week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_of_year.sql", "original_file_path": "macros\\calendar_date\\iso_week_of_year.sql", "name": "_iso_week_of_year", "macro_sql": "{%- macro _iso_week_of_year(date, week_type) -%}\r\ncast({{ dbt_date.date_part(week_type, date) }} as {{ dbt_utils.type_int() }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6277995, "supported_languages": null}, "macro.dbt_date.default__iso_week_of_year": {"unique_id": "macro.dbt_date.default__iso_week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_of_year.sql", "original_file_path": "macros\\calendar_date\\iso_week_of_year.sql", "name": "default__iso_week_of_year", "macro_sql": "\r\n\r\n{%- macro default__iso_week_of_year(date) -%}\r\n{{ dbt_date._iso_week_of_year(date, 'isoweek') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6277995, "supported_languages": null}, "macro.dbt_date.snowflake__iso_week_of_year": {"unique_id": "macro.dbt_date.snowflake__iso_week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_of_year.sql", "original_file_path": "macros\\calendar_date\\iso_week_of_year.sql", "name": "snowflake__iso_week_of_year", "macro_sql": "\r\n\r\n{%- macro snowflake__iso_week_of_year(date) -%}\r\n{{ dbt_date._iso_week_of_year(date, 'weekiso') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.628799, "supported_languages": null}, "macro.dbt_date.postgres__iso_week_of_year": {"unique_id": "macro.dbt_date.postgres__iso_week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_of_year.sql", "original_file_path": "macros\\calendar_date\\iso_week_of_year.sql", "name": "postgres__iso_week_of_year", "macro_sql": "\r\n\r\n{%- macro postgres__iso_week_of_year(date) -%}\r\n-- postgresql week is isoweek, the first week of a year containing January 4 of that year.\r\n{{ dbt_date._iso_week_of_year(date, 'week') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.628799, "supported_languages": null}, "macro.dbt_date.iso_week_start": {"unique_id": "macro.dbt_date.iso_week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_start.sql", "original_file_path": "macros\\calendar_date\\iso_week_start.sql", "name": "iso_week_start", "macro_sql": "{%- macro iso_week_start(date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{{ adapter.dispatch('iso_week_start', 'dbt_date') (dt) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.629799, "supported_languages": null}, "macro.dbt_date._iso_week_start": {"unique_id": "macro.dbt_date._iso_week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_start.sql", "original_file_path": "macros\\calendar_date\\iso_week_start.sql", "name": "_iso_week_start", "macro_sql": "{%- macro _iso_week_start(date, week_type) -%}\r\ncast({{ dbt_utils.date_trunc(week_type, date) }} as date)\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.629799, "supported_languages": null}, "macro.dbt_date.default__iso_week_start": {"unique_id": "macro.dbt_date.default__iso_week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_start.sql", "original_file_path": "macros\\calendar_date\\iso_week_start.sql", "name": "default__iso_week_start", "macro_sql": "\r\n\r\n{%- macro default__iso_week_start(date) -%}\r\n{{ dbt_date._iso_week_start(date, 'isoweek') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6308002, "supported_languages": null}, "macro.dbt_date.snowflake__iso_week_start": {"unique_id": "macro.dbt_date.snowflake__iso_week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_start.sql", "original_file_path": "macros\\calendar_date\\iso_week_start.sql", "name": "snowflake__iso_week_start", "macro_sql": "\r\n\r\n{%- macro snowflake__iso_week_start(date) -%}\r\n{{ dbt_date._iso_week_start(date, 'week') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6308002, "supported_languages": null}, "macro.dbt_date.postgres__iso_week_start": {"unique_id": "macro.dbt_date.postgres__iso_week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\iso_week_start.sql", "original_file_path": "macros\\calendar_date\\iso_week_start.sql", "name": "postgres__iso_week_start", "macro_sql": "\r\n\r\n{%- macro postgres__iso_week_start(date) -%}\r\n{{ dbt_date._iso_week_start(date, 'week') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date._iso_week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6308002, "supported_languages": null}, "macro.dbt_date.last_month": {"unique_id": "macro.dbt_date.last_month", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\last_month.sql", "original_file_path": "macros\\calendar_date\\last_month.sql", "name": "last_month", "macro_sql": "{%- macro last_month(tz=None) -%}\r\n{{ dbt_date.n_months_ago(1, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_months_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6317992, "supported_languages": null}, "macro.dbt_date.last_month_name": {"unique_id": "macro.dbt_date.last_month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\last_month_name.sql", "original_file_path": "macros\\calendar_date\\last_month_name.sql", "name": "last_month_name", "macro_sql": "{%- macro last_month_name(short=True, tz=None) -%}\r\n{{ dbt_date.month_name(dbt_date.last_month(1, tz), short=short) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.month_name", "macro.dbt_date.last_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6317992, "supported_languages": null}, "macro.dbt_date.last_month_number": {"unique_id": "macro.dbt_date.last_month_number", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\last_month_number.sql", "original_file_path": "macros\\calendar_date\\last_month_number.sql", "name": "last_month_number", "macro_sql": "{%- macro last_month_number(tz=None) -%}\r\n{{ dbt_date.date_part('month', dbt_date.last_month(1, tz)) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.last_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6327982, "supported_languages": null}, "macro.dbt_date.last_week": {"unique_id": "macro.dbt_date.last_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\last_week.sql", "original_file_path": "macros\\calendar_date\\last_week.sql", "name": "last_week", "macro_sql": "{%- macro last_week(tz=None) -%}\r\n{{ dbt_date.n_weeks_ago(1, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_weeks_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6337998, "supported_languages": null}, "macro.dbt_date.month_name": {"unique_id": "macro.dbt_date.month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\month_name.sql", "original_file_path": "macros\\calendar_date\\month_name.sql", "name": "month_name", "macro_sql": "{%- macro month_name(date, short=True) -%}\r\n    {{ adapter.dispatch('month_name', 'dbt_date') (date, short) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__month_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.634799, "supported_languages": null}, "macro.dbt_date.default__month_name": {"unique_id": "macro.dbt_date.default__month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\month_name.sql", "original_file_path": "macros\\calendar_date\\month_name.sql", "name": "default__month_name", "macro_sql": "\r\n\r\n{%- macro default__month_name(date, short) -%}\r\n{%- set f = 'MON' if short else 'MONTH' -%}\r\n    to_char({{ date }}, '{{ f }}')\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.634799, "supported_languages": null}, "macro.dbt_date.bigquery__month_name": {"unique_id": "macro.dbt_date.bigquery__month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\month_name.sql", "original_file_path": "macros\\calendar_date\\month_name.sql", "name": "bigquery__month_name", "macro_sql": "\r\n\r\n{%- macro bigquery__month_name(date, short) -%}\r\n{%- set f = '%b' if short else '%B' -%}\r\n    format_date('{{ f }}', cast({{ date }} as date))\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.634799, "supported_languages": null}, "macro.dbt_date.snowflake__month_name": {"unique_id": "macro.dbt_date.snowflake__month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\month_name.sql", "original_file_path": "macros\\calendar_date\\month_name.sql", "name": "snowflake__month_name", "macro_sql": "\r\n\r\n{%- macro snowflake__month_name(date, short) -%}\r\n{%- set f = 'MON' if short else 'MMMM' -%}\r\n    to_char({{ date }}, '{{ f }}')\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6357994, "supported_languages": null}, "macro.dbt_date.postgres__month_name": {"unique_id": "macro.dbt_date.postgres__month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\month_name.sql", "original_file_path": "macros\\calendar_date\\month_name.sql", "name": "postgres__month_name", "macro_sql": "\r\n\r\n{%- macro postgres__month_name(date, short) -%}\r\n{# FM = Fill mode, which suppresses padding blanks #}\r\n{%- set f = 'FMMon' if short else 'FMMonth' -%}\r\n    to_char({{ date }}, '{{ f }}')\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6357994, "supported_languages": null}, "macro.dbt_date.next_month": {"unique_id": "macro.dbt_date.next_month", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\next_month.sql", "original_file_path": "macros\\calendar_date\\next_month.sql", "name": "next_month", "macro_sql": "{%- macro next_month(tz=None) -%}\r\n{{ dbt_date.n_months_away(1, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_months_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6357994, "supported_languages": null}, "macro.dbt_date.next_month_name": {"unique_id": "macro.dbt_date.next_month_name", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\next_month_name.sql", "original_file_path": "macros\\calendar_date\\next_month_name.sql", "name": "next_month_name", "macro_sql": "{%- macro next_month_name(short=True, tz=None) -%}\r\n{{ dbt_date.month_name(dbt_date.next_month(1, tz), short=short) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.month_name", "macro.dbt_date.next_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6367996, "supported_languages": null}, "macro.dbt_date.next_month_number": {"unique_id": "macro.dbt_date.next_month_number", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\next_month_number.sql", "original_file_path": "macros\\calendar_date\\next_month_number.sql", "name": "next_month_number", "macro_sql": "{%- macro next_month_number(tz=None) -%}\r\n{{ dbt_date.date_part('month', dbt_date.next_month(1, tz)) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt_date.next_month"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6377997, "supported_languages": null}, "macro.dbt_date.next_week": {"unique_id": "macro.dbt_date.next_week", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\next_week.sql", "original_file_path": "macros\\calendar_date\\next_week.sql", "name": "next_week", "macro_sql": "{%- macro next_week(tz=None) -%}\r\n{{ dbt_date.n_weeks_away(1, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_weeks_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6377997, "supported_languages": null}, "macro.dbt_date.now": {"unique_id": "macro.dbt_date.now", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\now.sql", "original_file_path": "macros\\calendar_date\\now.sql", "name": "now", "macro_sql": "{%- macro now(tz=None) -%}\r\n{{ dbt_date.convert_timezone(dbt_utils.current_timestamp(), tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.convert_timezone", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6387994, "supported_languages": null}, "macro.dbt_date.n_days_ago": {"unique_id": "macro.dbt_date.n_days_ago", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\n_days_ago.sql", "original_file_path": "macros\\calendar_date\\n_days_ago.sql", "name": "n_days_ago", "macro_sql": "{%- macro n_days_ago(n, date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{%- set n = n|int -%}\r\ncast({{ dbt_utils.dateadd('day', -1 * n, dt) }} as date)\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6397994, "supported_languages": null}, "macro.dbt_date.n_days_away": {"unique_id": "macro.dbt_date.n_days_away", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\n_days_away.sql", "original_file_path": "macros\\calendar_date\\n_days_away.sql", "name": "n_days_away", "macro_sql": "{%- macro n_days_away(n, date=None, tz=None) -%}\r\n{{ dbt_date.n_days_ago(-1 * n, date, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_days_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.640799, "supported_languages": null}, "macro.dbt_date.n_months_ago": {"unique_id": "macro.dbt_date.n_months_ago", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\n_months_ago.sql", "original_file_path": "macros\\calendar_date\\n_months_ago.sql", "name": "n_months_ago", "macro_sql": "{%- macro n_months_ago(n, tz=None) -%}\r\n{%- set n = n|int -%}\r\n{{ dbt_utils.date_trunc('month', \r\n    dbt_utils.dateadd('month', -1 * n, \r\n        dbt_date.today(tz)\r\n        )\r\n    ) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.640799, "supported_languages": null}, "macro.dbt_date.n_months_away": {"unique_id": "macro.dbt_date.n_months_away", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\n_months_away.sql", "original_file_path": "macros\\calendar_date\\n_months_away.sql", "name": "n_months_away", "macro_sql": "{%- macro n_months_away(n, tz=None) -%}\r\n{%- set n = n|int -%}\r\n{{ dbt_utils.date_trunc('month', \r\n    dbt_utils.dateadd('month', n, \r\n        dbt_date.today(tz)\r\n        )\r\n    ) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6417992, "supported_languages": null}, "macro.dbt_date.n_weeks_ago": {"unique_id": "macro.dbt_date.n_weeks_ago", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\n_weeks_ago.sql", "original_file_path": "macros\\calendar_date\\n_weeks_ago.sql", "name": "n_weeks_ago", "macro_sql": "{%- macro n_weeks_ago(n, tz=None) -%}\r\n{%- set n = n|int -%}\r\n{{ dbt_utils.date_trunc('week', \r\n    dbt_utils.dateadd('week', -1 * n, \r\n        dbt_date.today(tz)\r\n        )\r\n    ) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6427991, "supported_languages": null}, "macro.dbt_date.n_weeks_away": {"unique_id": "macro.dbt_date.n_weeks_away", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\n_weeks_away.sql", "original_file_path": "macros\\calendar_date\\n_weeks_away.sql", "name": "n_weeks_away", "macro_sql": "{%- macro n_weeks_away(n, tz=None) -%}\r\n{%- set n = n|int -%}\r\n{{ dbt_utils.date_trunc('week', \r\n    dbt_utils.dateadd('week', n, \r\n        dbt_date.today(tz)\r\n        )\r\n    ) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.date_trunc", "macro.dbt.dateadd", "macro.dbt_date.today"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.643799, "supported_languages": null}, "macro.dbt_date.periods_since": {"unique_id": "macro.dbt_date.periods_since", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\periods_since.sql", "original_file_path": "macros\\calendar_date\\periods_since.sql", "name": "periods_since", "macro_sql": "{%- macro periods_since(date_col, period_name='day', tz=None) -%}\r\n{{ dbt_utils.datediff(date_col, dbt_date.now(tz), period_name) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.datediff", "macro.dbt_date.now"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6447992, "supported_languages": null}, "macro.dbt_date.today": {"unique_id": "macro.dbt_date.today", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\today.sql", "original_file_path": "macros\\calendar_date\\today.sql", "name": "today", "macro_sql": "{%- macro today(tz=None) -%}\r\ncast({{ dbt_date.now(tz) }} as date)\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.now"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6447992, "supported_languages": null}, "macro.dbt_date.tomorrow": {"unique_id": "macro.dbt_date.tomorrow", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\tomorrow.sql", "original_file_path": "macros\\calendar_date\\tomorrow.sql", "name": "tomorrow", "macro_sql": "{%- macro tomorrow(date=None, tz=None) -%}\r\n{{ dbt_date.n_days_away(1, date, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6457996, "supported_languages": null}, "macro.dbt_date.to_unixtimestamp": {"unique_id": "macro.dbt_date.to_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\to_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\to_unixtimestamp.sql", "name": "to_unixtimestamp", "macro_sql": "{%- macro to_unixtimestamp(timestamp) -%}\r\n    {{ adapter.dispatch('to_unixtimestamp', 'dbt_date') (timestamp) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__to_unixtimestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.646802, "supported_languages": null}, "macro.dbt_date.default__to_unixtimestamp": {"unique_id": "macro.dbt_date.default__to_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\to_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\to_unixtimestamp.sql", "name": "default__to_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro default__to_unixtimestamp(timestamp) -%}\r\n    {{ dbt_date.date_part('epoch', timestamp) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.646802, "supported_languages": null}, "macro.dbt_date.snowflake__to_unixtimestamp": {"unique_id": "macro.dbt_date.snowflake__to_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\to_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\to_unixtimestamp.sql", "name": "snowflake__to_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro snowflake__to_unixtimestamp(timestamp) -%}\r\n    {{ dbt_date.date_part('epoch_seconds', timestamp) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.646802, "supported_languages": null}, "macro.dbt_date.bigquery__to_unixtimestamp": {"unique_id": "macro.dbt_date.bigquery__to_unixtimestamp", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\to_unixtimestamp.sql", "original_file_path": "macros\\calendar_date\\to_unixtimestamp.sql", "name": "bigquery__to_unixtimestamp", "macro_sql": "\r\n\r\n{%- macro bigquery__to_unixtimestamp(timestamp) -%}\r\n    unix_seconds({{ timestamp }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.646802, "supported_languages": null}, "macro.dbt_date.week_end": {"unique_id": "macro.dbt_date.week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_end.sql", "original_file_path": "macros\\calendar_date\\week_end.sql", "name": "week_end", "macro_sql": "{%- macro week_end(date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{{ adapter.dispatch('week_end', 'dbt_date') (dt) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__week_end"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6477995, "supported_languages": null}, "macro.dbt_date.default__week_end": {"unique_id": "macro.dbt_date.default__week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_end.sql", "original_file_path": "macros\\calendar_date\\week_end.sql", "name": "default__week_end", "macro_sql": "{%- macro default__week_end(date) -%}\r\n{{ dbt_utils.last_day(date, 'week') }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6487994, "supported_languages": null}, "macro.dbt_date.snowflake__week_end": {"unique_id": "macro.dbt_date.snowflake__week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_end.sql", "original_file_path": "macros\\calendar_date\\week_end.sql", "name": "snowflake__week_end", "macro_sql": "\r\n\r\n{%- macro snowflake__week_end(date) -%}\r\n{%- set dt = dbt_date.week_start(date) -%}\r\n{{ dbt_date.n_days_away(6, dt) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6487994, "supported_languages": null}, "macro.dbt_date.postgres__week_end": {"unique_id": "macro.dbt_date.postgres__week_end", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_end.sql", "original_file_path": "macros\\calendar_date\\week_end.sql", "name": "postgres__week_end", "macro_sql": "\r\n\r\n{%- macro postgres__week_end(date) -%}\r\n{%- set dt = dbt_date.week_start(date) -%}\r\n{{ dbt_date.n_days_away(6, dt) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.week_start", "macro.dbt_date.n_days_away"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6487994, "supported_languages": null}, "macro.dbt_date.week_of_year": {"unique_id": "macro.dbt_date.week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_of_year.sql", "original_file_path": "macros\\calendar_date\\week_of_year.sql", "name": "week_of_year", "macro_sql": "{%- macro week_of_year(date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{{ adapter.dispatch('week_of_year', 'dbt_date') (dt) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__week_of_year"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6497996, "supported_languages": null}, "macro.dbt_date.default__week_of_year": {"unique_id": "macro.dbt_date.default__week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_of_year.sql", "original_file_path": "macros\\calendar_date\\week_of_year.sql", "name": "default__week_of_year", "macro_sql": "{%- macro default__week_of_year(date) -%}\r\ncast({{ dbt_date.date_part('week', date) }} as {{ dbt_utils.type_int() }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.date_part", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6507993, "supported_languages": null}, "macro.dbt_date.postgres__week_of_year": {"unique_id": "macro.dbt_date.postgres__week_of_year", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_of_year.sql", "original_file_path": "macros\\calendar_date\\week_of_year.sql", "name": "postgres__week_of_year", "macro_sql": "\r\n\r\n{%- macro postgres__week_of_year(date) -%}\r\n{# postgresql 'week' returns isoweek. Use to_char instead.\r\n   WW = the first week starts on the first day of the year #}\r\ncast(to_char({{ date }}, 'WW') as {{ dbt_utils.type_int() }})\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6507993, "supported_languages": null}, "macro.dbt_date.week_start": {"unique_id": "macro.dbt_date.week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_start.sql", "original_file_path": "macros\\calendar_date\\week_start.sql", "name": "week_start", "macro_sql": "{%- macro week_start(date=None, tz=None) -%}\r\n{%-set dt = date if date else dbt_date.today(tz) -%}\r\n{{ adapter.dispatch('week_start', 'dbt_date') (dt) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.today", "macro.dbt_date.default__week_start"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.651799, "supported_languages": null}, "macro.dbt_date.default__week_start": {"unique_id": "macro.dbt_date.default__week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_start.sql", "original_file_path": "macros\\calendar_date\\week_start.sql", "name": "default__week_start", "macro_sql": "{%- macro default__week_start(date) -%}\r\ncast({{ dbt_utils.date_trunc('week', date) }} as date)\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.651799, "supported_languages": null}, "macro.dbt_date.snowflake__week_start": {"unique_id": "macro.dbt_date.snowflake__week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_start.sql", "original_file_path": "macros\\calendar_date\\week_start.sql", "name": "snowflake__week_start", "macro_sql": "\r\n\r\n{%- macro snowflake__week_start(date) -%}\r\n    {#\r\n        Get the day of week offset: e.g. if the date is a Sunday,\r\n        dbt_date.day_of_week returns 1, so we subtract 1 to get a 0 offset\r\n    #}\r\n    {% set off_set = dbt_date.day_of_week(date, isoweek=False) ~ \" - 1\" %}\r\n    cast({{ dbt_utils.dateadd(\"day\", \"-1 * (\" ~ off_set ~ \")\", date) }} as date)\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.day_of_week", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6527996, "supported_languages": null}, "macro.dbt_date.postgres__week_start": {"unique_id": "macro.dbt_date.postgres__week_start", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\week_start.sql", "original_file_path": "macros\\calendar_date\\week_start.sql", "name": "postgres__week_start", "macro_sql": "\r\n\r\n{%- macro postgres__week_start(date) -%}\r\n-- Sunday as week start date\r\ncast({{ dbt_utils.dateadd('day', -1, dbt_utils.date_trunc('week', dbt_utils.dateadd('day', 1, date))) }} as date)\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6527996, "supported_languages": null}, "macro.dbt_date.yesterday": {"unique_id": "macro.dbt_date.yesterday", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\calendar_date\\yesterday.sql", "original_file_path": "macros\\calendar_date\\yesterday.sql", "name": "yesterday", "macro_sql": "{%- macro yesterday(date=None, tz=None) -%}\r\n{{ dbt_date.n_days_ago(1, date, tz) }}\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.n_days_ago"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.653799, "supported_languages": null}, "macro.dbt_date.get_fiscal_periods": {"unique_id": "macro.dbt_date.get_fiscal_periods", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\fiscal_date\\get_fiscal_periods.sql", "original_file_path": "macros\\fiscal_date\\get_fiscal_periods.sql", "name": "get_fiscal_periods", "macro_sql": "{% macro get_fiscal_periods(dates, year_end_month, week_start_day, shift_year=1) %}\r\n{# \r\nThis macro requires you to pass in a ref to a date dimension, created via\r\ndbt_date.get_date_dimension()s\r\n#}\r\nwith fscl_year_dates_for_periods as (\r\n    {{ dbt_date.get_fiscal_year_dates(dates, year_end_month, week_start_day, shift_year) }}\r\n),\r\nfscl_year_w13 as (\r\n\r\n    select\r\n        f.*,\r\n        -- We count the weeks in a 13 week period\r\n        -- and separate the 4-5-4 week sequences\r\n        mod(cast(\r\n            (f.fiscal_week_of_year-1) as {{ dbt_utils.type_int() }}\r\n            ), 13) as w13_number,\r\n        -- Chop weeks into 13 week merch quarters\r\n        cast(\r\n            least(\r\n                floor((f.fiscal_week_of_year-1)/13.0)\r\n                , 3)\r\n            as {{ dbt_utils.type_int() }}) as quarter_number\r\n    from\r\n        fscl_year_dates_for_periods f\r\n\r\n),\r\nfscl_periods as (\r\n\r\n    select\r\n        f.date_day,\r\n        f.fiscal_year_number,\r\n        f.week_start_date,\r\n        f.week_end_date,\r\n        f.fiscal_week_of_year,\r\n        case \r\n            -- we move week 53 into the 3rd period of the quarter\r\n            when f.fiscal_week_of_year = 53 then 3\r\n            when f.w13_number between 0 and 3 then 1\r\n            when f.w13_number between 4 and 8 then 2\r\n            when f.w13_number between 9 and 12 then 3\r\n        end as period_of_quarter,\r\n        f.quarter_number\r\n    from\r\n        fscl_year_w13 f\r\n\r\n),\r\nfscl_periods_quarters as (\r\n\r\n    select\r\n        f.*,\r\n        cast((\r\n            (f.quarter_number * 3) + f.period_of_quarter\r\n         ) as {{ dbt_utils.type_int() }}) as fiscal_period_number\r\n    from\r\n        fscl_periods f\r\n\r\n)\r\nselect\r\n    date_day,\r\n    fiscal_year_number,\r\n    week_start_date,\r\n    week_end_date,\r\n    fiscal_week_of_year, \r\n    dense_rank() over(partition by fiscal_period_number order by fiscal_week_of_year) as fiscal_week_of_period,\r\n    fiscal_period_number,\r\n    quarter_number+1 as fiscal_quarter_number,\r\n    period_of_quarter as fiscal_period_of_quarter\r\nfrom \r\n    fscl_periods_quarters \r\norder by 1,2\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.get_fiscal_year_dates", "macro.dbt.type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6548011, "supported_languages": null}, "macro.dbt_date.get_fiscal_year_dates": {"unique_id": "macro.dbt_date.get_fiscal_year_dates", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\fiscal_date\\get_fiscal_year_dates.sql", "original_file_path": "macros\\fiscal_date\\get_fiscal_year_dates.sql", "name": "get_fiscal_year_dates", "macro_sql": "{% macro get_fiscal_year_dates(dates, year_end_month=12, week_start_day=1, shift_year=1) %}\r\n{{ adapter.dispatch('get_fiscal_year_dates', 'dbt_date') (dates, year_end_month, week_start_day, shift_year) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_date.default__get_fiscal_year_dates"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6577995, "supported_languages": null}, "macro.dbt_date.default__get_fiscal_year_dates": {"unique_id": "macro.dbt_date.default__get_fiscal_year_dates", "package_name": "dbt_date", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-date", "path": "macros\\fiscal_date\\get_fiscal_year_dates.sql", "original_file_path": "macros\\fiscal_date\\get_fiscal_year_dates.sql", "name": "default__get_fiscal_year_dates", "macro_sql": "{% macro default__get_fiscal_year_dates(dates, year_end_month, week_start_day, shift_year) %}\r\n-- this gets all the dates within a fiscal year\r\n-- determined by the given year-end-month\r\n-- ending on the saturday closest to that month's end date\r\nwith date_dimension as (\r\n    select * from {{ dates }}\r\n),\r\nyear_month_end as (\r\n\r\n    select\r\n       d.year_number - {{ shift_year }} as fiscal_year_number,\r\n       d.month_end_date\r\n    from\r\n        date_dimension d\r\n    where\r\n        d.month_of_year = {{ year_end_month }}\r\n    group by 1,2\r\n\r\n),\r\nweeks as (\r\n\r\n    select\r\n        d.year_number,\r\n        d.month_of_year,\r\n        d.date_day as week_start_date,\r\n        cast({{ dbt_utils.dateadd('day', 6, 'd.date_day') }} as date) as week_end_date\r\n    from\r\n        date_dimension d\r\n    where\r\n        d.day_of_week = {{ week_start_day }}\r\n\r\n),\r\n-- get all the weeks that start in the month the year ends\r\nyear_week_ends as (\r\n\r\n    select\r\n        d.year_number - {{ shift_year }} as fiscal_year_number,\r\n        d.week_end_date\r\n    from\r\n        weeks d\r\n    where\r\n        d.month_of_year = {{ year_end_month }}\r\n    group by\r\n        1,2\r\n\r\n),\r\n-- then calculate which Saturday is closest to month end\r\nweeks_at_month_end as (\r\n\r\n    select\r\n        d.fiscal_year_number,\r\n        d.week_end_date,\r\n        m.month_end_date,\r\n        rank() over\r\n            (partition by d.fiscal_year_number\r\n                order by\r\n                abs({{ dbt_utils.datediff('d.week_end_date', 'm.month_end_date', 'day') }})\r\n\r\n            ) as closest_to_month_end\r\n    from\r\n        year_week_ends d\r\n        join\r\n        year_month_end m on d.fiscal_year_number = m.fiscal_year_number\r\n),\r\nfiscal_year_range as (\r\n\r\n    select\r\n        w.fiscal_year_number,\r\n        cast(\r\n            {{ dbt_utils.dateadd('day', 1,\r\n            'lag(w.week_end_date) over(order by w.week_end_date)') }}\r\n            as date) as fiscal_year_start_date,\r\n        w.week_end_date as fiscal_year_end_date\r\n    from\r\n        weeks_at_month_end w\r\n    where\r\n        w.closest_to_month_end = 1\r\n\r\n),\r\nfiscal_year_dates as (\r\n\r\n    select\r\n        d.date_day,\r\n        m.fiscal_year_number,\r\n        m.fiscal_year_start_date,\r\n        m.fiscal_year_end_date,\r\n        w.week_start_date,\r\n        w.week_end_date,\r\n        -- we reset the weeks of the year starting with the merch year start date\r\n        dense_rank()\r\n            over(\r\n                partition by m.fiscal_year_number\r\n                order by w.week_start_date\r\n                ) as fiscal_week_of_year\r\n    from\r\n        date_dimension d\r\n        join\r\n        fiscal_year_range m on d.date_day between m.fiscal_year_start_date and m.fiscal_year_end_date\r\n        join\r\n        weeks w on d.date_day between w.week_start_date and w.week_end_date\r\n\r\n)\r\nselect * from fiscal_year_dates order by 1\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6587994, "supported_languages": null}, "macro.dbt_external_tables.create_external_table": {"unique_id": "macro.dbt_external_tables.create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\create_external_table.sql", "original_file_path": "macros\\common\\create_external_table.sql", "name": "create_external_table", "macro_sql": "{% macro create_external_table(source_node) %}\r\n    {{ adapter.dispatch('create_external_table', 'dbt_external_tables')(source_node) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__create_external_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6587994, "supported_languages": null}, "macro.dbt_external_tables.default__create_external_table": {"unique_id": "macro.dbt_external_tables.default__create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\create_external_table.sql", "original_file_path": "macros\\common\\create_external_table.sql", "name": "default__create_external_table", "macro_sql": "{% macro default__create_external_table(source_node) %}\r\n    {{ exceptions.raise_compiler_error(\"External table creation is not implemented for the default adapter\") }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.659799, "supported_languages": null}, "macro.dbt_external_tables.get_external_build_plan": {"unique_id": "macro.dbt_external_tables.get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\get_external_build_plan.sql", "original_file_path": "macros\\common\\get_external_build_plan.sql", "name": "get_external_build_plan", "macro_sql": "{% macro get_external_build_plan(source_node) %}\r\n    {{ return(adapter.dispatch('get_external_build_plan', 'dbt_external_tables')(source_node)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__get_external_build_plan"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.659799, "supported_languages": null}, "macro.dbt_external_tables.default__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.default__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\get_external_build_plan.sql", "original_file_path": "macros\\common\\get_external_build_plan.sql", "name": "default__get_external_build_plan", "macro_sql": "{% macro default__get_external_build_plan(source_node) %}\r\n    {{ exceptions.raise_compiler_error(\"Staging external sources is not implemented for the default adapter\") }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6607993, "supported_languages": null}, "macro.dbt_external_tables.refresh_external_table": {"unique_id": "macro.dbt_external_tables.refresh_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\refresh_external_table.sql", "original_file_path": "macros\\common\\refresh_external_table.sql", "name": "refresh_external_table", "macro_sql": "{% macro refresh_external_table(source_node) %}\r\n    {{ return(adapter.dispatch('refresh_external_table', 'dbt_external_tables')(source_node)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6607993, "supported_languages": null}, "macro.dbt_external_tables.default__refresh_external_table": {"unique_id": "macro.dbt_external_tables.default__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\refresh_external_table.sql", "original_file_path": "macros\\common\\refresh_external_table.sql", "name": "default__refresh_external_table", "macro_sql": "{% macro default__refresh_external_table(source_node) %}\r\n    {% do return([]) %}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6617994, "supported_languages": null}, "macro.dbt_external_tables.stage_external_sources": {"unique_id": "macro.dbt_external_tables.stage_external_sources", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\stage_external_sources.sql", "original_file_path": "macros\\common\\stage_external_sources.sql", "name": "stage_external_sources", "macro_sql": "{% macro stage_external_sources(select=none) %}\r\n\r\n    {% set sources_to_stage = [] %}\r\n    \r\n    {% set source_nodes = graph.sources.values() if graph.sources else [] %}\r\n    \r\n    {% for node in source_nodes %}\r\n        {% if node.external %}\r\n            \r\n            {% if select %}\r\n            \r\n                {% for src in select.split(' ') %}\r\n                \r\n                    {% if '.' in src %}\r\n                        {% set src_s = src.split('.') %}\r\n                        {% if src_s[0] == node.source_name and src_s[1] == node.name %}\r\n                            {% do sources_to_stage.append(node) %}\r\n                        {% endif %}\r\n                    {% else %}\r\n                        {% if src == node.source_name %}\r\n                            {% do sources_to_stage.append(node) %}\r\n                        {% endif %}\r\n                    {% endif %}\r\n                    \r\n                {% endfor %}\r\n                        \r\n            {% else %}\r\n            \r\n                {% do sources_to_stage.append(node) %}\r\n                \r\n            {% endif %}\r\n        {% endif %}\r\n        \r\n    {% endfor %}\r\n    \r\n    {% if sources_to_stage|length == 0 %}\r\n        {% do log('No external sources selected', info = true) %}\r\n    {% endif %}\r\n            \r\n    {% for node in sources_to_stage %}\r\n\r\n        {% set loop_label = loop.index ~ ' of ' ~ loop.length %}\r\n\r\n        {% do log(loop_label ~ ' START external source ' ~ node.schema ~ '.' ~ node.identifier, info = true) -%}\r\n        \r\n        {% set run_queue = dbt_external_tables.get_external_build_plan(node) %}\r\n        \r\n        {% do log(loop_label ~ ' SKIP', info = true) if run_queue == [] %}\r\n        {% set width = flags.PRINTER_WIDTH %}\r\n        \r\n        {% for q in run_queue %}\r\n        \r\n            {% set q_msg = q|replace('\\n','')|replace('begin;','')|trim %}\r\n            {% set q_log = q_msg[:width] ~ '...  ' if q_msg|length > width else q_msg %}\r\n        \r\n            {% do log(loop_label ~ ' (' ~ loop.index ~ ') ' ~ q_log, info = true) %}\r\n            {% set exit_txn = dbt_external_tables.exit_transaction() %}\r\n        \r\n            {% call statement('runner', fetch_result = True, auto_begin = False) %}\r\n                {{ exit_txn }} {{ q }}\r\n            {% endcall %}\r\n            \r\n            {% set runner = load_result('runner') %}\r\n            {% set log_msg = runner['response'] if 'response' in runner.keys() else runner['status'] %}\r\n            {% do log(loop_label ~ ' (' ~ loop.index ~ ') ' ~ log_msg, info = true) %}\r\n            \r\n        {% endfor %}\r\n        \r\n    {% endfor %}\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.get_external_build_plan", "macro.dbt_external_tables.exit_transaction", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.669799, "supported_languages": null}, "macro.dbt_external_tables.dropif": {"unique_id": "macro.dbt_external_tables.dropif", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\helpers\\dropif.sql", "original_file_path": "macros\\common\\helpers\\dropif.sql", "name": "dropif", "macro_sql": "{% macro dropif(node) %}\r\n    {{ adapter.dispatch('dropif', 'dbt_external_tables')(node) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__dropif"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6707997, "supported_languages": null}, "macro.dbt_external_tables.default__dropif": {"unique_id": "macro.dbt_external_tables.default__dropif", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\helpers\\dropif.sql", "original_file_path": "macros\\common\\helpers\\dropif.sql", "name": "default__dropif", "macro_sql": "{% macro default__dropif() %}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"Dropping external tables is not implemented for the default adapter\"\r\n    ) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6717992, "supported_languages": null}, "macro.dbt_external_tables.exit_transaction": {"unique_id": "macro.dbt_external_tables.exit_transaction", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\helpers\\transaction.sql", "original_file_path": "macros\\common\\helpers\\transaction.sql", "name": "exit_transaction", "macro_sql": "{% macro exit_transaction() %}\r\n    {{ return(adapter.dispatch('exit_transaction', 'dbt_external_tables')()) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.default__exit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6717992, "supported_languages": null}, "macro.dbt_external_tables.default__exit_transaction": {"unique_id": "macro.dbt_external_tables.default__exit_transaction", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\common\\helpers\\transaction.sql", "original_file_path": "macros\\common\\helpers\\transaction.sql", "name": "default__exit_transaction", "macro_sql": "{% macro default__exit_transaction() %}\r\n    {{ return('') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6717992, "supported_languages": null}, "macro.dbt_external_tables.bigquery__create_external_table": {"unique_id": "macro.dbt_external_tables.bigquery__create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\bigquery\\create_external_table.sql", "original_file_path": "macros\\plugins\\bigquery\\create_external_table.sql", "name": "bigquery__create_external_table", "macro_sql": "{% macro bigquery__create_external_table(source_node) %}\r\n\r\n    {%- set columns = source_node.columns.values() -%}\r\n    {%- set external = source_node.external -%}\r\n    {%- set partitions = external.partitions -%}\r\n    {%- set options = external.options -%}\r\n    \r\n    {%- set uris = [] -%}\r\n    {%- if options is mapping and options.get('uris', none) -%}\r\n        {%- set uris = external.options.get('uris') -%}\r\n    {%- else -%}\r\n        {%- set uris = [external.location] -%}\r\n    {%- endif -%}\r\n\r\n    create or replace external table {{source(source_node.source_name, source_node.name)}}\r\n        {%- if columns -%}(\r\n            {% for column in columns %}\r\n                {{column.name}} {{column.data_type}} {{- ',' if not loop.last -}}\r\n            {%- endfor -%}\r\n        )\r\n        {% endif %}\r\n        {% if options and options.get('hive_partition_uri_prefix', none) %}\r\n        with partition columns {%- if partitions %} (\r\n            {%- for partition in partitions %}\r\n                {{partition.name}} {{partition.data_type}}{{',' if not loop.last}}\r\n            {%- endfor -%}\r\n        ) {% endif -%}\r\n        {% endif %}\r\n        options (\r\n            uris = [{%- for uri in uris -%} '{{uri}}' {{- \",\" if not loop.last}} {%- endfor -%}]\r\n            {%- if options is mapping -%}\r\n            {%- for key, value in options.items() if key != 'uris' %}\r\n                {%- if value is string -%}\r\n                , {{key}} = '{{value}}'\r\n                {%- else -%}\r\n                , {{key}} = {{value}}\r\n                {%- endif -%}\r\n            {%- endfor -%}\r\n            {%- endif -%}\r\n        )\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.676799, "supported_languages": null}, "macro.dbt_external_tables.bigquery__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.bigquery__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\bigquery\\get_external_build_plan.sql", "original_file_path": "macros\\plugins\\bigquery\\get_external_build_plan.sql", "name": "bigquery__get_external_build_plan", "macro_sql": "{% macro bigquery__get_external_build_plan(source_node) %}\r\n\r\n    {% set build_plan = [] %}\r\n    \r\n    {% set old_relation = adapter.get_relation(\r\n        database = source_node.database,\r\n        schema = source_node.schema,\r\n        identifier = source_node.identifier\r\n    ) %}\r\n    \r\n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\r\n\r\n    {% if create_or_replace %}\r\n        {% set build_plan = build_plan + [dbt_external_tables.create_external_table(source_node)] %}\r\n    {% else %}\r\n        {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\r\n    {% endif %}\r\n\r\n    {% do return(build_plan) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6787999, "supported_languages": null}, "macro.dbt_external_tables.redshift__create_external_table": {"unique_id": "macro.dbt_external_tables.redshift__create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\create_external_table.sql", "original_file_path": "macros\\plugins\\redshift\\create_external_table.sql", "name": "redshift__create_external_table", "macro_sql": "{% macro redshift__create_external_table(source_node) %}\r\n\r\n    {%- set columns = source_node.columns.values() -%}\r\n    {%- set external = source_node.external -%}\r\n    {%- set partitions = external.partitions -%}\r\n\r\n{# https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE.html #}\r\n{# This assumes you have already created an external schema #}\r\n\r\n    create external table {{source(source_node.source_name, source_node.name)}} (\r\n        {% for column in columns %}\r\n            {{adapter.quote(column.name)}} {{column.data_type}}\r\n            {{- ',' if not loop.last -}}\r\n        {% endfor %}\r\n    )\r\n    {% if partitions -%} partitioned by (\r\n        {%- for partition in partitions -%}\r\n            {{adapter.quote(partition.name)}} {{partition.data_type}}{{', ' if not loop.last}}\r\n        {%- endfor -%}\r\n    ) {%- endif %}\r\n    {% if external.row_format -%} row format {{external.row_format}} {%- endif %}\r\n    {% if external.file_format -%} stored as {{external.file_format}} {%- endif %}\r\n    {% if external.location -%} location '{{external.location}}' {%- endif %}\r\n    {% if external.table_properties -%} table properties {{external.table_properties}} {%- endif %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6807992, "supported_languages": null}, "macro.dbt_external_tables.redshift__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.redshift__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\get_external_build_plan.sql", "original_file_path": "macros\\plugins\\redshift\\get_external_build_plan.sql", "name": "redshift__get_external_build_plan", "macro_sql": "{% macro redshift__get_external_build_plan(source_node) %}\r\n\r\n    {% set build_plan = [] %}\r\n    \r\n    {% set create_or_replace = (var('ext_full_refresh', false) or not redshift_is_ext_tbl(source_node)) %}\r\n    \r\n    {% if create_or_replace %}\r\n\r\n        {% set build_plan = [\r\n                dbt_external_tables.dropif(source_node),\r\n                dbt_external_tables.create_external_table(source_node)\r\n            ] + dbt_external_tables.refresh_external_table(source_node) \r\n        %}\r\n        \r\n    {% else %}\r\n    \r\n        {% set build_plan = dbt_external_tables.refresh_external_table(source_node) %}\r\n        \r\n    {% endif %}\r\n    \r\n    {% do return(build_plan) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.redshift_is_ext_tbl", "macro.dbt_external_tables.dropif", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6827986, "supported_languages": null}, "macro.dbt_external_tables.redshift__refresh_external_table": {"unique_id": "macro.dbt_external_tables.redshift__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\refresh_external_table.sql", "original_file_path": "macros\\plugins\\redshift\\refresh_external_table.sql", "name": "redshift__refresh_external_table", "macro_sql": "{% macro redshift__refresh_external_table(source_node) %}\r\n\r\n    {%- set partitions = source_node.external.get('partitions',[]) -%}\r\n\r\n    {%- if partitions -%}\r\n    \r\n        {%- set part_len = partitions|length -%}\r\n    \r\n        {%- set get_partitions_sql -%}\r\n        \r\n        select * from\r\n        \r\n        {%- for partition in partitions %} (\r\n        \r\n            {%- set part_num = loop.index -%}\r\n            \r\n            {%- if partition.vals.macro -%}\r\n                {%- set vals = dbt_external_tables.render_from_context(partition.vals.macro, **partition.vals.args) -%}\r\n            {%- elif partition.vals is string -%}\r\n                {%- set vals = [partition.vals] -%}\r\n            {%- else -%}\r\n                {%- set vals = partition.vals -%}\r\n            {%- endif -%}\r\n        \r\n            {%- for val in vals %}\r\n            \r\n                select\r\n                    '\"{{ partition.name }}\"' as name_{{ part_num }},\r\n                    '\"{{ val }}\"' as val_{{ part_num }},\r\n                    '\"{{ dbt_external_tables.render_from_context(partition.path_macro, partition.name, val) }}\"' as path_{{ part_num }}\r\n                \r\n                {{ 'union all' if not loop.last else ') ' }}\r\n            \r\n            {%- endfor -%}\r\n            \r\n            {{ 'cross join' if not loop.last }}\r\n            \r\n        {%- endfor -%}\r\n        \r\n        {%- endset -%}\r\n        \r\n        {%- set finals = [] -%}\r\n        \r\n        {%- if execute -%}\r\n            {%- set results = run_query(get_partitions_sql) -%}\r\n            {%- for row in results -%}\r\n                \r\n                {%- set partition_parts = [] -%}\r\n                {%- set path_parts = [] -%}\r\n                \r\n                {%- for i in range(0, part_len) -%}\r\n                    {%- do partition_parts.append({\r\n                        'name': row[i * 3][1:-1],\r\n                        'value': row[i * 3 + 1][1:-1]\r\n                    }) -%}\r\n                    {%- do path_parts.append(row[i * 3 + 2][1:-1]) -%}\r\n                {%- endfor -%}\r\n                \r\n                {%- set construct = {\r\n                    'partition_by': partition_parts,\r\n                    'path': path_parts | join('/')\r\n                }  -%}\r\n                \r\n                {% do finals.append(construct) %}\r\n            {%- endfor -%}\r\n        {%- endif -%}\r\n    \r\n        {%- set ddl = dbt_external_tables.redshift_alter_table_add_partitions(source_node, finals) -%}\r\n        {{ return(ddl) }}\r\n    \r\n    {% else %}\r\n    \r\n        {% do return([]) %}\r\n    \r\n    {% endif %}\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.render_from_context", "macro.dbt.run_query", "macro.dbt_external_tables.redshift_alter_table_add_partitions"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.690799, "supported_languages": null}, "macro.dbt_external_tables.redshift_alter_table_add_partitions": {"unique_id": "macro.dbt_external_tables.redshift_alter_table_add_partitions", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\add_partitions.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\add_partitions.sql", "name": "redshift_alter_table_add_partitions", "macro_sql": "{% macro redshift_alter_table_add_partitions(source_node, partitions) %}\r\n\r\n  {{ log(\"Generating ADD PARTITION statement for partition set between \" \r\n         ~ partitions[0]['path'] ~ \" and \" ~ (partitions|last)['path']) }}\r\n\r\n  {% set ddl = [] %}\r\n  \r\n  {% if partitions|length > 0 %}\r\n  \r\n    {% set alter_table_add %}\r\n        alter table {{source(source_node.source_name, source_node.name)}} add if not exists \r\n    {% endset %}\r\n  \r\n    {%- set alters -%}\r\n\r\n      {{ alter_table_add }}\r\n\r\n    {%- for partition in partitions -%}\r\n\r\n      {%- if loop.index0 != 0 and loop.index0 % 100 == 0 -%}\r\n\r\n        ; {{ alter_table_add }}\r\n\r\n      {%- endif -%}\r\n\r\n        partition ({%- for part in partition.partition_by -%}{{ part.name }}='{{ part.value }}'{{', ' if not loop.last}}{%- endfor -%})\r\n        location '{{ source_node.external.location }}/{{ partition.path }}/'\r\n\r\n    {% endfor -%}\r\n    \r\n    {%- endset -%}\r\n    \r\n    {% set ddl = ddl + alters.split(';') %}\r\n\r\n  {% else %}\r\n\r\n    {{ log(\"No partitions to be added\") }}\r\n\r\n  {% endif %}\r\n  \r\n  {% do return(ddl) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6937997, "supported_languages": null}, "macro.dbt_external_tables.redshift__dropif": {"unique_id": "macro.dbt_external_tables.redshift__dropif", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\dropif.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\dropif.sql", "name": "redshift__dropif", "macro_sql": "{% macro redshift__dropif(node) %}\r\n    \r\n    {% set ddl %}\r\n        drop table if exists {{source(node.source_name, node.name)}} cascade\r\n    {% endset %}\r\n    \r\n    {{return(ddl)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6937997, "supported_languages": null}, "macro.dbt_external_tables.redshift_is_ext_tbl": {"unique_id": "macro.dbt_external_tables.redshift_is_ext_tbl", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\is_ext_tbl.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\is_ext_tbl.sql", "name": "redshift_is_ext_tbl", "macro_sql": "{% macro redshift_is_ext_tbl(node) %}\r\n\r\n    {% set existing_relation = load_relation(node) %}\r\n    \r\n    {#  external tables don't appear in information_schema.tables,\r\n        so dbt doesn't cache them #}\r\n    {% if existing_relation is none %}\r\n\r\n        {% set find_ext_tbl %}\r\n        \r\n            select count(*) from svv_external_tables\r\n            where schemaname = '{{node.schema}}'\r\n            and tablename = '{{node.identifier}}'\r\n        \r\n        {% endset %}\r\n        \r\n        {% if execute %}\r\n            {% set result = run_query(find_ext_tbl)[0][0] %}\r\n        {% else %}\r\n            {% set result = 0 %}\r\n        {% endif %}\r\n\r\n        {% set is_ext_tbl = (result > 0) %}\r\n        {% do return(is_ext_tbl) %}\r\n        \r\n    {% else %}\r\n    \r\n        {% do return(false) %}\r\n        \r\n    {% endif %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6958, "supported_languages": null}, "macro.dbt_external_tables.year_month_day": {"unique_id": "macro.dbt_external_tables.year_month_day", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\paths.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\paths.sql", "name": "year_month_day", "macro_sql": "{% macro year_month_day(name, value) %}\r\n    {% set path = value.replace('-','/') %}\r\n    {{return(path)}}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.replace"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6967995, "supported_languages": null}, "macro.dbt_external_tables.key_value": {"unique_id": "macro.dbt_external_tables.key_value", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\paths.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\paths.sql", "name": "key_value", "macro_sql": "{% macro key_value(name, value) %}\r\n    {% set path = name ~ '=' ~ value %}\r\n    {{return(path)}}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6977994, "supported_languages": null}, "macro.dbt_external_tables.value_only": {"unique_id": "macro.dbt_external_tables.value_only", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\paths.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\paths.sql", "name": "value_only", "macro_sql": "{% macro value_only(name, value) %}\r\n    {% set path = value %}\r\n    {{return(path)}}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6977994, "supported_languages": null}, "macro.dbt_external_tables.render_from_context": {"unique_id": "macro.dbt_external_tables.render_from_context", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\render_macro.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\render_macro.sql", "name": "render_from_context", "macro_sql": "{% macro render_from_context(name) -%}\r\n{% set original_name = name %}\r\n  {% if '.' in name %}\r\n    {% set package_name, name = name.split(\".\", 1) %}\r\n  {% else %}\r\n    {% set package_name = none %}\r\n  {% endif %}\r\n\r\n  {% if package_name is none %}\r\n    {% set package_context = context %}\r\n  {% elif package_name in context %}\r\n    {% set package_context = context[package_name] %}\r\n  {% else %}\r\n    {% set error_msg %}\r\n        Could not find package '{{package_name}}', called by macro '{{original_name}}'\r\n    {% endset %}\r\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\r\n  {% endif %}\r\n  \r\n    {{ return(package_context[name](*varargs, **kwargs)) }}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.6997995, "supported_languages": null}, "macro.dbt_external_tables.redshift__exit_transaction": {"unique_id": "macro.dbt_external_tables.redshift__exit_transaction", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\redshift\\helpers\\transaction.sql", "original_file_path": "macros\\plugins\\redshift\\helpers\\transaction.sql", "name": "redshift__exit_transaction", "macro_sql": "{% macro redshift__exit_transaction() %}\r\n    {{ return('begin; commit;') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7007995, "supported_languages": null}, "macro.dbt_external_tables.snowflake__create_external_table": {"unique_id": "macro.dbt_external_tables.snowflake__create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\create_external_table.sql", "original_file_path": "macros\\plugins\\snowflake\\create_external_table.sql", "name": "snowflake__create_external_table", "macro_sql": "{% macro snowflake__create_external_table(source_node) %}\r\n\r\n    {%- set columns = source_node.columns.values() -%}\r\n    {%- set external = source_node.external -%}\r\n    {%- set partitions = external.partitions -%}\r\n\r\n    {%- set is_csv = dbt_external_tables.is_csv(external.file_format) -%}\r\n\r\n{# https://docs.snowflake.net/manuals/sql-reference/sql/create-external-table.html #}\r\n{# This assumes you have already created an external stage #}\r\n    create or replace external table {{source(source_node.source_name, source_node.name)}}\r\n    {%- if columns or partitions -%}\r\n    (\r\n        {%- if partitions -%}{%- for partition in partitions %}\r\n            {{partition.name}} {{partition.data_type}} as {{partition.expression}}{{- ',' if not loop.last or columns|length > 0 -}}\r\n        {%- endfor -%}{%- endif -%}\r\n        {%- for column in columns %}\r\n            {%- set column_quoted = adapter.quote(column.name) if column.quote else column.name %}\r\n            {%- set col_expression -%}\r\n                {%- set col_id = 'value:c' ~ loop.index if is_csv else 'value:' ~ column.name -%}\r\n                (case when is_null_value({{col_id}}) or lower({{col_id}}) = 'null' then null else {{col_id}} end)\r\n            {%- endset %}\r\n            {{column_quoted}} {{column.data_type}} as ({{col_expression}}::{{column.data_type}})\r\n            {{- ',' if not loop.last -}}\r\n        {% endfor %}\r\n    )\r\n    {%- endif -%}\r\n    {% if partitions %} partition by ({{partitions|map(attribute='name')|join(', ')}}) {% endif %}\r\n    location = {{external.location}} {# stage #}\r\n    {% if external.auto_refresh in (true, false) -%}\r\n      auto_refresh = {{external.auto_refresh}}\r\n    {%- endif %}\r\n    {% if external.pattern -%} pattern = '{{external.pattern}}' {%- endif %}\r\n    {% if external.integration -%} integration = '{{external.integration}}' {%- endif %}\r\n    file_format = {{external.file_format}}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.is_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7047997, "supported_languages": null}, "macro.dbt_external_tables.snowflake__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.snowflake__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\get_external_build_plan.sql", "original_file_path": "macros\\plugins\\snowflake\\get_external_build_plan.sql", "name": "snowflake__get_external_build_plan", "macro_sql": "{% macro snowflake__get_external_build_plan(source_node) %}\r\n\r\n    {% set build_plan = [] %}\r\n    \r\n    {% set old_relation = adapter.get_relation(\r\n        database = source_node.database,\r\n        schema = source_node.schema,\r\n        identifier = source_node.identifier\r\n    ) %}\r\n    \r\n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\r\n\r\n    {% if source_node.external.get('snowpipe', none) is not none %}\r\n    \r\n        {% if create_or_replace %}\r\n            {% set build_plan = build_plan + [\r\n                dbt_external_tables.snowflake_create_empty_table(source_node),\r\n                dbt_external_tables.snowflake_get_copy_sql(source_node, explicit_transaction=true),\r\n                dbt_external_tables.snowflake_create_snowpipe(source_node)\r\n            ] %}\r\n        {% else %}\r\n            {% set build_plan = build_plan + dbt_external_tables.snowflake_refresh_snowpipe(source_node) %}\r\n        {% endif %}\r\n            \r\n    {% else %}\r\n    \r\n        {% if create_or_replace %}\r\n            {% set build_plan = build_plan + [dbt_external_tables.create_external_table(source_node)] %}\r\n        {% else %}\r\n            {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\r\n        {% endif %}\r\n        \r\n    {% endif %}\r\n\r\n    {% do return(build_plan) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.snowflake_create_empty_table", "macro.dbt_external_tables.snowflake_get_copy_sql", "macro.dbt_external_tables.snowflake_create_snowpipe", "macro.dbt_external_tables.snowflake_refresh_snowpipe", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7078, "supported_languages": null}, "macro.dbt_external_tables.snowflake__refresh_external_table": {"unique_id": "macro.dbt_external_tables.snowflake__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\refresh_external_table.sql", "original_file_path": "macros\\plugins\\snowflake\\refresh_external_table.sql", "name": "snowflake__refresh_external_table", "macro_sql": "{% macro snowflake__refresh_external_table(source_node) %}\r\n\r\n    {% set external = source_node.external %}\r\n    {% set snowpipe = source_node.external.get('snowpipe', none) %}\r\n    \r\n    {% set auto_refresh = external.get('auto_refresh', false) %}\r\n    {% set partitions = external.get('partitions', none) %}\r\n    \r\n    {% set manual_refresh = (partitions and not auto_refresh) %}\r\n    \r\n    {% if manual_refresh %}\r\n\r\n        {% set ddl %}\r\n        begin;\r\n        alter external table {{source(source_node.source_name, source_node.name)}} refresh;\r\n        commit;\r\n        {% endset %}\r\n        \r\n        {% do return([ddl]) %}\r\n    \r\n    {% else %}\r\n    \r\n        {% do return([]) %}\r\n    \r\n    {% endif %}\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7097998, "supported_languages": null}, "macro.dbt_external_tables.is_csv": {"unique_id": "macro.dbt_external_tables.is_csv", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\helpers\\is_csv.sql", "original_file_path": "macros\\plugins\\snowflake\\helpers\\is_csv.sql", "name": "is_csv", "macro_sql": "{% macro is_csv(file_format) %}\r\n\r\n{# From https://docs.snowflake.net/manuals/sql-reference/sql/create-external-table.html:\r\n\r\nImportant: The external table does not inherit the file format, if any, in the \r\nstage definition. You must explicitly specify any file format options for the \r\nexternal table using the FILE_FORMAT parameter.\r\n\r\nNote: FORMAT_NAME and TYPE are mutually exclusive; to avoid unintended behavior, \r\nyou should only specify one or the other when creating an external table.\r\n\r\n#}\r\n\r\n    {% set ff_ltrimmed = file_format|lower|replace(' ','') %}\r\n\r\n    {% if 'type=' in ff_ltrimmed %}\r\n    \r\n        {% if 'type=csv' in ff_ltrimmed %}\r\n\r\n            {{return(true)}}\r\n\r\n        {% else %}\r\n\r\n            {{return(false)}}\r\n            \r\n        {% endif %}\r\n        \r\n    {% else %}\r\n    \r\n        {% set ff_standardized = ff_ltrimmed\r\n            | replace('(','') | replace(')','')\r\n            | replace('format_name=','') %}\r\n        {% set fqn = ff_standardized.split('.') %}\r\n        \r\n        {% if fqn | length == 3 %}\r\n            {% set ff_database, ff_schema, ff_identifier = fqn[0], fqn[1], fqn[2] %}\r\n        {% elif fqn | length == 2 %}\r\n            {% set ff_database, ff_schema, ff_identifier = target.database, fqn[0], fqn[1] %}\r\n        {% else %}\r\n            {% set ff_database, ff_schema, ff_identifier = target.database, target.schema, fqn[0] %}\r\n        {% endif %}\r\n    \r\n        {% call statement('get_file_format', fetch_result = True) %}\r\n            show file formats in {{ff_database}}.{{ff_schema}}\r\n        {% endcall %}\r\n        \r\n        {% set ffs = load_result('get_file_format').table %}\r\n        \r\n        {% for ff in ffs %}\r\n            \r\n            {% if ff['name']|lower == ff_identifier and ff['type']|lower == 'csv' %}\r\n            \r\n                {{return(true)}}\r\n            \r\n            {% endif %}\r\n        \r\n        {% endfor %}\r\n        \r\n        {{return(false)}}        \r\n    \r\n    {% endif %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7137995, "supported_languages": null}, "macro.dbt_external_tables.snowflake_create_empty_table": {"unique_id": "macro.dbt_external_tables.snowflake_create_empty_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\snowpipe\\create_empty_table.sql", "original_file_path": "macros\\plugins\\snowflake\\snowpipe\\create_empty_table.sql", "name": "snowflake_create_empty_table", "macro_sql": "{% macro snowflake_create_empty_table(source_node) %}\r\n\r\n    {%- set columns = source_node.columns.values() %}\r\n\r\n    create or replace table {{source(source_node.source_name, source_node.name)}} (\r\n        {% if columns|length == 0 %}\r\n            value variant,\r\n        {% else -%}\r\n        {%- for column in columns -%}\r\n            {{column.name}} {{column.data_type}},\r\n        {% endfor -%}\r\n        {% endif %}\r\n            metadata_filename varchar,\r\n            metadata_file_row_number bigint,\r\n            _dbt_copied_at timestamp\r\n    );\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7157986, "supported_languages": null}, "macro.dbt_external_tables.snowflake_create_snowpipe": {"unique_id": "macro.dbt_external_tables.snowflake_create_snowpipe", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\snowpipe\\create_snowpipe.sql", "original_file_path": "macros\\plugins\\snowflake\\snowpipe\\create_snowpipe.sql", "name": "snowflake_create_snowpipe", "macro_sql": "{% macro snowflake_create_snowpipe(source_node) %}\r\n\r\n    {%- set external = source_node.external -%}\r\n    {%- set snowpipe = external.snowpipe -%}\r\n\r\n{# https://docs.snowflake.com/en/sql-reference/sql/create-pipe.html #}\r\n    create or replace pipe {{source(source_node.source_name, source_node.name)}}\r\n        {% if snowpipe.auto_ingest -%} auto_ingest = {{snowpipe.auto_ingest}} {%- endif %}\r\n        {% if snowpipe.aws_sns_topic -%} aws_sns_topic = '{{snowpipe.aws_sns_topic}}' {%- endif %}\r\n        {% if snowpipe.integration -%} integration = '{{snowpipe.integration}}' {%- endif %}\r\n        as {{ dbt_external_tables.snowflake_get_copy_sql(source_node) }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.snowflake_get_copy_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7167997, "supported_languages": null}, "macro.dbt_external_tables.snowflake_get_copy_sql": {"unique_id": "macro.dbt_external_tables.snowflake_get_copy_sql", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\snowpipe\\get_copy_sql.sql", "original_file_path": "macros\\plugins\\snowflake\\snowpipe\\get_copy_sql.sql", "name": "snowflake_get_copy_sql", "macro_sql": "{% macro snowflake_get_copy_sql(source_node, explicit_transaction=false) %}\r\n{# This assumes you have already created an external stage #}\r\n\r\n    {%- set columns = source_node.columns.values() -%}\r\n    {%- set external = source_node.external -%}\r\n    {%- set is_csv = dbt_external_tables.is_csv(external.file_format) %}\r\n    {%- set copy_options = external.snowpipe.get('copy_options', none) -%}\r\n   \r\n    {%- if explicit_transaction -%} begin; {%- endif %}\r\n    \r\n    copy into {{source(source_node.source_name, source_node.name)}}\r\n    from ( \r\n        select\r\n        {% if columns|length == 0 %}\r\n            $1::variant as value,\r\n        {% else -%}\r\n        {%- for column in columns -%}\r\n            {%- set col_expression -%}\r\n                {%- if is_csv -%}nullif(${{loop.index}},''){# special case: get columns by ordinal position #}\r\n                {%- else -%}nullif($1:{{column.name}},''){# standard behavior: get columns by name #}\r\n                {%- endif -%}\r\n            {%- endset -%}\r\n            {{col_expression}}::{{column.data_type}} as {{column.name}},\r\n        {% endfor -%}\r\n        {% endif %}\r\n            metadata$filename::varchar as metadata_filename,\r\n            metadata$file_row_number::bigint as metadata_file_row_number,\r\n            current_timestamp::timestamp as _dbt_copied_at\r\n        from {{external.location}} {# stage #}\r\n    )\r\n    file_format = {{external.file_format}}\r\n    {% if external.pattern -%} pattern = '{{external.pattern}}' {%- endif %}\r\n    {% if copy_options %} {{copy_options}} {% endif %};\r\n    \r\n    {% if explicit_transaction -%} commit; {%- endif -%}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.is_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7197993, "supported_languages": null}, "macro.dbt_external_tables.snowflake_refresh_snowpipe": {"unique_id": "macro.dbt_external_tables.snowflake_refresh_snowpipe", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\snowflake\\snowpipe\\refresh_snowpipe.sql", "original_file_path": "macros\\plugins\\snowflake\\snowpipe\\refresh_snowpipe.sql", "name": "snowflake_refresh_snowpipe", "macro_sql": "{% macro snowflake_refresh_snowpipe(source_node) %}\r\n\r\n    {% set snowpipe = source_node.external.snowpipe %}\r\n    {% set auto_ingest = snowpipe.get('auto_ingest', false) if snowpipe is mapping %}\r\n    \r\n    {% if auto_ingest is true %}\r\n    \r\n        {% do return([]) %}\r\n    \r\n    {% else %}\r\n    \r\n        {% set ddl %}\r\n        alter pipe {{source(source_node.source_name, source_node.name)}} refresh\r\n        {% endset %}\r\n        \r\n        {{ return([ddl]) }}\r\n    \r\n    {% endif %}\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7207992, "supported_languages": null}, "macro.dbt_external_tables.spark__create_external_table": {"unique_id": "macro.dbt_external_tables.spark__create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\spark\\create_external_table.sql", "original_file_path": "macros\\plugins\\spark\\create_external_table.sql", "name": "spark__create_external_table", "macro_sql": "{% macro spark__create_external_table(source_node) %}\r\n\r\n    {%- set columns = source_node.columns.values() -%}\r\n    {%- set external = source_node.external -%}\r\n    {%- set partitions = external.partitions -%}\r\n    {%- set options = external.options -%}\r\n\r\n{# https://spark.apache.org/docs/latest/sql-data-sources-hive-tables.html #}\r\n    create table {{source(source_node.source_name, source_node.name)}} \r\n    {%- if columns|length > 0 %} (\r\n        {% for column in columns %}\r\n            {{column.name}} {{column.data_type}}\r\n            {{- ',' if not loop.last -}}\r\n        {% endfor %}\r\n    ) {% endif -%}\r\n    {% if external.using %} using {{external.using}} {%- endif %}\r\n    {% if options -%} options (\r\n        {%- for key, value in options.items() -%}\r\n            '{{ key }}' = '{{value}}' {{- ', \\n' if not loop.last -}}\r\n        {%- endfor -%}\r\n    ) {%- endif %}\r\n    {% if partitions -%} partitioned by (\r\n        {%- for partition in partitions -%}\r\n            {{partition.name}} {{partition.data_type}}{{', ' if not loop.last}}\r\n        {%- endfor -%}\r\n    ) {%- endif %}\r\n    {% if external.row_format -%} row format {{external.row_format}} {%- endif %}\r\n    {% if external.file_format -%} stored as {{external.file_format}} {%- endif %}\r\n    {% if external.location -%} location '{{external.location}}' {%- endif %}\r\n    {% if external.table_properties -%} tblproperties {{ external.table_properties }} {%- endif -%}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7248003, "supported_languages": null}, "macro.dbt_external_tables.spark__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.spark__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\spark\\get_external_build_plan.sql", "original_file_path": "macros\\plugins\\spark\\get_external_build_plan.sql", "name": "spark__get_external_build_plan", "macro_sql": "{% macro spark__get_external_build_plan(source_node) %}\r\n\r\n    {% set build_plan = [] %}\r\n\r\n    {% set old_relation = adapter.get_relation(\r\n        database = none,\r\n        schema = source_node.schema,\r\n        identifier = source_node.identifier\r\n    ) %}\r\n\r\n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\r\n\r\n    {% if create_or_replace %}\r\n        {% set build_plan = build_plan + [\r\n            dbt_external_tables.dropif(source_node), \r\n            dbt_external_tables.create_external_table(source_node)\r\n        ] %}\r\n    {% else %}\r\n        {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\r\n    {% endif %}\r\n\r\n    {% set recover_partitions = spark__recover_partitions(source_node) %}\r\n    {% if recover_partitions|length > 0 %}\r\n    {% set build_plan = build_plan + [\r\n        recover_partitions\r\n    ] %}\r\n    {% endif %}\r\n\r\n    {% do return(build_plan) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.dropif", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table", "macro.dbt_external_tables.spark__recover_partitions"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7267992, "supported_languages": null}, "macro.dbt_external_tables.spark__refresh_external_table": {"unique_id": "macro.dbt_external_tables.spark__refresh_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\spark\\refresh_external_table.sql", "original_file_path": "macros\\plugins\\spark\\refresh_external_table.sql", "name": "spark__refresh_external_table", "macro_sql": "{% macro spark__refresh_external_table(source_node) %}\r\n    \r\n    {% set refresh %}\r\n        refresh table {{source(source_node.source_name, source_node.name)}}\r\n    {% endset %}\r\n    \r\n    {% do return([refresh]) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7278, "supported_languages": null}, "macro.dbt_external_tables.spark__dropif": {"unique_id": "macro.dbt_external_tables.spark__dropif", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\spark\\helpers\\dropif.sql", "original_file_path": "macros\\plugins\\spark\\helpers\\dropif.sql", "name": "spark__dropif", "macro_sql": "{% macro spark__dropif(node) %}\r\n    \r\n    {% set ddl %}\r\n        drop table if exists {{source(node.source_name, node.name)}}\r\n    {% endset %}\r\n    \r\n    {{return(ddl)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7288003, "supported_languages": null}, "macro.dbt_external_tables.spark__recover_partitions": {"unique_id": "macro.dbt_external_tables.spark__recover_partitions", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\spark\\helpers\\recover_partitions.sql", "original_file_path": "macros\\plugins\\spark\\helpers\\recover_partitions.sql", "name": "spark__recover_partitions", "macro_sql": "{% macro spark__recover_partitions(source_node) %}\r\n    {# https://docs.databricks.com/sql/language-manual/sql-ref-syntax-ddl-alter-table.html #}\r\n\r\n    {% set ddl %}\r\n    {%- if source_node.external.partitions and source_node.external.using and source_node.external.using|lower != 'delta' -%}\r\n        ALTER TABLE {{ source(source_node.source_name, source_node.name) }} RECOVER PARTITIONS\r\n    {%- endif -%}\r\n    {% endset %}\r\n\r\n    {{return(ddl)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7298026, "supported_languages": null}, "macro.dbt_external_tables.sqlserver__create_external_table": {"unique_id": "macro.dbt_external_tables.sqlserver__create_external_table", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\sqlserver\\create_external_table.sql", "original_file_path": "macros\\plugins\\sqlserver\\create_external_table.sql", "name": "sqlserver__create_external_table", "macro_sql": "{% macro sqlserver__create_external_table(source_node) %}\r\n\r\n    {%- set columns = source_node.columns.values() -%}\r\n    {%- set external = source_node.external -%}\r\n\r\n    {% if external.ansi_nulls is true -%} SET ANSI_NULLS ON; {%- endif %}\r\n    {% if external.quoted_identifier is true -%} SET QUOTED_IDENTIFIER ON; {%- endif %}\r\n\r\n    create external table {{source(source_node.source_name, source_node.name)}} (\r\n        {% for column in columns %}\r\n            {# TODO set nullity based on schema tests?? #}\r\n            {%- set nullity = 'NOT NULL' if 'not_null' in columns.tests else 'NULL'-%}\r\n            {{adapter.quote(column.name)}} {{column.data_type}} {{nullity}}\r\n            {{- ',' if not loop.last -}}\r\n        {% endfor %}\r\n    )\r\n    WITH (\r\n        {# remove keys that are None (i.e. not defined for a given source) #}\r\n        {%- for key, value in external.items() if value is not none and key not in ['ansi_nulls', 'quoted_identifier'] -%}\r\n            {{key}} = \r\n                {%- if key in [\"location\", \"schema_name\", \"object_name\"] -%}\r\n                    '{{value}}'\r\n                {% elif key in [\"data_source\",\"file_format\"] -%}\r\n                    [{{value}}]\r\n                {% else -%}\r\n                    {{value}}\r\n                {%- endif -%}\r\n            {{- ',' if not loop.last -}}\r\n            {%- endfor -%}\r\n    )\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.732803, "supported_languages": null}, "macro.dbt_external_tables.sqlserver__get_external_build_plan": {"unique_id": "macro.dbt_external_tables.sqlserver__get_external_build_plan", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\sqlserver\\get_external_build_plan.sql", "original_file_path": "macros\\plugins\\sqlserver\\get_external_build_plan.sql", "name": "sqlserver__get_external_build_plan", "macro_sql": "{% macro sqlserver__get_external_build_plan(source_node) %}\r\n\r\n    {% set build_plan = [] %}\r\n\r\n    {% set old_relation = adapter.get_relation(\r\n        database = source_node.database,\r\n        schema = source_node.schema,\r\n        identifier = source_node.identifier\r\n    ) %}\r\n\r\n    {% set create_or_replace = (old_relation is none or var('ext_full_refresh', false)) %}\r\n\r\n    {% if create_or_replace %}\r\n        {% set build_plan = build_plan + [ \r\n            dbt_external_tables.dropif(source_node), \r\n            dbt_external_tables.create_external_table(source_node)\r\n        ] %}\r\n    {% else %}\r\n        {% set build_plan = build_plan + dbt_external_tables.refresh_external_table(source_node) %}\r\n    {% endif %}\r\n    {% do return(build_plan) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_external_tables.dropif", "macro.dbt_external_tables.create_external_table", "macro.dbt_external_tables.refresh_external_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7347994, "supported_languages": null}, "macro.dbt_external_tables.sqlserver__dropif": {"unique_id": "macro.dbt_external_tables.sqlserver__dropif", "package_name": "dbt_external_tables", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-external-tables", "path": "macros\\plugins\\sqlserver\\helpers\\dropif.sql", "original_file_path": "macros\\plugins\\sqlserver\\helpers\\dropif.sql", "name": "sqlserver__dropif", "macro_sql": "{% macro sqlserver__dropif(node) %}\r\n    \r\n    {% set ddl %}\r\n      if object_id ('{{source(node.source_name, node.name)}}') is not null\r\n        begin\r\n        drop external table {{source(node.source_name, node.name)}}\r\n        end\r\n    {% endset %}\r\n    \r\n    {{return(ddl)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7358, "supported_languages": null}, "macro.dbt_utils.test_accepted_range": {"unique_id": "macro.dbt_utils.test_accepted_range", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\accepted_range.sql", "original_file_path": "macros\\generic_tests\\accepted_range.sql", "name": "test_accepted_range", "macro_sql": "{% test accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\r\n  {{ return(adapter.dispatch('test_accepted_range', 'dbt_utils')(model, column_name, min_value, max_value, inclusive)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_accepted_range"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7367995, "supported_languages": null}, "macro.dbt_utils.default__test_accepted_range": {"unique_id": "macro.dbt_utils.default__test_accepted_range", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\accepted_range.sql", "original_file_path": "macros\\generic_tests\\accepted_range.sql", "name": "default__test_accepted_range", "macro_sql": "{% macro default__test_accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\r\n\r\nwith meet_condition as(\r\n  select *\r\n  from {{ model }}\r\n),\r\n\r\nvalidation_errors as (\r\n  select *\r\n  from meet_condition\r\n  where\r\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\r\n    1 = 2\r\n\r\n  {%- if min_value is not none %}\r\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\r\n    or not {{ column_name }} > {{- \"=\" if inclusive }} {{ min_value }}\r\n  {%- endif %}\r\n\r\n  {%- if max_value is not none %}\r\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\r\n    or not {{ column_name }} < {{- \"=\" if inclusive }} {{ max_value }}\r\n  {%- endif %}\r\n)\r\n\r\nselect *\r\nfrom validation_errors\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7377994, "supported_languages": null}, "macro.dbt_utils.test_at_least_one": {"unique_id": "macro.dbt_utils.test_at_least_one", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\at_least_one.sql", "original_file_path": "macros\\generic_tests\\at_least_one.sql", "name": "test_at_least_one", "macro_sql": "{% test at_least_one(model, column_name, group_by_columns = []) %}\r\n  {{ return(adapter.dispatch('test_at_least_one', 'dbt_utils')(model, column_name, group_by_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_at_least_one"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7387996, "supported_languages": null}, "macro.dbt_utils.default__test_at_least_one": {"unique_id": "macro.dbt_utils.default__test_at_least_one", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\at_least_one.sql", "original_file_path": "macros\\generic_tests\\at_least_one.sql", "name": "default__test_at_least_one", "macro_sql": "{% macro default__test_at_least_one(model, column_name, group_by_columns) %}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\r\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\nselect *\r\nfrom (\r\n    select\r\n        {# In TSQL, subquery aggregate columns need aliases #}\r\n        {# thus: a filler col name, 'filler_column' #}\r\n      {{select_gb_cols}}\r\n      count({{ column_name }}) as filler_column\r\n\r\n    from {{ model }}\r\n\r\n    {{groupby_gb_cols}}\r\n\r\n    having count({{ column_name }}) = 0\r\n\r\n) validation_errors\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7397995, "supported_languages": null}, "macro.dbt_utils.test_cardinality_equality": {"unique_id": "macro.dbt_utils.test_cardinality_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\cardinality_equality.sql", "original_file_path": "macros\\generic_tests\\cardinality_equality.sql", "name": "test_cardinality_equality", "macro_sql": "{% test cardinality_equality(model, column_name, to, field) %}\r\n    {{ return(adapter.dispatch('test_cardinality_equality', 'dbt_utils')(model, column_name, to, field)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_cardinality_equality"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7407997, "supported_languages": null}, "macro.dbt_utils.default__test_cardinality_equality": {"unique_id": "macro.dbt_utils.default__test_cardinality_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\cardinality_equality.sql", "original_file_path": "macros\\generic_tests\\cardinality_equality.sql", "name": "default__test_cardinality_equality", "macro_sql": "{% macro default__test_cardinality_equality(model, column_name, to, field) %}\r\n\r\n{# T-SQL does not let you use numbers as aliases for columns #}\r\n{# Thus, no \"GROUP BY 1\" #}\r\n\r\nwith table_a as (\r\nselect\r\n  {{ column_name }},\r\n  count(*) as num_rows\r\nfrom {{ model }}\r\ngroup by {{ column_name }}\r\n),\r\n\r\ntable_b as (\r\nselect\r\n  {{ field }},\r\n  count(*) as num_rows\r\nfrom {{ to }}\r\ngroup by {{ field }}\r\n),\r\n\r\nexcept_a as (\r\n  select *\r\n  from table_a\r\n  {{ dbt.except() }}\r\n  select *\r\n  from table_b\r\n),\r\n\r\nexcept_b as (\r\n  select *\r\n  from table_b\r\n  {{ dbt.except() }}\r\n  select *\r\n  from table_a\r\n),\r\n\r\nunioned as (\r\n  select *\r\n  from except_a\r\n  union all\r\n  select *\r\n  from except_b\r\n)\r\n\r\nselect *\r\nfrom unioned\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7417996, "supported_languages": null}, "macro.dbt_utils.test_equality": {"unique_id": "macro.dbt_utils.test_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\equality.sql", "original_file_path": "macros\\generic_tests\\equality.sql", "name": "test_equality", "macro_sql": "{% test equality(model, compare_model, compare_columns=None) %}\r\n  {{ return(adapter.dispatch('test_equality', 'dbt_utils')(model, compare_model, compare_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equality"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7427993, "supported_languages": null}, "macro.dbt_utils.default__test_equality": {"unique_id": "macro.dbt_utils.default__test_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\equality.sql", "original_file_path": "macros\\generic_tests\\equality.sql", "name": "default__test_equality", "macro_sql": "{% macro default__test_equality(model, compare_model, compare_columns=None) %}\r\n\r\n{% set set_diff %}\r\n    count(*) + coalesce(abs(\r\n        sum(case when which_diff = 'a_minus_b' then 1 else 0 end) -\r\n        sum(case when which_diff = 'b_minus_a' then 1 else 0 end)\r\n    ), 0)\r\n{% endset %}\r\n\r\n{#-- Needs to be set at parse time, before we return '' below --#}\r\n{{ config(fail_calc = set_diff) }}\r\n\r\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\r\n{%- if not execute -%}\r\n    {{ return('') }}\r\n{% endif %}\r\n\r\n-- setup\r\n{%- do dbt_utils._is_relation(model, 'test_equality') -%}\r\n\r\n{#-\r\nIf the compare_cols arg is provided, we can run this test without querying the\r\ninformation schema\u00a0\u2014 this allows the model to be an ephemeral model\r\n-#}\r\n\r\n{%- if not compare_columns -%}\r\n    {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\r\n    {%- set compare_columns = adapter.get_columns_in_relation(model) | map(attribute='quoted') -%}\r\n{%- endif -%}\r\n\r\n{% set compare_cols_csv = compare_columns | join(', ') %}\r\n\r\nwith a as (\r\n\r\n    select * from {{ model }}\r\n\r\n),\r\n\r\nb as (\r\n\r\n    select * from {{ compare_model }}\r\n\r\n),\r\n\r\na_minus_b as (\r\n\r\n    select {{compare_cols_csv}} from a\r\n    {{ dbt.except() }}\r\n    select {{compare_cols_csv}} from b\r\n\r\n),\r\n\r\nb_minus_a as (\r\n\r\n    select {{compare_cols_csv}} from b\r\n    {{ dbt.except() }}\r\n    select {{compare_cols_csv}} from a\r\n\r\n),\r\n\r\nunioned as (\r\n\r\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\r\n    union all\r\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\r\n\r\n)\r\n\r\nselect * from unioned\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt.except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7447999, "supported_languages": null}, "macro.dbt_utils.test_equal_rowcount": {"unique_id": "macro.dbt_utils.test_equal_rowcount", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\equal_rowcount.sql", "original_file_path": "macros\\generic_tests\\equal_rowcount.sql", "name": "test_equal_rowcount", "macro_sql": "{% test equal_rowcount(model, compare_model, group_by_columns = []) %}\r\n  {{ return(adapter.dispatch('test_equal_rowcount', 'dbt_utils')(model, compare_model, group_by_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equal_rowcount"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7458, "supported_languages": null}, "macro.dbt_utils.default__test_equal_rowcount": {"unique_id": "macro.dbt_utils.default__test_equal_rowcount", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\equal_rowcount.sql", "original_file_path": "macros\\generic_tests\\equal_rowcount.sql", "name": "default__test_equal_rowcount", "macro_sql": "{% macro default__test_equal_rowcount(model, compare_model, group_by_columns) %}\r\n\r\n{#-- Needs to be set at parse time, before we return '' below --#}\r\n{{ config(fail_calc = 'sum(coalesce(diff_count, 0))') }}\r\n\r\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\r\n{%- if not execute -%}\r\n    {{ return('') }}\r\n{% endif %}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(', ') + ', ' %}\r\n  {% set join_gb_cols %}\r\n    {% for c in group_by_columns %}\r\n      and a.{{c}} = b.{{c}}\r\n    {% endfor %}\r\n  {% endset %}\r\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\n{#-- We must add a fake join key in case additional grouping variables are not provided --#}\r\n{#-- Redshift does not allow for dynamically created join conditions (e.g. full join on 1 = 1 --#}\r\n{#-- The same logic is used in fewer_rows_than. In case of changes, maintain consistent logic --#}\r\n{% set group_by_columns = ['id_dbtutils_test_equal_rowcount'] + group_by_columns %}\r\n{% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n\r\nwith a as (\r\n\r\n    select \r\n      {{select_gb_cols}}\r\n      1 as id_dbtutils_test_equal_rowcount,\r\n      count(*) as count_a \r\n    from {{ model }}\r\n    {{groupby_gb_cols}}\r\n\r\n\r\n),\r\nb as (\r\n\r\n    select \r\n      {{select_gb_cols}}\r\n      1 as id_dbtutils_test_equal_rowcount,\r\n      count(*) as count_b \r\n    from {{ compare_model }}\r\n    {{groupby_gb_cols}}\r\n\r\n),\r\nfinal as (\r\n\r\n    select\r\n    \r\n        {% for c in group_by_columns -%}\r\n          a.{{c}} as {{c}}_a,\r\n          b.{{c}} as {{c}}_b,\r\n        {% endfor %}\r\n\r\n        count_a,\r\n        count_b,\r\n        abs(count_a - count_b) as diff_count\r\n\r\n    from a\r\n    full join b\r\n    on\r\n    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount\r\n    {{join_gb_cols}}\r\n\r\n\r\n)\r\n\r\nselect * from final\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7478, "supported_languages": null}, "macro.dbt_utils.test_expression_is_true": {"unique_id": "macro.dbt_utils.test_expression_is_true", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\expression_is_true.sql", "original_file_path": "macros\\generic_tests\\expression_is_true.sql", "name": "test_expression_is_true", "macro_sql": "{% test expression_is_true(model, expression, column_name=None) %}\r\n  {{ return(adapter.dispatch('test_expression_is_true', 'dbt_utils')(model, expression, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7488, "supported_languages": null}, "macro.dbt_utils.default__test_expression_is_true": {"unique_id": "macro.dbt_utils.default__test_expression_is_true", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\expression_is_true.sql", "original_file_path": "macros\\generic_tests\\expression_is_true.sql", "name": "default__test_expression_is_true", "macro_sql": "{% macro default__test_expression_is_true(model, expression, column_name) %}\r\n\r\n{% set column_list = '*' if should_store_failures() else \"1\" %}\r\n\r\nselect\r\n    {{ column_list }}\r\nfrom {{ model }}\r\n{% if column_name is none %}\r\nwhere not({{ expression }})\r\n{%- else %}\r\nwhere not({{ column_name }} {{ expression }})\r\n{%- endif %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7498, "supported_languages": null}, "macro.dbt_utils.test_fewer_rows_than": {"unique_id": "macro.dbt_utils.test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\fewer_rows_than.sql", "original_file_path": "macros\\generic_tests\\fewer_rows_than.sql", "name": "test_fewer_rows_than", "macro_sql": "{% test fewer_rows_than(model, compare_model, group_by_columns = []) %}\r\n  {{ return(adapter.dispatch('test_fewer_rows_than', 'dbt_utils')(model, compare_model, group_by_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_fewer_rows_than"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7517993, "supported_languages": null}, "macro.dbt_utils.default__test_fewer_rows_than": {"unique_id": "macro.dbt_utils.default__test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\fewer_rows_than.sql", "original_file_path": "macros\\generic_tests\\fewer_rows_than.sql", "name": "default__test_fewer_rows_than", "macro_sql": "{% macro default__test_fewer_rows_than(model, compare_model, group_by_columns) %}\r\n\r\n{{ config(fail_calc = 'sum(coalesce(row_count_delta, 0))') }}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\r\n  {% set join_gb_cols %}\r\n    {% for c in group_by_columns %}\r\n      and a.{{c}} = b.{{c}}\r\n    {% endfor %}\r\n  {% endset %}\r\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\n{#-- We must add a fake join key in case additional grouping variables are not provided --#}\r\n{#-- Redshift does not allow for dynamically created join conditions (e.g. full join on 1 = 1 --#}\r\n{#-- The same logic is used in equal_rowcount. In case of changes, maintain consistent logic --#}\r\n{% set group_by_columns = ['id_dbtutils_test_fewer_rows_than'] + group_by_columns %}\r\n{% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n\r\n\r\nwith a as (\r\n\r\n    select \r\n      {{select_gb_cols}}\r\n      1 as id_dbtutils_test_fewer_rows_than,\r\n      count(*) as count_our_model \r\n    from {{ model }}\r\n    {{ groupby_gb_cols }}\r\n\r\n),\r\nb as (\r\n\r\n    select \r\n      {{select_gb_cols}}\r\n      1 as id_dbtutils_test_fewer_rows_than,\r\n      count(*) as count_comparison_model \r\n    from {{ compare_model }}\r\n    {{ groupby_gb_cols }}\r\n\r\n),\r\ncounts as (\r\n\r\n    select\r\n\r\n        {% for c in group_by_columns -%}\r\n          a.{{c}} as {{c}}_a,\r\n          b.{{c}} as {{c}}_b,\r\n        {% endfor %}\r\n\r\n        count_our_model,\r\n        count_comparison_model\r\n    from a\r\n    full join b on \r\n    a.id_dbtutils_test_fewer_rows_than = b.id_dbtutils_test_fewer_rows_than\r\n    {{ join_gb_cols }}\r\n\r\n),\r\nfinal as (\r\n\r\n    select *,\r\n        case\r\n            -- fail the test if we have more rows than the reference model and return the row count delta\r\n            when count_our_model > count_comparison_model then (count_our_model - count_comparison_model)\r\n            -- fail the test if they are the same number\r\n            when count_our_model = count_comparison_model then 1\r\n            -- pass the test if the delta is positive (i.e. return the number 0)\r\n            else 0\r\n    end as row_count_delta\r\n    from counts\r\n\r\n)\r\n\r\nselect * from final\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7527995, "supported_languages": null}, "macro.dbt_utils.test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "original_file_path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "name": "test_mutually_exclusive_ranges", "macro_sql": "{% test mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\r\n  {{ return(adapter.dispatch('test_mutually_exclusive_ranges', 'dbt_utils')(model, lower_bound_column, upper_bound_column, partition_by, gaps, zero_length_range_allowed)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_mutually_exclusive_ranges"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7577996, "supported_languages": null}, "macro.dbt_utils.default__test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.default__test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "original_file_path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "name": "default__test_mutually_exclusive_ranges", "macro_sql": "{% macro default__test_mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\r\n{% if gaps == 'not_allowed' %}\r\n    {% set allow_gaps_operator='=' %}\r\n    {% set allow_gaps_operator_in_words='equal_to' %}\r\n{% elif gaps == 'allowed' %}\r\n    {% set allow_gaps_operator='<=' %}\r\n    {% set allow_gaps_operator_in_words='less_than_or_equal_to' %}\r\n{% elif gaps == 'required' %}\r\n    {% set allow_gaps_operator='<' %}\r\n    {% set allow_gaps_operator_in_words='less_than' %}\r\n{% else %}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"`gaps` argument for mutually_exclusive_ranges test must be one of ['not_allowed', 'allowed', 'required'] Got: '\" ~ gaps ~\"'.'\"\r\n    ) }}\r\n{% endif %}\r\n{% if not zero_length_range_allowed %}\r\n    {% set allow_zero_length_operator='<' %}\r\n    {% set allow_zero_length_operator_in_words='less_than' %}\r\n{% elif zero_length_range_allowed %}\r\n    {% set allow_zero_length_operator='<=' %}\r\n    {% set allow_zero_length_operator_in_words='less_than_or_equal_to' %}\r\n{% else %}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"`zero_length_range_allowed` argument for mutually_exclusive_ranges test must be one of [true, false] Got: '\" ~ zero_length_range_allowed ~\"'.'\"\r\n    ) }}\r\n{% endif %}\r\n\r\n{% set partition_clause=\"partition by \" ~ partition_by if partition_by else '' %}\r\n\r\nwith window_functions as (\r\n\r\n    select\r\n        {% if partition_by %}\r\n        {{ partition_by }} as partition_by_col,\r\n        {% endif %}\r\n        {{ lower_bound_column }} as lower_bound,\r\n        {{ upper_bound_column }} as upper_bound,\r\n\r\n        lead({{ lower_bound_column }}) over (\r\n            {{ partition_clause }}\r\n            order by {{ lower_bound_column }}, {{ upper_bound_column }}\r\n        ) as next_lower_bound,\r\n\r\n        row_number() over (\r\n            {{ partition_clause }}\r\n            order by {{ lower_bound_column }} desc, {{ upper_bound_column }} desc\r\n        ) = 1 as is_last_record\r\n\r\n    from {{ model }}\r\n\r\n),\r\n\r\ncalc as (\r\n    -- We want to return records where one of our assumptions fails, so we'll use\r\n    -- the `not` function with `and` statements so we can write our assumptions more cleanly\r\n    select\r\n        *,\r\n\r\n        -- For each record: lower_bound should be < upper_bound.\r\n        -- Coalesce it to return an error on the null case (implicit assumption\r\n        -- these columns are not_null)\r\n        coalesce(\r\n            lower_bound {{ allow_zero_length_operator }} upper_bound,\r\n            false\r\n        ) as lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound,\r\n\r\n        -- For each record: upper_bound {{ allow_gaps_operator }} the next lower_bound.\r\n        -- Coalesce it to handle null cases for the last record.\r\n        coalesce(\r\n            upper_bound {{ allow_gaps_operator }} next_lower_bound,\r\n            is_last_record,\r\n            false\r\n        ) as upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\r\n\r\n    from window_functions\r\n\r\n),\r\n\r\nvalidation_errors as (\r\n\r\n    select\r\n        *\r\n    from calc\r\n\r\n    where not(\r\n        -- THE FOLLOWING SHOULD BE TRUE --\r\n        lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound\r\n        and upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\r\n    )\r\n)\r\n\r\nselect * from validation_errors\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7607994, "supported_languages": null}, "macro.dbt_utils.test_not_accepted_values": {"unique_id": "macro.dbt_utils.test_not_accepted_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_accepted_values.sql", "original_file_path": "macros\\generic_tests\\not_accepted_values.sql", "name": "test_not_accepted_values", "macro_sql": "{% test not_accepted_values(model, column_name, values, quote=True) %}\r\n  {{ return(adapter.dispatch('test_not_accepted_values', 'dbt_utils')(model, column_name, values, quote)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7617996, "supported_languages": null}, "macro.dbt_utils.default__test_not_accepted_values": {"unique_id": "macro.dbt_utils.default__test_not_accepted_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_accepted_values.sql", "original_file_path": "macros\\generic_tests\\not_accepted_values.sql", "name": "default__test_not_accepted_values", "macro_sql": "{% macro default__test_not_accepted_values(model, column_name, values, quote=True) %}\r\nwith all_values as (\r\n\r\n    select distinct\r\n        {{ column_name }} as value_field\r\n\r\n    from {{ model }}\r\n\r\n),\r\n\r\nvalidation_errors as (\r\n\r\n    select\r\n        value_field\r\n\r\n    from all_values\r\n    where value_field in (\r\n        {% for value in values -%}\r\n            {% if quote -%}\r\n            '{{ value }}'\r\n            {%- else -%}\r\n            {{ value }}\r\n            {%- endif -%}\r\n            {%- if not loop.last -%},{%- endif %}\r\n        {%- endfor %}\r\n        )\r\n\r\n)\r\n\r\nselect *\r\nfrom validation_errors\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7627995, "supported_languages": null}, "macro.dbt_utils.test_not_constant": {"unique_id": "macro.dbt_utils.test_not_constant", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_constant.sql", "original_file_path": "macros\\generic_tests\\not_constant.sql", "name": "test_not_constant", "macro_sql": "{% test not_constant(model, column_name, group_by_columns = []) %}\r\n  {{ return(adapter.dispatch('test_not_constant', 'dbt_utils')(model, column_name, group_by_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_constant"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7638, "supported_languages": null}, "macro.dbt_utils.default__test_not_constant": {"unique_id": "macro.dbt_utils.default__test_not_constant", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_constant.sql", "original_file_path": "macros\\generic_tests\\not_constant.sql", "name": "default__test_not_constant", "macro_sql": "{% macro default__test_not_constant(model, column_name, group_by_columns) %}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\r\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\n\r\nselect\r\n    {# In TSQL, subquery aggregate columns need aliases #}\r\n    {# thus: a filler col name, 'filler_column' #}\r\n    {{select_gb_cols}}\r\n    count(distinct {{ column_name }}) as filler_column\r\n\r\nfrom {{ model }}\r\n\r\n  {{groupby_gb_cols}}\r\n\r\nhaving count(distinct {{ column_name }}) = 1\r\n\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7647996, "supported_languages": null}, "macro.dbt_utils.test_not_empty_string": {"unique_id": "macro.dbt_utils.test_not_empty_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_empty_string.sql", "original_file_path": "macros\\generic_tests\\not_empty_string.sql", "name": "test_not_empty_string", "macro_sql": "{% test not_empty_string(model, column_name, trim_whitespace=true) %}\r\n\r\n  {{ return(adapter.dispatch('test_not_empty_string', 'dbt_utils')(model, column_name, trim_whitespace)) }}\r\n\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_empty_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7657983, "supported_languages": null}, "macro.dbt_utils.default__test_not_empty_string": {"unique_id": "macro.dbt_utils.default__test_not_empty_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_empty_string.sql", "original_file_path": "macros\\generic_tests\\not_empty_string.sql", "name": "default__test_not_empty_string", "macro_sql": "{% macro default__test_not_empty_string(model, column_name, trim_whitespace=true) %}\r\n\r\n    with\r\n    \r\n    all_values as (\r\n\r\n        select \r\n\r\n\r\n            {% if trim_whitespace == true -%}\r\n\r\n                trim({{ column_name }}) as {{ column_name }}\r\n\r\n            {%- else -%}\r\n\r\n                {{ column_name }}\r\n\r\n            {%- endif %}\r\n            \r\n        from {{ model }}\r\n\r\n    ),\r\n\r\n    errors as (\r\n\r\n        select * from all_values\r\n        where {{ column_name }} = ''\r\n\r\n    )\r\n\r\n    select * from errors\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7657983, "supported_languages": null}, "macro.dbt_utils.test_not_null_proportion": {"unique_id": "macro.dbt_utils.test_not_null_proportion", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_null_proportion.sql", "original_file_path": "macros\\generic_tests\\not_null_proportion.sql", "name": "test_not_null_proportion", "macro_sql": "{% macro test_not_null_proportion(model, group_by_columns = []) %}\r\n  {{ return(adapter.dispatch('test_not_null_proportion', 'dbt_utils')(model, group_by_columns, **kwargs)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_proportion"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7677999, "supported_languages": null}, "macro.dbt_utils.default__test_not_null_proportion": {"unique_id": "macro.dbt_utils.default__test_not_null_proportion", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\not_null_proportion.sql", "original_file_path": "macros\\generic_tests\\not_null_proportion.sql", "name": "default__test_not_null_proportion", "macro_sql": "{% macro default__test_not_null_proportion(model, group_by_columns) %}\r\n\r\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\r\n{% set at_least = kwargs.get('at_least', kwargs.get('arg')) %}\r\n{% set at_most = kwargs.get('at_most', kwargs.get('arg', 1)) %}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\r\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\nwith validation as (\r\n  select\r\n    {{select_gb_cols}}\r\n    sum(case when {{ column_name }} is null then 0 else 1 end) / cast(count(*) as numeric) as not_null_proportion\r\n  from {{ model }}\r\n  {{groupby_gb_cols}}\r\n),\r\nvalidation_errors as (\r\n  select\r\n    {{select_gb_cols}}\r\n    not_null_proportion\r\n  from validation\r\n  where not_null_proportion < {{ at_least }} or not_null_proportion > {{ at_most }}\r\n)\r\nselect\r\n  *\r\nfrom validation_errors\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7687995, "supported_languages": null}, "macro.dbt_utils.test_recency": {"unique_id": "macro.dbt_utils.test_recency", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\recency.sql", "original_file_path": "macros\\generic_tests\\recency.sql", "name": "test_recency", "macro_sql": "{% test recency(model, field, datepart, interval, ignore_time_component=False, group_by_columns = []) %}\r\n  {{ return(adapter.dispatch('test_recency', 'dbt_utils')(model, field, datepart, interval, ignore_time_component, group_by_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_recency"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7697997, "supported_languages": null}, "macro.dbt_utils.default__test_recency": {"unique_id": "macro.dbt_utils.default__test_recency", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\recency.sql", "original_file_path": "macros\\generic_tests\\recency.sql", "name": "default__test_recency", "macro_sql": "{% macro default__test_recency(model, field, datepart, interval, ignore_time_component, group_by_columns) %}\r\n\r\n{% set threshold = 'cast(' ~ dbt.dateadd(datepart, interval * -1, dbt.current_timestamp()) ~ ' as ' ~ ('date' if ignore_time_component else dbt.type_timestamp()) ~ ')'  %}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(' ,') + ', ' %}\r\n  {% set groupby_gb_cols = 'group by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\n\r\nwith recency as (\r\n\r\n    select \r\n\r\n      {{ select_gb_cols }}\r\n      {% if ignore_time_component %}\r\n        cast(max({{ field }}) as date) as most_recent\r\n      {%- else %}\r\n        max({{ field }}) as most_recent\r\n      {%- endif %}\r\n\r\n    from {{ model }}\r\n\r\n    {{ groupby_gb_cols }}\r\n\r\n)\r\n\r\nselect\r\n\r\n    {{ select_gb_cols }}\r\n    most_recent,\r\n    {{ threshold }} as threshold\r\n\r\nfrom recency\r\nwhere most_recent < {{ threshold }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.current_timestamp", "macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7717996, "supported_languages": null}, "macro.dbt_utils.test_relationships_where": {"unique_id": "macro.dbt_utils.test_relationships_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\relationships_where.sql", "original_file_path": "macros\\generic_tests\\relationships_where.sql", "name": "test_relationships_where", "macro_sql": "{% test relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\r\n  {{ return(adapter.dispatch('test_relationships_where', 'dbt_utils')(model, column_name, to, field, from_condition, to_condition)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_relationships_where"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7728002, "supported_languages": null}, "macro.dbt_utils.default__test_relationships_where": {"unique_id": "macro.dbt_utils.default__test_relationships_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\relationships_where.sql", "original_file_path": "macros\\generic_tests\\relationships_where.sql", "name": "default__test_relationships_where", "macro_sql": "{% macro default__test_relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\r\n\r\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\r\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\r\n\r\nwith left_table as (\r\n\r\n  select\r\n    {{column_name}} as id\r\n\r\n  from {{model}}\r\n\r\n  where {{column_name}} is not null\r\n    and {{from_condition}}\r\n\r\n),\r\n\r\nright_table as (\r\n\r\n  select\r\n    {{field}} as id\r\n\r\n  from {{to}}\r\n\r\n  where {{field}} is not null\r\n    and {{to_condition}}\r\n\r\n),\r\n\r\nexceptions as (\r\n\r\n  select\r\n    left_table.id,\r\n    right_table.id as right_id\r\n\r\n  from left_table\r\n\r\n  left join right_table\r\n         on left_table.id = right_table.id\r\n\r\n  where right_table.id is null\r\n\r\n)\r\n\r\nselect * from exceptions\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7737994, "supported_languages": null}, "macro.dbt_utils.test_sequential_values": {"unique_id": "macro.dbt_utils.test_sequential_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\sequential_values.sql", "original_file_path": "macros\\generic_tests\\sequential_values.sql", "name": "test_sequential_values", "macro_sql": "{% test sequential_values(model, column_name, interval=1, datepart=None, group_by_columns = []) %}\r\n\r\n  {{ return(adapter.dispatch('test_sequential_values', 'dbt_utils')(model, column_name, interval, datepart, group_by_columns)) }}\r\n\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_sequential_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7747996, "supported_languages": null}, "macro.dbt_utils.default__test_sequential_values": {"unique_id": "macro.dbt_utils.default__test_sequential_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\sequential_values.sql", "original_file_path": "macros\\generic_tests\\sequential_values.sql", "name": "default__test_sequential_values", "macro_sql": "{% macro default__test_sequential_values(model, column_name, interval=1, datepart=None, group_by_columns = []) %}\r\n\r\n{% set previous_column_name = \"previous_\" ~ dbt_utils.slugify(column_name) %}\r\n\r\n{% if group_by_columns|length() > 0 %}\r\n  {% set select_gb_cols = group_by_columns|join(',') + ', ' %}\r\n  {% set partition_gb_cols = 'partition by ' + group_by_columns|join(',') %}\r\n{% endif %}\r\n\r\nwith windowed as (\r\n\r\n    select\r\n        {{ select_gb_cols }}\r\n        {{ column_name }},\r\n        lag({{ column_name }}) over (\r\n            {{partition_gb_cols}}\r\n            order by {{ column_name }}\r\n        ) as {{ previous_column_name }}\r\n    from {{ model }}\r\n),\r\n\r\nvalidation_errors as (\r\n    select\r\n        *\r\n    from windowed\r\n    {% if datepart %}\r\n    where not(cast({{ column_name }} as {{ dbt.type_timestamp() }})= cast({{ dbt.dateadd(datepart, interval, previous_column_name) }} as {{ dbt.type_timestamp() }}))\r\n    {% else %}\r\n    where not({{ column_name }} = {{ previous_column_name }} + {{ interval }})\r\n    {% endif %}\r\n)\r\n\r\nselect *\r\nfrom validation_errors\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.slugify", "macro.dbt.type_timestamp", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7767994, "supported_languages": null}, "macro.dbt_utils.test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\unique_combination_of_columns.sql", "original_file_path": "macros\\generic_tests\\unique_combination_of_columns.sql", "name": "test_unique_combination_of_columns", "macro_sql": "{% test unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\r\n  {{ return(adapter.dispatch('test_unique_combination_of_columns', 'dbt_utils')(model, combination_of_columns, quote_columns)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_combination_of_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7777998, "supported_languages": null}, "macro.dbt_utils.default__test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.default__test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\generic_tests\\unique_combination_of_columns.sql", "original_file_path": "macros\\generic_tests\\unique_combination_of_columns.sql", "name": "default__test_unique_combination_of_columns", "macro_sql": "{% macro default__test_unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\r\n\r\n{% if not quote_columns %}\r\n    {%- set column_list=combination_of_columns %}\r\n{% elif quote_columns %}\r\n    {%- set column_list=[] %}\r\n        {% for column in combination_of_columns -%}\r\n            {% set column_list = column_list.append( adapter.quote(column) ) %}\r\n        {%- endfor %}\r\n{% else %}\r\n    {{ exceptions.raise_compiler_error(\r\n        \"`quote_columns` argument for unique_combination_of_columns test must be one of [True, False] Got: '\" ~ quote ~\"'.'\"\r\n    ) }}\r\n{% endif %}\r\n\r\n{%- set columns_csv=column_list | join(', ') %}\r\n\r\n\r\nwith validation_errors as (\r\n\r\n    select\r\n        {{ columns_csv }}\r\n    from {{ model }}\r\n    group by {{ columns_csv }}\r\n    having count(*) > 1\r\n\r\n)\r\n\r\nselect *\r\nfrom validation_errors\r\n\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7797995, "supported_languages": null}, "macro.dbt_utils.log_info": {"unique_id": "macro.dbt_utils.log_info", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\log_info.sql", "original_file_path": "macros\\jinja_helpers\\log_info.sql", "name": "log_info", "macro_sql": "{% macro log_info(message) %}\r\n    {{ return(adapter.dispatch('log_info', 'dbt_utils')(message)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__log_info"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7797995, "supported_languages": null}, "macro.dbt_utils.default__log_info": {"unique_id": "macro.dbt_utils.default__log_info", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\log_info.sql", "original_file_path": "macros\\jinja_helpers\\log_info.sql", "name": "default__log_info", "macro_sql": "{% macro default__log_info(message) %}\r\n    {{ log(dbt_utils.pretty_log_format(message), info=True) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7807996, "supported_languages": null}, "macro.dbt_utils.pretty_log_format": {"unique_id": "macro.dbt_utils.pretty_log_format", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\pretty_log_format.sql", "original_file_path": "macros\\jinja_helpers\\pretty_log_format.sql", "name": "pretty_log_format", "macro_sql": "{% macro pretty_log_format(message) %}\r\n    {{ return(adapter.dispatch('pretty_log_format', 'dbt_utils')(message)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7807996, "supported_languages": null}, "macro.dbt_utils.default__pretty_log_format": {"unique_id": "macro.dbt_utils.default__pretty_log_format", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\pretty_log_format.sql", "original_file_path": "macros\\jinja_helpers\\pretty_log_format.sql", "name": "default__pretty_log_format", "macro_sql": "{% macro default__pretty_log_format(message) %}\r\n    {{ return( dbt_utils.pretty_time() ~ ' + ' ~ message) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7817993, "supported_languages": null}, "macro.dbt_utils.pretty_time": {"unique_id": "macro.dbt_utils.pretty_time", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\pretty_time.sql", "original_file_path": "macros\\jinja_helpers\\pretty_time.sql", "name": "pretty_time", "macro_sql": "{% macro pretty_time(format='%H:%M:%S') %}\r\n    {{ return(adapter.dispatch('pretty_time', 'dbt_utils')(format)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7817993, "supported_languages": null}, "macro.dbt_utils.default__pretty_time": {"unique_id": "macro.dbt_utils.default__pretty_time", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\pretty_time.sql", "original_file_path": "macros\\jinja_helpers\\pretty_time.sql", "name": "default__pretty_time", "macro_sql": "{% macro default__pretty_time(format='%H:%M:%S') %}\r\n    {{ return(modules.datetime.datetime.now().strftime(format)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7828002, "supported_languages": null}, "macro.dbt_utils.slugify": {"unique_id": "macro.dbt_utils.slugify", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\slugify.sql", "original_file_path": "macros\\jinja_helpers\\slugify.sql", "name": "slugify", "macro_sql": "{% macro slugify(string) %}\r\n\r\n{#- Lower case the string -#}\r\n{% set string = string | lower %}\r\n{#- Replace spaces and dashes with underscores -#}\r\n{% set string = modules.re.sub('[ -]+', '_', string) %}\r\n{#- Only take letters, numbers, and underscores -#}\r\n{% set string = modules.re.sub('[^a-z0-9_]+', '', string) %}\r\n{#- Prepends \"_\" if string begins with a number -#}\r\n{% set string = modules.re.sub('^[0-9]', '_' + string[0], string) %}\r\n\r\n{{ return(string) }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7838001, "supported_languages": null}, "macro.dbt_utils._is_ephemeral": {"unique_id": "macro.dbt_utils._is_ephemeral", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\_is_ephemeral.sql", "original_file_path": "macros\\jinja_helpers\\_is_ephemeral.sql", "name": "_is_ephemeral", "macro_sql": "{% macro _is_ephemeral(obj, macro) %}\r\n    {%- if obj.is_cte -%}\r\n        {% set ephemeral_prefix = api.Relation.add_ephemeral_prefix('') %}\r\n        {% if obj.name.startswith(ephemeral_prefix) %}\r\n            {% set model_name = obj.name[(ephemeral_prefix|length):] %}\r\n        {% else %}\r\n            {% set model_name = obj.name %}\r\n        {%- endif -%}\r\n        {% set error_message %}\r\nThe `{{ macro }}` macro cannot be used with ephemeral models, as it relies on the information schema.\r\n\r\n`{{ model_name }}` is an ephemeral model. Consider making it a view or table instead.\r\n        {% endset %}\r\n        {%- do exceptions.raise_compiler_error(error_message) -%}\r\n    {%- endif -%}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7858, "supported_languages": null}, "macro.dbt_utils._is_relation": {"unique_id": "macro.dbt_utils._is_relation", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\jinja_helpers\\_is_relation.sql", "original_file_path": "macros\\jinja_helpers\\_is_relation.sql", "name": "_is_relation", "macro_sql": "{% macro _is_relation(obj, macro) %}\r\n    {%- if not (obj is mapping and obj.get('metadata', {}).get('type', '').endswith('Relation')) -%}\r\n        {%- do exceptions.raise_compiler_error(\"Macro \" ~ macro ~ \" expected a Relation but received the value: \" ~ obj) -%}\r\n    {%- endif -%}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7868, "supported_languages": null}, "macro.dbt_utils.get_intervals_between": {"unique_id": "macro.dbt_utils.get_intervals_between", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\r\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt_utils')(start_date, end_date, datepart)) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7878027, "supported_languages": null}, "macro.dbt_utils.default__get_intervals_between": {"unique_id": "macro.dbt_utils.default__get_intervals_between", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\r\n    {%- call statement('get_intervals_between', fetch_result=True) %}\r\n\r\n        select {{ dbt.datediff(start_date, end_date, datepart) }}\r\n\r\n    {%- endcall -%}\r\n\r\n    {%- set value_list = load_result('get_intervals_between') -%}\r\n\r\n    {%- if value_list and value_list['data'] -%}\r\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\r\n        {{ return(values[0]) }}\r\n    {%- else -%}\r\n        {{ return(1) }}\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7887998, "supported_languages": null}, "macro.dbt_utils.date_spine": {"unique_id": "macro.dbt_utils.date_spine", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\r\n    {{ return(adapter.dispatch('date_spine', 'dbt_utils')(datepart, start_date, end_date)) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7898002, "supported_languages": null}, "macro.dbt_utils.default__date_spine": {"unique_id": "macro.dbt_utils.default__date_spine", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\r\n\r\n\r\n{# call as follows:\r\n\r\ndate_spine(\r\n    \"day\",\r\n    \"to_date('01/01/2016', 'mm/dd/yyyy')\",\r\n    \"dbt.dateadd(week, 1, current_date)\"\r\n) #}\r\n\r\n\r\nwith rawdata as (\r\n\r\n    {{dbt_utils.generate_series(\r\n        dbt_utils.get_intervals_between(start_date, end_date, datepart)\r\n    )}}\r\n\r\n),\r\n\r\nall_periods as (\r\n\r\n    select (\r\n        {{\r\n            dbt.dateadd(\r\n                datepart,\r\n                \"row_number() over (order by 1) - 1\",\r\n                start_date\r\n            )\r\n        }}\r\n    ) as date_{{datepart}}\r\n    from rawdata\r\n\r\n),\r\n\r\nfiltered as (\r\n\r\n    select *\r\n    from all_periods\r\n    where date_{{datepart}} <= {{ end_date }}\r\n\r\n)\r\n\r\nselect * from filtered\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.generate_series", "macro.dbt_utils.get_intervals_between", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7898002, "supported_languages": null}, "macro.dbt_utils.deduplicate": {"unique_id": "macro.dbt_utils.deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "deduplicate", "macro_sql": "{%- macro deduplicate(relation, partition_by, order_by) -%}\r\n    {{ return(adapter.dispatch('deduplicate', 'dbt_utils')(relation, partition_by, order_by)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7908008, "supported_languages": null}, "macro.dbt_utils.default__deduplicate": {"unique_id": "macro.dbt_utils.default__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "default__deduplicate", "macro_sql": "\r\n\r\n{%- macro default__deduplicate(relation, partition_by, order_by) -%}\r\n\r\n    with row_numbered as (\r\n        select\r\n            _inner.*,\r\n            row_number() over (\r\n                partition by {{ partition_by }}\r\n                order by {{ order_by }}\r\n            ) as rn\r\n        from {{ relation }} as _inner\r\n    )\r\n\r\n    select\r\n        distinct data.*\r\n    from {{ relation }} as data\r\n    {#\r\n    -- Not all DBs will support natural joins but the ones that do include:\r\n    -- Oracle, MySQL, SQLite, Redshift, Teradata, Materialize, Databricks\r\n    -- Apache Spark, SingleStore, Vertica\r\n    -- Those that do not appear to support natural joins include:\r\n    -- SQLServer, Trino, Presto, Rockset, Athena\r\n    #}\r\n    natural join row_numbered\r\n    where row_numbered.rn = 1\r\n\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7917998, "supported_languages": null}, "macro.dbt_utils.redshift__deduplicate": {"unique_id": "macro.dbt_utils.redshift__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "redshift__deduplicate", "macro_sql": "{% macro redshift__deduplicate(relation, partition_by, order_by) -%}\r\n\r\n    {{ return(dbt_utils.default__deduplicate(relation, partition_by, order_by=order_by)) }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7917998, "supported_languages": null}, "macro.dbt_utils.postgres__deduplicate": {"unique_id": "macro.dbt_utils.postgres__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "postgres__deduplicate", "macro_sql": "\r\n{%- macro postgres__deduplicate(relation, partition_by, order_by) -%}\r\n\r\n    select\r\n        distinct on ({{ partition_by }}) *\r\n    from {{ relation }}\r\n    order by {{ partition_by }}{{ ',' ~ order_by }}\r\n\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7927997, "supported_languages": null}, "macro.dbt_utils.snowflake__deduplicate": {"unique_id": "macro.dbt_utils.snowflake__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "snowflake__deduplicate", "macro_sql": "\r\n{%- macro snowflake__deduplicate(relation, partition_by, order_by) -%}\r\n\r\n    select *\r\n    from {{ relation }}\r\n    qualify\r\n        row_number() over (\r\n            partition by {{ partition_by }}\r\n            order by {{ order_by }}\r\n        ) = 1\r\n\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7927997, "supported_languages": null}, "macro.dbt_utils.bigquery__deduplicate": {"unique_id": "macro.dbt_utils.bigquery__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "bigquery__deduplicate", "macro_sql": "\r\n{%- macro bigquery__deduplicate(relation, partition_by, order_by) -%}\r\n\r\n    select unique.*\r\n    from (\r\n        select\r\n            array_agg (\r\n                original\r\n                order by {{ order_by }}\r\n                limit 1\r\n            )[offset(0)] unique\r\n        from {{ relation }} original\r\n        group by {{ partition_by }}\r\n    )\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7927997, "supported_languages": null}, "macro.dbt_utils.get_powers_of_two": {"unique_id": "macro.dbt_utils.get_powers_of_two", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\r\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt_utils')(upper_bound)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7947998, "supported_languages": null}, "macro.dbt_utils.default__get_powers_of_two": {"unique_id": "macro.dbt_utils.default__get_powers_of_two", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\r\n\r\n    {% if upper_bound <= 0 %}\r\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\r\n    {% endif %}\r\n\r\n    {% for _ in range(1, 100) %}\r\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\r\n    {% endfor %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7958, "supported_languages": null}, "macro.dbt_utils.generate_series": {"unique_id": "macro.dbt_utils.generate_series", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\r\n    {{ return(adapter.dispatch('generate_series', 'dbt_utils')(upper_bound)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7958, "supported_languages": null}, "macro.dbt_utils.default__generate_series": {"unique_id": "macro.dbt_utils.default__generate_series", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\r\n\r\n    {% set n = dbt_utils.get_powers_of_two(upper_bound) %}\r\n\r\n    with p as (\r\n        select 0 as generated_number union all select 1\r\n    ), unioned as (\r\n\r\n    select\r\n\r\n    {% for i in range(n) %}\r\n    p{{i}}.generated_number * power(2, {{i}})\r\n    {% if not loop.last %} + {% endif %}\r\n    {% endfor %}\r\n    + 1\r\n    as generated_number\r\n\r\n    from\r\n\r\n    {% for i in range(n) %}\r\n    p as p{{i}}\r\n    {% if not loop.last %} cross join {% endif %}\r\n    {% endfor %}\r\n\r\n    )\r\n\r\n    select *\r\n    from unioned\r\n    where generated_number <= {{upper_bound}}\r\n    order by generated_number\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7967994, "supported_languages": null}, "macro.dbt_utils.generate_surrogate_key": {"unique_id": "macro.dbt_utils.generate_surrogate_key", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\generate_surrogate_key.sql", "original_file_path": "macros\\sql\\generate_surrogate_key.sql", "name": "generate_surrogate_key", "macro_sql": "{%- macro generate_surrogate_key(field_list) -%}\r\n    {{ return(adapter.dispatch('generate_surrogate_key', 'dbt_utils')(field_list)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__generate_surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7978003, "supported_languages": null}, "macro.dbt_utils.default__generate_surrogate_key": {"unique_id": "macro.dbt_utils.default__generate_surrogate_key", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\generate_surrogate_key.sql", "original_file_path": "macros\\sql\\generate_surrogate_key.sql", "name": "default__generate_surrogate_key", "macro_sql": "\r\n\r\n{%- macro default__generate_surrogate_key(field_list) -%}\r\n\r\n{% if var('surrogate_key_treat_nulls_as_empty_strings', False) %}\r\n    {% set default_null_value = \"\" %}\r\n{% else %}\r\n    {% set default_null_value = '_dbt_utils_surrogate_key_null_'%}\r\n{% endif %}\r\n\r\n{%- set fields = [] -%}\r\n\r\n{%- for field in field_list -%}\r\n\r\n    {%- do fields.append(\r\n        \"coalesce(cast(\" ~ field ~ \" as \" ~ dbt.type_string() ~ \"), '\" ~ default_null_value  ~\"')\"\r\n    ) -%}\r\n\r\n    {%- if not loop.last %}\r\n        {%- do fields.append(\"'-'\") -%}\r\n    {%- endif -%}\r\n\r\n{%- endfor -%}\r\n\r\n{{ dbt.hash(dbt.concat(fields)) }}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.type_string", "macro.dbt.hash", "macro.dbt.concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.7988002, "supported_languages": null}, "macro.dbt_utils.get_column_values": {"unique_id": "macro.dbt_utils.get_column_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_column_values.sql", "original_file_path": "macros\\sql\\get_column_values.sql", "name": "get_column_values", "macro_sql": "{% macro get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\r\n    {{ return(adapter.dispatch('get_column_values', 'dbt_utils')(table, column, order_by, max_records, default, where)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_column_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8008003, "supported_languages": null}, "macro.dbt_utils.default__get_column_values": {"unique_id": "macro.dbt_utils.default__get_column_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_column_values.sql", "original_file_path": "macros\\sql\\get_column_values.sql", "name": "default__get_column_values", "macro_sql": "{% macro default__get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\r\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\r\n    {%- if not execute -%}\r\n        {% set default = [] if not default %}\r\n        {{ return(default) }}\r\n    {% endif %}\r\n\r\n    {%- do dbt_utils._is_ephemeral(table, 'get_column_values') -%}\r\n\r\n    {# Not all relations are tables. Renaming for internal clarity without breaking functionality for anyone using named arguments #}\r\n    {# TODO: Change the method signature in a future 0.x.0 release #}\r\n    {%- set target_relation = table -%}\r\n\r\n    {# adapter.load_relation is a convenience wrapper to avoid building a Relation when we already have one #}\r\n    {% set relation_exists = (load_relation(target_relation)) is not none %}\r\n\r\n    {%- call statement('get_column_values', fetch_result=true) %}\r\n\r\n        {%- if not relation_exists and default is none -%}\r\n\r\n          {{ exceptions.raise_compiler_error(\"In get_column_values(): relation \" ~ target_relation ~ \" does not exist and no default value was provided.\") }}\r\n\r\n        {%- elif not relation_exists and default is not none -%}\r\n\r\n          {{ log(\"Relation \" ~ target_relation ~ \" does not exist. Returning the default value: \" ~ default) }}\r\n\r\n          {{ return(default) }}\r\n\r\n        {%- else -%}\r\n\r\n\r\n            select\r\n                {{ column }} as value\r\n\r\n            from {{ target_relation }}\r\n\r\n            {% if where is not none %}\r\n            where {{ where }}\r\n            {% endif %}\r\n\r\n            group by {{ column }}\r\n            order by {{ order_by }}\r\n\r\n            {% if max_records is not none %}\r\n            limit {{ max_records }}\r\n            {% endif %}\r\n\r\n        {% endif %}\r\n\r\n    {%- endcall -%}\r\n\r\n    {%- set value_list = load_result('get_column_values') -%}\r\n\r\n    {%- if value_list and value_list['data'] -%}\r\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\r\n        {{ return(values) }}\r\n    {%- else -%}\r\n        {{ return(default) }}\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_ephemeral", "macro.dbt.load_relation", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8038, "supported_languages": null}, "macro.dbt_utils.get_filtered_columns_in_relation": {"unique_id": "macro.dbt_utils.get_filtered_columns_in_relation", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_filtered_columns_in_relation.sql", "original_file_path": "macros\\sql\\get_filtered_columns_in_relation.sql", "name": "get_filtered_columns_in_relation", "macro_sql": "{% macro get_filtered_columns_in_relation(from, except=[]) -%}\r\n    {{ return(adapter.dispatch('get_filtered_columns_in_relation', 'dbt_utils')(from, except)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8048, "supported_languages": null}, "macro.dbt_utils.default__get_filtered_columns_in_relation": {"unique_id": "macro.dbt_utils.default__get_filtered_columns_in_relation", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_filtered_columns_in_relation.sql", "original_file_path": "macros\\sql\\get_filtered_columns_in_relation.sql", "name": "default__get_filtered_columns_in_relation", "macro_sql": "{% macro default__get_filtered_columns_in_relation(from, except=[]) -%}\r\n    {%- do dbt_utils._is_relation(from, 'get_filtered_columns_in_relation') -%}\r\n    {%- do dbt_utils._is_ephemeral(from, 'get_filtered_columns_in_relation') -%}\r\n\r\n    {# -- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\r\n    {%- if not execute -%}\r\n        {{ return('') }}\r\n    {% endif %}\r\n\r\n    {%- set include_cols = [] %}\r\n    {%- set cols = adapter.get_columns_in_relation(from) -%}\r\n    {%- set except = except | map(\"lower\") | list %}\r\n    {%- for col in cols -%}\r\n        {%- if col.column|lower not in except -%}\r\n            {% do include_cols.append(col.column) %}\r\n        {%- endif %}\r\n    {%- endfor %}\r\n\r\n    {{ return(include_cols) }}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8058002, "supported_languages": null}, "macro.dbt_utils.get_query_results_as_dict": {"unique_id": "macro.dbt_utils.get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_query_results_as_dict.sql", "original_file_path": "macros\\sql\\get_query_results_as_dict.sql", "name": "get_query_results_as_dict", "macro_sql": "{% macro get_query_results_as_dict(query) %}\r\n    {{ return(adapter.dispatch('get_query_results_as_dict', 'dbt_utils')(query)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_query_results_as_dict"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8068001, "supported_languages": null}, "macro.dbt_utils.default__get_query_results_as_dict": {"unique_id": "macro.dbt_utils.default__get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_query_results_as_dict.sql", "original_file_path": "macros\\sql\\get_query_results_as_dict.sql", "name": "default__get_query_results_as_dict", "macro_sql": "{% macro default__get_query_results_as_dict(query) %}\r\n\r\n{# This macro returns a dictionary of the form {column_name: (tuple_of_results)} #}\r\n\r\n    {%- call statement('get_query_results', fetch_result=True,auto_begin=false) -%}\r\n\r\n        {{ query }}\r\n\r\n    {%- endcall -%}\r\n\r\n    {% set sql_results={} %}\r\n\r\n    {%- if execute -%}\r\n        {% set sql_results_table = load_result('get_query_results').table.columns %}\r\n        {% for column_name, column in sql_results_table.items() %}\r\n            {% do sql_results.update({column_name: column.values()}) %}\r\n        {% endfor %}\r\n    {%- endif -%}\r\n\r\n    {{ return(sql_results) }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8077998, "supported_languages": null}, "macro.dbt_utils.get_relations_by_pattern": {"unique_id": "macro.dbt_utils.get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_relations_by_pattern.sql", "original_file_path": "macros\\sql\\get_relations_by_pattern.sql", "name": "get_relations_by_pattern", "macro_sql": "{% macro get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\r\n    {{ return(adapter.dispatch('get_relations_by_pattern', 'dbt_utils')(schema_pattern, table_pattern, exclude, database)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_pattern"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8088, "supported_languages": null}, "macro.dbt_utils.default__get_relations_by_pattern": {"unique_id": "macro.dbt_utils.default__get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_relations_by_pattern.sql", "original_file_path": "macros\\sql\\get_relations_by_pattern.sql", "name": "default__get_relations_by_pattern", "macro_sql": "{% macro default__get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\r\n\r\n    {%- call statement('get_tables', fetch_result=True) %}\r\n\r\n      {{ dbt_utils.get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude, database) }}\r\n\r\n    {%- endcall -%}\r\n\r\n    {%- set table_list = load_result('get_tables') -%}\r\n\r\n    {%- if table_list and table_list['table'] -%}\r\n        {%- set tbl_relations = [] -%}\r\n        {%- for row in table_list['table'] -%}\r\n            {%- set tbl_relation = api.Relation.create(\r\n                database=database,\r\n                schema=row.table_schema,\r\n                identifier=row.table_name,\r\n                type=row.table_type\r\n            ) -%}\r\n            {%- do tbl_relations.append(tbl_relation) -%}\r\n        {%- endfor -%}\r\n\r\n        {{ return(tbl_relations) }}\r\n    {%- else -%}\r\n        {{ return([]) }}\r\n    {%- endif -%}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8107996, "supported_languages": null}, "macro.dbt_utils.get_relations_by_prefix": {"unique_id": "macro.dbt_utils.get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_relations_by_prefix.sql", "original_file_path": "macros\\sql\\get_relations_by_prefix.sql", "name": "get_relations_by_prefix", "macro_sql": "{% macro get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\r\n    {{ return(adapter.dispatch('get_relations_by_prefix', 'dbt_utils')(schema, prefix, exclude, database)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_prefix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8117998, "supported_languages": null}, "macro.dbt_utils.default__get_relations_by_prefix": {"unique_id": "macro.dbt_utils.default__get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_relations_by_prefix.sql", "original_file_path": "macros\\sql\\get_relations_by_prefix.sql", "name": "default__get_relations_by_prefix", "macro_sql": "{% macro default__get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\r\n\r\n    {%- call statement('get_tables', fetch_result=True) %}\r\n\r\n      {{ dbt_utils.get_tables_by_prefix_sql(schema, prefix, exclude, database) }}\r\n\r\n    {%- endcall -%}\r\n\r\n    {%- set table_list = load_result('get_tables') -%}\r\n\r\n    {%- if table_list and table_list['table'] -%}\r\n        {%- set tbl_relations = [] -%}\r\n        {%- for row in table_list['table'] -%}\r\n            {%- set tbl_relation = api.Relation.create(\r\n                database=database,\r\n                schema=row.table_schema,\r\n                identifier=row.table_name,\r\n                type=row.table_type\r\n            ) -%}\r\n            {%- do tbl_relations.append(tbl_relation) -%}\r\n        {%- endfor -%}\r\n\r\n        {{ return(tbl_relations) }}\r\n    {%- else -%}\r\n        {{ return([]) }}\r\n    {%- endif -%}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8137994, "supported_languages": null}, "macro.dbt_utils.get_single_value": {"unique_id": "macro.dbt_utils.get_single_value", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_single_value.sql", "original_file_path": "macros\\sql\\get_single_value.sql", "name": "get_single_value", "macro_sql": "{% macro get_single_value(query, default=none) %}\r\n    {{ return(adapter.dispatch('get_single_value', 'dbt_utils')(query, default)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_single_value"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8147998, "supported_languages": null}, "macro.dbt_utils.default__get_single_value": {"unique_id": "macro.dbt_utils.default__get_single_value", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_single_value.sql", "original_file_path": "macros\\sql\\get_single_value.sql", "name": "default__get_single_value", "macro_sql": "{% macro default__get_single_value(query, default) %}\r\n\r\n{# This macro returns the (0, 0) record in a query, i.e. the first row of the first column #}\r\n\r\n    {%- call statement('get_query_result', fetch_result=True, auto_begin=false) -%}\r\n\r\n        {{ query }}\r\n\r\n    {%- endcall -%}\r\n\r\n    {%- if execute -%}\r\n\r\n        {% set r = load_result('get_query_result').table.columns[0].values() %}\r\n        {% if r | length == 0 %}\r\n            {% do print('Query `' ~ query ~ '` returned no rows. Using the default value: ' ~ default) %}\r\n            {% set sql_result = default %}\r\n        {% else %}\r\n            {% set sql_result = r[0] %}\r\n        {% endif %}\r\n        \r\n    {%- else -%}\r\n    \r\n        {% set sql_result = default %}\r\n    \r\n    {%- endif -%}\r\n\r\n    {% do return(sql_result) %}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8157988, "supported_languages": null}, "macro.dbt_utils.get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "get_tables_by_pattern_sql", "macro_sql": "{% macro get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\r\n    {{ return(adapter.dispatch('get_tables_by_pattern_sql', 'dbt_utils')\r\n        (schema_pattern, table_pattern, exclude, database)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8188016, "supported_languages": null}, "macro.dbt_utils.default__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "default__get_tables_by_pattern_sql", "macro_sql": "{% macro default__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\r\n\r\n        select distinct\r\n            table_schema as {{ adapter.quote('table_schema') }},\r\n            table_name as {{ adapter.quote('table_name') }},\r\n            {{ dbt_utils.get_table_types_sql() }}\r\n        from {{ database }}.information_schema.tables\r\n        where table_schema ilike '{{ schema_pattern }}'\r\n        and table_name ilike '{{ table_pattern }}'\r\n        and table_name not ilike '{{ exclude }}'\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8198025, "supported_languages": null}, "macro.dbt_utils.bigquery__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.bigquery__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "bigquery__get_tables_by_pattern_sql", "macro_sql": "{% macro bigquery__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\r\n\r\n    {% if '%' in schema_pattern %}\r\n        {% set schemata=dbt_utils._bigquery__get_matching_schemata(schema_pattern, database) %}\r\n    {% else %}\r\n        {% set schemata=[schema_pattern] %}\r\n    {% endif %}\r\n\r\n    {% set sql %}\r\n        {% for schema in schemata %}\r\n            select distinct\r\n                table_schema,\r\n                table_name,\r\n                {{ dbt_utils.get_table_types_sql() }}\r\n\r\n            from {{ adapter.quote(database) }}.{{ schema }}.INFORMATION_SCHEMA.TABLES\r\n            where lower(table_name) like lower ('{{ table_pattern }}')\r\n                and lower(table_name) not like lower ('{{ exclude }}')\r\n\r\n            {% if not loop.last %} union all {% endif %}\r\n\r\n        {% endfor %}\r\n    {% endset %}\r\n\r\n    {{ return(sql) }}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._bigquery__get_matching_schemata", "macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8207989, "supported_languages": null}, "macro.dbt_utils._bigquery__get_matching_schemata": {"unique_id": "macro.dbt_utils._bigquery__get_matching_schemata", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "_bigquery__get_matching_schemata", "macro_sql": "{% macro _bigquery__get_matching_schemata(schema_pattern, database) %}\r\n    {% if execute %}\r\n\r\n        {% set sql %}\r\n        select schema_name from {{ adapter.quote(database) }}.INFORMATION_SCHEMA.SCHEMATA\r\n        where lower(schema_name) like lower('{{ schema_pattern }}')\r\n        {% endset %}\r\n\r\n        {% set results=run_query(sql) %}\r\n\r\n        {% set schemata=results.columns['schema_name'].values() %}\r\n\r\n        {{ return(schemata) }}\r\n\r\n    {% else %}\r\n\r\n        {{ return([]) }}\r\n\r\n    {% endif %}\r\n\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8218153, "supported_languages": null}, "macro.dbt_utils.get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_tables_by_prefix_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_prefix_sql.sql", "name": "get_tables_by_prefix_sql", "macro_sql": "{% macro get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\r\n    {{ return(adapter.dispatch('get_tables_by_prefix_sql', 'dbt_utils')(schema, prefix, exclude, database)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.822809, "supported_languages": null}, "macro.dbt_utils.default__get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_tables_by_prefix_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_prefix_sql.sql", "name": "default__get_tables_by_prefix_sql", "macro_sql": "{% macro default__get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\r\n\r\n    {{ dbt_utils.get_tables_by_pattern_sql(\r\n        schema_pattern = schema,\r\n        table_pattern = prefix ~ '%',\r\n        exclude = exclude,\r\n        database = database\r\n    ) }}\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.823809, "supported_languages": null}, "macro.dbt_utils.get_table_types_sql": {"unique_id": "macro.dbt_utils.get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "get_table_types_sql", "macro_sql": "{%- macro get_table_types_sql() -%}\r\n  {{ return(adapter.dispatch('get_table_types_sql', 'dbt_utils')()) }}\r\n{%- endmacro -%}\r\n\r\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8248093, "supported_languages": null}, "macro.dbt_utils.default__get_table_types_sql": {"unique_id": "macro.dbt_utils.default__get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "default__get_table_types_sql", "macro_sql": "{% macro default__get_table_types_sql() %}\r\n            case table_type\r\n                when 'BASE TABLE' then 'table'\r\n                when 'EXTERNAL TABLE' then 'external'\r\n                when 'MATERIALIZED VIEW' then 'materializedview'\r\n                else lower(table_type)\r\n            end as {{ adapter.quote('table_type') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8248093, "supported_languages": null}, "macro.dbt_utils.postgres__get_table_types_sql": {"unique_id": "macro.dbt_utils.postgres__get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "postgres__get_table_types_sql", "macro_sql": "{% macro postgres__get_table_types_sql() %}\r\n            case table_type\r\n                when 'BASE TABLE' then 'table'\r\n                when 'FOREIGN' then 'external'\r\n                when 'MATERIALIZED VIEW' then 'materializedview'\r\n                else lower(table_type)\r\n            end as {{ adapter.quote('table_type') }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8248093, "supported_languages": null}, "macro.dbt_utils.group_by": {"unique_id": "macro.dbt_utils.group_by", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\groupby.sql", "original_file_path": "macros\\sql\\groupby.sql", "name": "group_by", "macro_sql": "{%- macro group_by(n) -%}\r\n    {{ return(adapter.dispatch('group_by', 'dbt_utils')(n)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__group_by"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8258119, "supported_languages": null}, "macro.dbt_utils.default__group_by": {"unique_id": "macro.dbt_utils.default__group_by", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\groupby.sql", "original_file_path": "macros\\sql\\groupby.sql", "name": "default__group_by", "macro_sql": "\r\n\r\n{%- macro default__group_by(n) -%}\r\n\r\n  group by {% for i in range(1, n + 1) -%}\r\n      {{ i }}{{ ',' if not loop.last }}   \r\n   {%- endfor -%}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8258119, "supported_languages": null}, "macro.dbt_utils.degrees_to_radians": {"unique_id": "macro.dbt_utils.degrees_to_radians", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "degrees_to_radians", "macro_sql": "{% macro degrees_to_radians(degrees) -%}\r\n    acos(-1) * {{degrees}} / 180\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8278103, "supported_languages": null}, "macro.dbt_utils.haversine_distance": {"unique_id": "macro.dbt_utils.haversine_distance", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "haversine_distance", "macro_sql": "{% macro haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\r\n    {{ return(adapter.dispatch('haversine_distance', 'dbt_utils')(lat1,lon1,lat2,lon2,unit)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__haversine_distance"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8288095, "supported_languages": null}, "macro.dbt_utils.default__haversine_distance": {"unique_id": "macro.dbt_utils.default__haversine_distance", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "default__haversine_distance", "macro_sql": "{% macro default__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\r\n{%- if unit == 'mi' %}\r\n    {% set conversion_rate = 1 %}\r\n{% elif unit == 'km' %}\r\n    {% set conversion_rate = 1.60934 %}\r\n{% else %}\r\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\r\n{% endif %}\r\n\r\n    2 * 3961 * asin(sqrt(power((sin(radians(({{ lat2 }} - {{ lat1 }}) / 2))), 2) +\r\n    cos(radians({{lat1}})) * cos(radians({{lat2}})) *\r\n    power((sin(radians(({{ lon2 }} - {{ lon1 }}) / 2))), 2))) * {{ conversion_rate }}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.829809, "supported_languages": null}, "macro.dbt_utils.bigquery__haversine_distance": {"unique_id": "macro.dbt_utils.bigquery__haversine_distance", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "bigquery__haversine_distance", "macro_sql": "{% macro bigquery__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\r\n{% set radians_lat1 = dbt_utils.degrees_to_radians(lat1) %}\r\n{% set radians_lat2 = dbt_utils.degrees_to_radians(lat2) %}\r\n{% set radians_lon1 = dbt_utils.degrees_to_radians(lon1) %}\r\n{% set radians_lon2 = dbt_utils.degrees_to_radians(lon2) %}\r\n{%- if unit == 'mi' %}\r\n    {% set conversion_rate = 1 %}\r\n{% elif unit == 'km' %}\r\n    {% set conversion_rate = 1.60934 %}\r\n{% else %}\r\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\r\n{% endif %}\r\n    2 * 3961 * asin(sqrt(power(sin(({{ radians_lat2 }} - {{ radians_lat1 }}) / 2), 2) +\r\n    cos({{ radians_lat1 }}) * cos({{ radians_lat2 }}) *\r\n    power(sin(({{ radians_lon2 }} - {{ radians_lon1 }}) / 2), 2))) * {{ conversion_rate }}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.degrees_to_radians"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.830812, "supported_languages": null}, "macro.dbt_utils.nullcheck": {"unique_id": "macro.dbt_utils.nullcheck", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\nullcheck.sql", "original_file_path": "macros\\sql\\nullcheck.sql", "name": "nullcheck", "macro_sql": "{% macro nullcheck(cols) %}\r\n    {{ return(adapter.dispatch('nullcheck', 'dbt_utils')(cols)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8317997, "supported_languages": null}, "macro.dbt_utils.default__nullcheck": {"unique_id": "macro.dbt_utils.default__nullcheck", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\nullcheck.sql", "original_file_path": "macros\\sql\\nullcheck.sql", "name": "default__nullcheck", "macro_sql": "{% macro default__nullcheck(cols) %}\r\n{%- for col in cols %}\r\n\r\n    {% if col.is_string() -%}\r\n\r\n    nullif({{col.name}},'') as {{col.name}}\r\n\r\n    {%- else -%}\r\n\r\n    {{col.name}}\r\n\r\n    {%- endif -%}\r\n\r\n{%- if not loop.last -%} , {%- endif -%}\r\n\r\n{%- endfor -%}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8327992, "supported_languages": null}, "macro.dbt_utils.nullcheck_table": {"unique_id": "macro.dbt_utils.nullcheck_table", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\nullcheck_table.sql", "original_file_path": "macros\\sql\\nullcheck_table.sql", "name": "nullcheck_table", "macro_sql": "{% macro nullcheck_table(relation) %}\r\n    {{ return(adapter.dispatch('nullcheck_table', 'dbt_utils')(relation)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8327992, "supported_languages": null}, "macro.dbt_utils.default__nullcheck_table": {"unique_id": "macro.dbt_utils.default__nullcheck_table", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\nullcheck_table.sql", "original_file_path": "macros\\sql\\nullcheck_table.sql", "name": "default__nullcheck_table", "macro_sql": "{% macro default__nullcheck_table(relation) %}\r\n\r\n  {%- do dbt_utils._is_relation(relation, 'nullcheck_table') -%}\r\n  {%- do dbt_utils._is_ephemeral(relation, 'nullcheck_table') -%}\r\n  {% set cols = adapter.get_columns_in_relation(relation) %}\r\n\r\n  select {{ dbt_utils.nullcheck(cols) }}\r\n  from {{relation}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8337996, "supported_languages": null}, "macro.dbt_utils.pivot": {"unique_id": "macro.dbt_utils.pivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\pivot.sql", "original_file_path": "macros\\sql\\pivot.sql", "name": "pivot", "macro_sql": "{% macro pivot(column,\r\n               values,\r\n               alias=True,\r\n               agg='sum',\r\n               cmp='=',\r\n               prefix='',\r\n               suffix='',\r\n               then_value=1,\r\n               else_value=0,\r\n               quote_identifiers=True,\r\n               distinct=False) %}\r\n    {{ return(adapter.dispatch('pivot', 'dbt_utils')(column, values, alias, agg, cmp, prefix, suffix, then_value, else_value, quote_identifiers, distinct)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pivot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8358004, "supported_languages": null}, "macro.dbt_utils.default__pivot": {"unique_id": "macro.dbt_utils.default__pivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\pivot.sql", "original_file_path": "macros\\sql\\pivot.sql", "name": "default__pivot", "macro_sql": "{% macro default__pivot(column,\r\n               values,\r\n               alias=True,\r\n               agg='sum',\r\n               cmp='=',\r\n               prefix='',\r\n               suffix='',\r\n               then_value=1,\r\n               else_value=0,\r\n               quote_identifiers=True,\r\n               distinct=False) %}\r\n  {% for value in values %}\r\n    {{ agg }}(\r\n      {% if distinct %} distinct {% endif %}\r\n      case\r\n      when {{ column }} {{ cmp }} '{{ dbt.escape_single_quotes(value) }}'\r\n        then {{ then_value }}\r\n      else {{ else_value }}\r\n      end\r\n    )\r\n    {% if alias %}\r\n      {% if quote_identifiers %}\r\n            as {{ adapter.quote(prefix ~ value ~ suffix) }}\r\n      {% else %}\r\n        as {{ dbt_utils.slugify(prefix ~ value ~ suffix) }}\r\n      {% endif %}\r\n    {% endif %}\r\n    {% if not loop.last %},{% endif %}\r\n  {% endfor %}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.escape_single_quotes", "macro.dbt_utils.slugify"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8367999, "supported_languages": null}, "macro.dbt_utils.safe_add": {"unique_id": "macro.dbt_utils.safe_add", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\safe_add.sql", "original_file_path": "macros\\sql\\safe_add.sql", "name": "safe_add", "macro_sql": "{%- macro safe_add(field_list) -%}\r\n    {{ return(adapter.dispatch('safe_add', 'dbt_utils')(field_list)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_add"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8378, "supported_languages": null}, "macro.dbt_utils.default__safe_add": {"unique_id": "macro.dbt_utils.default__safe_add", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\safe_add.sql", "original_file_path": "macros\\sql\\safe_add.sql", "name": "default__safe_add", "macro_sql": "\r\n\r\n{%- macro default__safe_add(field_list) -%}\r\n\r\n{%- if field_list is not iterable or field_list is string or field_list is mapping -%}\r\n\r\n{%- set error_message = '\r\nWarning: the `safe_add` macro now takes a single list argument instead of \\\r\nstring arguments. The {}.{} model triggered this warning. \\\r\n'.format(model.package_name, model.name) -%}\r\n\r\n{%- do exceptions.warn(error_message) -%}\r\n\r\n{%- endif -%}\r\n\r\n{% set fields = [] %}\r\n\r\n{%- for field in field_list -%}\r\n\r\n    {% do fields.append(\"coalesce(\" ~ field ~ \", 0)\") %}\r\n\r\n{%- endfor -%}\r\n\r\n{{ fields|join(' +\\n  ') }}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8388002, "supported_languages": null}, "macro.dbt_utils.safe_divide": {"unique_id": "macro.dbt_utils.safe_divide", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\safe_divide.sql", "original_file_path": "macros\\sql\\safe_divide.sql", "name": "safe_divide", "macro_sql": "{% macro safe_divide(numerator, denominator) -%}\r\n  {{ return(adapter.dispatch('safe_divide', 'dbt_utils')(numerator, denominator)) }}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_divide"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8398, "supported_languages": null}, "macro.dbt_utils.default__safe_divide": {"unique_id": "macro.dbt_utils.default__safe_divide", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\safe_divide.sql", "original_file_path": "macros\\sql\\safe_divide.sql", "name": "default__safe_divide", "macro_sql": "{% macro default__safe_divide(numerator, denominator) %}\r\n    ( {{ numerator }} ) / nullif( ( {{ denominator }} ), 0)\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8398, "supported_languages": null}, "macro.dbt_utils.star": {"unique_id": "macro.dbt_utils.star", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\star.sql", "original_file_path": "macros\\sql\\star.sql", "name": "star", "macro_sql": "{% macro star(from, relation_alias=False, except=[], prefix='', suffix='', quote_identifiers=True) -%}\r\n    {{ return(adapter.dispatch('star', 'dbt_utils')(from, relation_alias, except, prefix, suffix, quote_identifiers)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__star"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8418, "supported_languages": null}, "macro.dbt_utils.default__star": {"unique_id": "macro.dbt_utils.default__star", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\star.sql", "original_file_path": "macros\\sql\\star.sql", "name": "default__star", "macro_sql": "{% macro default__star(from, relation_alias=False, except=[], prefix='', suffix='', quote_identifiers=True) -%}\r\n    {%- do dbt_utils._is_relation(from, 'star') -%}\r\n    {%- do dbt_utils._is_ephemeral(from, 'star') -%}\r\n\r\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\r\n    {%- if not execute -%}\r\n        {% do return('*') %}\r\n    {%- endif -%}\r\n\r\n    {% set cols = dbt_utils.get_filtered_columns_in_relation(from, except) %}\r\n\r\n    {%- if cols|length <= 0 -%}\r\n        {% if flags.WHICH == 'compile' %}\r\n            {% set response %}\r\n*\r\n/* No columns were returned. Maybe the relation doesn't exist yet \r\nor all columns were excluded. This star is only output during  \r\ndbt compile, and exists to keep SQLFluff happy. */\r\n            {% endset %}\r\n            {% do return(response) %}\r\n        {% else %}\r\n            {% do return(\"/* no columns returned from star() macro */\") %}\r\n        {% endif %}\r\n    {%- else -%}\r\n        {%- for col in cols %}\r\n            {%- if relation_alias %}{{ relation_alias }}.{% else %}{%- endif -%}\r\n                {%- if quote_identifiers -%}\r\n                    {{ adapter.quote(col)|trim }} {%- if prefix!='' or suffix!='' %} as {{ adapter.quote(prefix ~ col ~ suffix)|trim }} {%- endif -%}\r\n                {%- else -%}\r\n                    {{ col|trim }} {%- if prefix!='' or suffix!='' %} as {{ (prefix ~ col ~ suffix)|trim }} {%- endif -%}\r\n                {% endif %}\r\n            {%- if not loop.last %},{{ '\\n  ' }}{%- endif -%}\r\n        {%- endfor -%}\r\n    {% endif %}\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8447998, "supported_languages": null}, "macro.dbt_utils.surrogate_key": {"unique_id": "macro.dbt_utils.surrogate_key", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\surrogate_key.sql", "original_file_path": "macros\\sql\\surrogate_key.sql", "name": "surrogate_key", "macro_sql": "{%- macro surrogate_key(field_list) -%}\r\n    {% set frustrating_jinja_feature = varargs %}\r\n    {{ return(adapter.dispatch('surrogate_key', 'dbt_utils')(field_list, *varargs)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8458002, "supported_languages": null}, "macro.dbt_utils.default__surrogate_key": {"unique_id": "macro.dbt_utils.default__surrogate_key", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\surrogate_key.sql", "original_file_path": "macros\\sql\\surrogate_key.sql", "name": "default__surrogate_key", "macro_sql": "\r\n\r\n{%- macro default__surrogate_key(field_list) -%}\r\n\r\n{%- set error_message = '\r\nWarning: `dbt_utils.surrogate_key` has been replaced by \\\r\n`dbt_utils.generate_surrogate_key`. The new macro treats null values \\\r\ndifferently to empty strings. To restore the behaviour of the original \\\r\nmacro, add a global variable in dbt_project.yml called \\\r\n`surrogate_key_treat_nulls_as_empty_strings` to your \\\r\ndbt_project.yml file with a value of True. \\\r\nThe {}.{} model triggered this warning. \\\r\n'.format(model.package_name, model.name) -%}\r\n\r\n{%- do exceptions.raise_compiler_error(error_message) -%}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8458002, "supported_languages": null}, "macro.dbt_utils.union_relations": {"unique_id": "macro.dbt_utils.union_relations", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\union.sql", "original_file_path": "macros\\sql\\union.sql", "name": "union_relations", "macro_sql": "{%- macro union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\r\n    {{ return(adapter.dispatch('union_relations', 'dbt_utils')(relations, column_override, include, exclude, source_column_name, where)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__union_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8498, "supported_languages": null}, "macro.dbt_utils.default__union_relations": {"unique_id": "macro.dbt_utils.default__union_relations", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\union.sql", "original_file_path": "macros\\sql\\union.sql", "name": "default__union_relations", "macro_sql": "\r\n\r\n{%- macro default__union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\r\n\r\n    {%- if exclude and include -%}\r\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\r\n    {%- endif -%}\r\n\r\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\r\n    {%- if not execute %}\r\n        {{ return('') }}\r\n    {% endif -%}\r\n\r\n    {%- set column_override = column_override if column_override is not none else {} -%}\r\n\r\n    {%- set relation_columns = {} -%}\r\n    {%- set column_superset = {} -%}\r\n    {%- set all_excludes = [] -%}\r\n    {%- set all_includes = [] -%}\r\n\r\n    {%- if exclude -%}\r\n        {%- for exc in exclude -%}\r\n            {%- do all_excludes.append(exc | lower) -%}\r\n        {%- endfor -%}\r\n    {%- endif -%}\r\n\r\n    {%- if include -%}\r\n        {%- for inc in include -%}\r\n            {%- do all_includes.append(inc | lower) -%}\r\n        {%- endfor -%}\r\n    {%- endif -%}\r\n\r\n    {%- for relation in relations -%}\r\n\r\n        {%- do relation_columns.update({relation: []}) -%}\r\n\r\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\r\n        {%- do dbt_utils._is_ephemeral(relation, 'union_relations') -%}\r\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\r\n        {%- for col in cols -%}\r\n\r\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\r\n        {%- if exclude and col.column | lower in all_excludes -%}\r\n\r\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\r\n        {%- elif include and col.column | lower not in all_includes -%}\r\n\r\n        {#- Otherwise add the column to the column superset -#}\r\n        {%- else -%}\r\n\r\n            {#- update the list of columns in this relation -#}\r\n            {%- do relation_columns[relation].append(col.column) -%}\r\n\r\n            {%- if col.column in column_superset -%}\r\n\r\n                {%- set stored = column_superset[col.column] -%}\r\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\r\n\r\n                    {%- do column_superset.update({col.column: col}) -%}\r\n\r\n                {%- endif %}\r\n\r\n            {%- else -%}\r\n\r\n                {%- do column_superset.update({col.column: col}) -%}\r\n\r\n            {%- endif -%}\r\n\r\n        {%- endif -%}\r\n\r\n        {%- endfor -%}\r\n    {%- endfor -%}\r\n\r\n    {%- set ordered_column_names = column_superset.keys() -%}\r\n    {%- set dbt_command = flags.WHICH -%}\r\n\r\n\r\n    {% if dbt_command in ['run', 'build'] %}\r\n    {% if (include | length > 0 or exclude | length > 0) and not column_superset.keys() %}\r\n        {%- set relations_string -%}\r\n            {%- for relation in relations -%}\r\n                {{ relation.name }}\r\n            {%- if not loop.last %}, {% endif -%}\r\n            {%- endfor -%}\r\n        {%- endset -%}\r\n\r\n        {%- set error_message -%}\r\n            There were no columns found to union for relations {{ relations_string }}\r\n        {%- endset -%}\r\n\r\n        {{ exceptions.raise_compiler_error(error_message) }}\r\n    {%- endif -%}\r\n    {%- endif -%}\r\n\r\n    {%- for relation in relations %}\r\n\r\n        (\r\n            select\r\n\r\n                {%- if source_column_name is not none %}\r\n                cast({{ dbt.string_literal(relation) }} as {{ dbt.type_string() }}) as {{ source_column_name }},\r\n                {%- endif %}\r\n\r\n                {% for col_name in ordered_column_names -%}\r\n\r\n                    {%- set col = column_superset[col_name] %}\r\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\r\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\r\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\r\n\r\n                {%- endfor %}\r\n\r\n            from {{ relation }}\r\n\r\n            {% if where -%}\r\n            where {{ where }}\r\n            {%- endif %}\r\n        )\r\n\r\n        {% if not loop.last -%}\r\n            union all\r\n        {% endif -%}\r\n\r\n    {%- endfor -%}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt.string_literal", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8558116, "supported_languages": null}, "macro.dbt_utils.unpivot": {"unique_id": "macro.dbt_utils.unpivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\unpivot.sql", "original_file_path": "macros\\sql\\unpivot.sql", "name": "unpivot", "macro_sql": "{% macro unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value') -%}\r\n    {{ return(adapter.dispatch('unpivot', 'dbt_utils')(relation, cast_to, exclude, remove, field_name, value_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__unpivot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8588114, "supported_languages": null}, "macro.dbt_utils.default__unpivot": {"unique_id": "macro.dbt_utils.default__unpivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\unpivot.sql", "original_file_path": "macros\\sql\\unpivot.sql", "name": "default__unpivot", "macro_sql": "{% macro default__unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value') -%}\r\n\r\n    {% if not relation %}\r\n        {{ exceptions.raise_compiler_error(\"Error: argument `relation` is required for `unpivot` macro.\") }}\r\n    {% endif %}\r\n\r\n  {%- set exclude = exclude if exclude is not none else [] %}\r\n  {%- set remove = remove if remove is not none else [] %}\r\n\r\n  {%- set include_cols = [] %}\r\n\r\n  {%- set table_columns = {} %}\r\n\r\n  {%- do table_columns.update({relation: []}) %}\r\n\r\n  {%- do dbt_utils._is_relation(relation, 'unpivot') -%}\r\n  {%- do dbt_utils._is_ephemeral(relation, 'unpivot') -%}\r\n  {%- set cols = adapter.get_columns_in_relation(relation) %}\r\n\r\n  {%- for col in cols -%}\r\n    {%- if col.column.lower() not in remove|map('lower') and col.column.lower() not in exclude|map('lower') -%}\r\n      {% do include_cols.append(col) %}\r\n    {%- endif %}\r\n  {%- endfor %}\r\n\r\n\r\n  {%- for col in include_cols -%}\r\n    select\r\n      {%- for exclude_col in exclude %}\r\n        {{ exclude_col }},\r\n      {%- endfor %}\r\n\r\n      cast('{{ col.column }}' as {{ dbt.type_string() }}) as {{ field_name }},\r\n      cast(  {% if col.data_type == 'boolean' %}\r\n           {{ dbt.cast_bool_to_text(col.column) }}\r\n             {% else %}\r\n           {{ col.column }}\r\n             {% endif %}\r\n           as {{ cast_to }}) as {{ value_name }}\r\n\r\n    from {{ relation }}\r\n\r\n    {% if not loop.last -%}\r\n      union all\r\n    {% endif -%}\r\n  {%- endfor -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt.type_string", "macro.dbt.cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8608096, "supported_languages": null}, "macro.dbt_utils.width_bucket": {"unique_id": "macro.dbt_utils.width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\width_bucket.sql", "original_file_path": "macros\\sql\\width_bucket.sql", "name": "width_bucket", "macro_sql": "{% macro width_bucket(expr, min_value, max_value, num_buckets) %}\r\n  {{ return(adapter.dispatch('width_bucket', 'dbt_utils') (expr, min_value, max_value, num_buckets)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__width_bucket"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.863809, "supported_languages": null}, "macro.dbt_utils.default__width_bucket": {"unique_id": "macro.dbt_utils.default__width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\width_bucket.sql", "original_file_path": "macros\\sql\\width_bucket.sql", "name": "default__width_bucket", "macro_sql": "{% macro default__width_bucket(expr, min_value, max_value, num_buckets) -%}\r\n\r\n    {% set bin_size -%}\r\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\r\n    {%- endset %}\r\n    (\r\n        -- to break ties when the amount is eaxtly at the bucket egde\r\n        case\r\n            when\r\n                mod(\r\n                    {{ dbt.safe_cast(expr, dbt.type_numeric() ) }},\r\n                    {{ dbt.safe_cast(bin_size, dbt.type_numeric() ) }}\r\n                ) = 0\r\n            then 1\r\n            else 0\r\n        end\r\n    ) +\r\n      -- Anything over max_value goes the N+1 bucket\r\n    least(\r\n        ceil(\r\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\r\n        ),\r\n        {{ num_buckets }} + 1\r\n    )\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.safe_cast", "macro.dbt.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.863809, "supported_languages": null}, "macro.dbt_utils.redshift__width_bucket": {"unique_id": "macro.dbt_utils.redshift__width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\width_bucket.sql", "original_file_path": "macros\\sql\\width_bucket.sql", "name": "redshift__width_bucket", "macro_sql": "{% macro redshift__width_bucket(expr, min_value, max_value, num_buckets) -%}\r\n\r\n    {% set bin_size -%}\r\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\r\n    {%- endset %}\r\n    (\r\n        -- to break ties when the amount is exactly at the bucket edge\r\n        case\r\n            when\r\n                {{ dbt.safe_cast(expr, dbt.type_numeric() ) }} %\r\n                {{ dbt.safe_cast(bin_size, dbt.type_numeric() ) }}\r\n                 = 0\r\n            then 1\r\n            else 0\r\n        end\r\n    ) +\r\n      -- Anything over max_value goes the N+1 bucket\r\n    least(\r\n        ceil(\r\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\r\n        ),\r\n        {{ num_buckets }} + 1\r\n    )\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.safe_cast", "macro.dbt.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8648093, "supported_languages": null}, "macro.dbt_utils.snowflake__width_bucket": {"unique_id": "macro.dbt_utils.snowflake__width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\sql\\width_bucket.sql", "original_file_path": "macros\\sql\\width_bucket.sql", "name": "snowflake__width_bucket", "macro_sql": "{% macro snowflake__width_bucket(expr, min_value, max_value, num_buckets) %}\r\n    width_bucket({{ expr }}, {{ min_value }}, {{ max_value }}, {{ num_buckets }} )\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8658, "supported_languages": null}, "macro.dbt_utils.get_url_host": {"unique_id": "macro.dbt_utils.get_url_host", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\web\\get_url_host.sql", "original_file_path": "macros\\web\\get_url_host.sql", "name": "get_url_host", "macro_sql": "{% macro get_url_host(field) -%}\r\n    {{ return(adapter.dispatch('get_url_host', 'dbt_utils')(field)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_host"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8668005, "supported_languages": null}, "macro.dbt_utils.default__get_url_host": {"unique_id": "macro.dbt_utils.default__get_url_host", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\web\\get_url_host.sql", "original_file_path": "macros\\web\\get_url_host.sql", "name": "default__get_url_host", "macro_sql": "{% macro default__get_url_host(field) -%}\r\n\r\n{%- set parsed =\r\n    dbt.split_part(\r\n        dbt.split_part(\r\n            dbt.replace(\r\n                dbt.replace(\r\n                    dbt.replace(field, \"'android-app://'\", \"''\"\r\n                    ), \"'http://'\", \"''\"\r\n                ), \"'https://'\", \"''\"\r\n            ), \"'/'\", 1\r\n        ), \"'?'\", 1\r\n    )\r\n\r\n-%}\r\n\r\n\r\n    {{ dbt.safe_cast(\r\n        parsed,\r\n        dbt.type_string()\r\n        )}}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.split_part", "macro.dbt.replace", "macro.dbt.safe_cast", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8668005, "supported_languages": null}, "macro.dbt_utils.get_url_parameter": {"unique_id": "macro.dbt_utils.get_url_parameter", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\web\\get_url_parameter.sql", "original_file_path": "macros\\web\\get_url_parameter.sql", "name": "get_url_parameter", "macro_sql": "{% macro get_url_parameter(field, url_parameter) -%}\r\n    {{ return(adapter.dispatch('get_url_parameter', 'dbt_utils')(field, url_parameter)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_parameter"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8678002, "supported_languages": null}, "macro.dbt_utils.default__get_url_parameter": {"unique_id": "macro.dbt_utils.default__get_url_parameter", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\web\\get_url_parameter.sql", "original_file_path": "macros\\web\\get_url_parameter.sql", "name": "default__get_url_parameter", "macro_sql": "{% macro default__get_url_parameter(field, url_parameter) -%}\r\n\r\n{%- set formatted_url_parameter = \"'\" + url_parameter + \"='\" -%}\r\n\r\n{%- set split = dbt.split_part(dbt.split_part(field, formatted_url_parameter, 2), \"'&'\", 1) -%}\r\n\r\nnullif({{ split }},'')\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.split_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8687997, "supported_languages": null}, "macro.dbt_utils.get_url_path": {"unique_id": "macro.dbt_utils.get_url_path", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\web\\get_url_path.sql", "original_file_path": "macros\\web\\get_url_path.sql", "name": "get_url_path", "macro_sql": "{% macro get_url_path(field) -%}\r\n    {{ return(adapter.dispatch('get_url_path', 'dbt_utils')(field)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_path"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8698, "supported_languages": null}, "macro.dbt_utils.default__get_url_path": {"unique_id": "macro.dbt_utils.default__get_url_path", "package_name": "dbt_utils", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\dbt_packages\\dbt-utils", "path": "macros\\web\\get_url_path.sql", "original_file_path": "macros\\web\\get_url_path.sql", "name": "default__get_url_path", "macro_sql": "{% macro default__get_url_path(field) -%}\r\n\r\n    {%- set stripped_url =\r\n        dbt.replace(\r\n            dbt.replace(field, \"'http://'\", \"''\"), \"'https://'\", \"''\")\r\n    -%}\r\n\r\n    {%- set first_slash_pos -%}\r\n        coalesce(\r\n            nullif({{ dbt.position(\"'/'\", stripped_url) }}, 0),\r\n            {{ dbt.position(\"'?'\", stripped_url) }} - 1\r\n            )\r\n    {%- endset -%}\r\n\r\n    {%- set parsed_path =\r\n        dbt.split_part(\r\n            dbt.right(\r\n                stripped_url,\r\n                dbt.length(stripped_url) ~ \"-\" ~ first_slash_pos\r\n                ),\r\n            \"'?'\", 1\r\n            )\r\n    -%}\r\n\r\n    {{ dbt.safe_cast(\r\n        parsed_path,\r\n        dbt.type_string()\r\n    )}}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.replace", "macro.dbt.position", "macro.dbt.split_part", "macro.dbt.right", "macro.dbt.length", "macro.dbt.safe_cast", "macro.dbt.type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1685959749.8707995, "supported_languages": null}}, "docs": {"dbt.__overview__": {"unique_id": "dbt.__overview__", "package_name": "dbt", "root_path": "C:\\Users\\truongdt3\\dga-data-model\\.env\\lib\\site-packages\\dbt\\include\\global_project", "path": "overview.md", "original_file_path": "docs\\overview.md", "name": "__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "selectors": {"daily": {"name": "daily", "definition": {"method": "tag", "value": "daily"}}, "weekly": {"name": "weekly", "definition": {"method": "tag", "value": "weekly"}}, "pkg_daily": {"name": "pkg_daily", "definition": {"method": "tag", "value": "pkg_daily"}}, "monthly": {"name": "monthly", "definition": {"method": "tag", "value": "monthly"}}, "hourly": {"name": "hourly", "definition": {"method": "tag", "value": "hourly"}}, "los": {"name": "los", "definition": {"method": "tag", "value": "los"}, "description": "schedule: '0 17 * * *' start_time: '2023, 3, 15' retry_delay: 'minutes=60' auto_gen_external_sensor: 'True' auto_gen_source_sensor: 'True' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '6' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True'"}, "ews_rb_monthly": {"name": "ews_rb_monthly", "definition": {"method": "tag", "value": "ews_rb_monthly"}}, "way4_daily": {"name": "way4_daily", "definition": {"method": "tag", "value": "way4_daily"}}, "gl_txn_daily": {"name": "gl_txn_daily", "definition": {"method": "tag", "value": "gl_txn_daily"}}, "gl_txn_daily_update": {"name": "gl_txn_daily_update", "definition": {"method": "tag", "value": "gl_txn_daily_update"}}, "cic_daily": {"name": "cic_daily", "definition": {"method": "tag", "value": "cic_daily"}, "description": "schedule: '0 4 * * *' start_time: '2023, 5, 9' retry_delay: 'minutes=30' auto_gen_external_sensor: 'False' auto_gen_source_sensor: 'False' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '25' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'False'"}, "venus_daily": {"name": "venus_daily", "definition": {"method": "tag", "value": "venus_daily"}}, "test_los": {"name": "test_los", "definition": {"method": "tag", "value": "test_los"}, "description": "schedule: '21 0 * * *' start_time: '2023, 3, 15' retry_delay: 'minutes=60' auto_gen_external_sensor: 'True' auto_gen_source_sensor: 'True' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '3' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True'"}, "los_tf": {"name": "los_tf", "definition": {"method": "tag", "value": "los_tf"}, "description": "schedule: '0 5 * * *' start_time: '2023, 3, 15' retry_delay: 'minutes=30' auto_gen_external_sensor: 'False' auto_gen_source_sensor: 'False' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '20' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True'"}, "bal_eb_daily": {"name": "bal_eb_daily", "definition": {"method": "tag", "value": "bal_eb_daily"}}, "clos": {"name": "clos", "definition": {"method": "tag", "value": "clos"}, "description": "schedule: '0 22 * * *' start_time: '2023, 5, 10' retry_delay: 'minutes=60' retries: '3' execution_timeout: 'hours=1'       auto_gen_external_sensor: 'True' auto_gen_source_sensor: 'True' auto_gen_dbt_source_check: 'True'       auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True'"}, "mercury_daily": {"name": "mercury_daily", "definition": {"method": "tag", "value": "mercury_daily"}, "description": "schedule: '0 0 * * *' start_time: '2023, 5, 9' retry_delay: 'minutes=30' auto_gen_external_sensor: 'False' auto_gen_source_sensor: 'False' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '3' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True'"}, "cms_df": {"name": "cms_df", "definition": {"method": "tag", "value": "cms_df"}, "description": "schedule: '0 1 * * *' start_time: '2023, 5, 29' retry_delay: 'minutes=60'     auto_gen_external_sensor: 'True'     auto_gen_source_sensor: 'True' retries: '3' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True' auto_gen_and_update_py_file: 'False' auto_gen_and_update_pickle: 'True'"}, "eb_rpt_cust360": {"name": "eb_rpt_cust360", "definition": {"method": "tag", "value": "eb_rpt_cust360"}, "description": "schedule: '0 4 * * *' start_time: '2023, 6, 1' retry_delay: 'minutes=30' auto_gen_external_sensor: 'False' auto_gen_source_sensor: 'False' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '10' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'False'"}, "eb_rpt_cashflow": {"name": "eb_rpt_cashflow", "definition": {"method": "tag", "value": "eb_rpt_cashflow"}, "description": "schedule: '0 4 * * *' start_time: '2023, 6, 1' retry_delay: 'minutes=30' auto_gen_external_sensor: 'False' auto_gen_source_sensor: 'False' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '10' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'False'"}, "pkg_monthly": {"name": "pkg_monthly", "definition": {"method": "tag", "value": "pkg_monthly"}, "description": "schedule: '0 9 * * *' start_time: '2023, 5, 29' retry_delay: 'minutes=60'     auto_gen_external_sensor: 'False'     auto_gen_source_sensor: 'False' retries: '3' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True' auto_gen_and_update_py_file: 'False' auto_gen_and_update_pickle: 'True'"}, "bpm_df": {"name": "bpm_df", "definition": {"method": "tag", "value": "bpm_df"}, "description": "schedule: '0 1 * * *' start_time: '2023, 5, 29'  retry_delay: 'minutes=30' auto_gen_external_sensor: 'True' auto_gen_source_sensor: 'True' auto_gen_and_update_py_file: 'True' auto_gen_and_update_pickle: 'True' retries: '3' execution_timeout: 'hours=3' auto_gen_dbt_source_check: 'True'"}}, "disabled": {"test.dga_data_model.int_way4__card_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int_way4__card_audit"], "unique_id": "test.dga_data_model.int_way4__card_audit", "raw_code": "SELECT\r\n  ETL_DATE,\r\n  CARD_ID,\r\n  ACNT_CONTRACT__ID,\r\n  ACNT_CONTRACT__OID,\r\n  LIAB_CONTRACT,\r\n  CCAT,\r\n  BRANCH,\r\n  CONTRACT_NUMBER,\r\n  CONTRACT_NAME,\r\n  CHANNEL,\r\n  CHANNEL_DESC,\r\n  PRODUCT_CODE_INTERNAL,\r\n  PRODUCT_CODE,\r\n  PRODUCT_NAME,\r\n  PRODUCT_GROUP,\r\n  CUSTOMER_ID_INTERNAL,\r\n  CUSTOMER_NUMBER,\r\n  COALESCE(auth_limit_amount, 0) AS auth_limit_amount ,\r\n  DATE_OPEN,\r\n  DATE_ACTIVATE,\r\n  DATE_EXPIRE,\r\n  LAST_BILLING_DATE,\r\n  NEXT_BILLING_DATE,\r\n  CARD_EXPIRE,\r\n  CONTRACT_STATUS,\r\n  CONTRACT_STATUS_NAME,\r\n  TR_FIRST_NAM,\r\n  TR_LAST_NAM,\r\n  CYCLE_LENGTH,\r\n  INTERVAL_TYPE,\r\n  IS_READY,\r\n  BILLING_CONTRACT,\r\n  TYPE_OF_CARD,\r\n  AMND_DATE,\r\n  RBS_NUMBER,\r\n  BPM_LOAN_ID,\r\n  CARD_SALES_CHANNEL,\r\n  ADD_INFO_01,\r\n  ADD_INFO_02,\r\n  ADD_INFO_03,\r\n  ADD_INFO_04,\r\n  CLOSE_DATE,\r\n  BANK_CODE,\r\n  PRODUCT_MAIN_OR_SUB\r\nFROM\r\n  {{ source('compare_bulanding', 'df_way4_card @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  ETL_DATE ,\r\n  CARD_ID ,\r\n  ACNT_CONTRACT__ID ,\r\n  ACNT_CONTRACT__OID ,\r\n  LIAB_CONTRACT ,\r\n  CCAT ,\r\n  BRANCH ,\r\n  CONTRACT_NUMBER ,\r\n  CONTRACT_NAME ,\r\n  CHANNEL ,\r\n  CHANNEL_DESC ,\r\n  PRODUCT_CODE_INTERNAL ,\r\n  PRODUCT_CODE ,\r\n  PRODUCT_NAME ,\r\n  PRODUCT_GROUP ,\r\n  CUSTOMER_ID_INTERNAL ,\r\n  CUSTOMER_NUMBER ,\r\n  COALESCE(AUTH_LIMIT_AMOUNT, 0) AS auth_limit_amount ,\r\n  DATE_OPEN ,\r\n  DATE_ACTIVATE ,\r\n  DATE_EXPIRE ,\r\n  LAST_BILLING_DATE ,\r\n  NEXT_BILLING_DATE ,\r\n  CAST (CARD_EXPIRE AS NUMBER) AS CARD_EXPIRE,\r\n  CONTRACT_STATUS ,\r\n  CONTRACT_STATUS_NAME ,\r\n  TR_FIRST_NAM ,\r\n  TR_LAST_NAM ,\r\n  CYCLE_LENGTH ,\r\n  INTERVAL_TYPE ,\r\n  IS_READY ,\r\n  BILLING_CONTRACT ,\r\n  TYPE_OF_CARD ,\r\n  AMND_DATE ,\r\n  CAST (RBS_NUMBER AS VARCHAR2(1000)) AS RBS_NUMBER,\r\n  CAST (BPM_LOAN_ID AS VARCHAR2(1000)) AS BPM_LOAN_ID,\r\n  CARD_SALES_CHANNEL ,\r\n  ADD_INFO_01 ,\r\n  ADD_INFO_02 ,\r\n  ADD_INFO_03 ,\r\n  ADD_INFO_04 ,\r\n  CLOSE_DATE ,\r\n  CAST (BANK_CODE AS VARCHAR2(1000)) AS BANK_CODE,\r\n  PRODUCT_MAIN_OR_SUB\r\nFROM\r\n  {{ ref('int_way4__card')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int_way4__card_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int_way4__card_audit.sql", "name": "int_way4__card_audit", "alias": "int_way4__card_audit", "checksum": {"name": "sha256", "checksum": "8179cf8f9805c9d358d9063af241c1a7fcfd4d0a515fcfcee84ae81e38c969fc"}, "tags": [], "refs": [["int_way4__card"]], "sources": [["compare_bulanding", "df_way4_card @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1021478, "config_call_dict": {}}], "test.dga_data_model.int_way4__card_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int_way4__card_sum"], "unique_id": "test.dga_data_model.int_way4__card_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_bulanding', 'df_way4_card @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('int_way4__card')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int_way4__card_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int_way4__card_sum.sql", "name": "int_way4__card_sum", "alias": "int_way4__card_sum", "checksum": {"name": "sha256", "checksum": "df96e3161fd63be261c7352e21de9dd8bb68f707269b77b60f8565497eaec731"}, "tags": [], "refs": [["int_way4__card"]], "sources": [["compare_bulanding", "df_way4_card @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1061478, "config_call_dict": {}}], "test.dga_data_model.int_way4__client_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int_way4__client_audit"], "unique_id": "test.dga_data_model.int_way4__client_audit", "raw_code": "SELECT\r\n  ETL_DATE,\r\n  AMND_DATE,\r\n  ID,\r\n  CUSTOMER_NUMBER,\r\n  BRANCH_CODE,\r\n  CCAT,\r\n  CUSTOMER_SHORTNAME,\r\n  BIRTH_DATE,\r\n  CUSTOMER_REGISTER_NUMBER_ORIGINAL,\r\n  CUSTOMER_REGISTER_NUMBER,\r\n  CUSTOMER_CODE_ORIGINAL,\r\n  CUSTOMER_CODE,\r\n  COUNTRY,\r\n  CITY,\r\n  ADDRESS_LINE_1,\r\n  ADDRESS_LINE_2,\r\n  PHONE_MOBILE,\r\n  E_MAIL,\r\n  DATE_OPEN,\r\n  CASA_ACCOUNT_NUMBER\r\nFROM\r\n  {{ source('compare_bulanding', 'df_way4_client @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  ETL_DATE,\r\n  AMND_DATE ,\r\n  ID ,\r\n  CUSTOMER_NUMBER ,\r\n  BRANCH_CODE ,\r\n  CCAT ,\r\n  CUSTOMER_SHORTNAME ,\r\n  BIRTH_DATE ,\r\n  CUSTOMER_REGISTER_NUMBER_ORIGINAL ,\r\n  CUSTOMER_REGISTER_NUMBER ,\r\n  CUSTOMER_CODE_ORIGINAL ,\r\n  CUSTOMER_CODE ,\r\n  COUNTRY ,\r\n  CITY ,\r\n  ADDRESS_LINE_1 ,\r\n  ADDRESS_LINE_2 ,\r\n  PHONE_MOBILE ,\r\n  E_MAIL ,\r\n  DATE_OPEN ,\r\n  CAST (CASA_ACCOUNT_NUMBER AS VARCHAR2(100))AS CASA_ACCOUNT_NUMBER\r\nFROM\r\n  {{ ref('int_way4__client')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int_way4__client_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int_way4__client_audit.sql", "name": "int_way4__client_audit", "alias": "int_way4__client_audit", "checksum": {"name": "sha256", "checksum": "835fd7ca20383f8e13516de830ceb0d6d87e95688e5f5ef23eb6c3a73a1591eb"}, "tags": [], "refs": [["int_way4__client"]], "sources": [["compare_bulanding", "df_way4_client @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1091475, "config_call_dict": {}}], "test.dga_data_model.int_way4__client_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int_way4__client_sum"], "unique_id": "test.dga_data_model.int_way4__client_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_bulanding', 'df_way4_client @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('int_way4__client')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int_way4__client_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int_way4__client_sum.sql", "name": "int_way4__client_sum", "alias": "int_way4__client_sum", "checksum": {"name": "sha256", "checksum": "9a3bf95cd713cd8ff548181dd37081baeb7ec647ef21a0a302cf50ddc90355d0"}, "tags": [], "refs": [["int_way4__client"]], "sources": [["compare_bulanding", "df_way4_client @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.113148, "config_call_dict": {}}], "test.dga_data_model.int_way4__contract_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int_way4__contract_audit"], "unique_id": "test.dga_data_model.int_way4__contract_audit", "raw_code": "SELECT\r\n  ETL_DATE,\r\n  CONTRACT_ID,\r\n  ACNT_CONTRACT__ID,\r\n  ACNT_CONTRACT__OID,\r\n  LIAB_CONTRACT,\r\n  CCAT,\r\n  BRANCH,\r\n  CONTRACT_NUMBER,\r\n  CONTRACT_NAME,\r\n  CHANNEL,\r\n  CHANNEL_DESC,\r\n  PRODUCT_CODE_INTERNAL,\r\n  PRODUCT_CODE,\r\n  PRODUCT_NAME,\r\n  PRODUCT_GROUP,\r\n  CUSTOMER_ID_INTERNAL,\r\n  CUSTOMER_NUMBER,\r\n  AUTH_LIMIT_AMOUNT,\r\n  DATE_OPEN,\r\n  DATE_EXPIRE,\r\n  LAST_BILLING_DATE,\r\n  NEXT_BILLING_DATE,\r\n  CONTRACT_STATUS,\r\n  CONTRACT_STATUS_NAME,\r\n  TR_FIRST_NAM,\r\n  TR_LAST_NAM,\r\n  CYCLE_LENGTH,\r\n  INTERVAL_TYPE,\r\n  IS_READY,\r\n  BILLING_CONTRACT,\r\n  AMND_DATE,\r\n  RBS_NUMBER,\r\n  BPM_LOAN_ID,\r\n  CARD_SALES_CHANNEL,\r\n  ADD_INFO_01,\r\n  ADD_INFO_02,\r\n  ADD_INFO_03,\r\n  ADD_INFO_04,\r\n--   LOS_ID,\r\n  TYPE_OF_CARD\r\n--   HASH_DIFF\r\nFROM\r\n  {{ source('compare_bulanding', 'df_way4_contract @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  ETL_DATE ,\r\n  CONTRACT_ID ,\r\n  ACNT_CONTRACT__ID ,\r\n  ACNT_CONTRACT__OID ,\r\n  LIAB_CONTRACT ,\r\n  CCAT ,\r\n  BRANCH ,\r\n  CONTRACT_NUMBER ,\r\n  CONTRACT_NAME ,\r\n  CHANNEL ,\r\n  CHANNEL_DESC ,\r\n  PRODUCT_CODE_INTERNAL ,\r\n  PRODUCT_CODE ,\r\n  PRODUCT_NAME ,\r\n  PRODUCT_GROUP ,\r\n  CUSTOMER_ID_INTERNAL ,\r\n  CUSTOMER_NUMBER ,\r\n  AUTH_LIMIT_AMOUNT ,\r\n  DATE_OPEN ,\r\n  DATE_EXPIRE ,\r\n  LAST_BILLING_DATE ,\r\n  NEXT_BILLING_DATE ,\r\n  CONTRACT_STATUS ,\r\n  CONTRACT_STATUS_NAME ,\r\n  TR_FIRST_NAM ,\r\n  TR_LAST_NAM ,\r\n  CYCLE_LENGTH ,\r\n  INTERVAL_TYPE ,\r\n  IS_READY ,\r\n  BILLING_CONTRACT ,\r\n  AMND_DATE ,\r\n  CAST (RBS_NUMBER AS VARCHAR2(1000)) AS RBS_NUMBER,\r\n  CAST (BPM_LOAN_ID AS VARCHAR2(1000)) AS BPM_LOAN_ID,\r\n  CARD_SALES_CHANNEL ,\r\n  ADD_INFO_01 ,\r\n  ADD_INFO_02 ,\r\n  ADD_INFO_03 ,\r\n  ADD_INFO_04 ,\r\n--   CAST (LOS_ID AS VARCHAR2(1000)) AS LOS_ID,\r\n  TYPE_OF_CARD\r\nFROM\r\n  {{ ref('int_way4__contract')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int_way4__contract_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int_way4__contract_audit.sql", "name": "int_way4__contract_audit", "alias": "int_way4__contract_audit", "checksum": {"name": "sha256", "checksum": "7f8ac235db9c46478a55e26ab24d240007e3a16128af6795f15f2b826bdda3a4"}, "tags": [], "refs": [["int_way4__contract"]], "sources": [["compare_bulanding", "df_way4_contract @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1161485, "config_call_dict": {}}], "test.dga_data_model.int_way4__contract_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int_way4__contract_sum"], "unique_id": "test.dga_data_model.int_way4__contract_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_bulanding', 'df_way4_contract @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('int_way4__contract')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int_way4__contract_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int_way4__contract_sum.sql", "name": "int_way4__contract_sum", "alias": "int_way4__contract_sum", "checksum": {"name": "sha256", "checksum": "a04559d927ab9f7e38ca3904ea550bb752dbf9938f805d8f132c38c14567b1b4"}, "tags": [], "refs": [["int_way4__contract"]], "sources": [["compare_bulanding", "df_way4_contract @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1201477, "config_call_dict": {}}], "test.dga_data_model.int__arrangement_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__arrangement_audit"], "unique_id": "test.dga_data_model.int__arrangement_audit", "raw_code": "SELECT\r\n  ETL_DATE,\r\n  MODULE,\r\n  CUSTOMER_NUMBER,\r\n  ACCOUNT_NUMBER,\r\n  PRODUCT_CODE,\r\n  OPEN_DATE,\r\n  ACTIVATE_DATE,\r\n  maturity_date,\r\n  hash_diff\r\nFROM\r\n  {{ source('compare_bulanding', 'df_arrangement @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  CAST(ETL_DATE AS NUMBER(7,0)),\r\n  CAST(MODULE AS VARCHAR2(20 BYTE)),\r\n  CAST(CUSTOMER_NUMBER AS NUMBER),\r\n  CAST(ACCOUNT_NUMBER AS VARCHAR2(200 BYTE)),\r\n  CAST(PRODUCT_CODE AS VARCHAR2(50 BYTE)),\r\n  CAST(OPEN_DATE AS NUMBER),\r\n  CAST(ACTIVATE_DATE AS NUMBER),\r\n  maturity_date,\r\n  hash_diff\r\nFROM\r\n  {{ ref('int__arrangement')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__arrangement_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__arrangement_audit.sql", "name": "int__arrangement_audit", "alias": "int__arrangement_audit", "checksum": {"name": "sha256", "checksum": "c26f7fc31615c787f1b621579dfac44f593540421ef8f750412f5ed655105f92"}, "tags": [], "refs": [["int__arrangement"]], "sources": [["compare_bulanding", "df_arrangement @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1231477, "config_call_dict": {}}], "test.dga_data_model.int__arrangement_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__arrangement_sum"], "unique_id": "test.dga_data_model.int__arrangement_sum", "raw_code": "SELECT\r\n  COUNT(1)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_arrangement @DGA_READ_BULANDING_DBL') }}\r\n  MINUS\r\nSELECT\r\n  COUNT(1)\r\nFROM {{ ref('int__arrangement')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__arrangement_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__arrangement_sum.sql", "name": "int__arrangement_sum", "alias": "int__arrangement_sum", "checksum": {"name": "sha256", "checksum": "9420fafbbd79798bc742ef60838dd1625a3995d3e9fe81521ab2e2ef3ee8078e"}, "tags": [], "refs": [["int__arrangement"]], "sources": [["compare_bulanding", "df_arrangement @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1271477, "config_call_dict": {}}], "test.dga_data_model.int__casa_account_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__casa_account_audit"], "unique_id": "test.dga_data_model.int__casa_account_audit", "raw_code": "SELECT\r\n  ETL_DATE\r\n, CUSTOMER_NUMBER\r\n, ACCOUNT_NUMBER\r\n, CURRENCY_TYPE\r\n, PRODUCT_CODE\r\n, ACCOUNT_NAME\r\n, OPEN_DATE\r\n, OPEN_TIME\r\n, STATUS\r\n, STATUS_DATE\r\n, WORKSTATION_ID\r\n, USER_ID\r\n, BRANCH_CODE\r\n, SUBBRANCH_NO\r\n, OD_RATE_CURRENT\r\n, OD_REATE_NUMBER_CURRENT\r\n, OD_AGREEMENT_DATE_ORIGINAL\r\n, OD_EXPIRATION_DATE_ORIGINAL\r\n, OD_AGREEMENT_DATE_CURRENT\r\n, OD_EXPIRATION_DATE_CURRENT\r\n, OD_AUTHORIZED_LIMIT_CURRENT\r\n, OD_DRAW_LIMIT_CURRENT\r\n, IS_OVERDRAFT_CURRENT\r\n, CAST(SOURCE_ACCOUNT AS NUMBER) AS SOURCE_ACCOUNT\r\nFROM\r\n  {{ source('compare_bulanding', 'df_casa_account @DGA_READ_BULANDING_DBL') }}\r\n--   WHERE account_number NOT IN (3001017988805, 3001017988814, 4301010610466, 4301010610475, 4301015939153\r\n--     , 4301015939162 )\r\nMINUS\r\nSELECT\r\n  ETL_DATE\r\n, CUSTOMER_NUMBER\r\n, ACCOUNT_NUMBER\r\n, CURRENCY_TYPE\r\n, PRODUCT_CODE\r\n, ACCOUNT_NAME\r\n, OPEN_DATE\r\n, OPEN_TIME\r\n, STATUS\r\n, STATUS_DATE\r\n, WORKSTATION_ID\r\n, USER_ID\r\n, BRANCH_CODE\r\n, SUBBRANCH_NO\r\n, OD_RATE_CURRENT\r\n, OD_REATE_NUMBER_CURRENT\r\n, OD_AGREEMENT_DATE_ORIGINAL\r\n, OD_EXPIRATION_DATE_ORIGINAL\r\n, OD_AGREEMENT_DATE_CURRENT\r\n, OD_EXPIRATION_DATE_CURRENT\r\n, OD_AUTHORIZED_LIMIT_CURRENT\r\n, OD_DRAW_LIMIT_CURRENT\r\n, IS_OVERDRAFT_CURRENT\r\n, SOURCE_ACCOUNT\r\nFROM\r\n  {{ ref('int__casa_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__casa_account_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__casa_account_audit.sql", "name": "int__casa_account_audit", "alias": "int__casa_account_audit", "checksum": {"name": "sha256", "checksum": "e3338c3ac38e5f01f379092400a5363da57e2b6de7a1731607146d4072a5d9cf"}, "tags": [], "refs": [["int__casa_account"]], "sources": [["compare_bulanding", "df_casa_account @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.130148, "config_call_dict": {}}], "test.dga_data_model.int__casa_account_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__casa_account_sum"], "unique_id": "test.dga_data_model.int__casa_account_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_bulanding', 'df_casa_account @DGA_READ_BULANDING_DBL') }}\r\n  MINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM {{ ref('int__casa_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__casa_account_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__casa_account_sum.sql", "name": "int__casa_account_sum", "alias": "int__casa_account_sum", "checksum": {"name": "sha256", "checksum": "58624514cba11475212fe69ac819161acc7950e99db641a10cfe8d97e23a0ec9"}, "tags": [], "refs": [["int__casa_account"]], "sources": [["compare_bulanding", "df_casa_account @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.134148, "config_call_dict": {}}], "test.dga_data_model.int__customer_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__customer_audit"], "unique_id": "test.dga_data_model.int__customer_audit", "raw_code": "select\r\n        ETL_DATE\r\n      , BANK_NUMBER\r\n      , BRANCH_NUMBER\r\n      , CUSTOMER_NUMBER\r\n      , CUSTOMER_SHORTNAME\r\n      , FORMATTED_SHORT_NAME\r\n      , CUSTOMER_FULLNAME_LOCALE\r\n      , CUSTOMER_FULLNAME_ENGLISH\r\n      , RELATIONSHIP_MANAGER\r\n      , RESIDENT_CODE\r\n      , COUNTRY_OF_CITIZENSHIP\r\n      , ORIGINAL_DATE_OF_BIRTH\r\n      , DATE_OF_BIRTH\r\n      , ORIGINAL_CONTACT_DATE\r\n      , CONTACT_DATE\r\n      , CUSTOMER_REGISTER_NUMBER\r\n      , ID_TYPE_CODE\r\n      , ORIGINAL_ID_ISSUE_DATE\r\n      , ID_ISSUE_DATE\r\n      , PLACE_OF_BIRTH\r\n      , MARITAL_STATUS_CODE\r\n      , MARITAL_STATUS_NAME\r\n      , MARITAL_STATUS_DATE\r\n      , GENDER\r\n      , USER_ID\r\n      , WORKSTATION_ID\r\n      , CUSTOMER_STS_CODE\r\n      , CUSTOMER_STS_NAME\r\n      , CUSTOMER_STATUS_DATE\r\n      , TAX_CODE_ID\r\n      , REPORTING_BRANCH\r\n      , DEPARTMENT_CODE\r\n      , INDIVIDUAL\r\n      , INDUSTRY_CODE\r\n      , INDUSTRY_NAME\r\n      , FORMATTED_MOBILE_PHONE_ADDRESS\r\n      , CUSTOMER_ADDRESS_LINE_1\r\n      , CUSTOMER_ADDRESS_LINE_2\r\n      , CUSTOMER_ADDRESS_LINE_3\r\n      , CUSTOMER_ADDRESS_LINE_4\r\n      , PERMANENT_ADDRESS_CITY_NAME\r\n      , PERMANENT_ADDRESS_CITY_CODE\r\n      , PERMANENT_ADDRESS_COUNTRY\r\n      , DIVISION\r\n      , BIZ_LINE\r\n      , CUSTOMER_COMPANY\r\n      , DIVISION_LV2\r\n      , CUSTOMER_REFER\r\n      , SALE_CODE\r\n--       , HASH_DIFF\r\n      , ID_ISSUE_PLACE\r\n      , ID_ISSUE_REMARK\r\n      , OFFICE_PHONE_ADDRESS\r\n      , HOME_PHONE_ADDRESS\r\n      , MOBILE_PHONE_ADDRESS\r\n      , EMAIL_ADDRESS\r\n      , VALID_FORMAT_EMAIL_ADDRESS\r\n      , SEGMENT_LV1_RB\r\n      , SEGMENT_LV2_RB\r\n      , SOURCE_CUSTOMER\r\n      , TAX_CODE_FINAL\r\n    from {{ source('compare_bulanding', 'df_customer @DGA_READ_BULANDING_DBL') }}\r\nminus\r\n    select\r\n        ETL_DATE\r\n      , BANK_NUMBER\r\n      , BRANCH_NUMBER\r\n      , CUSTOMER_NUMBER\r\n      , CUSTOMER_SHORTNAME\r\n      , FORMATTED_SHORT_NAME\r\n      , CUSTOMER_FULLNAME_LOCALE\r\n      , CUSTOMER_FULLNAME_ENGLISH\r\n      , RELATIONSHIP_MANAGER\r\n      , RESIDENT_CODE\r\n      , COUNTRY_OF_CITIZENSHIP\r\n      , ORIGINAL_DATE_OF_BIRTH\r\n      , DATE_OF_BIRTH\r\n      , ORIGINAL_CONTACT_DATE\r\n      , CONTACT_DATE\r\n      , CUSTOMER_REGISTER_NUMBER\r\n      , ID_TYPE_CODE\r\n      , ORIGINAL_ID_ISSUE_DATE\r\n      , ID_ISSUE_DATE\r\n      , PLACE_OF_BIRTH\r\n      , MARITAL_STATUS_CODE\r\n      , MARITAL_STATUS_NAME\r\n      , MARITAL_STATUS_DATE\r\n      , GENDER\r\n      , USER_ID\r\n      , WORKSTATION_ID\r\n      , CUSTOMER_STS_CODE\r\n      , CUSTOMER_STS_NAME\r\n      , CUSTOMER_STATUS_DATE\r\n      , TAX_CODE_ID\r\n      , REPORTING_BRANCH\r\n      , DEPARTMENT_CODE\r\n      , INDIVIDUAL\r\n      , INDUSTRY_CODE\r\n      , INDUSTRY_NAME\r\n      , FORMATTED_MOBILE_PHONE_ADDRESS\r\n      , CUSTOMER_ADDRESS_LINE_1\r\n      , CUSTOMER_ADDRESS_LINE_2\r\n      , CUSTOMER_ADDRESS_LINE_3\r\n      , CUSTOMER_ADDRESS_LINE_4\r\n      , PERMANENT_ADDRESS_CITY_NAME\r\n      , PERMANENT_ADDRESS_CITY_CODE\r\n      , PERMANENT_ADDRESS_COUNTRY\r\n      , DIVISION\r\n      , BIZ_LINE\r\n      , CUSTOMER_COMPANY\r\n      , DIVISION_LV2\r\n      , CUSTOMER_REFER\r\n      , SALE_CODE\r\n--       , HASH_DIFF\r\n      , CAST(ID_ISSUE_PLACE AS nvarchar2(200)) AS ID_ISSUE_PLACE\r\n      , CAST(ID_ISSUE_REMARK AS NVARCHAR2(200)) AS ID_ISSUE_REMARK\r\n      , CAST(OFFICE_PHONE_ADDRESS AS VARCHAR2(200)) AS OFFICE_PHONE_ADDRESS\r\n      , CAST(HOME_PHONE_ADDRESS AS VARCHAR2(200)) AS HOME_PHONE_ADDRESS\r\n      , CAST(MOBILE_PHONE_ADDRESS AS VARCHAR2(200)) AS MOBILE_PHONE_ADDRESS\r\n      , CAST(EMAIL_ADDRESS AS VARCHAR2(200)) AS EMAIL_ADDRESS\r\n      , CAST(VALID_FORMAT_EMAIL_ADDRESS AS VARCHAR2(200)) AS VALID_FORMAT_EMAIL_ADDRESS\r\n      , CAST(SEGMENT_LV1_RB AS VARCHAR2(200)) AS SEGMENT_LV1_RB\r\n      , CAST(SEGMENT_LV2_RB AS VARCHAR2(200)) AS SEGMENT_LV2_RB\r\n      , CAST(SOURCE_CUSTOMER AS VARCHAR2(200)) AS SOURCE_CUSTOMER\r\n      , CAST(TAX_CODE_FINAL AS VARCHAR2(200)) AS TAX_CODE_FINAL\r\n    from {{ ref('int__customer') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__customer_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__customer_audit.sql", "name": "int__customer_audit", "alias": "int__customer_audit", "checksum": {"name": "sha256", "checksum": "f1a3e48fa906409ec57cd8ee716606b6243b7c710207762889a6726afdbf9e28"}, "tags": [], "refs": [["int__customer"]], "sources": [["compare_bulanding", "df_customer @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.137148, "config_call_dict": {}}], "test.dga_data_model.int__customer_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__customer_sum"], "unique_id": "test.dga_data_model.int__customer_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM {{ source('compare_bulanding', 'df_customer @DGA_READ_BULANDING_DBL') }}\r\nminus\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('int__customer') }}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__customer_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__customer_sum.sql", "name": "int__customer_sum", "alias": "int__customer_sum", "checksum": {"name": "sha256", "checksum": "223b96800702c92379aa0a9ca05f53045edb9c2e3837ac83db2a7afd3562fe42"}, "tags": [], "refs": [["int__customer"]], "sources": [["compare_bulanding", "df_customer @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.141148, "config_call_dict": {}}], "test.dga_data_model.int__fd_account_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__fd_account_audit"], "unique_id": "test.dga_data_model.int__fd_account_audit", "raw_code": "SELECT\r\n  ETL_DATE,\r\n  CUSTOMER_NUMBER,\r\n  ACCOUNT_NUMBER,\r\n  CURRENCY_TYPE,\r\n  PRODUCT_CODE,\r\n  OPEN_DATE,\r\n  TERM,\r\n  AUTO_RENEW,\r\n  BRANCH_CODE,\r\n  SUBBRANCH_NO,\r\n  ORG_AMOUNT,\r\n  LCY_ORG_AMOUNT,\r\n  maturity_date2\r\nFROM\r\n  {{ source('compare_bulanding', 'df_fd_account @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  CAST(ETL_DATE AS NUMBER),\r\n  CAST(CUSTOMER_NUMBER AS NUMBER),\r\n  CAST(ACCOUNT_NUMBER AS NUMBER),\r\n  CAST(CURRENCY_TYPE AS VARCHAR2(4 BYTE)),\r\n  CAST(PRODUCT_CODE AS VARCHAR2(20 BYTE)),\r\n  CAST(OPEN_DATE AS NUMBER(8)),\r\n  CAST(TERM AS VARCHAR2(10 BYTE)),\r\n  CAST(AUTO_RENEW AS CHAR(1 BYTE)),\r\n  CAST(BRANCH_CODE AS NUMBER),\r\n  CAST(SUBBRANCH_NO AS NUMBER),\r\n  CAST(ORG_AMOUNT AS NUMBER),\r\n  CAST(LCY_ORG_AMOUNT AS NUMBER)\r\n  , maturity_date2\r\nFROM\r\n  {{ ref('int__fd_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__fd_account_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__fd_account_audit.sql", "name": "int__fd_account_audit", "alias": "int__fd_account_audit", "checksum": {"name": "sha256", "checksum": "2af0dd391c63803358fe3a06e368967f680ecce6d78d6efb0aa034bb986b638d"}, "tags": [], "refs": [["int__fd_account"]], "sources": [["compare_bulanding", "df_fd_account @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1441479, "config_call_dict": {}}], "test.dga_data_model.int__fd_account_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__fd_account_sum"], "unique_id": "test.dga_data_model.int__fd_account_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM {{ source('compare_bulanding', 'df_fd_account @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM {{ ref('int__fd_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__fd_account_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__fd_account_sum.sql", "name": "int__fd_account_sum", "alias": "int__fd_account_sum", "checksum": {"name": "sha256", "checksum": "29fad961154241b1667019793a6671eeff67d66555bb93860a128d7360392db4"}, "tags": [], "refs": [["int__fd_account"]], "sources": [["compare_bulanding", "df_fd_account @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1481483, "config_call_dict": {}}], "test.dga_data_model.int__ln_account_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__ln_account_audit"], "unique_id": "test.dga_data_model.int__ln_account_audit", "raw_code": "SELECT\r\n  ETL_DATE,\r\n  CUSTOMER_NUMBER,\r\n  ACCOUNT_NUMBER,\r\n  BRANCH_CODE,\r\n  SUBBRANCH_NO,\r\n  STATUS,\r\n  PRODUCT_CODE,\r\n  SHORT_DESCRIPTION,\r\n  CURRENCY_TYPE,\r\n  PRINCIPAL_ORIGINAL_AMOUNT,\r\n  LCY_PRINCIPAL_ORIGINAL_AMOUNT,\r\n  ORIGINAL_LOAN_DATE,\r\n  ORIGINAL_MATURITY_DATE,\r\n  FINAL_MATURITY_DATE,\r\n  PAYOFF_DATE,\r\n  STATUS_DATE,\r\n  INTEREST_RATE,\r\n  INTEREST_TERM,\r\n  INTEREST_TERM_CODE,\r\n  LETTER_OF_OFFER_DATE,\r\n  PRINCIPAL_TERM,\r\n  PRINCIPAL_TERM_CODE,\r\n  PAYMENT_FREQUENCY,\r\n  REVOLVING,\r\n  ROLLOVER_METHOD,\r\n  PURPOSE_CODE,\r\n  PURPOSE_NAME,\r\n  PAST_DUE_HISTORY_FLAG,\r\n  AF_APPLICATION_NO,\r\n  AF_APPLICATION_CIF,\r\n  AF_BRANCH_CODE,\r\n  AF_CURRENCY,\r\n  AF_ACF_NO,\r\n  AF_FACILITY_CODE,\r\n  AF_FACILITY_LEVEL,\r\n  AF_FACILITY_SEQ,\r\n  AF_FACILITY_MOTHER_CODE,\r\n  AF_FACILITY_MOTHER_SEQ,\r\n  AF_APPLY_LIMIT,\r\n  AF_FACILITY_LIMIT,\r\n  AF_APPROVED_LIMIT,\r\n  AF_FACILITY_RATE,\r\n  AF_FACILITY_REVOLVING,\r\n  AF_FACILITY_TERM,\r\n  AF_FACILITY_TERM_CODE,\r\n  AF_PURPOSE_CODE,\r\n  AF_DECISION_CENTER,\r\n  AF_SECURE_UNSECURED_PARTIAL,\r\n  AF_ACF_STATUS,\r\n  AF_DATE_APPROVED,\r\n  AF_DATE_OF_OFFER,\r\n  AF_DATE_OFFER_ACCEPTED,\r\n  OFFICER,\r\n  DEALER_ID\r\nFROM\r\n  {{ source('compare_bulanding', 'df_ln_account @DGA_READ_BULANDING_DBL') }}\r\nminus\r\nSELECT\r\n  ETL_DATE,\r\n  CUSTOMER_NUMBER,\r\n  ACCOUNT_NUMBER,\r\n  BRANCH_CODE,\r\n  SUBBRANCH_NO,\r\n  STATUS,\r\n  PRODUCT_CODE,\r\n  SHORT_DESCRIPTION,\r\n  CURRENCY_TYPE,\r\n  PRINCIPAL_ORIGINAL_AMOUNT,\r\n  LCY_PRINCIPAL_ORIGINAL_AMOUNT,\r\n  ORIGINAL_LOAN_DATE,\r\n  ORIGINAL_MATURITY_DATE,\r\n  FINAL_MATURITY_DATE,\r\n  PAYOFF_DATE,\r\n  STATUS_DATE,\r\n  INTEREST_RATE,\r\n  INTEREST_TERM,\r\n  INTEREST_TERM_CODE,\r\n  LETTER_OF_OFFER_DATE,\r\n  PRINCIPAL_TERM,\r\n  PRINCIPAL_TERM_CODE,\r\n  PAYMENT_FREQUENCY,\r\n  REVOLVING,\r\n  ROLLOVER_METHOD,\r\n  PURPOSE_CODE,\r\n  PURPOSE_NAME,\r\n  PAST_DUE_HISTORY_FLAG,\r\n  AF_APPLICATION_NO,\r\n  AF_APPLICATION_CIF,\r\n  AF_BRANCH_CODE,\r\n  AF_CURRENCY,\r\n  AF_ACF_NO,\r\n  AF_FACILITY_CODE,\r\n  AF_FACILITY_LEVEL,\r\n  AF_FACILITY_SEQ,\r\n  AF_FACILITY_MOTHER_CODE,\r\n  AF_FACILITY_MOTHER_SEQ,\r\n  AF_APPLY_LIMIT,\r\n  AF_FACILITY_LIMIT,\r\n  AF_APPROVED_LIMIT,\r\n  AF_FACILITY_RATE,\r\n  AF_FACILITY_REVOLVING,\r\n  AF_FACILITY_TERM,\r\n  AF_FACILITY_TERM_CODE,\r\n  AF_PURPOSE_CODE,\r\n  AF_DECISION_CENTER,\r\n  AF_SECURE_UNSECURED_PARTIAL,\r\n  AF_ACF_STATUS,\r\n  AF_DATE_APPROVED,\r\n  AF_DATE_OF_OFFER,\r\n  AF_DATE_OFFER_ACCEPTED,\r\n  OFFICER,\r\n  DEALER_ID\r\nFROM\r\n  {{ ref('int__ln_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__ln_account_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__ln_account_audit.sql", "name": "int__ln_account_audit", "alias": "int__ln_account_audit", "checksum": {"name": "sha256", "checksum": "e9923de3e2c95364705e5fb4834b099b2a6b6c275f1209aa14aa6d505654faf7"}, "tags": [], "refs": [["int__ln_account"]], "sources": [["compare_bulanding", "df_ln_account @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.151148, "config_call_dict": {}}], "test.dga_data_model.int__ln_account_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "int__ln_account_sum"], "unique_id": "test.dga_data_model.int__ln_account_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_bulanding', 'df_ln_account @DGA_READ_BULANDING_DBL') }}\r\nminus\r\nSELECT\r\n  count(*)\r\nFROM {{ ref('int__ln_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\int__ln_account_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\int__ln_account_sum.sql", "name": "int__ln_account_sum", "alias": "int__ln_account_sum", "checksum": {"name": "sha256", "checksum": "85afbe55db424987b452c7920edc64caee00217e1ead41ca10b070506a8f6606"}, "tags": [], "refs": [["int__ln_account"]], "sources": [["compare_bulanding", "df_ln_account @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1551478, "config_call_dict": {}}], "test.dga_data_model.mart__dim_arrangement_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__dim_arrangement_audit"], "unique_id": "test.dga_data_model.mart__dim_arrangement_audit", "raw_code": "SELECT\r\n  \"IS_CUR_REC\",\r\n  \"EFF_FM_DT\",\r\n  \"EFF_TO_DT\",\r\n  \"MODULE\",\r\n  \"CUSTOMER_NUMBER\",\r\n  \"ACCOUNT_NUMBER\",\r\n  \"PRODUCT_CODE\",\r\n  \"OPEN_DATE\",\r\n  \"ACTIVATE_DATE\",\r\n  \"HASH_DIFF\",\r\n  \"UNQ_ID\",\r\n  \"MATURITY_DATE\"\r\nFROM\r\n  {{ source('compare_bulanding', 'df_arrangement_dim @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  \"IS_CUR_REC\",\r\n  \"EFF_FM_DT\",\r\n  \"EFF_TO_DT\",\r\n  \"MODULE\",\r\n  \"CUSTOMER_NUMBER\",\r\n  \"ACCOUNT_NUMBER\",\r\n  \"PRODUCT_CODE\",\r\n  \"OPEN_DATE\",\r\n  \"ACTIVATE_DATE\",\r\n  \"HASH_DIFF\",\r\n  \"UNQ_ID\",\r\n  \"MATURITY_DATE\"\r\nFROM\r\n  {{ ref ('dim__arrangement')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__dim_arrangement_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__dim_arrangement_audit.sql", "name": "mart__dim_arrangement_audit", "alias": "mart__dim_arrangement_audit", "checksum": {"name": "sha256", "checksum": "3b0f04424f83a904bd569d10c2171741e6647fe2648101fe2410292c5a974131"}, "tags": [], "refs": [["dim__arrangement"]], "sources": [["compare_bulanding", "df_arrangement_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.158148, "config_call_dict": {}}], "test.dga_data_model.mart__dim_arrangement_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__dim_arrangement_sum"], "unique_id": "test.dga_data_model.mart__dim_arrangement_sum", "raw_code": "SELECT\r\n  COUNT(*)\r\nFROM {{ source('compare_bulanding', 'df_arrangement_dim @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  count(*)\r\nFROM\r\n  {{ ref ('dim__arrangement')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__dim_arrangement_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__dim_arrangement_sum.sql", "name": "mart__dim_arrangement_sum", "alias": "mart__dim_arrangement_sum", "checksum": {"name": "sha256", "checksum": "aa458332c37390023adbf2d4563d9980dde9e7a9195ecb9faf8ed1291b0a970a"}, "tags": [], "refs": [["dim__arrangement"]], "sources": [["compare_bulanding", "df_arrangement_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1621478, "config_call_dict": {}}], "test.dga_data_model.mart__dim_casa_account_audit": [{"resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.star"], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__dim_casa_account_audit"], "unique_id": "test.dga_data_model.mart__dim_casa_account_audit", "raw_code": "SELECT\r\n  is_cur_rec\r\n, eff_fm_dt\r\n, eff_to_dt\r\n, customer_number\r\n, account_number\r\n, currency_type\r\n, product_code\r\n, account_name\r\n, open_date\r\n, open_time\r\n, status\r\n, status_date\r\n, workstation_id\r\n, user_id\r\n, branch_code\r\n, subbranch_no\r\n, od_rate_current\r\n, od_reate_number_current\r\n, od_agreement_date_original\r\n, od_expiration_date_original\r\n, od_agreement_date_current\r\n, od_expiration_date_current\r\n, od_authorized_limit_current\r\n, od_draw_limit_current\r\n, is_overdraft_current\r\n, source_account\r\nFROM\r\n  {{ source('compare_bulanding', 'df_casa_account_dim @DGA_READ_BULANDING_DBL') }}\r\n\r\nMINUS\r\nSELECT\r\n  {{ dbt_utils.star(from=ref('dim__casa_account'), except=[\"hash_diff\",\"merge_key\"]) }}\r\nFROM\r\n  {{ ref('dim__casa_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__dim_casa_account_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__dim_casa_account_audit.sql", "name": "mart__dim_casa_account_audit", "alias": "mart__dim_casa_account_audit", "checksum": {"name": "sha256", "checksum": "3661b6f286b06e6632575003d7349c6d8da6e92c6cb9426cf0c7995592ea3d89"}, "tags": [], "refs": [["dim__casa_account"], ["dim__casa_account"]], "sources": [["compare_bulanding", "df_casa_account_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.165148, "config_call_dict": {}}], "test.dga_data_model.mart__dim_casa_account_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__dim_casa_account_sum"], "unique_id": "test.dga_data_model.mart__dim_casa_account_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_casa_account_dim @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  count(*)\r\nFROM\r\n  {{ ref('dim__casa_account')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__dim_casa_account_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__dim_casa_account_sum.sql", "name": "mart__dim_casa_account_sum", "alias": "mart__dim_casa_account_sum", "checksum": {"name": "sha256", "checksum": "605a770d069a4ed532c305a3f793986ad348e7e74cfb0eea7a1fa8a976d5f803"}, "tags": [], "refs": [["dim__casa_account"]], "sources": [["compare_bulanding", "df_casa_account_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1701481, "config_call_dict": {}}], "test.dga_data_model.mart__dim_customer_audit": [{"resource_type": "test", "depends_on": {"macros": ["macro.dbt_utils.star"], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__dim_customer_audit"], "unique_id": "test.dga_data_model.mart__dim_customer_audit", "raw_code": "SELECT\r\n    is_cur_rec\r\n  , eff_fm_dt\r\n  , eff_to_dt\r\n  , bank_number\r\n  , branch_number\r\n  , customer_number\r\n  , customer_shortname\r\n  , formatted_short_name\r\n  , customer_fullname_locale\r\n  , customer_fullname_english\r\n  , relationship_manager\r\n  , resident_code\r\n  , country_of_citizenship\r\n  , original_date_of_birth\r\n  , date_of_birth\r\n  , original_contact_date\r\n  , contact_date\r\n  , customer_register_number\r\n  , id_type_code\r\n  , id_issue_place\r\n  , id_issue_remark\r\n  , original_id_issue_date\r\n  , id_issue_date\r\n  , place_of_birth\r\n  , marital_status_code\r\n  , marital_status_name\r\n  , marital_status_date\r\n  , gender\r\n  , user_id\r\n  , workstation_id\r\n  , customer_sts_code\r\n  , customer_sts_name\r\n  , customer_status_date\r\n  , tax_code_id\r\n  , reporting_branch\r\n  , department_code\r\n  , individual\r\n  , industry_code\r\n  , industry_name\r\n  , office_phone_address\r\n  , home_phone_address\r\n  , mobile_phone_address\r\n  , formatted_mobile_phone_address\r\n  , email_address\r\n  , valid_format_email_address\r\n  , customer_address_line_1\r\n  , customer_address_line_2\r\n  , customer_address_line_3\r\n  , customer_address_line_4\r\n  , permanent_address_city_name\r\n  , permanent_address_city_code\r\n  , permanent_address_country\r\n  , division\r\n  , biz_line\r\n  , segment_lv1_rb\r\n  , segment_lv2_rb\r\n  , source_customer\r\n  , subbranch_no\r\n  , customer_company\r\n  , tax_code_final\r\nFROM\r\n  {{ source('compare_bulanding', 'df_customer_dim @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  {{ dbt_utils.star( from = ref('dim__customer'), except =[\"merge_key\", \"hash_diff\"]) }}\r\nFROM\r\n  {{ ref ('dim__customer')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__dim_customer_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__dim_customer_audit.sql", "name": "mart__dim_customer_audit", "alias": "mart__dim_customer_audit", "checksum": {"name": "sha256", "checksum": "ca18c860a236fcb570dfb7267c16c8d1c6cb469972e876bf5cdcb1ab56c59f65"}, "tags": [], "refs": [["dim__customer"], ["dim__customer"]], "sources": [["compare_bulanding", "df_customer_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.173148, "config_call_dict": {}}], "test.dga_data_model.mart__dim_customer_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__dim_customer_sum"], "unique_id": "test.dga_data_model.mart__dim_customer_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_customer_dim @DGA_READ_BULANDING_DBL') }}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM\r\n  {{ ref ('dim__customer')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__dim_customer_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__dim_customer_sum.sql", "name": "mart__dim_customer_sum", "alias": "mart__dim_customer_sum", "checksum": {"name": "sha256", "checksum": "08c33d6a227c2bfaa4720fad97d5f879d46c582727a8e9a5d4ee129d1c829867"}, "tags": [], "refs": [["dim__customer"]], "sources": [["compare_bulanding", "df_customer_dim @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1771479, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_casa_bal_daily_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_casa_bal_daily_audit"], "unique_id": "test.dga_data_model.mart__fct_agg_casa_bal_daily_audit", "raw_code": "SELECT *\r\nFROM {{ source('compare_bulanding', 'df_casa_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\n  MINUS\r\nSELECT *\r\nFROM {{ ref('fct__agg_casa_bal_daily')}}\r\nWHERE date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_casa_bal_daily_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_casa_bal_daily_audit.sql", "name": "mart__fct_agg_casa_bal_daily_audit", "alias": "mart__fct_agg_casa_bal_daily_audit", "checksum": {"name": "sha256", "checksum": "83ea6e8c4e87374ea2f66aac9aef40ca12fee7ee69a4cde16f60f256f2cfabea"}, "tags": [], "refs": [["fct__agg_casa_bal_daily"]], "sources": [["compare_bulanding", "df_casa_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1811478, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_casa_bal_daily_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_casa_bal_daily_sum"], "unique_id": "test.dga_data_model.mart__fct_agg_casa_bal_daily_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM {{ source('compare_bulanding', 'df_casa_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\n  MINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM {{ ref('fct__agg_casa_bal_daily')}}\r\nWHERE date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_casa_bal_daily_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_casa_bal_daily_sum.sql", "name": "mart__fct_agg_casa_bal_daily_sum", "alias": "mart__fct_agg_casa_bal_daily_sum", "checksum": {"name": "sha256", "checksum": "efa38b9404f42253848f6fd3b09c17ce70154e83c12714c0937b81ba285beda6"}, "tags": [], "refs": [["fct__agg_casa_bal_daily"]], "sources": [["compare_bulanding", "df_casa_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1841483, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_casa_txn_daily_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_casa_txn_daily_audit"], "unique_id": "test.dga_data_model.mart__fct_agg_casa_txn_daily_audit", "raw_code": "SELECT\r\n  *\r\nFROM\r\n  {{ source('compare_bulanding', 'df_casa_txn_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  *\r\nFROM\r\n  {{ ref('fct__agg_casa_txn_daily')}}\r\nWHERE date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_casa_txn_daily_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_casa_txn_daily_audit.sql", "name": "mart__fct_agg_casa_txn_daily_audit", "alias": "mart__fct_agg_casa_txn_daily_audit", "checksum": {"name": "sha256", "checksum": "560300a8c1b6b47345dbcc4143a06ef7c5d7700a473d2579a23f98b4ad0f4e36"}, "tags": [], "refs": [["fct__agg_casa_txn_daily"]], "sources": [["compare_bulanding", "df_casa_txn_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.189148, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_casa_txn_daily_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_casa_txn_daily_sum"], "unique_id": "test.dga_data_model.mart__fct_agg_casa_txn_daily_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_casa_txn_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM\r\n  {{ ref('fct__agg_casa_txn_daily')}}\r\nWHERE date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_casa_txn_daily_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_casa_txn_daily_sum.sql", "name": "mart__fct_agg_casa_txn_daily_sum", "alias": "mart__fct_agg_casa_txn_daily_sum", "checksum": {"name": "sha256", "checksum": "fef7a0500e64232080b82a920866674ad1d428542b8f17189b2a53cac4557e6f"}, "tags": [], "refs": [["fct__agg_casa_txn_daily"]], "sources": [["compare_bulanding", "df_casa_txn_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.192148, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_fd_bal_daily_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_fd_bal_daily_audit"], "unique_id": "test.dga_data_model.mart__fct_agg_fd_bal_daily_audit", "raw_code": "SELECT\r\n  *\r\nFROM\r\n  {{ source('compare_bulanding', 'df_fd_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  *\r\nFROM\r\n  {{ ref('fct__agg_fd_bal_daily')}}\r\nWHERE\r\n  date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_fd_bal_daily_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_fd_bal_daily_audit.sql", "name": "mart__fct_agg_fd_bal_daily_audit", "alias": "mart__fct_agg_fd_bal_daily_audit", "checksum": {"name": "sha256", "checksum": "a65f6f9d75b43e0148b9ee769a64284055a2daa8e18151bff144f6fbdf5cc594"}, "tags": [], "refs": [["fct__agg_fd_bal_daily"]], "sources": [["compare_bulanding", "df_fd_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.196148, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_fd_bal_daily_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_fd_bal_daily_sum"], "unique_id": "test.dga_data_model.mart__fct_agg_fd_bal_daily_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_fd_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM\r\n  {{ ref('fct__agg_fd_bal_daily')}}\r\nWHERE\r\n  date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_fd_bal_daily_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_fd_bal_daily_sum.sql", "name": "mart__fct_agg_fd_bal_daily_sum", "alias": "mart__fct_agg_fd_bal_daily_sum", "checksum": {"name": "sha256", "checksum": "831e762bd0651e1bc9b4bb7e3685c02f44c468d4afed9decf8eee04a3d4a8210"}, "tags": [], "refs": [["fct__agg_fd_bal_daily"]], "sources": [["compare_bulanding", "df_fd_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.1991482, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_ln_bal_daily_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_ln_bal_daily_audit"], "unique_id": "test.dga_data_model.mart__fct_agg_ln_bal_daily_audit", "raw_code": "SELECT\r\n  *\r\nFROM\r\n  {{ source('compare_bulanding', 'df_ln_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  *\r\nFROM\r\n  {{ ref('fct__agg_ln_bal_daily')}}\r\nWHERE\r\n  date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_ln_bal_daily_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_ln_bal_daily_audit.sql", "name": "mart__fct_agg_ln_bal_daily_audit", "alias": "mart__fct_agg_ln_bal_daily_audit", "checksum": {"name": "sha256", "checksum": "c47a1b2236e178cec35f6cc4d2b040163687c81640a067ed8efd171a857eca92"}, "tags": [], "refs": [["fct__agg_ln_bal_daily"]], "sources": [["compare_bulanding", "df_ln_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.203148, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_ln_bal_daily_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_ln_bal_daily_sum"], "unique_id": "test.dga_data_model.mart__fct_agg_ln_bal_daily_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_ln_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM\r\n  {{ ref('fct__agg_ln_bal_daily')}}\r\nWHERE\r\n  date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_ln_bal_daily_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_ln_bal_daily_sum.sql", "name": "mart__fct_agg_ln_bal_daily_sum", "alias": "mart__fct_agg_ln_bal_daily_sum", "checksum": {"name": "sha256", "checksum": "ad0a059cc98bb46b140e3df8e61b06524b815dcf0fcbc7f6e62245ac1648d925"}, "tags": [], "refs": [["fct__agg_ln_bal_daily"]], "sources": [["compare_bulanding", "df_ln_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.2071478, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_od_bal_daily_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_od_bal_daily_audit"], "unique_id": "test.dga_data_model.mart__fct_agg_od_bal_daily_audit", "raw_code": "SELECT\r\n  *\r\nFROM\r\n  {{ source('compare_bulanding', 'df_od_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  *\r\nFROM\r\n  {{ ref('fct__agg_od_bal_daily')}}\r\nWHERE\r\n  date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_od_bal_daily_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_od_bal_daily_audit.sql", "name": "mart__fct_agg_od_bal_daily_audit", "alias": "mart__fct_agg_od_bal_daily_audit", "checksum": {"name": "sha256", "checksum": "95fcbb5d013ea4bca9edc9792c6a79ddb4c328812cffaa9e80ee8332500d6a44"}, "tags": [], "refs": [["fct__agg_od_bal_daily"]], "sources": [["compare_bulanding", "df_od_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.211148, "config_call_dict": {}}], "test.dga_data_model.mart__fct_agg_od_bal_daily_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__fct_agg_od_bal_daily_sum"], "unique_id": "test.dga_data_model.mart__fct_agg_od_bal_daily_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM\r\n  {{ source('compare_bulanding', 'df_od_bal_daily_agg_fct @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  date_id = {{ var('date_id')}}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM\r\n  {{ ref('fct__agg_od_bal_daily')}}\r\nWHERE\r\n  date_id = {{ var('date_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__fct_agg_od_bal_daily_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__fct_agg_od_bal_daily_sum.sql", "name": "mart__fct_agg_od_bal_daily_sum", "alias": "mart__fct_agg_od_bal_daily_sum", "checksum": {"name": "sha256", "checksum": "b19ea1b86708b703aa680157408c4d557ccaa223d0cacce6bfaad4365945a127"}, "tags": [], "refs": [["fct__agg_od_bal_daily"]], "sources": [["compare_bulanding", "df_od_bal_daily_agg_fct @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.214148, "config_call_dict": {}}], "test.dga_data_model.mart__trans_card_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__trans_card_audit"], "unique_id": "test.dga_data_model.mart__trans_card_audit", "raw_code": "SELECT *\r\nFROM {{ source('compare_bulanding', 'df_card_txn_daily @DGA_READ_BULANDING_DBL') }}\r\nwhere posting_date = {{ var('date')}}\r\nMINUS\r\nSELECT\r\n  id\r\n, amnd_date\r\n, posting_date\r\n, transaction_date\r\n, is_authorization\r\n, posting_status\r\n, request_category\r\n, return_code\r\n, merchant_id\r\n, doc__orig__id\r\n, ret_ref_number\r\n, settlement_amount\r\n, settlement_currency\r\n, transaction_amount\r\n, transaction_currency\r\n, txn_amt_lcy\r\n, sic_code\r\n, src_cnl\r\n, trg_cnl\r\n, source_member_id\r\n, source_number\r\n, source_reg_num\r\n, trans_condition\r\n, target_contract\r\n, target_number\r\n, transaction_city\r\n, transaction_country\r\n, transaction_location\r\n, trans_type\r\n, dr_cr\r\n, type_of_card\r\n, source_code\r\n, outward_status\r\n, service_class\r\n, trans_channel\r\nFROM {{ ref('fct__trans_card')}}\r\nwhere posting_date = {{ var('date')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__trans_card_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__trans_card_audit.sql", "name": "mart__trans_card_audit", "alias": "mart__trans_card_audit", "checksum": {"name": "sha256", "checksum": "6a642a0c82f86b431e85a5db616fbfd9846eef1d7754ad04e1121872c572a73b"}, "tags": [], "refs": [["fct__trans_card"]], "sources": [["compare_bulanding", "df_card_txn_daily @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.218148, "config_call_dict": {}}], "test.dga_data_model.mart__trans_card_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__trans_card_sum"], "unique_id": "test.dga_data_model.mart__trans_card_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM {{ source('compare_bulanding', 'df_card_txn_daily @DGA_READ_BULANDING_DBL') }}\r\nwhere posting_date = {{ var('date')}}\r\nMINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM {{ ref('fct__trans_card')}}\r\nwhere posting_date = {{ var('date')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__trans_card_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__trans_card_sum.sql", "name": "mart__trans_card_sum", "alias": "mart__trans_card_sum", "checksum": {"name": "sha256", "checksum": "9f1b16fc09c2a65d1492333e93b9e6440545661c26a7410d1d15f925cce3822f"}, "tags": [], "refs": [["fct__trans_card"]], "sources": [["compare_bulanding", "df_card_txn_daily @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.2221482, "config_call_dict": {}}], "test.dga_data_model.mart__trans_casa_mpayroll_audit": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__trans_casa_mpayroll_audit"], "unique_id": "test.dga_data_model.mart__trans_casa_mpayroll_audit", "raw_code": "SELECT *\r\nFROM {{ source('compare_bulanding', 'df_casa_mpayroll_txn @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  month_id = {{ var('month_id')}}\r\nMINUS\r\nSELECT *\r\nFROM {{ ref('fct__trans_casa_mpayroll')}}\r\nWHERE month_id = {{ var('month_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__trans_casa_mpayroll_audit.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__trans_casa_mpayroll_audit.sql", "name": "mart__trans_casa_mpayroll_audit", "alias": "mart__trans_casa_mpayroll_audit", "checksum": {"name": "sha256", "checksum": "5263a1e1462339a1e9a5f35ddfa3d0f8b8052a05b33e6ab52cece53e69328bf4"}, "tags": [], "refs": [["fct__trans_casa_mpayroll"]], "sources": [["compare_bulanding", "df_casa_mpayroll_txn @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.2251482, "config_call_dict": {}}], "test.dga_data_model.mart__trans_casa_mpayroll_sum": [{"resource_type": "test", "depends_on": {"macros": [], "nodes": []}, "config": {"enabled": false, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "oracle_dgaworkzone", "schema": "dbt_test__audit", "fqn": ["dga_data_model", "daily", "compare_bulanding", "mart__trans_casa_mpayroll_sum"], "unique_id": "test.dga_data_model.mart__trans_casa_mpayroll_sum", "raw_code": "SELECT\r\n  count(*)\r\nFROM {{ source('compare_bulanding', 'df_casa_mpayroll_txn @DGA_READ_BULANDING_DBL') }}\r\nWHERE\r\n  month_id = {{ var('month_id')}}\r\n  MINUS\r\nSELECT\r\n  COUNT(*)\r\nFROM {{ ref('fct__trans_casa_mpayroll')}}\r\nWHERE month_id = {{ var('month_id')}}", "language": "sql", "package_name": "dga_data_model", "root_path": "C:\\Users\\truongdt3\\dga-data-model", "path": "daily\\compare_bulanding\\mart__trans_casa_mpayroll_sum.sql", "original_file_path": "tests\\daily\\compare_bulanding\\mart__trans_casa_mpayroll_sum.sql", "name": "mart__trans_casa_mpayroll_sum", "alias": "mart__trans_casa_mpayroll_sum", "checksum": {"name": "sha256", "checksum": "17a451b7e1d81d63307d4f6eb9f1e2a3a6783b9d29fd3084f58d7c9931a70b62"}, "tags": [], "refs": [["fct__trans_casa_mpayroll"]], "sources": [["compare_bulanding", "df_casa_mpayroll_txn @DGA_READ_BULANDING_DBL"]], "metrics": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"enabled": false}, "created_at": 1685959752.2311478, "config_call_dict": {}}]}, "parent_map": {"model.dga_data_model.dwh__ccl_pln": ["source.dga_data_model.dwh.ccl_pln"], "model.dga_data_model.dwh__demanddeposit_master003": ["source.dga_data_model.dwh.ddft_master"], "model.dga_data_model.dwh__demanddeposit_transaction001": ["source.dga_data_model.dwh.ddft_transaction"], "model.dga_data_model.dwh__fixeddeposit_master003": ["source.dga_data_model.dwh.fdft_master"], "model.dga_data_model.dwh__fixeddeposit_transaction001": ["source.dga_data_model.dwh.fdft_transaction"], "model.dga_data_model.dwh__glft_his_transaction": ["source.dga_data_model.dwh.glft_his_transaction"], "model.dga_data_model.dwh__loan_master003": ["source.dga_data_model.dwh.lnft_master"], "model.dga_data_model.dwh__loan_transaction001": ["source.dga_data_model.dwh.lnft_transaction"], "model.dga_data_model.imp__eb_portfolio_mtd": ["source.dga_data_model.dga.thuvh3_eb_dm_luyke"], "model.dga_data_model.imp__eb_txn_processed": ["source.dga_data_model.dga.anlt4_eb_txn_processed"], "model.dga_data_model.landing__lc_cc_mast": ["source.dga_data_model.dga_ingest.lc_cc_mast"], "model.dga_data_model.vision__mgt_result_balances": ["source.dga_data_model.vision.mgt_result_balances"], "model.dga_data_model.vision__mgt_result_headers": ["source.dga_data_model.vision.mgt_result_headers"], "model.dga_data_model.bpm_vhkq__atm": ["model.dga_data_model.stg_bpm_vhkq__atm"], "model.dga_data_model.bpm_vhkq__atm_category_tray": ["model.dga_data_model.stg_bpm_vhkq__atm_category_tray"], "model.dga_data_model.bpm_vhkq__atm_detail": ["model.dga_data_model.stg_bpm_vhkq__atm_detail"], "model.dga_data_model.bpm_vhkq__attachment": ["model.dga_data_model.stg_bpm_vhkq__attachment"], "model.dga_data_model.bpm_vhkq__category": ["model.dga_data_model.stg_bpm_vhkq__category"], "model.dga_data_model.bpm_vhkq__delivery": ["model.dga_data_model.stg_bpm_vhkq__delivery"], "model.dga_data_model.bpm_vhkq__doc_no": ["model.dga_data_model.stg_bpm_vhkq__doc_no"], "model.dga_data_model.bpm_vhkq__mail_log": ["model.dga_data_model.stg_bpm_vhkq__mail_log"], "model.dga_data_model.bpm_vhkq__position": ["model.dga_data_model.stg_bpm_vhkq__position"], "model.dga_data_model.bpm_vhkq__process_definition": ["model.dga_data_model.stg_bpm_vhkq__process_definition"], "model.dga_data_model.bpm_vhkq__process_instance": ["model.dga_data_model.stg_bpm_vhkq__process_instance"], "model.dga_data_model.bpm_vhkq__process_instance_his": ["model.dga_data_model.stg_bpm_vhkq__process_instance_his"], "model.dga_data_model.bpm_vhkq__request_atm": ["model.dga_data_model.stg_bpm_vhkq__request_atm"], "model.dga_data_model.bpm_vhkq__request_atm_card_detail": ["model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail"], "model.dga_data_model.bpm_vhkq__request_atm_detail": ["model.dga_data_model.stg_bpm_vhkq__request_atm_detail"], "model.dga_data_model.bpm_vhkq__request_atm_tray_control": ["model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control"], "model.dga_data_model.bpm_vhkq__request_atm_tray_detail": ["model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail"], "model.dga_data_model.bpm_vhkq__request_branch": ["model.dga_data_model.stg_bpm_vhkq__request_branch"], "model.dga_data_model.bpm_vhkq__request_branch_detail": ["model.dga_data_model.stg_bpm_vhkq__request_branch_detail"], "model.dga_data_model.bpm_vhkq__skewed_threshold": ["model.dga_data_model.stg_bpm_vhkq__skewed_threshold"], "model.dga_data_model.bpm_vhkq__staff": ["model.dga_data_model.stg_bpm_vhkq__staff"], "model.dga_data_model.bpm_vhkq__staff_assignment": ["model.dga_data_model.stg_bpm_vhkq__staff_assignment"], "model.dga_data_model.bpm_vhkq__staff_request_atm": ["model.dga_data_model.stg_bpm_vhkq__staff_request_atm"], "model.dga_data_model.bpm_vhkq__staff_request_branch": ["model.dga_data_model.stg_bpm_vhkq__staff_request_branch"], "model.dga_data_model.bpm_vhkq__staff_transfer_history": ["model.dga_data_model.stg_bpm_vhkq__staff_transfer_history"], "model.dga_data_model.bpm_vhkq__staff_tsd": ["snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd"], "model.dga_data_model.bpm_vhkq__template": ["model.dga_data_model.stg_bpm_vhkq__template"], "model.dga_data_model.bpm_vhkq__user_unit": ["model.dga_data_model.stg_bpm_vhkq__user_unit"], "model.dga_data_model.bpm_vhkq__volume": ["model.dga_data_model.stg_bpm_vhkq__volume"], "model.dga_data_model.bpm_vhkq__volume_detail": ["model.dga_data_model.stg_bpm_vhkq__volume_detail"], "model.dga_data_model.bpm_vhkq__warehouse": ["model.dga_data_model.stg_bpm_vhkq__warehouse"], "model.dga_data_model.bpm_vhkq__warehouse_organization": ["model.dga_data_model.stg_bpm_vhkq__warehouse_organization"], "model.dga_data_model.bpm_vhkq__warehouse_user": ["model.dga_data_model.stg_bpm_vhkq__warehouse_user"], "model.dga_data_model.landing_hist__ews_rb_cust_info": ["source.dga_data_model.ews_bulanding.ews_rb_cust_info @DGA_READ_BULANDING_DBL"], "model.dga_data_model.landing_hist__ews_rb_thruput_casa": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL"], "model.dga_data_model.landing_hist__ews_rb_thruput_fd": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL"], "model.dga_data_model.landing_hist__ews_rb_thruput_in": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_in @DGA_READ_BULANDING_DBL"], "model.dga_data_model.landing_hist__ews_rb_thruput_out": ["source.dga_data_model.ews_bulanding.ews_rb_thruput_out @DGA_READ_BULANDING_DBL"], "model.dga_data_model.los__addoncarddetails": ["model.dga_data_model.stg_los__addoncarddetails"], "model.dga_data_model.los__address": ["source.dga_data_model.crmuser.address"], "model.dga_data_model.los__addressdetail": ["source.dga_data_model.crmuser.addressdetail"], "model.dga_data_model.los__agents": ["model.dga_data_model.stg_los__agents"], "model.dga_data_model.los__agent_entity_details": ["model.dga_data_model.stg_los__agent_entity_details"], "model.dga_data_model.los__applicant": ["model.dga_data_model.stg_los__applicant"], "model.dga_data_model.los__applicantaddress": ["source.dga_data_model.crmuser.applicantaddress"], "model.dga_data_model.los__applicantcontact": ["model.dga_data_model.stg_los__applicantcontact"], "model.dga_data_model.los__applicantcontactphnemllist": ["model.dga_data_model.stg_los__applicantcontactphnemllist"], "model.dga_data_model.los__applicantidentitydetail": ["model.dga_data_model.stg_los__applicantidentitydetail"], "model.dga_data_model.los__applicantmiscdetail": ["model.dga_data_model.stg_los__applicantmiscdetail"], "model.dga_data_model.los__applicationdetails": ["model.dga_data_model.stg_los__applicationdetails"], "model.dga_data_model.los__appraisal_custom": ["model.dga_data_model.stg_los__appraisal_custom"], "model.dga_data_model.los__areas": ["model.dga_data_model.stg_los__areas"], "model.dga_data_model.los__bizcenter": ["model.dga_data_model.stg_los__bizcenter"], "model.dga_data_model.los__categories": ["model.dga_data_model.stg_los__categories"], "model.dga_data_model.los__category_lang": ["model.dga_data_model.stg_los__category_lang"], "model.dga_data_model.los__closroutingdetails": ["model.dga_data_model.stg_los__closroutingdetails"], "model.dga_data_model.los__collateralgeneraldetails": ["model.dga_data_model.stg_los__collateralgeneraldetails"], "model.dga_data_model.los__collaterallinkage": ["model.dga_data_model.stg_los__collaterallinkage"], "model.dga_data_model.los__corpappentitydetails": ["model.dga_data_model.stg_los__corpappentitydetails"], "model.dga_data_model.los__corpapplicationdetails": ["model.dga_data_model.stg_los__corpapplicationdetails"], "model.dga_data_model.los__corpapplimitdetails": ["model.dga_data_model.stg_los__corpapplimitdetails"], "model.dga_data_model.los__corpdecisioncode": ["model.dga_data_model.stg_los__corpdecisioncode"], "model.dga_data_model.los__creditcardproduct": ["model.dga_data_model.stg_los__creditcardproduct"], "model.dga_data_model.los__creditscoringdetails": ["model.dga_data_model.stg_los__creditscoringdetails"], "model.dga_data_model.los__custidentitydetail": ["model.dga_data_model.stg_los__custidentitydetail"], "model.dga_data_model.los__customerdetail": ["model.dga_data_model.stg_los__customerdetail"], "model.dga_data_model.los__decision": ["model.dga_data_model.stg_los__decision"], "model.dga_data_model.los__loanproductdetails": ["model.dga_data_model.stg_los__loanproductdetails"], "model.dga_data_model.los__losprocessentity": ["model.dga_data_model.stg_los__losprocessentity"], "model.dga_data_model.los__opportunities": ["model.dga_data_model.stg_los__opportunities"], "model.dga_data_model.los__oscorpcustomerdetail": ["model.dga_data_model.stg_los__oscorpcustomerdetail"], "model.dga_data_model.los__oscorpdocumentdetail": ["model.dga_data_model.stg_los__oscorpdocumentdetail"], "model.dga_data_model.los__oslineproductdetails": ["model.dga_data_model.stg_los__oslineproductdetails"], "model.dga_data_model.los__osproduct": ["model.dga_data_model.stg_los__osproduct"], "model.dga_data_model.los__parentapplication": ["model.dga_data_model.stg_los__parentapplication"], "model.dga_data_model.los__person": ["model.dga_data_model.stg_los__person"], "model.dga_data_model.los__rlosroutingdetails": ["model.dga_data_model.stg_los__rlosroutingdetails"], "model.dga_data_model.los__rlosworknotes": ["model.dga_data_model.stg_los__rlosworknotes"], "model.dga_data_model.los__rollback": ["model.dga_data_model.stg_los__rollback"], "model.dga_data_model.los__slbccodemapping": ["source.dga_data_model.crmuser.slbccodemapping"], "model.dga_data_model.los__srmgroups": ["model.dga_data_model.stg_los__srmgroups"], "model.dga_data_model.los__syncapplicantaddressmap": ["source.dga_data_model.crmuser.syncapplicantaddressmap"], "model.dga_data_model.los__transactiondepartment": ["model.dga_data_model.stg_los__transactiondepartment"], "model.dga_data_model.los__useractiontray": ["model.dga_data_model.stg_los__useractiontray"], "model.dga_data_model.los__users": ["model.dga_data_model.stg_los__users"], "model.dga_data_model.los__user_groups": ["model.dga_data_model.stg_los__user_groups"], "model.dga_data_model.mercury__tbl_applicant_enterprise_income": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"], "model.dga_data_model.mercury__tbl_css_eb_applicant": ["model.dga_data_model.stg_mercury__tbl_css_eb_applicant"], "model.dga_data_model.mercury__tbl_doc_detail": ["model.dga_data_model.stg_mercury__tbl_doc_detail_clean"], "model.dga_data_model.mercury__tbl_doc_need_list": ["model.dga_data_model.stg_mercury__tbl_doc_need_list"], "model.dga_data_model.mercury__tbl_doc_no_hist": ["model.dga_data_model.stg_mercury__tbl_doc_no_hist"], "model.dga_data_model.mercury__tbl_eb_applicant": ["model.dga_data_model.stg_mercury__tbl_eb_applicant"], "model.dga_data_model.mercury__tbl_eb_application": ["model.dga_data_model.stg_mercury__tbl_eb_application"], "model.dga_data_model.qlhs__customer_active_df": ["source.dga_data_model.dbo.customer_active_df"], "model.dga_data_model.qlhs__customer_product_holding_df": ["source.dga_data_model.dbo.customer_product_holding_df"], "model.dga_data_model.qlhs__data_toi": ["source.dga_data_model.dbo.data_toi_df"], "model.dga_data_model.tms__tbl_daily_performance": ["model.dga_data_model.stg_tms__tbldailyperformance"], "model.dga_data_model.tms__tbl_event": ["model.dga_data_model.stg_tms__tblevent"], "model.dga_data_model.tms__tbl_event_history": ["model.dga_data_model.stg_tms__tbleventhistory"], "model.dga_data_model.tms__tbl_incident": ["model.dga_data_model.stg_tms__tblincident"], "model.dga_data_model.tms__tbl_incident_history": ["model.dga_data_model.stg_tms__tblincidenthistory"], "model.dga_data_model.vision__build_schedules_details_audit": ["source.dga_data_model.vision.build_schedules_details_audit"], "model.dga_data_model.vision__contracts": ["model.dga_data_model.stg_vision_tmp__contracts"], "model.dga_data_model.vision__currency_rates_daily": ["source.dga_data_model.vision.currency_rates_daily"], "model.dga_data_model.vision__customers": ["model.dga_data_model.stg_vision_tmp__customers"], "model.dga_data_model.vision__eb_bal_offbs_monthly": ["source.dga_data_model.eb_datasource.huong_atf_vision_mth_2023"], "model.dga_data_model.vision__eb_bal_onbs_monthly": ["source.dga_data_model.eb_datasource.zcustomersall_2023"], "model.dga_data_model.vision__eb_cst_status_monthly": ["source.dga_data_model.eb_datasource.trang_thai_kh_2023"], "model.dga_data_model.vision__eb_prd_holding_monthly": ["source.dga_data_model.eb_datasource.tambtt3_sanpham_kh_sudung_2023"], "model.dga_data_model.vision__eb_toi_monthly": ["source.dga_data_model.eb_datasource.zlnthang_cif_ftpnew_2023"], "model.dga_data_model.vision__fin_dly_audit": ["source.dga_data_model.vision.fin_dly_audit"], "model.dga_data_model.vision__fin_dly_balances": ["model.dga_data_model.stg_vision_tmp__fin_dly_balances"], "model.dga_data_model.vision__fin_dly_headers": ["model.dga_data_model.stg_vision_tmp__fin_dly_headers"], "model.dga_data_model.vision__fin_dly_mappings": ["model.dga_data_model.stg_vision_tmp__fin_dly_mappings"], "model.dga_data_model.vision__ftp_term_rates": ["model.dga_data_model.stg_vision__ftp_term_rates"], "model.dga_data_model.vision__mgt_expanded": ["source.dga_data_model.vision.mgt_expanded"], "model.dga_data_model.way4__account": ["source.dga_data_model.msb.account"], "model.dga_data_model.way4__acnt_contract": ["model.dga_data_model.stg_way4__acnt_contract"], "model.dga_data_model.way4__cr_limit_log": ["model.dga_data_model.stg_way4__cr_limit_log"], "model.dga_data_model.way4__cs_decision": ["source.dga_data_model.msb.cs_decision"], "model.dga_data_model.way4__cs_status_type": ["source.dga_data_model.msb.cs_status_type"], "model.dga_data_model.int_qlhs__bal_mly_eb": ["model.dga_data_model.vision__eb_bal_offbs_monthly", "model.dga_data_model.vision__eb_bal_onbs_monthly", "model.dga_data_model.vision__eb_bal_onbs_monthly"], "model.dga_data_model.int_vision__bal_dly": ["model.dga_data_model.stg_landing__vision_currency_rates_daily", "model.dga_data_model.stg_landing__vision_fin_dly_balances", "model.dga_data_model.stg_landing__vision_fin_dly_headers", "model.dga_data_model.stg_landing__vision_fin_dly_mappings", "model.dga_data_model.stg_landing__vision_mgt_expanded", "model.dga_data_model.stg_landing__vision_mgt_expanded", "model.dga_data_model.vision__build_schedules_details_audit"], "model.dga_data_model.int_vision__bal_dly_eb": ["model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.int_vision__bal_mly_eb": ["model.dga_data_model.int_vision__bal_dly_eb", "model.dga_data_model.int_vision__bal_dly_eb"], "model.dga_data_model.int__bal_mly_eb": ["model.dga_data_model.int_qlhs__bal_mly_eb", "model.dga_data_model.int_vision__bal_mly_eb"], "model.dga_data_model.bpm_vhkq__atm_module": ["model.dga_data_model.bpm_vhkq__atm", "model.dga_data_model.bpm_vhkq__process_definition", "model.dga_data_model.bpm_vhkq__process_instance", "model.dga_data_model.bpm_vhkq__request_atm", "model.dga_data_model.bpm_vhkq__request_atm_card_detail", "model.dga_data_model.bpm_vhkq__request_atm_detail", "model.dga_data_model.bpm_vhkq__request_atm_tray_detail", "model.dga_data_model.bpm_vhkq__staff", "model.dga_data_model.bpm_vhkq__staff_request_atm", "source.dga_data_model.base.imp_bpm_vhkq__category"], "model.dga_data_model.bpm_vhkq__kq_module": ["model.dga_data_model.bpm_vhkq__delivery", "model.dga_data_model.bpm_vhkq__process_definition", "model.dga_data_model.bpm_vhkq__process_instance", "model.dga_data_model.bpm_vhkq__process_instance_his", "model.dga_data_model.bpm_vhkq__request_branch", "model.dga_data_model.bpm_vhkq__request_branch_detail", "model.dga_data_model.bpm_vhkq__staff", "model.dga_data_model.bpm_vhkq__staff", "model.dga_data_model.bpm_vhkq__staff_request_branch", "source.dga_data_model.base.imp_bpm_vhkq__category"], "model.dga_data_model.bpm_vhkq__kq_module_unit": ["model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__volume_module": ["model.dga_data_model.bpm_vhkq__staff", "model.dga_data_model.bpm_vhkq__volume", "model.dga_data_model.bpm_vhkq__volume_detail", "model.dga_data_model.bpm_vhkq__warehouse"], "model.dga_data_model.int__gl_bal": ["model.dga_data_model.stg_landing__gl_account_master", "source.dga_data_model.base.imp_bpm_vhkq__gl_khoquy"], "model.dga_data_model.int__gl_txn": ["model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_int__gl_txn_demanddeposit", "model.dga_data_model.stg_int__gl_txn_fixeddeposit", "model.dga_data_model.stg_int__gl_txn_loan", "model.dga_data_model.stg_int__gl_txn_nhnn_tctd", "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung", "source.dga_data_model.base.imp_vhkq__cust_thu_chi_ho"], "model.dga_data_model.int_cic__bond_outstanding": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__daututraiphieu", "model.dga_data_model.stg_dwh__cydm_rate_history"], "model.dga_data_model.int_cic__cc_lag_12m": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__dunothetd12thang"], "model.dga_data_model.int_cic__cc_outstanding": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__dunothetd", "model.dga_data_model.stg_dwh__cydm_rate_history"], "model.dga_data_model.int_cic__customer_info": ["model.dga_data_model.stg_cic__customer_info"], "model.dga_data_model.int_cic__loan_lag_12m": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__duno12thang"], "model.dga_data_model.int_cic__loan_outstanding": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__ttduno", "model.dga_data_model.stg_dwh__cydm_rate_history"], "model.dga_data_model.int_cic__outstanding": ["model.dga_data_model.dim__customer", "model.dga_data_model.dim_cic__customer_info", "model.dga_data_model.int_cic__bond_outstanding", "model.dga_data_model.int_cic__cc_outstanding", "model.dga_data_model.int_cic__loan_outstanding", "model.dga_data_model.int_cic__tf_outstanding", "model.dga_data_model.int_cic__vamc_outstanding"], "model.dga_data_model.int_cic__outstanding_lag_12m": ["model.dga_data_model.dim__customer", "model.dga_data_model.dim_cic__customer_info", "model.dga_data_model.int_cic__cc_lag_12m", "model.dga_data_model.int_cic__loan_lag_12m"], "model.dga_data_model.int_cic__outstanding_lag_12m_smy": ["model.dga_data_model.dim__customer", "model.dga_data_model.dim_cic__customer_info", "model.dga_data_model.int_cic__outstanding", "model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__duno12thang", "model.dga_data_model.stg_cic__dunothetd12thang"], "model.dga_data_model.int_cic__question_info": ["model.dga_data_model.stg_cic__cicmaster", "model.dga_data_model.stg_cic__thongtinchung"], "model.dga_data_model.int_cic__tf_outstanding": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__camketngoaibang", "model.dga_data_model.stg_dwh__cydm_rate_history"], "model.dga_data_model.int_cic__vamc_outstanding": ["model.dga_data_model.int_cic__question_info", "model.dga_data_model.stg_cic__novamc", "model.dga_data_model.stg_dwh__cydm_rate_history"], "model.dga_data_model.int_way4__card": ["model.dga_data_model.int_way4__contract", "model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg_landing__card_add_data", "model.dga_data_model.stg_landing__card_f_i"], "model.dga_data_model.int_way4__client": ["model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_client", "model.dga_data_model.stg_landing__demanddeposit_master001"], "model.dga_data_model.int_way4__contract": ["model.dga_data_model.stg__card_acnt_contract_plus"], "model.dga_data_model.int__arrangement": ["model.dga_data_model.int__casa_account", "model.dga_data_model.int__casa_account", "model.dga_data_model.int__fd_account", "model.dga_data_model.int_way4__card", "model.dga_data_model.int_way4__card", "model.dga_data_model.stg_landing__bc_user_info", "model.dga_data_model.stg_landing__fixeddeposit_master002", "model.dga_data_model.stg_landing__loan_master002"], "model.dga_data_model.int__casa_account": ["model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.stg_landing__jupiter_account_register_hist", "model.dga_data_model.stg_landing__jupiter_cif_register_history", "model.dga_data_model.stg_landing__jupiter_customer_temp", "model.dga_data_model.stg_landing__overdraft_tier001"], "model.dga_data_model.int__customer": ["model.dga_data_model.stg__customer_connection_pivot", "model.dga_data_model.stg_landing__customer_address", "model.dga_data_model.stg_landing__customer_job_infomation", "model.dga_data_model.stg_landing__customer_marital_status", "model.dga_data_model.stg_landing__customer_master001", "model.dga_data_model.stg_landing__customer_master001", "model.dga_data_model.stg_landing__customer_master002", "model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__df_customer_sts_type", "model.dga_data_model.stg_landing__jupiter_cif_register_history", "model.dga_data_model.stg_landing__loan_master002", "model.dga_data_model.stg_landing__vw_df_customer_active_latest", "source.dga_data_model.int.int_tax__customer_info", "source.dga_data_model.mart.dim__industry"], "model.dga_data_model.int__fd_account": ["model.dga_data_model.stg_dwh__csdm_branch", "model.dga_data_model.stg_dwh__cydm_rate_history", "model.dga_data_model.stg_dwh__fddm_product", "model.dga_data_model.stg_landing__fixeddeposit_master001", "model.dga_data_model.stg_landing__fixeddeposit_master002", "model.dga_data_model.stg_landing__fixeddeposit_master002", "model.dga_data_model.stg_landing__fixeddeposit_master003"], "model.dga_data_model.int__ln_account": ["model.dga_data_model.stg_dwh__cydm_rate_history", "model.dga_data_model.stg_dwh__cydm_rate_history", "model.dga_data_model.stg_dwh__loan_master001", "model.dga_data_model.stg_landing__loan_application_facility", "model.dga_data_model.stg_landing__loan_master002"], "model.dga_data_model.agg_clos_limit_tree_detail": ["model.dga_data_model.fact_clos_decision", "source.dga_data_model.mart.dim_clos_limit_tree"], "model.dga_data_model.int_los__application_relation": ["model.dga_data_model.los__applicantidentitydetail", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_rb_los__addressdetail", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__applicantaddress", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontact", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__applicantcontactphnemllist", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__creditcardproduct", "model.dga_data_model.stg_rb_los__decision", "model.dga_data_model.stg_rb_los__opportunities", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__person", "model.dga_data_model.stg_rb_los__slbccodemapping", "model.dga_data_model.stg_rb_los__syncapplicantaddressmap"], "model.dga_data_model.int_los__product": ["model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_los__transactiondepartmentinfo", "model.dga_data_model.stg_rb_los__addoncarddetails", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__creditcardproduct", "model.dga_data_model.stg_rb_los__decision", "model.dga_data_model.stg_rb_los__decision", "model.dga_data_model.stg_rb_los__loanproductdetails", "model.dga_data_model.stg_rb_los__losprocessentity", "model.dga_data_model.stg_rb_los__opportunities", "model.dga_data_model.stg_rb_los__oslineproductdetails", "model.dga_data_model.stg_rb_los__osproduct", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__rlosroutingdetails", "model.dga_data_model.stg_rb_los__slbccodemapping"], "model.dga_data_model.int_los__rb": ["model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat_remark", "model.dga_data_model.stg_rb_los__rlosroutingdetails"], "model.dga_data_model.int_los__tat": ["model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_category", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg__los_user", "model.dga_data_model.stg_rb_los__applicant", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__applicationdetails", "model.dga_data_model.stg_rb_los__losprocessentity", "model.dga_data_model.stg_rb_los__opportunities", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__parentapplication", "model.dga_data_model.stg_rb_los__rlosroutingdetails", "model.dga_data_model.stg_rb_los__rlosroutingdetails", "model.dga_data_model.stg_rb_los__rlosworknotes"], "model.dga_data_model.int_los__tat_remark": ["model.dga_data_model.int_los__tat", "model.dga_data_model.stg_rb_los__rlosworknotes"], "model.dga_data_model.int_mercury__customer_ckdt": ["model.dga_data_model.mercury__tbl_applicant_enterprise_income", "model.dga_data_model.mercury__tbl_css_eb_applicant", "model.dga_data_model.mercury__tbl_doc_detail", "model.dga_data_model.mercury__tbl_doc_need_list", "model.dga_data_model.mercury__tbl_doc_no_hist", "model.dga_data_model.mercury__tbl_eb_applicant", "model.dga_data_model.mercury__tbl_eb_application"], "model.dga_data_model.int_venus__oppotunity": ["model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_branch", "model.dga_data_model.stg_landing__sppl_m_campaign", "model.dga_data_model.stg_landing__sppl_m_customer", "model.dga_data_model.stg_landing__sppl_m_lead", "model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "model.dga_data_model.stg_landing__sppl_m_team_group", "model.dga_data_model.stg_landing__sppl_m_user", "model.dga_data_model.stg_landing__sppl_m_user"], "model.dga_data_model.dim_bpm__loan_application": ["source.dga_data_model.df_2.bpm_application", "source.dga_data_model.df_2.bpm_application_data", "source.dga_data_model.df_2.bpm_branch_mapping", "source.dga_data_model.df_2.bpm_eb_customer", "source.dga_data_model.df_2.bpm_opportunity", "source.dga_data_model.df_2.jstb_111", "source.dga_data_model.df_2.jstb_12"], "model.dga_data_model.fact_bpm__loan_application_activities": ["source.dga_data_model.df_2.bpm_application", "source.dga_data_model.df_2.bpm_application_history_detail", "source.dga_data_model.df_2.bpm_eb_customer", "source.dga_data_model.df_2.bpm_opportunity"], "model.dga_data_model.fact_bpm__loan_application_decision": ["source.dga_data_model.df_2.bpm_application_data", "source.dga_data_model.df_2.bpm_application_history", "source.dga_data_model.df_2.bpm_application_history_detail", "source.dga_data_model.df_2.bpm_branch_mapping", "source.dga_data_model.df_2.bpm_opportunity", "source.dga_data_model.df_2.jstb_110", "source.dga_data_model.df_2.jstb_111", "source.dga_data_model.df_2.jstb_118", "source.dga_data_model.df_2.jstb_122", "source.dga_data_model.df_2.jstb_123", "source.dga_data_model.df_2.jstb_135", "source.dga_data_model.df_2.jstb_143", "source.dga_data_model.df_2.jstb_145", "source.dga_data_model.df_2.jstb_147", "source.dga_data_model.df_2.jstb_152", "source.dga_data_model.df_2.jstb_153", "source.dga_data_model.df_2.jstb_154", "source.dga_data_model.df_2.jstb_155", "source.dga_data_model.df_2.jstb_159", "source.dga_data_model.df_2.jstb_171", "source.dga_data_model.df_2.jstb_174", "source.dga_data_model.df_2.jstb_183", "source.dga_data_model.df_2.jstb_184", "source.dga_data_model.df_2.jstb_188", "source.dga_data_model.df_2.jstb_189", "source.dga_data_model.df_2.jstb_20363", "source.dga_data_model.df_2.jstb_240", "source.dga_data_model.df_2.jstb_3"], "model.dga_data_model.dim__atm": ["snapshot.dga_data_model.stg_mart__atm_dim", "snapshot.dga_data_model.stg_mart__atm_dim"], "model.dga_data_model.dim__subbranch": ["snapshot.dga_data_model.stg_mart__sub_branch"], "model.dga_data_model.fact__atm_cash_in_cycle": ["model.dga_data_model.stg_atm__cashout_sum", "model.dga_data_model.stg_atm__cashout_sum", "model.dga_data_model.stg_atm__update_chu_ky", "model.dga_data_model.stg_atm__update_chu_ky"], "model.dga_data_model.fact__atm_cost_performance": ["model.dga_data_model.dim__atm", "model.dga_data_model.fact__atm_daily", "model.dga_data_model.int__gl_bal", "model.dga_data_model.vision__ftp_term_rates"], "model.dga_data_model.fact__atm_daily": ["model.dga_data_model.dim__atm", "model.dga_data_model.stg_mart_vhkq__atm_cash_daily", "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus", "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus"], "model.dga_data_model.dim_cic__customer_info": ["model.dga_data_model.int_cic__customer_info"], "model.dga_data_model.dim_clos_application_detail": ["model.dga_data_model.los__corpappentitydetails", "model.dga_data_model.los__corpapplicationdetails", "model.dga_data_model.los__oscorpcustomerdetail", "model.dga_data_model.los__users"], "model.dga_data_model.fact_clos_application_activities": ["model.dga_data_model.dim_clos_application_detail", "model.dga_data_model.los__closroutingdetails", "model.dga_data_model.los__corpapplicationdetails", "model.dga_data_model.los__useractiontray", "model.dga_data_model.los__users", "model.dga_data_model.los__users", "model.dga_data_model.los__users", "model.dga_data_model.stg_los__corpapplicationdetails", "model.dga_data_model.stg_los__useractiontray"], "model.dga_data_model.fact_clos_decision": ["model.dga_data_model.los__corpappentitydetails", "model.dga_data_model.los__corpapplicationdetails", "model.dga_data_model.los__corpapplimitdetails", "model.dga_data_model.los__users"], "model.dga_data_model.dim_cms__loan_application": ["source.dga_data_model.df_2.bpm_branch_mapping", "source.dga_data_model.df_2.cj3_file_upload_loan", "source.dga_data_model.df_2.cj3_history_assign_lead", "source.dga_data_model.df_2.cj3_history_update_loan", "source.dga_data_model.df_2.cj3_leads_activities", "source.dga_data_model.df_2.cj3_leads_info", "source.dga_data_model.df_2.cj3_loan_application", "source.dga_data_model.df_2.cj3_staff", "source.dga_data_model.df_2.thuvh3_tax_code_test"], "model.dga_data_model.fact_cms__loan_application_activities": ["source.dga_data_model.df_2.cj3_file_upload_loan", "source.dga_data_model.df_2.cj3_history_assign_lead", "source.dga_data_model.df_2.cj3_history_update_loan", "source.dga_data_model.df_2.cj3_loan_application", "source.dga_data_model.df_2.cj3_loan_application_tracking", "source.dga_data_model.df_2.cj3_staff"], "model.dga_data_model.dim__arrangement": ["model.dga_data_model.int__arrangement"], "model.dga_data_model.dim__casa_account": ["model.dga_data_model.int__casa_account", "model.dga_data_model.int__casa_account"], "model.dga_data_model.dim__customer": ["model.dga_data_model.int__customer"], "model.dga_data_model.dim__date": ["source.dga_data_model.daily_bulanding.df_date_dim @DGA_READ_BULANDING_DBL"], "model.dga_data_model.fct__agg_casa_bal_daily": ["model.dga_data_model.stg_landing__demanddeposit_master001", "model.dga_data_model.stg_landing__demanddeposit_master002", "source.dga_data_model.daily_bulanding.demanddeposit_master003 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.fct__agg_casa_txn_daily": ["model.dga_data_model.fct__trans_casa"], "model.dga_data_model.fct__agg_fd_bal_daily": ["model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_landing__fixeddeposit_master003", "model.dga_data_model.stg_landing__fixeddeposit_master003"], "model.dga_data_model.fct__agg_ln_bal_daily": ["model.dga_data_model.stg_dwh__lnft_master", "model.dga_data_model.stg_dwh__loan_master001", "model.dga_data_model.stg_landing__customer_master002", "model.dga_data_model.stg_landing__loan_master001_2020001_2021212"], "model.dga_data_model.fct__agg_od_bal_daily": ["model.dga_data_model.stg_dwh__crtb_odtier"], "model.dga_data_model.fct__trans_card": ["model.dga_data_model.int_way4__card", "model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg_landing__card_currency", "model.dga_data_model.stg_landing__card_doc", "model.dga_data_model.stg_landing__card_m_transaction", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.stg_landing__way4_trans_type"], "model.dga_data_model.fct__trans_casa": ["model.dga_data_model.dim__date", "model.dga_data_model.int__casa_account", "model.dga_data_model.stg_dwh__csdm_branch", "model.dga_data_model.stg_dwh__csdm_branch", "model.dga_data_model.stg_dwh__csdm_transaction_code", "model.dga_data_model.stg_dwh__dddm_product", "model.dga_data_model.stg_dwh__demanddeposit_transaction001", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.stg_landing__df_casa_channel_trn_type"], "model.dga_data_model.fct__trans_casa_mpayroll": ["model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa"], "model.dga_data_model.fct__trans_casa_test": ["model.dga_data_model.dim__arrangement", "model.dga_data_model.dim__date", "model.dga_data_model.int__casa_account", "model.dga_data_model.stg__ddft_transaction_map_ibmb", "model.dga_data_model.stg_dwh__csdm_transaction_code", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.stg_landing__df_casa_channel_trn_type", "source.dga_data_model.staging.temp_daily_transaction_remark_define_product"], "model.dga_data_model.fct__agg_casa_bal_monthly": ["model.dga_data_model.dim__date", "model.dga_data_model.fct__agg_casa_bal_daily"], "model.dga_data_model.fct__agg_casa_txn_monthly": ["model.dga_data_model.int__casa_account", "model.dga_data_model.stg_landing__demanddeposit_master002", "model.dga_data_model.stg_landing__df_casa_channel_trn_type", "model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all"], "model.dga_data_model.fct__agg_fd_bal_monthly": ["model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily"], "model.dga_data_model.fct__agg_ln_bal_monthly": ["model.dga_data_model.fct__agg_ln_bal_daily", "model.dga_data_model.fct__agg_ln_bal_daily", "model.dga_data_model.fct__agg_ln_bal_daily"], "model.dga_data_model.fct__agg_od_bal_monthly": ["model.dga_data_model.dim__date", "model.dga_data_model.fct__agg_od_bal_daily"], "model.dga_data_model.report_eb_cashflow__cst_smy": ["model.dga_data_model.dim__customer", "model.dga_data_model.dwh__ccl_pln", "model.dga_data_model.report_eb_cashflow__detail", "source.dga_data_model.dga.tunglt_eb_health_financing", "source.dga_data_model.mart.dim__industry"], "model.dga_data_model.report_eb_cashflow__detail": ["model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int_mercury__customer_ckdt", "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL", "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL", "source.dga_data_model.dga.anlt4_eb_txn_processed", "source.dga_data_model.dga.thuvh3_eb_dm_luyke"], "model.dga_data_model.report_eb_cust360__casa_trans_agg": ["model.dga_data_model.fct__agg_casa_txn_daily", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__customer", "source.dga_data_model.dga.thuvh3_eb_dm_luyke"], "model.dga_data_model.report_eb_cust360__prd_smy": ["model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.vision__eb_toi_monthly"], "model.dga_data_model.report_eb__cst_smy_pivot": ["model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__bal_mly_eb", "model.dga_data_model.int__customer", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cashflow__detail"], "model.dga_data_model.report_eb__cst_smy_pivot_khsx": ["model.dga_data_model.report_eb__cst_smy_pivot", "source.dga_data_model.dga.tunglt_eb_acct_khsx"], "model.dga_data_model.fct__agg_card_txn_first_last": ["model.dga_data_model.fct__trans_card_bk"], "model.dga_data_model.fct__trans_card_bk": ["model.dga_data_model.int_way4__card", "model.dga_data_model.stg__card_acnt_contract_plus_bk", "model.dga_data_model.stg_landing__card_currency", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.stg_landing__df_card_channel", "model.dga_data_model.stg_landing__way4_trans_type", "source.dga_data_model.daily_bulanding.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL", "source.dga_data_model.daily_bulanding.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.fct__acc_opportunity_step": ["model.dga_data_model.stg_landing__sppl_m_account_planning", "model.dga_data_model.stg_landing__sppl_m_activities", "model.dga_data_model.stg_landing__sppl_m_activities", "model.dga_data_model.stg_landing__sppl_m_flow_activities_status", "model.dga_data_model.stg_landing__sppl_m_flow_activities_status", "model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "model.dga_data_model.stg_landing__sppl_m_selling_opportunity", "model.dga_data_model.stg_landing__sppl_m_selling_status", "model.dga_data_model.stg_landing__sppl_m_selling_status"], "model.dga_data_model.stg_bpm_vhkq__atm": ["source.dga_data_model.ms_kho_quy.atm"], "model.dga_data_model.stg_bpm_vhkq__atm_category_tray": ["source.dga_data_model.ms_kho_quy.atm_category_tray"], "model.dga_data_model.stg_bpm_vhkq__atm_detail": ["source.dga_data_model.ms_kho_quy.atm_detail"], "model.dga_data_model.stg_bpm_vhkq__attachment": ["source.dga_data_model.ms_kho_quy.attachment"], "model.dga_data_model.stg_bpm_vhkq__category": ["source.dga_data_model.ms_kho_quy.category"], "model.dga_data_model.stg_bpm_vhkq__delivery": ["source.dga_data_model.ms_kho_quy.delivery"], "model.dga_data_model.stg_bpm_vhkq__doc_no": ["source.dga_data_model.ms_kho_quy.doc_no"], "model.dga_data_model.stg_bpm_vhkq__mail_log": ["source.dga_data_model.ms_kho_quy.mail_log"], "model.dga_data_model.stg_bpm_vhkq__position": ["source.dga_data_model.ms_kho_quy.position"], "model.dga_data_model.stg_bpm_vhkq__process_definition": ["source.dga_data_model.ms_kho_quy.process_definition"], "model.dga_data_model.stg_bpm_vhkq__process_instance": ["source.dga_data_model.ms_kho_quy.process_instance"], "model.dga_data_model.stg_bpm_vhkq__process_instance_his": ["source.dga_data_model.ms_kho_quy.process_instance_his"], "model.dga_data_model.stg_bpm_vhkq__request_atm": ["source.dga_data_model.ms_kho_quy.request_atm"], "model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail": ["source.dga_data_model.ms_kho_quy.request_atm_card_detail"], "model.dga_data_model.stg_bpm_vhkq__request_atm_detail": ["source.dga_data_model.ms_kho_quy.request_atm_detail"], "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control": ["source.dga_data_model.ms_kho_quy.request_atm_tray_control"], "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail": ["source.dga_data_model.ms_kho_quy.request_atm_tray_detail"], "model.dga_data_model.stg_bpm_vhkq__request_branch": ["source.dga_data_model.ms_kho_quy.request_branch"], "model.dga_data_model.stg_bpm_vhkq__request_branch_detail": ["source.dga_data_model.ms_kho_quy.request_branch_detail"], "model.dga_data_model.stg_bpm_vhkq__skewed_threshold": ["source.dga_data_model.ms_kho_quy.skewed_threshold"], "model.dga_data_model.stg_bpm_vhkq__staff": ["source.dga_data_model.ms_kho_quy.staff"], "model.dga_data_model.stg_bpm_vhkq__staff_assignment": ["source.dga_data_model.ms_kho_quy.staff_assignment"], "model.dga_data_model.stg_bpm_vhkq__staff_request_atm": ["source.dga_data_model.ms_kho_quy.staff_request_atm"], "model.dga_data_model.stg_bpm_vhkq__staff_request_branch": ["source.dga_data_model.ms_kho_quy.staff_request_branch"], "model.dga_data_model.stg_bpm_vhkq__staff_transfer_history": ["source.dga_data_model.ms_kho_quy.staff_transfer_history"], "model.dga_data_model.stg_bpm_vhkq__template": ["source.dga_data_model.ms_kho_quy.template"], "model.dga_data_model.stg_bpm_vhkq__user_unit": ["source.dga_data_model.ms_kho_quy.user_unit"], "model.dga_data_model.stg_bpm_vhkq__volume": ["source.dga_data_model.ms_kho_quy.volume"], "model.dga_data_model.stg_bpm_vhkq__volume_detail": ["source.dga_data_model.ms_kho_quy.volume_detail"], "model.dga_data_model.stg_bpm_vhkq__warehouse": ["source.dga_data_model.ms_kho_quy.warehouse"], "model.dga_data_model.stg_bpm_vhkq__warehouse_organization": ["source.dga_data_model.ms_kho_quy.warehouse_organization"], "model.dga_data_model.stg_bpm_vhkq__warehouse_user": ["source.dga_data_model.ms_kho_quy.warehouse_user"], "model.dga_data_model.stg_atm__cashout_sum": ["model.dga_data_model.fact__atm_daily"], "model.dga_data_model.stg_atm__update_chu_ky": ["model.dga_data_model.fact__atm_daily"], "model.dga_data_model.stg_mart_vhkq__atm": ["model.dga_data_model.bpm_vhkq__warehouse", "model.dga_data_model.bpm_vhkq__warehouse", "model.dga_data_model.bpm_vhkq__warehouse_organization", "model.dga_data_model.stg_bpm_vhkq__atm", "source.dga_data_model.vhkq_atm_daily_az_base.imp_bpm_vhkq__atm"], "model.dga_data_model.stg_mart_vhkq__atm_cash_daily": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus": ["model.dga_data_model.stg_landing__card_doc"], "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus": ["model.dga_data_model.stg_landing__card_doc"], "model.dga_data_model.stg_mart_vhkq__subbranch_dim": ["model.dga_data_model.bpm_vhkq__warehouse_organization"], "model.dga_data_model.stg_cic__camketngoaibang": ["source.dga_data_model.cic_bulanding.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__cicmaster": ["source.dga_data_model.cic_bulanding.cic_cicmaster @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__customer_info": ["source.dga_data_model.cic_bulanding.cic_customer_info @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__daututraiphieu": ["source.dga_data_model.cic_bulanding.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__duno12thang": ["source.dga_data_model.cic_bulanding.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__dunothetd": ["source.dga_data_model.cic_bulanding.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__dunothetd12thang": ["source.dga_data_model.cic_bulanding.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__novamc": ["source.dga_data_model.cic_bulanding.cic_cicth_novamc @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__thongtinchung": ["source.dga_data_model.cic_bulanding.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_cic__ttduno": ["source.dga_data_model.cic_bulanding.cic_cicth_ttduno @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg__card_acnt_contract_plus": ["model.dga_data_model.int_way4__client", "model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_appl_product", "model.dga_data_model.stg_landing__card_contr_status", "model.dga_data_model.stg_landing__df_card_channel"], "model.dga_data_model.stg__customer_connection_pivot": ["model.dga_data_model.stg_landing__customer_connection"], "model.dga_data_model.stg__customer_subbranch_no": ["model.dga_data_model.int__casa_account", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "model.dga_data_model.int__fd_account"], "model.dga_data_model.stg_dwh__crtb_odtier": ["source.dga_data_model.daily_dwh.crtb_odtier @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__csdm_branch": ["source.dga_data_model.daily_dwh.csdm_branch @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__csdm_transaction_code": ["source.dga_data_model.daily_dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__cydm_rate_history": ["source.dga_data_model.daily_dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__dddm_product": ["source.dga_data_model.daily_dwh.dddm_product @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__ddft_master": ["source.dga_data_model.daily_dwh.ddft_master @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__demanddeposit_transaction001": ["source.dga_data_model.daily_dwh.ddft_transaction @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__fddm_product": ["source.dga_data_model.daily_dwh.fddm_product @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__lnft_master": ["source.dga_data_model.daily_dwh.lnft_master @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_dwh__loan_master001": ["source.dga_data_model.daily_dwh.lndm_account @DGA_READ_DWHPRO_DBL"], "model.dga_data_model.stg_int__gl_txn": ["model.dga_data_model.stg_landing__gl_hist", "model.dga_data_model.stg_landing__gl_hist"], "model.dga_data_model.stg_int__gl_txn_check_date": ["model.dga_data_model.int__gl_txn", "model.dga_data_model.stg_int__gl_txn", "source.dga_data_model.gl_daily_bul.demanddeposit_transaction001", "source.dga_data_model.gl_daily_bul.fixeddeposit_transaction001", "source.dga_data_model.gl_daily_bul.loan_transaction001"], "model.dga_data_model.stg_int__gl_txn_demanddeposit": ["model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_landing__demanddeposit_transaction001"], "model.dga_data_model.stg_int__gl_txn_fixeddeposit": ["model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_landing__fixeddeposit_transaction001"], "model.dga_data_model.stg_int__gl_txn_loan": ["model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_landing__loan_transaction001"], "model.dga_data_model.stg_int__gl_txn_nhnn_tctd": ["model.dga_data_model.stg_landing__gl_hist"], "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung": ["model.dga_data_model.stg_landing__gl_hist"], "model.dga_data_model.stg_landing__demanddeposit_transaction001": ["model.dga_data_model.stg_landing__gl_hist"], "model.dga_data_model.stg_landing__fixeddeposit_transaction001": ["model.dga_data_model.stg_landing__gl_hist"], "model.dga_data_model.stg_landing__gl_account_master": ["source.dga_data_model.gl_daily_bul.gl_account_master"], "model.dga_data_model.stg_landing__gl_hist": ["source.dga_data_model.gl_daily_bul.si_his_glhist"], "model.dga_data_model.stg_landing__loan_transaction001": ["model.dga_data_model.stg_landing__gl_hist"], "model.dga_data_model.stg_landing__bc_user_info": ["source.dga_data_model.daily_bulanding.bc_user_info @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_acnt_contract": ["source.dga_data_model.daily_bulanding.card_acnt_contract @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_add_data": ["source.dga_data_model.daily_bulanding.card_add_data @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_appl_product": ["source.dga_data_model.daily_bulanding.card_appl_product @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_client": ["source.dga_data_model.daily_bulanding.card_client @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_contr_status": ["source.dga_data_model.daily_bulanding.card_contr_status @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_currency": ["source.dga_data_model.daily_bulanding.card_currency @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_doc": ["source.dga_data_model.daily_bulanding.card_doc @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_f_i": ["source.dga_data_model.daily_bulanding.card_f_i @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__card_m_transaction": ["source.dga_data_model.daily_bulanding.card_m_transaction @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__customer_address": ["source.dga_data_model.daily_bulanding.customer_address @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__customer_connection": ["source.dga_data_model.daily_bulanding.customer_connection @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__customer_job_infomation": ["source.dga_data_model.daily_bulanding.customer_job_infomation @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__customer_marital_status": ["source.dga_data_model.daily_bulanding.customer_marital_status @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__customer_master001": ["source.dga_data_model.daily_bulanding.customer_master001 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__customer_master002": ["source.dga_data_model.daily_bulanding.customer_master002 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__demanddeposit_master001": ["source.dga_data_model.daily_bulanding.demanddeposit_master001 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__demanddeposit_master002": ["source.dga_data_model.daily_bulanding.demanddeposit_master002 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__df_card_channel": ["source.dga_data_model.daily_bulanding.df_card_channel @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__df_card_sic": ["source.dga_data_model.daily_bulanding.df_card_sic @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__df_casa_channel_trn_type": ["source.dga_data_model.daily_bulanding.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__df_customer_sts_type": ["source.dga_data_model.daily_bulanding.df_customer_sts_type @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__fixeddeposit_master001": ["source.dga_data_model.daily_bulanding.fixeddeposit_master001 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__fixeddeposit_master002": ["source.dga_data_model.daily_bulanding.fixeddeposit_master002 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__fixeddeposit_master003": ["source.dga_data_model.daily_bulanding.fixeddeposit_master003 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__jupiter_account_register_hist": ["source.dga_data_model.daily_bulanding.jupiter_account_register_hist @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__jupiter_cif_register_history": ["source.dga_data_model.daily_bulanding.jupiter_cif_register_history @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__jupiter_customer_temp": ["source.dga_data_model.daily_bulanding.jupiter_customer_temp @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__loan_application_facility": ["source.dga_data_model.daily_bulanding.loan_application_facility @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__loan_master001_2020001_2021212": ["source.dga_data_model.daily_bulanding.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__loan_master002": ["source.dga_data_model.daily_bulanding.loan_master002 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__overdraft_tier001": ["source.dga_data_model.daily_bulanding.overdraft_tier001 @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vw_df_customer_active_latest": ["source.dga_data_model.daily_bulanding.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all": ["source.dga_data_model.daily_bulanding.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vw_df_overdraft_tier002_union_all": ["source.dga_data_model.daily_bulanding.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__way4_trans_type": ["source.dga_data_model.daily_bulanding.way4_trans_type @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vision_currency_rates_daily": ["source.dga_data_model.vision_bulanding.vision_currency_rates_daily @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vision_fin_dly_balances": ["source.dga_data_model.vision_bulanding.vision_fin_dly_balances @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vision_fin_dly_headers": ["source.dga_data_model.vision_bulanding.vision_fin_dly_headers @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vision_fin_dly_mappings": ["source.dga_data_model.vision_bulanding.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__vision_mgt_expanded": ["source.dga_data_model.vision_bulanding.vision_mgt_expanded @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_los__addoncarddetails": ["source.dga_data_model.crmuser.addoncarddetails"], "model.dga_data_model.stg_los__agents": ["source.dga_data_model.crmuser.agents"], "model.dga_data_model.stg_los__agent_entity_details": ["source.dga_data_model.crmuser.agent_entity_details"], "model.dga_data_model.stg_los__applicant": ["source.dga_data_model.crmuser.applicant"], "model.dga_data_model.stg_los__applicantcontact": ["source.dga_data_model.crmuser.applicantcontact"], "model.dga_data_model.stg_los__applicantcontactphnemllist": ["source.dga_data_model.crmuser.applicantcontactphnemllist"], "model.dga_data_model.stg_los__applicantidentitydetail": ["source.dga_data_model.crmuser.applicantidentitydetail"], "model.dga_data_model.stg_los__applicantmiscdetail": ["source.dga_data_model.crmuser.applicantmiscdetail"], "model.dga_data_model.stg_los__applicationdetails": ["source.dga_data_model.crmuser.applicationdetails"], "model.dga_data_model.stg_los__appraisal_custom": ["source.dga_data_model.crmuser.appraisal_custom"], "model.dga_data_model.stg_los__areas": ["source.dga_data_model.crmuser.areas"], "model.dga_data_model.stg_los__bizcenter": ["source.dga_data_model.crmuser.bizcenter"], "model.dga_data_model.stg_los__categories": ["source.dga_data_model.crmuser.categories"], "model.dga_data_model.stg_los__category_lang": ["source.dga_data_model.crmuser.category_lang"], "model.dga_data_model.stg_los__closroutingdetails": ["source.dga_data_model.crmuser.closroutingdetails"], "model.dga_data_model.stg_los__collateralgeneraldetails": ["source.dga_data_model.crmuser.collateralgeneraldetails"], "model.dga_data_model.stg_los__collaterallinkage": ["source.dga_data_model.crmuser.collaterallinkage"], "model.dga_data_model.stg_los__corpappentitydetails": ["source.dga_data_model.crmuser.corpappentitydetails"], "model.dga_data_model.stg_los__corpapplicationdetails": ["source.dga_data_model.crmuser.corpapplicationdetails"], "model.dga_data_model.stg_los__corpapplimitdetails": ["source.dga_data_model.crmuser.corpapplimitdetails"], "model.dga_data_model.stg_los__corpdecisioncode": ["source.dga_data_model.crmuser.corpdecisioncode"], "model.dga_data_model.stg_los__creditcardproduct": ["source.dga_data_model.crmuser.creditcardproduct"], "model.dga_data_model.stg_los__creditscoringdetails": ["source.dga_data_model.crmuser.creditscoringdetails"], "model.dga_data_model.stg_los__custidentitydetail": ["source.dga_data_model.crmuser.custidentitydetail"], "model.dga_data_model.stg_los__customerdetail": ["source.dga_data_model.crmuser.customerdetail"], "model.dga_data_model.stg_los__decision": ["source.dga_data_model.crmuser.decision"], "model.dga_data_model.stg_los__loanproductdetails": ["source.dga_data_model.crmuser.loanproductdetails"], "model.dga_data_model.stg_los__losprocessentity": ["source.dga_data_model.crmuser.losprocessentity"], "model.dga_data_model.stg_los__opportunities": ["source.dga_data_model.crmuser.opportunities"], "model.dga_data_model.stg_los__oscorpcustomerdetail": ["source.dga_data_model.crmuser.oscorpcustomerdetail"], "model.dga_data_model.stg_los__oscorpdocumentdetail": ["source.dga_data_model.crmuser.oscorpdocumentdetail"], "model.dga_data_model.stg_los__oslineproductdetails": ["source.dga_data_model.crmuser.oslineproductdetails"], "model.dga_data_model.stg_los__osproduct": ["source.dga_data_model.crmuser.osproduct"], "model.dga_data_model.stg_los__parentapplication": ["source.dga_data_model.crmuser.parentapplication"], "model.dga_data_model.stg_los__person": ["source.dga_data_model.crmuser.person"], "model.dga_data_model.stg_los__rlosroutingdetails": ["source.dga_data_model.crmuser.rlosroutingdetails"], "model.dga_data_model.stg_los__rlosworknotes": ["source.dga_data_model.crmuser.rlosworknotes"], "model.dga_data_model.stg_los__rollback": ["source.dga_data_model.crmuser.rollback"], "model.dga_data_model.stg_los__srmgroups": ["source.dga_data_model.crmuser.srmgroups"], "model.dga_data_model.stg_los__transactiondepartment": ["source.dga_data_model.crmuser.transactiondepartment"], "model.dga_data_model.stg_los__useractiontray": ["source.dga_data_model.crmuser.useractiontray"], "model.dga_data_model.stg_los__users": ["source.dga_data_model.crmuser.users"], "model.dga_data_model.stg_los__user_groups": ["source.dga_data_model.crmuser.user_groups"], "model.dga_data_model.stg_los__transactiondepartmentinfo": ["model.dga_data_model.stg_rb_los__areas", "model.dga_data_model.stg_rb_los__transactiondepartment"], "model.dga_data_model.stg_rb_los__addoncarddetails": ["model.dga_data_model.los__addoncarddetails"], "model.dga_data_model.stg_rb_los__address": ["model.dga_data_model.los__address"], "model.dga_data_model.stg_rb_los__addressdetail": ["model.dga_data_model.los__addressdetail"], "model.dga_data_model.stg_rb_los__agents": ["model.dga_data_model.los__agents"], "model.dga_data_model.stg_rb_los__applicant": ["model.dga_data_model.los__applicant"], "model.dga_data_model.stg_rb_los__applicantaddress": ["model.dga_data_model.los__applicantaddress"], "model.dga_data_model.stg_rb_los__applicantcontact": ["model.dga_data_model.los__applicantcontact"], "model.dga_data_model.stg_rb_los__applicantcontactphnemllist": ["model.dga_data_model.los__applicantcontactphnemllist"], "model.dga_data_model.stg_rb_los__applicantidentitydetail": ["model.dga_data_model.los__applicantidentitydetail"], "model.dga_data_model.stg_rb_los__applicationdetails": ["model.dga_data_model.los__applicationdetails"], "model.dga_data_model.stg_rb_los__areas": ["model.dga_data_model.los__areas"], "model.dga_data_model.stg_rb_los__bizcenter": ["model.dga_data_model.los__bizcenter"], "model.dga_data_model.stg_rb_los__categories": ["model.dga_data_model.los__categories"], "model.dga_data_model.stg_rb_los__category_lang": ["model.dga_data_model.los__category_lang"], "model.dga_data_model.stg_rb_los__creditcardproduct": ["model.dga_data_model.los__creditcardproduct"], "model.dga_data_model.stg_rb_los__decision": ["model.dga_data_model.los__decision"], "model.dga_data_model.stg_rb_los__loanproductdetails": ["model.dga_data_model.los__loanproductdetails"], "model.dga_data_model.stg_rb_los__losprocessentity": ["model.dga_data_model.los__losprocessentity"], "model.dga_data_model.stg_rb_los__opportunities": ["model.dga_data_model.los__opportunities"], "model.dga_data_model.stg_rb_los__oslineproductdetails": ["model.dga_data_model.los__oslineproductdetails"], "model.dga_data_model.stg_rb_los__osproduct": ["model.dga_data_model.los__osproduct"], "model.dga_data_model.stg_rb_los__parentapplication": ["model.dga_data_model.los__parentapplication"], "model.dga_data_model.stg_rb_los__person": ["model.dga_data_model.los__person"], "model.dga_data_model.stg_rb_los__rlosroutingdetails": ["model.dga_data_model.los__rlosroutingdetails"], "model.dga_data_model.stg_rb_los__rlosworknotes": ["model.dga_data_model.los__rlosworknotes"], "model.dga_data_model.stg_rb_los__rollback": ["model.dga_data_model.los__rollback"], "model.dga_data_model.stg_rb_los__slbccodemapping": ["model.dga_data_model.los__slbccodemapping"], "model.dga_data_model.stg_rb_los__syncapplicantaddressmap": ["model.dga_data_model.los__syncapplicantaddressmap"], "model.dga_data_model.stg_rb_los__transactiondepartment": ["model.dga_data_model.los__transactiondepartment"], "model.dga_data_model.stg_rb_los__users": ["model.dga_data_model.los__users"], "model.dga_data_model.stg__los_category": ["model.dga_data_model.stg_rb_los__categories", "model.dga_data_model.stg_rb_los__category_lang"], "model.dga_data_model.stg__los_user": ["model.dga_data_model.stg_rb_los__address", "model.dga_data_model.stg_rb_los__agents", "model.dga_data_model.stg_rb_los__bizcenter", "model.dga_data_model.stg_rb_los__person", "model.dga_data_model.stg_rb_los__users"], "model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income": ["source.dga_data_model.mercury.tbl_applicant_enterprise_income"], "model.dga_data_model.stg_mercury__tbl_css_eb_applicant": ["source.dga_data_model.mercury.tbl_css_eb_applicant"], "model.dga_data_model.stg_mercury__tbl_doc_detail": ["source.dga_data_model.mercury.tbl_doc_detail"], "model.dga_data_model.stg_mercury__tbl_doc_detail_clean": ["model.dga_data_model.stg_mercury__tbl_doc_detail"], "model.dga_data_model.stg_mercury__tbl_doc_need_list": ["source.dga_data_model.mercury.tbl_doc_need_list"], "model.dga_data_model.stg_mercury__tbl_doc_no_hist": ["source.dga_data_model.mercury.tbl_doc_no_hist"], "model.dga_data_model.stg_mercury__tbl_eb_applicant": ["source.dga_data_model.mercury.tbl_eb_applicant"], "model.dga_data_model.stg_mercury__tbl_eb_application": ["source.dga_data_model.mercury.tbl_eb_application"], "model.dga_data_model.stg__card_acnt_contract_plus_bk": ["model.dga_data_model.int_way4__client", "model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_acnt_contract", "model.dga_data_model.stg_landing__card_appl_product", "model.dga_data_model.stg_landing__card_contr_status", "model.dga_data_model.stg_landing__df_card_channel"], "model.dga_data_model.stg__ddft_transaction_map_ibmb": ["model.dga_data_model.stg_dwh__demanddeposit_transaction001", "model.dga_data_model.stg_landing__demanddeposit_master002", "source.dga_data_model.daily_bulanding.bb_transfer_history@dga_read_bulanding_dbl", "source.dga_data_model.daily_bulanding.bb_ttr_history@dga_read_bulanding_dbl", "source.dga_data_model.daily_dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl"], "model.dga_data_model.test_los__categories_run": ["source.dga_data_model.staging.stg_los__categories_test"], "model.dga_data_model.test_los__corpapplimitdetails_run": ["source.dga_data_model.staging.stg_los__corpapplimitdetails_test"], "model.dga_data_model.test_los__opportunities_run": ["source.dga_data_model.staging.stg_los__opportunities_test"], "model.dga_data_model.test_stg_los__areas_run": ["source.dga_data_model.crmuser.areas"], "model.dga_data_model.stg_tms__tbldailyperformance": ["source.dga_data_model.dbo.tbldailyperformance", "source.dga_data_model.sys.dual"], "model.dga_data_model.stg_tms__tblevent": ["source.dga_data_model.dbo.tblevent", "source.dga_data_model.sys.dual"], "model.dga_data_model.stg_tms__tbleventhistory": ["source.dga_data_model.dbo.tbleventhistory", "source.dga_data_model.sys.dual"], "model.dga_data_model.stg_tms__tblincident": ["source.dga_data_model.dbo.tblincident", "source.dga_data_model.sys.dual"], "model.dga_data_model.stg_tms__tblincidenthistory": ["source.dga_data_model.dbo.tblincidenthistory", "source.dga_data_model.sys.dual"], "model.dga_data_model.stg_landing__sppl_m_account_planning": ["source.dga_data_model.venus_bulanding.sppl_m_account_planning @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_activities": ["source.dga_data_model.venus_bulanding.sppl_m_activities @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_branch": ["source.dga_data_model.venus_bulanding.sppl_m_branch @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_campaign": ["source.dga_data_model.venus_bulanding.sppl_m_campaign @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_customer": ["source.dga_data_model.venus_bulanding.sppl_m_customer @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_flow_activities_status": ["source.dga_data_model.venus_bulanding.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_lead": ["source.dga_data_model.venus_bulanding.sppl_m_lead @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_selling_opportunity": ["source.dga_data_model.venus_bulanding.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_selling_status": ["source.dga_data_model.venus_bulanding.sppl_m_selling_status @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_team_group": ["source.dga_data_model.venus_bulanding.sppl_m_team_group @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_landing__sppl_m_user": ["source.dga_data_model.venus_bulanding.sppl_m_user @DGA_READ_BULANDING_DBL"], "model.dga_data_model.stg_vision_tmp__contracts": ["source.dga_data_model.vision.contracts"], "model.dga_data_model.stg_vision_tmp__customers": ["source.dga_data_model.vision.customers"], "model.dga_data_model.stg_vision_tmp__fin_dly_balances": [], "model.dga_data_model.stg_vision_tmp__fin_dly_headers": [], "model.dga_data_model.stg_vision_tmp__fin_dly_mappings": [], "model.dga_data_model.stg_vision__ftp_term_rates": ["source.dga_data_model.vision.ftp_term_rates"], "model.dga_data_model.stg_way4__acnt_contract": ["source.dga_data_model.msb.acnt_contract"], "model.dga_data_model.stg_way4__cr_limit_log": ["source.dga_data_model.msb.cr_limit_log"], "snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd": ["model.dga_data_model.stg_bpm_vhkq__staff"], "snapshot.dga_data_model.stg_mart__atm_dim": ["model.dga_data_model.stg_mart_vhkq__atm"], "snapshot.dga_data_model.stg_mart__sub_branch": ["model.dga_data_model.stg_mart_vhkq__subbranch_dim"], "test.dga_data_model.fct__trans_casa_test_sum": ["model.dga_data_model.fct__trans_casa_test"], "test.dga_data_model.stg__ddft_transaction_test": ["model.dga_data_model.stg__ddft_transaction_map_ibmb"], "test.dga_data_model.mart__dim_arrangement_unique": ["model.dga_data_model.dim__arrangement"], "test.dga_data_model.mart__dim_casa_account_unique": ["model.dga_data_model.dim__casa_account"], "test.dga_data_model.mart__dim_customer_unique": ["model.dga_data_model.dim__customer"], "operation.dga_data_model.dga_data_model-on-run-end-0": [], "test.dga_data_model.unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date.4761489701": ["model.dga_data_model.dwh__demanddeposit_master003"], "test.dga_data_model.unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date.744a049d76": ["model.dga_data_model.dwh__fixeddeposit_master003"], "test.dga_data_model.unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date.caecc3fb45": ["model.dga_data_model.dwh__loan_master003"], "test.dga_data_model.not_null_imp_topup_bscore_cif.fe574724d3": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_imp_topup_bscore_import_month__cif.6fee4edf88": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date.ce6b98aa4f": ["model.dga_data_model.landing_hist__ews_rb_cust_info"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date.0ebf942566": ["model.dga_data_model.landing_hist__ews_rb_thruput_casa"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date.858f988552": ["model.dga_data_model.landing_hist__ews_rb_thruput_fd"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date.8158943d76": ["model.dga_data_model.landing_hist__ews_rb_thruput_in"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date.8a73bd2fef": ["model.dga_data_model.landing_hist__ews_rb_thruput_out"], "test.dga_data_model.dbt_utils_recency_los__addoncarddetails_day__tmdate__1.bc4d5c6a33": ["model.dga_data_model.los__addoncarddetails"], "test.dga_data_model.dbt_utils_recency_los__applicationdetails_day__tmdate__1.da6d96a64a": ["model.dga_data_model.los__applicationdetails"], "test.dga_data_model.dbt_utils_recency_los__decision_day__tmdate__1.146f2ebedd": ["model.dga_data_model.los__decision"], "test.dga_data_model.dbt_utils_recency_los__loanproductdetails_day__tmdate__1.458576e248": ["model.dga_data_model.los__loanproductdetails"], "test.dga_data_model.dbt_utils_recency_los__opportunities_day__tmdate__1.0df0f3f09e": ["model.dga_data_model.los__opportunities"], "test.dga_data_model.dbt_utils_recency_los__parentapplication_day__tmdate__1.2894f8d3ff": ["model.dga_data_model.los__parentapplication"], "test.dga_data_model.dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.3f5502f1a8": ["model.dga_data_model.los__rlosroutingdetails"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno.193e15dda9": ["model.dga_data_model.qlhs__customer_active_df"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno.effa5cebe5": ["model.dga_data_model.qlhs__customer_product_holding_df"], "test.dga_data_model.unique_way4__account_id.606c041c7e": ["model.dga_data_model.way4__account"], "test.dga_data_model.not_null_way4__account_id.42250b14a9": ["model.dga_data_model.way4__account"], "test.dga_data_model.unique_way4__acnt_contract_id.d8efeb3890": ["model.dga_data_model.way4__acnt_contract"], "test.dga_data_model.not_null_way4__acnt_contract_id.0c26c772e0": ["model.dga_data_model.way4__acnt_contract"], "test.dga_data_model.not_null_int_vision__bal_dly_contract_id.ccfb098323": ["model.dga_data_model.int_vision__bal_dly"], "test.dga_data_model.not_null_int_vision__bal_dly_customer_number.98f4fd21ca": ["model.dga_data_model.int_vision__bal_dly"], "test.dga_data_model.not_null_int_qlhs__bal_mly_eb_customer_number.89b884b56a": ["model.dga_data_model.int_qlhs__bal_mly_eb"], "test.dga_data_model.orc_is_recency_int__gl_bal_etl_date.05b7836690": ["model.dga_data_model.int__gl_bal"], "test.dga_data_model.unique_int__customer_customer_number.1cd17835b2": ["model.dga_data_model.int__customer"], "test.dga_data_model.not_null_int__customer_customer_number.aac0557946": ["model.dga_data_model.int__customer"], "test.dga_data_model.unique_int__fd_account_account_number.603b8c0377": ["model.dga_data_model.int__fd_account"], "test.dga_data_model.not_null_int__fd_account_account_number.81310a0a6b": ["model.dga_data_model.int__fd_account"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid.c510d4509a": ["model.dga_data_model.int_los__product"], "test.dga_data_model.unique_int_los__tat_rlosroutingdetailsid.4b99cb2e71": ["model.dga_data_model.int_los__tat"], "test.dga_data_model.unique_int_mercury__customer_ckdt_process_instance_id.ddc0fb4315": ["model.dga_data_model.int_mercury__customer_ckdt"], "test.dga_data_model.not_null_int_mercury__customer_ckdt_process_instance_id.a7717a0618": ["model.dga_data_model.int_mercury__customer_ckdt"], "test.dga_data_model.relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_.9f85424705": ["model.dga_data_model.int_mercury__customer_ckdt", "model.dga_data_model.mercury__tbl_doc_need_list"], "test.dga_data_model.unique_int_venus__oppotunity_opportunity_id.109c0e1c9c": ["model.dga_data_model.int_venus__oppotunity"], "test.dga_data_model.dbt_utils_unique_combination_of_columns_report__list_approved_customer_by_df_001_created_month__customer_number.d3e2d5794d": [], "test.dga_data_model.unique_fct__acc_opportunity_step_opportunity_id.3a6507fb55": ["model.dga_data_model.fct__acc_opportunity_step"], "test.dga_data_model.orc_is_recency_stg_cic__cicmaster_etl_date.1bdcafa3a4": ["model.dga_data_model.stg_cic__cicmaster"], "test.dga_data_model.orc_is_recency_stg_cic__customer_info_etl_date.e0ab189878": ["model.dga_data_model.stg_cic__customer_info"], "test.dga_data_model.orc_is_recency_stg_cic__duno12thang_etl_date.dbfc93bf54": ["model.dga_data_model.stg_cic__duno12thang"], "test.dga_data_model.orc_is_recency_stg_cic__dunothetd_etl_date.d37908707e": ["model.dga_data_model.stg_cic__dunothetd"], "test.dga_data_model.orc_is_recency_stg_cic__dunothetd12thang_etl_date.eebb1d0751": ["model.dga_data_model.stg_cic__dunothetd12thang"], "test.dga_data_model.orc_is_recency_stg_cic__thongtinchung_etl_date.876fedf12a": ["model.dga_data_model.stg_cic__thongtinchung"], "test.dga_data_model.orc_is_recency_stg_cic__ttduno_etl_date.2af45cc849": ["model.dga_data_model.stg_cic__ttduno"], "test.dga_data_model.orc_is_recency_stg_landing__bc_user_info_etl_date.2dc6d694c8": ["model.dga_data_model.stg_landing__bc_user_info"], "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.8c71b1b163": ["model.dga_data_model.stg_landing__fixeddeposit_master003"], "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.99deaed4d2": ["model.dga_data_model.stg_landing__fixeddeposit_master002"], "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.97ff66932f": ["model.dga_data_model.stg_landing__fixeddeposit_master001"], "test.dga_data_model.orc_is_recency_stg_landing__card_acnt_contract_etl_date.5369951f37": ["model.dga_data_model.stg_landing__card_acnt_contract"], "test.dga_data_model.orc_is_recency_stg_landing__card_add_data_etl_date.942f1931e9": ["model.dga_data_model.stg_landing__card_add_data"], "test.dga_data_model.orc_is_recency_stg_landing__card_appl_product_etl_date.f3c5a7deb6": ["model.dga_data_model.stg_landing__card_appl_product"], "test.dga_data_model.orc_is_recency_stg_landing__card_client_etl_date.8d85cbdf16": ["model.dga_data_model.stg_landing__card_client"], "test.dga_data_model.orc_is_recency_stg_landing__card_contr_status_etl_date.6a4f16b203": ["model.dga_data_model.stg_landing__card_contr_status"], "test.dga_data_model.orc_is_recency_stg_landing__card_f_i_etl_date.672b25084d": ["model.dga_data_model.stg_landing__card_f_i"], "test.dga_data_model.orc_is_recency_stg_landing__customer_address_etl_date.eb7993f041": ["model.dga_data_model.stg_landing__customer_address"], "test.dga_data_model.orc_is_recency_stg_landing__customer_job_infomation_etl_date.ffc5a514d9": ["model.dga_data_model.stg_landing__customer_job_infomation"], "test.dga_data_model.orc_is_recency_stg_landing__customer_marital_status_etl_date.8162991b78": ["model.dga_data_model.stg_landing__customer_marital_status"], "test.dga_data_model.orc_is_recency_stg_landing__customer_master001_etl_date.99881945be": ["model.dga_data_model.stg_landing__customer_master001"], "test.dga_data_model.orc_is_recency_stg_landing__customer_master002_etl_date.1dcd6f7517": ["model.dga_data_model.stg_landing__customer_master002"], "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master001_etl_date.7948d90a59": ["model.dga_data_model.stg_landing__demanddeposit_master001"], "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master002_etl_date.b33614734e": ["model.dga_data_model.stg_landing__demanddeposit_master002"], "test.dga_data_model.orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date.61793b6aea": ["model.dga_data_model.stg_landing__jupiter_cif_register_history"], "test.dga_data_model.orc_is_recency_stg_landing__loan_application_facility_etl_date.c67bbe90a8": ["model.dga_data_model.stg_landing__loan_application_facility"], "test.dga_data_model.orc_is_recency_stg_landing__loan_master002_etl_date.1bc920035b": ["model.dga_data_model.stg_landing__loan_master002"], "test.dga_data_model.orc_is_recency_stg_landing__overdraft_tier001_etl_date.9945cfd653": ["model.dga_data_model.stg_landing__overdraft_tier001"], "test.dga_data_model.not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.fdf155c0bf": ["model.dga_data_model.stg_mercury__tbl_css_eb_applicant"], "test.dga_data_model.not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.b4c30eb3a4": ["model.dga_data_model.stg_mercury__tbl_doc_detail"], "test.dga_data_model.not_null_stg_mercury__tbl_doc_need_list_process_instance_id.0c46006a7b": ["model.dga_data_model.stg_mercury__tbl_doc_need_list"], "test.dga_data_model.not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.9ffee0b510": ["model.dga_data_model.stg_mercury__tbl_doc_no_hist"], "test.dga_data_model.not_null_stg_mercury__tbl_eb_applicant_eb_application_id.15581b5933": ["model.dga_data_model.stg_mercury__tbl_eb_applicant"], "test.dga_data_model.unique_stg_mercury__tbl_eb_application_id.f4697dc688": ["model.dga_data_model.stg_mercury__tbl_eb_application"], "test.dga_data_model.not_null_stg_mercury__tbl_eb_application_id.313e1bda9c": ["model.dga_data_model.stg_mercury__tbl_eb_application"], "test.dga_data_model.unique_stg_mercury__tbl_applicant_enterprise_income_id.4dc6760cd3": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"], "test.dga_data_model.not_null_stg_mercury__tbl_applicant_enterprise_income_id.1112240430": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"], "test.dga_data_model.unique_stg_way4__acnt_contract_id.6d1e1f65a1": ["model.dga_data_model.stg_way4__acnt_contract"], "test.dga_data_model.not_null_stg_way4__acnt_contract_id.c5a7413b7e": ["model.dga_data_model.stg_way4__acnt_contract"], "test.dga_data_model.unique_stg_cr_limit_log_id.72e579340e": [], "test.dga_data_model.not_null_stg_cr_limit_log_id.65f3470229": [], "test.dga_data_model.source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date.1cf303bcbd": ["source.dga_data_model.dwh.ddft_master"], "test.dga_data_model.source_is_recency_dwh_ddft_master_etl_date.58b2088fa3": ["source.dga_data_model.dwh.ddft_master"], "test.dga_data_model.source_is_recency_dwh_ddft_transaction_trn_date.b05d64f57c": ["source.dga_data_model.dwh.ddft_transaction"], "test.dga_data_model.source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date.6f8ee49248": ["source.dga_data_model.dwh.fdft_master"], "test.dga_data_model.source_is_recency_dwh_fdft_master_etl_date.9ed31cec99": ["source.dga_data_model.dwh.fdft_master"], "test.dga_data_model.source_is_recency_dwh_fdft_transaction_trn_date.05214279e7": ["source.dga_data_model.dwh.fdft_transaction"], "test.dga_data_model.source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date.f516a10e24": ["source.dga_data_model.dwh.lnft_master"], "test.dga_data_model.source_is_recency_dwh_lnft_master_etl_date.7d978c35de": ["source.dga_data_model.dwh.lnft_master"], "test.dga_data_model.source_is_recency_dwh_lnft_transaction_tran_date.396f7d9c7e": ["source.dga_data_model.dwh.lnft_transaction"], "test.dga_data_model.source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode.281de86ed2": ["source.dga_data_model.dga.thuvh3_eb_dm_luyke"], "test.dga_data_model.source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode.7aa21fe19d": ["source.dga_data_model.dga.tunglt_eb_acct_khsx"], "test.dga_data_model.source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_.22fea21b94": ["source.dga_data_model.dbo.data_toi_df"], "test.dga_data_model.source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_.08dc2fc82f": ["source.dga_data_model.dbo.customer_product_holding_df"], "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno.a1d6695c4f": ["source.dga_data_model.dbo.customer_product_holding_df"], "test.dga_data_model.source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_.f4966ea198": ["source.dga_data_model.dbo.customer_active_df"], "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno.d645917cc2": ["source.dga_data_model.dbo.customer_active_df"], "source.dga_data_model.dwh.ddft_master": [], "source.dga_data_model.dwh.ddft_transaction": [], "source.dga_data_model.dwh.fdft_master": [], "source.dga_data_model.dwh.fdft_transaction": [], "source.dga_data_model.dwh.lnft_master": [], "source.dga_data_model.dwh.lnft_transaction": [], "source.dga_data_model.dwh.ccl_pln": [], "source.dga_data_model.dwh.glft_his_transaction": [], "source.dga_data_model.dga_ingest.lc_cc_mast": [], "source.dga_data_model.base.dbt_test_materialized": [], "source.dga_data_model.dga.thuvh3_eb_dm_luyke": [], "source.dga_data_model.dga.anlt4_eb_txn_processed": [], "source.dga_data_model.dga.tunglt_eb_acct_khsx": [], "source.dga_data_model.dga.tunglt_eb_health_financing": [], "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.ews_bulanding.ews_rb_cust_info @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.ews_bulanding.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.ews_bulanding.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.ews_bulanding.ews_rb_thruput_in @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.ews_bulanding.ews_rb_thruput_out @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.dbo.data_toi_df": [], "source.dga_data_model.dbo.customer_product_holding_df": [], "source.dga_data_model.dbo.customer_active_df": [], "source.dga_data_model.vision.mgt_result_headers": [], "source.dga_data_model.vision.currency_rates_daily": [], "source.dga_data_model.vision.mgt_expanded": [], "source.dga_data_model.vision.contracts": [], "source.dga_data_model.vision.customers": [], "source.dga_data_model.vision.fin_dly_mappings_pm": [], "source.dga_data_model.vision.fin_dly_balances_pm": [], "source.dga_data_model.vision.vw_fin_dly_headers_pm": [], "source.dga_data_model.vision.mgt_result_balances": [], "source.dga_data_model.vision.fin_dly_audit": [], "source.dga_data_model.vision.ftp_term_rates": [], "source.dga_data_model.vision.build_schedules_details_audit": [], "source.dga_data_model.eb_datasource.zlnthang_cif_ftpnew_2023": [], "source.dga_data_model.eb_datasource.tambtt3_sanpham_kh_sudung_2023": [], "source.dga_data_model.eb_datasource.trang_thai_kh_2023": [], "source.dga_data_model.eb_datasource.zcustomersall_2023": [], "source.dga_data_model.eb_datasource.huong_atf_vision_mth_2023": [], "source.dga_data_model.msb.account": [], "source.dga_data_model.msb.acnt_contract": [], "source.dga_data_model.msb.cs_decision": [], "source.dga_data_model.msb.cs_status_type": [], "source.dga_data_model.base.imp_bpm_vhkq__category": [], "source.dga_data_model.base.imp_vhkq__cust_thu_chi_ho": [], "source.dga_data_model.base.imp_bpm_vhkq__gl_khoquy": [], "source.dga_data_model.int.int_tax__customer_info": [], "source.dga_data_model.mart.dim__industry": [], "source.dga_data_model.mart.dim_clos_limit_tree": [], "source.dga_data_model.df_2.bpm_branch_mapping": [], "source.dga_data_model.df_2.bpm_opportunity": [], "source.dga_data_model.df_2.bpm_eb_customer": [], "source.dga_data_model.df_2.bpm_application_data": [], "source.dga_data_model.df_2.bpm_application": [], "source.dga_data_model.df_2.bpm_application_history_detail": [], "source.dga_data_model.df_2.bpm_application_history": [], "source.dga_data_model.df_2.jstb_111": [], "source.dga_data_model.df_2.jstb_12": [], "source.dga_data_model.df_2.jstb_110": [], "source.dga_data_model.df_2.jstb_123": [], "source.dga_data_model.df_2.jstb_153": [], "source.dga_data_model.df_2.jstb_155": [], "source.dga_data_model.df_2.jstb_118": [], "source.dga_data_model.df_2.jstb_143": [], "source.dga_data_model.df_2.jstb_115": [], "source.dga_data_model.df_2.jstb_122": [], "source.dga_data_model.df_2.jstb_152": [], "source.dga_data_model.df_2.jstb_154": [], "source.dga_data_model.df_2.jstb_147": [], "source.dga_data_model.df_2.jstb_183": [], "source.dga_data_model.df_2.jstb_184": [], "source.dga_data_model.df_2.jstb_159": [], "source.dga_data_model.df_2.jstb_188": [], "source.dga_data_model.df_2.jstb_189": [], "source.dga_data_model.df_2.jstb_135": [], "source.dga_data_model.df_2.jstb_171": [], "source.dga_data_model.df_2.jstb_174": [], "source.dga_data_model.df_2.jstb_20363": [], "source.dga_data_model.df_2.jstb_240": [], "source.dga_data_model.df_2.jstb_3": [], "source.dga_data_model.df_2.jstb_145": [], "source.dga_data_model.df_2.cj3_history_assign_lead": [], "source.dga_data_model.df_2.cj3_history_update_loan": [], "source.dga_data_model.df_2.cj3_staff": [], "source.dga_data_model.df_2.cj3_file_upload_loan": [], "source.dga_data_model.df_2.cj3_loan_application": [], "source.dga_data_model.df_2.cj3_leads_activities": [], "source.dga_data_model.df_2.thuvh3_tax_code_test": [], "source.dga_data_model.df_2.cj3_loan_application_tracking": [], "source.dga_data_model.df_2.cj3_leads_info": [], "source.dga_data_model.ms_kho_quy.atm": [], "source.dga_data_model.ms_kho_quy.atm_category_tray": [], "source.dga_data_model.ms_kho_quy.atm_detail": [], "source.dga_data_model.ms_kho_quy.attachment": [], "source.dga_data_model.ms_kho_quy.category": [], "source.dga_data_model.ms_kho_quy.delivery": [], "source.dga_data_model.ms_kho_quy.doc_no": [], "source.dga_data_model.ms_kho_quy.mail_log": [], "source.dga_data_model.ms_kho_quy.position": [], "source.dga_data_model.ms_kho_quy.process_definition": [], "source.dga_data_model.ms_kho_quy.process_instance": [], "source.dga_data_model.ms_kho_quy.process_instance_his": [], "source.dga_data_model.ms_kho_quy.request_atm": [], "source.dga_data_model.ms_kho_quy.request_atm_card_detail": [], "source.dga_data_model.ms_kho_quy.request_atm_detail": [], "source.dga_data_model.ms_kho_quy.request_atm_tray_control": [], "source.dga_data_model.ms_kho_quy.request_atm_tray_detail": [], "source.dga_data_model.ms_kho_quy.request_branch": [], "source.dga_data_model.ms_kho_quy.request_branch_detail": [], "source.dga_data_model.ms_kho_quy.skewed_threshold": [], "source.dga_data_model.ms_kho_quy.staff": [], "source.dga_data_model.ms_kho_quy.staff_assignment": [], "source.dga_data_model.ms_kho_quy.staff_request_atm": [], "source.dga_data_model.ms_kho_quy.staff_request_branch": [], "source.dga_data_model.ms_kho_quy.staff_transfer_history": [], "source.dga_data_model.ms_kho_quy.template": [], "source.dga_data_model.ms_kho_quy.user_unit": [], "source.dga_data_model.ms_kho_quy.volume": [], "source.dga_data_model.ms_kho_quy.volume_detail": [], "source.dga_data_model.ms_kho_quy.warehouse": [], "source.dga_data_model.ms_kho_quy.warehouse_organization": [], "source.dga_data_model.ms_kho_quy.warehouse_user": [], "source.dga_data_model.vhkq_atm_daily_bul.card_doc": [], "source.dga_data_model.vhkq_atm_daily_az_int.int__gl_bal": [], "source.dga_data_model.vhkq_atm_daily_az_base.imp_bpm_vhkq__atm": [], "source.dga_data_model.cic_bulanding.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicmaster @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_customer_info @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_novamc @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.cic_bulanding.cic_cicth_ttduno @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.gl_daily_bul.si_his_glhist": [], "source.dga_data_model.gl_daily_bul.gl_account_master": [], "source.dga_data_model.gl_daily_bul.fixeddeposit_transaction001": [], "source.dga_data_model.gl_daily_bul.demanddeposit_transaction001": [], "source.dga_data_model.gl_daily_bul.loan_transaction001": [], "source.dga_data_model.gl_daily_az_stg.stg_int__gl_txn": [], "source.dga_data_model.gl_daily_az_int.int__gl_txn": [], "source.dga_data_model.daily_bulanding.bc_user_info @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_acnt_contract @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_add_data @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_appl_product @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_client @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_contr_status @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_currency @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_doc @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_f_i @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_m_transaction @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.customer_address @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.customer_connection @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.customer_job_infomation @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.customer_marital_status @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.customer_master001 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.customer_master002 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.demanddeposit_master001 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.demanddeposit_master002 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.df_card_channel @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.df_card_sic @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.df_customer_sts_type @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.fixeddeposit_master001 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.fixeddeposit_master002 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.fixeddeposit_master003 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.jupiter_account_register_hist @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.jupiter_cif_register_history @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.jupiter_customer_temp @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.loan_application_facility @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.loan_master002 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.overdraft_tier001 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.way4_trans_type @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.bb_ttr_history@dga_read_bulanding_dbl": [], "source.dga_data_model.daily_bulanding.bb_transfer_history@dga_read_bulanding_dbl": [], "source.dga_data_model.daily_bulanding.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.df_date_dim @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.demanddeposit_master003 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.daily_bulanding.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.staging.temp_daily_transaction_remark_define_product": [], "source.dga_data_model.daily_dwh.ddft_transaction @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.crtb_odtier @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.csdm_branch @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.dddm_product @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.ddft_master @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.fddm_product @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.lnft_master @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.lndm_account @DGA_READ_DWHPRO_DBL": [], "source.dga_data_model.daily_dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl": [], "source.dga_data_model.vision_bulanding.vision_currency_rates_daily @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.vision_bulanding.vision_fin_dly_balances @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.vision_bulanding.vision_fin_dly_headers @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.vision_bulanding.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.vision_bulanding.vision_mgt_expanded @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.mercury.tbl_eb_application": [], "source.dga_data_model.mercury.tbl_eb_applicant": [], "source.dga_data_model.mercury.tbl_css_eb_applicant": [], "source.dga_data_model.mercury.tbl_doc_need_list": [], "source.dga_data_model.mercury.tbl_doc_detail": [], "source.dga_data_model.mercury.tbl_doc_no_hist": [], "source.dga_data_model.mercury.tbl_applicant_enterprise_income": [], "source.dga_data_model.staging.stg_los__categories_test": [], "source.dga_data_model.staging.stg_los__opportunities_test": [], "source.dga_data_model.staging.stg_los__corpapplimitdetails_test": [], "source.dga_data_model.staging.stg_los__areas_test": [], "source.dga_data_model.dbo.tbldailyperformance": [], "source.dga_data_model.dbo.tblevent": [], "source.dga_data_model.dbo.tbleventhistory": [], "source.dga_data_model.dbo.tblincident": [], "source.dga_data_model.dbo.tblincidenthistory": [], "source.dga_data_model.sys.dual": [], "source.dga_data_model.venus_bulanding.sppl_m_account_planning @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_activities @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_branch @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_campaign @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_customer @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_lead @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_selling_status @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_team_group @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.venus_bulanding.sppl_m_user @DGA_READ_BULANDING_DBL": [], "source.dga_data_model.msb.cr_limit_log": [], "source.dga_data_model.crmuser.collaterallinkage": [], "source.dga_data_model.crmuser.customerdetail": [], "source.dga_data_model.crmuser.rollback": [], "source.dga_data_model.crmuser.user_groups": [], "source.dga_data_model.crmuser.applicantcontact": [], "source.dga_data_model.crmuser.oslineproductdetails": [], "source.dga_data_model.crmuser.applicantmiscdetail": [], "source.dga_data_model.crmuser.creditscoringdetails": [], "source.dga_data_model.crmuser.bizcenter": [], "source.dga_data_model.crmuser.useractiontray": [], "source.dga_data_model.crmuser.addoncarddetails": [], "source.dga_data_model.crmuser.applicant": [], "source.dga_data_model.crmuser.agents": [], "source.dga_data_model.crmuser.rlosworknotes": [], "source.dga_data_model.crmuser.agent_entity_details": [], "source.dga_data_model.crmuser.person": [], "source.dga_data_model.crmuser.corpdecisioncode": [], "source.dga_data_model.crmuser.rlosroutingdetails": [], "source.dga_data_model.crmuser.transactiondepartment": [], "source.dga_data_model.crmuser.parentapplication": [], "source.dga_data_model.crmuser.applicantcontactphnemllist": [], "source.dga_data_model.crmuser.decision": [], "source.dga_data_model.crmuser.appraisal_custom": [], "source.dga_data_model.crmuser.category_lang": [], "source.dga_data_model.crmuser.categories": [], "source.dga_data_model.crmuser.opportunities": [], "source.dga_data_model.crmuser.corpapplimitdetails": [], "source.dga_data_model.crmuser.osproduct": [], "source.dga_data_model.crmuser.corpapplicationdetails": [], "source.dga_data_model.crmuser.custidentitydetail": [], "source.dga_data_model.crmuser.losprocessentity": [], "source.dga_data_model.crmuser.creditcardproduct": [], "source.dga_data_model.crmuser.oscorpdocumentdetail": [], "source.dga_data_model.crmuser.oscorpcustomerdetail": [], "source.dga_data_model.crmuser.users": [], "source.dga_data_model.crmuser.corpappentitydetails": [], "source.dga_data_model.crmuser.applicantidentitydetail": [], "source.dga_data_model.crmuser.applicationdetails": [], "source.dga_data_model.crmuser.areas": [], "source.dga_data_model.crmuser.closroutingdetails": [], "source.dga_data_model.crmuser.srmgroups": [], "source.dga_data_model.crmuser.loanproductdetails": [], "source.dga_data_model.crmuser.address": [], "source.dga_data_model.crmuser.slbccodemapping": [], "source.dga_data_model.crmuser.collateralgeneraldetails": [], "source.dga_data_model.crmuser.addressdetail": [], "source.dga_data_model.crmuser.applicantaddress": [], "source.dga_data_model.crmuser.syncapplicantaddressmap": []}, "child_map": {"model.dga_data_model.dwh__ccl_pln": ["model.dga_data_model.report_eb_cashflow__cst_smy"], "model.dga_data_model.dwh__demanddeposit_master003": ["test.dga_data_model.unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date.4761489701"], "model.dga_data_model.dwh__demanddeposit_transaction001": [], "model.dga_data_model.dwh__fixeddeposit_master003": ["test.dga_data_model.unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date.744a049d76"], "model.dga_data_model.dwh__fixeddeposit_transaction001": [], "model.dga_data_model.dwh__glft_his_transaction": [], "model.dga_data_model.dwh__loan_master003": ["test.dga_data_model.unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date.caecc3fb45"], "model.dga_data_model.dwh__loan_transaction001": [], "model.dga_data_model.imp__eb_portfolio_mtd": [], "model.dga_data_model.imp__eb_txn_processed": [], "model.dga_data_model.landing__lc_cc_mast": [], "model.dga_data_model.vision__mgt_result_balances": [], "model.dga_data_model.vision__mgt_result_headers": [], "model.dga_data_model.bpm_vhkq__atm": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.bpm_vhkq__atm_category_tray": [], "model.dga_data_model.bpm_vhkq__atm_detail": [], "model.dga_data_model.bpm_vhkq__attachment": [], "model.dga_data_model.bpm_vhkq__category": [], "model.dga_data_model.bpm_vhkq__delivery": ["model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__doc_no": [], "model.dga_data_model.bpm_vhkq__mail_log": [], "model.dga_data_model.bpm_vhkq__position": [], "model.dga_data_model.bpm_vhkq__process_definition": ["model.dga_data_model.bpm_vhkq__atm_module", "model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__process_instance": ["model.dga_data_model.bpm_vhkq__atm_module", "model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__process_instance_his": ["model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__request_atm": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.bpm_vhkq__request_atm_card_detail": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.bpm_vhkq__request_atm_detail": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.bpm_vhkq__request_atm_tray_control": [], "model.dga_data_model.bpm_vhkq__request_atm_tray_detail": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.bpm_vhkq__request_branch": ["model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__request_branch_detail": ["model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__skewed_threshold": [], "model.dga_data_model.bpm_vhkq__staff": ["model.dga_data_model.bpm_vhkq__atm_module", "model.dga_data_model.bpm_vhkq__kq_module", "model.dga_data_model.bpm_vhkq__kq_module", "model.dga_data_model.bpm_vhkq__volume_module"], "model.dga_data_model.bpm_vhkq__staff_assignment": [], "model.dga_data_model.bpm_vhkq__staff_request_atm": ["model.dga_data_model.bpm_vhkq__atm_module"], "model.dga_data_model.bpm_vhkq__staff_request_branch": ["model.dga_data_model.bpm_vhkq__kq_module"], "model.dga_data_model.bpm_vhkq__staff_transfer_history": [], "model.dga_data_model.bpm_vhkq__staff_tsd": [], "model.dga_data_model.bpm_vhkq__template": [], "model.dga_data_model.bpm_vhkq__user_unit": [], "model.dga_data_model.bpm_vhkq__volume": ["model.dga_data_model.bpm_vhkq__volume_module"], "model.dga_data_model.bpm_vhkq__volume_detail": ["model.dga_data_model.bpm_vhkq__volume_module"], "model.dga_data_model.bpm_vhkq__warehouse": ["model.dga_data_model.bpm_vhkq__volume_module", "model.dga_data_model.stg_mart_vhkq__atm", "model.dga_data_model.stg_mart_vhkq__atm"], "model.dga_data_model.bpm_vhkq__warehouse_organization": ["model.dga_data_model.stg_mart_vhkq__atm", "model.dga_data_model.stg_mart_vhkq__subbranch_dim"], "model.dga_data_model.bpm_vhkq__warehouse_user": [], "model.dga_data_model.landing_hist__ews_rb_cust_info": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date.ce6b98aa4f"], "model.dga_data_model.landing_hist__ews_rb_thruput_casa": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date.0ebf942566"], "model.dga_data_model.landing_hist__ews_rb_thruput_fd": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date.858f988552"], "model.dga_data_model.landing_hist__ews_rb_thruput_in": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date.8158943d76"], "model.dga_data_model.landing_hist__ews_rb_thruput_out": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date.8a73bd2fef"], "model.dga_data_model.los__addoncarddetails": ["model.dga_data_model.stg_rb_los__addoncarddetails", "test.dga_data_model.dbt_utils_recency_los__addoncarddetails_day__tmdate__1.bc4d5c6a33"], "model.dga_data_model.los__address": ["model.dga_data_model.stg_rb_los__address"], "model.dga_data_model.los__addressdetail": ["model.dga_data_model.stg_rb_los__addressdetail"], "model.dga_data_model.los__agents": ["model.dga_data_model.stg_rb_los__agents"], "model.dga_data_model.los__agent_entity_details": [], "model.dga_data_model.los__applicant": ["model.dga_data_model.stg_rb_los__applicant"], "model.dga_data_model.los__applicantaddress": ["model.dga_data_model.stg_rb_los__applicantaddress"], "model.dga_data_model.los__applicantcontact": ["model.dga_data_model.stg_rb_los__applicantcontact"], "model.dga_data_model.los__applicantcontactphnemllist": ["model.dga_data_model.stg_rb_los__applicantcontactphnemllist"], "model.dga_data_model.los__applicantidentitydetail": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.stg_rb_los__applicantidentitydetail"], "model.dga_data_model.los__applicantmiscdetail": [], "model.dga_data_model.los__applicationdetails": ["model.dga_data_model.stg_rb_los__applicationdetails", "test.dga_data_model.dbt_utils_recency_los__applicationdetails_day__tmdate__1.da6d96a64a"], "model.dga_data_model.los__appraisal_custom": [], "model.dga_data_model.los__areas": ["model.dga_data_model.stg_rb_los__areas"], "model.dga_data_model.los__bizcenter": ["model.dga_data_model.stg_rb_los__bizcenter"], "model.dga_data_model.los__categories": ["model.dga_data_model.stg_rb_los__categories"], "model.dga_data_model.los__category_lang": ["model.dga_data_model.stg_rb_los__category_lang"], "model.dga_data_model.los__closroutingdetails": ["model.dga_data_model.fact_clos_application_activities"], "model.dga_data_model.los__collateralgeneraldetails": [], "model.dga_data_model.los__collaterallinkage": [], "model.dga_data_model.los__corpappentitydetails": ["model.dga_data_model.dim_clos_application_detail", "model.dga_data_model.fact_clos_decision"], "model.dga_data_model.los__corpapplicationdetails": ["model.dga_data_model.dim_clos_application_detail", "model.dga_data_model.fact_clos_application_activities", "model.dga_data_model.fact_clos_decision"], "model.dga_data_model.los__corpapplimitdetails": ["model.dga_data_model.fact_clos_decision"], "model.dga_data_model.los__corpdecisioncode": [], "model.dga_data_model.los__creditcardproduct": ["model.dga_data_model.stg_rb_los__creditcardproduct"], "model.dga_data_model.los__creditscoringdetails": [], "model.dga_data_model.los__custidentitydetail": [], "model.dga_data_model.los__customerdetail": [], "model.dga_data_model.los__decision": ["model.dga_data_model.stg_rb_los__decision", "test.dga_data_model.dbt_utils_recency_los__decision_day__tmdate__1.146f2ebedd"], "model.dga_data_model.los__loanproductdetails": ["model.dga_data_model.stg_rb_los__loanproductdetails", "test.dga_data_model.dbt_utils_recency_los__loanproductdetails_day__tmdate__1.458576e248"], "model.dga_data_model.los__losprocessentity": ["model.dga_data_model.stg_rb_los__losprocessentity"], "model.dga_data_model.los__opportunities": ["model.dga_data_model.stg_rb_los__opportunities", "test.dga_data_model.dbt_utils_recency_los__opportunities_day__tmdate__1.0df0f3f09e"], "model.dga_data_model.los__oscorpcustomerdetail": ["model.dga_data_model.dim_clos_application_detail"], "model.dga_data_model.los__oscorpdocumentdetail": [], "model.dga_data_model.los__oslineproductdetails": ["model.dga_data_model.stg_rb_los__oslineproductdetails"], "model.dga_data_model.los__osproduct": ["model.dga_data_model.stg_rb_los__osproduct"], "model.dga_data_model.los__parentapplication": ["model.dga_data_model.stg_rb_los__parentapplication", "test.dga_data_model.dbt_utils_recency_los__parentapplication_day__tmdate__1.2894f8d3ff"], "model.dga_data_model.los__person": ["model.dga_data_model.stg_rb_los__person"], "model.dga_data_model.los__rlosroutingdetails": ["model.dga_data_model.stg_rb_los__rlosroutingdetails", "test.dga_data_model.dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.3f5502f1a8"], "model.dga_data_model.los__rlosworknotes": ["model.dga_data_model.stg_rb_los__rlosworknotes"], "model.dga_data_model.los__rollback": ["model.dga_data_model.stg_rb_los__rollback"], "model.dga_data_model.los__slbccodemapping": ["model.dga_data_model.stg_rb_los__slbccodemapping"], "model.dga_data_model.los__srmgroups": [], "model.dga_data_model.los__syncapplicantaddressmap": ["model.dga_data_model.stg_rb_los__syncapplicantaddressmap"], "model.dga_data_model.los__transactiondepartment": ["model.dga_data_model.stg_rb_los__transactiondepartment"], "model.dga_data_model.los__useractiontray": ["model.dga_data_model.fact_clos_application_activities"], "model.dga_data_model.los__users": ["model.dga_data_model.dim_clos_application_detail", "model.dga_data_model.fact_clos_application_activities", "model.dga_data_model.fact_clos_application_activities", "model.dga_data_model.fact_clos_application_activities", "model.dga_data_model.fact_clos_decision", "model.dga_data_model.stg_rb_los__users"], "model.dga_data_model.los__user_groups": [], "model.dga_data_model.mercury__tbl_applicant_enterprise_income": ["model.dga_data_model.int_mercury__customer_ckdt"], "model.dga_data_model.mercury__tbl_css_eb_applicant": ["model.dga_data_model.int_mercury__customer_ckdt"], "model.dga_data_model.mercury__tbl_doc_detail": ["model.dga_data_model.int_mercury__customer_ckdt"], "model.dga_data_model.mercury__tbl_doc_need_list": ["model.dga_data_model.int_mercury__customer_ckdt", "test.dga_data_model.relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_.9f85424705"], "model.dga_data_model.mercury__tbl_doc_no_hist": ["model.dga_data_model.int_mercury__customer_ckdt"], "model.dga_data_model.mercury__tbl_eb_applicant": ["model.dga_data_model.int_mercury__customer_ckdt"], "model.dga_data_model.mercury__tbl_eb_application": ["model.dga_data_model.int_mercury__customer_ckdt"], "model.dga_data_model.qlhs__customer_active_df": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno.193e15dda9"], "model.dga_data_model.qlhs__customer_product_holding_df": ["test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno.effa5cebe5"], "model.dga_data_model.qlhs__data_toi": [], "model.dga_data_model.tms__tbl_daily_performance": [], "model.dga_data_model.tms__tbl_event": [], "model.dga_data_model.tms__tbl_event_history": [], "model.dga_data_model.tms__tbl_incident": [], "model.dga_data_model.tms__tbl_incident_history": [], "model.dga_data_model.vision__build_schedules_details_audit": ["model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.vision__contracts": [], "model.dga_data_model.vision__currency_rates_daily": [], "model.dga_data_model.vision__customers": [], "model.dga_data_model.vision__eb_bal_offbs_monthly": ["model.dga_data_model.int_qlhs__bal_mly_eb"], "model.dga_data_model.vision__eb_bal_onbs_monthly": ["model.dga_data_model.int_qlhs__bal_mly_eb", "model.dga_data_model.int_qlhs__bal_mly_eb"], "model.dga_data_model.vision__eb_cst_status_monthly": [], "model.dga_data_model.vision__eb_prd_holding_monthly": [], "model.dga_data_model.vision__eb_toi_monthly": ["model.dga_data_model.report_eb_cust360__prd_smy"], "model.dga_data_model.vision__fin_dly_audit": [], "model.dga_data_model.vision__fin_dly_balances": [], "model.dga_data_model.vision__fin_dly_headers": [], "model.dga_data_model.vision__fin_dly_mappings": [], "model.dga_data_model.vision__ftp_term_rates": ["model.dga_data_model.fact__atm_cost_performance"], "model.dga_data_model.vision__mgt_expanded": [], "model.dga_data_model.way4__account": ["test.dga_data_model.not_null_way4__account_id.42250b14a9", "test.dga_data_model.unique_way4__account_id.606c041c7e"], "model.dga_data_model.way4__acnt_contract": ["test.dga_data_model.not_null_way4__acnt_contract_id.0c26c772e0", "test.dga_data_model.unique_way4__acnt_contract_id.d8efeb3890"], "model.dga_data_model.way4__cr_limit_log": [], "model.dga_data_model.way4__cs_decision": [], "model.dga_data_model.way4__cs_status_type": [], "model.dga_data_model.int_qlhs__bal_mly_eb": ["model.dga_data_model.int__bal_mly_eb", "test.dga_data_model.not_null_int_qlhs__bal_mly_eb_customer_number.89b884b56a"], "model.dga_data_model.int_vision__bal_dly": ["model.dga_data_model.int_vision__bal_dly_eb", "test.dga_data_model.not_null_int_vision__bal_dly_contract_id.ccfb098323", "test.dga_data_model.not_null_int_vision__bal_dly_customer_number.98f4fd21ca"], "model.dga_data_model.int_vision__bal_dly_eb": ["model.dga_data_model.int_vision__bal_mly_eb", "model.dga_data_model.int_vision__bal_mly_eb"], "model.dga_data_model.int_vision__bal_mly_eb": ["model.dga_data_model.int__bal_mly_eb"], "model.dga_data_model.int__bal_mly_eb": ["model.dga_data_model.report_eb__cst_smy_pivot", "model.dga_data_model.report_eb__cst_smy_pivot", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cust360__casa_trans_agg", "model.dga_data_model.report_eb_cust360__prd_smy", "model.dga_data_model.report_eb_cust360__prd_smy"], "model.dga_data_model.bpm_vhkq__atm_module": ["model.dga_data_model.stg_mart_vhkq__atm_cash_daily"], "model.dga_data_model.bpm_vhkq__kq_module": ["model.dga_data_model.bpm_vhkq__kq_module_unit"], "model.dga_data_model.bpm_vhkq__kq_module_unit": [], "model.dga_data_model.bpm_vhkq__volume_module": [], "model.dga_data_model.int__gl_bal": ["model.dga_data_model.fact__atm_cost_performance", "test.dga_data_model.orc_is_recency_int__gl_bal_etl_date.05b7836690"], "model.dga_data_model.int__gl_txn": ["model.dga_data_model.stg_int__gl_txn_check_date"], "model.dga_data_model.int_cic__bond_outstanding": ["model.dga_data_model.int_cic__outstanding"], "model.dga_data_model.int_cic__cc_lag_12m": ["model.dga_data_model.int_cic__outstanding_lag_12m"], "model.dga_data_model.int_cic__cc_outstanding": ["model.dga_data_model.int_cic__outstanding"], "model.dga_data_model.int_cic__customer_info": ["model.dga_data_model.dim_cic__customer_info"], "model.dga_data_model.int_cic__loan_lag_12m": ["model.dga_data_model.int_cic__outstanding_lag_12m"], "model.dga_data_model.int_cic__loan_outstanding": ["model.dga_data_model.int_cic__outstanding"], "model.dga_data_model.int_cic__outstanding": ["model.dga_data_model.int_cic__outstanding_lag_12m_smy"], "model.dga_data_model.int_cic__outstanding_lag_12m": [], "model.dga_data_model.int_cic__outstanding_lag_12m_smy": [], "model.dga_data_model.int_cic__question_info": ["model.dga_data_model.int_cic__bond_outstanding", "model.dga_data_model.int_cic__cc_lag_12m", "model.dga_data_model.int_cic__cc_outstanding", "model.dga_data_model.int_cic__loan_lag_12m", "model.dga_data_model.int_cic__loan_outstanding", "model.dga_data_model.int_cic__outstanding_lag_12m_smy", "model.dga_data_model.int_cic__tf_outstanding", "model.dga_data_model.int_cic__vamc_outstanding"], "model.dga_data_model.int_cic__tf_outstanding": ["model.dga_data_model.int_cic__outstanding"], "model.dga_data_model.int_cic__vamc_outstanding": ["model.dga_data_model.int_cic__outstanding"], "model.dga_data_model.int_way4__card": ["model.dga_data_model.fct__trans_card", "model.dga_data_model.fct__trans_card_bk", "model.dga_data_model.int__arrangement", "model.dga_data_model.int__arrangement"], "model.dga_data_model.int_way4__client": ["model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg__card_acnt_contract_plus_bk"], "model.dga_data_model.int_way4__contract": ["model.dga_data_model.int_way4__card"], "model.dga_data_model.int__arrangement": ["model.dga_data_model.dim__arrangement"], "model.dga_data_model.int__casa_account": ["model.dga_data_model.dim__casa_account", "model.dga_data_model.dim__casa_account", "model.dga_data_model.fct__agg_casa_txn_monthly", "model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa_test", "model.dga_data_model.int__arrangement", "model.dga_data_model.int__arrangement", "model.dga_data_model.stg__customer_subbranch_no"], "model.dga_data_model.int__customer": ["model.dga_data_model.dim__customer", "model.dga_data_model.int__casa_account", "model.dga_data_model.int__casa_account", "model.dga_data_model.int_way4__client", "model.dga_data_model.int_way4__client", "model.dga_data_model.int_way4__client", "model.dga_data_model.report_eb__cst_smy_pivot", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cust360__casa_trans_agg", "model.dga_data_model.stg__customer_subbranch_no", "model.dga_data_model.stg__customer_subbranch_no", "model.dga_data_model.stg__customer_subbranch_no", "test.dga_data_model.not_null_int__customer_customer_number.aac0557946", "test.dga_data_model.unique_int__customer_customer_number.1cd17835b2"], "model.dga_data_model.int__fd_account": ["model.dga_data_model.int__arrangement", "model.dga_data_model.stg__customer_subbranch_no", "test.dga_data_model.not_null_int__fd_account_account_number.81310a0a6b", "test.dga_data_model.unique_int__fd_account_account_number.603b8c0377"], "model.dga_data_model.int__ln_account": [], "model.dga_data_model.agg_clos_limit_tree_detail": [], "model.dga_data_model.int_los__application_relation": [], "model.dga_data_model.int_los__product": ["model.dga_data_model.int_los__rb", "test.dga_data_model.dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid.c510d4509a"], "model.dga_data_model.int_los__rb": [], "model.dga_data_model.int_los__tat": ["model.dga_data_model.int_los__rb", "model.dga_data_model.int_los__tat_remark", "test.dga_data_model.unique_int_los__tat_rlosroutingdetailsid.4b99cb2e71"], "model.dga_data_model.int_los__tat_remark": ["model.dga_data_model.int_los__rb"], "model.dga_data_model.int_mercury__customer_ckdt": ["model.dga_data_model.report_eb_cashflow__detail", "test.dga_data_model.not_null_int_mercury__customer_ckdt_process_instance_id.a7717a0618", "test.dga_data_model.relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_.9f85424705", "test.dga_data_model.unique_int_mercury__customer_ckdt_process_instance_id.ddc0fb4315"], "model.dga_data_model.int_venus__oppotunity": ["test.dga_data_model.unique_int_venus__oppotunity_opportunity_id.109c0e1c9c"], "model.dga_data_model.dim_bpm__loan_application": [], "model.dga_data_model.fact_bpm__loan_application_activities": [], "model.dga_data_model.fact_bpm__loan_application_decision": [], "model.dga_data_model.dim__atm": ["model.dga_data_model.fact__atm_cost_performance", "model.dga_data_model.fact__atm_daily"], "model.dga_data_model.dim__subbranch": [], "model.dga_data_model.fact__atm_cash_in_cycle": [], "model.dga_data_model.fact__atm_cost_performance": [], "model.dga_data_model.fact__atm_daily": ["model.dga_data_model.fact__atm_cost_performance", "model.dga_data_model.stg_atm__cashout_sum", "model.dga_data_model.stg_atm__update_chu_ky"], "model.dga_data_model.dim_cic__customer_info": ["model.dga_data_model.int_cic__outstanding", "model.dga_data_model.int_cic__outstanding_lag_12m", "model.dga_data_model.int_cic__outstanding_lag_12m_smy"], "model.dga_data_model.dim_clos_application_detail": ["model.dga_data_model.fact_clos_application_activities"], "model.dga_data_model.fact_clos_application_activities": [], "model.dga_data_model.fact_clos_decision": ["model.dga_data_model.agg_clos_limit_tree_detail"], "model.dga_data_model.dim_cms__loan_application": [], "model.dga_data_model.fact_cms__loan_application_activities": [], "model.dga_data_model.dim__arrangement": ["model.dga_data_model.fct__trans_casa_test", "test.dga_data_model.mart__dim_arrangement_unique"], "model.dga_data_model.dim__casa_account": ["test.dga_data_model.mart__dim_casa_account_unique"], "model.dga_data_model.dim__customer": ["model.dga_data_model.int_cic__outstanding", "model.dga_data_model.int_cic__outstanding_lag_12m", "model.dga_data_model.int_cic__outstanding_lag_12m_smy", "model.dga_data_model.report_eb_cashflow__cst_smy", "test.dga_data_model.mart__dim_customer_unique"], "model.dga_data_model.dim__date": ["model.dga_data_model.fct__agg_casa_bal_monthly", "model.dga_data_model.fct__agg_od_bal_monthly", "model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa_test"], "model.dga_data_model.fct__agg_casa_bal_daily": ["model.dga_data_model.fct__agg_casa_bal_monthly"], "model.dga_data_model.fct__agg_casa_txn_daily": ["model.dga_data_model.report_eb_cust360__casa_trans_agg"], "model.dga_data_model.fct__agg_fd_bal_daily": ["model.dga_data_model.fct__agg_fd_bal_monthly", "model.dga_data_model.fct__agg_fd_bal_monthly", "model.dga_data_model.fct__agg_fd_bal_monthly"], "model.dga_data_model.fct__agg_ln_bal_daily": ["model.dga_data_model.fct__agg_ln_bal_monthly", "model.dga_data_model.fct__agg_ln_bal_monthly", "model.dga_data_model.fct__agg_ln_bal_monthly"], "model.dga_data_model.fct__agg_od_bal_daily": ["model.dga_data_model.fct__agg_od_bal_monthly"], "model.dga_data_model.fct__trans_card": [], "model.dga_data_model.fct__trans_casa": ["model.dga_data_model.fct__agg_casa_txn_daily", "model.dga_data_model.fct__trans_casa_mpayroll", "model.dga_data_model.fct__trans_casa_mpayroll"], "model.dga_data_model.fct__trans_casa_mpayroll": [], "model.dga_data_model.fct__trans_casa_test": ["test.dga_data_model.fct__trans_casa_test_sum"], "model.dga_data_model.fct__agg_casa_bal_monthly": [], "model.dga_data_model.fct__agg_casa_txn_monthly": [], "model.dga_data_model.fct__agg_fd_bal_monthly": [], "model.dga_data_model.fct__agg_ln_bal_monthly": [], "model.dga_data_model.fct__agg_od_bal_monthly": [], "model.dga_data_model.report_eb_cashflow__cst_smy": [], "model.dga_data_model.report_eb_cashflow__detail": ["model.dga_data_model.report_eb__cst_smy_pivot", "model.dga_data_model.report_eb__cst_smy_pivot", "model.dga_data_model.report_eb_cashflow__cst_smy"], "model.dga_data_model.report_eb_cust360__casa_trans_agg": [], "model.dga_data_model.report_eb_cust360__prd_smy": [], "model.dga_data_model.report_eb__cst_smy_pivot": ["model.dga_data_model.report_eb__cst_smy_pivot_khsx"], "model.dga_data_model.report_eb__cst_smy_pivot_khsx": [], "model.dga_data_model.fct__agg_card_txn_first_last": [], "model.dga_data_model.fct__trans_card_bk": ["model.dga_data_model.fct__agg_card_txn_first_last"], "model.dga_data_model.fct__acc_opportunity_step": ["test.dga_data_model.unique_fct__acc_opportunity_step_opportunity_id.3a6507fb55"], "model.dga_data_model.stg_bpm_vhkq__atm": ["model.dga_data_model.bpm_vhkq__atm", "model.dga_data_model.stg_mart_vhkq__atm"], "model.dga_data_model.stg_bpm_vhkq__atm_category_tray": ["model.dga_data_model.bpm_vhkq__atm_category_tray"], "model.dga_data_model.stg_bpm_vhkq__atm_detail": ["model.dga_data_model.bpm_vhkq__atm_detail"], "model.dga_data_model.stg_bpm_vhkq__attachment": ["model.dga_data_model.bpm_vhkq__attachment"], "model.dga_data_model.stg_bpm_vhkq__category": ["model.dga_data_model.bpm_vhkq__category"], "model.dga_data_model.stg_bpm_vhkq__delivery": ["model.dga_data_model.bpm_vhkq__delivery"], "model.dga_data_model.stg_bpm_vhkq__doc_no": ["model.dga_data_model.bpm_vhkq__doc_no"], "model.dga_data_model.stg_bpm_vhkq__mail_log": ["model.dga_data_model.bpm_vhkq__mail_log"], "model.dga_data_model.stg_bpm_vhkq__position": ["model.dga_data_model.bpm_vhkq__position"], "model.dga_data_model.stg_bpm_vhkq__process_definition": ["model.dga_data_model.bpm_vhkq__process_definition"], "model.dga_data_model.stg_bpm_vhkq__process_instance": ["model.dga_data_model.bpm_vhkq__process_instance"], "model.dga_data_model.stg_bpm_vhkq__process_instance_his": ["model.dga_data_model.bpm_vhkq__process_instance_his"], "model.dga_data_model.stg_bpm_vhkq__request_atm": ["model.dga_data_model.bpm_vhkq__request_atm"], "model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail": ["model.dga_data_model.bpm_vhkq__request_atm_card_detail"], "model.dga_data_model.stg_bpm_vhkq__request_atm_detail": ["model.dga_data_model.bpm_vhkq__request_atm_detail"], "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control": ["model.dga_data_model.bpm_vhkq__request_atm_tray_control"], "model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail": ["model.dga_data_model.bpm_vhkq__request_atm_tray_detail"], "model.dga_data_model.stg_bpm_vhkq__request_branch": ["model.dga_data_model.bpm_vhkq__request_branch"], "model.dga_data_model.stg_bpm_vhkq__request_branch_detail": ["model.dga_data_model.bpm_vhkq__request_branch_detail"], "model.dga_data_model.stg_bpm_vhkq__skewed_threshold": ["model.dga_data_model.bpm_vhkq__skewed_threshold"], "model.dga_data_model.stg_bpm_vhkq__staff": ["model.dga_data_model.bpm_vhkq__staff", "snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd"], "model.dga_data_model.stg_bpm_vhkq__staff_assignment": ["model.dga_data_model.bpm_vhkq__staff_assignment"], "model.dga_data_model.stg_bpm_vhkq__staff_request_atm": ["model.dga_data_model.bpm_vhkq__staff_request_atm"], "model.dga_data_model.stg_bpm_vhkq__staff_request_branch": ["model.dga_data_model.bpm_vhkq__staff_request_branch"], "model.dga_data_model.stg_bpm_vhkq__staff_transfer_history": ["model.dga_data_model.bpm_vhkq__staff_transfer_history"], "model.dga_data_model.stg_bpm_vhkq__template": ["model.dga_data_model.bpm_vhkq__template"], "model.dga_data_model.stg_bpm_vhkq__user_unit": ["model.dga_data_model.bpm_vhkq__user_unit"], "model.dga_data_model.stg_bpm_vhkq__volume": ["model.dga_data_model.bpm_vhkq__volume"], "model.dga_data_model.stg_bpm_vhkq__volume_detail": ["model.dga_data_model.bpm_vhkq__volume_detail"], "model.dga_data_model.stg_bpm_vhkq__warehouse": ["model.dga_data_model.bpm_vhkq__warehouse"], "model.dga_data_model.stg_bpm_vhkq__warehouse_organization": ["model.dga_data_model.bpm_vhkq__warehouse_organization"], "model.dga_data_model.stg_bpm_vhkq__warehouse_user": ["model.dga_data_model.bpm_vhkq__warehouse_user"], "model.dga_data_model.stg_atm__cashout_sum": ["model.dga_data_model.fact__atm_cash_in_cycle", "model.dga_data_model.fact__atm_cash_in_cycle"], "model.dga_data_model.stg_atm__update_chu_ky": ["model.dga_data_model.fact__atm_cash_in_cycle", "model.dga_data_model.fact__atm_cash_in_cycle"], "model.dga_data_model.stg_mart_vhkq__atm": ["snapshot.dga_data_model.stg_mart__atm_dim"], "model.dga_data_model.stg_mart_vhkq__atm_cash_daily": ["model.dga_data_model.fact__atm_daily"], "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus": ["model.dga_data_model.fact__atm_daily"], "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus": ["model.dga_data_model.fact__atm_daily"], "model.dga_data_model.stg_mart_vhkq__subbranch_dim": ["snapshot.dga_data_model.stg_mart__sub_branch"], "model.dga_data_model.stg_cic__camketngoaibang": ["model.dga_data_model.int_cic__tf_outstanding"], "model.dga_data_model.stg_cic__cicmaster": ["model.dga_data_model.int_cic__question_info", "test.dga_data_model.orc_is_recency_stg_cic__cicmaster_etl_date.1bdcafa3a4"], "model.dga_data_model.stg_cic__customer_info": ["model.dga_data_model.int_cic__customer_info", "test.dga_data_model.orc_is_recency_stg_cic__customer_info_etl_date.e0ab189878"], "model.dga_data_model.stg_cic__daututraiphieu": ["model.dga_data_model.int_cic__bond_outstanding"], "model.dga_data_model.stg_cic__duno12thang": ["model.dga_data_model.int_cic__loan_lag_12m", "model.dga_data_model.int_cic__outstanding_lag_12m_smy", "test.dga_data_model.orc_is_recency_stg_cic__duno12thang_etl_date.dbfc93bf54"], "model.dga_data_model.stg_cic__dunothetd": ["model.dga_data_model.int_cic__cc_outstanding", "test.dga_data_model.orc_is_recency_stg_cic__dunothetd_etl_date.d37908707e"], "model.dga_data_model.stg_cic__dunothetd12thang": ["model.dga_data_model.int_cic__cc_lag_12m", "model.dga_data_model.int_cic__outstanding_lag_12m_smy", "test.dga_data_model.orc_is_recency_stg_cic__dunothetd12thang_etl_date.eebb1d0751"], "model.dga_data_model.stg_cic__novamc": ["model.dga_data_model.int_cic__vamc_outstanding"], "model.dga_data_model.stg_cic__thongtinchung": ["model.dga_data_model.int_cic__question_info", "test.dga_data_model.orc_is_recency_stg_cic__thongtinchung_etl_date.876fedf12a"], "model.dga_data_model.stg_cic__ttduno": ["model.dga_data_model.int_cic__loan_outstanding", "test.dga_data_model.orc_is_recency_stg_cic__ttduno_etl_date.2af45cc849"], "model.dga_data_model.stg__card_acnt_contract_plus": ["model.dga_data_model.fct__trans_card", "model.dga_data_model.int_way4__card", "model.dga_data_model.int_way4__contract"], "model.dga_data_model.stg__customer_connection_pivot": ["model.dga_data_model.int__customer"], "model.dga_data_model.stg__customer_subbranch_no": [], "model.dga_data_model.stg_dwh__crtb_odtier": ["model.dga_data_model.fct__agg_od_bal_daily"], "model.dga_data_model.stg_dwh__csdm_branch": ["model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa", "model.dga_data_model.int__fd_account"], "model.dga_data_model.stg_dwh__csdm_transaction_code": ["model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa_test"], "model.dga_data_model.stg_dwh__cydm_rate_history": ["model.dga_data_model.int__fd_account", "model.dga_data_model.int__ln_account", "model.dga_data_model.int__ln_account", "model.dga_data_model.int_cic__bond_outstanding", "model.dga_data_model.int_cic__cc_outstanding", "model.dga_data_model.int_cic__loan_outstanding", "model.dga_data_model.int_cic__tf_outstanding", "model.dga_data_model.int_cic__vamc_outstanding"], "model.dga_data_model.stg_dwh__dddm_product": ["model.dga_data_model.fct__trans_casa"], "model.dga_data_model.stg_dwh__ddft_master": [], "model.dga_data_model.stg_dwh__demanddeposit_transaction001": ["model.dga_data_model.fct__trans_casa", "model.dga_data_model.stg__ddft_transaction_map_ibmb"], "model.dga_data_model.stg_dwh__fddm_product": ["model.dga_data_model.int__fd_account"], "model.dga_data_model.stg_dwh__lnft_master": ["model.dga_data_model.fct__agg_ln_bal_daily"], "model.dga_data_model.stg_dwh__loan_master001": ["model.dga_data_model.fct__agg_ln_bal_daily", "model.dga_data_model.int__ln_account"], "model.dga_data_model.stg_int__gl_txn": ["model.dga_data_model.int__gl_txn", "model.dga_data_model.stg_int__gl_txn_check_date", "model.dga_data_model.stg_int__gl_txn_demanddeposit", "model.dga_data_model.stg_int__gl_txn_fixeddeposit", "model.dga_data_model.stg_int__gl_txn_loan"], "model.dga_data_model.stg_int__gl_txn_check_date": [], "model.dga_data_model.stg_int__gl_txn_demanddeposit": ["model.dga_data_model.int__gl_txn"], "model.dga_data_model.stg_int__gl_txn_fixeddeposit": ["model.dga_data_model.int__gl_txn"], "model.dga_data_model.stg_int__gl_txn_loan": ["model.dga_data_model.int__gl_txn"], "model.dga_data_model.stg_int__gl_txn_nhnn_tctd": ["model.dga_data_model.int__gl_txn"], "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung": ["model.dga_data_model.int__gl_txn"], "model.dga_data_model.stg_landing__demanddeposit_transaction001": ["model.dga_data_model.stg_int__gl_txn_demanddeposit"], "model.dga_data_model.stg_landing__fixeddeposit_transaction001": ["model.dga_data_model.stg_int__gl_txn_fixeddeposit"], "model.dga_data_model.stg_landing__gl_account_master": ["model.dga_data_model.int__gl_bal"], "model.dga_data_model.stg_landing__gl_hist": ["model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_int__gl_txn", "model.dga_data_model.stg_int__gl_txn_nhnn_tctd", "model.dga_data_model.stg_int__gl_txn_update_gl_doi_ung", "model.dga_data_model.stg_landing__demanddeposit_transaction001", "model.dga_data_model.stg_landing__fixeddeposit_transaction001", "model.dga_data_model.stg_landing__loan_transaction001"], "model.dga_data_model.stg_landing__loan_transaction001": ["model.dga_data_model.stg_int__gl_txn_loan"], "model.dga_data_model.stg_landing__bc_user_info": ["model.dga_data_model.int__arrangement", "test.dga_data_model.orc_is_recency_stg_landing__bc_user_info_etl_date.2dc6d694c8"], "model.dga_data_model.stg_landing__card_acnt_contract": ["model.dga_data_model.int_way4__client", "model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg__card_acnt_contract_plus_bk", "model.dga_data_model.stg__card_acnt_contract_plus_bk", "test.dga_data_model.orc_is_recency_stg_landing__card_acnt_contract_etl_date.5369951f37"], "model.dga_data_model.stg_landing__card_add_data": ["model.dga_data_model.int_way4__card", "test.dga_data_model.orc_is_recency_stg_landing__card_add_data_etl_date.942f1931e9"], "model.dga_data_model.stg_landing__card_appl_product": ["model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg__card_acnt_contract_plus_bk", "test.dga_data_model.orc_is_recency_stg_landing__card_appl_product_etl_date.f3c5a7deb6"], "model.dga_data_model.stg_landing__card_client": ["model.dga_data_model.int_way4__client", "test.dga_data_model.orc_is_recency_stg_landing__card_client_etl_date.8d85cbdf16"], "model.dga_data_model.stg_landing__card_contr_status": ["model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg__card_acnt_contract_plus_bk", "test.dga_data_model.orc_is_recency_stg_landing__card_contr_status_etl_date.6a4f16b203"], "model.dga_data_model.stg_landing__card_currency": ["model.dga_data_model.fct__trans_card", "model.dga_data_model.fct__trans_card_bk"], "model.dga_data_model.stg_landing__card_doc": ["model.dga_data_model.fct__trans_card", "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus", "model.dga_data_model.stg_mart_vhkq__atm_cash_out_cus_sus"], "model.dga_data_model.stg_landing__card_f_i": ["model.dga_data_model.int_way4__card", "test.dga_data_model.orc_is_recency_stg_landing__card_f_i_etl_date.672b25084d"], "model.dga_data_model.stg_landing__card_m_transaction": ["model.dga_data_model.fct__trans_card"], "model.dga_data_model.stg_landing__customer_address": ["model.dga_data_model.int__customer", "test.dga_data_model.orc_is_recency_stg_landing__customer_address_etl_date.eb7993f041"], "model.dga_data_model.stg_landing__customer_connection": ["model.dga_data_model.stg__customer_connection_pivot"], "model.dga_data_model.stg_landing__customer_job_infomation": ["model.dga_data_model.int__customer", "test.dga_data_model.orc_is_recency_stg_landing__customer_job_infomation_etl_date.ffc5a514d9"], "model.dga_data_model.stg_landing__customer_marital_status": ["model.dga_data_model.int__customer", "test.dga_data_model.orc_is_recency_stg_landing__customer_marital_status_etl_date.8162991b78"], "model.dga_data_model.stg_landing__customer_master001": ["model.dga_data_model.int__customer", "model.dga_data_model.int__customer", "test.dga_data_model.orc_is_recency_stg_landing__customer_master001_etl_date.99881945be"], "model.dga_data_model.stg_landing__customer_master002": ["model.dga_data_model.fct__agg_ln_bal_daily", "model.dga_data_model.int__customer", "test.dga_data_model.orc_is_recency_stg_landing__customer_master002_etl_date.1dcd6f7517"], "model.dga_data_model.stg_landing__demanddeposit_master001": ["model.dga_data_model.fct__agg_casa_bal_daily", "model.dga_data_model.int__casa_account", "model.dga_data_model.int__customer", "model.dga_data_model.int_way4__client", "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master001_etl_date.7948d90a59"], "model.dga_data_model.stg_landing__demanddeposit_master002": ["model.dga_data_model.fct__agg_casa_bal_daily", "model.dga_data_model.fct__agg_casa_txn_monthly", "model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa_test", "model.dga_data_model.int__casa_account", "model.dga_data_model.stg__ddft_transaction_map_ibmb", "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master002_etl_date.b33614734e"], "model.dga_data_model.stg_landing__df_card_channel": ["model.dga_data_model.fct__trans_card", "model.dga_data_model.fct__trans_card", "model.dga_data_model.fct__trans_card_bk", "model.dga_data_model.fct__trans_card_bk", "model.dga_data_model.stg__card_acnt_contract_plus", "model.dga_data_model.stg__card_acnt_contract_plus_bk"], "model.dga_data_model.stg_landing__df_card_sic": [], "model.dga_data_model.stg_landing__df_casa_channel_trn_type": ["model.dga_data_model.fct__agg_casa_txn_monthly", "model.dga_data_model.fct__trans_casa", "model.dga_data_model.fct__trans_casa_test"], "model.dga_data_model.stg_landing__df_customer_sts_type": ["model.dga_data_model.int__customer"], "model.dga_data_model.stg_landing__fixeddeposit_master001": ["model.dga_data_model.int__fd_account", "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.97ff66932f"], "model.dga_data_model.stg_landing__fixeddeposit_master002": ["model.dga_data_model.int__arrangement", "model.dga_data_model.int__fd_account", "model.dga_data_model.int__fd_account", "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.99deaed4d2"], "model.dga_data_model.stg_landing__fixeddeposit_master003": ["model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.fct__agg_fd_bal_daily", "model.dga_data_model.int__fd_account", "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.8c71b1b163"], "model.dga_data_model.stg_landing__jupiter_account_register_hist": ["model.dga_data_model.int__casa_account"], "model.dga_data_model.stg_landing__jupiter_cif_register_history": ["model.dga_data_model.int__casa_account", "model.dga_data_model.int__customer", "test.dga_data_model.orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date.61793b6aea"], "model.dga_data_model.stg_landing__jupiter_customer_temp": ["model.dga_data_model.int__casa_account"], "model.dga_data_model.stg_landing__loan_application_facility": ["model.dga_data_model.int__ln_account", "test.dga_data_model.orc_is_recency_stg_landing__loan_application_facility_etl_date.c67bbe90a8"], "model.dga_data_model.stg_landing__loan_master001_2020001_2021212": ["model.dga_data_model.fct__agg_ln_bal_daily"], "model.dga_data_model.stg_landing__loan_master002": ["model.dga_data_model.int__arrangement", "model.dga_data_model.int__customer", "model.dga_data_model.int__ln_account", "test.dga_data_model.orc_is_recency_stg_landing__loan_master002_etl_date.1bc920035b"], "model.dga_data_model.stg_landing__overdraft_tier001": ["model.dga_data_model.int__casa_account", "test.dga_data_model.orc_is_recency_stg_landing__overdraft_tier001_etl_date.9945cfd653"], "model.dga_data_model.stg_landing__vw_df_customer_active_latest": ["model.dga_data_model.int__customer"], "model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all": ["model.dga_data_model.fct__agg_casa_txn_monthly"], "model.dga_data_model.stg_landing__vw_df_overdraft_tier002_union_all": [], "model.dga_data_model.stg_landing__way4_trans_type": ["model.dga_data_model.fct__trans_card", "model.dga_data_model.fct__trans_card_bk"], "model.dga_data_model.stg_landing__vision_currency_rates_daily": ["model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.stg_landing__vision_fin_dly_balances": ["model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.stg_landing__vision_fin_dly_headers": ["model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.stg_landing__vision_fin_dly_mappings": ["model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.stg_landing__vision_mgt_expanded": ["model.dga_data_model.int_vision__bal_dly", "model.dga_data_model.int_vision__bal_dly"], "model.dga_data_model.stg_los__addoncarddetails": ["model.dga_data_model.los__addoncarddetails"], "model.dga_data_model.stg_los__agents": ["model.dga_data_model.los__agents"], "model.dga_data_model.stg_los__agent_entity_details": ["model.dga_data_model.los__agent_entity_details"], "model.dga_data_model.stg_los__applicant": ["model.dga_data_model.los__applicant"], "model.dga_data_model.stg_los__applicantcontact": ["model.dga_data_model.los__applicantcontact"], "model.dga_data_model.stg_los__applicantcontactphnemllist": ["model.dga_data_model.los__applicantcontactphnemllist"], "model.dga_data_model.stg_los__applicantidentitydetail": ["model.dga_data_model.los__applicantidentitydetail"], "model.dga_data_model.stg_los__applicantmiscdetail": ["model.dga_data_model.los__applicantmiscdetail"], "model.dga_data_model.stg_los__applicationdetails": ["model.dga_data_model.los__applicationdetails"], "model.dga_data_model.stg_los__appraisal_custom": ["model.dga_data_model.los__appraisal_custom"], "model.dga_data_model.stg_los__areas": ["model.dga_data_model.los__areas"], "model.dga_data_model.stg_los__bizcenter": ["model.dga_data_model.los__bizcenter"], "model.dga_data_model.stg_los__categories": ["model.dga_data_model.los__categories"], "model.dga_data_model.stg_los__category_lang": ["model.dga_data_model.los__category_lang"], "model.dga_data_model.stg_los__closroutingdetails": ["model.dga_data_model.los__closroutingdetails"], "model.dga_data_model.stg_los__collateralgeneraldetails": ["model.dga_data_model.los__collateralgeneraldetails"], "model.dga_data_model.stg_los__collaterallinkage": ["model.dga_data_model.los__collaterallinkage"], "model.dga_data_model.stg_los__corpappentitydetails": ["model.dga_data_model.los__corpappentitydetails"], "model.dga_data_model.stg_los__corpapplicationdetails": ["model.dga_data_model.fact_clos_application_activities", "model.dga_data_model.los__corpapplicationdetails"], "model.dga_data_model.stg_los__corpapplimitdetails": ["model.dga_data_model.los__corpapplimitdetails"], "model.dga_data_model.stg_los__corpdecisioncode": ["model.dga_data_model.los__corpdecisioncode"], "model.dga_data_model.stg_los__creditcardproduct": ["model.dga_data_model.los__creditcardproduct"], "model.dga_data_model.stg_los__creditscoringdetails": ["model.dga_data_model.los__creditscoringdetails"], "model.dga_data_model.stg_los__custidentitydetail": ["model.dga_data_model.los__custidentitydetail"], "model.dga_data_model.stg_los__customerdetail": ["model.dga_data_model.los__customerdetail"], "model.dga_data_model.stg_los__decision": ["model.dga_data_model.los__decision"], "model.dga_data_model.stg_los__loanproductdetails": ["model.dga_data_model.los__loanproductdetails"], "model.dga_data_model.stg_los__losprocessentity": ["model.dga_data_model.los__losprocessentity"], "model.dga_data_model.stg_los__opportunities": ["model.dga_data_model.los__opportunities"], "model.dga_data_model.stg_los__oscorpcustomerdetail": ["model.dga_data_model.los__oscorpcustomerdetail"], "model.dga_data_model.stg_los__oscorpdocumentdetail": ["model.dga_data_model.los__oscorpdocumentdetail"], "model.dga_data_model.stg_los__oslineproductdetails": ["model.dga_data_model.los__oslineproductdetails"], "model.dga_data_model.stg_los__osproduct": ["model.dga_data_model.los__osproduct"], "model.dga_data_model.stg_los__parentapplication": ["model.dga_data_model.los__parentapplication"], "model.dga_data_model.stg_los__person": ["model.dga_data_model.los__person"], "model.dga_data_model.stg_los__rlosroutingdetails": ["model.dga_data_model.los__rlosroutingdetails"], "model.dga_data_model.stg_los__rlosworknotes": ["model.dga_data_model.los__rlosworknotes"], "model.dga_data_model.stg_los__rollback": ["model.dga_data_model.los__rollback"], "model.dga_data_model.stg_los__srmgroups": ["model.dga_data_model.los__srmgroups"], "model.dga_data_model.stg_los__transactiondepartment": ["model.dga_data_model.los__transactiondepartment"], "model.dga_data_model.stg_los__useractiontray": ["model.dga_data_model.fact_clos_application_activities", "model.dga_data_model.los__useractiontray"], "model.dga_data_model.stg_los__users": ["model.dga_data_model.los__users"], "model.dga_data_model.stg_los__user_groups": ["model.dga_data_model.los__user_groups"], "model.dga_data_model.stg_los__transactiondepartmentinfo": ["model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__addoncarddetails": ["model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__address": ["model.dga_data_model.stg__los_user"], "model.dga_data_model.stg_rb_los__addressdetail": ["model.dga_data_model.int_los__application_relation"], "model.dga_data_model.stg_rb_los__agents": ["model.dga_data_model.stg__los_user"], "model.dga_data_model.stg_rb_los__applicant": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_rb_los__applicantaddress": ["model.dga_data_model.int_los__application_relation"], "model.dga_data_model.stg_rb_los__applicantcontact": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation"], "model.dga_data_model.stg_rb_los__applicantcontactphnemllist": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation"], "model.dga_data_model.stg_rb_los__applicantidentitydetail": [], "model.dga_data_model.stg_rb_los__applicationdetails": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_rb_los__areas": ["model.dga_data_model.stg_los__transactiondepartmentinfo"], "model.dga_data_model.stg_rb_los__bizcenter": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.stg__los_user"], "model.dga_data_model.stg_rb_los__categories": ["model.dga_data_model.stg__los_category"], "model.dga_data_model.stg_rb_los__category_lang": ["model.dga_data_model.stg__los_category"], "model.dga_data_model.stg_rb_los__creditcardproduct": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__decision": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__loanproductdetails": ["model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__losprocessentity": ["model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_rb_los__opportunities": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_rb_los__oslineproductdetails": ["model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__osproduct": ["model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__parentapplication": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_rb_los__person": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.stg__los_user"], "model.dga_data_model.stg_rb_los__rlosroutingdetails": ["model.dga_data_model.int_los__product", "model.dga_data_model.int_los__rb", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_rb_los__rlosworknotes": ["model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat_remark"], "model.dga_data_model.stg_rb_los__rollback": [], "model.dga_data_model.stg_rb_los__slbccodemapping": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product"], "model.dga_data_model.stg_rb_los__syncapplicantaddressmap": ["model.dga_data_model.int_los__application_relation"], "model.dga_data_model.stg_rb_los__transactiondepartment": ["model.dga_data_model.stg_los__transactiondepartmentinfo"], "model.dga_data_model.stg_rb_los__users": ["model.dga_data_model.stg__los_user"], "model.dga_data_model.stg__los_category": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg__los_user": ["model.dga_data_model.int_los__application_relation", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__product", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat", "model.dga_data_model.int_los__tat"], "model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income": ["model.dga_data_model.mercury__tbl_applicant_enterprise_income", "test.dga_data_model.not_null_stg_mercury__tbl_applicant_enterprise_income_id.1112240430", "test.dga_data_model.unique_stg_mercury__tbl_applicant_enterprise_income_id.4dc6760cd3"], "model.dga_data_model.stg_mercury__tbl_css_eb_applicant": ["model.dga_data_model.mercury__tbl_css_eb_applicant", "test.dga_data_model.not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.fdf155c0bf"], "model.dga_data_model.stg_mercury__tbl_doc_detail": ["model.dga_data_model.stg_mercury__tbl_doc_detail_clean", "test.dga_data_model.not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.b4c30eb3a4"], "model.dga_data_model.stg_mercury__tbl_doc_detail_clean": ["model.dga_data_model.mercury__tbl_doc_detail"], "model.dga_data_model.stg_mercury__tbl_doc_need_list": ["model.dga_data_model.mercury__tbl_doc_need_list", "test.dga_data_model.not_null_stg_mercury__tbl_doc_need_list_process_instance_id.0c46006a7b"], "model.dga_data_model.stg_mercury__tbl_doc_no_hist": ["model.dga_data_model.mercury__tbl_doc_no_hist", "test.dga_data_model.not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.9ffee0b510"], "model.dga_data_model.stg_mercury__tbl_eb_applicant": ["model.dga_data_model.mercury__tbl_eb_applicant", "test.dga_data_model.not_null_stg_mercury__tbl_eb_applicant_eb_application_id.15581b5933"], "model.dga_data_model.stg_mercury__tbl_eb_application": ["model.dga_data_model.mercury__tbl_eb_application", "test.dga_data_model.not_null_stg_mercury__tbl_eb_application_id.313e1bda9c", "test.dga_data_model.unique_stg_mercury__tbl_eb_application_id.f4697dc688"], "model.dga_data_model.stg__card_acnt_contract_plus_bk": ["model.dga_data_model.fct__trans_card_bk"], "model.dga_data_model.stg__ddft_transaction_map_ibmb": ["model.dga_data_model.fct__trans_casa_test", "test.dga_data_model.stg__ddft_transaction_test"], "model.dga_data_model.test_los__categories_run": [], "model.dga_data_model.test_los__corpapplimitdetails_run": [], "model.dga_data_model.test_los__opportunities_run": [], "model.dga_data_model.test_stg_los__areas_run": [], "model.dga_data_model.stg_tms__tbldailyperformance": ["model.dga_data_model.tms__tbl_daily_performance"], "model.dga_data_model.stg_tms__tblevent": ["model.dga_data_model.tms__tbl_event"], "model.dga_data_model.stg_tms__tbleventhistory": ["model.dga_data_model.tms__tbl_event_history"], "model.dga_data_model.stg_tms__tblincident": ["model.dga_data_model.tms__tbl_incident"], "model.dga_data_model.stg_tms__tblincidenthistory": ["model.dga_data_model.tms__tbl_incident_history"], "model.dga_data_model.stg_landing__sppl_m_account_planning": ["model.dga_data_model.fct__acc_opportunity_step"], "model.dga_data_model.stg_landing__sppl_m_activities": ["model.dga_data_model.fct__acc_opportunity_step", "model.dga_data_model.fct__acc_opportunity_step"], "model.dga_data_model.stg_landing__sppl_m_branch": ["model.dga_data_model.int_venus__oppotunity", "model.dga_data_model.int_venus__oppotunity", "model.dga_data_model.int_venus__oppotunity", "model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_landing__sppl_m_campaign": ["model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_landing__sppl_m_customer": ["model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_landing__sppl_m_flow_activities_status": ["model.dga_data_model.fct__acc_opportunity_step", "model.dga_data_model.fct__acc_opportunity_step"], "model.dga_data_model.stg_landing__sppl_m_lead": ["model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_landing__sppl_m_selling_opportunity": ["model.dga_data_model.fct__acc_opportunity_step", "model.dga_data_model.fct__acc_opportunity_step", "model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_landing__sppl_m_selling_status": ["model.dga_data_model.fct__acc_opportunity_step", "model.dga_data_model.fct__acc_opportunity_step"], "model.dga_data_model.stg_landing__sppl_m_team_group": ["model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_landing__sppl_m_user": ["model.dga_data_model.int_venus__oppotunity", "model.dga_data_model.int_venus__oppotunity"], "model.dga_data_model.stg_vision_tmp__contracts": ["model.dga_data_model.vision__contracts"], "model.dga_data_model.stg_vision_tmp__customers": ["model.dga_data_model.vision__customers"], "model.dga_data_model.stg_vision_tmp__fin_dly_balances": ["model.dga_data_model.vision__fin_dly_balances"], "model.dga_data_model.stg_vision_tmp__fin_dly_headers": ["model.dga_data_model.vision__fin_dly_headers"], "model.dga_data_model.stg_vision_tmp__fin_dly_mappings": ["model.dga_data_model.vision__fin_dly_mappings"], "model.dga_data_model.stg_vision__ftp_term_rates": ["model.dga_data_model.vision__ftp_term_rates"], "model.dga_data_model.stg_way4__acnt_contract": ["model.dga_data_model.way4__acnt_contract", "test.dga_data_model.not_null_stg_way4__acnt_contract_id.c5a7413b7e", "test.dga_data_model.unique_stg_way4__acnt_contract_id.6d1e1f65a1"], "model.dga_data_model.stg_way4__cr_limit_log": ["model.dga_data_model.way4__cr_limit_log"], "snapshot.dga_data_model.stg_bpm_vhkq__staff_tsd": ["model.dga_data_model.bpm_vhkq__staff_tsd"], "snapshot.dga_data_model.stg_mart__atm_dim": ["model.dga_data_model.dim__atm", "model.dga_data_model.dim__atm"], "snapshot.dga_data_model.stg_mart__sub_branch": ["model.dga_data_model.dim__subbranch"], "test.dga_data_model.fct__trans_casa_test_sum": [], "test.dga_data_model.stg__ddft_transaction_test": [], "test.dga_data_model.mart__dim_arrangement_unique": [], "test.dga_data_model.mart__dim_casa_account_unique": [], "test.dga_data_model.mart__dim_customer_unique": [], "operation.dga_data_model.dga_data_model-on-run-end-0": [], "test.dga_data_model.unique_combination_of_columns_dwh__demanddeposit_master003_etl_date__account_no_sk__etl_date.4761489701": [], "test.dga_data_model.unique_combination_of_columns_dwh__fixeddeposit_master003_etl_date__account_sk__etl_date.744a049d76": [], "test.dga_data_model.unique_combination_of_columns_dwh__loan_master003_etl_date__account_no_sk__etl_date.caecc3fb45": [], "test.dga_data_model.not_null_imp_topup_bscore_cif.fe574724d3": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_imp_topup_bscore_import_month__cif.6fee4edf88": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_cust_info_cuif001__etl_date.ce6b98aa4f": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_casa_cifno__etl_date.0ebf942566": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_fd_cifno__etl_date.858f988552": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_in_cifno__etl_date.8158943d76": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_landing_hist__ews_rb_thruput_out_cifno__etl_date.8a73bd2fef": [], "test.dga_data_model.dbt_utils_recency_los__addoncarddetails_day__tmdate__1.bc4d5c6a33": [], "test.dga_data_model.dbt_utils_recency_los__applicationdetails_day__tmdate__1.da6d96a64a": [], "test.dga_data_model.dbt_utils_recency_los__decision_day__tmdate__1.146f2ebedd": [], "test.dga_data_model.dbt_utils_recency_los__loanproductdetails_day__tmdate__1.458576e248": [], "test.dga_data_model.dbt_utils_recency_los__opportunities_day__tmdate__1.0df0f3f09e": [], "test.dga_data_model.dbt_utils_recency_los__parentapplication_day__tmdate__1.2894f8d3ff": [], "test.dga_data_model.dbt_utils_recency_los__rlosroutingdetails_day__tmdate__1.3f5502f1a8": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_active_df_yearmonth__cifno.193e15dda9": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_qlhs__customer_product_holding_df_yearmonth__cifno.effa5cebe5": [], "test.dga_data_model.unique_way4__account_id.606c041c7e": [], "test.dga_data_model.not_null_way4__account_id.42250b14a9": [], "test.dga_data_model.unique_way4__acnt_contract_id.d8efeb3890": [], "test.dga_data_model.not_null_way4__acnt_contract_id.0c26c772e0": [], "test.dga_data_model.not_null_int_vision__bal_dly_contract_id.ccfb098323": [], "test.dga_data_model.not_null_int_vision__bal_dly_customer_number.98f4fd21ca": [], "test.dga_data_model.not_null_int_qlhs__bal_mly_eb_customer_number.89b884b56a": [], "test.dga_data_model.orc_is_recency_int__gl_bal_etl_date.05b7836690": [], "test.dga_data_model.unique_int__customer_customer_number.1cd17835b2": [], "test.dga_data_model.not_null_int__customer_customer_number.aac0557946": [], "test.dga_data_model.unique_int__fd_account_account_number.603b8c0377": [], "test.dga_data_model.not_null_int__fd_account_account_number.81310a0a6b": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_int_los__product_loanproductdetailsid__addoncarddetailsid__applicationdetailsid.c510d4509a": [], "test.dga_data_model.unique_int_los__tat_rlosroutingdetailsid.4b99cb2e71": [], "test.dga_data_model.unique_int_mercury__customer_ckdt_process_instance_id.ddc0fb4315": [], "test.dga_data_model.not_null_int_mercury__customer_ckdt_process_instance_id.a7717a0618": [], "test.dga_data_model.relationships_int_mercury__customer_ckdt_process_instance_id__process_instance_id__ref_mercury__tbl_doc_need_list_.9f85424705": [], "test.dga_data_model.unique_int_venus__oppotunity_opportunity_id.109c0e1c9c": [], "test.dga_data_model.dbt_utils_unique_combination_of_columns_report__list_approved_customer_by_df_001_created_month__customer_number.d3e2d5794d": [], "test.dga_data_model.unique_fct__acc_opportunity_step_opportunity_id.3a6507fb55": [], "test.dga_data_model.orc_is_recency_stg_cic__cicmaster_etl_date.1bdcafa3a4": [], "test.dga_data_model.orc_is_recency_stg_cic__customer_info_etl_date.e0ab189878": [], "test.dga_data_model.orc_is_recency_stg_cic__duno12thang_etl_date.dbfc93bf54": [], "test.dga_data_model.orc_is_recency_stg_cic__dunothetd_etl_date.d37908707e": [], "test.dga_data_model.orc_is_recency_stg_cic__dunothetd12thang_etl_date.eebb1d0751": [], "test.dga_data_model.orc_is_recency_stg_cic__thongtinchung_etl_date.876fedf12a": [], "test.dga_data_model.orc_is_recency_stg_cic__ttduno_etl_date.2af45cc849": [], "test.dga_data_model.orc_is_recency_stg_landing__bc_user_info_etl_date.2dc6d694c8": [], "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master003_etl_date.8c71b1b163": [], "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master002_etl_date.99deaed4d2": [], "test.dga_data_model.orc_is_recency_stg_landing__fixeddeposit_master001_etl_date.97ff66932f": [], "test.dga_data_model.orc_is_recency_stg_landing__card_acnt_contract_etl_date.5369951f37": [], "test.dga_data_model.orc_is_recency_stg_landing__card_add_data_etl_date.942f1931e9": [], "test.dga_data_model.orc_is_recency_stg_landing__card_appl_product_etl_date.f3c5a7deb6": [], "test.dga_data_model.orc_is_recency_stg_landing__card_client_etl_date.8d85cbdf16": [], "test.dga_data_model.orc_is_recency_stg_landing__card_contr_status_etl_date.6a4f16b203": [], "test.dga_data_model.orc_is_recency_stg_landing__card_f_i_etl_date.672b25084d": [], "test.dga_data_model.orc_is_recency_stg_landing__customer_address_etl_date.eb7993f041": [], "test.dga_data_model.orc_is_recency_stg_landing__customer_job_infomation_etl_date.ffc5a514d9": [], "test.dga_data_model.orc_is_recency_stg_landing__customer_marital_status_etl_date.8162991b78": [], "test.dga_data_model.orc_is_recency_stg_landing__customer_master001_etl_date.99881945be": [], "test.dga_data_model.orc_is_recency_stg_landing__customer_master002_etl_date.1dcd6f7517": [], "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master001_etl_date.7948d90a59": [], "test.dga_data_model.orc_is_recency_stg_landing__demanddeposit_master002_etl_date.b33614734e": [], "test.dga_data_model.orc_is_recency_stg_landing__jupiter_cif_register_history_etl_date.61793b6aea": [], "test.dga_data_model.orc_is_recency_stg_landing__loan_application_facility_etl_date.c67bbe90a8": [], "test.dga_data_model.orc_is_recency_stg_landing__loan_master002_etl_date.1bc920035b": [], "test.dga_data_model.orc_is_recency_stg_landing__overdraft_tier001_etl_date.9945cfd653": [], "test.dga_data_model.not_null_stg_mercury__tbl_css_eb_applicant_eb_application_id.fdf155c0bf": [], "test.dga_data_model.not_null_stg_mercury__tbl_doc_detail_doc_need_list_id.b4c30eb3a4": [], "test.dga_data_model.not_null_stg_mercury__tbl_doc_need_list_process_instance_id.0c46006a7b": [], "test.dga_data_model.not_null_stg_mercury__tbl_doc_no_hist_doc_need_list_id.9ffee0b510": [], "test.dga_data_model.not_null_stg_mercury__tbl_eb_applicant_eb_application_id.15581b5933": [], "test.dga_data_model.unique_stg_mercury__tbl_eb_application_id.f4697dc688": [], "test.dga_data_model.not_null_stg_mercury__tbl_eb_application_id.313e1bda9c": [], "test.dga_data_model.unique_stg_mercury__tbl_applicant_enterprise_income_id.4dc6760cd3": [], "test.dga_data_model.not_null_stg_mercury__tbl_applicant_enterprise_income_id.1112240430": [], "test.dga_data_model.unique_stg_way4__acnt_contract_id.6d1e1f65a1": [], "test.dga_data_model.not_null_stg_way4__acnt_contract_id.c5a7413b7e": [], "test.dga_data_model.unique_stg_cr_limit_log_id.72e579340e": [], "test.dga_data_model.not_null_stg_cr_limit_log_id.65f3470229": [], "test.dga_data_model.source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date.1cf303bcbd": [], "test.dga_data_model.source_is_recency_dwh_ddft_master_etl_date.58b2088fa3": [], "test.dga_data_model.source_is_recency_dwh_ddft_transaction_trn_date.b05d64f57c": [], "test.dga_data_model.source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date.6f8ee49248": [], "test.dga_data_model.source_is_recency_dwh_fdft_master_etl_date.9ed31cec99": [], "test.dga_data_model.source_is_recency_dwh_fdft_transaction_trn_date.05214279e7": [], "test.dga_data_model.source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date.f516a10e24": [], "test.dga_data_model.source_is_recency_dwh_lnft_master_etl_date.7d978c35de": [], "test.dga_data_model.source_is_recency_dwh_lnft_transaction_tran_date.396f7d9c7e": [], "test.dga_data_model.source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode.281de86ed2": [], "test.dga_data_model.source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode.7aa21fe19d": [], "test.dga_data_model.source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_.22fea21b94": [], "test.dga_data_model.source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_.08dc2fc82f": [], "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno.a1d6695c4f": [], "test.dga_data_model.source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_.f4966ea198": [], "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno.d645917cc2": [], "source.dga_data_model.dwh.ddft_master": ["model.dga_data_model.dwh__demanddeposit_master003", "test.dga_data_model.source_is_recency_dwh_ddft_master_etl_date.58b2088fa3", "test.dga_data_model.source_unique_combination_of_columns_dwh_ddft_master_etl_date__account_no_sk__etl_date.1cf303bcbd"], "source.dga_data_model.dwh.ddft_transaction": ["model.dga_data_model.dwh__demanddeposit_transaction001", "test.dga_data_model.source_is_recency_dwh_ddft_transaction_trn_date.b05d64f57c"], "source.dga_data_model.dwh.fdft_master": ["model.dga_data_model.dwh__fixeddeposit_master003", "test.dga_data_model.source_is_recency_dwh_fdft_master_etl_date.9ed31cec99", "test.dga_data_model.source_unique_combination_of_columns_dwh_fdft_master_etl_date__account_sk__etl_date.6f8ee49248"], "source.dga_data_model.dwh.fdft_transaction": ["model.dga_data_model.dwh__fixeddeposit_transaction001", "test.dga_data_model.source_is_recency_dwh_fdft_transaction_trn_date.05214279e7"], "source.dga_data_model.dwh.lnft_master": ["model.dga_data_model.dwh__loan_master003", "test.dga_data_model.source_is_recency_dwh_lnft_master_etl_date.7d978c35de", "test.dga_data_model.source_unique_combination_of_columns_dwh_lnft_master_etl_date__account_no_sk__etl_date.f516a10e24"], "source.dga_data_model.dwh.lnft_transaction": ["model.dga_data_model.dwh__loan_transaction001", "test.dga_data_model.source_is_recency_dwh_lnft_transaction_tran_date.396f7d9c7e"], "source.dga_data_model.dwh.ccl_pln": ["model.dga_data_model.dwh__ccl_pln"], "source.dga_data_model.dwh.glft_his_transaction": ["model.dga_data_model.dwh__glft_his_transaction"], "source.dga_data_model.dga_ingest.lc_cc_mast": ["model.dga_data_model.landing__lc_cc_mast"], "source.dga_data_model.base.dbt_test_materialized": [], "source.dga_data_model.dga.thuvh3_eb_dm_luyke": ["model.dga_data_model.imp__eb_portfolio_mtd", "model.dga_data_model.report_eb_cashflow__detail", "model.dga_data_model.report_eb_cust360__casa_trans_agg", "test.dga_data_model.source_unique_combination_of_columns_dga_thuvh3_eb_dm_luyke_yearmonth__cif__taxcode.281de86ed2"], "source.dga_data_model.dga.anlt4_eb_txn_processed": ["model.dga_data_model.imp__eb_txn_processed", "model.dga_data_model.report_eb_cashflow__detail"], "source.dga_data_model.dga.tunglt_eb_acct_khsx": ["model.dga_data_model.report_eb__cst_smy_pivot_khsx", "test.dga_data_model.source_unique_combination_of_columns_dga_tunglt_eb_acct_khsx_year__cifno__taxcode.7aa21fe19d"], "source.dga_data_model.dga.tunglt_eb_health_financing": ["model.dga_data_model.report_eb_cashflow__cst_smy"], "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_dim_application_bpm @DGA_READ_BULANDING_DBL": ["model.dga_data_model.report_eb_cashflow__detail"], "source.dga_data_model.bpm_bulanding.thuvh3_eb_approve_fact_decision_bpm @DGA_READ_BULANDING_DBL": ["model.dga_data_model.report_eb_cashflow__detail"], "source.dga_data_model.ews_bulanding.ews_rb_cust_info @DGA_READ_BULANDING_DBL": ["model.dga_data_model.landing_hist__ews_rb_cust_info"], "source.dga_data_model.ews_bulanding.ews_rb_thruput_casa @DGA_READ_BULANDING_DBL": ["model.dga_data_model.landing_hist__ews_rb_thruput_casa"], "source.dga_data_model.ews_bulanding.ews_rb_thruput_fd @DGA_READ_BULANDING_DBL": ["model.dga_data_model.landing_hist__ews_rb_thruput_fd"], "source.dga_data_model.ews_bulanding.ews_rb_thruput_in @DGA_READ_BULANDING_DBL": ["model.dga_data_model.landing_hist__ews_rb_thruput_in"], "source.dga_data_model.ews_bulanding.ews_rb_thruput_out @DGA_READ_BULANDING_DBL": ["model.dga_data_model.landing_hist__ews_rb_thruput_out"], "source.dga_data_model.dbo.data_toi_df": ["model.dga_data_model.qlhs__data_toi", "test.dga_data_model.source_is_updated_dbo_data_toi_df_oracle_dgaworkzone_base_qlhs__data_toi__MAX_cast_yearmonth_AS_integer_.22fea21b94"], "source.dga_data_model.dbo.customer_product_holding_df": ["model.dga_data_model.qlhs__customer_product_holding_df", "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_product_holding_df_yearmonth__cifno.a1d6695c4f", "test.dga_data_model.source_is_updated_dbo_customer_product_holding_df_oracle_dgaworkzone_base_qlhs__customer_product_holding_df__MAX_cast_yearmonth_AS_integer_.08dc2fc82f"], "source.dga_data_model.dbo.customer_active_df": ["model.dga_data_model.qlhs__customer_active_df", "test.dga_data_model.dbt_utils_source_unique_combination_of_columns_dbo_customer_active_df_yearmonth__cifno.d645917cc2", "test.dga_data_model.source_is_updated_dbo_customer_active_df_oracle_dgaworkzone_base_qlhs__customer_active_df__MAX_cast_yearmonth_AS_integer_.f4966ea198"], "source.dga_data_model.vision.mgt_result_headers": ["model.dga_data_model.vision__mgt_result_headers"], "source.dga_data_model.vision.currency_rates_daily": ["model.dga_data_model.vision__currency_rates_daily"], "source.dga_data_model.vision.mgt_expanded": ["model.dga_data_model.vision__mgt_expanded"], "source.dga_data_model.vision.contracts": ["model.dga_data_model.stg_vision_tmp__contracts"], "source.dga_data_model.vision.customers": ["model.dga_data_model.stg_vision_tmp__customers"], "source.dga_data_model.vision.fin_dly_mappings_pm": [], "source.dga_data_model.vision.fin_dly_balances_pm": [], "source.dga_data_model.vision.vw_fin_dly_headers_pm": [], "source.dga_data_model.vision.mgt_result_balances": ["model.dga_data_model.vision__mgt_result_balances"], "source.dga_data_model.vision.fin_dly_audit": ["model.dga_data_model.vision__fin_dly_audit"], "source.dga_data_model.vision.ftp_term_rates": ["model.dga_data_model.stg_vision__ftp_term_rates"], "source.dga_data_model.vision.build_schedules_details_audit": ["model.dga_data_model.vision__build_schedules_details_audit"], "source.dga_data_model.eb_datasource.zlnthang_cif_ftpnew_2023": ["model.dga_data_model.vision__eb_toi_monthly"], "source.dga_data_model.eb_datasource.tambtt3_sanpham_kh_sudung_2023": ["model.dga_data_model.vision__eb_prd_holding_monthly"], "source.dga_data_model.eb_datasource.trang_thai_kh_2023": ["model.dga_data_model.vision__eb_cst_status_monthly"], "source.dga_data_model.eb_datasource.zcustomersall_2023": ["model.dga_data_model.vision__eb_bal_onbs_monthly"], "source.dga_data_model.eb_datasource.huong_atf_vision_mth_2023": ["model.dga_data_model.vision__eb_bal_offbs_monthly"], "source.dga_data_model.msb.account": ["model.dga_data_model.way4__account"], "source.dga_data_model.msb.acnt_contract": ["model.dga_data_model.stg_way4__acnt_contract"], "source.dga_data_model.msb.cs_decision": ["model.dga_data_model.way4__cs_decision"], "source.dga_data_model.msb.cs_status_type": ["model.dga_data_model.way4__cs_status_type"], "source.dga_data_model.base.imp_bpm_vhkq__category": ["model.dga_data_model.bpm_vhkq__atm_module", "model.dga_data_model.bpm_vhkq__kq_module"], "source.dga_data_model.base.imp_vhkq__cust_thu_chi_ho": ["model.dga_data_model.int__gl_txn"], "source.dga_data_model.base.imp_bpm_vhkq__gl_khoquy": ["model.dga_data_model.int__gl_bal"], "source.dga_data_model.int.int_tax__customer_info": ["model.dga_data_model.int__customer"], "source.dga_data_model.mart.dim__industry": ["model.dga_data_model.int__customer", "model.dga_data_model.report_eb_cashflow__cst_smy"], "source.dga_data_model.mart.dim_clos_limit_tree": ["model.dga_data_model.agg_clos_limit_tree_detail"], "source.dga_data_model.df_2.bpm_branch_mapping": ["model.dga_data_model.dim_bpm__loan_application", "model.dga_data_model.dim_cms__loan_application", "model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.bpm_opportunity": ["model.dga_data_model.dim_bpm__loan_application", "model.dga_data_model.fact_bpm__loan_application_activities", "model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.bpm_eb_customer": ["model.dga_data_model.dim_bpm__loan_application", "model.dga_data_model.fact_bpm__loan_application_activities"], "source.dga_data_model.df_2.bpm_application_data": ["model.dga_data_model.dim_bpm__loan_application", "model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.bpm_application": ["model.dga_data_model.dim_bpm__loan_application", "model.dga_data_model.fact_bpm__loan_application_activities"], "source.dga_data_model.df_2.bpm_application_history_detail": ["model.dga_data_model.fact_bpm__loan_application_activities", "model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.bpm_application_history": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_111": ["model.dga_data_model.dim_bpm__loan_application", "model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_12": ["model.dga_data_model.dim_bpm__loan_application"], "source.dga_data_model.df_2.jstb_110": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_123": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_153": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_155": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_118": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_143": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_115": [], "source.dga_data_model.df_2.jstb_122": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_152": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_154": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_147": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_183": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_184": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_159": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_188": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_189": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_135": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_171": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_174": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_20363": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_240": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_3": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.jstb_145": ["model.dga_data_model.fact_bpm__loan_application_decision"], "source.dga_data_model.df_2.cj3_history_assign_lead": ["model.dga_data_model.dim_cms__loan_application", "model.dga_data_model.fact_cms__loan_application_activities"], "source.dga_data_model.df_2.cj3_history_update_loan": ["model.dga_data_model.dim_cms__loan_application", "model.dga_data_model.fact_cms__loan_application_activities"], "source.dga_data_model.df_2.cj3_staff": ["model.dga_data_model.dim_cms__loan_application", "model.dga_data_model.fact_cms__loan_application_activities"], "source.dga_data_model.df_2.cj3_file_upload_loan": ["model.dga_data_model.dim_cms__loan_application", "model.dga_data_model.fact_cms__loan_application_activities"], "source.dga_data_model.df_2.cj3_loan_application": ["model.dga_data_model.dim_cms__loan_application", "model.dga_data_model.fact_cms__loan_application_activities"], "source.dga_data_model.df_2.cj3_leads_activities": ["model.dga_data_model.dim_cms__loan_application"], "source.dga_data_model.df_2.thuvh3_tax_code_test": ["model.dga_data_model.dim_cms__loan_application"], "source.dga_data_model.df_2.cj3_loan_application_tracking": ["model.dga_data_model.fact_cms__loan_application_activities"], "source.dga_data_model.df_2.cj3_leads_info": ["model.dga_data_model.dim_cms__loan_application"], "source.dga_data_model.ms_kho_quy.atm": ["model.dga_data_model.stg_bpm_vhkq__atm"], "source.dga_data_model.ms_kho_quy.atm_category_tray": ["model.dga_data_model.stg_bpm_vhkq__atm_category_tray"], "source.dga_data_model.ms_kho_quy.atm_detail": ["model.dga_data_model.stg_bpm_vhkq__atm_detail"], "source.dga_data_model.ms_kho_quy.attachment": ["model.dga_data_model.stg_bpm_vhkq__attachment"], "source.dga_data_model.ms_kho_quy.category": ["model.dga_data_model.stg_bpm_vhkq__category"], "source.dga_data_model.ms_kho_quy.delivery": ["model.dga_data_model.stg_bpm_vhkq__delivery"], "source.dga_data_model.ms_kho_quy.doc_no": ["model.dga_data_model.stg_bpm_vhkq__doc_no"], "source.dga_data_model.ms_kho_quy.mail_log": ["model.dga_data_model.stg_bpm_vhkq__mail_log"], "source.dga_data_model.ms_kho_quy.position": ["model.dga_data_model.stg_bpm_vhkq__position"], "source.dga_data_model.ms_kho_quy.process_definition": ["model.dga_data_model.stg_bpm_vhkq__process_definition"], "source.dga_data_model.ms_kho_quy.process_instance": ["model.dga_data_model.stg_bpm_vhkq__process_instance"], "source.dga_data_model.ms_kho_quy.process_instance_his": ["model.dga_data_model.stg_bpm_vhkq__process_instance_his"], "source.dga_data_model.ms_kho_quy.request_atm": ["model.dga_data_model.stg_bpm_vhkq__request_atm"], "source.dga_data_model.ms_kho_quy.request_atm_card_detail": ["model.dga_data_model.stg_bpm_vhkq__request_atm_card_detail"], "source.dga_data_model.ms_kho_quy.request_atm_detail": ["model.dga_data_model.stg_bpm_vhkq__request_atm_detail"], "source.dga_data_model.ms_kho_quy.request_atm_tray_control": ["model.dga_data_model.stg_bpm_vhkq__request_atm_tray_control"], "source.dga_data_model.ms_kho_quy.request_atm_tray_detail": ["model.dga_data_model.stg_bpm_vhkq__request_atm_tray_detail"], "source.dga_data_model.ms_kho_quy.request_branch": ["model.dga_data_model.stg_bpm_vhkq__request_branch"], "source.dga_data_model.ms_kho_quy.request_branch_detail": ["model.dga_data_model.stg_bpm_vhkq__request_branch_detail"], "source.dga_data_model.ms_kho_quy.skewed_threshold": ["model.dga_data_model.stg_bpm_vhkq__skewed_threshold"], "source.dga_data_model.ms_kho_quy.staff": ["model.dga_data_model.stg_bpm_vhkq__staff"], "source.dga_data_model.ms_kho_quy.staff_assignment": ["model.dga_data_model.stg_bpm_vhkq__staff_assignment"], "source.dga_data_model.ms_kho_quy.staff_request_atm": ["model.dga_data_model.stg_bpm_vhkq__staff_request_atm"], "source.dga_data_model.ms_kho_quy.staff_request_branch": ["model.dga_data_model.stg_bpm_vhkq__staff_request_branch"], "source.dga_data_model.ms_kho_quy.staff_transfer_history": ["model.dga_data_model.stg_bpm_vhkq__staff_transfer_history"], "source.dga_data_model.ms_kho_quy.template": ["model.dga_data_model.stg_bpm_vhkq__template"], "source.dga_data_model.ms_kho_quy.user_unit": ["model.dga_data_model.stg_bpm_vhkq__user_unit"], "source.dga_data_model.ms_kho_quy.volume": ["model.dga_data_model.stg_bpm_vhkq__volume"], "source.dga_data_model.ms_kho_quy.volume_detail": ["model.dga_data_model.stg_bpm_vhkq__volume_detail"], "source.dga_data_model.ms_kho_quy.warehouse": ["model.dga_data_model.stg_bpm_vhkq__warehouse"], "source.dga_data_model.ms_kho_quy.warehouse_organization": ["model.dga_data_model.stg_bpm_vhkq__warehouse_organization"], "source.dga_data_model.ms_kho_quy.warehouse_user": ["model.dga_data_model.stg_bpm_vhkq__warehouse_user"], "source.dga_data_model.vhkq_atm_daily_bul.card_doc": [], "source.dga_data_model.vhkq_atm_daily_az_int.int__gl_bal": [], "source.dga_data_model.vhkq_atm_daily_az_base.imp_bpm_vhkq__atm": ["model.dga_data_model.stg_mart_vhkq__atm"], "source.dga_data_model.cic_bulanding.cic_cicth_camketngoaibang @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__camketngoaibang"], "source.dga_data_model.cic_bulanding.cic_cicmaster @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__cicmaster"], "source.dga_data_model.cic_bulanding.cic_customer_info @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__customer_info"], "source.dga_data_model.cic_bulanding.cic_cicth_daututraiphieu @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__daututraiphieu"], "source.dga_data_model.cic_bulanding.cic_cicth_duno12thang @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__duno12thang"], "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__dunothetd"], "source.dga_data_model.cic_bulanding.cic_cicth_dunothetd12thang @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__dunothetd12thang"], "source.dga_data_model.cic_bulanding.cic_cicth_novamc @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__novamc"], "source.dga_data_model.cic_bulanding.cic_cicth_thongtinchung @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__thongtinchung"], "source.dga_data_model.cic_bulanding.cic_cicth_ttduno @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_cic__ttduno"], "source.dga_data_model.gl_daily_bul.si_his_glhist": ["model.dga_data_model.stg_landing__gl_hist"], "source.dga_data_model.gl_daily_bul.gl_account_master": ["model.dga_data_model.stg_landing__gl_account_master"], "source.dga_data_model.gl_daily_bul.fixeddeposit_transaction001": ["model.dga_data_model.stg_int__gl_txn_check_date"], "source.dga_data_model.gl_daily_bul.demanddeposit_transaction001": ["model.dga_data_model.stg_int__gl_txn_check_date"], "source.dga_data_model.gl_daily_bul.loan_transaction001": ["model.dga_data_model.stg_int__gl_txn_check_date"], "source.dga_data_model.gl_daily_az_stg.stg_int__gl_txn": [], "source.dga_data_model.gl_daily_az_int.int__gl_txn": [], "source.dga_data_model.daily_bulanding.bc_user_info @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__bc_user_info"], "source.dga_data_model.daily_bulanding.card_acnt_contract @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_acnt_contract"], "source.dga_data_model.daily_bulanding.card_add_data @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_add_data"], "source.dga_data_model.daily_bulanding.card_appl_product @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_appl_product"], "source.dga_data_model.daily_bulanding.card_client @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_client"], "source.dga_data_model.daily_bulanding.card_contr_status @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_contr_status"], "source.dga_data_model.daily_bulanding.card_currency @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_currency"], "source.dga_data_model.daily_bulanding.card_doc @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_doc"], "source.dga_data_model.daily_bulanding.card_f_i @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_f_i"], "source.dga_data_model.daily_bulanding.card_m_transaction @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__card_m_transaction"], "source.dga_data_model.daily_bulanding.customer_address @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__customer_address"], "source.dga_data_model.daily_bulanding.customer_connection @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__customer_connection"], "source.dga_data_model.daily_bulanding.customer_job_infomation @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__customer_job_infomation"], "source.dga_data_model.daily_bulanding.customer_marital_status @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__customer_marital_status"], "source.dga_data_model.daily_bulanding.customer_master001 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__customer_master001"], "source.dga_data_model.daily_bulanding.customer_master002 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__customer_master002"], "source.dga_data_model.daily_bulanding.demanddeposit_master001 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__demanddeposit_master001"], "source.dga_data_model.daily_bulanding.demanddeposit_master002 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__demanddeposit_master002"], "source.dga_data_model.daily_bulanding.df_card_channel @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__df_card_channel"], "source.dga_data_model.daily_bulanding.df_card_sic @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__df_card_sic"], "source.dga_data_model.daily_bulanding.df_casa_channel_trn_type @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__df_casa_channel_trn_type"], "source.dga_data_model.daily_bulanding.df_customer_sts_type @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__df_customer_sts_type"], "source.dga_data_model.daily_bulanding.fixeddeposit_master001 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__fixeddeposit_master001"], "source.dga_data_model.daily_bulanding.fixeddeposit_master002 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__fixeddeposit_master002"], "source.dga_data_model.daily_bulanding.fixeddeposit_master003 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__fixeddeposit_master003"], "source.dga_data_model.daily_bulanding.jupiter_account_register_hist @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__jupiter_account_register_hist"], "source.dga_data_model.daily_bulanding.jupiter_cif_register_history @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__jupiter_cif_register_history"], "source.dga_data_model.daily_bulanding.jupiter_customer_temp @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__jupiter_customer_temp"], "source.dga_data_model.daily_bulanding.loan_application_facility @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__loan_application_facility"], "source.dga_data_model.daily_bulanding.loan_master001_2020001_2021212 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__loan_master001_2020001_2021212"], "source.dga_data_model.daily_bulanding.loan_master002 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__loan_master002"], "source.dga_data_model.daily_bulanding.overdraft_tier001 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__overdraft_tier001"], "source.dga_data_model.daily_bulanding.vw_df_customer_active_latest @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vw_df_customer_active_latest"], "source.dga_data_model.daily_bulanding.vw_df_demanddeposit_transaction001_union_all @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vw_df_demanddeposit_transaction001_union_all"], "source.dga_data_model.daily_bulanding.vw_df_overdraft_tier002_union_all @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vw_df_overdraft_tier002_union_all"], "source.dga_data_model.daily_bulanding.way4_trans_type @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__way4_trans_type"], "source.dga_data_model.daily_bulanding.bb_ttr_history@dga_read_bulanding_dbl": ["model.dga_data_model.stg__ddft_transaction_map_ibmb"], "source.dga_data_model.daily_bulanding.bb_transfer_history@dga_read_bulanding_dbl": ["model.dga_data_model.stg__ddft_transaction_map_ibmb"], "source.dga_data_model.daily_bulanding.card_doc_01012020_01012022 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.fct__trans_card_bk"], "source.dga_data_model.daily_bulanding.df_date_dim @DGA_READ_BULANDING_DBL": ["model.dga_data_model.dim__date"], "source.dga_data_model.daily_bulanding.demanddeposit_master003 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.fct__agg_casa_bal_daily"], "source.dga_data_model.daily_bulanding.card_m_transaction_01012020_01012022 @DGA_READ_BULANDING_DBL": ["model.dga_data_model.fct__trans_card_bk"], "source.dga_data_model.staging.temp_daily_transaction_remark_define_product": ["model.dga_data_model.fct__trans_casa_test"], "source.dga_data_model.daily_dwh.ddft_transaction @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__demanddeposit_transaction001"], "source.dga_data_model.daily_dwh.crtb_odtier @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__crtb_odtier"], "source.dga_data_model.daily_dwh.csdm_branch @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__csdm_branch"], "source.dga_data_model.daily_dwh.csdm_transaction_code @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__csdm_transaction_code"], "source.dga_data_model.daily_dwh.cydm_rate_history @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__cydm_rate_history"], "source.dga_data_model.daily_dwh.dddm_product @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__dddm_product"], "source.dga_data_model.daily_dwh.ddft_master @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__ddft_master"], "source.dga_data_model.daily_dwh.fddm_product @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__fddm_product"], "source.dga_data_model.daily_dwh.lnft_master @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__lnft_master"], "source.dga_data_model.daily_dwh.lndm_account @DGA_READ_DWHPRO_DBL": ["model.dga_data_model.stg_dwh__loan_master001"], "source.dga_data_model.daily_dwh.ebft_bc_transfer_history @dga_read_dwhpro_dbl": ["model.dga_data_model.stg__ddft_transaction_map_ibmb"], "source.dga_data_model.vision_bulanding.vision_currency_rates_daily @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vision_currency_rates_daily"], "source.dga_data_model.vision_bulanding.vision_fin_dly_balances @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vision_fin_dly_balances"], "source.dga_data_model.vision_bulanding.vision_fin_dly_headers @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vision_fin_dly_headers"], "source.dga_data_model.vision_bulanding.vision_fin_dly_mappings @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vision_fin_dly_mappings"], "source.dga_data_model.vision_bulanding.vision_mgt_expanded @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__vision_mgt_expanded"], "source.dga_data_model.mercury.tbl_eb_application": ["model.dga_data_model.stg_mercury__tbl_eb_application"], "source.dga_data_model.mercury.tbl_eb_applicant": ["model.dga_data_model.stg_mercury__tbl_eb_applicant"], "source.dga_data_model.mercury.tbl_css_eb_applicant": ["model.dga_data_model.stg_mercury__tbl_css_eb_applicant"], "source.dga_data_model.mercury.tbl_doc_need_list": ["model.dga_data_model.stg_mercury__tbl_doc_need_list"], "source.dga_data_model.mercury.tbl_doc_detail": ["model.dga_data_model.stg_mercury__tbl_doc_detail"], "source.dga_data_model.mercury.tbl_doc_no_hist": ["model.dga_data_model.stg_mercury__tbl_doc_no_hist"], "source.dga_data_model.mercury.tbl_applicant_enterprise_income": ["model.dga_data_model.stg_mercury__tbl_applicant_enterprise_income"], "source.dga_data_model.staging.stg_los__categories_test": ["model.dga_data_model.test_los__categories_run"], "source.dga_data_model.staging.stg_los__opportunities_test": ["model.dga_data_model.test_los__opportunities_run"], "source.dga_data_model.staging.stg_los__corpapplimitdetails_test": ["model.dga_data_model.test_los__corpapplimitdetails_run"], "source.dga_data_model.staging.stg_los__areas_test": [], "source.dga_data_model.dbo.tbldailyperformance": ["model.dga_data_model.stg_tms__tbldailyperformance"], "source.dga_data_model.dbo.tblevent": ["model.dga_data_model.stg_tms__tblevent"], "source.dga_data_model.dbo.tbleventhistory": ["model.dga_data_model.stg_tms__tbleventhistory"], "source.dga_data_model.dbo.tblincident": ["model.dga_data_model.stg_tms__tblincident"], "source.dga_data_model.dbo.tblincidenthistory": ["model.dga_data_model.stg_tms__tblincidenthistory"], "source.dga_data_model.sys.dual": ["model.dga_data_model.stg_tms__tbldailyperformance", "model.dga_data_model.stg_tms__tblevent", "model.dga_data_model.stg_tms__tbleventhistory", "model.dga_data_model.stg_tms__tblincident", "model.dga_data_model.stg_tms__tblincidenthistory"], "source.dga_data_model.venus_bulanding.sppl_m_account_planning @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_account_planning"], "source.dga_data_model.venus_bulanding.sppl_m_activities @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_activities"], "source.dga_data_model.venus_bulanding.sppl_m_branch @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_branch"], "source.dga_data_model.venus_bulanding.sppl_m_campaign @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_campaign"], "source.dga_data_model.venus_bulanding.sppl_m_customer @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_customer"], "source.dga_data_model.venus_bulanding.sppl_m_flow_activities_status @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_flow_activities_status"], "source.dga_data_model.venus_bulanding.sppl_m_lead @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_lead"], "source.dga_data_model.venus_bulanding.sppl_m_selling_opportunity @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_selling_opportunity"], "source.dga_data_model.venus_bulanding.sppl_m_selling_status @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_selling_status"], "source.dga_data_model.venus_bulanding.sppl_m_team_group @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_team_group"], "source.dga_data_model.venus_bulanding.sppl_m_user @DGA_READ_BULANDING_DBL": ["model.dga_data_model.stg_landing__sppl_m_user"], "source.dga_data_model.msb.cr_limit_log": ["model.dga_data_model.stg_way4__cr_limit_log"], "source.dga_data_model.crmuser.collaterallinkage": ["model.dga_data_model.stg_los__collaterallinkage"], "source.dga_data_model.crmuser.customerdetail": ["model.dga_data_model.stg_los__customerdetail"], "source.dga_data_model.crmuser.rollback": ["model.dga_data_model.stg_los__rollback"], "source.dga_data_model.crmuser.user_groups": ["model.dga_data_model.stg_los__user_groups"], "source.dga_data_model.crmuser.applicantcontact": ["model.dga_data_model.stg_los__applicantcontact"], "source.dga_data_model.crmuser.oslineproductdetails": ["model.dga_data_model.stg_los__oslineproductdetails"], "source.dga_data_model.crmuser.applicantmiscdetail": ["model.dga_data_model.stg_los__applicantmiscdetail"], "source.dga_data_model.crmuser.creditscoringdetails": ["model.dga_data_model.stg_los__creditscoringdetails"], "source.dga_data_model.crmuser.bizcenter": ["model.dga_data_model.stg_los__bizcenter"], "source.dga_data_model.crmuser.useractiontray": ["model.dga_data_model.stg_los__useractiontray"], "source.dga_data_model.crmuser.addoncarddetails": ["model.dga_data_model.stg_los__addoncarddetails"], "source.dga_data_model.crmuser.applicant": ["model.dga_data_model.stg_los__applicant"], "source.dga_data_model.crmuser.agents": ["model.dga_data_model.stg_los__agents"], "source.dga_data_model.crmuser.rlosworknotes": ["model.dga_data_model.stg_los__rlosworknotes"], "source.dga_data_model.crmuser.agent_entity_details": ["model.dga_data_model.stg_los__agent_entity_details"], "source.dga_data_model.crmuser.person": ["model.dga_data_model.stg_los__person"], "source.dga_data_model.crmuser.corpdecisioncode": ["model.dga_data_model.stg_los__corpdecisioncode"], "source.dga_data_model.crmuser.rlosroutingdetails": ["model.dga_data_model.stg_los__rlosroutingdetails"], "source.dga_data_model.crmuser.transactiondepartment": ["model.dga_data_model.stg_los__transactiondepartment"], "source.dga_data_model.crmuser.parentapplication": ["model.dga_data_model.stg_los__parentapplication"], "source.dga_data_model.crmuser.applicantcontactphnemllist": ["model.dga_data_model.stg_los__applicantcontactphnemllist"], "source.dga_data_model.crmuser.decision": ["model.dga_data_model.stg_los__decision"], "source.dga_data_model.crmuser.appraisal_custom": ["model.dga_data_model.stg_los__appraisal_custom"], "source.dga_data_model.crmuser.category_lang": ["model.dga_data_model.stg_los__category_lang"], "source.dga_data_model.crmuser.categories": ["model.dga_data_model.stg_los__categories"], "source.dga_data_model.crmuser.opportunities": ["model.dga_data_model.stg_los__opportunities"], "source.dga_data_model.crmuser.corpapplimitdetails": ["model.dga_data_model.stg_los__corpapplimitdetails"], "source.dga_data_model.crmuser.osproduct": ["model.dga_data_model.stg_los__osproduct"], "source.dga_data_model.crmuser.corpapplicationdetails": ["model.dga_data_model.stg_los__corpapplicationdetails"], "source.dga_data_model.crmuser.custidentitydetail": ["model.dga_data_model.stg_los__custidentitydetail"], "source.dga_data_model.crmuser.losprocessentity": ["model.dga_data_model.stg_los__losprocessentity"], "source.dga_data_model.crmuser.creditcardproduct": ["model.dga_data_model.stg_los__creditcardproduct"], "source.dga_data_model.crmuser.oscorpdocumentdetail": ["model.dga_data_model.stg_los__oscorpdocumentdetail"], "source.dga_data_model.crmuser.oscorpcustomerdetail": ["model.dga_data_model.stg_los__oscorpcustomerdetail"], "source.dga_data_model.crmuser.users": ["model.dga_data_model.stg_los__users"], "source.dga_data_model.crmuser.corpappentitydetails": ["model.dga_data_model.stg_los__corpappentitydetails"], "source.dga_data_model.crmuser.applicantidentitydetail": ["model.dga_data_model.stg_los__applicantidentitydetail"], "source.dga_data_model.crmuser.applicationdetails": ["model.dga_data_model.stg_los__applicationdetails"], "source.dga_data_model.crmuser.areas": ["model.dga_data_model.stg_los__areas", "model.dga_data_model.test_stg_los__areas_run"], "source.dga_data_model.crmuser.closroutingdetails": ["model.dga_data_model.stg_los__closroutingdetails"], "source.dga_data_model.crmuser.srmgroups": ["model.dga_data_model.stg_los__srmgroups"], "source.dga_data_model.crmuser.loanproductdetails": ["model.dga_data_model.stg_los__loanproductdetails"], "source.dga_data_model.crmuser.address": ["model.dga_data_model.los__address"], "source.dga_data_model.crmuser.slbccodemapping": ["model.dga_data_model.los__slbccodemapping"], "source.dga_data_model.crmuser.collateralgeneraldetails": ["model.dga_data_model.stg_los__collateralgeneraldetails"], "source.dga_data_model.crmuser.addressdetail": ["model.dga_data_model.los__addressdetail"], "source.dga_data_model.crmuser.applicantaddress": ["model.dga_data_model.los__applicantaddress"], "source.dga_data_model.crmuser.syncapplicantaddressmap": ["model.dga_data_model.los__syncapplicantaddressmap"]}}